# Comparing `tmp/evolutionary_forest-0.2.0.tar.gz` & `tmp/evolutionary_forest-0.2.1.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "evolutionary_forest-0.2.0.tar", last modified: Thu Dec  1 07:14:30 2022, max compression
+gzip compressed data, was "evolutionary_forest-0.2.1.tar", last modified: Sun Apr 16 04:50:19 2023, max compression
```

## Comparing `evolutionary_forest-0.2.0.tar` & `evolutionary_forest-0.2.1.tar`

### file list

```diff
@@ -1,65 +1,77 @@
-drwxrwxrwx   0        0        0        0 2022-12-01 07:14:30.099019 evolutionary_forest-0.2.0/
--rw-rw-rw-   0        0        0      174 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.0/AUTHORS.rst
--rw-rw-rw-   0        0        0     3786 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.0/CONTRIBUTING.rst
--rw-rw-rw-   0        0        0       97 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.0/HISTORY.rst
--rw-rw-rw-   0        0        0     7817 2022-09-18 23:11:28.000000 evolutionary_forest-0.2.0/LICENSE
--rw-rw-rw-   0        0        0      273 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.0/MANIFEST.in
--rw-rw-rw-   0        0        0     5515 2022-12-01 07:14:30.099019 evolutionary_forest-0.2.0/PKG-INFO
--rw-rw-rw-   0        0        0     4473 2022-09-29 09:50:56.000000 evolutionary_forest-0.2.0/README.rst
-drwxrwxrwx   0        0        0        0 2022-12-01 07:14:29.998593 evolutionary_forest-0.2.0/docs/
--rw-rw-rw-   0        0        0      640 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.0/docs/Makefile
--rw-rw-rw-   0        0        0       29 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.0/docs/authors.rst
--rw-rw-rw-   0        0        0     4945 2021-05-23 09:17:11.000000 evolutionary_forest-0.2.0/docs/conf.py
--rw-rw-rw-   0        0        0    35548 2021-05-22 17:56:17.000000 evolutionary_forest-0.2.0/docs/constructed_features.png
--rw-rw-rw-   0        0        0       34 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.0/docs/contributing.rst
--rw-rw-rw-   0        0        0       29 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.0/docs/history.rst
--rw-rw-rw-   0        0        0      336 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.0/docs/index.rst
--rw-rw-rw-   0        0        0     1269 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.0/docs/installation.rst
--rwxrwxrwx   0        0        0      817 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.0/docs/make.bat
--rw-rw-rw-   0        0        0       28 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.0/docs/readme.rst
--rw-rw-rw-   0        0        0      100 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.0/docs/usage.rst
-drwxrwxrwx   0        0        0        0 2022-12-01 07:14:30.016659 evolutionary_forest-0.2.0/evolutionary_forest/
--rw-rw-rw-   0        0        0      147 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.0/evolutionary_forest/__init__.py
-drwxrwxrwx   0        0        0        0 2022-12-01 07:14:30.066646 evolutionary_forest-0.2.0/evolutionary_forest/component/
--rw-rw-rw-   0        0        0        0 2021-06-05 13:01:56.000000 evolutionary_forest-0.2.0/evolutionary_forest/component/__init__.py
--rw-rw-rw-   0        0        0    21205 2022-11-01 07:31:40.000000 evolutionary_forest-0.2.0/evolutionary_forest/component/archive.py
--rw-rw-rw-   0        0        0    18617 2022-11-15 03:00:39.000000 evolutionary_forest-0.2.0/evolutionary_forest/component/evaluation.py
--rw-rw-rw-   0        0        0     2692 2022-11-29 05:08:08.000000 evolutionary_forest-0.2.0/evolutionary_forest/component/generation.py
--rw-rw-rw-   0        0        0    15979 2022-11-03 11:33:13.000000 evolutionary_forest-0.2.0/evolutionary_forest/component/mutation_transformer.py
--rw-rw-rw-   0        0        0     9368 2022-10-27 04:27:32.000000 evolutionary_forest-0.2.0/evolutionary_forest/component/primitives.py
--rw-rw-rw-   0        0        0    30529 2022-10-17 02:15:05.000000 evolutionary_forest-0.2.0/evolutionary_forest/component/selection.py
--rw-rw-rw-   0        0        0     3436 2022-10-28 09:48:39.000000 evolutionary_forest-0.2.0/evolutionary_forest/component/stateful_gp.py
--rw-rw-rw-   0        0        0     4425 2021-07-14 16:11:41.000000 evolutionary_forest-0.2.0/evolutionary_forest/component/subset_selection.py
--rw-rw-rw-   0        0        0     3544 2022-04-13 03:31:07.000000 evolutionary_forest-0.2.0/evolutionary_forest/component/syntax_tools.py
--rw-rw-rw-   0        0        0    14885 2021-09-11 08:33:29.000000 evolutionary_forest-0.2.0/evolutionary_forest/component/translation_transformer.py
--rw-rw-rw-   0        0        0   187720 2022-12-01 06:43:08.000000 evolutionary_forest-0.2.0/evolutionary_forest/forest.py
-drwxrwxrwx   0        0        0        0 2022-12-01 07:14:30.081807 evolutionary_forest-0.2.0/evolutionary_forest/model/
--rw-rw-rw-   0        0        0    23534 2022-12-01 07:03:23.000000 evolutionary_forest-0.2.0/evolutionary_forest/model/PLTree.py
--rw-rw-rw-   0        0        0     2509 2021-10-04 12:18:17.000000 evolutionary_forest-0.2.0/evolutionary_forest/model/RBFN.py
--rw-rw-rw-   0        0        0      213 2022-03-05 06:51:18.000000 evolutionary_forest-0.2.0/evolutionary_forest/model/SafetyLR.py
--rw-rw-rw-   0        0        0     1366 2022-10-29 09:31:55.000000 evolutionary_forest-0.2.0/evolutionary_forest/model/SafetyScaler.py
--rw-rw-rw-   0        0        0     2767 2022-09-21 22:33:20.000000 evolutionary_forest-0.2.0/evolutionary_forest/model/VAE.py
--rw-rw-rw-   0        0        0        0 2021-09-16 12:36:02.000000 evolutionary_forest-0.2.0/evolutionary_forest/model/__init__.py
--rw-rw-rw-   0        0        0    31772 2022-11-30 07:51:57.000000 evolutionary_forest-0.2.0/evolutionary_forest/multigene_gp.py
--rw-rw-rw-   0        0        0     3750 2022-09-05 05:44:00.000000 evolutionary_forest-0.2.0/evolutionary_forest/preprocess_utils.py
--rw-rw-rw-   0        0        0     5370 2021-08-15 10:17:14.000000 evolutionary_forest-0.2.0/evolutionary_forest/probability_gp.py
--rw-rw-rw-   0        0        0     2105 2021-05-22 12:12:51.000000 evolutionary_forest-0.2.0/evolutionary_forest/pruning.py
--rw-rw-rw-   0        0        0    10665 2022-10-31 13:06:47.000000 evolutionary_forest-0.2.0/evolutionary_forest/sklearn_utils.py
-drwxrwxrwx   0        0        0        0 2022-12-01 07:14:30.090864 evolutionary_forest-0.2.0/evolutionary_forest/strategies/
--rw-rw-rw-   0        0        0        0 2022-12-01 07:12:29.000000 evolutionary_forest-0.2.0/evolutionary_forest/strategies/__init__.py
--rw-rw-rw-   0        0        0     7524 2022-11-19 23:07:04.000000 evolutionary_forest-0.2.0/evolutionary_forest/strategies/estimation_of_distribution.py
--rw-rw-rw-   0        0        0     4926 2022-11-19 20:57:05.000000 evolutionary_forest-0.2.0/evolutionary_forest/strategies/space_partition.py
--rw-rw-rw-   0        0        0    10169 2022-09-29 08:18:18.000000 evolutionary_forest-0.2.0/evolutionary_forest/strategies/surrogate_model.py
--rw-rw-rw-   0        0        0    10501 2022-11-22 08:04:35.000000 evolutionary_forest-0.2.0/evolutionary_forest/utils.py
-drwxrwxrwx   0        0        0        0 2022-12-01 07:14:30.037797 evolutionary_forest-0.2.0/evolutionary_forest.egg-info/
--rw-rw-rw-   0        0        0     5515 2022-12-01 07:14:29.000000 evolutionary_forest-0.2.0/evolutionary_forest.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0     1801 2022-12-01 07:14:29.000000 evolutionary_forest-0.2.0/evolutionary_forest.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2022-12-01 07:14:29.000000 evolutionary_forest-0.2.0/evolutionary_forest.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0        2 2022-09-29 09:53:12.000000 evolutionary_forest-0.2.0/evolutionary_forest.egg-info/not-zip-safe
--rw-rw-rw-   0        0        0      137 2022-12-01 07:14:29.000000 evolutionary_forest-0.2.0/evolutionary_forest.egg-info/requires.txt
--rw-rw-rw-   0        0        0       20 2022-12-01 07:14:29.000000 evolutionary_forest-0.2.0/evolutionary_forest.egg-info/top_level.txt
--rw-rw-rw-   0        0        0      490 2022-12-01 07:14:30.101555 evolutionary_forest-0.2.0/setup.cfg
--rw-rw-rw-   0        0        0     1721 2022-12-01 07:14:04.000000 evolutionary_forest-0.2.0/setup.py
-drwxrwxrwx   0        0        0        0 2022-12-01 07:14:30.096021 evolutionary_forest-0.2.0/tests/
--rw-rw-rw-   0        0        0       50 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.0/tests/__init__.py
--rw-rw-rw-   0        0        0      717 2021-06-05 11:47:17.000000 evolutionary_forest-0.2.0/tests/test_evolutionary_forest.py
+drwxrwxrwx   0        0        0        0 2023-04-16 04:50:19.950722 evolutionary_forest-0.2.1/
+-rw-rw-rw-   0        0        0      174 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.1/AUTHORS.rst
+-rw-rw-rw-   0        0        0     3786 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.1/CONTRIBUTING.rst
+-rw-rw-rw-   0        0        0       97 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.1/HISTORY.rst
+-rw-rw-rw-   0        0        0     7817 2022-09-18 23:11:28.000000 evolutionary_forest-0.2.1/LICENSE
+-rw-rw-rw-   0        0        0      273 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.1/MANIFEST.in
+-rw-rw-rw-   0        0        0     5492 2023-04-16 04:50:19.950722 evolutionary_forest-0.2.1/PKG-INFO
+-rw-rw-rw-   0        0        0     4473 2022-09-29 09:50:56.000000 evolutionary_forest-0.2.1/README.rst
+drwxrwxrwx   0        0        0        0 2023-04-16 04:50:19.752997 evolutionary_forest-0.2.1/docs/
+-rw-rw-rw-   0        0        0      640 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.1/docs/Makefile
+-rw-rw-rw-   0        0        0       29 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.1/docs/authors.rst
+-rw-rw-rw-   0        0        0     4945 2021-05-23 09:17:11.000000 evolutionary_forest-0.2.1/docs/conf.py
+-rw-rw-rw-   0        0        0    35548 2021-05-22 17:56:17.000000 evolutionary_forest-0.2.1/docs/constructed_features.png
+-rw-rw-rw-   0        0        0       34 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.1/docs/contributing.rst
+-rw-rw-rw-   0        0        0       29 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.1/docs/history.rst
+-rw-rw-rw-   0        0        0      336 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.1/docs/index.rst
+-rw-rw-rw-   0        0        0     1269 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.1/docs/installation.rst
+-rwxrwxrwx   0        0        0      817 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.1/docs/make.bat
+-rw-rw-rw-   0        0        0       28 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.1/docs/readme.rst
+-rw-rw-rw-   0        0        0      100 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.1/docs/usage.rst
+drwxrwxrwx   0        0        0        0 2023-04-16 04:50:19.783996 evolutionary_forest-0.2.1/evolutionary_forest/
+-rw-rw-rw-   0        0        0      147 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.1/evolutionary_forest/__init__.py
+drwxrwxrwx   0        0        0        0 2023-04-16 04:50:19.826527 evolutionary_forest-0.2.1/evolutionary_forest/application/
+-rw-rw-rw-   0        0        0        0 2023-02-21 01:07:11.000000 evolutionary_forest-0.2.1/evolutionary_forest/application/__init__.py
+-rw-rw-rw-   0        0        0     2141 2023-02-21 01:21:13.000000 evolutionary_forest-0.2.1/evolutionary_forest/application/baes_class.py
+-rw-rw-rw-   0        0        0     5953 2023-02-21 01:12:56.000000 evolutionary_forest-0.2.1/evolutionary_forest/application/expensive_benchmark.py
+-rw-rw-rw-   0        0        0      897 2023-02-21 01:20:21.000000 evolutionary_forest-0.2.1/evolutionary_forest/application/gp_function_test.py
+drwxrwxrwx   0        0        0        0 2023-04-16 04:50:19.890529 evolutionary_forest-0.2.1/evolutionary_forest/component/
+-rw-rw-rw-   0        0        0        0 2021-06-05 13:01:56.000000 evolutionary_forest-0.2.1/evolutionary_forest/component/__init__.py
+-rw-rw-rw-   0        0        0    22224 2023-02-13 23:08:33.000000 evolutionary_forest-0.2.1/evolutionary_forest/component/archive.py
+-rw-rw-rw-   0        0        0     7630 2023-04-06 03:58:05.000000 evolutionary_forest-0.2.1/evolutionary_forest/component/configuration.py
+-rw-rw-rw-   0        0        0    13056 2023-02-24 02:43:34.000000 evolutionary_forest-0.2.1/evolutionary_forest/component/crossover_mutation.py
+-rw-rw-rw-   0        0        0    28002 2023-04-15 23:44:05.000000 evolutionary_forest-0.2.1/evolutionary_forest/component/evaluation.py
+-rw-rw-rw-   0        0        0     6619 2023-03-16 12:33:12.000000 evolutionary_forest-0.2.1/evolutionary_forest/component/generation.py
+-rw-rw-rw-   0        0        0    15879 2023-03-21 12:02:47.000000 evolutionary_forest-0.2.1/evolutionary_forest/component/mutation_transformer.py
+-rw-rw-rw-   0        0        0     9515 2023-02-21 04:27:30.000000 evolutionary_forest-0.2.1/evolutionary_forest/component/primitives.py
+-rw-rw-rw-   0        0        0    33870 2023-03-22 02:09:26.000000 evolutionary_forest-0.2.1/evolutionary_forest/component/selection.py
+-rw-rw-rw-   0        0        0     3436 2022-10-28 09:48:39.000000 evolutionary_forest-0.2.1/evolutionary_forest/component/stateful_gp.py
+-rw-rw-rw-   0        0        0     4425 2021-07-14 16:11:41.000000 evolutionary_forest-0.2.1/evolutionary_forest/component/subset_selection.py
+-rw-rw-rw-   0        0        0     3544 2022-04-13 03:31:07.000000 evolutionary_forest-0.2.1/evolutionary_forest/component/syntax_tools.py
+-rw-rw-rw-   0        0        0      804 2023-02-20 22:24:52.000000 evolutionary_forest-0.2.1/evolutionary_forest/component/toolbox.py
+-rw-rw-rw-   0        0        0    14885 2021-09-11 08:33:29.000000 evolutionary_forest-0.2.1/evolutionary_forest/component/translation_transformer.py
+-rw-rw-rw-   0        0        0     2900 2023-02-24 09:43:14.000000 evolutionary_forest-0.2.1/evolutionary_forest/component/tree_utils.py
+-rw-rw-rw-   0        0        0   240866 2023-04-16 04:33:48.000000 evolutionary_forest-0.2.1/evolutionary_forest/forest.py
+drwxrwxrwx   0        0        0        0 2023-04-16 04:50:19.912719 evolutionary_forest-0.2.1/evolutionary_forest/model/
+-rw-rw-rw-   0        0        0    23534 2022-12-16 10:17:44.000000 evolutionary_forest-0.2.1/evolutionary_forest/model/PLTree.py
+-rw-rw-rw-   0        0        0     2509 2021-10-04 12:18:17.000000 evolutionary_forest-0.2.1/evolutionary_forest/model/RBFN.py
+-rw-rw-rw-   0        0        0      213 2022-03-05 06:51:18.000000 evolutionary_forest-0.2.1/evolutionary_forest/model/SafetyLR.py
+-rw-rw-rw-   0        0        0     1366 2022-10-29 09:31:55.000000 evolutionary_forest-0.2.1/evolutionary_forest/model/SafetyScaler.py
+-rw-rw-rw-   0        0        0     2767 2022-09-21 22:33:20.000000 evolutionary_forest-0.2.1/evolutionary_forest/model/VAE.py
+-rw-rw-rw-   0        0        0        0 2021-09-16 12:36:02.000000 evolutionary_forest-0.2.1/evolutionary_forest/model/__init__.py
+-rw-rw-rw-   0        0        0    51198 2023-04-07 23:30:16.000000 evolutionary_forest-0.2.1/evolutionary_forest/multigene_gp.py
+-rw-rw-rw-   0        0        0     3750 2022-09-05 05:44:00.000000 evolutionary_forest-0.2.1/evolutionary_forest/preprocess_utils.py
+-rw-rw-rw-   0        0        0     5370 2021-08-15 10:17:14.000000 evolutionary_forest-0.2.1/evolutionary_forest/probability_gp.py
+-rw-rw-rw-   0        0        0     2105 2021-05-22 12:12:51.000000 evolutionary_forest-0.2.1/evolutionary_forest/pruning.py
+-rw-rw-rw-   0        0        0    10665 2022-10-31 13:06:47.000000 evolutionary_forest-0.2.1/evolutionary_forest/sklearn_utils.py
+drwxrwxrwx   0        0        0        0 2023-04-16 04:50:19.939721 evolutionary_forest-0.2.1/evolutionary_forest/strategies/
+-rw-rw-rw-   0        0        0        0 2022-12-01 07:12:29.000000 evolutionary_forest-0.2.1/evolutionary_forest/strategies/__init__.py
+-rw-rw-rw-   0        0        0     1084 2023-02-16 13:06:23.000000 evolutionary_forest-0.2.1/evolutionary_forest/strategies/adaptive_rate.py
+-rw-rw-rw-   0        0        0    21656 2023-03-05 22:15:44.000000 evolutionary_forest-0.2.1/evolutionary_forest/strategies/estimation_of_distribution.py
+-rw-rw-rw-   0        0        0     2016 2023-03-05 00:31:14.000000 evolutionary_forest-0.2.1/evolutionary_forest/strategies/multiarm_bandit.py
+-rw-rw-rw-   0        0        0      269 2022-12-12 22:48:25.000000 evolutionary_forest-0.2.1/evolutionary_forest/strategies/prune_strategy.py
+-rw-rw-rw-   0        0        0     4926 2022-11-19 20:57:05.000000 evolutionary_forest-0.2.1/evolutionary_forest/strategies/space_partition.py
+-rw-rw-rw-   0        0        0    10169 2022-09-29 08:18:18.000000 evolutionary_forest-0.2.1/evolutionary_forest/strategies/surrogate_model.py
+-rw-rw-rw-   0        0        0    12667 2023-04-16 04:00:24.000000 evolutionary_forest-0.2.1/evolutionary_forest/utils.py
+drwxrwxrwx   0        0        0        0 2023-04-16 04:50:19.809007 evolutionary_forest-0.2.1/evolutionary_forest.egg-info/
+-rw-rw-rw-   0        0        0     5492 2023-04-16 04:50:19.000000 evolutionary_forest-0.2.1/evolutionary_forest.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0     2329 2023-04-16 04:50:19.000000 evolutionary_forest-0.2.1/evolutionary_forest.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2023-04-16 04:50:19.000000 evolutionary_forest-0.2.1/evolutionary_forest.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0        2 2022-09-29 09:53:12.000000 evolutionary_forest-0.2.1/evolutionary_forest.egg-info/not-zip-safe
+-rw-rw-rw-   0        0        0      137 2023-04-16 04:50:19.000000 evolutionary_forest-0.2.1/evolutionary_forest.egg-info/requires.txt
+-rw-rw-rw-   0        0        0       20 2023-04-16 04:50:19.000000 evolutionary_forest-0.2.1/evolutionary_forest.egg-info/top_level.txt
+-rw-rw-rw-   0        0        0      490 2023-04-16 04:50:19.953719 evolutionary_forest-0.2.1/setup.cfg
+-rw-rw-rw-   0        0        0     1721 2023-04-16 04:50:15.000000 evolutionary_forest-0.2.1/setup.py
+drwxrwxrwx   0        0        0        0 2023-04-16 04:50:19.946721 evolutionary_forest-0.2.1/tests/
+-rw-rw-rw-   0        0        0       50 2021-05-22 12:05:17.000000 evolutionary_forest-0.2.1/tests/__init__.py
+-rw-rw-rw-   0        0        0      717 2021-06-05 11:47:17.000000 evolutionary_forest-0.2.1/tests/test_evolutionary_forest.py
```

### Comparing `evolutionary_forest-0.2.0/CONTRIBUTING.rst` & `evolutionary_forest-0.2.1/CONTRIBUTING.rst`

 * *Files identical despite different names*

### Comparing `evolutionary_forest-0.2.0/LICENSE` & `evolutionary_forest-0.2.1/LICENSE`

 * *Files identical despite different names*

### Comparing `evolutionary_forest-0.2.0/PKG-INFO` & `evolutionary_forest-0.2.1/PKG-INFO`

 * *Files 2% similar despite different names*

```diff
@@ -1,17 +1,16 @@
 Metadata-Version: 2.1
 Name: evolutionary_forest
-Version: 0.2.0
+Version: 0.2.1
 Summary: An open source python library for automated feature engineering based on Genetic Programming
 Home-page: https://github.com/zhenlingcn/evolutionary_forest
 Author: Hengzhe Zhang
 Author-email: zhenlingcn@foxmail.com
 License: BSD license
 Keywords: evolutionary_forest
-Platform: UNKNOWN
 Classifier: Development Status :: 2 - Pre-Alpha
 Classifier: Intended Audience :: Developers
 Classifier: License :: OSI Approved :: BSD License
 Classifier: Natural Language :: English
 Classifier: Programming Language :: Python :: 3
 Classifier: Programming Language :: Python :: 3.6
 Classifier: Programming Language :: Python :: 3.7
@@ -134,9 +133,7 @@
 History
 =======
 
 0.1.0 (2021-05-22)
 ------------------
 
 * First release on PyPI.
-
-
```

### Comparing `evolutionary_forest-0.2.0/README.rst` & `evolutionary_forest-0.2.1/README.rst`

 * *Files identical despite different names*

### Comparing `evolutionary_forest-0.2.0/docs/Makefile` & `evolutionary_forest-0.2.1/docs/Makefile`

 * *Files identical despite different names*

### Comparing `evolutionary_forest-0.2.0/docs/conf.py` & `evolutionary_forest-0.2.1/docs/conf.py`

 * *Files identical despite different names*

### Comparing `evolutionary_forest-0.2.0/docs/constructed_features.png` & `evolutionary_forest-0.2.1/docs/constructed_features.png`

 * *Files identical despite different names*

### Comparing `evolutionary_forest-0.2.0/docs/installation.rst` & `evolutionary_forest-0.2.1/docs/installation.rst`

 * *Files identical despite different names*

### Comparing `evolutionary_forest-0.2.0/docs/make.bat` & `evolutionary_forest-0.2.1/docs/make.bat`

 * *Files identical despite different names*

### Comparing `evolutionary_forest-0.2.0/evolutionary_forest/component/archive.py` & `evolutionary_forest-0.2.1/evolutionary_forest/component/archive.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,21 +1,23 @@
+import copy
 import math
 import operator
 from collections import defaultdict
 from functools import partial
 from itertools import chain, compress
 from operator import eq
 
 import numpy as np
 from deap.tools import HallOfFame
 from sklearn.linear_model import RidgeCV, LinearRegression
 from sklearn.metrics import r2_score
 from sklearn.preprocessing import OneHotEncoder
 from sklearn.tree import DecisionTreeRegressor
 
+from evolutionary_forest.component.configuration import ArchiveConfiguration
 from evolutionary_forest.component.evaluation import quick_result_calculation
 from evolutionary_forest.component.primitives import individual_to_tuple
 from evolutionary_forest.component.subset_selection import EnsembleSelectionADE
 
 
 class StrictlyImprovementHOF(HallOfFame):
 
@@ -76,16 +78,15 @@
                 hofer_arr = np.concatenate([hofer_arr, np.array(-1 * hofer.case_values).reshape(1, -1)])
         max_hof = np.max(hofer_arr, axis=0)
 
         del_ind = []
         max_value = np.full_like(max_hof, -np.inf)
         for index, x in enumerate(self):
             fitness_wvalues = np.array(-1 * x.case_values)
-            if np.any(fitness_wvalues >= max_hof) \
-                and np.any(fitness_wvalues > max_value):
+            if np.any(fitness_wvalues >= max_hof) and np.any(fitness_wvalues > max_value):
                 loc = np.where(fitness_wvalues > max_value)
                 max_value[loc] = fitness_wvalues[loc]
                 continue
             # determine the deletion individual list
             del_ind.append(index)
 
         for i in reversed(del_ind):
@@ -158,15 +159,15 @@
         return (self.label - prediction) ** 2
 
     def cross_entropy(self, prediction):
         eps = 1e-15
         return -1 * self.label * np.log(np.clip(prediction, eps, 1 - eps))
 
     def zero_one(self, prediction):
-        return (np.argmax(self.label, axis=1) != np.argmax(prediction, axis=1))
+        return np.argmax(self.label, axis=1) != np.argmax(prediction, axis=1)
 
     def hinge_loss(self, prediction):
         return np.mean(np.clip(self.label - prediction, 0, None))
 
     def loss(self, prediction):
         # Both classification and regression use MSE as the ensemble selection metric
         # The reason is due to an additive model need to use MSE as the loss function
@@ -185,15 +186,15 @@
                 raise Exception
 
     def ensemble_selection(self, population):
         new_inds = []
         new_ind_tuples = defaultdict(int)
         instances_num = self.instances_num
         assert instances_num > 0
-        if self.categories == None:
+        if self.categories is None:
             # regression
             sum_prediction = np.zeros(instances_num)
         else:
             # classification
             sum_prediction = np.zeros((instances_num, self.categories))
 
         all_inds = population
@@ -235,15 +236,15 @@
                 if isinstance(self, GreedySelectionHallOfFame):
                     # calculate loss summation
                     if self.loss_function in ['ZeroOne', 'CrossEntropy', 'MSE']:
                         errors = [error_calculation(x) for x in all_inds]
                     else:
                         errors = [np.sum(x.case_values[:instances_num]) for x in all_inds]
                     # For multitask optimization, we may need to consider them respectively
-                    if self.multitask and all_inds[0].base_model != None:
+                    if self.multitask and all_inds[0].base_model is not None:
                         initial_individuals = self.initial_size * 2
                         args = np.argsort(errors)
                         all_base_models = {ind.base_model for ind in all_inds}
                         inds = []
                         for m in all_base_models:
                             inds.extend(list(filter(lambda id: all_inds[id].base_model == m, args))
                                         [:self.initial_size])
@@ -388,14 +389,33 @@
             self.r = r
             paradigm.append(self.ensemble_selection(population))
         # print([x[1] for x in paradigm])
         new_inds, _ = min(paradigm, key=lambda x: x[1])
         super(DREPHallOfFame, self).update(new_inds)
 
 
+class ValidationHallOfFame(HallOfFame):
+    def __init__(self, maxsize, validation_function, archive_configuration: ArchiveConfiguration,
+                 similar=eq):
+        # Currently, only supports size of one
+        self.validation_function = validation_function
+        self.archive_configuration = archive_configuration
+        assert maxsize == 1
+        super().__init__(maxsize, similar)
+
+    def update(self, population):
+        if self.archive_configuration.dynamic_validation and len(self) > 0:
+            # update the fitness of individuals in the hall of fame
+            self[0].fitness.values = (-1 * self.validation_function(self[0], force_training=True),)
+        best_individual = max(population, key=lambda x: x.fitness.wvalues)
+        best_individual = copy.deepcopy(best_individual)
+        best_individual.fitness.values = (-1 * self.validation_function(best_individual),)
+        super().update([best_individual])
+
+
 class NoveltyHallOfFame(EnsembleSelectionHallOfFame):
     pass
 
 
 class GreedySelectionHallOfFame(EnsembleSelectionHallOfFame):
     pass
```

### Comparing `evolutionary_forest-0.2.0/evolutionary_forest/component/evaluation.py` & `evolutionary_forest-0.2.1/evolutionary_forest/component/evaluation.py`

 * *Files 26% similar despite different names*

```diff
@@ -1,95 +1,142 @@
 import enum
 import random
 import time
-from typing import List
+from typing import List, Tuple
 
 import dill
 import numpy as np
 import shap
 from deap import base
 from deap import creator
 from deap import gp
 from deap import tools
 from deap.gp import PrimitiveTree, Primitive, Terminal
 from numpy.testing import assert_almost_equal
+from scipy.spatial.distance import cdist
+from scipy.stats import wilcoxon
 from sklearn import model_selection
 from sklearn.base import RegressorMixin, ClassifierMixin
 from sklearn.datasets import make_regression
 from sklearn.feature_selection import VarianceThreshold
 from sklearn.inspection import permutation_importance
 from sklearn.linear_model import RidgeCV, LogisticRegression
 from sklearn.linear_model._base import LinearModel
 from sklearn.metrics import make_scorer, accuracy_score, balanced_accuracy_score, precision_score, recall_score, \
     f1_score, r2_score
 from sklearn.model_selection import StratifiedKFold, cross_validate, train_test_split, KFold
 from sklearn.pipeline import Pipeline, FeatureUnion
 from sklearn.tree import BaseDecisionTree
 
-from evolutionary_forest.model.PLTree import SoftPLTreeRegressor, SoftPLTreeRegressorEM
-from evolutionary_forest.multigene_gp import result_post_process, MultiplePrimitiveSet, quick_fill
+from evolutionary_forest.component.configuration import EvaluationConfiguration, ImbalancedConfiguration
+from evolutionary_forest.multigene_gp import result_post_process, MultiplePrimitiveSet, quick_fill, GPPipeline
 from evolutionary_forest.sklearn_utils import cross_val_predict
 from evolutionary_forest.utils import reset_random
 
+np.seterr(invalid='ignore')
 reset_random(0)
+time_flag = False
+
+
+def select_from_array(arr, s, x):
+    s = s % len(arr)
+    if s + x <= len(arr):
+        return arr[s:s + x]
+    else:
+        return np.concatenate((arr[s:s + x], arr[:(s + x) % len(arr)]))
+
+
+class EvaluationResults():
+    def __init__(self,
+                 gp_evaluation_time=None,
+                 ml_evaluation_time=None,
+                 hash_result=None,
+                 correlation_results=None,
+                 introns_results=None,
+                 semantic_results=None,
+                 ):
+        self.gp_evaluation_time: int = gp_evaluation_time
+        self.ml_evaluation_time: int = ml_evaluation_time
+        # hash value of all features
+        self.hash_result: list = hash_result
+        # correlation of all features
+        self.correlation_results: list = correlation_results
+        # correlation of each node
+        self.introns_results: list = introns_results
+        # semantic of each features
+        self.semantic_results: list = semantic_results
 
 
 def calculate_score(args):
-    (X, Y, score_func, cv, other_parameters) = calculate_score.data
-    # nn_prediction: prediction results of the neural network
-    nn_prediction = other_parameters['nn_prediction']
-    # dynamic_target: random generate cross-validation scheme
-    dynamic_target = other_parameters['dynamic_target']
-    original_features = other_parameters['original_features']
-    # test_data_size: number of test data samples, which do not have the label
-    test_data_size = other_parameters['test_data_size']
-    pset = other_parameters['pset']
-    # sklearn_format: model is in sklearn format
-    sklearn_format = other_parameters['sklearn_format']
-    cross_validation = other_parameters['cross_validation']
-    feature_importance_method = other_parameters['feature_importance_method']
-    filter_elimination = other_parameters['filter_elimination']
+    (X, Y, score_func, cv, configuration) = calculate_score.data
+    configuration: EvaluationConfiguration
+    nn_prediction = configuration.nn_prediction
+    dynamic_target = configuration.dynamic_target
+    original_features = configuration.original_features
+    test_data_size = configuration.test_data_size
+    pset = configuration.pset
+    sklearn_format = configuration.sklearn_format
+    cross_validation = configuration.cross_validation
+    feature_importance_method = configuration.feature_importance_method
+    filter_elimination = configuration.filter_elimination
+    intron_calculation = configuration.intron_calculation
+    sample_weight = configuration.sample_weight
+
+    if configuration.mini_batch:
+        X = select_from_array(X, configuration.current_generation * configuration.batch_size // 4,
+                              configuration.batch_size)
+        Y = select_from_array(Y, configuration.current_generation * configuration.batch_size // 4,
+                              configuration.batch_size)
 
-    pipe: Pipeline
+    pipe: GPPipeline
     pipe, func = args
     if not isinstance(func, list):
         func = dill.loads(func)
 
-    # only used for PS-Tree
-    best_label = None
-    altered_labels = None
     # GP evaluation
     start_time = time.time()
-
+    semantic_results = None
     if sklearn_format:
         Yp = quick_result_calculation(func, pset, X, original_features, sklearn_format)
         pipe = pipe_combine(Yp, pipe)
         Yp = X
         hash_result = None
+        correlation_results = None
+        introns_results = None
     else:
+        results: EvaluationResults
         if hasattr(pipe, 'register'):
-            Yp, hash_result = quick_result_calculation(func, pset, X, original_features, need_hash=True,
-                                                       register_array=pipe.register)
+            Yp, results = quick_result_calculation(func, pset, X, original_features,
+                                                   need_hash=True, target=Y,
+                                                   register_array=pipe.register,
+                                                   configuration=configuration)
         else:
-            Yp, hash_result = quick_result_calculation(func, pset, X, original_features, need_hash=True)
+            Yp, results = quick_result_calculation(func, pset, X, original_features,
+                                                   need_hash=True, target=Y,
+                                                   configuration=configuration,
+                                                   similarity_score=intron_calculation)
+        hash_result, correlation_results, introns_results = results.hash_result, \
+            results.correlation_results, results.introns_results
+        if configuration.save_semantics:
+            semantic_results = Yp
         if nn_prediction is not None:
             Yp = np.concatenate([Yp, nn_prediction], axis=1)
         if test_data_size > 0:
             Yp = Yp[:-test_data_size]
         assert isinstance(Yp, np.ndarray)
         assert not np.any(np.isnan(Yp))
         assert not np.any(np.isinf(Yp))
 
         # only use for PS-Tree
         if hasattr(pipe, 'partition_scheme'):
             partition_scheme = pipe.partition_scheme
             assert not np.any(np.isnan(partition_scheme))
             assert not np.any(np.isinf(partition_scheme))
             Yp = np.concatenate([Yp, np.reshape(partition_scheme, (-1, 1))], axis=1)
-    if hasattr(pipe, 'active_gene'):
+    if hasattr(pipe, 'active_gene') and pipe.active_gene is not None:
         Yp = Yp[:, pipe.active_gene]
 
     gp_evaluation_time = time.time() - start_time
 
     # ML evaluation
     start_time = time.time()
     if 'CV' in score_func:
@@ -120,27 +167,53 @@
                                np.mean(result['test_precision']),
                                np.mean(result['test_recall']),
                                np.mean(result['test_f1'])])
         else:
             y_pred = result['test_score']
         estimators = result['estimator']
     elif not cross_validation:
+        # lasso = Pipeline([('Scaler', SafetyScaler()), ('Ridge', LassoCV(max_iter=10000))])
+        # lasso.fit(Yp, Y)
+        # lasso.predict(Yp)
+        # print(lasso['Ridge'].coef_)
         pipe.fit(Yp, Y)
         y_pred = pipe.predict(Yp)
         estimators = [pipe]
     else:
         if sklearn_format:
             base_model = pipe['model']['Ridge']
         else:
             base_model = pipe['Ridge']
         regression_task = isinstance(base_model, RegressorMixin)
         if isinstance(base_model, RidgeCV):
+            if time_flag:
+                cv_st = time.time()
+            else:
+                cv_st = 0
+
             # Ridge CV
-            pipe.fit(Yp, Y)
-            y_pred, estimators = base_model.cv_values_[:, np.argmax(base_model.cv_values_.sum(axis=0))], [pipe]
+            if sample_weight is not None:
+                pipe.fit(Yp, Y, Ridge__sample_weight=sample_weight)
+            else:
+                pipe.fit(Yp, Y)
+
+            if time_flag:
+                print('Cross Validation Time', time.time() - cv_st)
+
+            """
+            Potential Impacts:
+            Given an incorrect best index
+            """
+            # old_best_index = np.argmax(base_model.cv_values_.sum(axis=0))
+            all_y_pred = (base_model.cv_values_ + Y.mean())
+            # r2_score(Y, base_model.cv_values_[:, new_best_index] + Y.mean())
+            error_list = ((Y.reshape(-1, 1) - all_y_pred) ** 2).sum(axis=0)
+            new_best_index = np.argmin(error_list)
+            y_pred, estimators = base_model.cv_values_[:, new_best_index], [pipe]
+            y_pred += Y.mean()
         elif cv == 1:
             # single fold training (not recommend)
             indices = np.arange(len(Y))
             x_train, x_test, y_train, y_test, idx_train, idx_test = train_test_split(
                 Yp, Y, indices, test_size=0.2)
             estimators = [pipe]
             pipe.fit(x_train, y_train)
@@ -149,15 +222,15 @@
         else:
             # cross-validation
             if dynamic_target:
                 cv = get_cv_splitter(base_model, cv, random.randint(0, int(1e9)))
             else:
                 cv = get_cv_splitter(base_model, cv)
 
-            if filter_elimination is not None:
+            if filter_elimination is not None and filter_elimination is not False:
                 strategies = set(filter_elimination.split(','))
                 mask = np.ones(X.shape[1], dtype=bool)
                 if 'Variance' in strategies:
                     # eliminate features based on variance
                     threshold = VarianceThreshold(threshold=0.01)
                     threshold.fit(Yp)
                     indices = threshold.get_support(indices=True)
@@ -171,19 +244,27 @@
                             if abs(corr_matrix[i, j]) > threshold:
                                 # highly correlated features
                                 col_corr.append(i)
                                 break
                     mask[col_corr] = False
                 Yp = Yp[:, mask]
 
+            if time_flag:
+                cv_st = time.time()
+            else:
+                cv_st = 0
+
             if regression_task:
                 y_pred, estimators = cross_val_predict(pipe, Yp, Y, cv=cv)
             else:
                 y_pred, estimators = cross_val_predict(pipe, Yp, Y, cv=cv, method='predict_proba')
 
+            if time_flag:
+                print('Cross Validation Time', time.time() - cv_st)
+
             if feature_importance_method == 'SHAP' and len(estimators) == cv.n_splits:
                 for id, estimator in enumerate(estimators):
                     split_fold = list(cv.split(Yp, Y))
                     train_id, test_id = split_fold[id][0], split_fold[id][1]
                     if isinstance(estimator['Ridge'], (LinearModel, LogisticRegression)):
                         explainer = shap.LinearExplainer(estimator['Ridge'], Yp[train_id])
                     elif isinstance(estimator['Ridge'], BaseDecisionTree):
@@ -200,51 +281,112 @@
                 # Don't need to calculate the mean value here
                 for id, estimator in enumerate(estimators):
                     split_fold = list(cv.split(Yp, Y))
                     train_id, test_id = split_fold[id][0], split_fold[id][1]
                     r = permutation_importance(estimator['Ridge'], Yp[test_id], Y[test_id], n_jobs=1, n_repeats=1)
                     estimator['Ridge'].pi_values = np.abs(r.importances_mean)
 
+            # calculate_permutation_importance(estimators, Yp, Y)
+
             if np.any(np.isnan(y_pred)):
                 np.save('error_data_x.npy', Yp)
                 np.save('error_data_y.npy', Y)
                 raise Exception
-
-            if isinstance(base_model, SoftPLTreeRegressor) and not isinstance(base_model, SoftPLTreeRegressorEM):
-                # determine the best partition scheme
-                cv_label = other_parameters['cv_label']
-                if cv_label:
-                    best_label = np.zeros(len(Y))
-                else:
-                    partition_num = len(np.unique(pipe.partition_scheme))
-                    best_label = np.zeros((len(Y), partition_num))
-                for index, estimator in zip(cv.split(Y), estimators):
-                    estimator: SoftPLTreeRegressor
-                    if cv_label:
-                        # determine the label of PS-Tree through cross-validation
-                        train_index, test_index = index
-                        X_test, y_test = Yp[test_index], Y[test_index]
-                        best_label[test_index] = estimator.score(X_test, np.reshape(y_test, (-1, 1)))
-                    else:
-                        train_index, test_index = index
-                        score = estimator.score(Yp[train_index], np.reshape(Y[train_index], (-1, 1)))
-                        best_label[train_index, score] += 1
-                if not cv_label:
-                    best_label = np.argmax(best_label, axis=1)
-                altered_labels = np.sum(pipe.partition_scheme != best_label)
     ml_evaluation_time = time.time() - start_time
-    if altered_labels is not None:
-        print('altered_labels', altered_labels)
-    return y_pred, estimators, {
-        'gp_evaluation_time': gp_evaluation_time,
-        'ml_evaluation_time': ml_evaluation_time,
-        'best_label': best_label,
-        'altered_labels': altered_labels,
-        'hash_result': hash_result,
-    }
+    return y_pred, estimators, EvaluationResults(gp_evaluation_time=gp_evaluation_time,
+                                                 ml_evaluation_time=ml_evaluation_time,
+                                                 hash_result=hash_result,
+                                                 correlation_results=correlation_results,
+                                                 introns_results=introns_results,
+                                                 semantic_results=semantic_results)
+
+
+def calculate_permutation_importance(estimators, Yp, Y):
+    if not hasattr(estimators[0]['Ridge'], 'coef_') \
+        and not hasattr(estimators[0]['Ridge'], 'feature_importances_') \
+        and not hasattr(estimators[0]['Ridge'], 'feature_importance'):
+        if time_flag:
+            permutation_st = time.time()
+        else:
+            permutation_st = 0
+
+        for id, estimator in enumerate(estimators):
+            knn = estimator
+            X_test, y_test = Yp, Y
+            baseline_score = knn.score(X_test, y_test)
+            importances = []
+            for i in range(X_test.shape[1]):
+                X_drop = X_test.copy()
+                X_drop[:, i] = np.mean(X_drop[:, i])
+                score = knn.score(X_drop, y_test)
+                importances.append(baseline_score - score)
+            feature_importances_ = np.array(importances)
+
+            # importance_values = permutation_importance(estimator, Yp, Y, random_state=0)
+            # feature_importances_ = importance_values.importances_mean
+            if np.any(feature_importances_ < 0):
+                feature_importances_ = feature_importances_ - feature_importances_.min()
+            estimator['Ridge'].feature_importances_ = feature_importances_ / feature_importances_.sum()
+
+        if time_flag:
+            print('Permutation Cost', time.time() - permutation_st)
+
+
+def statistical_best_alpha(base_model, Y, new_best_index):
+    # new_best_index = statistical_best_alpha(base_model, Y, new_best_index)
+    all_y_pred = (base_model.cv_values_ + Y.mean())
+    # get all error values
+    errors = (Y.reshape(-1, 1) - all_y_pred) ** 2
+    b_idx = None
+    for idx in range(new_best_index + 1, errors.shape[1]):
+        # singed rank test
+        if wilcoxon(errors[:, new_best_index], errors[:, idx])[1] > 0.05:
+            b_idx = idx
+    if b_idx is not None:
+        new_best_index = b_idx
+    return new_best_index
+
+
+def rbf_kernel_on_label(X, gamma):
+    # Compute pairwise squared Euclidean distances
+    distances_sq = cdist(X.reshape(-1, 1), X.reshape(-1, 1), 'sqeuclidean')
+    # Compute RBF kernel
+    K = np.exp(-gamma * distances_sq)
+    return K
+
+
+def get_sample_weight(X, testX, Y, imbalanced_configuration: ImbalancedConfiguration):
+    """
+    When calculating the distance with test data, larger means more important.
+    When calculating the distance with training data, larger is more important.
+    :return:
+    """
+    # return None
+    # Calculate the pairwise Euclidean distance
+    X_space = imbalanced_configuration.weight_on_x_space
+    based_on_test = imbalanced_configuration.based_on_test
+    if X_space:
+        if based_on_test:
+            D = np.sqrt(np.sum((X[:, np.newaxis, :] - testX[np.newaxis, :, :]) ** 2, axis=-1))
+        else:
+            X = np.concatenate([X, Y.reshape(-1, 1)], axis=1)
+            D = np.sqrt(np.sum((X[:, np.newaxis, :] - X[np.newaxis, :, :]) ** 2, axis=-1))
+        # Set the gamma hyperparameter
+        gamma = 1 / X.shape[1]
+        # Calculate the RBF kernel matrix
+        K = np.exp(-gamma * D ** 2)
+    else:
+        K = rbf_kernel_on_label(Y, 0.1)
+
+    if not based_on_test or not X_space:
+        K = np.sum(-np.sort(-K, axis=1)[:, :5], axis=1)
+        K = 1 / K
+    else:
+        K = np.sum(-np.sort(-K, axis=1)[:, :5], axis=1)
+    return K
 
 
 def pipe_combine(Yp, pipe):
     Yp = list(filter(lambda x: not isinstance(x, (int, float, np.ndarray, enum.Enum)), Yp))
     if len(Yp) == 0:
         pipe = Pipeline([
             ("feature", "passthrough"),
@@ -292,84 +434,162 @@
         cv = StratifiedKFold(n_splits=cv, shuffle=True, random_state=random_state)
     else:
         cv = KFold(n_splits=cv, shuffle=True, random_state=random_state)
     return cv
 
 
 def quick_result_calculation(func: List[PrimitiveTree], pset, data, original_features=False,
-                             sklearn_format=False, need_hash=False, register_array=None):
+                             sklearn_format=False, need_hash=False, register_array=None,
+                             target=None, configuration: EvaluationConfiguration = None,
+                             similarity_score=False):
+    if configuration is None:
+        configuration = EvaluationConfiguration()
+    intron_gp = configuration.intron_gp
+    lsh = configuration.lsh
+    # evaluate an individual rather than a gene
     if sklearn_format:
         data = enum.Enum('Enum', {f"ARG{i}": i for i in range(data.shape[1])})
     # quick evaluate the result of features
     result = []
     hash_result = []
+    correlation_results = []
+    introns_results = []
     if hasattr(pset, 'number_of_register'):
+        # This part is useful for modular GP with registers
         register = np.ones((data.shape[0], pset.number_of_register))
         for id, gene in enumerate(func):
             input_data = np.concatenate([data, register], axis=1)
             quick_result = quick_evaluate(gene, pset, input_data)
             quick_result = quick_fill([quick_result], data)[0]
             if isinstance(quick_result, np.ndarray):
                 hash_result.append(hash(quick_result.tostring()))
             else:
                 hash_result.append(hash(str(quick_result)))
             register[:, register_array[id]] = quick_result
         result = register.T
     elif isinstance(pset, MultiplePrimitiveSet):
+        # Modular GP
         for id, gene in enumerate(func):
             quick_result = quick_evaluate(gene, pset.pset_list[id], data)
             quick_result = quick_fill([quick_result], data)[0]
-            if isinstance(quick_result, np.ndarray):
-                hash_result.append(hash(quick_result.tostring()))
-            else:
-                hash_result.append(hash(str(quick_result)))
+            add_hash_value(quick_result, hash_result)
+            if target is not None:
+                correlation_results.append(np.abs(cos_sim(target - target.mean(), quick_result - quick_result.mean())))
             result.append(quick_result)
             data = np.concatenate([data, np.reshape(quick_result, (-1, 1))], axis=1)
     else:
+        # ordinary GP evaluation
         for gene in func:
-            feature: np.ndarray = quick_evaluate(gene, pset, data)
-            if isinstance(feature, np.ndarray):
-                hash_result.append(hash(feature.tostring()))
-            else:
-                hash_result.append(hash(str(feature)))
+            feature, intron_ids = quick_evaluate(gene, pset, data, target=target if similarity_score else None,
+                                                 intron_gp=intron_gp, lsh=lsh,
+                                                 return_subtree_information=True)
+            introns_results.append(intron_ids)
+            simple_feature = quick_fill([feature], data)[0]
+            add_hash_value(simple_feature, hash_result)
+            if target is not None:
+                correlation_results.append(np.abs(cos_sim(target - target.mean(),
+                                                          simple_feature - simple_feature.mean())))
             result.append(feature)
     if not sklearn_format:
         result = result_post_process(result, data, original_features)
         # result = np.reshape(result[:, -1], (-1, 1))
     if not need_hash:
         return result
     else:
-        return result, hash_result
+        return result, EvaluationResults(hash_result=hash_result,
+                                         correlation_results=correlation_results,
+                                         introns_results=introns_results)
 
 
-def quick_evaluate(expr: PrimitiveTree, pset, data, prefix='ARG'):
+def add_hash_value(quick_result, hash_result):
+    if quick_result.var() != 0:
+        hash_value = quick_result - quick_result.mean() / quick_result.var()
+    else:
+        hash_value = quick_result - quick_result.mean()
+    if isinstance(quick_result, np.ndarray):
+        hash_result.append(hash(hash_value.tostring()))
+    else:
+        hash_result.append(hash(str(hash_value)))
+
+
+cos_sim = lambda a, b: np.dot(a, b) / (np.linalg.norm(a) * np.linalg.norm(b))
+
+
+def quick_evaluate(expr: PrimitiveTree, pset, data, prefix='ARG', target=None,
+                   intron_gp=False, lsh=False, return_subtree_information=False) -> Tuple[np.ndarray, dict]:
+    # quickly evaluate a primitive tree
+    if lsh:
+        rng = np.random.RandomState(0)
+        if lsh == 'Log':
+            random_matrix = rng.randn(len(data), int(np.ceil(np.log2(len(data)))))
+        elif not isinstance(lsh, bool) and isinstance(lsh, int):
+            random_matrix = rng.randn(len(data), int(lsh))
+        else:
+            random_matrix = rng.randn(len(data), 10)
     result = None
     stack = []
-    for node in expr:
-        stack.append((node, []))
+    subtree_information = {}
+    best_score = None
+    # save the semantics of the best subtree
+    best_subtree_semantics = None
+    for id, node in enumerate(expr):
+        stack.append((node, [], id))
         while len(stack[-1][1]) == stack[-1][0].arity:
-            prim, args = stack.pop()
+            prim, args, id = stack.pop()
+            equivalent_subtree = -1
             if isinstance(prim, Primitive):
                 result = pset.context[prim.name](*args)
+                if target is not None:
+                    for arg_id, a in enumerate(args):
+                        if np.array_equal(result, a):
+                            equivalent_subtree = arg_id
             elif isinstance(prim, Terminal):
                 if prefix in prim.name:
                     if isinstance(data, np.ndarray):
                         result = data[:, int(prim.name.replace(prefix, ''))]
                     elif isinstance(data, (dict, enum.EnumMeta)):
                         result = data[prim.name]
                     else:
                         raise ValueError("Unsupported data type!")
                 else:
-                    result = prim.value
+                    result = float(prim.name)
             else:
                 raise Exception
+            if target is not None:
+                if len(np.unique(result)) == 1:
+                    # If this primitive outputs constant, this can be viewed as an intron
+                    subtree_information[id] = -1
+                else:
+                    subtree_information[id] = np.abs(cos_sim(result - result.mean(), target - target.mean()))
+                    if lsh:
+                        # locality sensitive hash
+                        hash_id = 0
+                        final_sign = (result - result.mean()) @ random_matrix
+                        for s_id, s in enumerate(final_sign):
+                            if s > 0:
+                                hash_id += 1 << s_id
+                        subtree_information[id] = (subtree_information[id], hash_id)
+                    if best_subtree_semantics is None or best_score < subtree_information[id]:
+                        best_score = subtree_information[id]
+                        best_subtree_semantics = result
+                    if equivalent_subtree >= 0:
+                        # check whether a subtree is equal to its parent
+                        subtree_information[id] = (subtree_information[id], equivalent_subtree, '')
             if len(stack) == 0:
                 break  # If stack is empty, all nodes should have been seen
             stack[-1][1].append(result)
-    return result
+    if len(subtree_information) > 0:
+        assert len(subtree_information) == len(expr)
+    if intron_gp:
+        return best_subtree_semantics, subtree_information
+    else:
+        if return_subtree_information:
+            return result, subtree_information
+        else:
+            return result
 
 
 def minimal_task():
     # A minimal task for SR
     x, y = make_regression(n_samples=1000)
     pset = gp.PrimitiveSet("MAIN", x.shape[1])
     pset.addPrimitive(np.add, 2, name="vadd")
```

### Comparing `evolutionary_forest-0.2.0/evolutionary_forest/component/mutation_transformer.py` & `evolutionary_forest-0.2.1/evolutionary_forest/component/mutation_transformer.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,25 +1,22 @@
 import random
 
-from sklearn.datasets import load_boston, load_diabetes
-from torch.utils.tensorboard import SummaryWriter
-
 import numpy as np
 import torch
-import math
 from deap import gp, base
 from scipy.stats import pearsonr
-from sklearn.preprocessing import LabelEncoder, MinMaxScaler, StandardScaler
-from torch import nn, Tensor
+from sklearn.datasets import load_diabetes
+from sklearn.preprocessing import LabelEncoder, StandardScaler
+from torch import nn
 from torch.nn.utils.rnn import pad_sequence
+from torch.utils.tensorboard import SummaryWriter
 
 from evolutionary_forest.component.evaluation import quick_evaluate
 from evolutionary_forest.component.primitives import analytical_quotient
 from evolutionary_forest.utils import reset_random
-from experiment.experiment_dataset import get_dataset
 
 device = 'cuda' if torch.cuda.is_available() else 'cpu'
 
 reset_random(0)
 
 
 class MutationTransformer(nn.Module):
@@ -324,15 +321,15 @@
         else:
             pass
     print('Useful Training Data', len(training_data))
     return training_data
 
 
 def get_dataset_simple():
-    X, y = load_boston(return_X_y=True)
+    X, y = load_diabetes(return_X_y=True)
     # X, y, _ = get_dataset({
     #     'dataset': '604_fri_c4_500_10'
     # })
     # X, y = load_diabetes(return_X_y=True)
     X, y = np.array(X), np.array(y)
     X = StandardScaler().fit_transform(X)
     y = StandardScaler().fit_transform(y.reshape(-1, 1)).flatten()
```

### Comparing `evolutionary_forest-0.2.0/evolutionary_forest/component/primitives.py` & `evolutionary_forest-0.2.1/evolutionary_forest/component/primitives.py`

 * *Files 5% similar despite different names*

```diff
@@ -25,16 +25,24 @@
 
 
 def protect_loge(x1):
     with np.errstate(divide='ignore', invalid='ignore'):
         return np.where(np.abs(x1) > threshold, np.log(np.abs(x1)), 0.)
 
 
-def analytical_loge(x):
-    return np.log(np.abs(x) + 1)
+def analytical_log(x):
+    return np.log(np.sqrt(1 + x ** 2))
+
+
+def analytical_log10(x):
+    return np.log10(np.sqrt(1 + x ** 2))
+
+
+def cube(x):
+    return np.power(x, 3)
 
 
 def protect_sqrt(a):
     return np.sqrt(np.abs(a))
 
 
 def shape_wrapper(x1, x2):
@@ -201,22 +209,26 @@
 
 
 def cross_feature(x1, x2):
     vf = np.vectorize(hash)
     return vf(x1) + vf(x2)
 
 
-def leaky_relu(arr):
-    return np.maximum(0.1 * arr, arr)
+def leaky_relu(x, alpha=0.01):
+    return np.where(x > 0, x, alpha * x)
 
 
 def sigmoid(x):
     return 1 / (1 + np.exp(-x))
 
 
+def residual(x):
+    return x - np.round(x)
+
+
 def np_mean(a, b):
     return np.mean([a, b], axis=0)
 
 
 def greater_or_equal_than(a, b):
     return np.where(a >= b, 1, 0)
 
@@ -298,15 +310,15 @@
     # Basic features
     """
     
     
     
     """
     pset.addPrimitive(protect_sqrt, 1)
-    pset.addPrimitive(analytical_loge, 1)
+    pset.addPrimitive(analytical_log, 1)
     pset.addPrimitive(np.sin, 1)
     pset.addPrimitive(np.cos, 1)
     pset.addPrimitive(np.maximum, 2)
     pset.addPrimitive(np.minimum, 2)
 
     # GroupBy features
     """
@@ -349,8 +361,8 @@
         st = time.time()
         result = g(a, b)
         print(result)
         print('time', time.time() - st)
 
 
 if __name__ == '__main__':
-    groupby_operator_speed_test()
+    pass
```

### Comparing `evolutionary_forest-0.2.0/evolutionary_forest/component/selection.py` & `evolutionary_forest-0.2.1/evolutionary_forest/component/selection.py`

 * *Files 7% similar despite different names*

```diff
@@ -1,18 +1,21 @@
 import copy
 import random
 from operator import attrgetter
+from pathlib import Path
 from types import SimpleNamespace
 import math
 import numpy as np
+import pandas as pd
 import seaborn as sns
 from deap.tools import selRandom, selTournament
 from matplotlib import pyplot as plt
 from numba import njit
 from numpy.linalg import LinAlgError
+from scipy.stats import wilcoxon
 from sklearn.cluster import KMeans
 from sklearn.decomposition import PCA, KernelPCA
 from sklearn.manifold import Isomap, LocallyLinearEmbedding, TSNE, SpectralEmbedding
 from sklearn.metrics.pairwise import cosine_similarity
 from sklearn.pipeline import Pipeline
 from sklearn.preprocessing import StandardScaler
 from skorch.callbacks import EarlyStopping
@@ -20,14 +23,29 @@
 from torch.nn import MSELoss
 from umap import UMAP
 from evolutionary_forest.model.VAE import NeuralNetTransformer, VAE
 from evolutionary_forest.multigene_gp import MultipleGeneGP
 from evolutionary_forest.utils import efficient_deepcopy
 
 
+class SelectionConfiguration():
+    def __init__(self, tournament_warmup_round=10, **params):
+        self.tournament_warmup_round = tournament_warmup_round
+        self.current_gen = 0
+
+
+def tournament_lexicase_selection(individuals, k, configuration: SelectionConfiguration):
+    # tournament as first several stages
+    if configuration.tournament_warmup_round:
+        offspring = selTournament(individuals, k, tournsize=7)
+    else:
+        offspring = selAutomaticEpsilonLexicaseFast(individuals, k)
+    return offspring
+
+
 # @njit(cache=True)
 def batch_tournament_selection(individuals, k, tournsize=8, batch_size=8, fit_attr="fitness"):
     fitness_cases_num = len(individuals[0].case_values)
     idx_cases_batch = np.arange(0, fitness_cases_num)
     np.random.shuffle(idx_cases_batch)
     _batches = np.array_split(idx_cases_batch, max(fitness_cases_num // batch_size, 1))
     batch_ids = list(range(0, len(_batches)))
@@ -72,14 +90,40 @@
                 candidates = list([x for x in candidates if case_values[x][cases[0]] <= max_val_to_survive])
             cases = np.delete(cases, 0)
         avg_cases = (avg_cases * i + (len(case_values[0]) - len(cases))) / (i + 1)
         selected_individuals.append(np.random.choice(np.array(candidates)))
     return selected_individuals, avg_cases
 
 
+def selLexicographicParsimonyPressure(individuals, k):
+    individuals = list(sorted(individuals, key=lambda x: x.fitness.wvalues))
+    selected = []
+    r = 1 / 2
+    for i in range(k):
+        indices = [i for i in range(len(individuals))]
+        rank = np.zeros(len(individuals))
+        ix = 0
+        cnt_rank = 0
+        while ix < len(individuals):
+            cnt = math.ceil(len(individuals) * r)
+            rank[ix:ix + cnt] = cnt_rank
+            ix += cnt
+            r /= 2
+            cnt_rank += 1
+        a, b = selRandom(indices, 2)
+        if rank[a] == rank[b] and len(individuals[a]) == len(individuals[b]):
+            best_index = random.choice([a, b])
+        elif rank[a] == rank[b]:
+            best_index = min([a, b], key=lambda x: len(individuals[x]))
+        else:
+            best_index = max([a, b], key=lambda x: rank[x])
+        selected.append(individuals[best_index])
+    return selected
+
+
 # @timeit
 def selAutomaticEpsilonLexicaseFast(individuals, k, return_avg_cases=False):
     fit_weights = individuals[0].fitness.weights[0]
     case_values = np.array([ind.case_values for ind in individuals])
     index, avg_cases = selAutomaticEpsilonLexicaseNumba(case_values, fit_weights, k)
     selected_individuals = [individuals[i] for i in index]
     if return_avg_cases:
@@ -318,44 +362,49 @@
                  data_augmentation=0):
     """
     """
     fitness_ratio = map_elite_parameter.get('fitness_ratio', 0.2)
     map_size = map_elite_parameter.get('map_size', 10)
     pca_dimension = map_elite_parameter.get('pca_dimension', 2)
     reduction_method = map_elite_parameter.get('reduction_method', 'PCA')
+    both_real_and_synthetic = map_elite_parameter.get('both_real_and_synthetic', False)
+    plot_function = map_elite_parameter.get('plot_function', None)
 
     plot = False
     individuals = individuals + list(old_map.values())
     individuals = list({tuple(x.predicted_values): x for x in individuals}.values())
     mean_fitness = np.quantile([ind.fitness.wvalues[0] for ind in individuals], fitness_ratio)
     # update a MAP
-    map_dict = {}
-    case_values = np.array([ind.predicted_values for ind in individuals])
-    semantic_matrix = case_values
+    elites_dict = {}
+    behavior_space = np.array([ind.predicted_values for ind in individuals])
+    # extract behavior of all good individuals
     well_individuals = [ind for ind in filter(lambda x: x.fitness.wvalues[0] >= mean_fitness, individuals)]
     if data_augmentation > 0:
-        original_data = np.array([ind.predicted_values for ind in well_individuals])
-        well_individual_values = np.concatenate([
-            (1 - data_augmentation) * original_data + data_augmentation * target,
-            (data_augmentation - 1) * original_data + (2 - data_augmentation) * target,
+        original_semantic_space = np.array([ind.predicted_values for ind in well_individuals])
+        synthetic_semantic_space = np.concatenate([
+            (1 - data_augmentation) * original_semantic_space + data_augmentation * target,
+            (data_augmentation - 1) * original_semantic_space + (2 - data_augmentation) * target,
         ], axis=0)
     else:
-        well_individual_values = np.array([ind.predicted_values for ind in well_individuals])
+        original_semantic_space = None
+        synthetic_semantic_space = np.array([ind.predicted_values for ind in well_individuals])
 
-    semantic_matrix -= target
-    well_individual_values -= target
-    scaler = StandardScaler(with_mean=False).fit(well_individual_values)
-    semantic_matrix = scaler.transform(semantic_matrix)
-    well_individual_values = scaler.transform(well_individual_values)
+    behavior_space -= target
+    synthetic_semantic_space -= target
+    scaler = StandardScaler(with_mean=False)
+    scaler.fit(synthetic_semantic_space)
+    behavior_space = scaler.transform(behavior_space)
+    synthetic_semantic_space = scaler.transform(synthetic_semantic_space)
     if data_augmentation > 0:
-        original_data -= target
-        original_data = scaler.transform(original_data)
+        # transform augmented data
+        original_semantic_space -= target
+        original_semantic_space = scaler.transform(original_semantic_space)
 
     def common_tsne(metric='euclidean', init='pca'):
-        return TSNE(n_components=pca_dimension, perplexity=30 if len(well_individual_values) >= 50 else 5,
+        return TSNE(n_components=pca_dimension, perplexity=30 if len(synthetic_semantic_space) >= 50 else 5,
                     metric=metric, init=init)
 
     try:
         if reduction_method == 'PCA':
             pca = PCA(n_components=pca_dimension)
         elif reduction_method == 'KPCA(POLY)':
             pca = KernelPCA(n_components=pca_dimension, kernel='poly')
@@ -391,22 +440,22 @@
             pca = UMAP(n_components=pca_dimension)
         elif reduction_method == 'SpectralEmbedding':
             pca = SpectralEmbedding(n_components=pca_dimension)
         elif reduction_method == 'Beta-VAE':
             pca = NeuralNetTransformer(VAE,
                                        criterion=MSELoss(),
                                        optimizer=optim.Adam,
-                                       module__input_unit=semantic_matrix.shape[1],
+                                       module__input_unit=behavior_space.shape[1],
                                        max_epochs=2000,
                                        callbacks=[EarlyStopping(patience=50)],
                                        verbose=False)
         else:
             print('Unsupported method', reduction_method)
             raise Exception
-        pca.fit(well_individual_values.astype(np.float32))
+        pca.fit(synthetic_semantic_space.astype(np.float32))
     except Exception as e:
         if reduction_method == 'PCA':
             pca = PCA(n_components=pca_dimension, svd_solver='randomized')
         elif reduction_method == 'PCA-TSNE':
             pca = Pipeline([('PCA-Preprocess', PCA(0.99, svd_solver='randomized')),
                             ('PCA', common_tsne(init='random'))])
         elif reduction_method == 'KPCA(COSINE)+TSNE':
@@ -421,68 +470,76 @@
                                          method='modified')
         elif reduction_method == 'HLLE':
             pca = LocallyLinearEmbedding(eigen_solver='dense', n_neighbors=10, n_components=pca_dimension,
                                          method='hessian')
         elif reduction_method == 'LTSA':
             pca = LocallyLinearEmbedding(eigen_solver='dense', n_components=pca_dimension, method='ltsa')
         elif reduction_method == 'TSNE':
-            pca = TSNE(n_components=pca_dimension, perplexity=30 if len(well_individual_values) >= 50 else 5,
+            pca = TSNE(n_components=pca_dimension, perplexity=30 if len(synthetic_semantic_space) >= 50 else 5,
                        init='random')
         else:
             print('Unsupported reduction algorithm', reduction_method)
             raise e
-        pca.fit(well_individual_values.astype(np.float32))
+        pca.fit(synthetic_semantic_space.astype(np.float32))
     if (isinstance(pca, Pipeline) and pca._can_transform()) or \
         (not isinstance(pca, Pipeline) and hasattr(pca, 'transform')):
         if data_augmentation > 0:
-            semantic_matrix = pca.transform(original_data.astype(np.float32))
+            # Only transform original data. It means discretization is on original data.
+            # Here, one question exist, should we transform on original data.
+            # If we transform on original data, we will definitely get mismatch distribution.
+            if both_real_and_synthetic:
+                # this is to test whether to use synthetic data in discretization
+                behavior_space = pca.transform(synthetic_semantic_space.astype(np.float32))
+            else:
+                # this is to validate the situation of mismatch distribution
+                behavior_space = pca.transform(original_semantic_space.astype(np.float32))
         else:
-            semantic_matrix = pca.transform(well_individual_values.astype(np.float32))
+            # If no synthetic data, can directly perform on synthetic space.
+            behavior_space = pca.transform(synthetic_semantic_space.astype(np.float32))
     else:
+        # One problem here is that get all data will have an influence on discretization. Be Careful!
         if isinstance(pca, Pipeline):
-            semantic_matrix = np.copy(pca[-1].embedding_)
+            behavior_space = np.copy(pca[-1].embedding_)
         else:
-            semantic_matrix = np.copy(pca.embedding_)
-    semantic_matrix = semantic_matrix[:, :pca_dimension + 1]
-
-    for id in range(semantic_matrix.shape[1]):
-        bins = np.linspace(semantic_matrix[:, id].min(), semantic_matrix[:, id].max(), map_size + 1)
-        semantic_matrix[:, id] = np.digitize(semantic_matrix[:, id], bins)
-        data = semantic_matrix[:, id]
+            # Get embedding directly
+            behavior_space = np.copy(pca.embedding_)
+    behavior_space = behavior_space[:, :pca_dimension + 1]
+    # behavior space before discretization
+    original_behavior_space = np.copy(behavior_space)
+
+    # discretize behavior space
+    for id in range(behavior_space.shape[1]):
+        bins = np.linspace(behavior_space[:, id].min(), behavior_space[:, id].max(), map_size + 1)
+        behavior_space[:, id] = np.digitize(behavior_space[:, id], bins)
+        data = behavior_space[:, id]
         # for the boundary, it should belong to the boundary class
         data[data == map_size + 1] = map_size
         assert np.all(data <= map_size)
 
-    # pool = individuals if pca._can_transform() else well_individuals
+    # save good individuals
     pool = well_individuals
+    elites_behavior_dict = {}
     for id in range(len(pool)):
-        case = tuple(int(x) for x in semantic_matrix[id])
-        if case not in map_dict:
-            map_dict[case] = pool[id]
-        elif pool[id].fitness.wvalues >= map_dict[case].fitness.wvalues:
-            map_dict[case] = pool[id]
-
-    if plot:
-        if (isinstance(pca, Pipeline) and pca._can_transform()) or \
-            (not isinstance(pca, Pipeline) and hasattr(pca, 'transform')):
-            plot_matrix = pca.transform(well_individual_values)
-        else:
-            plot_matrix = pca['PCA'].embedding_
-        plt.scatter(plot_matrix[:-1, 0], plot_matrix[:-1, 1])
-        plt.scatter(plot_matrix[-1, 0], plot_matrix[-1, 1],
-                    marker="*", c='red')
-        plt.show()
-
+        case = tuple(int(x) for x in behavior_space[id])
+        if case not in elites_dict:
+            elites_dict[case] = pool[id]
+            elites_behavior_dict[case] = original_behavior_space[id]
+        elif pool[id].fitness.wvalues >= elites_dict[case].fitness.wvalues:
+            elites_dict[case] = pool[id]
+            elites_behavior_dict[case] = original_behavior_space[id]
+    if plot_function is not None:
+        plot_function(reduction_method, original_behavior_space, well_individuals,
+                      elites_dict, elites_behavior_dict)
     if plot:
         map_value = np.zeros((map_size, map_size))
-        for k, v in map_dict.items():
+        for k, v in elites_dict.items():
             map_value[int(k[0]) - 1][int(k[1]) - 1] = v.fitness.wvalues[0]
         sns.heatmap(map_value, linewidth=0.5)
         plt.show()
-    return map_dict
+    return elites_dict
 
 
 def selMaxAngleSelection(individuals: list, k, target: np.ndarray, unique=False):
     """
     A variant of ADS in Qi Chen's paper
     :param individuals: Individuals from the current population
     :param k: Number of individuals to be selected
@@ -649,14 +706,36 @@
             if len(c) < k:
                 break
             candidates = c
         cases.pop(0)
     return random.sample(candidates, k)
 
 
+def selStatisticsTournament(individuals, k, tournsize):
+    """
+    :param individuals: population
+    :param k: number of offspring
+    :param tournsize: tournament size
+    """
+    chosen = []
+    for i in range(k):
+        a = random.choice(individuals)
+        for _ in range(tournsize):
+            b = random.choice(individuals)
+            if np.all(np.equal(a.case_values, b.case_values)):
+                continue
+            p_value = wilcoxon(a.case_values, b.case_values).pvalue
+            if p_value < 0.05:
+                a = max([a, b], key=lambda x: x.fitness.wvalues)
+            else:
+                a = min([a, b], key=lambda x: len(x))
+        chosen.append(a)
+    return chosen
+
+
 def selTournamentPlus(individuals, k, tournsize):
     """
     Select individuals based on the sum of case values
     :param individuals: population
     :param k: number of offspring
     :param tournsize: tournament size
     :return:
```

### Comparing `evolutionary_forest-0.2.0/evolutionary_forest/component/stateful_gp.py` & `evolutionary_forest-0.2.1/evolutionary_forest/component/stateful_gp.py`

 * *Files identical despite different names*

### Comparing `evolutionary_forest-0.2.0/evolutionary_forest/component/subset_selection.py` & `evolutionary_forest-0.2.1/evolutionary_forest/component/subset_selection.py`

 * *Files identical despite different names*

### Comparing `evolutionary_forest-0.2.0/evolutionary_forest/component/syntax_tools.py` & `evolutionary_forest-0.2.1/evolutionary_forest/component/syntax_tools.py`

 * *Files identical despite different names*

### Comparing `evolutionary_forest-0.2.0/evolutionary_forest/component/translation_transformer.py` & `evolutionary_forest-0.2.1/evolutionary_forest/component/translation_transformer.py`

 * *Files identical despite different names*

### Comparing `evolutionary_forest-0.2.0/evolutionary_forest/forest.py` & `evolutionary_forest-0.2.1/evolutionary_forest/forest.py`

 * *Files 17% similar despite different names*

```diff
@@ -1,11733 +1,15055 @@
-00000000: 6672 6f6d 2063 6f6c 6c65 6374 696f 6e73  from collections
-00000010: 2069 6d70 6f72 7420 436f 756e 7465 720a   import Counter.
-00000020: 6672 6f6d 206d 756c 7469 7072 6f63 6573  from multiproces
-00000030: 7369 6e67 2069 6d70 6f72 7420 506f 6f6c  sing import Pool
-00000040: 0a66 726f 6d20 7479 7069 6e67 2069 6d70  .from typing imp
-00000050: 6f72 7420 556e 696f 6e2c 204c 6973 740a  ort Union, List.
-00000060: 0a69 6d70 6f72 7420 6469 6c6c 0a66 726f  .import dill.fro
-00000070: 6d20 6465 6170 2069 6d70 6f72 7420 6770  m deap import gp
-00000080: 0a66 726f 6d20 6465 6170 2069 6d70 6f72  .from deap impor
-00000090: 7420 746f 6f6c 730a 6672 6f6d 2064 6561  t tools.from dea
-000000a0: 702e 616c 676f 7269 7468 6d73 2069 6d70  p.algorithms imp
-000000b0: 6f72 7420 7661 7241 6e64 0a66 726f 6d20  ort varAnd.from 
-000000c0: 6465 6170 2e62 6173 6520 696d 706f 7274  deap.base import
-000000d0: 2054 6f6f 6c62 6f78 0a66 726f 6d20 6465   Toolbox.from de
-000000e0: 6170 2e74 6f6f 6c73 2069 6d70 6f72 7420  ap.tools import 
-000000f0: 7365 6c4e 5347 4132 2c20 4869 7374 6f72  selNSGA2, Histor
-00000100: 792c 2073 656c 4265 7374 2c20 6378 5477  y, selBest, cxTw
-00000110: 6f50 6f69 6e74 2c20 6d75 7446 6c69 7042  oPoint, mutFlipB
-00000120: 6974 0a66 726f 6d20 6770 6c65 6172 6e2e  it.from gplearn.
-00000130: 6675 6e63 7469 6f6e 7320 696d 706f 7274  functions import
-00000140: 205f 7072 6f74 6563 7465 645f 7371 7274   _protected_sqrt
-00000150: 0a66 726f 6d20 6c69 6768 7467 626d 2069  .from lightgbm i
-00000160: 6d70 6f72 7420 4c47 424d 436c 6173 7369  mport LGBMClassi
-00000170: 6669 6572 2c20 4c47 424d 5265 6772 6573  fier, LGBMRegres
-00000180: 736f 722c 204c 4742 4d4d 6f64 656c 0a66  sor, LGBMModel.f
-00000190: 726f 6d20 6c69 6e65 6172 7472 6565 2069  rom lineartree i
-000001a0: 6d70 6f72 7420 4c69 6e65 6172 5472 6565  mport LinearTree
-000001b0: 5265 6772 6573 736f 720a 6672 6f6d 206e  Regressor.from n
-000001c0: 756d 7079 2e6c 696e 616c 6720 696d 706f  umpy.linalg impo
-000001d0: 7274 206e 6f72 6d0a 6672 6f6d 2073 6369  rt norm.from sci
-000001e0: 7079 2069 6d70 6f72 7420 7374 6174 730a  py import stats.
-000001f0: 6672 6f6d 2073 6369 7079 2e73 7061 7469  from scipy.spati
-00000200: 616c 2e64 6973 7461 6e63 6520 696d 706f  al.distance impo
-00000210: 7274 2063 6f73 696e 650a 6672 6f6d 2073  rt cosine.from s
-00000220: 6369 7079 2e73 7461 7473 2069 6d70 6f72  cipy.stats impor
-00000230: 7420 7370 6561 726d 616e 722c 206b 656e  t spearmanr, ken
-00000240: 6461 6c6c 7461 752c 2072 616e 6b64 6174  dalltau, rankdat
-00000250: 610a 6672 6f6d 2073 6b6c 6561 726e 2e62  a.from sklearn.b
-00000260: 6173 6520 696d 706f 7274 2052 6567 7265  ase import Regre
-00000270: 7373 6f72 4d69 7869 6e2c 2042 6173 6545  ssorMixin, BaseE
-00000280: 7374 696d 6174 6f72 2c20 436c 6173 7369  stimator, Classi
-00000290: 6669 6572 4d69 7869 6e2c 2054 7261 6e73  fierMixin, Trans
-000002a0: 666f 726d 6572 4d69 7869 6e0a 6672 6f6d  formerMixin.from
-000002b0: 2073 6b6c 6561 726e 2e63 6c75 7374 6572   sklearn.cluster
-000002c0: 2069 6d70 6f72 7420 4b4d 6561 6e73 2c20   import KMeans, 
-000002d0: 4442 5343 414e 0a66 726f 6d20 736b 6c65  DBSCAN.from skle
-000002e0: 6172 6e2e 636f 6d70 6f73 652e 7465 7374  arn.compose.test
-000002f0: 732e 7465 7374 5f74 6172 6765 7420 696d  s.test_target im
-00000300: 706f 7274 2044 756d 6d79 5472 616e 7366  port DummyTransf
-00000310: 6f72 6d65 720a 6672 6f6d 2073 6b6c 6561  ormer.from sklea
-00000320: 726e 2e64 6563 6f6d 706f 7369 7469 6f6e  rn.decomposition
-00000330: 2069 6d70 6f72 7420 5043 410a 6672 6f6d   import PCA.from
-00000340: 2073 6b6c 6561 726e 2e65 6e73 656d 626c   sklearn.ensembl
-00000350: 6520 696d 706f 7274 2045 7874 7261 5472  e import ExtraTr
-00000360: 6565 7352 6567 7265 7373 6f72 2c20 4772  eesRegressor, Gr
-00000370: 6164 6965 6e74 426f 6f73 7469 6e67 5265  adientBoostingRe
-00000380: 6772 6573 736f 722c 2052 616e 646f 6d46  gressor, RandomF
-00000390: 6f72 6573 7443 6c61 7373 6966 6965 722c  orestClassifier,
-000003a0: 205c 0a20 2020 2052 616e 646f 6d46 6f72   \.    RandomFor
-000003b0: 6573 7452 6567 7265 7373 6f72 0a66 726f  estRegressor.fro
-000003c0: 6d20 736b 6c65 6172 6e2e 6578 6365 7074  m sklearn.except
-000003d0: 696f 6e73 2069 6d70 6f72 7420 4e6f 7446  ions import NotF
-000003e0: 6974 7465 6445 7272 6f72 0a66 726f 6d20  ittedError.from 
-000003f0: 736b 6c65 6172 6e2e 6c69 6e65 6172 5f6d  sklearn.linear_m
-00000400: 6f64 656c 2069 6d70 6f72 7420 5269 6467  odel import Ridg
-00000410: 652c 204c 6f67 6973 7469 6352 6567 7265  e, LogisticRegre
-00000420: 7373 696f 6e2c 204c 6f67 6973 7469 6352  ssion, LogisticR
-00000430: 6567 7265 7373 696f 6e43 562c 2048 7562  egressionCV, Hub
-00000440: 6572 5265 6772 6573 736f 722c 205c 0a20  erRegressor, \. 
-00000450: 2020 204c 6173 736f 0a66 726f 6d20 736b     Lasso.from sk
-00000460: 6c65 6172 6e2e 6c69 6e65 6172 5f6d 6f64  learn.linear_mod
-00000470: 656c 2e5f 6261 7365 2069 6d70 6f72 7420  el._base import 
-00000480: 4c69 6e65 6172 4d6f 6465 6c2c 204c 696e  LinearModel, Lin
-00000490: 6561 7243 6c61 7373 6966 6965 724d 6978  earClassifierMix
-000004a0: 696e 0a66 726f 6d20 736b 6c65 6172 6e2e  in.from sklearn.
-000004b0: 6d65 7472 6963 7320 696d 706f 7274 202a  metrics import *
-000004c0: 0a66 726f 6d20 736b 6c65 6172 6e2e 6d65  .from sklearn.me
-000004d0: 7472 6963 732e 7061 6972 7769 7365 2069  trics.pairwise i
-000004e0: 6d70 6f72 7420 636f 7369 6e65 5f73 696d  mport cosine_sim
-000004f0: 696c 6172 6974 792c 2070 6169 7277 6973  ilarity, pairwis
-00000500: 655f 6469 7374 616e 6365 730a 6672 6f6d  e_distances.from
-00000510: 2073 6b6c 6561 726e 2e6d 6f64 656c 5f73   sklearn.model_s
-00000520: 656c 6563 7469 6f6e 2069 6d70 6f72 7420  election import 
-00000530: 6372 6f73 735f 7661 6c5f 7363 6f72 652c  cross_val_score,
-00000540: 2050 6172 616d 6574 6572 4772 6964 2c20   ParameterGrid, 
-00000550: 7472 6169 6e5f 7465 7374 5f73 706c 6974  train_test_split
-00000560: 0a66 726f 6d20 736b 6c65 6172 6e2e 6e65  .from sklearn.ne
-00000570: 6967 6862 6f72 7320 696d 706f 7274 204b  ighbors import K
-00000580: 4e65 6967 6862 6f72 7352 6567 7265 7373  NeighborsRegress
-00000590: 6f72 2c20 4b44 5472 6565 0a66 726f 6d20  or, KDTree.from 
-000005a0: 736b 6c65 6172 6e2e 6e65 7572 616c 5f6e  sklearn.neural_n
-000005b0: 6574 776f 726b 2069 6d70 6f72 7420 4d4c  etwork import ML
-000005c0: 5052 6567 7265 7373 6f72 0a66 726f 6d20  PRegressor.from 
-000005d0: 736b 6c65 6172 6e2e 7069 7065 6c69 6e65  sklearn.pipeline
-000005e0: 2069 6d70 6f72 7420 5069 7065 6c69 6e65   import Pipeline
-000005f0: 0a66 726f 6d20 736b 6c65 6172 6e2e 7072  .from sklearn.pr
-00000600: 6570 726f 6365 7373 696e 6720 696d 706f  eprocessing impo
-00000610: 7274 2053 7461 6e64 6172 6453 6361 6c65  rt StandardScale
-00000620: 722c 204d 696e 4d61 7853 6361 6c65 720a  r, MinMaxScaler.
-00000630: 6672 6f6d 2073 6b6c 6561 726e 2e73 766d  from sklearn.svm
-00000640: 2069 6d70 6f72 7420 5356 520a 6672 6f6d   import SVR.from
-00000650: 2073 6b6c 6561 726e 2e74 7265 6520 696d   sklearn.tree im
-00000660: 706f 7274 2044 6563 6973 696f 6e54 7265  port DecisionTre
-00000670: 6543 6c61 7373 6966 6965 722c 2042 6173  eClassifier, Bas
-00000680: 6544 6563 6973 696f 6e54 7265 650a 6672  eDecisionTree.fr
-00000690: 6f6d 2073 6b6c 6561 726e 2e75 7469 6c73  om sklearn.utils
-000006a0: 2069 6d70 6f72 7420 636f 6d70 7574 655f   import compute_
-000006b0: 7361 6d70 6c65 5f77 6569 6768 740a 6672  sample_weight.fr
-000006c0: 6f6d 2073 6b6c 6561 726e 3270 6d6d 6c2e  om sklearn2pmml.
-000006d0: 656e 7365 6d62 6c65 2069 6d70 6f72 7420  ensemble import 
-000006e0: 4742 4454 4c52 436c 6173 7369 6669 6572  GBDTLRClassifier
-000006f0: 0a66 726f 6d20 7379 6d70 7920 696d 706f  .from sympy impo
-00000700: 7274 2070 6172 7365 5f65 7870 720a 6672  rt parse_expr.fr
-00000710: 6f6d 2074 706f 7420 696d 706f 7274 2054  om tpot import T
-00000720: 504f 5443 6c61 7373 6966 6965 722c 2054  POTClassifier, T
-00000730: 504f 5452 6567 7265 7373 6f72 0a0a 6672  POTRegressor..fr
-00000740: 6f6d 2065 766f 6c75 7469 6f6e 6172 795f  om evolutionary_
-00000750: 666f 7265 7374 2e63 6f6d 706f 6e65 6e74  forest.component
-00000760: 2e61 7263 6869 7665 2069 6d70 6f72 7420  .archive import 
-00000770: 2a0a 6672 6f6d 2065 766f 6c75 7469 6f6e  *.from evolution
-00000780: 6172 795f 666f 7265 7374 2e63 6f6d 706f  ary_forest.compo
-00000790: 6e65 6e74 2e61 7263 6869 7665 2069 6d70  nent.archive imp
-000007a0: 6f72 7420 4452 4550 4861 6c6c 4f66 4661  ort DREPHallOfFa
-000007b0: 6d65 2c20 4e6f 7665 6c74 7948 616c 6c4f  me, NoveltyHallO
-000007c0: 6646 616d 652c 204f 4f42 4861 6c6c 4f66  fFame, OOBHallOf
-000007d0: 4661 6d65 2c20 426f 6f74 7374 7261 7048  Fame, BootstrapH
-000007e0: 616c 6c4f 6646 616d 650a 6672 6f6d 2065  allOfFame.from e
-000007f0: 766f 6c75 7469 6f6e 6172 795f 666f 7265  volutionary_fore
-00000800: 7374 2e63 6f6d 706f 6e65 6e74 2e65 7661  st.component.eva
-00000810: 6c75 6174 696f 6e20 696d 706f 7274 2063  luation import c
-00000820: 616c 6375 6c61 7465 5f73 636f 7265 2c20  alculate_score, 
-00000830: 6765 745f 6376 5f73 706c 6974 7465 722c  get_cv_splitter,
-00000840: 2071 7569 636b 5f72 6573 756c 745f 6361   quick_result_ca
-00000850: 6c63 756c 6174 696f 6e2c 205c 0a20 2020  lculation, \.   
-00000860: 2070 6970 655f 636f 6d62 696e 652c 2071   pipe_combine, q
-00000870: 7569 636b 5f65 7661 6c75 6174 650a 6672  uick_evaluate.fr
-00000880: 6f6d 2065 766f 6c75 7469 6f6e 6172 795f  om evolutionary_
-00000890: 666f 7265 7374 2e63 6f6d 706f 6e65 6e74  forest.component
-000008a0: 2e67 656e 6572 6174 696f 6e20 696d 706f  .generation impo
-000008b0: 7274 2076 6172 416e 6450 6c75 730a 6672  rt varAndPlus.fr
-000008c0: 6f6d 2065 766f 6c75 7469 6f6e 6172 795f  om evolutionary_
-000008d0: 666f 7265 7374 2e63 6f6d 706f 6e65 6e74  forest.component
-000008e0: 2e70 7269 6d69 7469 7665 7320 696d 706f  .primitives impo
-000008f0: 7274 202a 0a66 726f 6d20 6576 6f6c 7574  rt *.from evolut
-00000900: 696f 6e61 7279 5f66 6f72 6573 742e 636f  ionary_forest.co
-00000910: 6d70 6f6e 656e 742e 7072 696d 6974 6976  mponent.primitiv
-00000920: 6573 2069 6d70 6f72 7420 6e70 5f6d 6561  es import np_mea
-00000930: 6e2c 2061 6464 5f65 7874 656e 645f 6f70  n, add_extend_op
-00000940: 6572 6174 6f72 730a 6672 6f6d 2065 766f  erators.from evo
-00000950: 6c75 7469 6f6e 6172 795f 666f 7265 7374  lutionary_forest
-00000960: 2e63 6f6d 706f 6e65 6e74 2e73 656c 6563  .component.selec
-00000970: 7469 6f6e 2069 6d70 6f72 7420 6261 7463  tion import batc
-00000980: 685f 746f 7572 6e61 6d65 6e74 5f73 656c  h_tournament_sel
-00000990: 6563 7469 6f6e 2c20 7365 6c41 7574 6f6d  ection, selAutom
-000009a0: 6174 6963 4570 7369 6c6f 6e4c 6578 6963  aticEpsilonLexic
-000009b0: 6173 654b 2c20 5c0a 2020 2020 7365 6c54  aseK, \.    selT
-000009c0: 6f75 726e 616d 656e 7450 6c75 732c 2073  ournamentPlus, s
-000009d0: 656c 4175 746f 6d61 7469 6345 7073 696c  elAutomaticEpsil
-000009e0: 6f6e 4c65 7869 6361 7365 4661 7374 2c20  onLexicaseFast, 
-000009f0: 7365 6c44 6f75 626c 6552 6f75 6e64 2c20  selDoubleRound, 
-00000a00: 7365 6c52 616e 646f 6d50 6c75 732c 2073  selRandomPlus, s
-00000a10: 656c 4261 6767 696e 672c 2073 656c 546f  elBagging, selTo
-00000a20: 7572 6e61 6d65 6e74 4e6f 7665 6c74 792c  urnamentNovelty,
-00000a30: 205c 0a20 2020 2073 656c 4879 6272 6964   \.    selHybrid
-00000a40: 2c20 7365 6c47 5045 442c 2073 656c 4d41  , selGPED, selMA
-00000a50: 5045 6c69 7465 732c 2073 656c 4d41 5045  PElites, selMAPE
-00000a60: 6c69 7465 436c 7573 7465 7269 6e67 2c20  liteClustering, 
-00000a70: 7365 6c4b 6e6f 636b 6f75 742c 2073 656c  selKnockout, sel
-00000a80: 526f 756c 6574 7465 2c20 7365 6c4d 6178  Roulette, selMax
-00000a90: 416e 676c 6553 656c 6563 7469 6f6e 2c20  AngleSelection, 
-00000aa0: 5c0a 2020 2020 7365 6c41 6e67 6c65 4472  \.    selAngleDr
-00000ab0: 6976 656e 5365 6c65 6374 696f 6e0a 6672  ivenSelection.fr
-00000ac0: 6f6d 2065 766f 6c75 7469 6f6e 6172 795f  om evolutionary_
-00000ad0: 666f 7265 7374 2e63 6f6d 706f 6e65 6e74  forest.component
-00000ae0: 2e73 7461 7465 6675 6c5f 6770 2069 6d70  .stateful_gp imp
-00000af0: 6f72 7420 6d61 6b65 5f63 6c61 7373 2c20  ort make_class, 
-00000b00: 5461 7267 6574 456e 636f 6465 724e 756d  TargetEncoderNum
-00000b10: 7079 0a66 726f 6d20 6576 6f6c 7574 696f  py.from evolutio
-00000b20: 6e61 7279 5f66 6f72 6573 742e 6d6f 6465  nary_forest.mode
-00000b30: 6c2e 504c 5472 6565 2069 6d70 6f72 7420  l.PLTree import 
-00000b40: 536f 6674 504c 5472 6565 5265 6772 6573  SoftPLTreeRegres
-00000b50: 736f 722c 2053 6f66 7450 4c54 7265 6552  sor, SoftPLTreeR
-00000b60: 6567 7265 7373 6f72 454d 2c20 504c 5472  egressorEM, PLTr
-00000b70: 6565 5265 6772 6573 736f 722c 2052 6964  eeRegressor, Rid
-00000b80: 6765 4454 2c20 5c0a 2020 2020 4c52 4454  geDT, \.    LRDT
-00000b90: 436c 6173 7369 6669 6572 2c20 5269 6467  Classifier, Ridg
-00000ba0: 6544 5450 6c75 732c 2052 616e 646f 6d57  eDTPlus, RandomW
-00000bb0: 6569 6768 7452 6964 6765 0a66 726f 6d20  eightRidge.from 
-00000bc0: 6576 6f6c 7574 696f 6e61 7279 5f66 6f72  evolutionary_for
-00000bd0: 6573 742e 6d6f 6465 6c2e 5242 464e 2069  est.model.RBFN i
-00000be0: 6d70 6f72 7420 5242 464e 0a66 726f 6d20  mport RBFN.from 
-00000bf0: 6576 6f6c 7574 696f 6e61 7279 5f66 6f72  evolutionary_for
-00000c00: 6573 742e 6d6f 6465 6c2e 5361 6665 7479  est.model.Safety
-00000c10: 4c52 2069 6d70 6f72 7420 5361 6665 7479  LR import Safety
-00000c20: 4c6f 6769 7374 6963 5265 6772 6573 7369  LogisticRegressi
-00000c30: 6f6e 0a66 726f 6d20 6576 6f6c 7574 696f  on.from evolutio
-00000c40: 6e61 7279 5f66 6f72 6573 742e 6d6f 6465  nary_forest.mode
-00000c50: 6c2e 5361 6665 7479 5363 616c 6572 2069  l.SafetyScaler i
-00000c60: 6d70 6f72 7420 5361 6665 7479 5363 616c  mport SafetyScal
-00000c70: 6572 0a66 726f 6d20 6576 6f6c 7574 696f  er.from evolutio
-00000c80: 6e61 7279 5f66 6f72 6573 742e 6d75 6c74  nary_forest.mult
-00000c90: 6967 656e 655f 6770 2069 6d70 6f72 7420  igene_gp import 
-00000ca0: 2a0a 6672 6f6d 2065 766f 6c75 7469 6f6e  *.from evolution
-00000cb0: 6172 795f 666f 7265 7374 2e70 7265 7072  ary_forest.prepr
-00000cc0: 6f63 6573 735f 7574 696c 7320 696d 706f  ocess_utils impo
-00000cd0: 7274 2047 656e 6572 616c 4665 6174 7572  rt GeneralFeatur
-00000ce0: 652c 2043 6174 6567 6f72 6963 616c 4665  e, CategoricalFe
-00000cf0: 6174 7572 652c 2042 6f6f 6c65 616e 4665  ature, BooleanFe
-00000d00: 6174 7572 652c 205c 0a20 2020 204e 756d  ature, \.    Num
-00000d10: 6572 6963 616c 4665 6174 7572 652c 2046  ericalFeature, F
-00000d20: 6561 7475 7265 5472 616e 7366 6f72 6d65  eatureTransforme
-00000d30: 720a 6672 6f6d 2065 766f 6c75 7469 6f6e  r.from evolution
-00000d40: 6172 795f 666f 7265 7374 2e70 726f 6261  ary_forest.proba
-00000d50: 6269 6c69 7479 5f67 7020 696d 706f 7274  bility_gp import
-00000d60: 2067 656e 4861 6c66 416e 6448 616c 660a   genHalfAndHalf.
-00000d70: 6672 6f6d 2065 766f 6c75 7469 6f6e 6172  from evolutionar
-00000d80: 795f 666f 7265 7374 2e70 7275 6e69 6e67  y_forest.pruning
-00000d90: 2069 6d70 6f72 7420 6f6f 625f 7072 756e   import oob_prun
-00000da0: 696e 670a 6672 6f6d 2065 766f 6c75 7469  ing.from evoluti
-00000db0: 6f6e 6172 795f 666f 7265 7374 2e73 7472  onary_forest.str
-00000dc0: 6174 6567 6965 732e 6573 7469 6d61 7469  ategies.estimati
-00000dd0: 6f6e 5f6f 665f 6469 7374 7269 6275 7469  on_of_distributi
-00000de0: 6f6e 2069 6d70 6f72 7420 4573 7469 6d61  on import Estima
-00000df0: 7469 6f6e 4f66 4469 7374 7269 6275 7469  tionOfDistributi
-00000e00: 6f6e 0a66 726f 6d20 6576 6f6c 7574 696f  on.from evolutio
-00000e10: 6e61 7279 5f66 6f72 6573 742e 7374 7261  nary_forest.stra
-00000e20: 7465 6769 6573 2e73 7061 6365 5f70 6172  tegies.space_par
-00000e30: 7469 7469 6f6e 2069 6d70 6f72 7420 5370  tition import Sp
-00000e40: 6163 6550 6172 7469 7469 6f6e 2c20 7061  acePartition, pa
-00000e50: 7274 6974 696f 6e5f 7363 6865 6d65 5f76  rtition_scheme_v
-00000e60: 6172 416e 642c 205c 0a20 2020 2070 6172  arAnd, \.    par
-00000e70: 7469 7469 6f6e 5f73 6368 656d 655f 746f  tition_scheme_to
-00000e80: 6f6c 626f 780a 6672 6f6d 2065 766f 6c75  olbox.from evolu
-00000e90: 7469 6f6e 6172 795f 666f 7265 7374 2e73  tionary_forest.s
-00000ea0: 7472 6174 6567 6965 732e 7375 7272 6f67  trategies.surrog
-00000eb0: 6174 655f 6d6f 6465 6c20 696d 706f 7274  ate_model import
-00000ec0: 2053 7572 726f 6761 7465 4d6f 6465 6c0a   SurrogateModel.
-00000ed0: 6672 6f6d 2065 766f 6c75 7469 6f6e 6172  from evolutionar
-00000ee0: 795f 666f 7265 7374 2e75 7469 6c73 2069  y_forest.utils i
-00000ef0: 6d70 6f72 7420 6765 745f 6665 6174 7572  mport get_featur
-00000f00: 655f 696d 706f 7274 616e 6365 2c20 6665  e_importance, fe
-00000f10: 6174 7572 655f 6170 7065 6e64 2c20 7365  ature_append, se
-00000f20: 6c65 6374 5f74 6f70 5f66 6561 7475 7265  lect_top_feature
-00000f30: 732c 2065 6666 6963 6965 6e74 5f64 6565  s, efficient_dee
-00000f40: 7063 6f70 792c 205c 0a20 2020 2067 656e  pcopy, \.    gen
-00000f50: 655f 746f 5f73 7472 696e 672c 2067 6574  e_to_string, get
-00000f60: 5f61 6374 6976 6174 696f 6e73 2c20 7265  _activations, re
-00000f70: 7365 745f 7261 6e64 6f6d 2c20 7765 6967  set_random, weig
-00000f80: 6874 6564 5f61 7667 5f61 6e64 5f73 7464  hted_avg_and_std
-00000f90: 2c20 7361 7665 5f61 7272 6179 2c20 6765  , save_array, ge
-00000fa0: 745f 696d 706f 7274 616e 745f 6665 6174  t_important_feat
-00000fb0: 7572 6573 0a0a 6564 615f 6f70 6572 6174  ures..eda_operat
-00000fc0: 6f72 7320 3d20 5b27 7072 6f62 6162 696c  ors = ['probabil
-00000fd0: 6974 792d 5453 272c 2027 4544 412d 5072  ity-TS', 'EDA-Pr
-00000fe0: 696d 6974 6976 6527 2c20 2745 4441 2d54  imitive', 'EDA-T
-00000ff0: 6572 6d69 6e61 6c27 2c20 2745 4441 2d50  erminal', 'EDA-P
-00001000: 4d27 2c0a 2020 2020 2020 2020 2020 2020  M',.            
-00001010: 2020 2020 2027 4544 412d 5465 726d 696e       'EDA-Termin
-00001020: 616c 2d50 4d27 2c20 2745 4441 2d54 6572  al-PM', 'EDA-Ter
-00001030: 6d69 6e61 6c2d 4261 6c61 6e63 6564 272c  minal-Balanced',
-00001040: 2027 4544 412d 5465 726d 696e 616c 2d53   'EDA-Terminal-S
-00001050: 616d 6557 6569 6768 7427 2c20 2745 4441  ameWeight', 'EDA
-00001060: 2d54 6572 6d69 6e61 6c2d 504d 4927 2c0a  -Terminal-PMI',.
-00001070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001080: 2027 4544 412d 5465 726d 696e 616c 2d50   'EDA-Terminal-P
-00001090: 4d2d 4269 6173 6564 272c 2027 4544 412d  M-Biased', 'EDA-
-000010a0: 5465 726d 696e 616c 2d50 4d2d 506f 7075  Terminal-PM-Popu
-000010b0: 6c61 7469 6f6e 272c 2027 4544 412d 504d  lation', 'EDA-PM
-000010c0: 2d50 6f70 756c 6174 696f 6e27 2c0a 2020  -Population',.  
-000010d0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-000010e0: 4544 412d 5465 726d 696e 616c 2d50 4d2d  EDA-Terminal-PM-
-000010f0: 4672 6571 7565 6e63 7927 2c20 2745 4441  Frequency', 'EDA
-00001100: 2d54 6572 6d69 6e61 6c2d 504d 2d54 6f75  -Terminal-PM-Tou
-00001110: 726e 616d 656e 7427 2c0a 2020 2020 2020  rnament',.      
-00001120: 2020 2020 2020 2020 2020 2027 4544 412d             'EDA-
-00001130: 5465 726d 696e 616c 2d50 4d2d 5343 272c  Terminal-PM-SC',
-00001140: 2027 4544 412d 5465 726d 696e 616c 2d50   'EDA-Terminal-P
-00001150: 4d2d 5343 2d57 5327 2c20 2745 4441 2d54  M-SC-WS', 'EDA-T
-00001160: 6572 6d69 6e61 6c2d 504d 2d53 432d 4e54  erminal-PM-SC-NT
-00001170: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-00001180: 2020 2020 2745 4441 2d54 6572 6d69 6e61      'EDA-Termina
-00001190: 6c2d 504d 2d53 616d 6549 6e64 6578 275d  l-PM-SameIndex']
-000011a0: 0a6d 6170 5f65 6c69 7465 5f73 6572 6965  .map_elite_serie
-000011b0: 7320 3d20 5b27 4d41 502d 456c 6974 652d  s = ['MAP-Elite-
-000011c0: 4c65 7869 6361 7365 272c 2027 4d41 502d  Lexicase', 'MAP-
-000011d0: 456c 6974 652d 546f 7572 6e61 6d65 6e74  Elite-Tournament
-000011e0: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-000011f0: 2020 2020 2020 2027 4d41 502d 456c 6974         'MAP-Elit
-00001200: 652d 526f 756c 6574 7465 272c 2027 4d41  e-Roulette', 'MA
-00001210: 502d 456c 6974 652d 546f 7572 6e61 6d65  P-Elite-Tourname
-00001220: 6e74 2d33 272c 2027 4d41 502d 456c 6974  nt-3', 'MAP-Elit
-00001230: 652d 546f 7572 6e61 6d65 6e74 2d37 272c  e-Tournament-7',
-00001240: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001250: 2020 2020 2027 4d41 502d 456c 6974 652d       'MAP-Elite-
-00001260: 5261 6e64 6f6d 272c 2027 4d41 502d 456c  Random', 'MAP-El
-00001270: 6974 652d 4b6e 6f63 6b6f 7574 272c 2027  ite-Knockout', '
-00001280: 4d41 502d 456c 6974 652d 4b6e 6f63 6b6f  MAP-Elite-Knocko
-00001290: 7574 2d53 272c 0a20 2020 2020 2020 2020  ut-S',.         
-000012a0: 2020 2020 2020 2020 2020 2027 4d41 502d             'MAP-
-000012b0: 456c 6974 652d 4b6e 6f63 6b6f 7574 2d41  Elite-Knockout-A
-000012c0: 272c 2027 4d41 502d 456c 6974 652d 4b6e  ', 'MAP-Elite-Kn
-000012d0: 6f63 6b6f 7574 2d53 4127 2c0a 2020 2020  ockout-SA',.    
-000012e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000012f0: 2741 7574 6f27 2c20 2741 7574 6f2d 4d43  'Auto', 'Auto-MC
-00001300: 5453 275d 0a72 6573 6574 5f72 616e 646f  TS'].reset_rando
-00001310: 6d28 3029 0a0a 0a63 6c61 7373 2047 4244  m(0)...class GBD
-00001320: 544c 5243 6c61 7373 6966 6965 7258 2847  TLRClassifierX(G
-00001330: 4244 544c 5243 6c61 7373 6966 6965 7229  BDTLRClassifier)
-00001340: 3a0a 0a20 2020 2064 6566 2066 6974 2873  :..    def fit(s
-00001350: 656c 662c 2058 2c20 792c 202a 2a66 6974  elf, X, y, **fit
-00001360: 5f70 6172 616d 7329 3a0a 2020 2020 2020  _params):.      
-00001370: 2020 7375 7065 7228 292e 6669 7428 582c    super().fit(X,
-00001380: 2079 2c20 2a2a 6669 745f 7061 7261 6d73   y, **fit_params
-00001390: 290a 2020 2020 2020 2020 7365 6c66 2e63  ).        self.c
-000013a0: 6c61 7373 6573 5f20 3d20 7365 6c66 2e67  lasses_ = self.g
-000013b0: 6264 745f 2e63 6c61 7373 6573 5f0a 2020  bdt_.classes_.  
-000013c0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-000013d0: 660a 0a0a 636c 6173 7320 5374 6174 6963  f...class Static
-000013e0: 5261 6e64 6f6d 5072 6f6a 6563 7469 6f6e  RandomProjection
-000013f0: 2854 7261 6e73 666f 726d 6572 4d69 7869  (TransformerMixi
-00001400: 6e2c 2042 6173 6545 7374 696d 6174 6f72  n, BaseEstimator
-00001410: 293a 0a0a 2020 2020 6465 6620 5f5f 696e  ):..    def __in
-00001420: 6974 5f5f 2873 656c 662c 2063 6f6d 706f  it__(self, compo
-00001430: 6e65 6e74 735f 3a20 696e 7429 3a0a 2020  nents_: int):.  
-00001440: 2020 2020 2020 7365 6c66 2e63 6f6d 706f        self.compo
-00001450: 6e65 6e74 735f 203d 2063 6f6d 706f 6e65  nents_ = compone
-00001460: 6e74 735f 0a0a 2020 2020 6465 6620 5f6d  nts_..    def _m
-00001470: 616b 655f 7261 6e64 6f6d 5f6d 6174 7269  ake_random_matri
-00001480: 7828 7365 6c66 2c20 6e5f 636f 6d70 6f6e  x(self, n_compon
-00001490: 656e 7473 2c20 6e5f 6665 6174 7572 6573  ents, n_features
-000014a0: 293a 0a20 2020 2020 2020 2070 6173 730a  ):.        pass.
-000014b0: 0a20 2020 2064 6566 2066 6974 2873 656c  .    def fit(sel
-000014c0: 662c 2058 2c20 793d 4e6f 6e65 293a 0a20  f, X, y=None):. 
-000014d0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-000014e0: 6c66 0a0a 2020 2020 6465 6620 7472 616e  lf..    def tran
-000014f0: 7366 6f72 6d28 7365 6c66 2c20 5829 3a0a  sform(self, X):.
-00001500: 2020 2020 2020 2020 7265 7475 726e 2058          return X
-00001510: 2040 2073 656c 662e 636f 6d70 6f6e 656e   @ self.componen
-00001520: 7473 5f0a 0a0a 636c 6173 7320 456e 7365  ts_...class Ense
-00001530: 6d62 6c65 5265 6772 6573 736f 7228 5265  mbleRegressor(Re
-00001540: 6772 6573 736f 724d 6978 696e 2c20 4261  gressorMixin, Ba
-00001550: 7365 4573 7469 6d61 746f 7229 3a0a 2020  seEstimator):.  
-00001560: 2020 2222 220a 2020 2020 436f 6d62 696e    """.    Combin
-00001570: 696e 6720 7365 7665 7261 6c20 6d6f 6465  ing several mode
-00001580: 6c73 2067 656e 6572 6174 6564 2062 7920  ls generated by 
-00001590: 352d 666f 6c64 2043 5620 746f 2066 6f72  5-fold CV to for
-000015a0: 6d20 6120 6669 6e61 6c20 656e 7365 6d62  m a final ensemb
-000015b0: 6c65 206d 6f64 656c 0a20 2020 2022 2222  le model.    """
-000015c0: 0a0a 2020 2020 6465 6620 5f5f 696e 6974  ..    def __init
-000015d0: 5f5f 2873 656c 662c 2074 7265 6573 293a  __(self, trees):
-000015e0: 0a20 2020 2020 2020 2073 656c 662e 7472  .        self.tr
-000015f0: 6565 7320 3d20 7472 6565 730a 0a20 2020  ees = trees..   
-00001600: 2064 6566 2066 6974 2873 656c 662c 2058   def fit(self, X
-00001610: 2c20 7929 3a0a 2020 2020 2020 2020 7061  , y):.        pa
-00001620: 7373 0a0a 2020 2020 6465 6620 7072 6564  ss..    def pred
-00001630: 6963 7428 7365 6c66 2c20 5829 3a0a 2020  ict(self, X):.  
-00001640: 2020 2020 2020 7072 6564 6963 7469 6f6e        prediction
-00001650: 7320 3d20 5b5d 0a20 2020 2020 2020 2074  s = [].        t
-00001660: 3a20 4465 6369 7369 6f6e 5472 6565 5265  : DecisionTreeRe
-00001670: 6772 6573 736f 720a 2020 2020 2020 2020  gressor.        
-00001680: 666f 7220 7420 696e 2073 656c 662e 7472  for t in self.tr
-00001690: 6565 733a 0a20 2020 2020 2020 2020 2020  ees:.           
-000016a0: 2070 7265 6469 6374 696f 6e73 2e61 7070   predictions.app
-000016b0: 656e 6428 742e 7072 6564 6963 7428 5829  end(t.predict(X)
-000016c0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-000016d0: 206e 702e 6d65 616e 2870 7265 6469 6374   np.mean(predict
-000016e0: 696f 6e73 2c20 6178 6973 3d30 290a 0a0a  ions, axis=0)...
-000016f0: 636c 6173 7320 456e 7365 6d62 6c65 436c  class EnsembleCl
-00001700: 6173 7369 6669 6572 2843 6c61 7373 6966  assifier(Classif
-00001710: 6965 724d 6978 696e 2c20 4261 7365 4573  ierMixin, BaseEs
-00001720: 7469 6d61 746f 7229 3a0a 2020 2020 2222  timator):.    ""
-00001730: 220a 2020 2020 436f 6d62 696e 696e 6720  ".    Combining 
-00001740: 7365 7665 7261 6c20 6d6f 6465 6c73 2067  several models g
-00001750: 656e 6572 6174 6564 2062 7920 352d 666f  enerated by 5-fo
-00001760: 6c64 2043 5620 746f 2066 6f72 6d20 6120  ld CV to form a 
-00001770: 6669 6e61 6c20 656e 7365 6d62 6c65 206d  final ensemble m
-00001780: 6f64 656c 0a20 2020 2022 2222 0a0a 2020  odel.    """..  
-00001790: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
-000017a0: 656c 662c 2074 7265 6573 293a 0a20 2020  elf, trees):.   
-000017b0: 2020 2020 2073 656c 662e 7472 6565 7320       self.trees 
-000017c0: 3d20 7472 6565 730a 0a20 2020 2064 6566  = trees..    def
-000017d0: 2066 6974 2873 656c 662c 2058 2c20 7929   fit(self, X, y)
-000017e0: 3a0a 2020 2020 2020 2020 7061 7373 0a0a  :.        pass..
-000017f0: 2020 2020 6465 6620 7072 6564 6963 7428      def predict(
-00001800: 7365 6c66 2c20 5829 3a0a 2020 2020 2020  self, X):.      
-00001810: 2020 7072 6564 6963 7469 6f6e 7320 3d20    predictions = 
-00001820: 5b5d 0a20 2020 2020 2020 2074 3a20 4465  [].        t: De
-00001830: 6369 7369 6f6e 5472 6565 436c 6173 7369  cisionTreeClassi
-00001840: 6669 6572 0a20 2020 2020 2020 2066 6f72  fier.        for
-00001850: 2074 2069 6e20 7365 6c66 2e74 7265 6573   t in self.trees
-00001860: 3a0a 2020 2020 2020 2020 2020 2020 7072  :.            pr
-00001870: 6564 6963 7469 6f6e 732e 6170 7065 6e64  edictions.append
-00001880: 2874 2e70 7265 6469 6374 2858 2929 0a20  (t.predict(X)). 
-00001890: 2020 2020 2020 2072 6574 7572 6e20 7374         return st
-000018a0: 6174 732e 6d6f 6465 2870 7265 6469 6374  ats.mode(predict
-000018b0: 696f 6e73 2c20 6178 6973 3d30 295b 305d  ions, axis=0)[0]
-000018c0: 2e66 6c61 7474 656e 2829 0a0a 0a64 6566  .flatten()...def
-000018d0: 2073 696d 696c 6172 2861 2c20 6229 3a0a   similar(a, b):.
-000018e0: 2020 2020 7265 7475 726e 2063 6f73 696e      return cosin
-000018f0: 655f 7369 6d69 6c61 7269 7479 2861 2e63  e_similarity(a.c
-00001900: 6173 655f 7661 6c75 6573 2e72 6573 6861  ase_values.resha
-00001910: 7065 2831 2c20 2d31 292c 2062 2e63 6173  pe(1, -1), b.cas
-00001920: 655f 7661 6c75 6573 2e72 6573 6861 7065  e_values.reshape
-00001930: 2831 2c20 2d31 2929 5b30 5d5b 305d 203e  (1, -1))[0][0] >
-00001940: 2030 2e39 0a0a 0a64 6566 2073 7065 6172   0.9...def spear
-00001950: 6d61 6e28 7961 2c20 7962 293a 0a20 2020  man(ya, yb):.   
-00001960: 2072 6574 7572 6e20 7370 6561 726d 616e   return spearman
-00001970: 7228 7961 2c20 7962 295b 305d 0a0a 0a64  r(ya, yb)[0]...d
-00001980: 6566 206b 656e 6461 6c6c 2879 612c 2079  ef kendall(ya, y
-00001990: 6229 3a0a 2020 2020 7265 7475 726e 206b  b):.    return k
-000019a0: 656e 6461 6c6c 7461 7528 7961 2c20 7962  endalltau(ya, yb
-000019b0: 295b 305d 0a0a 0a63 6c61 7373 2054 6573  )[0]...class Tes
-000019c0: 7446 756e 6374 696f 6e28 293a 0a20 2020  tFunction():.   
-000019d0: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
-000019e0: 6c66 2c20 782c 2079 293a 0a20 2020 2020  lf, x, y):.     
-000019f0: 2020 2073 656c 662e 7820 3d20 780a 2020     self.x = x.  
-00001a00: 2020 2020 2020 7365 6c66 2e79 203d 2079        self.y = y
-00001a10: 0a20 2020 2020 2020 2073 656c 662e 7265  .        self.re
-00001a20: 6772 203d 204e 6f6e 650a 0a20 2020 2064  gr = None..    d
-00001a30: 6566 2070 7265 6469 6374 5f6c 6f73 7328  ef predict_loss(
-00001a40: 7365 6c66 293a 0a20 2020 2020 2020 2069  self):.        i
-00001a50: 6620 6c65 6e28 7365 6c66 2e78 2920 3e20  f len(self.x) > 
-00001a60: 303a 0a20 2020 2020 2020 2020 2020 2079  0:.            y
-00001a70: 5f70 203d 2073 656c 662e 7265 6772 2e70  _p = self.regr.p
-00001a80: 7265 6469 6374 2873 656c 662e 7829 0a20  redict(self.x). 
-00001a90: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00001aa0: 6e20 7232 5f73 636f 7265 2873 656c 662e  n r2_score(self.
-00001ab0: 792c 2079 5f70 290a 2020 2020 2020 2020  y, y_p).        
-00001ac0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00001ad0: 2020 7265 7475 726e 2030 0a0a 2020 2020    return 0..    
-00001ae0: 6465 6620 5f5f 6465 6570 636f 7079 5f5f  def __deepcopy__
-00001af0: 2873 656c 662c 206d 656d 6f64 6963 743d  (self, memodict=
-00001b00: 7b7d 293a 0a20 2020 2020 2020 2072 6574  {}):.        ret
-00001b10: 7572 6e20 636f 7079 2e64 6565 7063 6f70  urn copy.deepcop
-00001b20: 7928 7365 6c66 290a 0a0a 636c 6173 7320  y(self)...class 
-00001b30: 4576 6f6c 7574 696f 6e61 7279 466f 7265  EvolutionaryFore
-00001b40: 7374 5265 6772 6573 736f 7228 5265 6772  stRegressor(Regr
-00001b50: 6573 736f 724d 6978 696e 2c20 5472 616e  essorMixin, Tran
-00001b60: 7366 6f72 6d65 724d 6978 696e 2c20 4261  sformerMixin, Ba
-00001b70: 7365 4573 7469 6d61 746f 722c 0a20 2020  seEstimator,.   
-00001b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001b90: 2020 2020 2020 2020 2020 2020 2020 2053                 S
-00001ba0: 7572 726f 6761 7465 4d6f 6465 6c2c 2053  urrogateModel, S
-00001bb0: 7061 6365 5061 7274 6974 696f 6e2c 2045  pacePartition, E
-00001bc0: 7374 696d 6174 696f 6e4f 6644 6973 7472  stimationOfDistr
-00001bd0: 6962 7574 696f 6e29 3a0a 2020 2020 2222  ibution):.    ""
-00001be0: 220a 2020 2020 5375 7070 6f72 7420 626f  ".    Support bo
-00001bf0: 7468 2054 4750 2061 6e64 2061 2076 6172  th TGP and a var
-00001c00: 6961 6e74 206f 6620 4c47 5020 666f 7220  iant of LGP for 
-00001c10: 6576 6f6c 7574 696f 616e 7279 2066 6561  evolutioanry fea
-00001c20: 7475 7265 2063 6f6e 7374 7275 6374 696f  ture constructio
-00001c30: 6e0a 2020 2020 2222 220a 0a20 2020 2064  n.    """..    d
-00001c40: 6566 205f 5f69 6e69 745f 5f28 7365 6c66  ef __init__(self
-00001c50: 2c20 6e5f 706f 703d 3530 2c20 6e5f 6765  , n_pop=50, n_ge
-00001c60: 6e3d 3230 2c20 7665 7262 6f73 653d 4661  n=20, verbose=Fa
-00001c70: 6c73 652c 206d 6178 5f68 6569 6768 743d  lse, max_height=
-00001c80: 382c 206d 696e 5f68 6569 6768 743d 302c  8, min_height=0,
-00001c90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001ca0: 2020 6261 7369 635f 7072 696d 6974 6976    basic_primitiv
-00001cb0: 6573 3d54 7275 652c 206e 6f72 6d61 6c69  es=True, normali
-00001cc0: 7a65 3d54 7275 652c 2073 656c 6563 743d  ze=True, select=
-00001cd0: 2741 7574 6f6d 6174 6963 4c65 7869 6361  'AutomaticLexica
-00001ce0: 7365 4661 7374 272c 0a20 2020 2020 2020  seFast',.       
-00001cf0: 2020 2020 2020 2020 2020 6765 6e65 5f6e            gene_n
-00001d00: 756d 3d35 2c20 6d75 7461 7469 6f6e 5f73  um=5, mutation_s
-00001d10: 6368 656d 653d 2775 6e69 666f 726d 272c  cheme='uniform',
-00001d20: 2065 6e73 656d 626c 655f 7369 7a65 3d31   ensemble_size=1
-00001d30: 3030 2c0a 2020 2020 2020 2020 2020 2020  00,.            
-00001d40: 2020 2020 2065 7874 6572 6e61 6c5f 6172       external_ar
-00001d50: 6368 6976 653d 4e6f 6e65 2c20 6f72 6967  chive=None, orig
-00001d60: 696e 616c 5f66 6561 7475 7265 733d 4661  inal_features=Fa
-00001d70: 6c73 652c 2064 6976 6572 7369 7479 5f73  lse, diversity_s
-00001d80: 6561 7263 683d 274e 6f6e 6527 2c20 6372  earch='None', cr
-00001d90: 6f73 735f 7062 3d30 2e35 2c0a 2020 2020  oss_pb=0.5,.    
-00001da0: 2020 2020 2020 2020 2020 2020 206d 7574               mut
-00001db0: 6174 696f 6e5f 7062 3d30 2e31 2c20 7365  ation_pb=0.1, se
-00001dc0: 636f 6e64 5f6c 6179 6572 3d4e 6f6e 652c  cond_layer=None,
-00001dd0: 2065 6e73 656d 626c 655f 7365 6c65 6374   ensemble_select
-00001de0: 696f 6e3d 4e6f 6e65 2c20 7465 7374 5f66  ion=None, test_f
-00001df0: 756e 3d4e 6f6e 652c 2062 6f6f 7473 7472  un=None, bootstr
-00001e00: 6170 5f74 7261 696e 696e 673d 4661 6c73  ap_training=Fals
-00001e10: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-00001e20: 2020 2020 6d65 616e 5f6d 6f64 656c 3d46      mean_model=F
-00001e30: 616c 7365 2c20 6561 726c 795f 7374 6f70  alse, early_stop
-00001e40: 3d2d 312c 206d 696e 5f73 616d 706c 6573  =-1, min_samples
-00001e50: 5f6c 6561 663d 312c 2062 6173 655f 6c65  _leaf=1, base_le
-00001e60: 6172 6e65 723d 2752 616e 646f 6d2d 4454  arner='Random-DT
-00001e70: 272c 2073 636f 7265 5f66 756e 633d 2752  ', score_func='R
-00001e80: 3227 2c0a 2020 2020 2020 2020 2020 2020  2',.            
-00001e90: 2020 2020 206d 6178 5f74 7265 655f 6465       max_tree_de
-00001ea0: 7074 683d 4e6f 6e65 2c20 656e 7669 726f  pth=None, enviro
-00001eb0: 6e6d 656e 7461 6c5f 7365 6c65 6374 696f  nmental_selectio
-00001ec0: 6e3d 4e6f 6e65 2c20 7072 655f 7365 6c65  n=None, pre_sele
-00001ed0: 6374 696f 6e3d 4e6f 6e65 2c20 6561 6765  ction=None, eage
-00001ee0: 725f 7472 6169 6e69 6e67 3d46 616c 7365  r_training=False
-00001ef0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00001f00: 2020 206e 5f70 726f 6365 7373 3d31 2c20     n_process=1, 
-00001f10: 7573 656c 6573 735f 6665 6174 7572 655f  useless_feature_
-00001f20: 7261 7469 6f3d 4e6f 6e65 2c20 7765 6967  ratio=None, weig
-00001f30: 6874 6564 5f63 6f65 663d 4661 6c73 652c  hted_coef=False,
-00001f40: 2066 6561 7475 7265 5f73 656c 6563 7469   feature_selecti
-00001f50: 6f6e 3d46 616c 7365 2c0a 2020 2020 2020  on=False,.      
-00001f60: 2020 2020 2020 2020 2020 2061 6c6c 6f77             allow
-00001f70: 5f72 6570 6574 6974 6976 653d 4661 6c73  _repetitive=Fals
-00001f80: 652c 2063 763d 352c 2065 6c69 7469 736d  e, cv=5, elitism
-00001f90: 3d30 2c20 7365 6d61 6e74 6963 5f76 6172  =0, semantic_var
-00001fa0: 6961 7469 6f6e 3d46 616c 7365 2c0a 2020  iation=False,.  
-00001fb0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00001fc0: 2053 6f66 742d 5053 2d54 7265 650a 2020   Soft-PS-Tree.  
-00001fd0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00001fe0: 6172 7469 7469 6f6e 5f6e 756d 6265 723d  artition_number=
-00001ff0: 342c 2070 735f 7472 6565 5f6c 6f63 616c  4, ps_tree_local
-00002000: 5f6d 6f64 656c 3d27 5269 6467 6543 5627  _model='RidgeCV'
-00002010: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00002020: 2020 2064 796e 616d 6963 5f70 6172 7469     dynamic_parti
-00002030: 7469 6f6e 3d27 5365 6c66 2d41 6461 7074  tion='Self-Adapt
-00002040: 6976 6527 2c20 6d61 785f 6c65 6166 5f6e  ive', max_leaf_n
-00002050: 6f64 6573 3d4e 6f6e 652c 2070 735f 7472  odes=None, ps_tr
-00002060: 6565 5f63 765f 6c61 6265 6c3d 5472 7565  ee_cv_label=True
-00002070: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00002080: 2020 2070 735f 7472 6565 5f70 6172 7469     ps_tree_parti
-00002090: 7469 6f6e 5f6d 6f64 656c 3d27 4465 6369  tion_model='Deci
-000020a0: 7369 6f6e 5472 6565 272c 2070 735f 7472  sionTree', ps_tr
-000020b0: 6565 5f72 6174 696f 3d30 2e31 2c0a 2020  ee_ratio=0.1,.  
-000020c0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-000020d0: 6e6c 795f 6f72 6967 696e 616c 5f66 6561  nly_original_fea
-000020e0: 7475 7265 733d 5472 7565 2c20 7368 6172  tures=True, shar
-000020f0: 6564 5f70 6172 7469 7469 6f6e 5f73 6368  ed_partition_sch
-00002100: 656d 653d 4661 6c73 652c 0a20 2020 2020  eme=False,.     
-00002110: 2020 2020 2020 2020 2020 2020 2320 4d6f              # Mo
-00002120: 7265 2050 6172 616d 6574 6572 730a 2020  re Parameters.  
-00002130: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00002140: 6e69 7469 616c 5f74 7265 655f 7369 7a65  nitial_tree_size
-00002150: 3d4e 6f6e 652c 2064 6563 6973 696f 6e5f  =None, decision_
-00002160: 7472 6565 5f63 6f75 6e74 3d32 2c20 6261  tree_count=2, ba
-00002170: 7369 635f 6765 6e65 5f6e 756d 3d30 2c0a  sic_gene_num=0,.
-00002180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002190: 2063 6c65 6172 696e 675f 636c 7573 7465   clearing_cluste
-000021a0: 725f 7369 7a65 3d30 2c20 7265 6475 6374  r_size=0, reduct
-000021b0: 696f 6e5f 7261 7469 6f3d 302c 0a20 2020  ion_ratio=0,.   
-000021c0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-000021d0: 6e64 6f6d 5f73 7461 7465 3d4e 6f6e 652c  ndom_state=None,
-000021e0: 2063 6c61 7373 5f77 6569 6768 743d 4e6f   class_weight=No
-000021f0: 6e65 2c20 6d61 705f 656c 6974 655f 7061  ne, map_elite_pa
-00002200: 7261 6d65 7465 723d 4e6f 6e65 2c0a 2020  rameter=None,.  
-00002210: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00002220: 2044 6570 7265 6361 7465 6420 7061 7261   Deprecated para
-00002230: 6d65 7465 7273 0a20 2020 2020 2020 2020  meters.         
-00002240: 2020 2020 2020 2020 626f 6f73 745f 7369          boost_si
-00002250: 7a65 3d4e 6f6e 652c 2076 616c 6964 6174  ze=None, validat
-00002260: 696f 6e5f 7369 7a65 3d30 2c20 6d61 625f  ion_size=0, mab_
-00002270: 7061 7261 6d65 7465 723d 4e6f 6e65 2c20  parameter=None, 
-00002280: 7365 6d61 6e74 6963 5f64 6976 6572 7369  semantic_diversi
-00002290: 7479 3d4e 6f6e 652c 0a20 2020 2020 2020  ty=None,.       
-000022a0: 2020 2020 2020 2020 2020 696e 7465 726c            interl
-000022b0: 6561 7669 6e67 5f70 6572 696f 643d 302c  eaving_period=0,
-000022c0: 2076 6172 5f6f 723d 4661 6c73 652c 0a20   var_or=False,. 
-000022d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000022e0: 2320 4c47 5020 6879 7065 7270 6172 616d  # LGP hyperparam
-000022f0: 6574 6572 730a 2020 2020 2020 2020 2020  eters.          
-00002300: 2020 2020 2020 206c 6770 5f6d 6f64 653d         lgp_mode=
-00002310: 4661 6c73 652c 206c 6770 5f73 636f 7065  False, lgp_scope
-00002320: 3d4e 6f6e 652c 206e 756d 6265 725f 6f66  =None, number_of
-00002330: 5f72 6567 6973 7465 723d 3130 2c20 696e  _register=10, in
-00002340: 7472 6f6e 5f70 726f 6261 6269 6c69 7479  tron_probability
-00002350: 3d30 2c0a 2020 2020 2020 2020 2020 2020  =0,.            
-00002360: 2020 2020 2072 6567 6973 7465 725f 6d75       register_mu
-00002370: 7461 7469 6f6e 5f70 726f 6261 6269 6c69  tation_probabili
-00002380: 7479 3d30 2e31 2c20 6465 6c65 7465 5f69  ty=0.1, delete_i
-00002390: 7272 656c 6576 616e 743d 5472 7565 2c0a  rrelevant=True,.
-000023a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000023b0: 2064 656c 6574 655f 7265 6475 6e64 616e   delete_redundan
-000023c0: 743d 5472 7565 2c20 6972 7265 6c65 7661  t=True, irreleva
-000023d0: 6e74 5f66 6561 7475 7265 5f72 6174 696f  nt_feature_ratio
-000023e0: 3d30 2e30 312c 2073 7472 6963 745f 6c61  =0.01, strict_la
-000023f0: 7965 725f 6c67 703d 5472 7565 2c0a 2020  yer_lgp=True,.  
-00002400: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00002410: 2055 7369 6e67 2066 6f72 2070 7265 2d73   Using for pre-s
-00002420: 656c 6563 7469 6f6e 0a20 2020 2020 2020  election.       
-00002430: 2020 2020 2020 2020 2020 636f 7272 656c            correl
-00002440: 6174 696f 6e5f 7468 7265 7368 6f6c 643d  ation_threshold=
-00002450: 4e6f 6e65 2c20 636f 7272 656c 6174 696f  None, correlatio
-00002460: 6e5f 6d6f 6465 3d4e 6f6e 652c 0a20 2020  n_mode=None,.   
-00002470: 2020 2020 2020 2020 2020 2020 2020 656e                en
-00002480: 7365 6d62 6c65 5f70 7265 6469 6374 696f  semble_predictio
-00002490: 6e3d 274d 6561 6e27 2c20 6e75 6d62 6572  n='Mean', number
-000024a0: 5f6f 665f 7061 7265 6e74 733d 302c 206f  _of_parents=0, o
-000024b0: 7574 6c69 6572 5f64 6574 6563 7469 6f6e  utlier_detection
-000024c0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-000024d0: 2020 2020 2020 2020 2063 6f6e 7374 616e           constan
-000024e0: 745f 7479 7065 3d27 496e 7427 2c20 6372  t_type='Int', cr
-000024f0: 6f73 735f 7661 6c69 6461 7469 6f6e 3d54  oss_validation=T
-00002500: 7275 652c 2066 6561 7475 7265 5f69 6d70  rue, feature_imp
-00002510: 6f72 7461 6e63 655f 6d65 7468 6f64 3d46  ortance_method=F
-00002520: 616c 7365 2c20 7365 6d61 6e74 6963 5f72  alse, semantic_r
-00002530: 6570 6169 723d 302c 0a20 2020 2020 2020  epair=0,.       
-00002540: 2020 2020 2020 2020 2020 6479 6e61 6d69            dynami
-00002550: 635f 7265 6475 6374 696f 6e3d 302c 2066  c_reduction=0, f
-00002560: 696c 7465 725f 656c 696d 696e 6174 696f  ilter_eliminatio
-00002570: 6e3d 4e6f 6e65 2c20 6163 7469 7665 5f67  n=None, active_g
-00002580: 656e 655f 6e75 6d3d 302c 2069 6e74 726f  ene_num=0, intro
-00002590: 6e5f 7468 7265 7368 6f6c 643d 302c 202a  n_threshold=0, *
-000025a0: 2a70 6172 616d 293a 0a20 2020 2020 2020  *param):.       
-000025b0: 2022 2222 0a20 2020 2020 2020 2042 6173   """.        Bas
-000025c0: 6963 2047 5020 5061 7261 6d65 7465 7273  ic GP Parameters
-000025d0: 3a0a 2020 2020 2020 2020 6e5f 706f 703a  :.        n_pop:
-000025e0: 2054 6865 2073 697a 6520 6f66 2074 6865   The size of the
-000025f0: 2070 6f70 756c 6174 696f 6e0a 2020 2020   population.    
-00002600: 2020 2020 6e5f 6765 6e3a 2054 6865 206e      n_gen: The n
-00002610: 756d 6265 7220 6f66 2067 656e 6572 6174  umber of generat
-00002620: 696f 6e73 0a20 2020 2020 2020 2076 6572  ions.        ver
-00002630: 626f 7365 3a20 5768 6574 6865 7220 746f  bose: Whether to
-00002640: 2070 7269 6e74 2076 6572 626f 7365 2069   print verbose i
-00002650: 6e66 6f72 6d61 7469 6f6e 0a20 2020 2020  nformation.     
-00002660: 2020 206d 6178 5f6c 6561 665f 6e6f 6465     max_leaf_node
-00002670: 733a 2054 6865 206d 6178 696d 756d 2068  s: The maximum h
-00002680: 6569 6768 7420 6f66 2065 6163 6820 4750  eight of each GP
-00002690: 2074 7265 650a 2020 2020 2020 2020 6261   tree.        ba
-000026a0: 7369 635f 7072 696d 6974 6976 6573 3a20  sic_primitives: 
-000026b0: 5468 6520 7072 696d 6974 6976 6520 7365  The primitive se
-000026c0: 7420 7573 6564 2069 6e20 4750 0a20 2020  t used in GP.   
-000026d0: 2020 2020 206e 6f72 6d61 6c69 7a65 3a20       normalize: 
-000026e0: 4e6f 726d 616c 697a 6174 696f 6e20 6265  Normalization be
-000026f0: 666f 7265 2066 6974 7469 6e67 2061 206d  fore fitting a m
-00002700: 6f64 656c 0a20 2020 2020 2020 2073 656c  odel.        sel
-00002710: 6563 743a 2054 6865 206e 616d 6520 6f66  ect: The name of
-00002720: 2074 6865 2073 656c 6563 7469 6f6e 206f   the selection o
-00002730: 7065 7261 746f 722c 2073 7570 706f 7274  perator, support
-00002740: 696e 6720 2254 6f75 726e 616d 656e 742d  ing "Tournament-
-00002750: 2854 6f75 726e 616d 656e 7420 5369 7a65  (Tournament Size
-00002760: 2922 2c20 224c 6578 6963 6173 6522 0a20  )", "Lexicase". 
-00002770: 2020 2020 2020 2067 656e 655f 6e75 6d3a         gene_num:
-00002780: 2054 6865 206e 756d 6265 7220 6f66 2067   The number of g
-00002790: 656e 6573 2069 6e20 6561 6368 2047 5020  enes in each GP 
-000027a0: 696e 6469 7669 6475 616c 0a20 2020 2020  individual.     
-000027b0: 2020 2065 6e73 656d 626c 655f 7369 7a65     ensemble_size
-000027c0: 3a20 5468 6520 7369 7a65 206f 6620 7468  : The size of th
-000027d0: 6520 656e 7365 6d62 6c65 206d 6f64 656c  e ensemble model
-000027e0: 0a20 2020 2020 2020 2065 7874 6572 6e61  .        externa
-000027f0: 6c5f 6172 6368 6976 653a 2055 7369 6e67  l_archive: Using
-00002800: 2061 6e20 6578 7465 726e 616c 2061 7263   an external arc
-00002810: 6869 7665 2074 6f20 7374 6f72 6520 6869  hive to store hi
-00002820: 7374 6f72 6963 616c 2062 6573 7420 7265  storical best re
-00002830: 7375 6c74 730a 2020 2020 2020 2020 6f72  sults.        or
-00002840: 6967 696e 616c 5f66 6561 7475 7265 733a  iginal_features:
-00002850: 2057 6865 7468 6572 2074 6f20 7573 6520   Whether to use 
-00002860: 6f72 6967 696e 616c 2066 6561 7475 7265  original feature
-00002870: 7320 696e 2074 6865 206d 6f64 656c 206f  s in the model o
-00002880: 7220 6e6f 740a 2020 2020 2020 2020 6469  r not.        di
-00002890: 7665 7273 6974 795f 7365 6172 6368 3a20  versity_search: 
-000028a0: 5468 6520 6e61 6d65 2073 7472 6174 6567  The name strateg
-000028b0: 7920 746f 2064 6972 6563 746c 7920 656e  y to directly en
-000028c0: 6861 6e63 6520 7468 6520 6469 7665 7273  hance the divers
-000028d0: 6974 790a 2020 2020 2020 2020 6372 6f73  ity.        cros
-000028e0: 735f 7062 3a20 5468 6520 7072 6f62 6162  s_pb: The probab
-000028f0: 696c 6974 7920 6f66 2063 726f 7373 6f76  ility of crossov
-00002900: 6572 0a20 2020 2020 2020 206d 7574 6174  er.        mutat
-00002910: 696f 6e5f 7062 3a20 5468 6520 7072 6f62  ion_pb: The prob
-00002920: 6162 696c 6974 7920 6f66 206d 7574 6174  ability of mutat
-00002930: 696f 6e0a 2020 2020 2020 2020 7365 636f  ion.        seco
-00002940: 6e64 5f6c 6179 6572 3a20 5468 6520 7374  nd_layer: The st
-00002950: 7261 7465 6779 2074 6f20 696e 6475 6365  rategy to induce
-00002960: 2061 2073 6563 6f6e 6420 6c61 7965 7220   a second layer 
-00002970: 746f 2061 7373 6967 6e20 6469 6666 6572  to assign differ
-00002980: 656e 7420 7765 6967 6874 7320 666f 7220  ent weights for 
-00002990: 7468 6520 6d65 6d62 6572 2069 6e20 7468  the member in th
-000029a0: 6520 656e 7365 6d62 6c65 0a20 2020 2020  e ensemble.     
-000029b0: 2020 2073 656d 616e 7469 635f 6469 7665     semantic_dive
-000029c0: 7273 6974 793a 2054 6865 2073 7472 6174  rsity: The strat
-000029d0: 6567 7920 746f 206d 6169 6e74 6169 6e20  egy to maintain 
-000029e0: 7468 6520 6469 7665 7273 6974 7920 6f66  the diversity of
-000029f0: 2074 6865 2065 6e73 656d 626c 6520 6d6f   the ensemble mo
-00002a00: 6465 6c0a 0a20 2020 2020 2020 2053 6f66  del..        Sof
-00002a10: 7420 5053 2d54 7265 6520 5061 7261 6d65  t PS-Tree Parame
-00002a20: 7465 7273 3a0a 2020 2020 2020 2020 7368  ters:.        sh
-00002a30: 6172 6564 5f70 6172 7469 7469 6f6e 5f73  ared_partition_s
-00002a40: 6368 656d 653a 2041 6c6c 2069 6e64 6976  cheme: All indiv
-00002a50: 6964 7561 6c73 2075 7365 2061 2073 6861  iduals use a sha
-00002a60: 7265 6420 7061 7274 6974 696f 6e20 7363  red partition sc
-00002a70: 6865 6d65 0a0a 2020 2020 2020 2020 504c  heme..        PL
-00002a80: 2d54 7265 6520 5061 7261 6d65 7465 7273  -Tree Parameters
-00002a90: 3a0a 2020 2020 2020 2020 6465 6369 7369  :.        decisi
-00002aa0: 6f6e 5f74 7265 655f 636f 756e 743a 204e  on_tree_count: N
-00002ab0: 756d 6265 7220 6f66 2070 6965 6365 7769  umber of piecewi
-00002ac0: 7365 2074 7265 6573 2069 6e20 6120 504c  se trees in a PL
-00002ad0: 2d54 7265 650a 0a20 2020 2020 2020 2045  -Tree..        E
-00002ae0: 4120 5061 7261 6d65 7465 7273 3a0a 2020  A Parameters:.  
-00002af0: 2020 2020 2020 7265 6475 6374 696f 6e5f        reduction_
-00002b00: 7261 7469 6f3a 2050 7265 2d73 656c 6563  ratio: Pre-selec
-00002b10: 7469 6f6e 2062 6173 6564 206f 6e20 6669  tion based on fi
-00002b20: 6c74 6572 730a 0a20 2020 2020 2020 206d  lters..        m
-00002b30: 6170 5f65 6c69 7465 5f70 6172 616d 6574  ap_elite_paramet
-00002b40: 6572 3a20 4879 7065 722d 7061 7261 6d65  er: Hyper-parame
-00002b50: 7465 7273 2066 6f72 204d 4150 2d45 6c69  ters for MAP-Eli
-00002b60: 7465 0a20 2020 2020 2020 2022 2222 0a20  te.        """. 
-00002b70: 2020 2020 2020 2073 7570 6572 2853 7572         super(Sur
-00002b80: 726f 6761 7465 4d6f 6465 6c2c 2073 656c  rogateModel, sel
-00002b90: 6629 2e5f 5f69 6e69 745f 5f28 290a 2020  f).__init__().  
-00002ba0: 2020 2020 2020 7375 7065 7228 5370 6163        super(Spac
-00002bb0: 6550 6172 7469 7469 6f6e 2c20 7365 6c66  ePartition, self
-00002bc0: 292e 5f5f 696e 6974 5f5f 2829 0a20 2020  ).__init__().   
-00002bd0: 2020 2020 2073 7570 6572 2845 7374 696d       super(Estim
-00002be0: 6174 696f 6e4f 6644 6973 7472 6962 7574  ationOfDistribut
-00002bf0: 696f 6e2c 2073 656c 6629 2e5f 5f69 6e69  ion, self).__ini
-00002c00: 745f 5f28 290a 2020 2020 2020 2020 7365  t__().        se
-00002c10: 6c66 2e69 6e74 726f 6e5f 7468 7265 7368  lf.intron_thresh
-00002c20: 6f6c 6420 3d20 696e 7472 6f6e 5f74 6872  old = intron_thr
-00002c30: 6573 686f 6c64 0a20 2020 2020 2020 2073  eshold.        s
-00002c40: 656c 662e 6163 7469 7665 5f67 656e 655f  elf.active_gene_
-00002c50: 6e75 6d20 3d20 6163 7469 7665 5f67 656e  num = active_gen
-00002c60: 655f 6e75 6d0a 2020 2020 2020 2020 7365  e_num.        se
-00002c70: 6c66 2e66 696c 7465 725f 656c 696d 696e  lf.filter_elimin
-00002c80: 6174 696f 6e20 3d20 6669 6c74 6572 5f65  ation = filter_e
-00002c90: 6c69 6d69 6e61 7469 6f6e 0a20 2020 2020  limination.     
-00002ca0: 2020 2073 656c 662e 6479 6e61 6d69 635f     self.dynamic_
-00002cb0: 7265 6475 6374 696f 6e20 3d20 6479 6e61  reduction = dyna
-00002cc0: 6d69 635f 7265 6475 6374 696f 6e0a 2020  mic_reduction.  
-00002cd0: 2020 2020 2020 7365 6c66 2e69 7272 656c        self.irrel
-00002ce0: 6576 616e 745f 6665 6174 7572 655f 7261  evant_feature_ra
-00002cf0: 7469 6f20 3d20 6972 7265 6c65 7661 6e74  tio = irrelevant
-00002d00: 5f66 6561 7475 7265 5f72 6174 696f 0a20  _feature_ratio. 
-00002d10: 2020 2020 2020 2073 656c 662e 7265 6475         self.redu
-00002d20: 6e64 616e 745f 6665 6174 7572 6573 203d  ndant_features =
-00002d30: 2030 0a20 2020 2020 2020 2073 656c 662e   0.        self.
-00002d40: 7265 6475 6e64 616e 745f 6665 6174 7572  redundant_featur
-00002d50: 6573 5f68 6973 746f 7279 203d 205b 5d0a  es_history = [].
-00002d60: 2020 2020 2020 2020 7365 6c66 2e69 7272          self.irr
-00002d70: 656c 6576 616e 745f 6665 6174 7572 6573  elevant_features
-00002d80: 203d 2030 0a20 2020 2020 2020 2073 656c   = 0.        sel
-00002d90: 662e 6972 7265 6c65 7661 6e74 5f66 6561  f.irrelevant_fea
-00002da0: 7475 7265 735f 6869 7374 6f72 7920 3d20  tures_history = 
-00002db0: 5b5d 0a20 2020 2020 2020 2073 656c 662e  [].        self.
-00002dc0: 6465 6c65 7465 5f69 7272 656c 6576 616e  delete_irrelevan
-00002dd0: 7420 3d20 6465 6c65 7465 5f69 7272 656c  t = delete_irrel
-00002de0: 6576 616e 740a 2020 2020 2020 2020 7365  evant.        se
-00002df0: 6c66 2e64 656c 6574 655f 7265 6475 6e64  lf.delete_redund
-00002e00: 616e 7420 3d20 6465 6c65 7465 5f72 6564  ant = delete_red
-00002e10: 756e 6461 6e74 0a20 2020 2020 2020 2073  undant.        s
-00002e20: 656c 662e 7265 6769 7374 6572 5f6d 7574  elf.register_mut
-00002e30: 6174 696f 6e5f 7072 6f62 6162 696c 6974  ation_probabilit
-00002e40: 7920 3d20 7265 6769 7374 6572 5f6d 7574  y = register_mut
-00002e50: 6174 696f 6e5f 7072 6f62 6162 696c 6974  ation_probabilit
-00002e60: 790a 2020 2020 2020 2020 7365 6c66 2e69  y.        self.i
-00002e70: 6e74 726f 6e5f 7072 6f62 6162 696c 6974  ntron_probabilit
-00002e80: 7920 3d20 696e 7472 6f6e 5f70 726f 6261  y = intron_proba
-00002e90: 6269 6c69 7479 0a20 2020 2020 2020 2073  bility.        s
-00002ea0: 656c 662e 7374 7269 6374 5f6c 6179 6572  elf.strict_layer
-00002eb0: 5f6c 6770 203d 2073 7472 6963 745f 6c61  _lgp = strict_la
-00002ec0: 7965 725f 6c67 700a 2020 2020 2020 2020  yer_lgp.        
-00002ed0: 7365 6c66 2e66 6561 7475 7265 5f69 6d70  self.feature_imp
-00002ee0: 6f72 7461 6e63 655f 6d65 7468 6f64 203d  ortance_method =
-00002ef0: 2066 6561 7475 7265 5f69 6d70 6f72 7461   feature_importa
-00002f00: 6e63 655f 6d65 7468 6f64 0a20 2020 2020  nce_method.     
-00002f10: 2020 2073 656c 662e 6372 6f73 735f 7661     self.cross_va
-00002f20: 6c69 6461 7469 6f6e 203d 2063 726f 7373  lidation = cross
-00002f30: 5f76 616c 6964 6174 696f 6e0a 2020 2020  _validation.    
-00002f40: 2020 2020 7365 6c66 2e63 6f6e 7374 616e      self.constan
-00002f50: 745f 7479 7065 203d 2063 6f6e 7374 616e  t_type = constan
-00002f60: 745f 7479 7065 0a20 2020 2020 2020 2073  t_type.        s
-00002f70: 656c 662e 6e75 6d62 6572 5f6f 665f 7061  elf.number_of_pa
-00002f80: 7265 6e74 7320 3d20 6e75 6d62 6572 5f6f  rents = number_o
-00002f90: 665f 7061 7265 6e74 730a 2020 2020 2020  f_parents.      
-00002fa0: 2020 7365 6c66 2e65 6e73 656d 626c 655f    self.ensemble_
-00002fb0: 7072 6564 6963 7469 6f6e 203d 2065 6e73  prediction = ens
-00002fc0: 656d 626c 655f 7072 6564 6963 7469 6f6e  emble_prediction
-00002fd0: 0a20 2020 2020 2020 2073 656c 662e 6c61  .        self.la
-00002fe0: 7965 725f 6c67 7020 3d20 4661 6c73 650a  yer_lgp = False.
-00002ff0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00003000: 7461 6e63 6528 6c67 705f 7363 6f70 652c  tance(lgp_scope,
-00003010: 2073 7472 293a 0a20 2020 2020 2020 2020   str):.         
-00003020: 2020 206c 6770 5f73 636f 7065 203d 2069     lgp_scope = i
-00003030: 6e74 286c 6770 5f73 636f 7065 2e72 6570  nt(lgp_scope.rep
-00003040: 6c61 6365 2827 5374 7269 6374 2d27 2c20  lace('Strict-', 
-00003050: 2727 2929 0a20 2020 2020 2020 2020 2020  '')).           
-00003060: 2073 656c 662e 6c61 7965 725f 6c67 7020   self.layer_lgp 
-00003070: 3d20 5472 7565 0a20 2020 2020 2020 2073  = True.        s
-00003080: 656c 662e 6c67 705f 7363 6f70 6520 3d20  elf.lgp_scope = 
-00003090: 6c67 705f 7363 6f70 650a 2020 2020 2020  lgp_scope.      
-000030a0: 2020 7365 6c66 2e73 656d 616e 7469 635f    self.semantic_
-000030b0: 7661 7269 6174 696f 6e20 3d20 7365 6d61  variation = sema
-000030c0: 6e74 6963 5f76 6172 6961 7469 6f6e 0a20  ntic_variation. 
-000030d0: 2020 2020 2020 2073 656c 662e 6d61 625f         self.mab_
-000030e0: 7061 7261 6d65 7465 7220 3d20 7b7d 2069  parameter = {} i
-000030f0: 6620 6d61 625f 7061 7261 6d65 7465 7220  f mab_parameter 
-00003100: 6973 204e 6f6e 6520 656c 7365 206d 6162  is None else mab
-00003110: 5f70 6172 616d 6574 6572 0a20 2020 2020  _parameter.     
-00003120: 2020 2073 656c 662e 7661 6c69 6461 7469     self.validati
-00003130: 6f6e 5f73 697a 6520 3d20 7661 6c69 6461  on_size = valida
-00003140: 7469 6f6e 5f73 697a 650a 2020 2020 2020  tion_size.      
-00003150: 2020 7365 6c66 2e63 6c61 7373 5f77 6569    self.class_wei
-00003160: 6768 7420 3d20 636c 6173 735f 7765 6967  ght = class_weig
-00003170: 6874 0a20 2020 2020 2020 2069 6620 7261  ht.        if ra
-00003180: 6e64 6f6d 5f73 7461 7465 2021 3d20 4e6f  ndom_state != No
-00003190: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-000031a0: 7265 7365 745f 7261 6e64 6f6d 2872 616e  reset_random(ran
-000031b0: 646f 6d5f 7374 6174 6529 0a20 2020 2020  dom_state).     
-000031c0: 2020 2073 656c 662e 7261 6e64 6f6d 5f73     self.random_s
-000031d0: 7461 7465 203d 2072 616e 646f 6d5f 7374  tate = random_st
-000031e0: 6174 650a 2020 2020 2020 2020 7365 6c66  ate.        self
-000031f0: 2e72 6564 7563 7469 6f6e 5f72 6174 696f  .reduction_ratio
-00003200: 203d 2072 6564 7563 7469 6f6e 5f72 6174   = reduction_rat
-00003210: 696f 0a20 2020 2020 2020 2073 656c 662e  io.        self.
-00003220: 636c 6561 7269 6e67 5f63 6c75 7374 6572  clearing_cluster
-00003230: 5f73 697a 6520 3d20 636c 6561 7269 6e67  _size = clearing
-00003240: 5f63 6c75 7374 6572 5f73 697a 650a 2020  _cluster_size.  
-00003250: 2020 2020 2020 7365 6c66 2e6c 6770 5f6d        self.lgp_m
-00003260: 6f64 6520 3d20 6c67 705f 6d6f 6465 0a20  ode = lgp_mode. 
-00003270: 2020 2020 2020 2073 656c 662e 6261 7369         self.basi
-00003280: 635f 6765 6e65 5f6e 756d 203d 2062 6173  c_gene_num = bas
-00003290: 6963 5f67 656e 655f 6e75 6d0a 2020 2020  ic_gene_num.    
-000032a0: 2020 2020 7365 6c66 2e64 6563 6973 696f      self.decisio
-000032b0: 6e5f 7472 6565 5f63 6f75 6e74 203d 2064  n_tree_count = d
-000032c0: 6563 6973 696f 6e5f 7472 6565 5f63 6f75  ecision_tree_cou
-000032d0: 6e74 0a20 2020 2020 2020 2073 656c 662e  nt.        self.
-000032e0: 7368 6172 6564 5f70 6172 7469 7469 6f6e  shared_partition
-000032f0: 5f73 6368 656d 6520 3d20 7368 6172 6564  _scheme = shared
-00003300: 5f70 6172 7469 7469 6f6e 5f73 6368 656d  _partition_schem
-00003310: 650a 2020 2020 2020 2020 7365 6c66 2e6f  e.        self.o
-00003320: 6e6c 795f 6f72 6967 696e 616c 5f66 6561  nly_original_fea
-00003330: 7475 7265 7320 3d20 6f6e 6c79 5f6f 7269  tures = only_ori
-00003340: 6769 6e61 6c5f 6665 6174 7572 6573 0a20  ginal_features. 
-00003350: 2020 2020 2020 2073 656c 662e 696e 6974         self.init
-00003360: 6961 6c5f 7472 6565 5f73 697a 6520 3d20  ial_tree_size = 
-00003370: 696e 6974 6961 6c5f 7472 6565 5f73 697a  initial_tree_siz
-00003380: 650a 2020 2020 2020 2020 7365 6c66 2e70  e.        self.p
-00003390: 735f 7472 6565 5f70 6172 7469 7469 6f6e  s_tree_partition
-000033a0: 5f6d 6f64 656c 203d 2070 735f 7472 6565  _model = ps_tree
-000033b0: 5f70 6172 7469 7469 6f6e 5f6d 6f64 656c  _partition_model
-000033c0: 0a20 2020 2020 2020 2073 656c 662e 7073  .        self.ps
-000033d0: 5f74 7265 655f 6376 5f6c 6162 656c 203d  _tree_cv_label =
-000033e0: 2070 735f 7472 6565 5f63 765f 6c61 6265   ps_tree_cv_labe
-000033f0: 6c0a 2020 2020 2020 2020 7365 6c66 2e61  l.        self.a
-00003400: 6c6c 6f77 5f72 6570 6574 6974 6976 6520  llow_repetitive 
-00003410: 3d20 616c 6c6f 775f 7265 7065 7469 7469  = allow_repetiti
-00003420: 7665 0a20 2020 2020 2020 2073 656c 662e  ve.        self.
-00003430: 7072 655f 7365 6c65 6374 696f 6e20 3d20  pre_selection = 
-00003440: 7072 655f 7365 6c65 6374 696f 6e0a 2020  pre_selection.  
-00003450: 2020 2020 2020 7365 6c66 2e6d 6178 5f74        self.max_t
-00003460: 7265 655f 6465 7074 6820 3d20 6d61 785f  ree_depth = max_
-00003470: 7472 6565 5f64 6570 7468 0a20 2020 2020  tree_depth.     
-00003480: 2020 2073 656c 662e 656c 6974 6973 6d20     self.elitism 
-00003490: 3d20 656c 6974 6973 6d0a 2020 2020 2020  = elitism.      
-000034a0: 2020 7365 6c66 2e73 636f 7265 5f66 756e    self.score_fun
-000034b0: 6320 3d20 7363 6f72 655f 6675 6e63 0a20  c = score_func. 
-000034c0: 2020 2020 2020 2073 656c 662e 6d69 6e5f         self.min_
-000034d0: 7361 6d70 6c65 735f 6c65 6166 203d 206d  samples_leaf = m
-000034e0: 696e 5f73 616d 706c 6573 5f6c 6561 660a  in_samples_leaf.
-000034f0: 2020 2020 2020 2020 7365 6c66 2e6d 6561          self.mea
-00003500: 6e5f 6d6f 6465 6c20 3d20 6d65 616e 5f6d  n_model = mean_m
-00003510: 6f64 656c 0a20 2020 2020 2020 2073 656c  odel.        sel
-00003520: 662e 6261 7365 5f6c 6561 726e 6572 203d  f.base_learner =
-00003530: 2062 6173 655f 6c65 6172 6e65 720a 2020   base_learner.  
-00003540: 2020 2020 2020 7365 6c66 2e62 6f6f 7473        self.boots
-00003550: 7472 6170 5f74 7261 696e 696e 6720 3d20  trap_training = 
-00003560: 626f 6f74 7374 7261 705f 7472 6169 6e69  bootstrap_traini
-00003570: 6e67 0a20 2020 2020 2020 2073 656c 662e  ng.        self.
-00003580: 7365 6d61 6e74 6963 5f64 6976 6572 7369  semantic_diversi
-00003590: 7479 203d 2073 656d 616e 7469 635f 6469  ty = semantic_di
-000035a0: 7665 7273 6974 790a 2020 2020 2020 2020  versity.        
-000035b0: 7365 6c66 2e65 6e73 656d 626c 655f 7365  self.ensemble_se
-000035c0: 6c65 6374 696f 6e20 3d20 656e 7365 6d62  lection = ensemb
-000035d0: 6c65 5f73 656c 6563 7469 6f6e 2069 6620  le_selection if 
-000035e0: 7365 6d61 6e74 6963 5f64 6976 6572 7369  semantic_diversi
-000035f0: 7479 2069 7320 4e6f 6e65 2065 6c73 6520  ty is None else 
-00003600: 7365 6d61 6e74 6963 5f64 6976 6572 7369  semantic_diversi
-00003610: 7479 0a20 2020 2020 2020 2073 656c 662e  ty.        self.
-00003620: 6f72 6967 696e 616c 5f66 6561 7475 7265  original_feature
-00003630: 7320 3d20 6f72 6967 696e 616c 5f66 6561  s = original_fea
-00003640: 7475 7265 730a 2020 2020 2020 2020 7365  tures.        se
-00003650: 6c66 2e65 7874 6572 6e61 6c5f 6172 6368  lf.external_arch
-00003660: 6976 6520 3d20 6578 7465 726e 616c 5f61  ive = external_a
-00003670: 7263 6869 7665 0a20 2020 2020 2020 2073  rchive.        s
-00003680: 656c 662e 626f 6f73 745f 7369 7a65 203d  elf.boost_size =
-00003690: 2062 6f6f 7374 5f73 697a 650a 2020 2020   boost_size.    
-000036a0: 2020 2020 7365 6c66 2e65 6e73 656d 626c      self.ensembl
-000036b0: 655f 7369 7a65 203d 2065 6e73 656d 626c  e_size = ensembl
-000036c0: 655f 7369 7a65 2069 6620 626f 6f73 745f  e_size if boost_
-000036d0: 7369 7a65 2069 7320 4e6f 6e65 2065 6c73  size is None els
-000036e0: 6520 696e 7428 626f 6f73 745f 7369 7a65  e int(boost_size
-000036f0: 290a 2020 2020 2020 2020 7365 6c66 2e6d  ).        self.m
-00003700: 7574 6174 696f 6e5f 7363 6865 6d65 203d  utation_scheme =
-00003710: 206d 7574 6174 696f 6e5f 7363 6865 6d65   mutation_scheme
-00003720: 0a20 2020 2020 2020 2073 656c 662e 6e5f  .        self.n_
-00003730: 706f 7020 3d20 6e5f 706f 700a 2020 2020  pop = n_pop.    
-00003740: 2020 2020 7365 6c66 2e6e 5f67 656e 203d      self.n_gen =
-00003750: 206e 5f67 656e 0a20 2020 2020 2020 2073   n_gen.        s
-00003760: 656c 662e 7665 7262 6f73 6520 3d20 7665  elf.verbose = ve
-00003770: 7262 6f73 650a 2020 2020 2020 2020 7365  rbose.        se
-00003780: 6c66 2e6d 6178 5f68 6569 6768 743a 2055  lf.max_height: U
-00003790: 6e69 6f6e 5b73 7472 2c20 696e 745d 203d  nion[str, int] =
-000037a0: 206d 6178 5f68 6569 6768 740a 2020 2020   max_height.    
-000037b0: 2020 2020 7365 6c66 2e6d 696e 5f68 6569      self.min_hei
-000037c0: 6768 7420 3d20 6d69 6e5f 6865 6967 6874  ght = min_height
-000037d0: 0a20 2020 2020 2020 2073 656c 662e 696e  .        self.in
-000037e0: 6974 6961 6c69 7a65 6420 3d20 4661 6c73  itialized = Fals
-000037f0: 650a 2020 2020 2020 2020 7365 6c66 2e65  e.        self.e
-00003800: 7661 6c75 6174 6564 5f70 6f70 203d 2073  valuated_pop = s
-00003810: 6574 2829 0a20 2020 2020 2020 2073 656c  et().        sel
-00003820: 662e 6765 6e65 7261 7465 645f 6665 6174  f.generated_feat
-00003830: 7572 6573 203d 2073 6574 2829 0a20 2020  ures = set().   
-00003840: 2020 2020 2073 656c 662e 706f 703a 204c       self.pop: L
-00003850: 6973 745b 4d75 6c74 6970 6c65 4765 6e65  ist[MultipleGene
-00003860: 4750 5d20 3d20 5b5d 0a20 2020 2020 2020  GP] = [].       
-00003870: 2073 656c 662e 6261 7369 635f 7072 696d   self.basic_prim
-00003880: 6974 6976 6573 203d 2062 6173 6963 5f70  itives = basic_p
-00003890: 7269 6d69 7469 7665 730a 2020 2020 2020  rimitives.      
-000038a0: 2020 7365 6c66 2e73 656c 6563 7420 3d20    self.select = 
-000038b0: 7365 6c65 6374 0a20 2020 2020 2020 2073  select.        s
-000038c0: 656c 662e 6765 6e65 5f6e 756d 203d 2067  elf.gene_num = g
-000038d0: 656e 655f 6e75 6d0a 2020 2020 2020 2020  ene_num.        
-000038e0: 7365 6c66 2e70 6172 616d 203d 2070 6172  self.param = par
-000038f0: 616d 0a20 2020 2020 2020 2073 656c 662e  am.        self.
-00003900: 6469 7665 7273 6974 795f 7365 6172 6368  diversity_search
-00003910: 203d 2064 6976 6572 7369 7479 5f73 6561   = diversity_sea
-00003920: 7263 680a 2020 2020 2020 2020 7365 6c66  rch.        self
-00003930: 2e73 6563 6f6e 645f 6c61 7965 7220 3d20  .second_layer = 
-00003940: 7365 636f 6e64 5f6c 6179 6572 0a20 2020  second_layer.   
-00003950: 2020 2020 2073 656c 662e 7465 7374 5f66       self.test_f
-00003960: 756e 3a20 4c69 7374 5b54 6573 7446 756e  un: List[TestFun
-00003970: 6374 696f 6e5d 203d 2074 6573 745f 6675  ction] = test_fu
-00003980: 6e0a 2020 2020 2020 2020 7365 6c66 2e74  n.        self.t
-00003990: 7261 696e 5f64 6174 615f 6869 7374 6f72  rain_data_histor
-000039a0: 7920 3d20 5b5d 0a20 2020 2020 2020 2073  y = [].        s
-000039b0: 656c 662e 7465 7374 5f64 6174 615f 6869  elf.test_data_hi
-000039c0: 7374 6f72 7920 3d20 5b5d 0a20 2020 2020  story = [].     
-000039d0: 2020 2023 2061 7665 7261 6765 2066 6974     # average fit
-000039e0: 6e65 7373 206f 6620 7468 6520 656e 7365  ness of the ense
-000039f0: 6d62 6c65 206d 6f64 656c 0a20 2020 2020  mble model.     
-00003a00: 2020 2073 656c 662e 6172 6368 6976 655f     self.archive_
-00003a10: 6669 746e 6573 735f 6869 7374 6f72 7920  fitness_history 
-00003a20: 3d20 5b5d 0a20 2020 2020 2020 2023 2061  = [].        # a
-00003a30: 7665 7261 6765 2064 6976 6572 7369 7479  verage diversity
-00003a40: 206f 6620 7468 6520 656e 7365 6d62 6c65   of the ensemble
-00003a50: 206d 6f64 656c 0a20 2020 2020 2020 2073   model.        s
-00003a60: 656c 662e 6172 6368 6976 655f 6469 7665  elf.archive_dive
-00003a70: 7273 6974 795f 6869 7374 6f72 7920 3d20  rsity_history = 
-00003a80: 5b5d 0a20 2020 2020 2020 2023 2061 7665  [].        # ave
-00003a90: 7261 6765 2064 6976 6572 7369 7479 206f  rage diversity o
-00003aa0: 6620 7468 6520 656e 7365 6d62 6c65 206d  f the ensemble m
-00003ab0: 6f64 656c 0a20 2020 2020 2020 2073 656c  odel.        sel
-00003ac0: 662e 6172 6368 6976 655f 636f 735f 7369  f.archive_cos_si
-00003ad0: 6d69 6c61 7269 7479 5f68 6973 746f 7279  milarity_history
-00003ae0: 203d 205b 5d0a 2020 2020 2020 2020 2320   = [].        # 
-00003af0: 6176 6572 6167 6520 6669 746e 6573 7320  average fitness 
-00003b00: 6f66 2074 6865 2070 6f70 756c 6174 696f  of the populatio
-00003b10: 6e0a 2020 2020 2020 2020 7365 6c66 2e66  n.        self.f
-00003b20: 6974 6e65 7373 5f68 6973 746f 7279 203d  itness_history =
-00003b30: 205b 5d0a 2020 2020 2020 2020 2320 6176   [].        # av
-00003b40: 6572 6167 6520 6469 7665 7273 6974 7920  erage diversity 
-00003b50: 6f66 2074 6865 2070 6f70 756c 6174 696f  of the populatio
-00003b60: 6e0a 2020 2020 2020 2020 7365 6c66 2e64  n.        self.d
-00003b70: 6976 6572 7369 7479 5f68 6973 746f 7279  iversity_history
-00003b80: 203d 205b 5d0a 2020 2020 2020 2020 2320   = [].        # 
-00003b90: 6265 7374 2066 6974 6e65 7373 206f 6620  best fitness of 
-00003ba0: 7468 6520 656e 7365 6d62 6c65 206d 6f64  the ensemble mod
-00003bb0: 656c 0a20 2020 2020 2020 2073 656c 662e  el.        self.
-00003bc0: 6265 7374 5f66 6974 6e65 7373 5f68 6973  best_fitness_his
-00003bd0: 746f 7279 203d 205b 5d0a 2020 2020 2020  tory = [].      
-00003be0: 2020 7365 6c66 2e6f 7065 7261 746f 725f    self.operator_
-00003bf0: 7365 6c65 6374 696f 6e5f 6869 7374 6f72  selection_histor
-00003c00: 7920 3d20 5b5d 0a20 2020 2020 2020 2023  y = [].        #
-00003c10: 2061 7665 7261 6765 2066 6974 6e65 7373   average fitness
-00003c20: 206f 6620 696e 6469 7669 6475 616c 7320   of individuals 
-00003c30: 696e 2067 7269 640a 2020 2020 2020 2020  in grid.        
-00003c40: 7365 6c66 2e65 6c69 7465 5f67 7269 645f  self.elite_grid_
-00003c50: 6176 675f 6669 746e 6573 735f 6869 7374  avg_fitness_hist
-00003c60: 6f72 7920 3d20 5b5d 0a20 2020 2020 2020  ory = [].       
-00003c70: 2023 2061 7665 7261 6765 2064 6976 6572   # average diver
-00003c80: 7369 7479 206f 6620 696e 6469 7669 6475  sity of individu
-00003c90: 616c 7320 696e 2067 7269 640a 2020 2020  als in grid.    
-00003ca0: 2020 2020 7365 6c66 2e65 6c69 7465 5f67      self.elite_g
-00003cb0: 7269 645f 6176 675f 6469 7665 7273 6974  rid_avg_diversit
-00003cc0: 795f 6869 7374 6f72 7920 3d20 5b5d 0a20  y_history = []. 
-00003cd0: 2020 2020 2020 2023 2066 696e 616c 204d         # final M
-00003ce0: 4150 2d45 6c69 7465 2067 7269 640a 2020  AP-Elite grid.  
-00003cf0: 2020 2020 2020 7365 6c66 2e66 696e 616c        self.final
-00003d00: 5f65 6c69 7465 5f67 7269 6420 3d20 5b5d  _elite_grid = []
-00003d10: 0a20 2020 2020 2020 2073 656c 662e 6561  .        self.ea
-00003d20: 726c 795f 7374 6f70 203d 2065 6172 6c79  rly_stop = early
-00003d30: 5f73 746f 700a 2020 2020 2020 2020 7365  _stop.        se
-00003d40: 6c66 2e65 6e76 6972 6f6e 6d65 6e74 616c  lf.environmental
-00003d50: 5f73 656c 6563 7469 6f6e 203d 2065 6e76  _selection = env
-00003d60: 6972 6f6e 6d65 6e74 616c 5f73 656c 6563  ironmental_selec
-00003d70: 7469 6f6e 0a20 2020 2020 2020 2073 656c  tion.        sel
-00003d80: 662e 6561 6765 725f 7472 6169 6e69 6e67  f.eager_training
-00003d90: 203d 2065 6167 6572 5f74 7261 696e 696e   = eager_trainin
-00003da0: 670a 2020 2020 2020 2020 7365 6c66 2e63  g.        self.c
-00003db0: 7572 7265 6e74 5f68 6569 6768 7420 3d20  urrent_height = 
-00003dc0: 310a 2020 2020 2020 2020 7365 6c66 2e72  1.        self.r
-00003dd0: 6570 6574 6974 6976 655f 6665 6174 7572  epetitive_featur
-00003de0: 655f 636f 756e 7420 3d20 5b5d 0a20 2020  e_count = [].   
-00003df0: 2020 2020 2073 656c 662e 7573 656c 6573       self.useles
-00003e00: 735f 6665 6174 7572 655f 7261 7469 6f20  s_feature_ratio 
-00003e10: 3d20 7573 656c 6573 735f 6665 6174 7572  = useless_featur
-00003e20: 655f 7261 7469 6f0a 2020 2020 2020 2020  e_ratio.        
-00003e30: 7365 6c66 2e77 6569 6768 7465 645f 636f  self.weighted_co
-00003e40: 6566 203d 2077 6569 6768 7465 645f 636f  ef = weighted_co
-00003e50: 6566 0a20 2020 2020 2020 2073 656c 662e  ef.        self.
-00003e60: 6665 6174 7572 655f 7365 6c65 6374 696f  feature_selectio
-00003e70: 6e20 3d20 6665 6174 7572 655f 7365 6c65  n = feature_sele
-00003e80: 6374 696f 6e0a 2020 2020 2020 2020 7365  ction.        se
-00003e90: 6c66 2e63 7620 3d20 6376 0a20 2020 2020  lf.cv = cv.     
-00003ea0: 2020 2073 656c 662e 7374 6167 655f 666c     self.stage_fl
-00003eb0: 6167 203d 2046 616c 7365 0a20 2020 2020  ag = False.     
-00003ec0: 2020 2073 656c 662e 6d61 705f 656c 6974     self.map_elit
-00003ed0: 655f 7061 7261 6d65 7465 7220 3d20 7b7d  e_parameter = {}
-00003ee0: 2069 6620 6d61 705f 656c 6974 655f 7061   if map_elite_pa
-00003ef0: 7261 6d65 7465 7220 6973 204e 6f6e 6520  rameter is None 
-00003f00: 656c 7365 206d 6170 5f65 6c69 7465 5f70  else map_elite_p
-00003f10: 6172 616d 6574 6572 0a20 2020 2020 2020  arameter.       
-00003f20: 2073 656c 662e 6e75 6d62 6572 5f6f 665f   self.number_of_
-00003f30: 7265 6769 7374 6572 203d 206e 756d 6265  register = numbe
-00003f40: 725f 6f66 5f72 6567 6973 7465 720a 2020  r_of_register.  
-00003f50: 2020 2020 2020 7365 6c66 2e63 6f72 7265        self.corre
-00003f60: 6c61 7469 6f6e 5f74 6872 6573 686f 6c64  lation_threshold
-00003f70: 203d 2063 6f72 7265 6c61 7469 6f6e 5f74   = correlation_t
-00003f80: 6872 6573 686f 6c64 0a20 2020 2020 2020  hreshold.       
-00003f90: 2073 656c 662e 636f 7272 656c 6174 696f   self.correlatio
-00003fa0: 6e5f 6d6f 6465 203d 2063 6f72 7265 6c61  n_mode = correla
-00003fb0: 7469 6f6e 5f6d 6f64 650a 2020 2020 2020  tion_mode.      
-00003fc0: 2020 7365 6c66 2e6f 7574 6c69 6572 5f64    self.outlier_d
-00003fd0: 6574 6563 7469 6f6e 203d 206f 7574 6c69  etection = outli
-00003fe0: 6572 5f64 6574 6563 7469 6f6e 0a0a 2020  er_detection..  
-00003ff0: 2020 2020 2020 7365 6c66 2e63 726f 7373        self.cross
-00004000: 5f70 6220 3d20 6372 6f73 735f 7062 0a20  _pb = cross_pb. 
-00004010: 2020 2020 2020 2073 656c 662e 6d75 7461         self.muta
-00004020: 7469 6f6e 5f70 6220 3d20 6d75 7461 7469  tion_pb = mutati
-00004030: 6f6e 5f70 620a 2020 2020 2020 2020 7365  on_pb.        se
-00004040: 6c66 2e63 7572 7265 6e74 5f67 656e 203d  lf.current_gen =
-00004050: 2030 0a20 2020 2020 2020 2073 656c 662e   0.        self.
-00004060: 7061 7274 6974 696f 6e5f 6e75 6d62 6572  partition_number
-00004070: 203d 2070 6172 7469 7469 6f6e 5f6e 756d   = partition_num
-00004080: 6265 720a 2020 2020 2020 2020 7365 6c66  ber.        self
-00004090: 2e70 735f 7472 6565 5f6c 6f63 616c 5f6d  .ps_tree_local_m
-000040a0: 6f64 656c 203d 2070 735f 7472 6565 5f6c  odel = ps_tree_l
-000040b0: 6f63 616c 5f6d 6f64 656c 0a20 2020 2020  ocal_model.     
-000040c0: 2020 2073 656c 662e 6479 6e61 6d69 635f     self.dynamic_
-000040d0: 7061 7274 6974 696f 6e20 3d20 6479 6e61  partition = dyna
-000040e0: 6d69 635f 7061 7274 6974 696f 6e0a 2020  mic_partition.  
-000040f0: 2020 2020 2020 7365 6c66 2e6d 6178 5f6c        self.max_l
-00004100: 6561 665f 6e6f 6465 7320 3d20 6d61 785f  eaf_nodes = max_
-00004110: 6c65 6166 5f6e 6f64 6573 0a20 2020 2020  leaf_nodes.     
-00004120: 2020 2073 656c 662e 7073 5f74 7265 655f     self.ps_tree_
-00004130: 7261 7469 6f20 3d20 7073 5f74 7265 655f  ratio = ps_tree_
-00004140: 7261 7469 6f0a 2020 2020 2020 2020 7365  ratio.        se
-00004150: 6c66 2e76 6172 5f6f 7220 3d20 7661 725f  lf.var_or = var_
-00004160: 6f72 0a20 2020 2020 2020 2073 656c 662e  or.        self.
-00004170: 7365 6d61 6e74 6963 5f72 6570 6169 7220  semantic_repair 
-00004180: 3d20 7365 6d61 6e74 6963 5f72 6570 6169  = semantic_repai
-00004190: 720a 2020 2020 2020 2020 7365 6c66 2e73  r.        self.s
-000041a0: 7563 6365 7373 6675 6c5f 7265 7061 6972  uccessful_repair
-000041b0: 203d 2030 0a20 2020 2020 2020 2073 656c   = 0.        sel
-000041c0: 662e 6661 696c 6564 5f72 6570 6169 7220  f.failed_repair 
-000041d0: 3d20 300a 2020 2020 2020 2020 6966 2069  = 0.        if i
-000041e0: 7369 6e73 7461 6e63 6528 7365 6c66 2e70  sinstance(self.p
-000041f0: 735f 7472 6565 5f72 6174 696f 2c20 7374  s_tree_ratio, st
-00004200: 7229 2061 6e64 2027 496e 7465 726c 6561  r) and 'Interlea
-00004210: 7665 2720 696e 2073 656c 662e 7073 5f74  ve' in self.ps_t
-00004220: 7265 655f 7261 7469 6f3a 0a20 2020 2020  ree_ratio:.     
-00004230: 2020 2020 2020 2069 6e74 6572 6c65 6176         interleav
-00004240: 696e 675f 7065 7269 6f64 203d 2069 6e74  ing_period = int
-00004250: 286e 702e 726f 756e 6428 6e5f 6765 6e20  (np.round(n_gen 
-00004260: 2f20 286e 5f67 656e 202a 2066 6c6f 6174  / (n_gen * float
-00004270: 2873 656c 662e 7073 5f74 7265 655f 7261  (self.ps_tree_ra
-00004280: 7469 6f2e 7265 706c 6163 6528 2749 6e74  tio.replace('Int
-00004290: 6572 6c65 6176 652d 272c 2027 2729 2929  erleave-', '')))
-000042a0: 2929 0a20 2020 2020 2020 2073 656c 662e  )).        self.
-000042b0: 696e 7465 726c 6561 7669 6e67 5f70 6572  interleaving_per
-000042c0: 696f 6420 3d20 696e 7465 726c 6561 7669  iod = interleavi
-000042d0: 6e67 5f70 6572 696f 640a 2020 2020 2020  ng_period.      
-000042e0: 2020 7365 6c66 2e74 6573 745f 6461 7461    self.test_data
-000042f0: 5f73 697a 6520 3d20 300a 0a20 2020 2020  _size = 0..     
-00004300: 2020 2069 6620 7061 7261 6d2e 6765 7428     if param.get(
-00004310: 2772 6563 6f72 645f 7472 6169 6e69 6e67  'record_training
-00004320: 5f64 6174 6127 2c20 4661 6c73 6529 3a0a  _data', False):.
-00004330: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00004340: 2e74 6573 745f 6675 6e5b 305d 2e72 6567  .test_fun[0].reg
-00004350: 7220 3d20 7365 6c66 0a20 2020 2020 2020  r = self.       
-00004360: 2020 2020 2073 656c 662e 7465 7374 5f66       self.test_f
-00004370: 756e 5b31 5d2e 7265 6772 203d 2073 656c  un[1].regr = sel
-00004380: 660a 0a20 2020 2020 2020 2073 656c 662e  f..        self.
-00004390: 6e6f 726d 616c 697a 6520 3d20 6e6f 726d  normalize = norm
-000043a0: 616c 697a 650a 2020 2020 2020 2020 7365  alize.        se
-000043b0: 6c66 2e74 696d 655f 7374 6174 6973 7469  lf.time_statisti
-000043c0: 6373 203d 207b 0a20 2020 2020 2020 2020  cs = {.         
-000043d0: 2020 2027 4750 2045 7661 6c75 6174 696f     'GP Evaluatio
-000043e0: 6e27 3a20 5b5d 2c0a 2020 2020 2020 2020  n': [],.        
-000043f0: 2020 2020 274d 4c20 4576 616c 7561 7469      'ML Evaluati
-00004400: 6f6e 273a 205b 5d2c 0a20 2020 2020 2020  on': [],.       
-00004410: 2020 2020 2027 4750 2047 656e 6572 6174       'GP Generat
-00004420: 696f 6e27 3a20 5b5d 2c0a 2020 2020 2020  ion': [],.      
-00004430: 2020 7d0a 2020 2020 2020 2020 6966 206e    }.        if n
-00004440: 6f72 6d61 6c69 7a65 2069 7320 5472 7565  ormalize is True
-00004450: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00004460: 6c66 2e78 5f73 6361 6c65 7220 3d20 5374  lf.x_scaler = St
-00004470: 616e 6461 7264 5363 616c 6572 2829 0a20  andardScaler(). 
-00004480: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00004490: 795f 7363 616c 6572 203d 2053 7461 6e64  y_scaler = Stand
-000044a0: 6172 6453 6361 6c65 7228 290a 2020 2020  ardScaler().    
-000044b0: 2020 2020 656c 6966 206e 6f72 6d61 6c69      elif normali
-000044c0: 7a65 203d 3d20 274d 696e 4d61 7827 3a0a  ze == 'MinMax':.
-000044d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000044e0: 2e78 5f73 6361 6c65 7220 3d20 4d69 6e4d  .x_scaler = MinM
-000044f0: 6178 5363 616c 6572 2829 0a20 2020 2020  axScaler().     
-00004500: 2020 2020 2020 2073 656c 662e 795f 7363         self.y_sc
-00004510: 616c 6572 203d 204d 696e 4d61 7853 6361  aler = MinMaxSca
-00004520: 6c65 7228 290a 2020 2020 2020 2020 656c  ler().        el
-00004530: 6966 206e 6f72 6d61 6c69 7a65 2069 6e20  if normalize in 
-00004540: 5b0a 2020 2020 2020 2020 2020 2020 2742  [.            'B
-00004550: 6163 6b77 6172 6444 6966 6665 7265 6e63  ackwardDifferenc
-00004560: 6545 6e63 6f64 6572 272c 0a20 2020 2020  eEncoder',.     
-00004570: 2020 2020 2020 2027 4269 6e61 7279 456e         'BinaryEn
-00004580: 636f 6465 7227 2c0a 2020 2020 2020 2020  coder',.        
-00004590: 2020 2020 2743 6174 426f 6f73 7445 6e63      'CatBoostEnc
-000045a0: 6f64 6572 272c 0a20 2020 2020 2020 2020  oder',.         
-000045b0: 2020 2027 436f 756e 7445 6e63 6f64 6572     'CountEncoder
-000045c0: 272c 0a20 2020 2020 2020 2020 2020 2027  ',.            '
-000045d0: 4861 7368 696e 6745 6e63 6f64 6572 272c  HashingEncoder',
-000045e0: 0a20 2020 2020 2020 2020 2020 2027 4865  .            'He
-000045f0: 6c6d 6572 7445 6e63 6f64 6572 272c 0a20  lmertEncoder',. 
-00004600: 2020 2020 2020 2020 2020 2027 4a61 6d65             'Jame
-00004610: 7353 7465 696e 456e 636f 6465 7227 2c0a  sSteinEncoder',.
-00004620: 2020 2020 2020 2020 2020 2020 274c 6561              'Lea
-00004630: 7665 4f6e 654f 7574 456e 636f 6465 7227  veOneOutEncoder'
-00004640: 2c0a 2020 2020 2020 2020 2020 2020 274d  ,.            'M
-00004650: 4573 7469 6d61 7465 456e 636f 6465 7227  EstimateEncoder'
-00004660: 2c0a 2020 2020 2020 2020 2020 2020 274f  ,.            'O
-00004670: 6e65 486f 7445 6e63 6f64 6572 272c 0a20  neHotEncoder',. 
-00004680: 2020 2020 2020 2020 2020 2027 4f72 6469             'Ordi
-00004690: 6e61 6c45 6e63 6f64 6572 272c 0a20 2020  nalEncoder',.   
-000046a0: 2020 2020 2020 2020 2027 506f 6c79 6e6f           'Polyno
-000046b0: 6d69 616c 456e 636f 6465 7227 2c0a 2020  mialEncoder',.  
-000046c0: 2020 2020 2020 2020 2020 2751 7561 6e74            'Quant
-000046d0: 696c 6545 6e63 6f64 6572 272c 0a20 2020  ileEncoder',.   
-000046e0: 2020 2020 2020 2020 2027 5375 6d45 6e63           'SumEnc
-000046f0: 6f64 6572 272c 0a20 2020 2020 2020 2020  oder',.         
-00004700: 2020 2027 5375 6d6d 6172 7945 6e63 6f64     'SummaryEncod
-00004710: 6572 272c 0a20 2020 2020 2020 2020 2020  er',.           
-00004720: 2027 5461 7267 6574 456e 636f 6465 7227   'TargetEncoder'
-00004730: 2c0a 2020 2020 2020 2020 5d3a 0a20 2020  ,.        ]:.   
-00004740: 2020 2020 2020 2020 2073 656c 662e 785f           self.x_
-00004750: 7363 616c 6572 203d 2046 6561 7475 7265  scaler = Feature
-00004760: 5472 616e 7366 6f72 6d65 7228 656e 636f  Transformer(enco
-00004770: 6469 6e67 5f73 6368 656d 653d 6e6f 726d  ding_scheme=norm
-00004780: 616c 697a 6529 0a20 2020 2020 2020 2020  alize).         
-00004790: 2020 2073 656c 662e 795f 7363 616c 6572     self.y_scaler
-000047a0: 203d 2053 7461 6e64 6172 6453 6361 6c65   = StandardScale
-000047b0: 7228 290a 2020 2020 2020 2020 656c 6966  r().        elif
-000047c0: 206e 6f72 6d61 6c69 7a65 2069 7320 4661   normalize is Fa
-000047d0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000047e0: 2070 6173 730a 2020 2020 2020 2020 656c   pass.        el
-000047f0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00004800: 7261 6973 6520 4578 6365 7074 696f 6e0a  raise Exception.
-00004810: 0a20 2020 2020 2020 2073 7461 7469 7374  .        statist
-00004820: 6963 616c 5f66 6561 7475 7265 203d 2073  ical_feature = s
-00004830: 656c 662e 7061 7261 6d2e 6765 7428 2773  elf.param.get('s
-00004840: 7461 7469 7374 6963 616c 5f66 6561 7475  tatistical_featu
-00004850: 7265 272c 2046 616c 7365 290a 2020 2020  re', False).    
-00004860: 2020 2020 6966 2073 7461 7469 7374 6963      if statistic
-00004870: 616c 5f66 6561 7475 7265 3a0a 2020 2020  al_feature:.    
-00004880: 2020 2020 2020 2020 6672 6f6d 2061 7574          from aut
-00004890: 6f78 2e61 7574 6f78 5f63 6f6d 7065 7469  ox.autox_competi
-000048a0: 7469 6f6e 2e66 6561 7475 7265 5f65 6e67  tion.feature_eng
-000048b0: 696e 6565 7220 696d 706f 7274 2046 6561  ineer import Fea
-000048c0: 7475 7265 5374 6174 0a20 2020 2020 2020  tureStat.       
-000048d0: 2020 2020 2063 6c61 7373 2046 6561 7475       class Featu
-000048e0: 7265 5374 6174 4669 7865 6428 4665 6174  reStatFixed(Feat
-000048f0: 7572 6553 7461 7429 3a0a 2020 2020 2020  ureStat):.      
-00004900: 2020 2020 2020 2020 2020 6465 6620 6669            def fi
-00004910: 745f 7472 616e 7366 6f72 6d28 7365 6c66  t_transform(self
-00004920: 2c20 6466 2c20 7461 7267 6574 3d4e 6f6e  , df, target=Non
-00004930: 652c 2064 665f 6665 6174 7572 655f 7479  e, df_feature_ty
-00004940: 7065 3d4e 6f6e 652c 2073 696c 656e 6365  pe=None, silence
-00004950: 5f67 726f 7570 5f63 6f6c 733d 5b5d 2c0a  _group_cols=[],.
-00004960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004980: 2020 7369 6c65 6e63 655f 6167 675f 636f    silence_agg_co
-00004990: 6c73 3d5b 5d2c 2073 656c 6563 745f 616c  ls=[], select_al
-000049a0: 6c3d 5472 7565 2c20 6d61 785f 6e75 6d3d  l=True, max_num=
-000049b0: 4e6f 6e65 293a 0a20 2020 2020 2020 2020  None):.         
-000049c0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-000049d0: 6e20 7375 7065 7228 292e 6669 745f 7472  n super().fit_tr
-000049e0: 616e 7366 6f72 6d28 6466 2c20 7461 7267  ansform(df, targ
-000049f0: 6574 2c20 6466 5f66 6561 7475 7265 5f74  et, df_feature_t
-00004a00: 7970 652c 2073 696c 656e 6365 5f67 726f  ype, silence_gro
-00004a10: 7570 5f63 6f6c 732c 2073 696c 656e 6365  up_cols, silence
-00004a20: 5f61 6767 5f63 6f6c 732c 0a20 2020 2020  _agg_cols,.     
-00004a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004a50: 2020 2020 2020 2020 2020 2020 7365 6c65              sele
-00004a60: 6374 5f61 6c6c 2c20 6d61 785f 6e75 6d29  ct_all, max_num)
-00004a70: 0a0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-00004a80: 6c66 2e78 5f73 6361 6c65 7220 3d20 5069  lf.x_scaler = Pi
-00004a90: 7065 6c69 6e65 285b 0a20 2020 2020 2020  peline([.       
-00004aa0: 2020 2020 2020 2020 2028 2253 7461 7469           ("Stati
-00004ab0: 7374 6963 616c 4665 6174 7572 6573 222c  sticalFeatures",
-00004ac0: 2046 6561 7475 7265 5374 6174 4669 7865   FeatureStatFixe
-00004ad0: 6428 2929 2c0a 2020 2020 2020 2020 2020  d()),.          
-00004ae0: 2020 2020 2020 2822 4361 7465 676f 7269        ("Categori
-00004af0: 6361 6c45 6e63 6f64 6572 222c 2073 656c  calEncoder", sel
-00004b00: 662e 785f 7363 616c 6572 290a 2020 2020  f.x_scaler).    
-00004b10: 2020 2020 2020 2020 5d29 0a0a 2020 2020          ])..    
-00004b20: 2020 2020 7365 6c66 2e6e 5f70 726f 6365      self.n_proce
-00004b30: 7373 203d 206e 5f70 726f 6365 7373 0a0a  ss = n_process..
-00004b40: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00004b50: 6261 7365 5f6c 6561 726e 6572 203d 3d20  base_learner == 
-00004b60: 274e 4e27 3a0a 2020 2020 2020 2020 2020  'NN':.          
-00004b70: 2020 2320 5769 6465 2644 6565 700a 2020    # Wide&Deep.  
-00004b80: 2020 2020 2020 2020 2020 7365 6c66 2e68            self.h
-00004b90: 6964 6465 6e5f 6c61 7965 7273 203d 205b  idden_layers = [
-00004ba0: 3136 2c20 345d 0a20 2020 2020 2020 2020  16, 4].         
-00004bb0: 2020 2073 656c 662e 6e65 7572 616c 5f6e     self.neural_n
-00004bc0: 6574 776f 726b 203d 204d 4c50 5265 6772  etwork = MLPRegr
-00004bd0: 6573 736f 7228 7365 6c66 2e68 6964 6465  essor(self.hidde
-00004be0: 6e5f 6c61 7965 7273 2c20 6163 7469 7661  n_layers, activa
-00004bf0: 7469 6f6e 3d27 6c6f 6769 7374 6963 272c  tion='logistic',
-00004c00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004c30: 6d61 785f 6974 6572 3d31 3030 302c 2065  max_iter=1000, e
-00004c40: 6172 6c79 5f73 746f 7070 696e 673d 5472  arly_stopping=Tr
-00004c50: 7565 290a 0a20 2020 2020 2020 2069 6620  ue)..        if 
-00004c60: 7365 6c66 2e6d 7574 6174 696f 6e5f 7363  self.mutation_sc
-00004c70: 6865 6d65 203d 3d20 2754 7261 6e73 666f  heme == 'Transfo
-00004c80: 726d 6572 273a 0a20 2020 2020 2020 2020  rmer':.         
-00004c90: 2020 2073 656c 662e 7472 616e 7366 6f72     self.transfor
-00004ca0: 6d65 725f 7377 6974 6368 203d 2054 7275  mer_switch = Tru
-00004cb0: 650a 2020 2020 2020 2020 2020 2020 7365  e.            se
-00004cc0: 6c66 2e6d 7574 6174 696f 6e5f 7363 6865  lf.mutation_sche
-00004cd0: 6d65 203d 2027 756e 6966 6f72 6d2d 706c  me = 'uniform-pl
-00004ce0: 7573 270a 2020 2020 2020 2020 656c 7365  us'.        else
-00004cf0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00004d00: 6c66 2e74 7261 6e73 666f 726d 6572 5f73  lf.transformer_s
-00004d10: 7769 7463 6820 3d20 4661 6c73 650a 0a20  witch = False.. 
-00004d20: 2020 2020 2020 2073 656c 662e 6e6f 7665         self.nove
-00004d30: 6c74 795f 7765 6967 6874 203d 2031 0a20  lty_weight = 1. 
-00004d40: 2020 2020 2020 2073 656c 662e 6479 6e61         self.dyna
-00004d50: 6d69 635f 7461 7267 6574 203d 2046 616c  mic_target = Fal
-00004d60: 7365 0a20 2020 2020 2020 2073 656c 662e  se.        self.
-00004d70: 656e 7365 6d62 6c65 5f63 6f6f 7065 7261  ensemble_coopera
-00004d80: 7469 6f6e 203d 2046 616c 7365 0a20 2020  tion = False.   
-00004d90: 2020 2020 2073 656c 662e 6469 7665 7273       self.divers
-00004da0: 6974 795f 6d65 7472 6963 203d 2027 436f  ity_metric = 'Co
-00004db0: 7369 6e65 5369 6d69 6c61 7269 7479 270a  sineSimilarity'.
-00004dc0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00004dd0: 7461 6e63 6528 7365 6c66 2e73 636f 7265  tance(self.score
-00004de0: 5f66 756e 632c 2073 7472 2920 616e 6420  _func, str) and 
-00004df0: 272d 4b4c 2720 696e 2073 656c 662e 7363  '-KL' in self.sc
-00004e00: 6f72 655f 6675 6e63 3a0a 2020 2020 2020  ore_func:.      
-00004e10: 2020 2020 2020 7365 6c66 2e73 636f 7265        self.score
-00004e20: 5f66 756e 6320 3d20 7365 6c66 2e73 636f  _func = self.sco
-00004e30: 7265 5f66 756e 632e 7265 706c 6163 6528  re_func.replace(
-00004e40: 272d 4b4c 272c 2027 2729 0a20 2020 2020  '-KL', '').     
-00004e50: 2020 2020 2020 2073 656c 662e 6469 7665         self.dive
-00004e60: 7273 6974 795f 6d65 7472 6963 203d 2027  rsity_metric = '
-00004e70: 4b4c 2d44 6976 6572 6765 6e63 6527 0a0a  KL-Divergence'..
-00004e80: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00004e90: 7363 6f72 655f 6675 6e63 203d 3d20 274e  score_func == 'N
-00004ea0: 6f76 656c 7479 5365 6172 6368 2d44 796e  oveltySearch-Dyn
-00004eb0: 616d 6963 273a 0a20 2020 2020 2020 2020  amic':.         
-00004ec0: 2020 2073 656c 662e 6479 6e61 6d69 635f     self.dynamic_
-00004ed0: 7461 7267 6574 203d 2054 7275 650a 2020  target = True.  
-00004ee0: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
-00004ef0: 636f 7265 5f66 756e 6320 3d20 274e 6f76  core_func = 'Nov
-00004f00: 656c 7479 5365 6172 6368 270a 2020 2020  eltySearch'.    
-00004f10: 2020 2020 656c 6966 2027 5765 6967 6874      elif 'Weight
-00004f20: 6564 4e6f 7665 6c74 7953 6561 7263 682d  edNoveltySearch-
-00004f30: 2720 696e 2073 656c 662e 7363 6f72 655f  ' in self.score_
-00004f40: 6675 6e63 3a0a 2020 2020 2020 2020 2020  func:.          
-00004f50: 2020 7365 6c66 2e6e 6f76 656c 7479 5f77    self.novelty_w
-00004f60: 6569 6768 7420 3d20 666c 6f61 7428 7365  eight = float(se
-00004f70: 6c66 2e73 636f 7265 5f66 756e 632e 7370  lf.score_func.sp
-00004f80: 6c69 7428 272d 2729 5b31 5d29 0a20 2020  lit('-')[1]).   
-00004f90: 2020 2020 2020 2020 2073 656c 662e 7363           self.sc
-00004fa0: 6f72 655f 6675 6e63 203d 2027 4e6f 7665  ore_func = 'Nove
-00004fb0: 6c74 7953 6561 7263 6827 0a20 2020 2020  ltySearch'.     
-00004fc0: 2020 2065 6c69 6620 2757 6569 6768 7465     elif 'Weighte
-00004fd0: 6443 6f6f 7065 7261 7469 6f6e 5365 6172  dCooperationSear
-00004fe0: 6368 2d27 2069 6e20 7365 6c66 2e73 636f  ch-' in self.sco
-00004ff0: 7265 5f66 756e 633a 0a20 2020 2020 2020  re_func:.       
-00005000: 2020 2020 2073 656c 662e 6e6f 7665 6c74       self.novelt
-00005010: 795f 7765 6967 6874 203d 2066 6c6f 6174  y_weight = float
-00005020: 2873 656c 662e 7363 6f72 655f 6675 6e63  (self.score_func
-00005030: 2e73 706c 6974 2827 2d27 295b 315d 290a  .split('-')[1]).
-00005040: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00005050: 2e73 636f 7265 5f66 756e 6320 3d20 274e  .score_func = 'N
-00005060: 6f76 656c 7479 5365 6172 6368 270a 2020  oveltySearch'.  
-00005070: 2020 2020 2020 2020 2020 7365 6c66 2e65            self.e
-00005080: 6e73 656d 626c 655f 636f 6f70 6572 6174  nsemble_cooperat
-00005090: 696f 6e20 3d20 5472 7565 0a0a 2020 2020  ion = True..    
-000050a0: 2020 2020 6966 2073 656c 662e 6261 7365      if self.base
-000050b0: 5f6c 6561 726e 6572 203d 3d20 2748 7962  _learner == 'Hyb
-000050c0: 7269 6427 3a0a 2020 2020 2020 2020 2020  rid':.          
-000050d0: 2020 7365 6c66 2e74 706f 745f 6d6f 6465    self.tpot_mode
-000050e0: 6c20 3d20 5450 4f54 5265 6772 6573 736f  l = TPOTRegresso
-000050f0: 7228 290a 2020 2020 2020 2020 2020 2020  r().            
-00005100: 7365 6c66 2e74 706f 745f 6d6f 6465 6c2e  self.tpot_model.
-00005110: 5f66 6974 5f69 6e69 7428 290a 2020 2020  _fit_init().    
-00005120: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00005130: 2020 2020 2020 7365 6c66 2e74 706f 745f        self.tpot_
-00005140: 6d6f 6465 6c20 3d20 4e6f 6e65 0a0a 2020  model = None..  
-00005150: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00005160: 2020 536f 6d65 2070 6172 616d 6574 6572    Some parameter
-00005170: 7320 7375 7070 6f72 7420 4d75 6c74 692d  s support Multi-
-00005180: 7461 736b 2073 6368 656d 650a 2020 2020  task scheme.    
-00005190: 2020 2020 486f 7765 7665 722c 2073 6f6d      However, som
-000051a0: 6520 7061 7261 6d65 7465 7273 2064 6f20  e parameters do 
-000051b0: 6e6f 7420 636f 6e73 6964 6572 2074 6869  not consider thi
-000051c0: 730a 2020 2020 2020 2020 2222 220a 2020  s.        """.  
-000051d0: 2020 2020 2020 7365 6c66 2e62 6173 655f        self.base_
-000051e0: 6d6f 6465 6c5f 6469 6374 203d 207b 7d0a  model_dict = {}.
-000051f0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00005200: 7461 6e63 6528 7365 6c66 2e62 6173 655f  tance(self.base_
-00005210: 6c65 6172 6e65 722c 2042 6173 6545 7374  learner, BaseEst
-00005220: 696d 6174 6f72 293a 0a20 2020 2020 2020  imator):.       
-00005230: 2020 2020 2073 656c 662e 6261 7365 5f6d       self.base_m
-00005240: 6f64 656c 5f6c 6973 7420 3d20 4e6f 6e65  odel_list = None
-00005250: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00005260: 662e 6261 7365 5f6d 6f64 656c 5f64 6963  f.base_model_dic
-00005270: 745b 7365 6c66 2e62 6173 655f 6c65 6172  t[self.base_lear
-00005280: 6e65 722e 5f5f 636c 6173 735f 5f2e 5f5f  ner.__class__.__
-00005290: 6e61 6d65 5f5f 5d20 3d20 7365 6c66 2e62  name__] = self.b
-000052a0: 6173 655f 6c65 6172 6e65 720a 2020 2020  ase_learner.    
-000052b0: 2020 2020 2020 2020 7365 6c66 2e62 6173          self.bas
-000052c0: 655f 6c65 6172 6e65 7220 3d20 7365 6c66  e_learner = self
-000052d0: 2e62 6173 655f 6c65 6172 6e65 722e 5f5f  .base_learner.__
-000052e0: 636c 6173 735f 5f2e 5f5f 6e61 6d65 5f5f  class__.__name__
-000052f0: 0a20 2020 2020 2020 2065 6c69 6620 6973  .        elif is
-00005300: 696e 7374 616e 6365 2873 656c 662e 6261  instance(self.ba
-00005310: 7365 5f6c 6561 726e 6572 2c20 6c69 7374  se_learner, list
-00005320: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
-00005330: 656c 662e 726d 705f 7261 7469 6f20 3d20  elf.rmp_ratio = 
-00005340: 302e 350a 2020 2020 2020 2020 2020 2020  0.5.            
-00005350: 7365 6c66 2e62 6173 655f 6d6f 6465 6c5f  self.base_model_
-00005360: 6469 6374 203d 207b 0a20 2020 2020 2020  dict = {.       
-00005370: 2020 2020 2020 2020 206c 6561 726e 6572           learner
-00005380: 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e 616d  .__class__.__nam
-00005390: 655f 5f3a 206c 6561 726e 6572 2066 6f72  e__: learner for
-000053a0: 206c 6561 726e 6572 2069 6e20 7365 6c66   learner in self
-000053b0: 2e62 6173 655f 6c65 6172 6e65 720a 2020  .base_learner.  
-000053c0: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
-000053d0: 2020 2020 2020 2020 7365 6c66 2e62 6173          self.bas
-000053e0: 655f 6d6f 6465 6c5f 6c69 7374 203d 2027  e_model_list = '
-000053f0: 2c27 2e6a 6f69 6e28 5b6c 6561 726e 6572  ,'.join([learner
-00005400: 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e 616d  .__class__.__nam
-00005410: 655f 5f20 666f 7220 6c65 6172 6e65 7220  e__ for learner 
-00005420: 696e 2073 656c 662e 6261 7365 5f6c 6561  in self.base_lea
-00005430: 726e 6572 5d29 0a20 2020 2020 2020 2065  rner]).        e
-00005440: 6c69 6620 7365 6c66 2e62 6173 655f 6c65  lif self.base_le
-00005450: 6172 6e65 722e 7374 6172 7473 7769 7468  arner.startswith
-00005460: 2827 4454 2d4c 522d 2729 3a0a 2020 2020  ('DT-LR-'):.    
-00005470: 2020 2020 2020 2020 7365 6c66 2e72 6d70          self.rmp
-00005480: 5f72 6174 696f 203d 2066 6c6f 6174 2873  _ratio = float(s
-00005490: 656c 662e 6261 7365 5f6c 6561 726e 6572  elf.base_learner
-000054a0: 2e73 706c 6974 2827 2d27 295b 2d31 5d29  .split('-')[-1])
-000054b0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000054c0: 662e 6261 7365 5f6c 6561 726e 6572 203d  f.base_learner =
-000054d0: 2027 2d27 2e6a 6f69 6e28 7365 6c66 2e62   '-'.join(self.b
-000054e0: 6173 655f 6c65 6172 6e65 722e 7370 6c69  ase_learner.spli
-000054f0: 7428 272d 2729 5b3a 2d31 5d29 0a20 2020  t('-')[:-1]).   
-00005500: 2020 2020 2020 2020 2073 656c 662e 6261           self.ba
-00005510: 7365 5f6d 6f64 656c 5f6c 6973 7420 3d20  se_model_list = 
-00005520: 2752 616e 646f 6d2d 4454 2c4c 6f67 6973  'Random-DT,Logis
-00005530: 7469 6352 6567 7265 7373 696f 6e27 0a20  ticRegression'. 
-00005540: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
-00005550: 2e62 6173 655f 6c65 6172 6e65 722e 7374  .base_learner.st
-00005560: 6172 7473 7769 7468 2827 4261 6c61 6e63  artswith('Balanc
-00005570: 6564 2d44 542d 4c52 2d27 293a 0a20 2020  ed-DT-LR-'):.   
-00005580: 2020 2020 2020 2020 2073 656c 662e 726d           self.rm
-00005590: 705f 7261 7469 6f20 3d20 666c 6f61 7428  p_ratio = float(
-000055a0: 7365 6c66 2e62 6173 655f 6c65 6172 6e65  self.base_learne
-000055b0: 722e 7370 6c69 7428 272d 2729 5b2d 315d  r.split('-')[-1]
-000055c0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-000055d0: 6c66 2e62 6173 655f 6c65 6172 6e65 7220  lf.base_learner 
-000055e0: 3d20 272d 272e 6a6f 696e 2873 656c 662e  = '-'.join(self.
-000055f0: 6261 7365 5f6c 6561 726e 6572 2e73 706c  base_learner.spl
-00005600: 6974 2827 2d27 295b 3a2d 315d 290a 2020  it('-')[:-1]).  
-00005610: 2020 2020 2020 2020 2020 7365 6c66 2e62            self.b
-00005620: 6173 655f 6d6f 6465 6c5f 6c69 7374 203d  ase_model_list =
-00005630: 2027 4261 6c61 6e63 6564 2d52 616e 646f   'Balanced-Rando
-00005640: 6d2d 4454 2c42 616c 616e 6365 642d 4c6f  m-DT,Balanced-Lo
-00005650: 6769 7374 6963 5265 6772 6573 7369 6f6e  gisticRegression
-00005660: 270a 2020 2020 2020 2020 656c 6966 2073  '.        elif s
-00005670: 656c 662e 6261 7365 5f6c 6561 726e 6572  elf.base_learner
-00005680: 203d 3d20 2744 542d 4c52 273a 0a20 2020   == 'DT-LR':.   
-00005690: 2020 2020 2020 2020 2073 656c 662e 726d           self.rm
-000056a0: 705f 7261 7469 6f20 3d20 302e 350a 2020  p_ratio = 0.5.  
-000056b0: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
-000056c0: 6e73 7461 6e63 6528 7365 6c66 2c20 4576  nstance(self, Ev
-000056d0: 6f6c 7574 696f 6e61 7279 466f 7265 7374  olutionaryForest
-000056e0: 436c 6173 7369 6669 6572 293a 0a20 2020  Classifier):.   
-000056f0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00005700: 662e 6261 7365 5f6d 6f64 656c 5f6c 6973  f.base_model_lis
-00005710: 7420 3d20 2744 542c 4c6f 6769 7374 6963  t = 'DT,Logistic
-00005720: 5265 6772 6573 7369 6f6e 270a 2020 2020  Regression'.    
-00005730: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00005740: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00005750: 6c66 2e62 6173 655f 6d6f 6465 6c5f 6c69  lf.base_model_li
-00005760: 7374 203d 2027 4454 2c52 6964 6765 270a  st = 'DT,Ridge'.
-00005770: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
-00005780: 662e 6261 7365 5f6c 6561 726e 6572 203d  f.base_learner =
-00005790: 3d20 2752 4454 2d4c 5227 3a0a 2020 2020  = 'RDT-LR':.    
-000057a0: 2020 2020 2020 2020 7365 6c66 2e72 6d70          self.rmp
-000057b0: 5f72 6174 696f 203d 2030 2e35 0a20 2020  _ratio = 0.5.   
-000057c0: 2020 2020 2020 2020 2073 656c 662e 6261           self.ba
-000057d0: 7365 5f6d 6f64 656c 5f6c 6973 7420 3d20  se_model_list = 
-000057e0: 2752 616e 646f 6d2d 4454 2c4c 6f67 6973  'Random-DT,Logis
-000057f0: 7469 6352 6567 7265 7373 696f 6e27 0a20  ticRegression'. 
-00005800: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
-00005810: 2e62 6173 655f 6c65 6172 6e65 7220 3d3d  .base_learner ==
-00005820: 2027 4261 6c61 6e63 6564 2d52 4454 2d4c   'Balanced-RDT-L
-00005830: 5227 3a0a 2020 2020 2020 2020 2020 2020  R':.            
-00005840: 7365 6c66 2e72 6d70 5f72 6174 696f 203d  self.rmp_ratio =
-00005850: 2030 2e35 0a20 2020 2020 2020 2020 2020   0.5.           
-00005860: 2073 656c 662e 6261 7365 5f6d 6f64 656c   self.base_model
-00005870: 5f6c 6973 7420 3d20 2742 616c 616e 6365  _list = 'Balance
-00005880: 642d 5261 6e64 6f6d 2d44 542c 4261 6c61  d-Random-DT,Bala
-00005890: 6e63 6564 2d4c 6f67 6973 7469 6352 6567  nced-LogisticReg
-000058a0: 7265 7373 696f 6e27 0a20 2020 2020 2020  ression'.       
-000058b0: 2065 6c69 6620 7365 6c66 2e62 6173 655f   elif self.base_
-000058c0: 6c65 6172 6e65 7220 3d3d 2027 4261 6c61  learner == 'Bala
-000058d0: 6e63 6564 2d44 542d 4c52 273a 0a20 2020  nced-DT-LR':.   
-000058e0: 2020 2020 2020 2020 2073 656c 662e 726d           self.rm
-000058f0: 705f 7261 7469 6f20 3d20 302e 350a 2020  p_ratio = 0.5.  
-00005900: 2020 2020 2020 2020 2020 7365 6c66 2e62            self.b
-00005910: 6173 655f 6d6f 6465 6c5f 6c69 7374 203d  ase_model_list =
-00005920: 2027 4261 6c61 6e63 6564 2d44 542c 4261   'Balanced-DT,Ba
-00005930: 6c61 6e63 6564 2d4c 6f67 6973 7469 6352  lanced-LogisticR
-00005940: 6567 7265 7373 696f 6e27 0a20 2020 2020  egression'.     
-00005950: 2020 2065 6c69 6620 7365 6c66 2e62 6173     elif self.bas
-00005960: 655f 6c65 6172 6e65 7220 3d3d 2027 4454  e_learner == 'DT
-00005970: 2d4c 4742 4d27 3a0a 2020 2020 2020 2020  -LGBM':.        
-00005980: 2020 2020 7365 6c66 2e62 6173 655f 6d6f      self.base_mo
-00005990: 6465 6c5f 6c69 7374 203d 2027 5261 6e64  del_list = 'Rand
-000059a0: 6f6d 2d44 542c 4c69 6768 7447 424d 2d53  om-DT,LightGBM-S
-000059b0: 7475 6d70 2c44 5427 0a20 2020 2020 2020  tump,DT'.       
-000059c0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-000059d0: 2020 2073 656c 662e 6261 7365 5f6d 6f64     self.base_mod
-000059e0: 656c 5f6c 6973 7420 3d20 4e6f 6e65 0a0a  el_list = None..
-000059f0: 2020 2020 6465 6620 6361 6c63 756c 6174      def calculat
-00005a00: 655f 6469 7665 7273 6974 7928 7365 6c66  e_diversity(self
-00005a10: 2c20 706f 7075 6c61 7469 6f6e 293a 0a20  , population):. 
-00005a20: 2020 2020 2020 2069 6e64 7320 3d20 5b5d         inds = []
-00005a30: 0a20 2020 2020 2020 2066 6f72 2070 2069  .        for p i
-00005a40: 6e20 706f 7075 6c61 7469 6f6e 3a0a 2020  n population:.  
-00005a50: 2020 2020 2020 2020 2020 696e 6473 2e61            inds.a
-00005a60: 7070 656e 6428 702e 6361 7365 5f76 616c  ppend(p.case_val
-00005a70: 7565 732e 666c 6174 7465 6e28 2929 0a20  ues.flatten()). 
-00005a80: 2020 2020 2020 2069 6e64 7320 3d20 6e70         inds = np
-00005a90: 2e61 7272 6179 2869 6e64 7329 0a20 2020  .array(inds).   
-00005aa0: 2020 2020 2074 7265 6520 3d20 4b44 5472       tree = KDTr
-00005ab0: 6565 2869 6e64 7329 0a20 2020 2020 2020  ee(inds).       
-00005ac0: 206e 6569 6768 626f 7273 203d 2074 7265   neighbors = tre
-00005ad0: 652e 7175 6572 7928 696e 6473 2c20 6b3d  e.query(inds, k=
-00005ae0: 3320 2b20 3129 5b30 5d0a 2020 2020 2020  3 + 1)[0].      
-00005af0: 2020 6d65 616e 5f64 6976 6572 7369 7479    mean_diversity
-00005b00: 203d 206e 702e 6d65 616e 286e 6569 6768   = np.mean(neigh
-00005b10: 626f 7273 2c20 6178 6973 3d31 290a 2020  bors, axis=1).  
-00005b20: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
-00005b30: 7262 6f73 653a 0a20 2020 2020 2020 2020  rbose:.         
-00005b40: 2020 2070 7269 6e74 2827 6d65 616e 5f64     print('mean_d
-00005b50: 6976 6572 7369 7479 272c 206e 702e 6d65  iversity', np.me
-00005b60: 616e 286d 6561 6e5f 6469 7665 7273 6974  an(mean_diversit
-00005b70: 7929 290a 2020 2020 2020 2020 7265 7475  y)).        retu
-00005b80: 726e 206d 6561 6e5f 6469 7665 7273 6974  rn mean_diversit
-00005b90: 790a 0a20 2020 2064 6566 206f 6f62 5f65  y..    def oob_e
-00005ba0: 7272 6f72 2873 656c 662c 2070 6f70 293a  rror(self, pop):
-00005bb0: 0a20 2020 2020 2020 2070 7265 6469 6374  .        predict
-00005bc0: 696f 6e20 3d20 6e70 2e66 756c 6c28 286c  ion = np.full((l
-00005bd0: 656e 2870 6f70 292c 206c 656e 2873 656c  en(pop), len(sel
-00005be0: 662e 7929 292c 206e 702e 6e61 6e2c 2064  f.y)), np.nan, d
-00005bf0: 7479 7065 3d6e 702e 666c 6f61 7429 0a20  type=np.float). 
-00005c00: 2020 2020 2020 2066 6f72 2069 2c20 7820         for i, x 
-00005c10: 696e 2065 6e75 6d65 7261 7465 2870 6f70  in enumerate(pop
-00005c20: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-00005c30: 6e64 6578 203d 2078 2e6f 7574 5f6f 665f  ndex = x.out_of_
-00005c40: 6261 670a 2020 2020 2020 2020 2020 2020  bag.            
-00005c50: 7072 6564 6963 7469 6f6e 5b69 5d5b 696e  prediction[i][in
-00005c60: 6465 785d 203d 2078 2e6f 6f62 5f70 7265  dex] = x.oob_pre
-00005c70: 6469 6374 696f 6e0a 2020 2020 2020 2020  diction.        
-00005c80: 6c61 6265 6c20 3d20 6e70 2e6e 616e 6d65  label = np.nanme
-00005c90: 616e 2870 7265 6469 6374 696f 6e2c 2061  an(prediction, a
-00005ca0: 7869 733d 3029 0a20 2020 2020 2020 206c  xis=0).        l
-00005cb0: 6162 656c 203d 206e 702e 6e61 6e5f 746f  abel = np.nan_to
-00005cc0: 5f6e 756d 286c 6162 656c 290a 2020 2020  _num(label).    
-00005cd0: 2020 2020 6163 6375 7261 6379 203d 2072      accuracy = r
-00005ce0: 325f 7363 6f72 6528 7365 6c66 2e79 2c20  2_score(self.y, 
-00005cf0: 6c61 6265 6c29 0a20 2020 2020 2020 2069  label).        i
-00005d00: 6620 7365 6c66 2e76 6572 626f 7365 3a0a  f self.verbose:.
-00005d10: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00005d20: 7428 276f 6f62 2073 636f 7265 272c 2061  t('oob score', a
-00005d30: 6363 7572 6163 7929 0a20 2020 2020 2020  ccuracy).       
-00005d40: 2072 6574 7572 6e20 6163 6375 7261 6379   return accuracy
-00005d50: 0a0a 2020 2020 6465 6620 6665 6174 7572  ..    def featur
-00005d60: 655f 7175 6963 6b5f 6576 616c 7561 7469  e_quick_evaluati
-00005d70: 6f6e 2873 656c 662c 2067 656e 6529 3a0a  on(self, gene):.
-00005d80: 2020 2020 2020 2020 2320 7175 6963 6b6c          # quickl
-00005d90: 7920 6576 616c 7561 7465 2073 656d 616e  y evaluate seman
-00005da0: 7469 6320 696e 666f 726d 6174 696f 6e20  tic information 
-00005db0: 6f66 2061 6e20 696e 6469 7669 6475 616c  of an individual
-00005dc0: 2062 6173 6564 206f 6e20 6669 7273 7420   based on first 
-00005dd0: 3230 2064 6174 6120 6974 656d 730a 2020  20 data items.  
-00005de0: 2020 2020 2020 2320 7573 6167 653a 2073        # usage: s
-00005df0: 7572 726f 6761 7465 206d 6f64 656c 0a20  urrogate model. 
-00005e00: 2020 2020 2020 2066 756e 6320 3d20 636f         func = co
-00005e10: 6d70 696c 6528 6765 6e65 2c20 7365 6c66  mpile(gene, self
-00005e20: 2e70 7365 7429 0a20 2020 2020 2020 2059  .pset).        Y
-00005e30: 7020 3d20 7265 7375 6c74 5f63 616c 6375  p = result_calcu
-00005e40: 6c61 7469 6f6e 285b 6675 6e63 5d2c 2073  lation([func], s
-00005e50: 656c 662e 585b 3a32 305d 2c20 4661 6c73  elf.X[:20], Fals
-00005e60: 6529 0a20 2020 2020 2020 2072 6574 7572  e).        retur
-00005e70: 6e20 7475 706c 6528 5970 2e66 6c61 7474  n tuple(Yp.flatt
-00005e80: 656e 2829 290a 0a20 2020 2064 6566 2067  en())..    def g
-00005e90: 6574 5f6d 6f64 656c 5f63 6f65 6666 6963  et_model_coeffic
-00005ea0: 6965 6e74 2873 656c 662c 2078 293a 0a20  ient(self, x):. 
-00005eb0: 2020 2020 2020 2069 6620 7365 6c66 2e62         if self.b
-00005ec0: 6173 6963 5f70 7269 6d69 7469 7665 7320  asic_primitives 
-00005ed0: 3d3d 2027 4d4c 273a 0a20 2020 2020 2020  == 'ML':.       
-00005ee0: 2020 2020 2072 6964 6765 5f20 3d20 785b       ridge_ = x[
-00005ef0: 276d 6f64 656c 275d 5b27 5269 6467 6527  'model']['Ridge'
-00005f00: 5d0a 2020 2020 2020 2020 656c 7365 3a0a  ].        else:.
-00005f10: 2020 2020 2020 2020 2020 2020 7269 6467              ridg
-00005f20: 655f 203d 2078 5b27 5269 6467 6527 5d0a  e_ = x['Ridge'].
-00005f30: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00005f40: 7461 6e63 6528 7269 6467 655f 2c20 5069  tance(ridge_, Pi
-00005f50: 7065 6c69 6e65 293a 0a20 2020 2020 2020  peline):.       
-00005f60: 2020 2020 2062 6173 655f 6c65 6172 6e65       base_learne
-00005f70: 7220 3d20 7269 6467 655f 5b2d 315d 0a20  r = ridge_[-1]. 
-00005f80: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00005f90: 2020 2020 2020 2020 2062 6173 655f 6c65           base_le
-00005fa0: 6172 6e65 7220 3d20 7269 6467 655f 0a0a  arner = ridge_..
-00005fb0: 2020 2020 2020 2020 6966 2068 6173 6174          if hasat
-00005fc0: 7472 2862 6173 655f 6c65 6172 6e65 722c  tr(base_learner,
-00005fd0: 2027 7368 6170 5f76 616c 7565 7327 293a   'shap_values'):
-00005fe0: 0a20 2020 2020 2020 2020 2020 2063 6f65  .            coe
-00005ff0: 6620 3d20 6261 7365 5f6c 6561 726e 6572  f = base_learner
-00006000: 2e73 6861 705f 7661 6c75 6573 0a20 2020  .shap_values.   
-00006010: 2020 2020 2065 6c69 6620 6861 7361 7474       elif hasatt
-00006020: 7228 6261 7365 5f6c 6561 726e 6572 2c20  r(base_learner, 
-00006030: 2770 695f 7661 6c75 6573 2729 3a0a 2020  'pi_values'):.  
-00006040: 2020 2020 2020 2020 2020 2320 7065 726d            # perm
-00006050: 7574 6174 696f 6e20 696d 706f 7274 616e  utation importan
-00006060: 6365 0a20 2020 2020 2020 2020 2020 2063  ce.            c
-00006070: 6f65 6620 3d20 6261 7365 5f6c 6561 726e  oef = base_learn
-00006080: 6572 2e70 695f 7661 6c75 6573 0a20 2020  er.pi_values.   
-00006090: 2020 2020 2065 6c69 6620 6973 696e 7374       elif isinst
-000060a0: 616e 6365 2862 6173 655f 6c65 6172 6e65  ance(base_learne
-000060b0: 722c 2028 4c69 6e65 6172 4d6f 6465 6c2c  r, (LinearModel,
-000060c0: 204c 696e 6561 7243 6c61 7373 6966 6965   LinearClassifie
-000060d0: 724d 6978 696e 2929 3a0a 2020 2020 2020  rMixin)):.      
-000060e0: 2020 2020 2020 6966 206c 656e 2862 6173        if len(bas
-000060f0: 655f 6c65 6172 6e65 722e 636f 6566 5f2e  e_learner.coef_.
-00006100: 7368 6170 6529 203d 3d20 323a 0a20 2020  shape) == 2:.   
-00006110: 2020 2020 2020 2020 2020 2020 2063 6f65               coe
-00006120: 6620 3d20 6e70 2e6d 6178 286e 702e 6162  f = np.max(np.ab
-00006130: 7328 6261 7365 5f6c 6561 726e 6572 2e63  s(base_learner.c
-00006140: 6f65 665f 292c 2061 7869 733d 3029 5b3a  oef_), axis=0)[:
-00006150: 7365 6c66 2e67 656e 655f 6e75 6d5d 0a20  self.gene_num]. 
-00006160: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00006170: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006180: 2063 6f65 6620 3d20 6e70 2e61 6273 2862   coef = np.abs(b
-00006190: 6173 655f 6c65 6172 6e65 722e 636f 6566  ase_learner.coef
-000061a0: 5f29 5b3a 7365 6c66 2e67 656e 655f 6e75  _)[:self.gene_nu
-000061b0: 6d5d 0a20 2020 2020 2020 2065 6c69 6620  m].        elif 
-000061c0: 6973 696e 7374 616e 6365 2862 6173 655f  isinstance(base_
-000061d0: 6c65 6172 6e65 722c 2028 4261 7365 4465  learner, (BaseDe
-000061e0: 6369 7369 6f6e 5472 6565 2c20 4c47 424d  cisionTree, LGBM
-000061f0: 4d6f 6465 6c29 293a 0a20 2020 2020 2020  Model)):.       
-00006200: 2020 2020 2063 6f65 6620 3d20 6261 7365       coef = base
-00006210: 5f6c 6561 726e 6572 2e66 6561 7475 7265  _learner.feature
-00006220: 5f69 6d70 6f72 7461 6e63 6573 5f5b 3a73  _importances_[:s
-00006230: 656c 662e 6765 6e65 5f6e 756d 5d0a 2020  elf.gene_num].  
-00006240: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
-00006250: 7461 6e63 6528 6261 7365 5f6c 6561 726e  tance(base_learn
-00006260: 6572 2c20 2847 4244 544c 5243 6c61 7373  er, (GBDTLRClass
-00006270: 6966 6965 7229 293a 0a20 2020 2020 2020  ifier)):.       
-00006280: 2020 2020 2063 6f65 6620 3d20 6261 7365       coef = base
-00006290: 5f6c 6561 726e 6572 2e67 6264 745f 2e66  _learner.gbdt_.f
-000062a0: 6561 7475 7265 5f69 6d70 6f72 7461 6e63  eature_importanc
-000062b0: 6573 5f5b 3a73 656c 662e 6765 6e65 5f6e  es_[:self.gene_n
-000062c0: 756d 5d0a 2020 2020 2020 2020 656c 6966  um].        elif
-000062d0: 2069 7369 6e73 7461 6e63 6528 6261 7365   isinstance(base
-000062e0: 5f6c 6561 726e 6572 2c20 5356 5229 3a0a  _learner, SVR):.
-000062f0: 2020 2020 2020 2020 2020 2020 636f 6566              coef
-00006300: 203d 206e 702e 6f6e 6573 2873 656c 662e   = np.ones(self.
-00006310: 582e 7368 6170 655b 315d 290a 2020 2020  X.shape[1]).    
-00006320: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
-00006330: 6e63 6528 6261 7365 5f6c 6561 726e 6572  nce(base_learner
-00006340: 2c20 2852 6964 6765 4454 2c20 4c52 4454  , (RidgeDT, LRDT
-00006350: 436c 6173 7369 6669 6572 2929 3a0a 2020  Classifier)):.  
-00006360: 2020 2020 2020 2020 2020 636f 6566 203d            coef =
-00006370: 2062 6173 655f 6c65 6172 6e65 722e 6665   base_learner.fe
-00006380: 6174 7572 655f 696d 706f 7274 616e 6365  ature_importance
-00006390: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-000063a0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-000063b0: 2045 7863 6570 7469 6f6e 0a20 2020 2020   Exception.     
-000063c0: 2020 2072 6574 7572 6e20 636f 6566 0a0a     return coef..
-000063d0: 2020 2020 6465 6620 6669 746e 6573 735f      def fitness_
-000063e0: 6576 616c 7561 7469 6f6e 2873 656c 662c  evaluation(self,
-000063f0: 2069 6e64 6976 6964 7561 6c3a 204d 756c   individual: Mul
-00006400: 7469 706c 6547 656e 6547 5029 3a0a 2020  tipleGeneGP):.  
-00006410: 2020 2020 2020 2320 7369 6e67 6c65 2069        # single i
-00006420: 6e64 6976 6964 7561 6c20 6576 616c 7561  ndividual evalua
-00006430: 7469 6f6e 0a20 2020 2020 2020 2058 2c20  tion.        X, 
-00006440: 5920 3d20 7365 6c66 2e58 2c20 7365 6c66  Y = self.X, self
-00006450: 2e79 0a20 2020 2020 2020 2059 203d 2059  .y.        Y = Y
-00006460: 2e66 6c61 7474 656e 2829 0a0a 2020 2020  .flatten()..    
-00006470: 2020 2020 2320 6675 6e63 203d 2073 656c      # func = sel
-00006480: 662e 746f 6f6c 626f 782e 636f 6d70 696c  f.toolbox.compil
-00006490: 6528 696e 6469 7669 6475 616c 290a 2020  e(individual).  
-000064a0: 2020 2020 2020 6966 2073 656c 662e 6261        if self.ba
-000064b0: 7365 5f6c 6561 726e 6572 203d 3d20 2744  se_learner == 'D
-000064c0: 796e 616d 6963 2d44 5427 3a0a 2020 2020  ynamic-DT':.    
-000064d0: 2020 2020 2020 2020 7365 6c66 2e6d 696e          self.min
-000064e0: 5f73 616d 706c 6573 5f6c 6561 6620 3d20  _samples_leaf = 
-000064f0: 696e 6469 7669 6475 616c 2e64 796e 616d  individual.dynam
-00006500: 6963 5f6c 6561 665f 7369 7a65 0a20 2020  ic_leaf_size.   
-00006510: 2020 2020 2020 2020 2070 6970 6520 3d20           pipe = 
-00006520: 7365 6c66 2e67 6574 5f62 6173 655f 6d6f  self.get_base_mo
-00006530: 6465 6c28 290a 2020 2020 2020 2020 2020  del().          
-00006540: 2020 7365 6c66 2e6d 696e 5f73 616d 706c    self.min_sampl
-00006550: 6573 5f6c 6561 6620 3d20 310a 2020 2020  es_leaf = 1.    
-00006560: 2020 2020 656c 6966 2073 656c 662e 6261      elif self.ba
-00006570: 7365 5f6c 6561 726e 6572 203d 3d20 2748  se_learner == 'H
-00006580: 7962 7269 6427 3a0a 2020 2020 2020 2020  ybrid':.        
-00006590: 2020 2020 7069 7065 203d 2073 656c 662e      pipe = self.
-000065a0: 6765 745f 6261 7365 5f6d 6f64 656c 2862  get_base_model(b
-000065b0: 6173 655f 6d6f 6465 6c3d 696e 6469 7669  ase_model=indivi
-000065c0: 6475 616c 2e62 6173 655f 6d6f 6465 6c29  dual.base_model)
-000065d0: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
-000065e0: 6c66 2e62 6173 655f 6c65 6172 6e65 7220  lf.base_learner 
-000065f0: 696e 205b 2744 542d 4c52 272c 2027 4261  in ['DT-LR', 'Ba
-00006600: 6c61 6e63 6564 2d44 542d 4c52 272c 2027  lanced-DT-LR', '
-00006610: 4261 6c61 6e63 6564 2d52 4454 2d4c 5227  Balanced-RDT-LR'
-00006620: 2c20 2744 542d 4c47 424d 272c 0a20 2020  , 'DT-LGBM',.   
-00006630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006650: 2752 4454 7e4c 6967 6874 4742 4d2d 5374  'RDT~LightGBM-St
-00006660: 756d 7027 5d20 6f72 205c 0a20 2020 2020  ump'] or \.     
-00006670: 2020 2020 2020 2069 7369 6e73 7461 6e63         isinstanc
-00006680: 6528 7365 6c66 2e62 6173 655f 6c65 6172  e(self.base_lear
-00006690: 6e65 722c 206c 6973 7429 3a0a 2020 2020  ner, list):.    
-000066a0: 2020 2020 2020 2020 7069 7065 203d 2073          pipe = s
-000066b0: 656c 662e 6765 745f 6261 7365 5f6d 6f64  elf.get_base_mod
-000066c0: 656c 2862 6173 655f 6d6f 6465 6c3d 696e  el(base_model=in
-000066d0: 6469 7669 6475 616c 2e62 6173 655f 6d6f  dividual.base_mo
-000066e0: 6465 6c29 0a20 2020 2020 2020 2065 6c69  del).        eli
-000066f0: 6620 7365 6c66 2e62 6173 655f 6c65 6172  f self.base_lear
-00006700: 6e65 7220 3d3d 2027 4479 6e61 6d69 632d  ner == 'Dynamic-
-00006710: 4c6f 6769 7374 6963 5265 6772 6573 7369  LogisticRegressi
-00006720: 6f6e 273a 0a20 2020 2020 2020 2020 2020  on':.           
-00006730: 2070 6970 6520 3d20 7365 6c66 2e67 6574   pipe = self.get
-00006740: 5f62 6173 655f 6d6f 6465 6c28 7265 6775  _base_model(regu
-00006750: 6c61 7269 7a61 7469 6f6e 5f72 6174 696f  larization_ratio
-00006760: 3d69 6e64 6976 6964 7561 6c2e 6479 6e61  =individual.dyna
-00006770: 6d69 635f 7265 6775 6c61 7269 7a61 7469  mic_regularizati
-00006780: 6f6e 290a 2020 2020 2020 2020 656c 6966  on).        elif
-00006790: 2073 656c 662e 6261 7365 5f6c 6561 726e   self.base_learn
-000067a0: 6572 203d 3d20 274c 6173 736f 273a 0a20  er == 'Lasso':. 
-000067b0: 2020 2020 2020 2020 2020 2070 6970 6520             pipe 
-000067c0: 3d20 7365 6c66 2e67 6574 5f62 6173 655f  = self.get_base_
-000067d0: 6d6f 6465 6c28 6c61 7373 6f5f 616c 7068  model(lasso_alph
-000067e0: 613d 6e70 2e70 6f77 6572 2831 302c 2069  a=np.power(10, i
-000067f0: 6e64 6976 6964 7561 6c2e 7061 7261 6d65  ndividual.parame
-00006800: 7465 7273 5b27 4c61 7373 6f27 5d29 290a  ters['Lasso'])).
-00006810: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00006820: 2020 2020 2020 2020 2020 7069 7065 203d            pipe =
-00006830: 2073 656c 662e 6765 745f 6261 7365 5f6d   self.get_base_m
-00006840: 6f64 656c 2829 0a0a 2020 2020 2020 2020  odel()..        
-00006850: 6966 2073 656c 662e 6261 7365 5f6c 6561  if self.base_lea
-00006860: 726e 6572 203d 3d20 2753 6f66 742d 504c  rner == 'Soft-PL
-00006870: 5472 6565 273a 0a20 2020 2020 2020 2020  Tree':.         
-00006880: 2020 2070 6970 652e 7061 7274 6974 696f     pipe.partitio
-00006890: 6e5f 7363 6865 6d65 203d 2069 6e64 6976  n_scheme = indiv
-000068a0: 6964 7561 6c2e 7061 7274 6974 696f 6e5f  idual.partition_
-000068b0: 7363 6865 6d65 0a0a 2020 2020 2020 2020  scheme..        
-000068c0: 6966 2073 656c 662e 6c67 705f 6d6f 6465  if self.lgp_mode
-000068d0: 203d 3d20 2752 6567 6973 7465 7227 3a0a   == 'Register':.
-000068e0: 2020 2020 2020 2020 2020 2020 7069 7065              pipe
-000068f0: 2e72 6567 6973 7465 7220 3d20 696e 6469  .register = indi
-00006900: 7669 6475 616c 2e70 6172 616d 6574 6572  vidual.parameter
-00006910: 735b 2752 6567 6973 7465 7227 5d0a 0a20  s['Register'].. 
-00006920: 2020 2020 2020 2069 6620 7365 6c66 2e69         if self.i
-00006930: 6e74 726f 6e5f 7072 6f62 6162 696c 6974  ntron_probabilit
-00006940: 7920 3e20 303a 0a20 2020 2020 2020 2020  y > 0:.         
-00006950: 2020 2070 6970 652e 6163 7469 7665 5f67     pipe.active_g
-00006960: 656e 6520 3d20 696e 6469 7669 6475 616c  ene = individual
-00006970: 2e70 6172 616d 6574 6572 735b 2741 6374  .parameters['Act
-00006980: 6976 6547 656e 6527 5d0a 0a20 2020 2020  iveGene']..     
-00006990: 2020 2023 2073 656e 6420 7461 736b 2074     # send task t
-000069a0: 6f20 7468 6520 6a6f 6220 706f 6f6c 2061  o the job pool a
-000069b0: 6e64 2077 6169 7469 6e67 2072 6573 756c  nd waiting resul
-000069c0: 7473 0a20 2020 2020 2020 2069 6620 696e  ts.        if in
-000069d0: 6469 7669 6475 616c 2e61 6374 6976 655f  dividual.active_
-000069e0: 6765 6e65 5f6e 756d 203e 2030 3a0a 2020  gene_num > 0:.  
-000069f0: 2020 2020 2020 2020 2020 6765 6e65 7320            genes 
-00006a00: 3d20 696e 6469 7669 6475 616c 2e67 656e  = individual.gen
-00006a10: 655b 3a69 6e64 6976 6964 7561 6c2e 6163  e[:individual.ac
-00006a20: 7469 7665 5f67 656e 655f 6e75 6d5d 0a20  tive_gene_num]. 
-00006a30: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00006a40: 2020 2020 2020 2020 2067 656e 6573 203d           genes =
-00006a50: 2069 6e64 6976 6964 7561 6c2e 6765 6e65   individual.gene
-00006a60: 0a0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-00006a70: 662e 6e5f 7072 6f63 6573 7320 3e20 313a  f.n_process > 1:
-00006a80: 0a20 2020 2020 2020 2020 2020 2079 5f70  .            y_p
-00006a90: 7265 642c 2065 7374 696d 6174 6f72 732c  red, estimators,
-00006aa0: 2069 6e66 6f72 6d61 7469 6f6e 203d 2079   information = y
-00006ab0: 6965 6c64 2070 6970 652c 2064 696c 6c2e  ield pipe, dill.
-00006ac0: 6475 6d70 7328 6765 6e65 732c 2070 726f  dumps(genes, pro
-00006ad0: 746f 636f 6c3d 2d31 290a 2020 2020 2020  tocol=-1).      
-00006ae0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00006af0: 2020 2020 795f 7072 6564 2c20 6573 7469      y_pred, esti
-00006b00: 6d61 746f 7273 2c20 696e 666f 726d 6174  mators, informat
-00006b10: 696f 6e20 3d20 7969 656c 6420 7069 7065  ion = yield pipe
-00006b20: 2c20 6765 6e65 730a 0a20 2020 2020 2020  , genes..       
-00006b30: 2069 6620 6c65 6e28 795f 7072 6564 2e73   if len(y_pred.s
-00006b40: 6861 7065 2920 3d3d 2032 2061 6e64 2079  hape) == 2 and y
-00006b50: 5f70 7265 642e 7368 6170 655b 315d 203d  _pred.shape[1] =
-00006b60: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
-00006b70: 2079 5f70 7265 6420 3d20 795f 7072 6564   y_pred = y_pred
-00006b80: 2e66 6c61 7474 656e 2829 0a20 2020 2020  .flatten().     
-00006b90: 2020 2069 6620 6e6f 7420 2743 5627 2069     if not 'CV' i
-00006ba0: 6e20 7365 6c66 2e73 636f 7265 5f66 756e  n self.score_fun
-00006bb0: 633a 0a20 2020 2020 2020 2020 2020 2061  c:.            a
-00006bc0: 7373 6572 7420 6c65 6e28 795f 7072 6564  ssert len(y_pred
-00006bd0: 2920 3d3d 206c 656e 2859 292c 2028 6c65  ) == len(Y), (le
-00006be0: 6e28 795f 7072 6564 292c 206c 656e 2859  n(y_pred), len(Y
-00006bf0: 2929 0a20 2020 2020 2020 2069 6e64 6976  )).        indiv
-00006c00: 6964 7561 6c2e 6576 616c 7561 7469 6f6e  idual.evaluation
-00006c10: 5f74 696d 6520 3d20 696e 666f 726d 6174  _time = informat
-00006c20: 696f 6e5b 2767 705f 6576 616c 7561 7469  ion['gp_evaluati
-00006c30: 6f6e 5f74 696d 6527 5d20 2b20 696e 666f  on_time'] + info
-00006c40: 726d 6174 696f 6e5b 276d 6c5f 6576 616c  rmation['ml_eval
-00006c50: 7561 7469 6f6e 5f74 696d 6527 5d0a 2020  uation_time'].  
-00006c60: 2020 2020 2020 7365 6c66 2e74 696d 655f        self.time_
-00006c70: 7374 6174 6973 7469 6373 5b27 4750 2045  statistics['GP E
-00006c80: 7661 6c75 6174 696f 6e27 5d2e 6170 7065  valuation'].appe
-00006c90: 6e64 2869 6e66 6f72 6d61 7469 6f6e 5b27  nd(information['
-00006ca0: 6770 5f65 7661 6c75 6174 696f 6e5f 7469  gp_evaluation_ti
-00006cb0: 6d65 275d 290a 2020 2020 2020 2020 7365  me']).        se
-00006cc0: 6c66 2e74 696d 655f 7374 6174 6973 7469  lf.time_statisti
-00006cd0: 6373 5b27 4d4c 2045 7661 6c75 6174 696f  cs['ML Evaluatio
-00006ce0: 6e27 5d2e 6170 7065 6e64 2869 6e66 6f72  n'].append(infor
-00006cf0: 6d61 7469 6f6e 5b27 6d6c 5f65 7661 6c75  mation['ml_evalu
-00006d00: 6174 696f 6e5f 7469 6d65 275d 290a 2020  ation_time']).  
-00006d10: 2020 2020 2020 6966 2073 656c 662e 6479        if self.dy
-00006d20: 6e61 6d69 635f 7061 7274 6974 696f 6e20  namic_partition 
-00006d30: 3d3d 2027 5365 6c66 2d41 6461 7074 6976  == 'Self-Adaptiv
-00006d40: 6527 2061 6e64 2073 656c 662e 6261 7365  e' and self.base
-00006d50: 5f6c 6561 726e 6572 203d 3d20 2753 6f66  _learner == 'Sof
-00006d60: 742d 504c 5472 6565 273a 0a20 2020 2020  t-PLTree':.     
-00006d70: 2020 2020 2020 2069 6e64 6976 6964 7561         individua
-00006d80: 6c2e 7061 7274 6974 696f 6e5f 7363 6865  l.partition_sche
-00006d90: 6d65 203d 2069 6e66 6f72 6d61 7469 6f6e  me = information
-00006da0: 5b27 6265 7374 5f6c 6162 656c 275d 0a20  ['best_label']. 
-00006db0: 2020 2020 2020 2020 2020 2023 2064 656c             # del
-00006dc0: 2070 6970 652e 7061 7274 6974 696f 6e5f   pipe.partition_
-00006dd0: 7363 6865 6d65 0a20 2020 2020 2020 2020  scheme.         
-00006de0: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
-00006df0: 616e 6365 2873 656c 662e 7061 7274 6974  ance(self.partit
-00006e00: 696f 6e5f 6d6f 6465 6c5b 274b 2d4d 6561  ion_model['K-Mea
-00006e10: 6e73 275d 2c20 4442 5343 414e 293a 0a20  ns'], DBSCAN):. 
-00006e20: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00006e30: 7373 6572 7420 6e70 2e61 6c6c 2869 6e64  ssert np.all(ind
-00006e40: 6976 6964 7561 6c2e 7061 7274 6974 696f  ividual.partitio
-00006e50: 6e5f 7363 6865 6d65 203c 2073 656c 662e  n_scheme < self.
-00006e60: 7061 7274 6974 696f 6e5f 6e75 6d62 6572  partition_number
-00006e70: 290a 0a20 2020 2020 2020 2023 2063 616c  )..        # cal
-00006e80: 6375 6c61 7465 2074 6572 6d69 6e61 6c20  culate terminal 
-00006e90: 696d 706f 7274 616e 6365 2062 6173 6564  importance based
-00006ea0: 206f 6e20 7468 6520 7065 726d 7574 6174   on the permutat
-00006eb0: 696f 6e20 696d 706f 7274 616e 6365 206d  ion importance m
-00006ec0: 6574 686f 640a 2020 2020 2020 2020 6966  ethod.        if
-00006ed0: 2073 656c 662e 6d75 7461 7469 6f6e 5f73   self.mutation_s
-00006ee0: 6368 656d 6520 3d3d 2027 4544 412d 5465  cheme == 'EDA-Te
-00006ef0: 726d 696e 616c 2d50 4d49 273a 0a20 2020  rminal-PMI':.   
-00006f00: 2020 2020 2020 2020 2069 6e64 6976 6964           individ
-00006f10: 7561 6c2e 6573 7469 6d61 746f 7273 203d  ual.estimators =
-00006f20: 2065 7374 696d 6174 6f72 730a 0a20 2020   estimators..   
-00006f30: 2020 2020 2069 6620 7365 6c66 2e62 6173       if self.bas
-00006f40: 655f 6c65 6172 6e65 7220 3d3d 2027 4454  e_learner == 'DT
-00006f50: 2d52 616e 646f 6d44 5427 3a0a 2020 2020  -RandomDT':.    
-00006f60: 2020 2020 2020 2020 7365 6c66 2e62 6173          self.bas
-00006f70: 655f 6c65 6172 6e65 7220 3d20 2752 616e  e_learner = 'Ran
-00006f80: 646f 6d2d 4454 270a 2020 2020 2020 2020  dom-DT'.        
-00006f90: 2020 2020 696e 6469 7669 6475 616c 2e70      individual.p
-00006fa0: 6970 6520 3d20 7365 6c66 2e67 6574 5f62  ipe = self.get_b
-00006fb0: 6173 655f 6d6f 6465 6c28 290a 2020 2020  ase_model().    
-00006fc0: 2020 2020 2020 2020 7365 6c66 2e62 6173          self.bas
-00006fd0: 655f 6c65 6172 6e65 7220 3d20 2744 542d  e_learner = 'DT-
-00006fe0: 5261 6e64 6f6d 4454 270a 2020 2020 2020  RandomDT'.      
-00006ff0: 2020 656c 6966 2073 656c 662e 6261 7365    elif self.base
-00007000: 5f6c 6561 726e 6572 203d 3d20 2752 616e  _learner == 'Ran
-00007010: 646f 6d44 542d 4454 273a 0a20 2020 2020  domDT-DT':.     
-00007020: 2020 2020 2020 2073 656c 662e 6261 7365         self.base
-00007030: 5f6c 6561 726e 6572 203d 2027 4454 270a  _learner = 'DT'.
-00007040: 2020 2020 2020 2020 2020 2020 696e 6469              indi
-00007050: 7669 6475 616c 2e70 6970 6520 3d20 7365  vidual.pipe = se
-00007060: 6c66 2e67 6574 5f62 6173 655f 6d6f 6465  lf.get_base_mode
-00007070: 6c28 290a 2020 2020 2020 2020 2020 2020  l().            
-00007080: 7365 6c66 2e62 6173 655f 6c65 6172 6e65  self.base_learne
-00007090: 7220 3d20 2752 616e 646f 6d44 542d 4454  r = 'RandomDT-DT
-000070a0: 270a 2020 2020 2020 2020 656c 6966 2073  '.        elif s
-000070b0: 656c 662e 6261 7365 5f6c 6561 726e 6572  elf.base_learner
-000070c0: 203d 3d20 2753 696d 706c 6544 542d 5261   == 'SimpleDT-Ra
-000070d0: 6e64 6f6d 4454 273a 0a20 2020 2020 2020  ndomDT':.       
-000070e0: 2020 2020 2073 656c 662e 6261 7365 5f6c       self.base_l
-000070f0: 6561 726e 6572 203d 2027 5261 6e64 6f6d  earner = 'Random
-00007100: 2d44 5427 0a20 2020 2020 2020 2020 2020  -DT'.           
-00007110: 2069 6e64 6976 6964 7561 6c2e 7069 7065   individual.pipe
-00007120: 203d 2073 656c 662e 6765 745f 6261 7365   = self.get_base
-00007130: 5f6d 6f64 656c 2829 0a20 2020 2020 2020  _model().       
-00007140: 2020 2020 2073 656c 662e 6261 7365 5f6c       self.base_l
-00007150: 6561 726e 6572 203d 2027 5369 6d70 6c65  earner = 'Simple
-00007160: 4454 2d52 616e 646f 6d44 5427 0a20 2020  DT-RandomDT'.   
-00007170: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00007180: 2020 2020 2020 2069 6620 7365 6c66 2e63         if self.c
-00007190: 7620 3d3d 2031 3a0a 2020 2020 2020 2020  v == 1:.        
-000071a0: 2020 2020 2020 2020 696e 6469 7669 6475          individu
-000071b0: 616c 2e70 6970 6520 3d20 6573 7469 6d61  al.pipe = estima
-000071c0: 746f 7273 5b30 5d0a 2020 2020 2020 2020  tors[0].        
-000071d0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-000071e0: 2020 2020 2020 2020 2020 696e 6469 7669            indivi
-000071f0: 6475 616c 2e70 6970 6520 3d20 7069 7065  dual.pipe = pipe
-00007200: 0a0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-00007210: 662e 626f 6f74 7374 7261 705f 7472 6169  f.bootstrap_trai
-00007220: 6e69 6e67 206f 7220 7365 6c66 2e65 6167  ning or self.eag
-00007230: 6572 5f74 7261 696e 696e 673a 0a20 2020  er_training:.   
-00007240: 2020 2020 2020 2020 2059 7020 3d20 7175           Yp = qu
-00007250: 6963 6b5f 7265 7375 6c74 5f63 616c 6375  ick_result_calcu
-00007260: 6c61 7469 6f6e 2867 656e 6573 2c20 7365  lation(genes, se
-00007270: 6c66 2e70 7365 742c 2058 2c20 7365 6c66  lf.pset, X, self
-00007280: 2e6f 7269 6769 6e61 6c5f 6665 6174 7572  .original_featur
-00007290: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
-000072a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000072b0: 2020 2020 2020 2020 2020 2020 2020 736b                sk
-000072c0: 6c65 6172 6e5f 666f 726d 6174 3d73 656c  learn_format=sel
-000072d0: 662e 6261 7369 635f 7072 696d 6974 6976  f.basic_primitiv
-000072e0: 6573 203d 3d20 274d 4c27 2c0a 2020 2020  es == 'ML',.    
-000072f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007310: 2020 2020 2020 7265 6769 7374 6572 5f61        register_a
-00007320: 7272 6179 3d69 6e64 6976 6964 7561 6c2e  rray=individual.
-00007330: 7061 7261 6d65 7465 7273 5b27 5265 6769  parameters['Regi
-00007340: 7374 6572 275d 0a20 2020 2020 2020 2020  ster'].         
-00007350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007370: 2069 6620 7365 6c66 2e6c 6770 5f6d 6f64   if self.lgp_mod
-00007380: 6520 3d3d 2027 5265 6769 7374 6572 2720  e == 'Register' 
-00007390: 656c 7365 204e 6f6e 6529 0a20 2020 2020  else None).     
-000073a0: 2020 2020 2020 2073 656c 662e 7472 6169         self.trai
-000073b0: 6e5f 6669 6e61 6c5f 6d6f 6465 6c28 696e  n_final_model(in
-000073c0: 6469 7669 6475 616c 2c20 5970 2c20 5929  dividual, Yp, Y)
-000073d0: 0a0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-000073e0: 662e 626f 6f74 7374 7261 705f 7472 6169  f.bootstrap_trai
-000073f0: 6e69 6e67 3a0a 2020 2020 2020 2020 2020  ning:.          
-00007400: 2020 2320 6361 6c63 756c 6174 6520 7072    # calculate pr
-00007410: 6564 6963 7469 6f6e 0a20 2020 2020 2020  ediction.       
-00007420: 2020 2020 2059 705f 6f6f 6220 3d20 5970       Yp_oob = Yp
-00007430: 5b69 6e64 6976 6964 7561 6c2e 6f75 745f  [individual.out_
-00007440: 6f66 5f62 6167 5d0a 2020 2020 2020 2020  of_bag].        
-00007450: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00007460: 6528 7365 6c66 2c20 436c 6173 7369 6669  e(self, Classifi
-00007470: 6572 4d69 7869 6e29 3a0a 2020 2020 2020  erMixin):.      
-00007480: 2020 2020 2020 2020 2020 696e 6469 7669            indivi
-00007490: 6475 616c 2e6f 6f62 5f70 7265 6469 6374  dual.oob_predict
-000074a0: 696f 6e20 3d20 696e 6469 7669 6475 616c  ion = individual
-000074b0: 2e70 6970 652e 7072 6564 6963 745f 7072  .pipe.predict_pr
-000074c0: 6f62 6128 5970 5f6f 6f62 290a 2020 2020  oba(Yp_oob).    
-000074d0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-000074e0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-000074f0: 6469 7669 6475 616c 2e6f 6f62 5f70 7265  dividual.oob_pre
-00007500: 6469 6374 696f 6e20 3d20 696e 6469 7669  diction = indivi
-00007510: 6475 616c 2e70 6970 652e 7072 6564 6963  dual.pipe.predic
-00007520: 7428 5970 5f6f 6f62 290a 0a20 2020 2020  t(Yp_oob)..     
-00007530: 2020 2069 6e64 6976 6964 7561 6c2e 7072     individual.pr
-00007540: 6564 6963 7465 645f 7661 6c75 6573 203d  edicted_values =
-00007550: 2079 5f70 7265 640a 0a20 2020 2020 2020   y_pred..       
-00007560: 2023 206d 696e 696d 697a 6520 6f62 6a65   # minimize obje
-00007570: 6374 6976 6520 6675 6e63 7469 6f6e 0a20  ctive function. 
-00007580: 2020 2020 2020 2073 656c 662e 6361 6c63         self.calc
-00007590: 756c 6174 655f 6361 7365 5f76 616c 7565  ulate_case_value
-000075a0: 7328 696e 6469 7669 6475 616c 2c20 6573  s(individual, es
-000075b0: 7469 6d61 746f 7273 2c20 592c 2079 5f70  timators, Y, y_p
-000075c0: 7265 6429 0a0a 2020 2020 2020 2020 6966  red)..        if
-000075d0: 2027 4356 2720 696e 2073 656c 662e 7363   'CV' in self.sc
-000075e0: 6f72 655f 6675 6e63 3a0a 2020 2020 2020  ore_func:.      
-000075f0: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
-00007600: 2869 6e64 6976 6964 7561 6c2e 6361 7365  (individual.case
-00007610: 5f76 616c 7565 7329 2025 2035 203d 3d20  _values) % 5 == 
-00007620: 300a 2020 2020 2020 2020 656c 6966 2073  0.        elif s
-00007630: 656c 662e 7363 6f72 655f 6675 6e63 203d  elf.score_func =
-00007640: 3d20 2743 4446 4327 3a0a 2020 2020 2020  = 'CDFC':.      
-00007650: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
-00007660: 2869 6e64 6976 6964 7561 6c2e 6361 7365  (individual.case
-00007670: 5f76 616c 7565 7329 203d 3d20 6c65 6e28  _values) == len(
-00007680: 6e70 2e75 6e69 7175 6528 5929 290a 2020  np.unique(Y)).  
-00007690: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-000076a0: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
-000076b0: 656e 2869 6e64 6976 6964 7561 6c2e 6361  en(individual.ca
-000076c0: 7365 5f76 616c 7565 7329 203d 3d20 6c65  se_values) == le
-000076d0: 6e28 5929 2c20 6c65 6e28 696e 6469 7669  n(Y), len(indivi
-000076e0: 6475 616c 2e63 6173 655f 7661 6c75 6573  dual.case_values
-000076f0: 290a 0a20 2020 2020 2020 2023 2069 6e64  )..        # ind
-00007700: 6976 6964 7561 6c2e 636f 6566 203d 206e  ividual.coef = n
-00007710: 702e 636c 6970 286e 702e 6d65 616e 285b  p.clip(np.mean([
-00007720: 7365 6c66 2e67 6574 5f6d 6f64 656c 5f63  self.get_model_c
-00007730: 6f65 6666 6963 6965 6e74 2878 2920 666f  oefficient(x) fo
-00007740: 7220 7820 696e 2065 7374 696d 6174 6f72  r x in estimator
-00007750: 735d 2c20 6178 6973 3d30 2920 2d20 5c0a  s], axis=0) - \.
-00007760: 2020 2020 2020 2020 2320 2020 2020 2020          #       
-00007770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007780: 2020 2020 6e70 2e73 7464 285b 7365 6c66      np.std([self
-00007790: 2e67 6574 5f6d 6f64 656c 5f63 6f65 6666  .get_model_coeff
-000077a0: 6963 6965 6e74 2878 2920 666f 7220 7820  icient(x) for x 
-000077b0: 696e 2065 7374 696d 6174 6f72 735d 2c20  in estimators], 
-000077c0: 6178 6973 3d30 292c 2030 2c20 4e6f 6e65  axis=0), 0, None
-000077d0: 290a 2020 2020 2020 2020 696e 6469 7669  ).        indivi
-000077e0: 6475 616c 2e63 6f65 6620 3d20 6e70 2e6d  dual.coef = np.m
-000077f0: 6178 285b 7365 6c66 2e67 6574 5f6d 6f64  ax([self.get_mod
-00007800: 656c 5f63 6f65 6666 6963 6965 6e74 2878  el_coefficient(x
-00007810: 2920 666f 7220 7820 696e 2065 7374 696d  ) for x in estim
-00007820: 6174 6f72 735d 2c20 6178 6973 3d30 290a  ators], axis=0).
-00007830: 2020 2020 2020 2020 6966 2073 756d 2869          if sum(i
-00007840: 6e64 6976 6964 7561 6c2e 636f 6566 2920  ndividual.coef) 
-00007850: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
-00007860: 2020 696e 6469 7669 6475 616c 2e63 6f65    individual.coe
-00007870: 6620 3d20 6e70 2e6f 6e65 735f 6c69 6b65  f = np.ones_like
-00007880: 2869 6e64 6976 6964 7561 6c2e 636f 6566  (individual.coef
-00007890: 290a 2020 2020 2020 2020 696e 6469 7669  ).        indivi
-000078a0: 6475 616c 2e63 6f65 6620 3d20 696e 6469  dual.coef = indi
-000078b0: 7669 6475 616c 2e63 6f65 6620 2f20 6e70  vidual.coef / np
-000078c0: 2e73 756d 2869 6e64 6976 6964 7561 6c2e  .sum(individual.
-000078d0: 636f 6566 290a 2020 2020 2020 2020 696e  coef).        in
-000078e0: 6469 7669 6475 616c 2e63 6f65 6620 3d20  dividual.coef = 
-000078f0: 6e70 2e6e 616e 5f74 6f5f 6e75 6d28 696e  np.nan_to_num(in
-00007900: 6469 7669 6475 616c 2e63 6f65 662c 2070  dividual.coef, p
-00007910: 6f73 696e 663d 302c 206e 6567 696e 663d  osinf=0, neginf=
-00007920: 3029 0a0a 2020 2020 2020 2020 6966 2073  0)..        if s
-00007930: 656c 662e 7665 7262 6f73 653a 0a20 2020  elf.verbose:.   
-00007940: 2020 2020 2020 2020 2070 6173 730a 0a20           pass.. 
-00007950: 2020 2020 2020 2069 6620 7365 6c66 2e62         if self.b
-00007960: 6173 655f 6c65 6172 6e65 7220 3d3d 2027  ase_learner == '
-00007970: 5261 6e64 6f6d 2d44 542d 506c 7573 273a  Random-DT-Plus':
-00007980: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00007990: 6973 696e 7374 616e 6365 2873 656c 662c  isinstance(self,
-000079a0: 2043 6c61 7373 6966 6965 724d 6978 696e   ClassifierMixin
-000079b0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-000079c0: 2020 2069 6e64 6976 6964 7561 6c2e 7069     individual.pi
-000079d0: 7065 203d 2045 6e73 656d 626c 6543 6c61  pe = EnsembleCla
-000079e0: 7373 6966 6965 7228 6573 7469 6d61 746f  ssifier(estimato
-000079f0: 7273 290a 2020 2020 2020 2020 2020 2020  rs).            
-00007a00: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
-00007a10: 7365 6c66 2c20 5265 6772 6573 736f 724d  self, RegressorM
-00007a20: 6978 696e 293a 0a20 2020 2020 2020 2020  ixin):.         
-00007a30: 2020 2020 2020 2069 6e64 6976 6964 7561         individua
-00007a40: 6c2e 7069 7065 203d 2045 6e73 656d 626c  l.pipe = Ensembl
-00007a50: 6552 6567 7265 7373 6f72 2865 7374 696d  eRegressor(estim
-00007a60: 6174 6f72 7329 0a20 2020 2020 2020 2020  ators).         
-00007a70: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00007a80: 2020 2020 2020 2020 2072 6169 7365 2045           raise E
-00007a90: 7863 6570 7469 6f6e 0a0a 2020 2020 2020  xception..      
-00007aa0: 2020 2320 636f 756e 7420 7468 6520 6e75    # count the nu
-00007ab0: 6d62 6572 206f 6620 6e6f 6465 7320 696e  mber of nodes in
-00007ac0: 2064 6563 6973 696f 6e20 7472 6565 0a20   decision tree. 
-00007ad0: 2020 2020 2020 2069 6620 7365 6c66 2e62         if self.b
-00007ae0: 6173 6963 5f70 7269 6d69 7469 7665 7320  asic_primitives 
-00007af0: 213d 2027 4d4c 2720 616e 6420 6861 7361  != 'ML' and hasa
-00007b00: 7474 7228 6573 7469 6d61 746f 7273 5b30  ttr(estimators[0
-00007b10: 5d5b 2752 6964 6765 275d 2c20 2774 7265  ]['Ridge'], 'tre
-00007b20: 655f 2729 3a0a 2020 2020 2020 2020 2020  e_'):.          
-00007b30: 2020 696e 6469 7669 6475 616c 2e6e 6f64    individual.nod
-00007b40: 655f 636f 756e 7420 3d20 5b65 7374 696d  e_count = [estim
-00007b50: 6174 6f72 735b 695d 5b27 5269 6467 6527  ators[i]['Ridge'
-00007b60: 5d2e 7472 6565 5f2e 6e6f 6465 5f63 6f75  ].tree_.node_cou
-00007b70: 6e74 2066 6f72 2069 2069 6e20 7261 6e67  nt for i in rang
-00007b80: 6528 6c65 6e28 6573 7469 6d61 746f 7273  e(len(estimators
-00007b90: 2929 5d0a 2020 2020 2020 2020 696e 6469  ))].        indi
-00007ba0: 7669 6475 616c 2e68 6173 685f 7265 7375  vidual.hash_resu
-00007bb0: 6c74 203d 2069 6e66 6f72 6d61 7469 6f6e  lt = information
-00007bc0: 5b27 6861 7368 5f72 6573 756c 7427 5d0a  ['hash_result'].
-00007bd0: 0a20 2020 2020 2020 2023 2066 696e 616c  .        # final
-00007be0: 2073 636f 7265 0a20 2020 2020 2020 2079   score.        y
-00007bf0: 6965 6c64 2073 656c 662e 6361 6c63 756c  ield self.calcul
-00007c00: 6174 655f 6669 746e 6573 735f 7661 6c75  ate_fitness_valu
-00007c10: 6528 696e 6469 7669 6475 616c 2c20 6573  e(individual, es
-00007c20: 7469 6d61 746f 7273 2c20 592c 2079 5f70  timators, Y, y_p
-00007c30: 7265 6429 0a0a 2020 2020 6465 6620 6361  red)..    def ca
-00007c40: 6c63 756c 6174 655f 6669 746e 6573 735f  lculate_fitness_
-00007c50: 7661 6c75 6528 7365 6c66 2c20 696e 6469  value(self, indi
-00007c60: 7669 6475 616c 2c20 6573 7469 6d61 746f  vidual, estimato
-00007c70: 7273 2c20 592c 2079 5f70 7265 6429 3a0a  rs, Y, y_pred):.
-00007c80: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00007c90: 2020 2020 536d 616c 6c65 7220 6973 2062      Smaller is b
-00007ca0: 6574 7465 7220 6265 6361 7573 6520 7468  etter because th
-00007cb0: 6520 7765 6967 6874 2069 7320 2d31 2e0a  e weight is -1..
-00007cc0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00007cd0: 2020 2020 6966 2073 656c 662e 7363 6f72      if self.scor
-00007ce0: 655f 6675 6e63 203d 3d20 2752 3227 206f  e_func == 'R2' o
-00007cf0: 7220 7365 6c66 2e73 636f 7265 5f66 756e  r self.score_fun
-00007d00: 6320 3d3d 2027 4e6f 7665 6c74 7953 6561  c == 'NoveltySea
-00007d10: 7263 6827 206f 7220 7365 6c66 2e73 636f  rch' or self.sco
-00007d20: 7265 5f66 756e 6320 3d3d 2027 4d41 4527  re_func == 'MAE'
-00007d30: 3a0a 2020 2020 2020 2020 2020 2020 7363  :.            sc
-00007d40: 6f72 6520 3d20 7232 5f73 636f 7265 2859  ore = r2_score(Y
-00007d50: 2c20 795f 7072 6564 290a 2020 2020 2020  , y_pred).      
-00007d60: 2020 2020 2020 6966 2073 656c 662e 7765        if self.we
-00007d70: 6967 6874 6564 5f63 6f65 663a 0a20 2020  ighted_coef:.   
-00007d80: 2020 2020 2020 2020 2020 2020 2069 6e64               ind
-00007d90: 6976 6964 7561 6c2e 636f 6566 203d 206e  ividual.coef = n
-00007da0: 702e 6172 7261 7928 696e 6469 7669 6475  p.array(individu
-00007db0: 616c 2e63 6f65 6629 202a 2073 636f 7265  al.coef) * score
-00007dc0: 0a20 2020 2020 2020 2020 2020 2023 2070  .            # p
-00007dd0: 7269 6e74 2827 7232 5f73 636f 7265 272c  rint('r2_score',
-00007de0: 7363 6f72 6529 0a20 2020 2020 2020 2020  score).         
-00007df0: 2020 2072 6574 7572 6e20 2d31 202a 2073     return -1 * s
-00007e00: 636f 7265 2c0a 2020 2020 2020 2020 656c  core,.        el
-00007e10: 6966 2073 656c 662e 7363 6f72 655f 6675  if self.score_fu
-00007e20: 6e63 203d 3d20 274d 5345 2d56 6172 6961  nc == 'MSE-Varia
-00007e30: 6e63 6527 3a0a 2020 2020 2020 2020 2020  nce':.          
-00007e40: 2020 6572 726f 7220 3d20 6d65 616e 5f73    error = mean_s
-00007e50: 7175 6172 6564 5f65 7272 6f72 2859 2c20  quared_error(Y, 
-00007e60: 795f 7072 6564 290a 2020 2020 2020 2020  y_pred).        
-00007e70: 2020 2020 7265 7475 726e 206e 702e 6d65      return np.me
-00007e80: 616e 2865 7272 6f72 2920 2b20 302e 3031  an(error) + 0.01
-00007e90: 202a 206e 702e 7374 6428 6572 726f 7229   * np.std(error)
-00007ea0: 2c0a 2020 2020 2020 2020 656c 6966 2073  ,.        elif s
-00007eb0: 656c 662e 7363 6f72 655f 6675 6e63 203d  elf.score_func =
-00007ec0: 3d20 274c 6f77 6572 2d42 6f75 6e64 273a  = 'Lower-Bound':
-00007ed0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00007ee0: 7572 6e20 6e70 2e6d 6178 286d 6561 6e5f  urn np.max(mean_
-00007ef0: 7371 7561 7265 645f 6572 726f 7228 592c  squared_error(Y,
-00007f00: 2079 5f70 7265 6429 292c 0a20 2020 2020   y_pred)),.     
-00007f10: 2020 2065 6c69 6620 7365 6c66 2e73 636f     elif self.sco
-00007f20: 7265 5f66 756e 6320 3d3d 2027 5370 6561  re_func == 'Spea
-00007f30: 726d 616e 273a 0a20 2020 2020 2020 2020  rman':.         
-00007f40: 2020 2072 6574 7572 6e20 2d31 202a 2073     return -1 * s
-00007f50: 7065 6172 6d61 6e28 592c 2079 5f70 7265  pearman(Y, y_pre
-00007f60: 6429 2c0a 2020 2020 2020 2020 656c 6966  d),.        elif
-00007f70: 2073 656c 662e 7363 6f72 655f 6675 6e63   self.score_func
-00007f80: 203d 3d20 2743 562d 4e6f 6465 436f 756e   == 'CV-NodeCoun
-00007f90: 7427 3a0a 2020 2020 2020 2020 2020 2020  t':.            
-00007fa0: 7265 7475 726e 205b 6573 7469 6d61 746f  return [estimato
-00007fb0: 7273 5b69 5d5b 2752 6964 6765 275d 2e74  rs[i]['Ridge'].t
-00007fc0: 7265 655f 2e6e 6f64 655f 636f 756e 7420  ree_.node_count 
-00007fd0: 666f 7220 6920 696e 2072 616e 6765 286c  for i in range(l
-00007fe0: 656e 2865 7374 696d 6174 6f72 7329 295d  en(estimators))]
-00007ff0: 0a20 2020 2020 2020 2065 6c69 6620 2743  .        elif 'C
-00008000: 5627 2069 6e20 7365 6c66 2e73 636f 7265  V' in self.score
-00008010: 5f66 756e 633a 0a20 2020 2020 2020 2020  _func:.         
-00008020: 2020 2072 6574 7572 6e20 2d31 202a 206e     return -1 * n
-00008030: 702e 6d65 616e 2879 5f70 7265 6429 2c0a  p.mean(y_pred),.
-00008040: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00008050: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00008060: 4578 6365 7074 696f 6e0a 0a20 2020 2064  Exception..    d
-00008070: 6566 2063 616c 6375 6c61 7465 5f63 6173  ef calculate_cas
-00008080: 655f 7661 6c75 6573 2873 656c 662c 2069  e_values(self, i
-00008090: 6e64 6976 6964 7561 6c2c 2065 7374 696d  ndividual, estim
-000080a0: 6174 6f72 732c 2059 2c20 795f 7072 6564  ators, Y, y_pred
-000080b0: 293a 0a20 2020 2020 2020 2023 204d 696e  ):.        # Min
-000080c0: 696d 697a 6520 6669 746e 6573 7320 7661  imize fitness va
-000080d0: 6c75 6573 0a20 2020 2020 2020 2069 6620  lues.        if 
-000080e0: 7365 6c66 2e73 636f 7265 5f66 756e 6320  self.score_func 
-000080f0: 3d3d 2027 5232 2720 6f72 2073 656c 662e  == 'R2' or self.
-00008100: 7363 6f72 655f 6675 6e63 203d 3d20 274d  score_func == 'M
-00008110: 5345 2d56 6172 6961 6e63 6527 206f 7220  SE-Variance' or 
-00008120: 7365 6c66 2e73 636f 7265 5f66 756e 6320  self.score_func 
-00008130: 3d3d 2027 4c6f 7765 722d 426f 756e 6427  == 'Lower-Bound'
-00008140: 3a0a 2020 2020 2020 2020 2020 2020 696e  :.            in
-00008150: 6469 7669 6475 616c 2e63 6173 655f 7661  dividual.case_va
-00008160: 6c75 6573 203d 2028 2879 5f70 7265 6420  lues = ((y_pred 
-00008170: 2d20 592e 666c 6174 7465 6e28 2929 2e66  - Y.flatten()).f
-00008180: 6c61 7474 656e 2829 2920 2a2a 2032 0a20  latten()) ** 2. 
-00008190: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
-000081a0: 2e73 636f 7265 5f66 756e 6320 3d3d 2027  .score_func == '
-000081b0: 4d41 4527 3a0a 2020 2020 2020 2020 2020  MAE':.          
-000081c0: 2020 696e 6469 7669 6475 616c 2e63 6173    individual.cas
-000081d0: 655f 7661 6c75 6573 203d 206e 702e 6162  e_values = np.ab
-000081e0: 7328 2828 795f 7072 6564 202d 2059 2e66  s(((y_pred - Y.f
-000081f0: 6c61 7474 656e 2829 292e 666c 6174 7465  latten()).flatte
-00008200: 6e28 2929 290a 2020 2020 2020 2020 656c  n())).        el
-00008210: 6966 2073 656c 662e 7363 6f72 655f 6675  if self.score_fu
-00008220: 6e63 203d 3d20 2753 7065 6172 6d61 6e27  nc == 'Spearman'
-00008230: 3a0a 2020 2020 2020 2020 2020 2020 696e  :.            in
-00008240: 6469 7669 6475 616c 2e63 6173 655f 7661  dividual.case_va
-00008250: 6c75 6573 203d 206e 702e 6162 7328 7261  lues = np.abs(ra
-00008260: 6e6b 6461 7461 2879 5f70 7265 6429 202d  nkdata(y_pred) -
-00008270: 2072 616e 6b64 6174 6128 592e 666c 6174   rankdata(Y.flat
-00008280: 7465 6e28 2929 292e 666c 6174 7465 6e28  ten())).flatten(
-00008290: 290a 2020 2020 2020 2020 656c 6966 2027  ).        elif '
-000082a0: 4356 2720 696e 2073 656c 662e 7363 6f72  CV' in self.scor
-000082b0: 655f 6675 6e63 3a0a 2020 2020 2020 2020  e_func:.        
-000082c0: 2020 2020 696e 6469 7669 6475 616c 2e63      individual.c
-000082d0: 6173 655f 7661 6c75 6573 203d 202d 3120  ase_values = -1 
-000082e0: 2a20 795f 7072 6564 0a20 2020 2020 2020  * y_pred.       
-000082f0: 2065 6c69 6620 7365 6c66 2e73 636f 7265   elif self.score
-00008300: 5f66 756e 6320 3d3d 2027 4e6f 7665 6c74  _func == 'Novelt
-00008310: 7953 6561 7263 6827 3a0a 2020 2020 2020  ySearch':.      
-00008320: 2020 2020 2020 6261 7365 5f76 616c 7565        base_value
-00008330: 7320 3d20 2879 5f70 7265 642e 666c 6174  s = (y_pred.flat
-00008340: 7465 6e28 2920 2d20 592e 666c 6174 7465  ten() - Y.flatte
-00008350: 6e28 2929 202a 2a20 320a 2020 2020 2020  n()) ** 2.      
-00008360: 2020 2020 2020 6966 206c 656e 2873 656c        if len(sel
-00008370: 662e 686f 6629 203d 3d20 303a 0a20 2020  f.hof) == 0:.   
-00008380: 2020 2020 2020 2020 2020 2020 2023 2066               # f
-00008390: 6972 7374 2067 656e 6572 6174 696f 6e0a  irst generation.
-000083a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000083b0: 2320 696e 6469 7669 6475 616c 2e63 6173  # individual.cas
-000083c0: 655f 7661 6c75 6573 203d 2062 6173 655f  e_values = base_
-000083d0: 7661 6c75 6573 0a20 2020 2020 2020 2020  values.         
-000083e0: 2020 2020 2020 2069 6e64 6976 6964 7561         individua
-000083f0: 6c2e 6361 7365 5f76 616c 7565 7320 3d20  l.case_values = 
-00008400: 6e70 2e63 6f6e 6361 7465 6e61 7465 285b  np.concatenate([
-00008410: 6261 7365 5f76 616c 7565 732c 206e 702e  base_values, np.
-00008420: 6675 6c6c 5f6c 696b 6528 6261 7365 5f76  full_like(base_v
-00008430: 616c 7565 732c 2030 295d 290a 2020 2020  alues, 0)]).    
-00008440: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00008450: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00008460: 6d61 7869 6d69 7a65 2063 726f 7373 2065  maximize cross e
-00008470: 6e74 726f 7079 0a20 2020 2020 2020 2020  ntropy.         
-00008480: 2020 2020 2020 2065 6e73 656d 626c 655f         ensemble_
-00008490: 7661 6c75 6520 3d20 6e70 2e6d 6561 6e28  value = np.mean(
-000084a0: 5b78 2e70 7265 6469 6374 6564 5f76 616c  [x.predicted_val
-000084b0: 7565 7320 666f 7220 7820 696e 2073 656c  ues for x in sel
-000084c0: 662e 686f 665d 2c20 6178 6973 3d30 290a  f.hof], axis=0).
-000084d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000084e0: 616d 6269 6775 6974 7920 3d20 2879 5f70  ambiguity = (y_p
-000084f0: 7265 642e 666c 6174 7465 6e28 2920 2d20  red.flatten() - 
-00008500: 656e 7365 6d62 6c65 5f76 616c 7565 2920  ensemble_value) 
-00008510: 2a2a 2032 0a20 2020 2020 2020 2020 2020  ** 2.           
-00008520: 2020 2020 2061 6d62 6967 7569 7479 202a       ambiguity *
-00008530: 3d20 7365 6c66 2e6e 6f76 656c 7479 5f77  = self.novelty_w
-00008540: 6569 6768 740a 2020 2020 2020 2020 2020  eight.          
-00008550: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
-00008560: 2861 6d62 6967 7569 7479 2920 3d3d 206c  (ambiguity) == l
-00008570: 656e 2879 5f70 7265 642e 666c 6174 7465  en(y_pred.flatte
-00008580: 6e28 2929 0a20 2020 2020 2020 2020 2020  n()).           
-00008590: 2020 2020 2023 2069 6e64 6976 6964 7561       # individua
-000085a0: 6c2e 6361 7365 5f76 616c 7565 7320 3d20  l.case_values = 
-000085b0: 6261 7365 5f76 616c 7565 7320 2d20 616d  base_values - am
-000085c0: 6269 6775 6974 790a 2020 2020 2020 2020  biguity.        
-000085d0: 2020 2020 2020 2020 696e 6469 7669 6475          individu
-000085e0: 616c 2e63 6173 655f 7661 6c75 6573 203d  al.case_values =
-000085f0: 206e 702e 636f 6e63 6174 656e 6174 6528   np.concatenate(
-00008600: 5b62 6173 655f 7661 6c75 6573 2c20 2d31  [base_values, -1
-00008610: 202a 2061 6d62 6967 7569 7479 5d29 0a20   * ambiguity]). 
-00008620: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00008630: 2069 6e64 6976 6964 7561 6c2e 6361 7365   individual.case
-00008640: 5f76 616c 7565 7320 3d20 6e70 2e63 6f6e  _values = np.con
-00008650: 6361 7465 6e61 7465 285b 6261 7365 5f76  catenate([base_v
-00008660: 616c 7565 732c 2062 6173 655f 7661 6c75  alues, base_valu
-00008670: 6573 5d29 0a20 2020 2020 2020 2065 6c73  es]).        els
-00008680: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-00008690: 6169 7365 2045 7863 6570 7469 6f6e 0a0a  aise Exception..
-000086a0: 2020 2020 6465 6620 7472 6169 6e5f 6669      def train_fi
-000086b0: 6e61 6c5f 6d6f 6465 6c28 7365 6c66 2c20  nal_model(self, 
-000086c0: 696e 6469 7669 6475 616c 2c20 5970 2c20  individual, Yp, 
-000086d0: 592c 2066 6f72 6365 5f74 7261 696e 696e  Y, force_trainin
-000086e0: 673d 4661 6c73 6529 3a0a 2020 2020 2020  g=False):.      
-000086f0: 2020 6966 2073 656c 662e 6261 7365 5f6c    if self.base_l
-00008700: 6561 726e 6572 203d 3d20 2746 6173 742d  earner == 'Fast-
-00008710: 536f 6674 2d50 4c54 7265 652d 454d 273a  Soft-PLTree-EM':
-00008720: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00008730: 662e 6261 7365 5f6c 6561 726e 6572 203d  f.base_learner =
-00008740: 2027 536f 6674 2d50 4c54 7265 652d 454d   'Soft-PLTree-EM
-00008750: 270a 2020 2020 2020 2020 2020 2020 696e  '.            in
-00008760: 6469 7669 6475 616c 2e70 6970 6520 3d20  dividual.pipe = 
-00008770: 7365 6c66 2e67 6574 5f62 6173 655f 6d6f  self.get_base_mo
-00008780: 6465 6c28 290a 2020 2020 2020 2020 6966  del().        if
-00008790: 2073 656c 662e 6261 7365 5f6c 6561 726e   self.base_learn
-000087a0: 6572 203d 3d20 274c 6173 736f 2d52 6964  er == 'Lasso-Rid
-000087b0: 6765 4356 273a 0a20 2020 2020 2020 2020  geCV':.         
-000087c0: 2020 2073 656c 662e 6261 7365 5f6c 6561     self.base_lea
-000087d0: 726e 6572 203d 2027 5269 6467 6543 5627  rner = 'RidgeCV'
-000087e0: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
-000087f0: 6976 6964 7561 6c2e 7069 7065 203d 2073  ividual.pipe = s
-00008800: 656c 662e 6765 745f 6261 7365 5f6d 6f64  elf.get_base_mod
-00008810: 656c 2829 0a20 2020 2020 2020 2020 2020  el().           
-00008820: 2073 656c 662e 6261 7365 5f6c 6561 726e   self.base_learn
-00008830: 6572 203d 2027 4c61 7373 6f2d 5269 6467  er = 'Lasso-Ridg
-00008840: 6543 5627 0a20 2020 2020 2020 2023 2061  eCV'.        # a
-00008850: 766f 6964 2072 652d 7472 6169 6e69 6e67  void re-training
-00008860: 0a20 2020 2020 2020 206d 6f64 656c 203d  .        model =
-00008870: 2069 6e64 6976 6964 7561 6c2e 7069 7065   individual.pipe
-00008880: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-00008890: 2e62 6173 6963 5f70 7269 6d69 7469 7665  .basic_primitive
-000088a0: 7320 3d3d 2027 4d4c 2720 616e 6420 6d6f  s == 'ML' and mo
-000088b0: 6465 6c2e 7374 6570 735b 305d 5b30 5d20  del.steps[0][0] 
-000088c0: 213d 2027 6665 6174 7572 6527 3a0a 2020  != 'feature':.  
-000088d0: 2020 2020 2020 2020 2020 696e 6469 7669            indivi
-000088e0: 6475 616c 2e70 6970 6520 3d20 7069 7065  dual.pipe = pipe
-000088f0: 5f63 6f6d 6269 6e65 2859 702c 206d 6f64  _combine(Yp, mod
-00008900: 656c 290a 2020 2020 2020 2020 2020 2020  el).            
-00008910: 6d6f 6465 6c20 3d20 696e 6469 7669 6475  model = individu
-00008920: 616c 2e70 6970 650a 2020 2020 2020 2020  al.pipe.        
-00008930: 2020 2020 5970 203d 2073 656c 662e 580a      Yp = self.X.
-00008940: 2020 2020 2020 2020 6966 206e 6f74 2066          if not f
-00008950: 6f72 6365 5f74 7261 696e 696e 673a 0a20  orce_training:. 
-00008960: 2020 2020 2020 2020 2020 2023 2063 6865             # che
-00008970: 636b 2074 6865 206e 6563 6573 7369 7479  ck the necessity
-00008980: 206f 6620 7472 6169 6e69 6e67 0a20 2020   of training.   
-00008990: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
-000089a0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000089b0: 2068 6173 6174 7472 2869 6e64 6976 6964   hasattr(individ
-000089c0: 7561 6c2c 2027 6163 7469 7665 5f67 656e  ual, 'active_gen
-000089d0: 655f 6e75 6d27 2920 616e 6420 696e 6469  e_num') and indi
-000089e0: 7669 6475 616c 2e61 6374 6976 655f 6765  vidual.active_ge
-000089f0: 6e65 5f6e 756d 203e 2030 3a0a 2020 2020  ne_num > 0:.    
-00008a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008a10: 696e 7075 745f 7369 7a65 203d 2069 6e64  input_size = ind
-00008a20: 6976 6964 7561 6c2e 6163 7469 7665 5f67  ividual.active_g
-00008a30: 656e 655f 6e75 6d0a 2020 2020 2020 2020  ene_num.        
-00008a40: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00008a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008a60: 2020 696e 7075 745f 7369 7a65 203d 206c    input_size = l
-00008a70: 656e 2869 6e64 6976 6964 7561 6c2e 6765  en(individual.ge
-00008a80: 6e65 290a 2020 2020 2020 2020 2020 2020  ne).            
-00008a90: 2020 2020 6966 2073 656c 662e 6261 7365      if self.base
-00008aa0: 5f6c 6561 726e 6572 203d 3d20 274e 4e27  _learner == 'NN'
-00008ab0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00008ac0: 2020 2020 2020 696e 7075 745f 7369 7a65        input_size
-00008ad0: 202b 3d20 7365 6c66 2e68 6964 6465 6e5f   += self.hidden_
-00008ae0: 6c61 7965 7273 5b2d 315d 0a20 2020 2020  layers[-1].     
-00008af0: 2020 2020 2020 2020 2020 2069 6620 6861             if ha
-00008b00: 7361 7474 7228 6d6f 6465 6c2c 2027 7061  sattr(model, 'pa
-00008b10: 7274 6974 696f 6e5f 7363 6865 6d65 2729  rtition_scheme')
-00008b20: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00008b30: 2020 2020 2020 696e 7075 745f 7369 7a65        input_size
-00008b40: 202b 3d20 310a 2020 2020 2020 2020 2020   += 1.          
-00008b50: 2020 2020 2020 6966 2073 656c 662e 6f72        if self.or
-00008b60: 6967 696e 616c 5f66 6561 7475 7265 733a  iginal_features:
-00008b70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008b80: 2020 2020 2069 6e70 7574 5f73 697a 6520       input_size 
-00008b90: 2b3d 2073 656c 662e 582e 7368 6170 655b  += self.X.shape[
-00008ba0: 315d 0a20 2020 2020 2020 2020 2020 2020  1].             
-00008bb0: 2020 2069 6620 7365 6c66 2e69 6e74 726f     if self.intro
-00008bc0: 6e5f 7072 6f62 6162 696c 6974 7920 3e20  n_probability > 
-00008bd0: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-00008be0: 2020 2020 2020 2069 6e70 7574 5f73 697a         input_siz
-00008bf0: 6520 3d20 696e 6469 7669 6475 616c 2e70  e = individual.p
-00008c00: 6172 616d 6574 6572 735b 2741 6374 6976  arameters['Activ
-00008c10: 6547 656e 6527 5d2e 7375 6d28 290a 2020  eGene'].sum().  
-00008c20: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00008c30: 2073 656c 662e 6261 7369 635f 7072 696d   self.basic_prim
-00008c40: 6974 6976 6573 203d 3d20 274d 4c27 3a0a  itives == 'ML':.
-00008c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008c60: 2020 2020 696e 7075 745f 7369 7a65 203d      input_size =
-00008c70: 2073 656c 662e 582e 7368 6170 655b 315d   self.X.shape[1]
-00008c80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008c90: 2069 6620 7365 6c66 2e6c 6770 5f6d 6f64   if self.lgp_mod
-00008ca0: 6520 3d3d 2027 5265 6769 7374 6572 273a  e == 'Register':
-00008cb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008cc0: 2020 2020 2069 6e70 7574 5f73 697a 6520       input_size 
-00008cd0: 3d20 7365 6c66 2e6e 756d 6265 725f 6f66  = self.number_of
-00008ce0: 5f72 6567 6973 7465 720a 2020 2020 2020  _register.      
-00008cf0: 2020 2020 2020 2020 2020 6d6f 6465 6c2e            model.
-00008d00: 7072 6564 6963 7428 6e70 2e6f 6e65 7328  predict(np.ones(
-00008d10: 2831 2c20 696e 7075 745f 7369 7a65 2929  (1, input_size))
-00008d20: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00008d30: 2020 7265 7475 726e 204e 6f6e 650a 2020    return None.  
-00008d40: 2020 2020 2020 2020 2020 6578 6365 7074            except
-00008d50: 204e 6f74 4669 7474 6564 4572 726f 723a   NotFittedError:
-00008d60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008d70: 2070 6173 730a 0a20 2020 2020 2020 2023   pass..        #
-00008d80: 2065 6e73 7572 6520 656e 7365 6d62 6c65   ensure ensemble
-00008d90: 2062 6173 6520 6c65 616e 6572 2077 696c   base leaner wil
-00008da0: 6c20 6e6f 7420 6265 2072 6574 7261 696e  l not be retrain
-00008db0: 6564 0a20 2020 2020 2020 2061 7373 6572  ed.        asser
-00008dc0: 7420 7365 6c66 2e62 6173 655f 6c65 6172  t self.base_lear
-00008dd0: 6e65 7220 213d 2027 5261 6e64 6f6d 2d44  ner != 'Random-D
-00008de0: 542d 506c 7573 270a 0a20 2020 2020 2020  T-Plus'..       
-00008df0: 2069 6620 7365 6c66 2e62 6173 655f 6c65   if self.base_le
-00008e00: 6172 6e65 7220 3d3d 2027 4e4e 273a 0a20  arner == 'NN':. 
-00008e10: 2020 2020 2020 2020 2020 206e 6e5f 7072             nn_pr
-00008e20: 6564 6963 7469 6f6e 203d 2067 6574 5f61  ediction = get_a
-00008e30: 6374 6976 6174 696f 6e73 2873 656c 662e  ctivations(self.
-00008e40: 6e65 7572 616c 5f6e 6574 776f 726b 2c20  neural_network, 
-00008e50: 7365 6c66 2e58 295b 2d32 5d0a 2020 2020  self.X)[-2].    
-00008e60: 2020 2020 2020 2020 5970 203d 206e 702e          Yp = np.
-00008e70: 636f 6e63 6174 656e 6174 6528 5b59 702c  concatenate([Yp,
-00008e80: 206e 6e5f 7072 6564 6963 7469 6f6e 5d2c   nn_prediction],
-00008e90: 2061 7869 733d 3129 0a0a 2020 2020 2020   axis=1)..      
-00008ea0: 2020 6966 2068 6173 6174 7472 286d 6f64    if hasattr(mod
-00008eb0: 656c 2c20 2770 6172 7469 7469 6f6e 5f73  el, 'partition_s
-00008ec0: 6368 656d 6527 293a 0a20 2020 2020 2020  cheme'):.       
-00008ed0: 2020 2020 2070 6172 7469 7469 6f6e 5f73       partition_s
-00008ee0: 6368 656d 6520 3d20 6d6f 6465 6c2e 7061  cheme = model.pa
-00008ef0: 7274 6974 696f 6e5f 7363 6865 6d65 0a20  rtition_scheme. 
-00008f00: 2020 2020 2020 2020 2020 2059 7020 3d20             Yp = 
-00008f10: 6e70 2e63 6f6e 6361 7465 6e61 7465 285b  np.concatenate([
-00008f20: 5970 2c20 6e70 2e72 6573 6861 7065 2870  Yp, np.reshape(p
-00008f30: 6172 7469 7469 6f6e 5f73 6368 656d 652c  artition_scheme,
-00008f40: 2028 2d31 2c20 3129 295d 2c20 6178 6973   (-1, 1))], axis
-00008f50: 3d31 290a 0a20 2020 2020 2020 2069 6620  =1)..        if 
-00008f60: 7365 6c66 2e69 6e74 726f 6e5f 7072 6f62  self.intron_prob
-00008f70: 6162 696c 6974 7920 3e20 303a 0a20 2020  ability > 0:.   
-00008f80: 2020 2020 2020 2020 2059 7020 3d20 5970           Yp = Yp
-00008f90: 5b3a 2c20 696e 6469 7669 6475 616c 2e70  [:, individual.p
-00008fa0: 6172 616d 6574 6572 735b 2741 6374 6976  arameters['Activ
-00008fb0: 6547 656e 6527 5d5d 0a0a 2020 2020 2020  eGene']]..      
-00008fc0: 2020 2320 7472 6169 6e20 6669 6e61 6c20    # train final 
-00008fd0: 6d6f 6465 6c0a 2020 2020 2020 2020 6966  model.        if
-00008fe0: 2073 656c 662e 626f 6f74 7374 7261 705f   self.bootstrap_
-00008ff0: 7472 6169 6e69 6e67 2061 6e64 206e 6f74  training and not
-00009000: 2066 6f72 6365 5f74 7261 696e 696e 673a   force_training:
-00009010: 0a20 2020 2020 2020 2020 2020 2073 616d  .            sam
-00009020: 706c 6520 3d20 6e70 2e72 616e 646f 6d2e  ple = np.random.
-00009030: 7261 6e64 696e 7428 302c 206c 656e 2859  randint(0, len(Y
-00009040: 292c 2073 697a 653d 286c 656e 2859 2929  ), size=(len(Y))
-00009050: 290a 0a20 2020 2020 2020 2020 2020 2023  )..            #
-00009060: 2067 6574 206f 7574 2d6f 662d 6261 6720   get out-of-bag 
-00009070: 696e 6469 6365 730a 2020 2020 2020 2020  indices.        
-00009080: 2020 2020 6368 6f73 656e 203d 206e 702e      chosen = np.
-00009090: 7a65 726f 735f 6c69 6b65 2859 290a 2020  zeros_like(Y).  
-000090a0: 2020 2020 2020 2020 2020 6368 6f73 656e            chosen
-000090b0: 5b73 616d 706c 655d 203d 2031 0a20 2020  [sample] = 1.   
-000090c0: 2020 2020 2020 2020 206f 7574 5f6f 665f           out_of_
-000090d0: 6261 6720 3d20 6e70 2e77 6865 7265 2863  bag = np.where(c
-000090e0: 686f 7365 6e20 3d3d 2030 295b 305d 0a20  hosen == 0)[0]. 
-000090f0: 2020 2020 2020 2020 2020 2069 6e64 6976             indiv
-00009100: 6964 7561 6c2e 6f75 745f 6f66 5f62 6167  idual.out_of_bag
-00009110: 203d 206f 7574 5f6f 665f 6261 670a 0a20   = out_of_bag.. 
-00009120: 2020 2020 2020 2020 2020 2023 2063 6f6e             # con
-00009130: 7665 7274 2073 616d 706c 6520 696e 6465  vert sample inde
-00009140: 7820 746f 2077 6569 6768 740a 2020 2020  x to weight.    
-00009150: 2020 2020 2020 2020 6e5f 7361 6d70 6c65          n_sample
-00009160: 7320 3d20 6c65 6e28 5929 0a20 2020 2020  s = len(Y).     
-00009170: 2020 2020 2020 2063 7572 725f 7361 6d70         curr_samp
-00009180: 6c65 5f77 6569 6768 7420 3d20 6e70 2e6f  le_weight = np.o
-00009190: 6e65 7328 286e 5f73 616d 706c 6573 2c29  nes((n_samples,)
-000091a0: 2c20 6474 7970 653d 6e70 2e66 6c6f 6174  , dtype=np.float
-000091b0: 3634 290a 2020 2020 2020 2020 2020 2020  64).            
-000091c0: 7361 6d70 6c65 5f63 6f75 6e74 7320 3d20  sample_counts = 
-000091d0: 6e70 2e62 696e 636f 756e 7428 7361 6d70  np.bincount(samp
-000091e0: 6c65 2c20 6d69 6e6c 656e 6774 683d 6e5f  le, minlength=n_
-000091f0: 7361 6d70 6c65 7329 0a20 2020 2020 2020  samples).       
-00009200: 2020 2020 2063 7572 725f 7361 6d70 6c65       curr_sample
-00009210: 5f77 6569 6768 7420 2a3d 2073 616d 706c  _weight *= sampl
-00009220: 655f 636f 756e 7473 0a0a 2020 2020 2020  e_counts..      
-00009230: 2020 2020 2020 696e 6469 7669 6475 616c        individual
-00009240: 2e70 6970 652e 6669 7428 5970 2c20 592c  .pipe.fit(Yp, Y,
-00009250: 2052 6964 6765 5f5f 7361 6d70 6c65 5f77   Ridge__sample_w
-00009260: 6569 6768 743d 6375 7272 5f73 616d 706c  eight=curr_sampl
-00009270: 655f 7765 6967 6874 290a 2020 2020 2020  e_weight).      
-00009280: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00009290: 2020 2020 696e 6469 7669 6475 616c 2e70      individual.p
-000092a0: 6970 652e 6669 7428 5970 2c20 5929 0a20  ipe.fit(Yp, Y). 
-000092b0: 2020 2020 2020 2020 2020 206f 7574 5f6f             out_o
-000092c0: 665f 6261 6720 3d20 4e6f 6e65 0a0a 2020  f_bag = None..  
-000092d0: 2020 2020 2020 2320 6665 6174 7572 6520        # feature 
-000092e0: 696d 706f 7274 616e 6365 2067 656e 6572  importance gener
-000092f0: 6174 696f 6e0a 2020 2020 2020 2020 6966  ation.        if
-00009300: 206d 6f64 656c 2e73 7465 7073 5b30 5d5b   model.steps[0][
-00009310: 305d 203d 3d20 2766 6561 7475 7265 273a  0] == 'feature':
-00009320: 0a20 2020 2020 2020 2020 2020 2062 6173  .            bas
-00009330: 655f 6d6f 6465 6c20 3d20 6d6f 6465 6c5b  e_model = model[
-00009340: 276d 6f64 656c 275d 5b27 5269 6467 6527  'model']['Ridge'
-00009350: 5d0a 2020 2020 2020 2020 656c 7365 3a0a  ].        else:.
-00009360: 2020 2020 2020 2020 2020 2020 6261 7365              base
-00009370: 5f6d 6f64 656c 203d 206d 6f64 656c 5b27  _model = model['
-00009380: 5269 6467 6527 5d0a 2020 2020 2020 2020  Ridge'].        
-00009390: 6966 2068 6173 6174 7472 2862 6173 655f  if hasattr(base_
-000093a0: 6d6f 6465 6c2c 2027 6665 6174 7572 655f  model, 'feature_
-000093b0: 696d 706f 7274 616e 6365 735f 2729 3a0a  importances_'):.
-000093c0: 2020 2020 2020 2020 2020 2020 696e 6469              indi
-000093d0: 7669 6475 616c 2e63 6f65 6620 3d20 6261  vidual.coef = ba
-000093e0: 7365 5f6d 6f64 656c 2e66 6561 7475 7265  se_model.feature
-000093f0: 5f69 6d70 6f72 7461 6e63 6573 5f5b 3a73  _importances_[:s
-00009400: 656c 662e 6765 6e65 5f6e 756d 5d0a 2020  elf.gene_num].  
-00009410: 2020 2020 2020 656c 6966 2068 6173 6174        elif hasat
-00009420: 7472 2862 6173 655f 6d6f 6465 6c2c 2027  tr(base_model, '
-00009430: 636f 6566 5f27 293a 0a20 2020 2020 2020  coef_'):.       
-00009440: 2020 2020 2069 6e64 6976 6964 7561 6c2e       individual.
-00009450: 636f 6566 203d 206e 702e 6162 7328 6261  coef = np.abs(ba
-00009460: 7365 5f6d 6f64 656c 2e63 6f65 665f 5b3a  se_model.coef_[:
-00009470: 7365 6c66 2e67 656e 655f 6e75 6d5d 292e  self.gene_num]).
-00009480: 666c 6174 7465 6e28 290a 2020 2020 2020  flatten().      
-00009490: 2020 2320 6173 7365 7274 206c 656e 2869    # assert len(i
-000094a0: 6e64 6976 6964 7561 6c2e 636f 6566 2920  ndividual.coef) 
-000094b0: 3d3d 2073 656c 662e 6765 6e65 5f6e 756d  == self.gene_num
-000094c0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000094d0: 6f75 745f 6f66 5f62 6167 0a0a 2020 2020  out_of_bag..    
-000094e0: 6465 6620 656e 7472 6f70 795f 6361 6c63  def entropy_calc
-000094f0: 756c 6174 696f 6e28 7365 6c66 293a 0a20  ulation(self):. 
-00009500: 2020 2020 2020 2070 6173 730a 0a20 2020         pass..   
-00009510: 2064 6566 2067 6574 5f62 6173 655f 6d6f   def get_base_mo
-00009520: 6465 6c28 7365 6c66 2c20 7265 6775 6c61  del(self, regula
-00009530: 7269 7a61 7469 6f6e 5f72 6174 696f 3d31  rization_ratio=1
-00009540: 2c20 6261 7365 5f6d 6f64 656c 3d4e 6f6e  , base_model=Non
-00009550: 652c 206c 6173 736f 5f61 6c70 6861 3d4e  e, lasso_alpha=N
-00009560: 6f6e 6529 3a0a 2020 2020 2020 2020 2320  one):.        # 
-00009570: 4765 7420 7468 6520 6261 7365 206d 6f64  Get the base mod
-00009580: 656c 2062 6173 6564 206f 6e20 7468 6520  el based on the 
-00009590: 6879 7065 7270 6172 616d 6574 6572 0a20  hyperparameter. 
-000095a0: 2020 2020 2020 2069 6620 7365 6c66 2e62         if self.b
-000095b0: 6173 655f 6c65 6172 6e65 7220 696e 205b  ase_learner in [
-000095c0: 2744 5427 2c20 2744 542d 5261 6e64 6f6d  'DT', 'DT-Random
-000095d0: 4454 272c 2027 5043 412d 4454 275d 206f  DT', 'PCA-DT'] o
-000095e0: 7220 5c0a 2020 2020 2020 2020 2020 2020  r \.            
-000095f0: 6261 7365 5f6d 6f64 656c 2069 6e20 5b27  base_model in ['
-00009600: 4454 272c 2027 4454 2d52 616e 646f 6d44  DT', 'DT-RandomD
-00009610: 5427 2c20 2750 4341 2d44 5427 5d3a 0a20  T', 'PCA-DT']:. 
-00009620: 2020 2020 2020 2020 2020 2072 6964 6765             ridge
-00009630: 5f6d 6f64 656c 203d 2044 6563 6973 696f  _model = Decisio
-00009640: 6e54 7265 6552 6567 7265 7373 6f72 286d  nTreeRegressor(m
-00009650: 6178 5f64 6570 7468 3d73 656c 662e 6d61  ax_depth=self.ma
-00009660: 785f 7472 6565 5f64 6570 7468 2c0a 2020  x_tree_depth,.  
-00009670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009690: 2020 2020 2020 2020 2020 2020 2020 6d69                mi
-000096a0: 6e5f 7361 6d70 6c65 735f 6c65 6166 3d73  n_samples_leaf=s
-000096b0: 656c 662e 6d69 6e5f 7361 6d70 6c65 735f  elf.min_samples_
-000096c0: 6c65 6166 290a 2020 2020 2020 2020 656c  leaf).        el
-000096d0: 6966 2073 656c 662e 6261 7365 5f6c 6561  if self.base_lea
-000096e0: 726e 6572 203d 3d20 2753 696d 706c 6544  rner == 'SimpleD
-000096f0: 542d 5261 6e64 6f6d 4454 273a 0a20 2020  T-RandomDT':.   
-00009700: 2020 2020 2020 2020 2072 6964 6765 5f6d           ridge_m
-00009710: 6f64 656c 203d 2044 6563 6973 696f 6e54  odel = DecisionT
-00009720: 7265 6552 6567 7265 7373 6f72 286d 6178  reeRegressor(max
-00009730: 5f64 6570 7468 3d33 290a 2020 2020 2020  _depth=3).      
-00009740: 2020 656c 6966 2073 656c 662e 6261 7365    elif self.base
-00009750: 5f6c 6561 726e 6572 2069 6e20 5b27 5261  _learner in ['Ra
-00009760: 6e64 6f6d 2d44 5427 2c20 2752 616e 646f  ndom-DT', 'Rando
-00009770: 6d44 542d 4454 272c 2027 5261 6e64 6f6d  mDT-DT', 'Random
-00009780: 2d44 542d 506c 7573 275d 206f 7220 5c0a  -DT-Plus'] or \.
-00009790: 2020 2020 2020 2020 2020 2020 6261 7365              base
-000097a0: 5f6d 6f64 656c 2069 6e20 5b27 5261 6e64  _model in ['Rand
-000097b0: 6f6d 2d44 5427 2c20 2752 616e 646f 6d44  om-DT', 'RandomD
-000097c0: 542d 4454 272c 2027 5261 6e64 6f6d 2d44  T-DT', 'Random-D
-000097d0: 542d 506c 7573 275d 3a0a 2020 2020 2020  T-Plus']:.      
-000097e0: 2020 2020 2020 7269 6467 655f 6d6f 6465        ridge_mode
-000097f0: 6c20 3d20 4465 6369 7369 6f6e 5472 6565  l = DecisionTree
-00009800: 5265 6772 6573 736f 7228 7370 6c69 7474  Regressor(splitt
-00009810: 6572 3d27 7261 6e64 6f6d 272c 206d 6178  er='random', max
-00009820: 5f64 6570 7468 3d73 656c 662e 6d61 785f  _depth=self.max_
-00009830: 7472 6565 5f64 6570 7468 2c0a 2020 2020  tree_depth,.    
-00009840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009860: 2020 2020 2020 2020 2020 2020 6d69 6e5f              min_
-00009870: 7361 6d70 6c65 735f 6c65 6166 3d73 656c  samples_leaf=sel
-00009880: 662e 6d69 6e5f 7361 6d70 6c65 735f 6c65  f.min_samples_le
-00009890: 6166 290a 2020 2020 2020 2020 656c 6966  af).        elif
-000098a0: 2073 656c 662e 6261 7365 5f6c 6561 726e   self.base_learn
-000098b0: 6572 203d 3d20 2750 4c2d 5472 6565 273a  er == 'PL-Tree':
-000098c0: 0a20 2020 2020 2020 2020 2020 2072 6964  .            rid
-000098d0: 6765 5f6d 6f64 656c 203d 204c 696e 6561  ge_model = Linea
-000098e0: 7254 7265 6552 6567 7265 7373 6f72 2862  rTreeRegressor(b
-000098f0: 6173 655f 6573 7469 6d61 746f 723d 4c69  ase_estimator=Li
-00009900: 6e65 6172 5265 6772 6573 7369 6f6e 2829  nearRegression()
-00009910: 290a 2020 2020 2020 2020 656c 6966 2073  ).        elif s
-00009920: 656c 662e 6261 7365 5f6c 6561 726e 6572  elf.base_learner
-00009930: 203d 3d20 2752 6964 6765 4356 273a 0a20   == 'RidgeCV':. 
-00009940: 2020 2020 2020 2020 2020 2072 6964 6765             ridge
-00009950: 5f6d 6f64 656c 203d 2052 6964 6765 4356  _model = RidgeCV
-00009960: 2861 6c70 6861 733d 5b30 2e31 2c20 312c  (alphas=[0.1, 1,
-00009970: 2031 305d 2c20 7374 6f72 655f 6376 5f76   10], store_cv_v
-00009980: 616c 7565 733d 5472 7565 2c0a 2020 2020  alues=True,.    
-00009990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000099a0: 2020 2020 2020 2020 2020 2020 2020 7363                sc
-000099b0: 6f72 696e 673d 6d61 6b65 5f73 636f 7265  oring=make_score
-000099c0: 7228 7232 5f73 636f 7265 2929 0a20 2020  r(r2_score)).   
-000099d0: 2020 2020 2065 6c69 6620 7365 6c66 2e62       elif self.b
-000099e0: 6173 655f 6c65 6172 6e65 7220 3d3d 2027  ase_learner == '
-000099f0: 4c52 273a 0a20 2020 2020 2020 2020 2020  LR':.           
-00009a00: 2072 6964 6765 5f6d 6f64 656c 203d 204c   ridge_model = L
-00009a10: 696e 6561 7252 6567 7265 7373 696f 6e28  inearRegression(
-00009a20: 290a 2020 2020 2020 2020 656c 6966 2073  ).        elif s
-00009a30: 656c 662e 6261 7365 5f6c 6561 726e 6572  elf.base_learner
-00009a40: 203d 3d20 274c 6173 736f 273a 0a20 2020   == 'Lasso':.   
-00009a50: 2020 2020 2020 2020 2072 6964 6765 5f6d           ridge_m
-00009a60: 6f64 656c 203d 204c 6173 736f 286c 6173  odel = Lasso(las
-00009a70: 736f 5f61 6c70 6861 2c20 7072 6563 6f6d  so_alpha, precom
-00009a80: 7075 7465 3d54 7275 652c 206d 6178 5f69  pute=True, max_i
-00009a90: 7465 723d 3130 3030 3029 0a20 2020 2020  ter=10000).     
-00009aa0: 2020 2065 6c69 6620 7365 6c66 2e62 6173     elif self.bas
-00009ab0: 655f 6c65 6172 6e65 7220 3d3d 2027 5261  e_learner == 'Ra
-00009ac0: 6e64 6f6d 5765 6967 6874 5269 6467 6527  ndomWeightRidge'
-00009ad0: 3a0a 2020 2020 2020 2020 2020 2020 7269  :.            ri
-00009ae0: 6467 655f 6d6f 6465 6c20 3d20 5261 6e64  dge_model = Rand
-00009af0: 6f6d 5765 6967 6874 5269 6467 6528 290a  omWeightRidge().
-00009b00: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
-00009b10: 662e 6261 7365 5f6c 6561 726e 6572 203d  f.base_learner =
-00009b20: 3d20 2752 6964 6765 2720 6f72 2062 6173  = 'Ridge' or bas
-00009b30: 655f 6d6f 6465 6c20 3d3d 2027 5269 6467  e_model == 'Ridg
-00009b40: 6527 205c 0a20 2020 2020 2020 2020 2020  e' \.           
-00009b50: 206f 7220 2746 6173 742d 536f 6674 2d50   or 'Fast-Soft-P
-00009b60: 4c54 7265 6527 2069 6e20 7365 6c66 2e62  LTree' in self.b
-00009b70: 6173 655f 6c65 6172 6e65 7220 5c0a 2020  ase_learner \.  
-00009b80: 2020 2020 2020 2020 2020 6f72 2073 656c            or sel
-00009b90: 662e 6261 7365 5f6c 6561 726e 6572 2069  f.base_learner i
-00009ba0: 6e20 5b27 4661 7374 2d50 4c54 7265 6527  n ['Fast-PLTree'
-00009bb0: 2c20 2746 6173 742d 5269 6467 6544 5427  , 'Fast-RidgeDT'
-00009bc0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00009bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009be0: 2020 2020 2020 2027 4661 7374 2d53 696d         'Fast-Sim
-00009bf0: 706c 652d 5269 6467 6544 5427 2c20 2746  ple-RidgeDT', 'F
-00009c00: 6173 742d 5269 6467 6544 542d 506c 7573  ast-RidgeDT-Plus
-00009c10: 275d 206f 7220 5c0a 2020 2020 2020 2020  '] or \.        
-00009c20: 2020 2020 7365 6c66 2e62 6173 655f 6c65      self.base_le
-00009c30: 6172 6e65 7220 3d3d 2027 4e4e 273a 0a20  arner == 'NN':. 
-00009c40: 2020 2020 2020 2020 2020 2072 6964 6765             ridge
-00009c50: 5f6d 6f64 656c 203d 2052 6964 6765 2829  _model = Ridge()
-00009c60: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
-00009c70: 6c66 2e62 6173 655f 6c65 6172 6e65 7220  lf.base_learner 
-00009c80: 3d3d 2027 5269 6467 6544 5427 3a0a 2020  == 'RidgeDT':.  
-00009c90: 2020 2020 2020 2020 2020 7269 6467 655f            ridge_
-00009ca0: 6d6f 6465 6c20 3d20 5269 6467 6544 5428  model = RidgeDT(
-00009cb0: 6465 6369 7369 6f6e 5f74 7265 655f 636f  decision_tree_co
-00009cc0: 756e 743d 7365 6c66 2e64 6563 6973 696f  unt=self.decisio
-00009cd0: 6e5f 7472 6565 5f63 6f75 6e74 2c0a 2020  n_tree_count,.  
-00009ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009d00: 6d61 785f 6c65 6166 5f6e 6f64 6573 3d73  max_leaf_nodes=s
-00009d10: 656c 662e 6d61 785f 6c65 6166 5f6e 6f64  elf.max_leaf_nod
-00009d20: 6573 290a 2020 2020 2020 2020 656c 6966  es).        elif
-00009d30: 2073 656c 662e 6261 7365 5f6c 6561 726e   self.base_learn
-00009d40: 6572 203d 3d20 2753 696d 706c 652d 5269  er == 'Simple-Ri
-00009d50: 6467 6544 5427 3a0a 2020 2020 2020 2020  dgeDT':.        
-00009d60: 2020 2020 7269 6467 655f 6d6f 6465 6c20      ridge_model 
-00009d70: 3d20 5269 6467 6544 5450 6c75 7328 6465  = RidgeDTPlus(de
-00009d80: 6369 7369 6f6e 5f74 7265 655f 636f 756e  cision_tree_coun
-00009d90: 743d 302c 0a20 2020 2020 2020 2020 2020  t=0,.           
-00009da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009db0: 2020 2020 2020 2020 2020 206d 6178 5f6c             max_l
-00009dc0: 6561 665f 6e6f 6465 733d 7365 6c66 2e6d  eaf_nodes=self.m
-00009dd0: 6178 5f6c 6561 665f 6e6f 6465 7329 0a20  ax_leaf_nodes). 
-00009de0: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
-00009df0: 2e62 6173 655f 6c65 6172 6e65 7220 3d3d  .base_learner ==
-00009e00: 2027 5269 6467 6544 542d 506c 7573 273a   'RidgeDT-Plus':
-00009e10: 0a20 2020 2020 2020 2020 2020 2072 6964  .            rid
-00009e20: 6765 5f6d 6f64 656c 203d 2052 6964 6765  ge_model = Ridge
-00009e30: 4454 506c 7573 2864 6563 6973 696f 6e5f  DTPlus(decision_
-00009e40: 7472 6565 5f63 6f75 6e74 3d73 656c 662e  tree_count=self.
-00009e50: 6465 6369 7369 6f6e 5f74 7265 655f 636f  decision_tree_co
-00009e60: 756e 742c 0a20 2020 2020 2020 2020 2020  unt,.           
-00009e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009e80: 2020 2020 2020 2020 2020 206d 6178 5f6c             max_l
-00009e90: 6561 665f 6e6f 6465 733d 7365 6c66 2e6d  eaf_nodes=self.m
-00009ea0: 6178 5f6c 6561 665f 6e6f 6465 7329 0a20  ax_leaf_nodes). 
-00009eb0: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
-00009ec0: 2e62 6173 655f 6c65 6172 6e65 7220 3d3d  .base_learner ==
-00009ed0: 2027 4554 273a 0a20 2020 2020 2020 2020   'ET':.         
-00009ee0: 2020 2072 6964 6765 5f6d 6f64 656c 203d     ridge_model =
-00009ef0: 2045 7874 7261 5472 6565 7352 6567 7265   ExtraTreesRegre
-00009f00: 7373 6f72 286e 5f65 7374 696d 6174 6f72  ssor(n_estimator
-00009f10: 733d 3130 3029 0a20 2020 2020 2020 2065  s=100).        e
-00009f20: 6c69 6620 7365 6c66 2e62 6173 655f 6c65  lif self.base_le
-00009f30: 6172 6e65 7220 3d3d 2027 4742 4454 273a  arner == 'GBDT':
-00009f40: 0a20 2020 2020 2020 2020 2020 2072 6964  .            rid
-00009f50: 6765 5f6d 6f64 656c 203d 2047 7261 6469  ge_model = Gradi
-00009f60: 656e 7442 6f6f 7374 696e 6752 6567 7265  entBoostingRegre
-00009f70: 7373 6f72 286c 6561 726e 696e 675f 7261  ssor(learning_ra
-00009f80: 7465 3d30 2e38 2c20 6e5f 6573 7469 6d61  te=0.8, n_estima
-00009f90: 746f 7273 3d35 290a 2020 2020 2020 2020  tors=5).        
-00009fa0: 656c 6966 2073 656c 662e 6261 7365 5f6c  elif self.base_l
-00009fb0: 6561 726e 6572 203d 3d20 274c 6967 6874  earner == 'Light
-00009fc0: 4742 4d27 3a0a 2020 2020 2020 2020 2020  GBM':.          
-00009fd0: 2020 7269 6467 655f 6d6f 6465 6c20 3d20    ridge_model = 
-00009fe0: 4c47 424d 5265 6772 6573 736f 7228 6e5f  LGBMRegressor(n_
-00009ff0: 6573 7469 6d61 746f 7273 3d31 302c 206c  estimators=10, l
-0000a000: 6561 726e 696e 675f 7261 7465 3d31 2c20  earning_rate=1, 
-0000a010: 6e5f 6a6f 6273 3d31 290a 2020 2020 2020  n_jobs=1).      
-0000a020: 2020 656c 6966 2073 656c 662e 6261 7365    elif self.base
-0000a030: 5f6c 6561 726e 6572 203d 3d20 274c 6967  _learner == 'Lig
-0000a040: 6874 4742 4d2d 5374 756d 7027 206f 7220  htGBM-Stump' or 
-0000a050: 6261 7365 5f6d 6f64 656c 203d 3d20 274c  base_model == 'L
-0000a060: 6967 6874 4742 4d2d 5374 756d 7027 3a0a  ightGBM-Stump':.
-0000a070: 2020 2020 2020 2020 2020 2020 7269 6467              ridg
-0000a080: 655f 6d6f 6465 6c20 3d20 4c47 424d 5265  e_model = LGBMRe
-0000a090: 6772 6573 736f 7228 6d61 785f 6465 7074  gressor(max_dept
-0000a0a0: 683d 312c 206c 6561 726e 696e 675f 7261  h=1, learning_ra
-0000a0b0: 7465 3d31 2c0a 2020 2020 2020 2020 2020  te=1,.          
-0000a0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a0d0: 2020 2020 2020 2020 2020 2020 2020 6e5f                n_
-0000a0e0: 6573 7469 6d61 746f 7273 3d6d 6174 682e  estimators=math.
-0000a0f0: 6365 696c 286e 702e 6c6f 6732 2873 656c  ceil(np.log2(sel
-0000a100: 662e 582e 7368 6170 655b 305d 2929 2c0a  f.X.shape[0])),.
-0000a110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a130: 2020 2020 2020 2020 6e5f 6a6f 6273 3d31          n_jobs=1
-0000a140: 290a 2020 2020 2020 2020 656c 6966 2073  ).        elif s
-0000a150: 656c 662e 6261 7365 5f6c 6561 726e 6572  elf.base_learner
-0000a160: 203d 3d20 2748 7962 7269 6427 3a0a 2020   == 'Hybrid':.  
-0000a170: 2020 2020 2020 2020 2020 7269 6467 655f            ridge_
-0000a180: 6d6f 6465 6c20 3d20 6261 7365 5f6d 6f64  model = base_mod
-0000a190: 656c 0a20 2020 2020 2020 2065 6c69 6620  el.        elif 
-0000a1a0: 7365 6c66 2e62 6173 655f 6c65 6172 6e65  self.base_learne
-0000a1b0: 7220 3d3d 2027 5242 4627 3a0a 2020 2020  r == 'RBF':.    
-0000a1c0: 2020 2020 2020 2020 7269 6467 655f 6d6f          ridge_mo
-0000a1d0: 6465 6c20 3d20 5242 464e 286d 696e 2873  del = RBFN(min(s
-0000a1e0: 656c 662e 582e 7368 6170 655b 305d 2c20  elf.X.shape[0], 
-0000a1f0: 3634 2929 0a20 2020 2020 2020 2065 6c69  64)).        eli
-0000a200: 6620 7365 6c66 2e62 6173 655f 6c65 6172  f self.base_lear
-0000a210: 6e65 7220 3d3d 2027 5356 5227 3a0a 2020  ner == 'SVR':.  
-0000a220: 2020 2020 2020 2020 2020 7269 6467 655f            ridge_
-0000a230: 6d6f 6465 6c20 3d20 5356 5228 290a 2020  model = SVR().  
-0000a240: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
-0000a250: 6261 7365 5f6c 6561 726e 6572 203d 3d20  base_learner == 
-0000a260: 274b 4e4e 273a 0a20 2020 2020 2020 2020  'KNN':.         
-0000a270: 2020 2072 6964 6765 5f6d 6f64 656c 203d     ridge_model =
-0000a280: 204b 4e65 6967 6862 6f72 7352 6567 7265   KNeighborsRegre
-0000a290: 7373 6f72 2829 0a20 2020 2020 2020 2065  ssor().        e
-0000a2a0: 6c69 6620 7365 6c66 2e62 6173 655f 6c65  lif self.base_le
-0000a2b0: 6172 6e65 7220 3d3d 2027 4875 6265 7252  arner == 'HuberR
-0000a2c0: 6567 7265 7373 6f72 273a 0a20 2020 2020  egressor':.     
-0000a2d0: 2020 2020 2020 2072 6964 6765 5f6d 6f64         ridge_mod
-0000a2e0: 656c 203d 2048 7562 6572 5265 6772 6573  el = HuberRegres
-0000a2f0: 736f 7228 290a 2020 2020 2020 2020 656c  sor().        el
-0000a300: 6966 2073 656c 662e 6261 7365 5f6c 6561  if self.base_lea
-0000a310: 726e 6572 203d 3d20 2750 4c54 7265 6527  rner == 'PLTree'
-0000a320: 3a0a 2020 2020 2020 2020 2020 2020 6d69  :.            mi
-0000a330: 6e5f 7361 6d70 6c65 735f 6c65 6166 203d  n_samples_leaf =
-0000a340: 2069 6e74 2873 656c 662e 7061 7274 6974   int(self.partit
-0000a350: 696f 6e5f 6e75 6d62 6572 2e73 706c 6974  ion_number.split
-0000a360: 2827 2d27 295b 315d 290a 2020 2020 2020  ('-')[1]).      
-0000a370: 2020 2020 2020 7061 7274 6974 696f 6e5f        partition_
-0000a380: 6e75 6d62 6572 203d 2069 6e74 2873 656c  number = int(sel
-0000a390: 662e 7061 7274 6974 696f 6e5f 6e75 6d62  f.partition_numb
-0000a3a0: 6572 2e73 706c 6974 2827 2d27 295b 325d  er.split('-')[2]
-0000a3b0: 290a 2020 2020 2020 2020 2020 2020 7269  ).            ri
-0000a3c0: 6467 655f 6d6f 6465 6c20 3d20 504c 5472  dge_model = PLTr
-0000a3d0: 6565 5265 6772 6573 736f 7228 6d69 6e5f  eeRegressor(min_
-0000a3e0: 7361 6d70 6c65 735f 6c65 6166 3d6d 696e  samples_leaf=min
-0000a3f0: 5f73 616d 706c 6573 5f6c 6561 662c 0a20  _samples_leaf,. 
-0000a400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a420: 2020 2020 2020 2020 206d 6178 5f6c 6561           max_lea
-0000a430: 665f 6e6f 6465 733d 7061 7274 6974 696f  f_nodes=partitio
-0000a440: 6e5f 6e75 6d62 6572 290a 2020 2020 2020  n_number).      
-0000a450: 2020 656c 6966 2073 656c 662e 6261 7365    elif self.base
-0000a460: 5f6c 6561 726e 6572 203d 3d20 2753 6f66  _learner == 'Sof
-0000a470: 742d 504c 5472 6565 2720 6f72 2073 656c  t-PLTree' or sel
-0000a480: 662e 6261 7365 5f6c 6561 726e 6572 203d  f.base_learner =
-0000a490: 3d20 2753 6f66 742d 504c 5472 6565 2d45  = 'Soft-PLTree-E
-0000a4a0: 4d27 3a0a 2020 2020 2020 2020 2020 2020  M':.            
-0000a4b0: 6966 2073 656c 662e 6261 7365 5f6c 6561  if self.base_lea
-0000a4c0: 726e 6572 203d 3d20 2753 6f66 742d 504c  rner == 'Soft-PL
-0000a4d0: 5472 6565 273a 0a20 2020 2020 2020 2020  Tree':.         
-0000a4e0: 2020 2020 2020 206d 6f64 656c 203d 2053         model = S
-0000a4f0: 6f66 7450 4c54 7265 6552 6567 7265 7373  oftPLTreeRegress
-0000a500: 6f72 0a20 2020 2020 2020 2020 2020 2065  or.            e
-0000a510: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0000a520: 2020 2020 206d 6f64 656c 203d 2053 6f66       model = Sof
-0000a530: 7450 4c54 7265 6552 6567 7265 7373 6f72  tPLTreeRegressor
-0000a540: 454d 0a20 2020 2020 2020 2020 2020 2066  EM.            f
-0000a550: 6561 7475 7265 5f6e 756d 203d 2073 656c  eature_num = sel
-0000a560: 662e 6765 6e65 5f6e 756d 0a20 2020 2020  f.gene_num.     
-0000a570: 2020 2020 2020 2069 6620 7365 6c66 2e6f         if self.o
-0000a580: 7269 6769 6e61 6c5f 6665 6174 7572 6573  riginal_features
-0000a590: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000a5a0: 2020 6665 6174 7572 655f 6e75 6d20 2b3d    feature_num +=
-0000a5b0: 2073 656c 662e 582e 7368 6170 655b 315d   self.X.shape[1]
-0000a5c0: 0a20 2020 2020 2020 2020 2020 2072 6964  .            rid
-0000a5d0: 6765 5f6d 6f64 656c 203d 206d 6f64 656c  ge_model = model
-0000a5e0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000a5f0: 2020 6d69 6e5f 7361 6d70 6c65 735f 6c65    min_samples_le
-0000a600: 6166 3d73 656c 662e 6d69 6e5f 7361 6d70  af=self.min_samp
-0000a610: 6c65 735f 6c65 6166 2c0a 2020 2020 2020  les_leaf,.      
-0000a620: 2020 2020 2020 2020 2020 6d61 785f 6c65            max_le
-0000a630: 6166 5f6e 6f64 6573 3d73 656c 662e 6d61  af_nodes=self.ma
-0000a640: 785f 6c65 6166 5f6e 6f64 6573 2c0a 2020  x_leaf_nodes,.  
-0000a650: 2020 2020 2020 2020 2020 2020 2020 6665                fe
-0000a660: 6174 7572 655f 6e75 6d3d 6665 6174 7572  ature_num=featur
-0000a670: 655f 6e75 6d2c 0a20 2020 2020 2020 2020  e_num,.         
-0000a680: 2020 2020 2020 2067 656e 655f 6e75 6d3d         gene_num=
-0000a690: 7365 6c66 2e67 656e 655f 6e75 6d2c 0a20  self.gene_num,. 
-0000a6a0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-0000a6b0: 6173 655f 6d6f 6465 6c3d 7365 6c66 2e70  ase_model=self.p
-0000a6c0: 735f 7472 6565 5f6c 6f63 616c 5f6d 6f64  s_tree_local_mod
-0000a6d0: 656c 2c0a 2020 2020 2020 2020 2020 2020  el,.            
-0000a6e0: 2020 2020 7061 7274 6974 696f 6e5f 6d6f      partition_mo
-0000a6f0: 6465 6c3d 7365 6c66 2e70 735f 7472 6565  del=self.ps_tree
-0000a700: 5f70 6172 7469 7469 6f6e 5f6d 6f64 656c  _partition_model
-0000a710: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000a720: 2020 7061 7274 6974 696f 6e5f 6e75 6d62    partition_numb
-0000a730: 6572 3d73 656c 662e 7061 7274 6974 696f  er=self.partitio
-0000a740: 6e5f 6e75 6d62 6572 2c0a 2020 2020 2020  n_number,.      
-0000a750: 2020 2020 2020 2020 2020 6f6e 6c79 5f6f            only_o
-0000a760: 7269 6769 6e61 6c5f 6665 6174 7572 6573  riginal_features
-0000a770: 3d73 656c 662e 6f6e 6c79 5f6f 7269 6769  =self.only_origi
-0000a780: 6e61 6c5f 6665 6174 7572 6573 290a 2020  nal_features).  
-0000a790: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
-0000a7a0: 7461 6e63 6528 7365 6c66 2e62 6173 655f  tance(self.base_
-0000a7b0: 6c65 6172 6e65 722c 2052 6567 7265 7373  learner, Regress
-0000a7c0: 6f72 4d69 7869 6e29 3a0a 2020 2020 2020  orMixin):.      
-0000a7d0: 2020 2020 2020 7269 6467 655f 6d6f 6465        ridge_mode
-0000a7e0: 6c20 3d20 7365 6c66 2e62 6173 655f 6c65  l = self.base_le
-0000a7f0: 6172 6e65 720a 2020 2020 2020 2020 656c  arner.        el
-0000a800: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0000a810: 7261 6973 6520 4578 6365 7074 696f 6e0a  raise Exception.
-0000a820: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0000a830: 6261 7365 5f6c 6561 726e 6572 203d 3d20  base_learner == 
-0000a840: 2750 4341 2d44 5427 3a0a 2020 2020 2020  'PCA-DT':.      
-0000a850: 2020 2020 2020 2320 7072 6f6a 6563 7469        # projecti
-0000a860: 6f6e 5f6d 6174 7269 7820 3d20 6e70 2e72  on_matrix = np.r
-0000a870: 616e 646f 6d2e 7261 6e64 6f6d 2828 7365  andom.random((se
-0000a880: 6c66 2e67 656e 655f 6e75 6d2c 2073 656c  lf.gene_num, sel
-0000a890: 662e 6765 6e65 5f6e 756d 2929 0a20 2020  f.gene_num)).   
-0000a8a0: 2020 2020 2020 2020 2023 2072 616e 646f           # rando
-0000a8b0: 6d5f 7072 6f6a 6563 7469 6f6e 203d 2053  m_projection = S
-0000a8c0: 7461 7469 6352 616e 646f 6d50 726f 6a65  taticRandomProje
-0000a8d0: 6374 696f 6e28 7072 6f6a 6563 7469 6f6e  ction(projection
-0000a8e0: 5f6d 6174 7269 7829 0a20 2020 2020 2020  _matrix).       
-0000a8f0: 2020 2020 2070 6970 6520 3d20 5069 7065       pipe = Pipe
-0000a900: 6c69 6e65 285b 0a20 2020 2020 2020 2020  line([.         
-0000a910: 2020 2020 2020 2028 2253 6361 6c65 7222         ("Scaler"
-0000a920: 2c20 5374 616e 6461 7264 5363 616c 6572  , StandardScaler
-0000a930: 2829 292c 0a20 2020 2020 2020 2020 2020  ()),.           
-0000a940: 2020 2020 2028 2252 6f74 6174 696f 6e22       ("Rotation"
-0000a950: 2c20 5043 4128 6e5f 636f 6d70 6f6e 656e  , PCA(n_componen
-0000a960: 7473 3d35 2929 2c0a 2020 2020 2020 2020  ts=5)),.        
-0000a970: 2020 2020 2020 2020 2822 5269 6467 6522          ("Ridge"
-0000a980: 2c20 7269 6467 655f 6d6f 6465 6c29 2c0a  , ridge_model),.
-0000a990: 2020 2020 2020 2020 2020 2020 5d29 0a20              ]). 
-0000a9a0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0000a9b0: 2020 2020 2020 2020 2070 6970 6520 3d20           pipe = 
-0000a9c0: 5069 7065 6c69 6e65 285b 0a20 2020 2020  Pipeline([.     
-0000a9d0: 2020 2020 2020 2020 2020 2028 2253 6361             ("Sca
-0000a9e0: 6c65 7222 2c20 5361 6665 7479 5363 616c  ler", SafetyScal
-0000a9f0: 6572 2829 292c 0a20 2020 2020 2020 2020  er()),.         
-0000aa00: 2020 2020 2020 2028 2252 6964 6765 222c         ("Ridge",
-0000aa10: 2072 6964 6765 5f6d 6f64 656c 292c 0a20   ridge_model),. 
-0000aa20: 2020 2020 2020 2020 2020 205d 290a 2020             ]).  
-0000aa30: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-0000aa40: 6e63 6528 7069 7065 5b27 5269 6467 6527  nce(pipe['Ridge'
-0000aa50: 5d2c 2042 6173 6544 6563 6973 696f 6e54  ], BaseDecisionT
-0000aa60: 7265 6529 2061 6e64 2073 656c 662e 6d61  ree) and self.ma
-0000aa70: 785f 7472 6565 5f64 6570 7468 2021 3d20  x_tree_depth != 
-0000aa80: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0000aa90: 2020 6173 7365 7274 2070 6970 655b 2752    assert pipe['R
-0000aaa0: 6964 6765 275d 2e6d 6178 5f64 6570 7468  idge'].max_depth
-0000aab0: 203d 3d20 7365 6c66 2e6d 6178 5f74 7265   == self.max_tre
-0000aac0: 655f 6465 7074 680a 2020 2020 2020 2020  e_depth.        
-0000aad0: 7265 7475 726e 2070 6970 650a 0a20 2020  return pipe..   
-0000aae0: 2064 6566 2074 7261 6e73 666f 726d 2873   def transform(s
-0000aaf0: 656c 662c 2058 2c20 7261 7469 6f3d 302e  elf, X, ratio=0.
-0000ab00: 3529 3a0a 2020 2020 2020 2020 7261 7469  5):.        rati
-0000ab10: 6f20 3d20 3120 2d20 7261 7469 6f0a 2020  o = 1 - ratio.  
-0000ab20: 2020 2020 2020 6966 2073 656c 662e 6e6f        if self.no
-0000ab30: 726d 616c 697a 653a 0a20 2020 2020 2020  rmalize:.       
-0000ab40: 2020 2020 2058 203d 2073 656c 662e 785f       X = self.x_
-0000ab50: 7363 616c 6572 2e74 7261 6e73 666f 726d  scaler.transform
-0000ab60: 2858 290a 2020 2020 2020 2020 636f 6465  (X).        code
-0000ab70: 5f69 6d70 6f72 7461 6e63 655f 6469 6374  _importance_dict
-0000ab80: 203d 2067 6574 5f66 6561 7475 7265 5f69   = get_feature_i
-0000ab90: 6d70 6f72 7461 6e63 6528 7365 6c66 2c20  mportance(self, 
-0000aba0: 6c61 7465 785f 7665 7273 696f 6e3d 4661  latex_version=Fa
-0000abb0: 6c73 652c 2066 6974 6e65 7373 5f77 6569  lse, fitness_wei
-0000abc0: 6768 7465 643d 4661 6c73 6529 0a20 2020  ghted=False).   
-0000abd0: 2020 2020 2069 6620 7365 6c66 2e65 6e73       if self.ens
-0000abe0: 656d 626c 655f 7369 7a65 203d 3d20 313a  emble_size == 1:
-0000abf0: 0a20 2020 2020 2020 2020 2020 2074 6f70  .            top
-0000ac00: 5f66 6561 7475 7265 7320 3d20 6c69 7374  _features = list
-0000ac10: 2863 6f64 655f 696d 706f 7274 616e 6365  (code_importance
-0000ac20: 5f64 6963 742e 6b65 7973 2829 290a 2020  _dict.keys()).  
-0000ac30: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0000ac40: 2020 2020 2020 2020 746f 705f 6665 6174          top_feat
-0000ac50: 7572 6573 203d 2073 656c 6563 745f 746f  ures = select_to
-0000ac60: 705f 6665 6174 7572 6573 2863 6f64 655f  p_features(code_
-0000ac70: 696d 706f 7274 616e 6365 5f64 6963 742c  importance_dict,
-0000ac80: 2072 6174 696f 290a 2020 2020 2020 2020   ratio).        
-0000ac90: 7472 616e 7366 6f72 6d65 645f 6665 6174  transformed_feat
-0000aca0: 7572 6573 203d 2066 6561 7475 7265 5f61  ures = feature_a
-0000acb0: 7070 656e 6428 7365 6c66 2c20 582c 2074  ppend(self, X, t
-0000acc0: 6f70 5f66 6561 7475 7265 732c 206f 6e6c  op_features, onl
-0000acd0: 795f 6e65 775f 6665 6174 7572 6573 3d54  y_new_features=T
-0000ace0: 7275 6529 0a20 2020 2020 2020 2072 6574  rue).        ret
-0000acf0: 7572 6e20 7472 616e 7366 6f72 6d65 645f  urn transformed_
-0000ad00: 6665 6174 7572 6573 0a0a 2020 2020 6465  features..    de
-0000ad10: 6620 6c61 7a79 5f69 6e69 7428 7365 6c66  f lazy_init(self
-0000ad20: 2c20 7829 3a0a 2020 2020 2020 2020 6966  , x):.        if
-0000ad30: 2073 656c 662e 7365 6d61 6e74 6963 5f72   self.semantic_r
-0000ad40: 6570 6169 7220 3e20 303a 0a20 2020 2020  epair > 0:.     
-0000ad50: 2020 2020 2020 2023 2053 616d 706c 696e         # Samplin
-0000ad60: 6720 736f 6d65 2064 6174 6120 706f 696e  g some data poin
-0000ad70: 7420 666f 7220 7365 6d61 6e74 6963 2072  t for semantic r
-0000ad80: 6570 6169 720a 2020 2020 2020 2020 2020  epair.          
-0000ad90: 2020 6964 203d 206e 702e 7261 6e64 6f6d    id = np.random
-0000ada0: 2e72 616e 6469 6e74 2830 2c20 7365 6c66  .randint(0, self
-0000adb0: 2e58 2e73 6861 7065 5b30 5d2c 2032 3029  .X.shape[0], 20)
-0000adc0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000add0: 662e 7365 6d61 6e74 6963 5f72 6570 6169  f.semantic_repai
-0000ade0: 725f 696e 7075 7420 3d20 7365 6c66 2e58  r_input = self.X
-0000adf0: 5b69 645d 0a20 2020 2020 2020 2020 2020  [id].           
-0000ae00: 2073 656c 662e 7365 6d61 6e74 6963 5f72   self.semantic_r
-0000ae10: 6570 6169 725f 7461 7267 6574 203d 2073  epair_target = s
-0000ae20: 656c 662e 795b 6964 5d0a 2020 2020 2020  elf.y[id].      
-0000ae30: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0000ae40: 2020 2020 7365 6c66 2e73 656d 616e 7469      self.semanti
-0000ae50: 635f 7265 7061 6972 5f69 6e70 7574 203d  c_repair_input =
-0000ae60: 204e 6f6e 650a 0a20 2020 2020 2020 2069   None..        i
-0000ae70: 6620 7365 6c66 2e67 656e 655f 6e75 6d20  f self.gene_num 
-0000ae80: 3d3d 2027 4164 6170 7469 7665 273a 0a20  == 'Adaptive':. 
-0000ae90: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000aea0: 6765 6e65 5f6e 756d 203d 206d 696e 2878  gene_num = min(x
-0000aeb0: 2e73 6861 7065 5b31 5d2c 2032 3029 0a20  .shape[1], 20). 
-0000aec0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0000aed0: 616e 6365 2873 656c 662e 6765 6e65 5f6e  ance(self.gene_n
-0000aee0: 756d 2c20 7374 7229 3a0a 2020 2020 2020  um, str):.      
-0000aef0: 2020 2020 2020 7365 6c66 2e67 656e 655f        self.gene_
-0000af00: 6e75 6d20 3d20 6d69 6e28 696e 7428 7365  num = min(int(se
-0000af10: 6c66 2e67 656e 655f 6e75 6d2e 7265 706c  lf.gene_num.repl
-0000af20: 6163 6528 2758 272c 2027 2729 2920 2a20  ace('X', '')) * 
-0000af30: 7365 6c66 2e58 2e73 6861 7065 5b31 5d2c  self.X.shape[1],
-0000af40: 2033 3029 0a20 2020 2020 2020 2070 7365   30).        pse
-0000af50: 7420 3d20 7365 6c66 2e70 7269 6d69 7469  t = self.primiti
-0000af60: 7665 5f69 6e69 7469 616c 697a 6174 696f  ve_initializatio
-0000af70: 6e28 7829 0a0a 2020 2020 2020 2020 7365  n(x)..        se
-0000af80: 6c66 2e61 7263 6869 7665 5f69 6e69 7469  lf.archive_initi
-0000af90: 616c 697a 6174 696f 6e28 290a 2020 2020  alization().    
-0000afa0: 2020 2020 6966 2073 656c 662e 7472 616e      if self.tran
-0000afb0: 7366 6f72 6d65 725f 7377 6974 6368 3a0a  sformer_switch:.
-0000afc0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000afd0: 2e74 7261 6e73 666f 726d 6572 5f74 6f6f  .transformer_too
-0000afe0: 6c20 3d20 5472 616e 7366 6f72 6d65 7254  l = TransformerT
-0000aff0: 6f6f 6c28 7365 6c66 2e58 2c20 7365 6c66  ool(self.X, self
-0000b000: 2e79 2c20 7365 6c66 2e68 6f66 2c20 7365  .y, self.hof, se
-0000b010: 6c66 2e70 7365 7429 0a0a 2020 2020 2020  lf.pset)..      
-0000b020: 2020 2320 746f 6f6c 626f 7820 696e 6974    # toolbox init
-0000b030: 6961 6c69 7a61 7469 6f6e 0a20 2020 2020  ialization.     
-0000b040: 2020 2074 6f6f 6c62 6f78 203d 2062 6173     toolbox = bas
-0000b050: 652e 546f 6f6c 626f 7828 290a 2020 2020  e.Toolbox().    
-0000b060: 2020 2020 7365 6c66 2e74 6f6f 6c62 6f78      self.toolbox
-0000b070: 203d 2074 6f6f 6c62 6f78 0a20 2020 2020   = toolbox.     
-0000b080: 2020 2069 6620 7365 6c66 2e66 6561 7475     if self.featu
-0000b090: 7265 5f73 656c 6563 7469 6f6e 3a0a 2020  re_selection:.  
-0000b0a0: 2020 2020 2020 2020 2020 7465 726d 696e            termin
-0000b0b0: 616c 5f70 726f 6220 3d20 7365 6c66 2e67  al_prob = self.g
-0000b0c0: 6574 5f74 6572 6d69 6e61 6c5f 7072 6f62  et_terminal_prob
-0000b0d0: 6162 696c 6974 7928 290a 2020 2020 2020  ability().      
-0000b0e0: 2020 2020 2020 746f 6f6c 626f 782e 7265        toolbox.re
-0000b0f0: 6769 7374 6572 2822 6578 7072 222c 2067  gister("expr", g
-0000b100: 656e 4861 6c66 416e 6448 616c 662c 2070  enHalfAndHalf, p
-0000b110: 7365 743d 7073 6574 2c20 6d69 6e5f 3d31  set=pset, min_=1
-0000b120: 2c20 6d61 785f 3d32 2c20 7465 726d 696e  , max_=2, termin
-0000b130: 616c 5f70 726f 623d 7465 726d 696e 616c  al_prob=terminal
-0000b140: 5f70 726f 6229 0a20 2020 2020 2020 2065  _prob).        e
-0000b150: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0000b160: 2023 2067 656e 6572 6174 6520 696e 6974   # generate init
-0000b170: 6961 6c20 706f 7075 6c61 7469 6f6e 0a20  ial population. 
-0000b180: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-0000b190: 6c66 2e69 6e69 7469 616c 5f74 7265 655f  lf.initial_tree_
-0000b1a0: 7369 7a65 2069 7320 4e6f 6e65 3a0a 2020  size is None:.  
-0000b1b0: 2020 2020 2020 2020 2020 2020 2020 746f                to
-0000b1c0: 6f6c 626f 782e 7265 6769 7374 6572 2822  olbox.register("
-0000b1d0: 6578 7072 222c 2067 702e 6765 6e48 616c  expr", gp.genHal
-0000b1e0: 6641 6e64 4861 6c66 2c20 7073 6574 3d70  fAndHalf, pset=p
-0000b1f0: 7365 742c 206d 696e 5f3d 312c 206d 6178  set, min_=1, max
-0000b200: 5f3d 3229 0a20 2020 2020 2020 2020 2020  _=2).           
-0000b210: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0000b220: 2020 2020 2020 206d 696e 5f68 6569 6768         min_heigh
-0000b230: 742c 206d 6178 5f68 6569 6768 7420 3d20  t, max_height = 
-0000b240: 7365 6c66 2e69 6e69 7469 616c 5f74 7265  self.initial_tre
-0000b250: 655f 7369 7a65 2e73 706c 6974 2827 2d27  e_size.split('-'
-0000b260: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0000b270: 2020 6d69 6e5f 6865 6967 6874 203d 2069    min_height = i
-0000b280: 6e74 286d 696e 5f68 6569 6768 7429 0a20  nt(min_height). 
-0000b290: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0000b2a0: 6178 5f68 6569 6768 7420 3d20 696e 7428  ax_height = int(
-0000b2b0: 6d61 785f 6865 6967 6874 290a 2020 2020  max_height).    
-0000b2c0: 2020 2020 2020 2020 2020 2020 746f 6f6c              tool
-0000b2d0: 626f 782e 7265 6769 7374 6572 2822 6578  box.register("ex
-0000b2e0: 7072 222c 2067 702e 6765 6e48 616c 6641  pr", gp.genHalfA
-0000b2f0: 6e64 4861 6c66 2c20 7073 6574 3d70 7365  ndHalf, pset=pse
-0000b300: 742c 206d 696e 5f3d 6d69 6e5f 6865 6967  t, min_=min_heig
-0000b310: 6874 2c20 6d61 785f 3d6d 6178 5f68 6569  ht, max_=max_hei
-0000b320: 6768 7429 0a0a 2020 2020 2020 2020 2320  ght)..        # 
-0000b330: 696e 6469 7669 6475 616c 2069 6e69 7469  individual initi
-0000b340: 616c 697a 6174 696f 6e0a 2020 2020 2020  alization.      
-0000b350: 2020 7061 7274 6974 696f 6e5f 7363 6865    partition_sche
-0000b360: 6d65 203d 2073 656c 662e 7061 7274 6974  me = self.partit
-0000b370: 696f 6e5f 7363 6865 6d65 5f69 6e69 7469  ion_scheme_initi
-0000b380: 616c 697a 6174 696f 6e28 290a 2020 2020  alization().    
-0000b390: 2020 2020 746f 6f6c 626f 782e 7265 6769      toolbox.regi
-0000b3a0: 7374 6572 2822 696e 6469 7669 6475 616c  ster("individual
-0000b3b0: 222c 206d 756c 7469 706c 655f 6765 6e65  ", multiple_gene
-0000b3c0: 5f69 6e69 7469 616c 697a 6174 696f 6e2c  _initialization,
-0000b3d0: 204d 756c 7469 706c 6547 656e 6547 502c   MultipleGeneGP,
-0000b3e0: 2074 6f6f 6c62 6f78 2e65 7870 722c 0a20   toolbox.expr,. 
-0000b3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b400: 2020 2020 2020 2020 6765 6e65 5f6e 756d          gene_num
-0000b410: 3d73 656c 662e 6765 6e65 5f6e 756d 2c20  =self.gene_num, 
-0000b420: 7470 6f74 5f6d 6f64 656c 3d73 656c 662e  tpot_model=self.
-0000b430: 7470 6f74 5f6d 6f64 656c 2c20 7061 7274  tpot_model, part
-0000b440: 6974 696f 6e5f 7363 6865 6d65 3d70 6172  ition_scheme=par
-0000b450: 7469 7469 6f6e 5f73 6368 656d 652c 0a20  tition_scheme,. 
-0000b460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b470: 2020 2020 2020 2020 6261 7365 5f6d 6f64          base_mod
-0000b480: 656c 5f6c 6973 743d 7365 6c66 2e62 6173  el_list=self.bas
-0000b490: 655f 6d6f 6465 6c5f 6c69 7374 2c20 6e75  e_model_list, nu
-0000b4a0: 6d62 6572 5f6f 665f 7265 6769 7374 6572  mber_of_register
-0000b4b0: 3d73 656c 662e 6e75 6d62 6572 5f6f 665f  =self.number_of_
-0000b4c0: 7265 6769 7374 6572 2c0a 2020 2020 2020  register,.      
-0000b4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b4e0: 2020 2061 6374 6976 655f 6765 6e65 5f6e     active_gene_n
-0000b4f0: 756d 3d73 656c 662e 6163 7469 7665 5f67  um=self.active_g
-0000b500: 656e 655f 6e75 6d2c 2069 6e74 726f 6e5f  ene_num, intron_
-0000b510: 7072 6f62 6162 696c 6974 793d 7365 6c66  probability=self
-0000b520: 2e69 6e74 726f 6e5f 7072 6f62 6162 696c  .intron_probabil
-0000b530: 6974 7929 0a20 2020 2020 2020 2074 6f6f  ity).        too
-0000b540: 6c62 6f78 2e72 6567 6973 7465 7228 2270  lbox.register("p
-0000b550: 6f70 756c 6174 696f 6e22 2c20 746f 6f6c  opulation", tool
-0000b560: 732e 696e 6974 5265 7065 6174 2c20 6c69  s.initRepeat, li
-0000b570: 7374 2c20 746f 6f6c 626f 782e 696e 6469  st, toolbox.indi
-0000b580: 7669 6475 616c 290a 2020 2020 2020 2020  vidual).        
-0000b590: 746f 6f6c 626f 782e 7265 6769 7374 6572  toolbox.register
-0000b5a0: 2822 636f 6d70 696c 6522 2c20 6d75 6c74  ("compile", mult
-0000b5b0: 6970 6c65 5f67 656e 655f 636f 6d70 696c  iple_gene_compil
-0000b5c0: 652c 2070 7365 743d 7073 6574 290a 0a20  e, pset=pset).. 
-0000b5d0: 2020 2020 2020 2074 6f6f 6c62 6f78 2e72         toolbox.r
-0000b5e0: 6567 6973 7465 7228 2763 6c6f 6e65 272c  egister('clone',
-0000b5f0: 2065 6666 6963 6965 6e74 5f64 6565 7063   efficient_deepc
-0000b600: 6f70 7929 0a0a 2020 2020 2020 2020 746f  opy)..        to
-0000b610: 6f6c 626f 782e 7265 6769 7374 6572 2822  olbox.register("
-0000b620: 6576 616c 7561 7465 222c 2073 656c 662e  evaluate", self.
-0000b630: 6669 746e 6573 735f 6576 616c 7561 7469  fitness_evaluati
-0000b640: 6f6e 290a 2020 2020 2020 2020 6966 2073  on).        if s
-0000b650: 656c 662e 7365 6c65 6374 203d 3d20 2754  elf.select == 'T
-0000b660: 6f75 726e 616d 656e 7427 3a0a 2020 2020  ournament':.    
-0000b670: 2020 2020 2020 2020 746f 6f6c 626f 782e          toolbox.
-0000b680: 7265 6769 7374 6572 2822 7365 6c65 6374  register("select
-0000b690: 222c 2074 6f6f 6c73 2e73 656c 546f 7572  ", tools.selTour
-0000b6a0: 6e61 6d65 6e74 2c20 746f 7572 6e73 697a  nament, tournsiz
-0000b6b0: 653d 7365 6c66 2e70 6172 616d 5b27 746f  e=self.param['to
-0000b6c0: 7572 6e61 6d65 6e74 5f73 697a 6527 5d29  urnament_size'])
-0000b6d0: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
-0000b6e0: 6c66 2e73 656c 6563 742e 7374 6172 7473  lf.select.starts
-0000b6f0: 7769 7468 2827 546f 7572 6e61 6d65 6e74  with('Tournament
-0000b700: 2d27 293a 0a20 2020 2020 2020 2020 2020  -'):.           
-0000b710: 2074 6f6f 6c62 6f78 2e72 6567 6973 7465   toolbox.registe
-0000b720: 7228 2273 656c 6563 7422 2c20 746f 6f6c  r("select", tool
-0000b730: 732e 7365 6c54 6f75 726e 616d 656e 742c  s.selTournament,
-0000b740: 2074 6f75 726e 7369 7a65 3d69 6e74 2873   tournsize=int(s
-0000b750: 656c 662e 7365 6c65 6374 2e73 706c 6974  elf.select.split
-0000b760: 2827 2d27 295b 315d 2929 0a20 2020 2020  ('-')[1])).     
-0000b770: 2020 2065 6c69 6620 7365 6c66 2e73 656c     elif self.sel
-0000b780: 6563 742e 7374 6172 7473 7769 7468 2827  ect.startswith('
-0000b790: 546f 7572 6e61 6d65 6e74 4e6f 7665 6c74  TournamentNovelt
-0000b7a0: 7927 293a 0a20 2020 2020 2020 2020 2020  y'):.           
-0000b7b0: 2074 6f6f 6c62 6f78 2e72 6567 6973 7465   toolbox.registe
-0000b7c0: 7228 2273 656c 6563 7422 2c20 7365 6c54  r("select", selT
-0000b7d0: 6f75 726e 616d 656e 744e 6f76 656c 7479  ournamentNovelty
-0000b7e0: 2c20 746f 7572 6e73 697a 653d 696e 7428  , tournsize=int(
-0000b7f0: 7365 6c66 2e73 656c 6563 742e 7370 6c69  self.select.spli
-0000b800: 7428 272d 2729 5b31 5d29 290a 2020 2020  t('-')[1])).    
-0000b810: 2020 2020 656c 6966 2073 656c 662e 7365      elif self.se
-0000b820: 6c65 6374 2e73 7461 7274 7377 6974 6828  lect.startswith(
-0000b830: 2754 6f75 726e 616d 656e 7450 6c75 732d  'TournamentPlus-
-0000b840: 2729 3a0a 2020 2020 2020 2020 2020 2020  '):.            
-0000b850: 746f 6f6c 626f 782e 7265 6769 7374 6572  toolbox.register
-0000b860: 2822 7365 6c65 6374 222c 2073 656c 546f  ("select", selTo
-0000b870: 7572 6e61 6d65 6e74 506c 7573 2c20 746f  urnamentPlus, to
-0000b880: 7572 6e73 697a 653d 696e 7428 7365 6c66  urnsize=int(self
-0000b890: 2e73 656c 6563 742e 7370 6c69 7428 272d  .select.split('-
-0000b8a0: 2729 5b31 5d29 290a 2020 2020 2020 2020  ')[1])).        
-0000b8b0: 656c 6966 2073 656c 662e 7365 6c65 6374  elif self.select
-0000b8c0: 203d 3d20 2742 6174 6368 546f 7572 6e61   == 'BatchTourna
-0000b8d0: 6d65 6e74 273a 0a20 2020 2020 2020 2020  ment':.         
-0000b8e0: 2020 2074 6f6f 6c62 6f78 2e72 6567 6973     toolbox.regis
-0000b8f0: 7465 7228 2273 656c 6563 7422 2c20 6261  ter("select", ba
-0000b900: 7463 685f 746f 7572 6e61 6d65 6e74 5f73  tch_tournament_s
-0000b910: 656c 6563 7469 6f6e 290a 2020 2020 2020  election).      
-0000b920: 2020 656c 6966 2073 656c 662e 7365 6c65    elif self.sele
-0000b930: 6374 2069 6e20 5b27 4175 746f 6d61 7469  ct in ['Automati
-0000b940: 634c 6578 6963 6173 6527 5d20 2b20 6d61  cLexicase'] + ma
-0000b950: 705f 656c 6974 655f 7365 7269 6573 3a0a  p_elite_series:.
-0000b960: 2020 2020 2020 2020 2020 2020 746f 6f6c              tool
-0000b970: 626f 782e 7265 6769 7374 6572 2822 7365  box.register("se
-0000b980: 6c65 6374 222c 2073 656c 4175 746f 6d61  lect", selAutoma
-0000b990: 7469 6345 7073 696c 6f6e 4c65 7869 6361  ticEpsilonLexica
-0000b9a0: 7365 4661 7374 290a 2020 2020 2020 2020  seFast).        
-0000b9b0: 656c 6966 2073 656c 662e 7365 6c65 6374  elif self.select
-0000b9c0: 203d 3d20 2741 7574 6f6d 6174 6963 4c65   == 'AutomaticLe
-0000b9d0: 7869 6361 7365 4661 7374 273a 0a20 2020  xicaseFast':.   
-0000b9e0: 2020 2020 2020 2020 2074 6f6f 6c62 6f78           toolbox
-0000b9f0: 2e72 6567 6973 7465 7228 2273 656c 6563  .register("selec
-0000ba00: 7422 2c20 7365 6c41 7574 6f6d 6174 6963  t", selAutomatic
-0000ba10: 4570 7369 6c6f 6e4c 6578 6963 6173 6546  EpsilonLexicaseF
-0000ba20: 6173 7429 0a20 2020 2020 2020 2065 6c69  ast).        eli
-0000ba30: 6620 7365 6c66 2e73 656c 6563 7420 3d3d  f self.select ==
-0000ba40: 2027 446f 7562 6c65 526f 756e 6427 3a0a   'DoubleRound':.
-0000ba50: 2020 2020 2020 2020 2020 2020 746f 6f6c              tool
-0000ba60: 626f 782e 7265 6769 7374 6572 2822 7365  box.register("se
-0000ba70: 6c65 6374 222c 2073 656c 446f 7562 6c65  lect", selDouble
-0000ba80: 526f 756e 6429 0a20 2020 2020 2020 2065  Round).        e
-0000ba90: 6c69 6620 7365 6c66 2e73 656c 6563 7420  lif self.select 
-0000baa0: 3d3d 2027 446f 7562 6c65 526f 756e 642d  == 'DoubleRound-
-0000bab0: 5261 6e64 6f6d 273a 0a20 2020 2020 2020  Random':.       
-0000bac0: 2020 2020 2074 6f6f 6c62 6f78 2e72 6567       toolbox.reg
-0000bad0: 6973 7465 7228 2273 656c 6563 7422 2c20  ister("select", 
-0000bae0: 7365 6c44 6f75 626c 6552 6f75 6e64 2c20  selDoubleRound, 
-0000baf0: 636f 756e 743d 7365 6c66 2e70 6172 616d  count=self.param
-0000bb00: 5b27 646f 7562 6c65 5f72 6f75 6e64 5f63  ['double_round_c
-0000bb10: 6f75 6e74 275d 2c0a 2020 2020 2020 2020  ount'],.        
-0000bb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bb30: 2020 2020 2062 6173 655f 6f70 6572 6174       base_operat
-0000bb40: 6f72 3d27 5261 6e64 6f6d 2729 0a20 2020  or='Random').   
-0000bb50: 2020 2020 2065 6c69 6620 7365 6c66 2e73       elif self.s
-0000bb60: 656c 6563 7420 3d3d 2027 446f 7562 6c65  elect == 'Double
-0000bb70: 526f 756e 642d 546f 7572 6e61 6d65 6e74  Round-Tournament
-0000bb80: 273a 0a20 2020 2020 2020 2020 2020 2074  ':.            t
-0000bb90: 6f6f 6c62 6f78 2e72 6567 6973 7465 7228  oolbox.register(
-0000bba0: 2273 656c 6563 7422 2c20 7365 6c44 6f75  "select", selDou
-0000bbb0: 626c 6552 6f75 6e64 2c20 636f 756e 743d  bleRound, count=
-0000bbc0: 7365 6c66 2e70 6172 616d 5b27 646f 7562  self.param['doub
-0000bbd0: 6c65 5f72 6f75 6e64 5f63 6f75 6e74 275d  le_round_count']
-0000bbe0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000bbf0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-0000bc00: 6173 655f 6f70 6572 6174 6f72 3d27 546f  ase_operator='To
-0000bc10: 7572 6e61 6d65 6e74 272c 0a20 2020 2020  urnament',.     
-0000bc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bc30: 2020 2020 2020 2020 746f 7572 6e73 697a          tournsiz
-0000bc40: 653d 7365 6c66 2e70 6172 616d 5b27 646f  e=self.param['do
-0000bc50: 7562 6c65 5f72 6f75 6e64 5f74 6f75 726e  uble_round_tourn
-0000bc60: 616d 656e 745f 7369 7a65 275d 290a 2020  ament_size']).  
-0000bc70: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
-0000bc80: 7365 6c65 6374 203d 3d20 2750 6172 7369  select == 'Parsi
-0000bc90: 6d6f 6e69 6f75 732d 446f 7562 6c65 526f  monious-DoubleRo
-0000bca0: 756e 642d 546f 7572 6e61 6d65 6e74 273a  und-Tournament':
-0000bcb0: 0a20 2020 2020 2020 2020 2020 2074 6f6f  .            too
-0000bcc0: 6c62 6f78 2e72 6567 6973 7465 7228 2273  lbox.register("s
-0000bcd0: 656c 6563 7422 2c20 7365 6c44 6f75 626c  elect", selDoubl
-0000bce0: 6552 6f75 6e64 2c20 636f 756e 743d 7365  eRound, count=se
-0000bcf0: 6c66 2e70 6172 616d 5b27 646f 7562 6c65  lf.param['double
-0000bd00: 5f72 6f75 6e64 5f63 6f75 6e74 275d 2c0a  _round_count'],.
-0000bd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bd20: 2020 2020 2020 2020 2020 2020 2062 6173               bas
-0000bd30: 655f 6f70 6572 6174 6f72 3d27 546f 7572  e_operator='Tour
-0000bd40: 6e61 6d65 6e74 272c 0a20 2020 2020 2020  nament',.       
-0000bd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bd60: 2020 2020 2020 746f 7572 6e73 697a 653d        tournsize=
-0000bd70: 7365 6c66 2e70 6172 616d 5b27 646f 7562  self.param['doub
-0000bd80: 6c65 5f72 6f75 6e64 5f74 6f75 726e 616d  le_round_tournam
-0000bd90: 656e 745f 7369 7a65 275d 2c0a 2020 2020  ent_size'],.    
-0000bda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bdb0: 2020 2020 2020 2020 2070 6172 7369 6d6f           parsimo
-0000bdc0: 6e69 6f75 733d 5472 7565 290a 2020 2020  nious=True).    
-0000bdd0: 2020 2020 656c 6966 2073 656c 662e 7365      elif self.se
-0000bde0: 6c65 6374 203d 3d20 2752 616e 646f 6d50  lect == 'RandomP
-0000bdf0: 6c75 7327 3a0a 2020 2020 2020 2020 2020  lus':.          
-0000be00: 2020 746f 6f6c 626f 782e 7265 6769 7374    toolbox.regist
-0000be10: 6572 2822 7365 6c65 6374 222c 2073 656c  er("select", sel
-0000be20: 5261 6e64 6f6d 506c 7573 290a 2020 2020  RandomPlus).    
-0000be30: 2020 2020 656c 6966 2073 656c 662e 7365      elif self.se
-0000be40: 6c65 6374 203d 3d20 2742 6167 6769 6e67  lect == 'Bagging
-0000be50: 273a 0a20 2020 2020 2020 2020 2020 2074  ':.            t
-0000be60: 6f6f 6c62 6f78 2e72 6567 6973 7465 7228  oolbox.register(
-0000be70: 2273 656c 6563 7422 2c20 7365 6c42 6167  "select", selBag
-0000be80: 6769 6e67 290a 2020 2020 2020 2020 656c  ging).        el
-0000be90: 6966 2073 656c 662e 7365 6c65 6374 203d  if self.select =
-0000bea0: 3d20 2741 7574 6f6d 6174 6963 4c65 7869  = 'AutomaticLexi
-0000beb0: 6361 7365 4b27 3a0a 2020 2020 2020 2020  caseK':.        
-0000bec0: 2020 2020 746f 6f6c 626f 782e 7265 6769      toolbox.regi
-0000bed0: 7374 6572 2822 7365 6c65 6374 222c 2073  ster("select", s
-0000bee0: 656c 4175 746f 6d61 7469 6345 7073 696c  elAutomaticEpsil
-0000bef0: 6f6e 4c65 7869 6361 7365 4b29 0a20 2020  onLexicaseK).   
-0000bf00: 2020 2020 2065 6c69 6620 7365 6c66 2e73       elif self.s
-0000bf10: 656c 6563 7420 3d3d 2027 4750 4544 273a  elect == 'GPED':
-0000bf20: 0a20 2020 2020 2020 2020 2020 2074 6f6f  .            too
-0000bf30: 6c62 6f78 2e72 6567 6973 7465 7228 2273  lbox.register("s
-0000bf40: 656c 6563 7422 2c20 7365 6c47 5045 4429  elect", selGPED)
-0000bf50: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
-0000bf60: 6c66 2e73 656c 6563 7420 3d3d 2027 4d61  lf.select == 'Ma
-0000bf70: 7841 6e67 6c65 5365 6c65 6374 696f 6e27  xAngleSelection'
-0000bf80: 3a0a 2020 2020 2020 2020 2020 2020 746f  :.            to
-0000bf90: 6f6c 626f 782e 7265 6769 7374 6572 2822  olbox.register("
-0000bfa0: 7365 6c65 6374 222c 2073 656c 4d61 7841  select", selMaxA
-0000bfb0: 6e67 6c65 5365 6c65 6374 696f 6e2c 2074  ngleSelection, t
-0000bfc0: 6172 6765 743d 7365 6c66 2e79 290a 2020  arget=self.y).  
-0000bfd0: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
-0000bfe0: 7365 6c65 6374 203d 3d20 2741 6e67 6c65  select == 'Angle
-0000bff0: 4472 6976 656e 5365 6c65 6374 696f 6e27  DrivenSelection'
-0000c000: 3a0a 2020 2020 2020 2020 2020 2020 746f  :.            to
-0000c010: 6f6c 626f 782e 7265 6769 7374 6572 2822  olbox.register("
-0000c020: 7365 6c65 6374 222c 2073 656c 416e 676c  select", selAngl
-0000c030: 6544 7269 7665 6e53 656c 6563 7469 6f6e  eDrivenSelection
-0000c040: 2c20 7461 7267 6574 3d73 656c 662e 7929  , target=self.y)
-0000c050: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
-0000c060: 6c66 2e73 656c 6563 7420 3d3d 2027 4b6e  lf.select == 'Kn
-0000c070: 6f63 6b6f 7574 273a 0a20 2020 2020 2020  ockout':.       
-0000c080: 2020 2020 2074 6f6f 6c62 6f78 2e72 6567       toolbox.reg
-0000c090: 6973 7465 7228 2273 656c 6563 7422 2c20  ister("select", 
-0000c0a0: 7365 6c4b 6e6f 636b 6f75 7429 0a20 2020  selKnockout).   
-0000c0b0: 2020 2020 2065 6c69 6620 7365 6c66 2e73       elif self.s
-0000c0c0: 656c 6563 7420 3d3d 2027 4b6e 6f63 6b6f  elect == 'Knocko
-0000c0d0: 7574 2d41 273a 0a20 2020 2020 2020 2020  ut-A':.         
-0000c0e0: 2020 2074 6f6f 6c62 6f78 2e72 6567 6973     toolbox.regis
-0000c0f0: 7465 7228 2273 656c 6563 7422 2c20 7365  ter("select", se
-0000c100: 6c4b 6e6f 636b 6f75 742c 2061 7574 6f5f  lKnockout, auto_
-0000c110: 6361 7365 3d54 7275 6529 0a20 2020 2020  case=True).     
-0000c120: 2020 2065 6c69 6620 7365 6c66 2e73 656c     elif self.sel
-0000c130: 6563 7420 3d3d 2027 4b6e 6f63 6b6f 7574  ect == 'Knockout
-0000c140: 2d53 273a 0a20 2020 2020 2020 2020 2020  -S':.           
-0000c150: 2074 6f6f 6c62 6f78 2e72 6567 6973 7465   toolbox.registe
-0000c160: 7228 2273 656c 6563 7422 2c20 7365 6c4b  r("select", selK
-0000c170: 6e6f 636b 6f75 742c 2076 6572 7369 6f6e  nockout, version
-0000c180: 3d27 5327 290a 2020 2020 2020 2020 656c  ='S').        el
-0000c190: 6966 2073 656c 662e 7365 6c65 6374 203d  if self.select =
-0000c1a0: 3d20 274b 6e6f 636b 6f75 742d 5341 273a  = 'Knockout-SA':
-0000c1b0: 0a20 2020 2020 2020 2020 2020 2074 6f6f  .            too
-0000c1c0: 6c62 6f78 2e72 6567 6973 7465 7228 2273  lbox.register("s
-0000c1d0: 656c 6563 7422 2c20 7365 6c4b 6e6f 636b  elect", selKnock
-0000c1e0: 6f75 742c 2076 6572 7369 6f6e 3d27 5327  out, version='S'
-0000c1f0: 2c20 6175 746f 5f63 6173 653d 5472 7565  , auto_case=True
-0000c200: 290a 2020 2020 2020 2020 656c 6966 2073  ).        elif s
-0000c210: 656c 662e 7365 6c65 6374 2069 6e20 5b27  elf.select in ['
-0000c220: 5261 6e64 6f6d 275d 3a0a 2020 2020 2020  Random']:.      
-0000c230: 2020 2020 2020 746f 6f6c 626f 782e 7265        toolbox.re
-0000c240: 6769 7374 6572 2822 7365 6c65 6374 222c  gister("select",
-0000c250: 2073 656c 5261 6e64 6f6d 290a 2020 2020   selRandom).    
-0000c260: 2020 2020 656c 6966 2073 656c 662e 7365      elif self.se
-0000c270: 6c65 6374 203d 3d20 2748 7962 7269 6427  lect == 'Hybrid'
-0000c280: 3a0a 2020 2020 2020 2020 2020 2020 746f  :.            to
-0000c290: 6f6c 626f 782e 7265 6769 7374 6572 2822  olbox.register("
-0000c2a0: 7365 6c65 6374 222c 2073 656c 4879 6272  select", selHybr
-0000c2b0: 6964 290a 2020 2020 2020 2020 656c 7365  id).        else
-0000c2c0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-0000c2d0: 6973 6520 4578 6365 7074 696f 6e0a 0a20  ise Exception.. 
-0000c2e0: 2020 2020 2020 2069 6620 2745 4441 2720         if 'EDA' 
-0000c2f0: 696e 2073 656c 662e 6d75 7461 7469 6f6e  in self.mutation
-0000c300: 5f73 6368 656d 653a 0a20 2020 2020 2020  _scheme:.       
-0000c310: 2020 2020 2061 7373 6572 7420 7365 6c66       assert self
-0000c320: 2e6d 7574 6174 696f 6e5f 7363 6865 6d65  .mutation_scheme
-0000c330: 2069 6e20 6564 615f 6f70 6572 6174 6f72   in eda_operator
-0000c340: 732c 2022 4544 412d 6261 7365 6420 6d75  s, "EDA-based mu
-0000c350: 7461 7469 6f6e 206f 7065 7261 746f 7220  tation operator 
-0000c360: 6d75 7374 2062 6520 6c69 7374 6564 2122  must be listed!"
-0000c370: 0a20 2020 2020 2020 2069 6620 2775 6e69  .        if 'uni
-0000c380: 666f 726d 2720 696e 2073 656c 662e 6d75  form' in self.mu
-0000c390: 7461 7469 6f6e 5f73 6368 656d 6520 6f72  tation_scheme or
-0000c3a0: 2027 6e6f 7665 6c74 7927 2069 6e20 7365   'novelty' in se
-0000c3b0: 6c66 2e6d 7574 6174 696f 6e5f 7363 6865  lf.mutation_sche
-0000c3c0: 6d65 205c 0a20 2020 2020 2020 2020 2020  me \.           
-0000c3d0: 206f 7220 2777 6569 6768 7465 642d 6372   or 'weighted-cr
-0000c3e0: 6f73 7327 2069 6e20 7365 6c66 2e6d 7574  oss' in self.mut
-0000c3f0: 6174 696f 6e5f 7363 6865 6d65 206f 7220  ation_scheme or 
-0000c400: 2761 6c6c 5f67 656e 6527 2069 6e20 7365  'all_gene' in se
-0000c410: 6c66 2e6d 7574 6174 696f 6e5f 7363 6865  lf.mutation_sche
-0000c420: 6d65 205c 0a20 2020 2020 2020 2020 2020  me \.           
-0000c430: 206f 7220 2762 6961 7365 6427 2069 6e20   or 'biased' in 
-0000c440: 7365 6c66 2e6d 7574 6174 696f 6e5f 7363  self.mutation_sc
-0000c450: 6865 6d65 3a0a 2020 2020 2020 2020 2020  heme:.          
-0000c460: 2020 6465 6620 636f 6e76 6572 745f 746f    def convert_to
-0000c470: 5f69 6e74 2873 293a 0a20 2020 2020 2020  _int(s):.       
-0000c480: 2020 2020 2020 2020 2069 6620 732e 7265           if s.re
-0000c490: 706c 6163 6528 272e 272c 2027 2729 2e69  place('.', '').i
-0000c4a0: 7364 6563 696d 616c 2829 3a0a 2020 2020  sdecimal():.    
-0000c4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c4c0: 7265 7475 726e 2066 6c6f 6174 2873 290a  return float(s).
-0000c4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c4e0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0000c4f0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0000c500: 204e 6f6e 650a 0a20 2020 2020 2020 2020   None..         
-0000c510: 2020 2023 2065 7874 7261 6374 206d 7574     # extract mut
-0000c520: 6174 696f 6e20 6f70 6572 6174 6f72 0a20  ation operator. 
-0000c530: 2020 2020 2020 2020 2020 2069 6620 277c             if '|
-0000c540: 2720 696e 2073 656c 662e 6d75 7461 7469  ' in self.mutati
-0000c550: 6f6e 5f73 6368 656d 653a 0a20 2020 2020  on_scheme:.     
-0000c560: 2020 2020 2020 2020 2020 206d 7574 6174             mutat
-0000c570: 696f 6e5f 6f70 6572 6174 6f72 203d 2073  ion_operator = s
-0000c580: 656c 662e 6d75 7461 7469 6f6e 5f73 6368  elf.mutation_sch
-0000c590: 656d 652e 7370 6c69 7428 277c 2729 5b31  eme.split('|')[1
-0000c5a0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0000c5b0: 2020 6372 6f73 736f 7665 725f 6f70 6572    crossover_oper
-0000c5c0: 6174 6f72 203d 2073 656c 662e 6d75 7461  ator = self.muta
-0000c5d0: 7469 6f6e 5f73 6368 656d 652e 7370 6c69  tion_scheme.spli
-0000c5e0: 7428 277c 2729 5b30 5d0a 2020 2020 2020  t('|')[0].      
-0000c5f0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0000c600: 2020 2020 2020 2020 2020 2020 6d75 7461              muta
-0000c610: 7469 6f6e 5f6f 7065 7261 746f 7220 3d20  tion_operator = 
-0000c620: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
-0000c630: 2020 2020 2063 726f 7373 6f76 6572 5f6f       crossover_o
-0000c640: 7065 7261 746f 7220 3d20 7365 6c66 2e6d  perator = self.m
-0000c650: 7574 6174 696f 6e5f 7363 6865 6d65 0a0a  utation_scheme..
-0000c660: 2020 2020 2020 2020 2020 2020 2320 6465              # de
-0000c670: 6369 7369 6f6e 2074 6872 6573 686f 6c64  cision threshold
-0000c680: 2066 6f72 2066 6561 7475 7265 2063 726f   for feature cro
-0000c690: 7373 6f76 6572 2061 6e64 206d 7574 6174  ssover and mutat
-0000c6a0: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
-0000c6b0: 7468 7265 7368 6f6c 645f 7261 7469 6f20  threshold_ratio 
-0000c6c0: 3d20 636f 6e76 6572 745f 746f 5f69 6e74  = convert_to_int
-0000c6d0: 2863 726f 7373 6f76 6572 5f6f 7065 7261  (crossover_opera
-0000c6e0: 746f 722e 7370 6c69 7428 272d 2729 5b2d  tor.split('-')[-
-0000c6f0: 315d 290a 2020 2020 2020 2020 2020 2020  1]).            
-0000c700: 6966 2074 6872 6573 686f 6c64 5f72 6174  if threshold_rat
-0000c710: 696f 2069 7320 4e6f 6e65 3a0a 2020 2020  io is None:.    
-0000c720: 2020 2020 2020 2020 2020 2020 7468 7265              thre
-0000c730: 7368 6f6c 645f 7261 7469 6f20 3d20 302e  shold_ratio = 0.
-0000c740: 320a 2020 2020 2020 2020 2020 2020 656c  2.            el
-0000c750: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0000c760: 2020 2020 6372 6f73 736f 7665 725f 6f70      crossover_op
-0000c770: 6572 6174 6f72 203d 2027 2d27 2e6a 6f69  erator = '-'.joi
-0000c780: 6e28 6372 6f73 736f 7665 725f 6f70 6572  n(crossover_oper
-0000c790: 6174 6f72 2e73 706c 6974 2827 2d27 295b  ator.split('-')[
-0000c7a0: 3a2d 315d 290a 2020 2020 2020 2020 2020  :-1]).          
-0000c7b0: 2020 2320 6361 6c63 756c 6174 6520 7468    # calculate th
-0000c7c0: 6520 7468 7265 7368 6f6c 6420 666f 7220  e threshold for 
-0000c7d0: 6372 6f73 736f 7665 720a 2020 2020 2020  crossover.      
-0000c7e0: 2020 2020 2020 7365 6c66 2e63 785f 7468        self.cx_th
-0000c7f0: 7265 7368 6f6c 645f 7261 7469 6f20 3d20  reshold_ratio = 
-0000c800: 7468 7265 7368 6f6c 645f 7261 7469 6f0a  threshold_ratio.
-0000c810: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000c820: 7365 6c66 2e62 6173 6963 5f70 7269 6d69  self.basic_primi
-0000c830: 7469 7665 7320 3d3d 2046 616c 7365 3a0a  tives == False:.
-0000c840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c850: 746f 6f6c 626f 782e 7265 6769 7374 6572  toolbox.register
-0000c860: 2822 6578 7072 5f6d 7574 222c 2067 702e  ("expr_mut", gp.
-0000c870: 6765 6e46 756c 6c2c 206d 696e 5f3d 312c  genFull, min_=1,
-0000c880: 206d 6178 5f3d 3329 0a20 2020 2020 2020   max_=3).       
-0000c890: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0000c8a0: 2020 2020 2020 2020 2020 2074 6f6f 6c62             toolb
-0000c8b0: 6f78 2e72 6567 6973 7465 7228 2265 7870  ox.register("exp
-0000c8c0: 725f 6d75 7422 2c20 6770 2e67 656e 4675  r_mut", gp.genFu
-0000c8d0: 6c6c 2c20 6d69 6e5f 3d30 2c20 6d61 785f  ll, min_=0, max_
-0000c8e0: 3d32 290a 0a20 2020 2020 2020 2020 2020  =2)..           
-0000c8f0: 2023 2073 7065 6369 616c 2063 726f 7373   # special cross
-0000c900: 6f76 6572 206f 7065 7261 746f 7273 0a20  over operators. 
-0000c910: 2020 2020 2020 2020 2020 2069 6620 2777             if 'w
-0000c920: 6569 6768 7465 642d 6372 6f73 7327 2069  eighted-cross' i
-0000c930: 6e20 6372 6f73 736f 7665 725f 6f70 6572  n crossover_oper
-0000c940: 6174 6f72 3a0a 2020 2020 2020 2020 2020  ator:.          
-0000c950: 2020 2020 2020 2320 6372 6f73 736f 7665        # crossove
-0000c960: 7220 6665 6174 7572 6573 2075 7369 6e67  r features using
-0000c970: 2066 6561 7475 7265 2069 6d70 6f72 7461   feature importa
-0000c980: 6e63 6520 7661 6c75 6520 6173 2074 6865  nce value as the
-0000c990: 2070 726f 6261 6269 6c69 7479 0a20 2020   probability.   
-0000c9a0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0000c9b0: 6372 6f73 736f 7665 725f 6f70 6572 6174  crossover_operat
-0000c9c0: 6f72 203d 3d20 2777 6569 6768 7465 642d  or == 'weighted-
-0000c9d0: 6372 6f73 732d 706f 7369 7469 7665 273a  cross-positive':
-0000c9e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c9f0: 2020 2020 2074 6f6f 6c62 6f78 2e72 6567       toolbox.reg
-0000ca00: 6973 7465 7228 226d 6174 6522 2c20 6665  ister("mate", fe
-0000ca10: 6174 7572 655f 6372 6f73 736f 7665 722c  ature_crossover,
-0000ca20: 2070 6f73 6974 6976 653d 5472 7565 2c20   positive=True, 
-0000ca30: 7468 7265 7368 6f6c 645f 7261 7469 6f3d  threshold_ratio=
-0000ca40: 7468 7265 7368 6f6c 645f 7261 7469 6f29  threshold_ratio)
-0000ca50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ca60: 2065 6c69 6620 6372 6f73 736f 7665 725f   elif crossover_
-0000ca70: 6f70 6572 6174 6f72 203d 3d20 2777 6569  operator == 'wei
-0000ca80: 6768 7465 642d 6372 6f73 732d 6e65 6761  ghted-cross-nega
-0000ca90: 7469 7665 273a 0a20 2020 2020 2020 2020  tive':.         
-0000caa0: 2020 2020 2020 2020 2020 2074 6f6f 6c62             toolb
-0000cab0: 6f78 2e72 6567 6973 7465 7228 226d 6174  ox.register("mat
-0000cac0: 6522 2c20 6665 6174 7572 655f 6372 6f73  e", feature_cros
-0000cad0: 736f 7665 722c 2070 6f73 6974 6976 653d  sover, positive=
-0000cae0: 4661 6c73 652c 2074 6872 6573 686f 6c64  False, threshold
-0000caf0: 5f72 6174 696f 3d74 6872 6573 686f 6c64  _ratio=threshold
-0000cb00: 5f72 6174 696f 290a 2020 2020 2020 2020  _ratio).        
-0000cb10: 2020 2020 2020 2020 656c 6966 2063 726f          elif cro
-0000cb20: 7373 6f76 6572 5f6f 7065 7261 746f 7220  ssover_operator 
-0000cb30: 3d3d 2027 7765 6967 6874 6564 2d63 726f  == 'weighted-cro
-0000cb40: 7373 2d50 4249 4327 3a0a 2020 2020 2020  ss-PBIC':.      
-0000cb50: 2020 2020 2020 2020 2020 2020 2020 746f                to
-0000cb60: 6f6c 626f 782e 7265 6769 7374 6572 2822  olbox.register("
-0000cb70: 6d61 7465 222c 2063 784f 6e65 506f 696e  mate", cxOnePoin
-0000cb80: 745f 616c 6c5f 6765 6e65 5f77 6974 685f  t_all_gene_with_
-0000cb90: 696d 706f 7274 616e 6365 5f70 726f 6261  importance_proba
-0000cba0: 6269 6c69 7479 290a 2020 2020 2020 2020  bility).        
-0000cbb0: 2020 2020 2020 2020 656c 6966 2063 726f          elif cro
-0000cbc0: 7373 6f76 6572 5f6f 7065 7261 746f 7220  ssover_operator 
-0000cbd0: 3d3d 2027 7765 6967 6874 6564 2d63 726f  == 'weighted-cro
-0000cbe0: 7373 2d63 726f 7373 273a 0a20 2020 2020  ss-cross':.     
-0000cbf0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-0000cc00: 6f6f 6c62 6f78 2e72 6567 6973 7465 7228  oolbox.register(
-0000cc10: 226d 6174 6522 2c20 6378 4f6e 6550 6f69  "mate", cxOnePoi
-0000cc20: 6e74 5f6d 756c 7469 706c 655f 6765 6e65  nt_multiple_gene
-0000cc30: 5f63 726f 7373 290a 2020 2020 2020 2020  _cross).        
-0000cc40: 2020 2020 2020 2020 656c 6966 2027 7765          elif 'we
-0000cc50: 6967 6874 6564 2d63 726f 7373 2d74 6872  ighted-cross-thr
-0000cc60: 6573 686f 6c64 2720 696e 2063 726f 7373  eshold' in cross
-0000cc70: 6f76 6572 5f6f 7065 7261 746f 723a 0a20  over_operator:. 
-0000cc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cc90: 2020 2023 2066 6561 7475 7265 2d69 6d70     # feature-imp
-0000cca0: 6f72 7461 6e63 6520 6261 7365 6420 6372  ortance based cr
-0000ccb0: 6f73 736f 7665 720a 2020 2020 2020 2020  ossover.        
-0000ccc0: 2020 2020 2020 2020 2020 2020 7468 7265              thre
-0000ccd0: 7368 6f6c 6420 3d20 4e6f 6e65 0a20 2020  shold = None.   
-0000cce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ccf0: 2069 6620 277e 2720 696e 2063 726f 7373   if '~' in cross
-0000cd00: 6f76 6572 5f6f 7065 7261 746f 723a 0a20  over_operator:. 
-0000cd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cd20: 2020 2020 2020 2023 2070 6172 7365 2074         # parse t
-0000cd30: 6872 6573 686f 6c64 0a20 2020 2020 2020  hreshold.       
-0000cd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cd50: 2073 656c 662e 6d75 7461 7469 6f6e 5f73   self.mutation_s
-0000cd60: 6368 656d 652c 2074 6872 6573 686f 6c64  cheme, threshold
-0000cd70: 203d 2063 726f 7373 6f76 6572 5f6f 7065   = crossover_ope
-0000cd80: 7261 746f 722e 7370 6c69 7428 277e 2729  rator.split('~')
-0000cd90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000cda0: 2020 2020 2020 2020 2074 6872 6573 686f           thresho
-0000cdb0: 6c64 203d 2066 6c6f 6174 2874 6872 6573  ld = float(thres
-0000cdc0: 686f 6c64 290a 2020 2020 2020 2020 2020  hold).          
-0000cdd0: 2020 2020 2020 2020 2020 2020 2020 6372                cr
-0000cde0: 6f73 736f 7665 725f 6f70 6572 6174 6f72  ossover_operator
-0000cdf0: 203d 2073 656c 662e 6d75 7461 7469 6f6e   = self.mutation
-0000ce00: 5f73 6368 656d 650a 2020 2020 2020 2020  _scheme.        
-0000ce10: 2020 2020 2020 2020 2020 2020 6966 2063              if c
-0000ce20: 726f 7373 6f76 6572 5f6f 7065 7261 746f  rossover_operato
-0000ce30: 7220 3d3d 2027 7765 6967 6874 6564 2d63  r == 'weighted-c
-0000ce40: 726f 7373 2d74 6872 6573 686f 6c64 2d45  ross-threshold-E
-0000ce50: 4441 273a 0a20 2020 2020 2020 2020 2020  DA':.           
-0000ce60: 2020 2020 2020 2020 2020 2020 2023 2077               # w
-0000ce70: 6569 6768 7465 6420 6372 6f73 736f 7665  eighted crossove
-0000ce80: 7220 7769 7468 2045 4441 2074 6572 6d69  r with EDA termi
-0000ce90: 6e61 6c73 0a20 2020 2020 2020 2020 2020  nals.           
-0000cea0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000ceb0: 662e 7465 726d 696e 616c 5f70 726f 6220  f.terminal_prob 
-0000cec0: 3d20 6e70 2e6f 6e65 7328 7365 6c66 2e70  = np.ones(self.p
-0000ced0: 7365 742e 7465 726d 735f 636f 756e 7429  set.terms_count)
-0000cee0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000cef0: 2020 2020 2020 2020 2073 656c 662e 7465           self.te
-0000cf00: 726d 696e 616c 5f70 726f 6220 2f3d 206e  rminal_prob /= n
-0000cf10: 702e 7375 6d28 7365 6c66 2e74 6572 6d69  p.sum(self.termi
-0000cf20: 6e61 6c5f 7072 6f62 290a 2020 2020 2020  nal_prob).      
-0000cf30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cf40: 2020 7365 6c66 2e70 7269 6d69 7469 7665    self.primitive
-0000cf50: 5f70 726f 6220 3d20 6e70 2e6f 6e65 7328  _prob = np.ones(
-0000cf60: 7365 6c66 2e70 7365 742e 7072 696d 735f  self.pset.prims_
-0000cf70: 636f 756e 7429 0a20 2020 2020 2020 2020  count).         
-0000cf80: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0000cf90: 656c 662e 7072 696d 6974 6976 655f 7072  elf.primitive_pr
-0000cfa0: 6f62 202f 3d20 6e70 2e73 756d 2873 656c  ob /= np.sum(sel
-0000cfb0: 662e 7072 696d 6974 6976 655f 7072 6f62  f.primitive_prob
-0000cfc0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0000cfd0: 2020 2020 2020 2020 2020 7061 7274 6961            partia
-0000cfe0: 6c5f 6675 6e63 203d 2070 6172 7469 616c  l_func = partial
-0000cff0: 2867 656e 4675 6c6c 5f77 6974 685f 7072  (genFull_with_pr
-0000d000: 6f62 2c20 7072 696d 6974 6976 655f 7072  ob, primitive_pr
-0000d010: 6f62 733d 7365 6c66 2e70 7269 6d69 7469  obs=self.primiti
-0000d020: 7665 5f70 726f 622c 0a20 2020 2020 2020  ve_prob,.       
-0000d030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d050: 2020 2020 2020 2020 7465 726d 696e 616c          terminal
-0000d060: 5f70 726f 6273 3d73 656c 662e 7465 726d  _probs=self.term
-0000d070: 696e 616c 5f70 726f 622c 206d 696e 5f3d  inal_prob, min_=
-0000d080: 302c 206d 6178 5f3d 3229 0a20 2020 2020  0, max_=2).     
-0000d090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d0a0: 2020 206d 7574 6174 696f 6e20 3d20 7061     mutation = pa
-0000d0b0: 7274 6961 6c28 6d75 7455 6e69 666f 726d  rtial(mutUniform
-0000d0c0: 2c20 6578 7072 3d70 6172 7469 616c 5f66  , expr=partial_f
-0000d0d0: 756e 632c 2070 7365 743d 7073 6574 290a  unc, pset=pset).
-0000d0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d0f0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0000d100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d110: 2020 6d75 7461 7469 6f6e 203d 2070 6172    mutation = par
-0000d120: 7469 616c 286d 7574 556e 6966 6f72 6d2c  tial(mutUniform,
-0000d130: 2065 7870 723d 746f 6f6c 626f 782e 6578   expr=toolbox.ex
-0000d140: 7072 5f6d 7574 2c20 7073 6574 3d70 7365  pr_mut, pset=pse
-0000d150: 7429 0a20 2020 2020 2020 2020 2020 2020  t).             
-0000d160: 2020 2020 2020 2023 2072 6570 6c61 6365         # replace
-0000d170: 2061 6c6c 2075 7365 6c65 7373 2066 6561   all useless fea
-0000d180: 7475 7265 7320 7769 7468 2074 6865 2063  tures with the c
-0000d190: 726f 7373 6f76 6572 2072 6573 756c 7473  rossover results
-0000d1a0: 206f 6620 6665 6174 7572 6573 0a20 2020   of features.   
-0000d1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d1c0: 2074 6f6f 6c62 6f78 2e72 6567 6973 7465   toolbox.registe
-0000d1d0: 7228 226d 6174 6522 2c20 6378 4f6e 6550  r("mate", cxOneP
-0000d1e0: 6f69 6e74 5f6d 756c 7469 706c 655f 6765  oint_multiple_ge
-0000d1f0: 6e65 5f74 6872 6573 686f 6c64 2c20 6d75  ne_threshold, mu
-0000d200: 7461 7469 6f6e 3d6d 7574 6174 696f 6e2c  tation=mutation,
-0000d210: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d230: 2020 2020 2020 6372 6f73 735f 7062 3d73        cross_pb=s
-0000d240: 656c 662e 6372 6f73 735f 7062 2c20 7468  elf.cross_pb, th
-0000d250: 7265 7368 6f6c 643d 7468 7265 7368 6f6c  reshold=threshol
-0000d260: 6429 0a20 2020 2020 2020 2020 2020 2020  d).             
-0000d270: 2020 2020 2020 2073 656c 662e 6372 6f73         self.cros
-0000d280: 735f 7062 203d 2031 0a20 2020 2020 2020  s_pb = 1.       
-0000d290: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000d2a0: 662e 6d75 7461 7469 6f6e 5f70 6220 3d20  f.mutation_pb = 
-0000d2b0: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
-0000d2c0: 2020 656c 6966 2063 726f 7373 6f76 6572    elif crossover
-0000d2d0: 5f6f 7065 7261 746f 7220 3d3d 2027 7765  _operator == 'we
-0000d2e0: 6967 6874 6564 2d63 726f 7373 2d62 6573  ighted-cross-bes
-0000d2f0: 7427 3a0a 2020 2020 2020 2020 2020 2020  t':.            
-0000d300: 2020 2020 2020 2020 746f 6f6c 626f 782e          toolbox.
-0000d310: 7265 6769 7374 6572 2822 6d61 7465 222c  register("mate",
-0000d320: 2063 784f 6e65 506f 696e 745f 6d75 6c74   cxOnePoint_mult
-0000d330: 6970 6c65 5f67 656e 655f 6265 7374 290a  iple_gene_best).
-0000d340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d350: 656c 6966 2063 726f 7373 6f76 6572 5f6f  elif crossover_o
-0000d360: 7065 7261 746f 7220 3d3d 2027 7765 6967  perator == 'weig
-0000d370: 6874 6564 2d63 726f 7373 2d77 6f72 7374  hted-cross-worst
-0000d380: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
-0000d390: 2020 2020 2020 2074 6f6f 6c62 6f78 2e72         toolbox.r
-0000d3a0: 6567 6973 7465 7228 226d 6174 6522 2c20  egister("mate", 
-0000d3b0: 6378 4f6e 6550 6f69 6e74 5f6d 756c 7469  cxOnePoint_multi
-0000d3c0: 706c 655f 6765 6e65 5f77 6f72 7374 290a  ple_gene_worst).
-0000d3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d3e0: 656c 6966 2063 726f 7373 6f76 6572 5f6f  elif crossover_o
-0000d3f0: 7065 7261 746f 7220 3d3d 2027 7765 6967  perator == 'weig
-0000d400: 6874 6564 2d63 726f 7373 2d63 726f 7373  hted-cross-cross
-0000d410: 2d67 6c6f 6261 6c2d 6d65 616e 273a 0a20  -global-mean':. 
-0000d420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d430: 2020 2074 6f6f 6c62 6f78 2e72 6567 6973     toolbox.regis
-0000d440: 7465 7228 226d 6174 6522 2c20 6665 6174  ter("mate", feat
-0000d450: 7572 655f 6372 6f73 736f 7665 725f 6372  ure_crossover_cr
-0000d460: 6f73 735f 676c 6f62 616c 2c20 7265 6772  oss_global, regr
-0000d470: 6573 736f 723d 7365 6c66 290a 2020 2020  essor=self).    
-0000d480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d490: 7365 6c66 2e67 6f6f 645f 6665 6174 7572  self.good_featur
-0000d4a0: 6573 5f74 6872 6573 686f 6c64 203d 2027  es_threshold = '
-0000d4b0: 6d65 616e 270a 2020 2020 2020 2020 2020  mean'.          
-0000d4c0: 2020 2020 2020 656c 6966 2063 726f 7373        elif cross
-0000d4d0: 6f76 6572 5f6f 7065 7261 746f 7220 3d3d  over_operator ==
-0000d4e0: 2027 7765 6967 6874 6564 2d63 726f 7373   'weighted-cross
-0000d4f0: 2d63 726f 7373 2d67 6c6f 6261 6c2d 696e  -cross-global-in
-0000d500: 7665 7273 6527 3a0a 2020 2020 2020 2020  verse':.        
-0000d510: 2020 2020 2020 2020 2020 2020 746f 6f6c              tool
-0000d520: 626f 782e 7265 6769 7374 6572 2822 6d61  box.register("ma
-0000d530: 7465 222c 2066 6561 7475 7265 5f63 726f  te", feature_cro
-0000d540: 7373 6f76 6572 5f63 726f 7373 5f67 6c6f  ssover_cross_glo
-0000d550: 6261 6c2c 2072 6567 7265 7373 6f72 3d73  bal, regressor=s
-0000d560: 656c 6629 0a20 2020 2020 2020 2020 2020  elf).           
-0000d570: 2020 2020 2020 2020 2073 656c 662e 676f           self.go
-0000d580: 6f64 5f66 6561 7475 7265 735f 7468 7265  od_features_thre
-0000d590: 7368 6f6c 6420 3d20 3120 2d20 7365 6c66  shold = 1 - self
-0000d5a0: 2e63 785f 7468 7265 7368 6f6c 645f 7261  .cx_threshold_ra
-0000d5b0: 7469 6f0a 2020 2020 2020 2020 2020 2020  tio.            
-0000d5c0: 2020 2020 656c 6966 2063 726f 7373 6f76      elif crossov
-0000d5d0: 6572 5f6f 7065 7261 746f 7220 3d3d 2027  er_operator == '
-0000d5e0: 7765 6967 6874 6564 2d63 726f 7373 2d63  weighted-cross-c
-0000d5f0: 726f 7373 2d67 6c6f 6261 6c27 3a0a 2020  ross-global':.  
-0000d600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d610: 2020 746f 6f6c 626f 782e 7265 6769 7374    toolbox.regist
-0000d620: 6572 2822 6d61 7465 222c 2066 6561 7475  er("mate", featu
-0000d630: 7265 5f63 726f 7373 6f76 6572 5f63 726f  re_crossover_cro
-0000d640: 7373 5f67 6c6f 6261 6c2c 2072 6567 7265  ss_global, regre
-0000d650: 7373 6f72 3d73 656c 6629 0a20 2020 2020  ssor=self).     
-0000d660: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0000d670: 656c 662e 676f 6f64 5f66 6561 7475 7265  elf.good_feature
-0000d680: 735f 7468 7265 7368 6f6c 6420 3d20 7365  s_threshold = se
-0000d690: 6c66 2e63 785f 7468 7265 7368 6f6c 645f  lf.cx_threshold_
-0000d6a0: 7261 7469 6f0a 2020 2020 2020 2020 2020  ratio.          
-0000d6b0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0000d6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d6d0: 7261 6973 6520 4578 6365 7074 696f 6e0a  raise Exception.
-0000d6e0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-0000d6f0: 2063 726f 7373 6f76 6572 5f6f 7065 7261   crossover_opera
-0000d700: 746f 7220 3d3d 2027 616c 6c5f 6765 6e65  tor == 'all_gene
-0000d710: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
-0000d720: 2020 2074 6f6f 6c62 6f78 2e72 6567 6973     toolbox.regis
-0000d730: 7465 7228 226d 6174 6522 2c20 6378 4f6e  ter("mate", cxOn
-0000d740: 6550 6f69 6e74 5f61 6c6c 5f67 656e 6529  ePoint_all_gene)
-0000d750: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-0000d760: 6620 6372 6f73 736f 7665 725f 6f70 6572  f crossover_oper
-0000d770: 6174 6f72 203d 3d20 2761 6c6c 5f67 656e  ator == 'all_gen
-0000d780: 655f 7065 726d 7574 6174 696f 6e27 3a0a  e_permutation':.
-0000d790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d7a0: 746f 6f6c 626f 782e 7265 6769 7374 6572  toolbox.register
-0000d7b0: 2822 6d61 7465 222c 2070 6172 7469 616c  ("mate", partial
-0000d7c0: 2863 784f 6e65 506f 696e 745f 616c 6c5f  (cxOnePoint_all_
-0000d7d0: 6765 6e65 2c20 7065 726d 7574 6174 696f  gene, permutatio
-0000d7e0: 6e3d 5472 7565 2929 0a20 2020 2020 2020  n=True)).       
-0000d7f0: 2020 2020 2065 6c69 6620 6372 6f73 736f       elif crosso
-0000d800: 7665 725f 6f70 6572 6174 6f72 203d 3d20  ver_operator == 
-0000d810: 2762 6961 7365 6427 3a0a 2020 2020 2020  'biased':.      
-0000d820: 2020 2020 2020 2020 2020 746f 6f6c 626f            toolbo
-0000d830: 782e 7265 6769 7374 6572 2822 6d61 7465  x.register("mate
-0000d840: 222c 2063 784f 6e65 506f 696e 745f 6d75  ", cxOnePoint_mu
-0000d850: 6c74 6970 6c65 5f67 656e 655f 6269 6173  ltiple_gene_bias
-0000d860: 6564 290a 2020 2020 2020 2020 2020 2020  ed).            
-0000d870: 656c 6966 2063 726f 7373 6f76 6572 5f6f  elif crossover_o
-0000d880: 7065 7261 746f 7220 3d3d 2027 6e6f 7665  perator == 'nove
-0000d890: 6c74 7927 3a0a 2020 2020 2020 2020 2020  lty':.          
-0000d8a0: 2020 2020 2020 2320 656e 7375 7265 2063        # ensure c
-0000d8b0: 726f 7373 6f76 6572 2072 6573 756c 7473  rossover results
-0000d8c0: 2061 7265 2064 6966 6665 7265 6e74 2066   are different f
-0000d8d0: 726f 6d20 7061 7265 6e74 2069 6e64 6976  rom parent indiv
-0000d8e0: 6964 7561 6c73 0a20 2020 2020 2020 2020  iduals.         
-0000d8f0: 2020 2020 2020 2064 6566 2074 6573 745f         def test_
-0000d900: 6675 6e63 2869 6e64 6976 6964 7561 6c29  func(individual)
-0000d910: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000d920: 2020 2020 2020 6675 6e63 203d 2063 6f6d        func = com
-0000d930: 7069 6c65 2869 6e64 6976 6964 7561 6c2c  pile(individual,
-0000d940: 2070 7365 7429 0a20 2020 2020 2020 2020   pset).         
-0000d950: 2020 2020 2020 2020 2020 2059 7020 3d20             Yp = 
-0000d960: 7265 7375 6c74 5f63 616c 6375 6c61 7469  result_calculati
-0000d970: 6f6e 285b 6675 6e63 5d2c 2073 656c 662e  on([func], self.
-0000d980: 585b 3a32 305d 2c20 7365 6c66 2e6f 7269  X[:20], self.ori
-0000d990: 6769 6e61 6c5f 6665 6174 7572 6573 290a  ginal_features).
-0000d9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d9b0: 2020 2020 7265 7475 726e 2059 702e 666c      return Yp.fl
-0000d9c0: 6174 7465 6e28 290a 0a20 2020 2020 2020  atten()..       
-0000d9d0: 2020 2020 2020 2020 2074 6f6f 6c62 6f78           toolbox
-0000d9e0: 2e72 6567 6973 7465 7228 226d 6174 6522  .register("mate"
-0000d9f0: 2c20 6378 4f6e 6550 6f69 6e74 5f6d 756c  , cxOnePoint_mul
-0000da00: 7469 706c 655f 6765 6e65 5f6e 6f76 656c  tiple_gene_novel
-0000da10: 7479 2c20 7465 7374 5f66 756e 633d 7465  ty, test_func=te
-0000da20: 7374 5f66 756e 6329 0a20 2020 2020 2020  st_func).       
-0000da30: 2020 2020 2065 6c69 6620 6372 6f73 736f       elif crosso
-0000da40: 7665 725f 6f70 6572 6174 6f72 203d 3d20  ver_operator == 
-0000da50: 2775 6e69 666f 726d 2d70 6c75 732d 7365  'uniform-plus-se
-0000da60: 6d61 6e74 6963 273a 0a20 2020 2020 2020  mantic':.       
-0000da70: 2020 2020 2020 2020 2074 6f6f 6c62 6f78           toolbox
-0000da80: 2e72 6567 6973 7465 7228 226d 6174 6522  .register("mate"
-0000da90: 2c20 6378 4f6e 6550 6f69 6e74 5f6d 756c  , cxOnePoint_mul
-0000daa0: 7469 706c 655f 6765 6e65 5f64 6976 6572  tiple_gene_diver
-0000dab0: 7369 7479 2c20 7669 7369 7465 645f 6665  sity, visited_fe
-0000dac0: 6174 7572 6573 3d73 656c 662e 6765 6e65  atures=self.gene
-0000dad0: 7261 7465 645f 6665 6174 7572 6573 290a  rated_features).
-0000dae0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-0000daf0: 2063 726f 7373 6f76 6572 5f6f 7065 7261   crossover_opera
-0000db00: 746f 7220 3d3d 2027 756e 6966 6f72 6d2d  tor == 'uniform-
-0000db10: 706c 7573 2d73 616d 652d 696e 6465 7827  plus-same-index'
-0000db20: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000db30: 2020 746f 6f6c 626f 782e 7265 6769 7374    toolbox.regist
-0000db40: 6572 2822 6d61 7465 222c 2063 784f 6e65  er("mate", cxOne
-0000db50: 506f 696e 745f 6d75 6c74 6970 6c65 5f67  Point_multiple_g
-0000db60: 656e 655f 7361 6d65 5f69 6e64 6578 290a  ene_same_index).
-0000db70: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0000db80: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000db90: 2020 6173 7365 7274 2027 756e 6966 6f72    assert 'unifor
-0000dba0: 6d27 2069 6e20 6372 6f73 736f 7665 725f  m' in crossover_
-0000dbb0: 6f70 6572 6174 6f72 0a20 2020 2020 2020  operator.       
-0000dbc0: 2020 2020 2020 2020 2074 6f6f 6c62 6f78           toolbox
-0000dbd0: 2e72 6567 6973 7465 7228 226d 6174 6522  .register("mate"
-0000dbe0: 2c20 6378 4f6e 6550 6f69 6e74 5f6d 756c  , cxOnePoint_mul
-0000dbf0: 7469 706c 655f 6765 6e65 290a 0a20 2020  tiple_gene)..   
-0000dc00: 2020 2020 2020 2020 2023 2073 7065 6369           # speci
-0000dc10: 616c 206d 7574 6174 696f 6e20 6f70 6572  al mutation oper
-0000dc20: 6174 6f72 730a 2020 2020 2020 2020 2020  ators.          
-0000dc30: 2020 6966 206d 7574 6174 696f 6e5f 6f70    if mutation_op
-0000dc40: 6572 6174 6f72 2069 7320 4e6f 6e65 3a0a  erator is None:.
-0000dc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dc60: 6966 2073 656c 662e 7472 616e 7366 6f72  if self.transfor
-0000dc70: 6d65 725f 7377 6974 6368 3a0a 2020 2020  mer_switch:.    
-0000dc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dc90: 2320 7573 696e 6720 7472 616e 7366 6f72  # using transfor
-0000dca0: 6d65 7220 746f 2067 656e 6572 6174 6520  mer to generate 
-0000dcb0: 7375 622d 7472 6565 730a 2020 2020 2020  sub-trees.      
-0000dcc0: 2020 2020 2020 2020 2020 2020 2020 6465                de
-0000dcd0: 6620 636f 6e64 6974 696f 6e5f 7072 6f62  f condition_prob
-0000dce0: 6162 696c 6974 7928 293a 0a20 2020 2020  ability():.     
-0000dcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dd00: 2020 2072 6574 7572 6e20 7365 6c66 2e63     return self.c
-0000dd10: 7572 7265 6e74 5f67 656e 202f 2073 656c  urrent_gen / sel
-0000dd20: 662e 6e5f 6765 6e0a 0a20 2020 2020 2020  f.n_gen..       
-0000dd30: 2020 2020 2020 2020 2020 2020 2074 6f6f               too
-0000dd40: 6c62 6f78 2e72 6567 6973 7465 7228 226d  lbox.register("m
-0000dd50: 7574 6174 6522 2c20 6d75 7455 6e69 666f  utate", mutUnifo
-0000dd60: 726d 5f6d 756c 7469 706c 655f 6765 6e65  rm_multiple_gene
-0000dd70: 5f74 7261 6e73 666f 726d 6572 2c20 6578  _transformer, ex
-0000dd80: 7072 3d74 6f6f 6c62 6f78 2e65 7870 725f  pr=toolbox.expr_
-0000dd90: 6d75 742c 2070 7365 743d 7073 6574 2c0a  mut, pset=pset,.
-0000dda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ddb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ddc0: 2020 2020 2063 6f6e 6469 7469 6f6e 5f70       condition_p
-0000ddd0: 726f 6261 6269 6c69 7479 3d63 6f6e 6469  robability=condi
-0000dde0: 7469 6f6e 5f70 726f 6261 6269 6c69 7479  tion_probability
-0000ddf0: 2c20 7472 616e 7366 6f72 6d65 723d 7365  , transformer=se
-0000de00: 6c66 2e74 7261 6e73 666f 726d 6572 5f74  lf.transformer_t
-0000de10: 6f6f 6c29 0a20 2020 2020 2020 2020 2020  ool).           
-0000de20: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0000de30: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-0000de40: 6f6f 6c62 6f78 2e72 6567 6973 7465 7228  oolbox.register(
-0000de50: 226d 7574 6174 6522 2c20 6d75 7455 6e69  "mutate", mutUni
-0000de60: 666f 726d 5f6d 756c 7469 706c 655f 6765  form_multiple_ge
-0000de70: 6e65 2c20 6578 7072 3d74 6f6f 6c62 6f78  ne, expr=toolbox
-0000de80: 2e65 7870 725f 6d75 742c 2070 7365 743d  .expr_mut, pset=
-0000de90: 7073 6574 290a 2020 2020 2020 2020 2020  pset).          
-0000dea0: 2020 656c 6966 206d 7574 6174 696f 6e5f    elif mutation_
-0000deb0: 6f70 6572 6174 6f72 203d 3d20 2777 6f72  operator == 'wor
-0000dec0: 7374 273a 0a20 2020 2020 2020 2020 2020  st':.           
-0000ded0: 2020 2020 2074 6f6f 6c62 6f78 2e72 6567       toolbox.reg
-0000dee0: 6973 7465 7228 226d 7574 6174 6522 2c20  ister("mutate", 
-0000def0: 6d75 7455 6e69 666f 726d 5f6d 756c 7469  mutUniform_multi
-0000df00: 706c 655f 6765 6e65 5f77 6f72 7374 2c20  ple_gene_worst, 
-0000df10: 6578 7072 3d74 6f6f 6c62 6f78 2e65 7870  expr=toolbox.exp
-0000df20: 725f 6d75 742c 2070 7365 743d 7073 6574  r_mut, pset=pset
-0000df30: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
-0000df40: 6966 206d 7574 6174 696f 6e5f 6f70 6572  if mutation_oper
-0000df50: 6174 6f72 203d 3d20 2774 6872 6573 686f  ator == 'thresho
-0000df60: 6c64 273a 0a20 2020 2020 2020 2020 2020  ld':.           
-0000df70: 2020 2020 2074 6f6f 6c62 6f78 2e72 6567       toolbox.reg
-0000df80: 6973 7465 7228 226d 7574 6174 6522 2c20  ister("mutate", 
-0000df90: 6d75 7455 6e69 666f 726d 5f6d 756c 7469  mutUniform_multi
-0000dfa0: 706c 655f 6765 6e65 5f74 6872 6573 686f  ple_gene_thresho
-0000dfb0: 6c64 2c20 6578 7072 3d74 6f6f 6c62 6f78  ld, expr=toolbox
-0000dfc0: 2e65 7870 725f 6d75 742c 2070 7365 743d  .expr_mut, pset=
-0000dfd0: 7073 6574 290a 2020 2020 2020 2020 2020  pset).          
-0000dfe0: 2020 656c 6966 206d 7574 6174 696f 6e5f    elif mutation_
-0000dff0: 6f70 6572 6174 6f72 203d 3d20 2777 6569  operator == 'wei
-0000e000: 6768 7465 642d 6d75 7461 7469 6f6e 273a  ghted-mutation':
-0000e010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e020: 2074 6f6f 6c62 6f78 2e72 6567 6973 7465   toolbox.registe
-0000e030: 7228 226d 7574 6174 6522 2c20 6d75 7457  r("mutate", mutW
-0000e040: 6569 6768 745f 6d75 6c74 6970 6c65 5f67  eight_multiple_g
-0000e050: 656e 652c 2065 7870 723d 746f 6f6c 626f  ene, expr=toolbo
-0000e060: 782e 6578 7072 5f6d 7574 2c20 7073 6574  x.expr_mut, pset
-0000e070: 3d70 7365 7429 0a20 2020 2020 2020 2020  =pset).         
-0000e080: 2020 2065 6c69 6620 6d75 7461 7469 6f6e     elif mutation
-0000e090: 5f6f 7065 7261 746f 7220 3d3d 2027 706f  _operator == 'po
-0000e0a0: 6f6c 2d6d 7574 6174 696f 6e27 3a0a 2020  ol-mutation':.  
-0000e0b0: 2020 2020 2020 2020 2020 2020 2020 746f                to
-0000e0c0: 6f6c 626f 782e 7265 6769 7374 6572 2822  olbox.register("
-0000e0d0: 6d75 7461 7465 222c 2070 6f6f 6c5f 6261  mutate", pool_ba
-0000e0e0: 7365 645f 6d75 7461 7469 6f6e 2c20 6578  sed_mutation, ex
-0000e0f0: 7072 3d74 6f6f 6c62 6f78 2e65 7870 725f  pr=toolbox.expr_
-0000e100: 6d75 742c 2070 7365 743d 7073 6574 2c0a  mut, pset=pset,.
-0000e110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e130: 2072 6567 7265 7373 6f72 3d73 656c 6629   regressor=self)
-0000e140: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e150: 2023 2074 6872 6573 686f 6c64 2066 6f72   # threshold for
-0000e160: 2067 6f6f 6420 6665 6174 7572 6573 0a20   good features. 
-0000e170: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0000e180: 656c 662e 676f 6f64 5f66 6561 7475 7265  elf.good_feature
-0000e190: 735f 7468 7265 7368 6f6c 6420 3d20 3120  s_threshold = 1 
-0000e1a0: 2d20 7365 6c66 2e63 785f 7468 7265 7368  - self.cx_thresh
-0000e1b0: 6f6c 645f 7261 7469 6f0a 2020 2020 2020  old_ratio.      
-0000e1c0: 2020 2020 2020 656c 6966 2027 706f 6f6c        elif 'pool
-0000e1d0: 2d6d 7574 6174 696f 6e2d 746f 7572 6e61  -mutation-tourna
-0000e1e0: 6d65 6e74 2720 696e 206d 7574 6174 696f  ment' in mutatio
-0000e1f0: 6e5f 6f70 6572 6174 6f72 3a0a 2020 2020  n_operator:.    
-0000e200: 2020 2020 2020 2020 2020 2020 746f 7572              tour
-0000e210: 6e61 6d65 6e74 5f73 697a 6520 3d20 696e  nament_size = in
-0000e220: 7428 6d75 7461 7469 6f6e 5f6f 7065 7261  t(mutation_opera
-0000e230: 746f 722e 7370 6c69 7428 272d 2729 5b2d  tor.split('-')[-
-0000e240: 315d 290a 2020 2020 2020 2020 2020 2020  1]).            
-0000e250: 2020 2020 746f 6f6c 626f 782e 7265 6769      toolbox.regi
-0000e260: 7374 6572 2822 6d75 7461 7465 222c 2070  ster("mutate", p
-0000e270: 6f6f 6c5f 6261 7365 645f 6d75 7461 7469  ool_based_mutati
-0000e280: 6f6e 2c20 6578 7072 3d74 6f6f 6c62 6f78  on, expr=toolbox
-0000e290: 2e65 7870 725f 6d75 742c 2070 7365 743d  .expr_mut, pset=
-0000e2a0: 7073 6574 2c0a 2020 2020 2020 2020 2020  pset,.          
-0000e2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e2c0: 2020 2020 2020 2072 6567 7265 7373 6f72         regressor
-0000e2d0: 3d73 656c 662c 2074 6f75 726e 616d 656e  =self, tournamen
-0000e2e0: 745f 7369 7a65 3d74 6f75 726e 616d 656e  t_size=tournamen
-0000e2f0: 745f 7369 7a65 290a 2020 2020 2020 2020  t_size).        
-0000e300: 2020 2020 2020 2020 7365 6c66 2e67 6f6f          self.goo
-0000e310: 645f 6665 6174 7572 6573 5f74 6872 6573  d_features_thres
-0000e320: 686f 6c64 203d 2073 656c 662e 6378 5f74  hold = self.cx_t
-0000e330: 6872 6573 686f 6c64 5f72 6174 696f 0a20  hreshold_ratio. 
-0000e340: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-0000e350: 6d75 7461 7469 6f6e 5f6f 7065 7261 746f  mutation_operato
-0000e360: 7220 3d3d 2027 706f 6f6c 2d6d 7574 6174  r == 'pool-mutat
-0000e370: 696f 6e2d 7065 6172 736f 6e27 3a0a 2020  ion-pearson':.  
-0000e380: 2020 2020 2020 2020 2020 2020 2020 746f                to
-0000e390: 6f6c 626f 782e 7265 6769 7374 6572 2822  olbox.register("
-0000e3a0: 6d75 7461 7465 222c 2070 6f6f 6c5f 6261  mutate", pool_ba
-0000e3b0: 7365 645f 6d75 7461 7469 6f6e 2c20 6578  sed_mutation, ex
-0000e3c0: 7072 3d74 6f6f 6c62 6f78 2e65 7870 725f  pr=toolbox.expr_
-0000e3d0: 6d75 742c 2070 7365 743d 7073 6574 2c0a  mut, pset=pset,.
-0000e3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e400: 2072 6567 7265 7373 6f72 3d73 656c 662c   regressor=self,
-0000e410: 2070 6561 7273 6f6e 5f73 656c 6563 7469   pearson_selecti
-0000e420: 6f6e 3d54 7275 6529 0a20 2020 2020 2020  on=True).       
-0000e430: 2020 2020 2020 2020 2073 656c 662e 676f           self.go
-0000e440: 6f64 5f66 6561 7475 7265 735f 7468 7265  od_features_thre
-0000e450: 7368 6f6c 6420 3d20 7365 6c66 2e63 785f  shold = self.cx_
-0000e460: 7468 7265 7368 6f6c 645f 7261 7469 6f0a  threshold_ratio.
-0000e470: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-0000e480: 206d 7574 6174 696f 6e5f 6f70 6572 6174   mutation_operat
-0000e490: 6f72 203d 3d20 2770 6f6f 6c2d 6d75 7461  or == 'pool-muta
-0000e4a0: 7469 6f6e 2d73 656d 616e 7469 6327 3a0a  tion-semantic':.
-0000e4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e4c0: 746f 6f6c 626f 782e 7265 6769 7374 6572  toolbox.register
-0000e4d0: 2822 6d75 7461 7465 222c 2070 6f6f 6c5f  ("mutate", pool_
-0000e4e0: 6261 7365 645f 6d75 7461 7469 6f6e 2c20  based_mutation, 
-0000e4f0: 6578 7072 3d74 6f6f 6c62 6f78 2e65 7870  expr=toolbox.exp
-0000e500: 725f 6d75 742c 2070 7365 743d 7073 6574  r_mut, pset=pset
-0000e510: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000e520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e530: 2020 2072 6567 7265 7373 6f72 3d73 656c     regressor=sel
-0000e540: 662c 2066 6561 7475 7265 5f65 7661 6c75  f, feature_evalu
-0000e550: 6174 696f 6e3d 7365 6c66 2e66 6561 7475  ation=self.featu
-0000e560: 7265 5f71 7569 636b 5f65 7661 6c75 6174  re_quick_evaluat
-0000e570: 696f 6e29 0a20 2020 2020 2020 2020 2020  ion).           
-0000e580: 2020 2020 2073 656c 662e 676f 6f64 5f66       self.good_f
-0000e590: 6561 7475 7265 735f 7468 7265 7368 6f6c  eatures_threshol
-0000e5a0: 6420 3d20 7365 6c66 2e63 785f 7468 7265  d = self.cx_thre
-0000e5b0: 7368 6f6c 645f 7261 7469 6f0a 2020 2020  shold_ratio.    
-0000e5c0: 2020 2020 2020 2020 656c 6966 206d 7574          elif mut
-0000e5d0: 6174 696f 6e5f 6f70 6572 6174 6f72 203d  ation_operator =
-0000e5e0: 3d20 2777 6569 6768 7465 642d 6d75 7461  = 'weighted-muta
-0000e5f0: 7469 6f6e 2d67 6c6f 6261 6c27 3a0a 2020  tion-global':.  
-0000e600: 2020 2020 2020 2020 2020 2020 2020 746f                to
-0000e610: 6f6c 626f 782e 7265 6769 7374 6572 2822  olbox.register("
-0000e620: 6d75 7461 7465 222c 2066 6561 7475 7265  mutate", feature
-0000e630: 5f6d 7574 6174 696f 6e5f 676c 6f62 616c  _mutation_global
-0000e640: 2c20 6578 7072 3d74 6f6f 6c62 6f78 2e65  , expr=toolbox.e
-0000e650: 7870 725f 6d75 742c 2070 7365 743d 7073  xpr_mut, pset=ps
-0000e660: 6574 2c0a 2020 2020 2020 2020 2020 2020  et,.            
-0000e670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e680: 2020 2020 2072 6567 7265 7373 6f72 3d73       regressor=s
-0000e690: 656c 6629 0a20 2020 2020 2020 2020 2020  elf).           
-0000e6a0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0000e6b0: 2020 2020 2020 2072 6169 7365 2045 7863         raise Exc
-0000e6c0: 6570 7469 6f6e 0a20 2020 2020 2020 2065  eption.        e
-0000e6d0: 6c69 6620 7365 6c66 2e6d 7574 6174 696f  lif self.mutatio
-0000e6e0: 6e5f 7363 6865 6d65 203d 3d20 2777 6569  n_scheme == 'wei
-0000e6f0: 6768 7465 6427 3a0a 2020 2020 2020 2020  ghted':.        
-0000e700: 2020 2020 746f 6f6c 626f 782e 7265 6769      toolbox.regi
-0000e710: 7374 6572 2822 6d61 7465 222c 2063 784f  ster("mate", cxO
-0000e720: 6e65 506f 696e 745f 6d75 6c74 6970 6c65  nePoint_multiple
-0000e730: 5f67 656e 655f 7765 6967 6874 6564 290a  _gene_weighted).
-0000e740: 2020 2020 2020 2020 2020 2020 746f 6f6c              tool
-0000e750: 626f 782e 7265 6769 7374 6572 2822 6578  box.register("ex
-0000e760: 7072 5f6d 7574 222c 2067 702e 6765 6e46  pr_mut", gp.genF
-0000e770: 756c 6c2c 206d 696e 5f3d 302c 206d 6178  ull, min_=0, max
-0000e780: 5f3d 3229 0a20 2020 2020 2020 2020 2020  _=2).           
-0000e790: 2074 6f6f 6c62 6f78 2e72 6567 6973 7465   toolbox.registe
-0000e7a0: 7228 226d 7574 6174 6522 2c20 6d75 7455  r("mutate", mutU
-0000e7b0: 6e69 666f 726d 5f6d 756c 7469 706c 655f  niform_multiple_
-0000e7c0: 6765 6e65 5f77 6569 6768 7465 642c 2065  gene_weighted, e
-0000e7d0: 7870 723d 746f 6f6c 626f 782e 6578 7072  xpr=toolbox.expr
-0000e7e0: 5f6d 7574 2c20 7073 6574 3d70 7365 7429  _mut, pset=pset)
-0000e7f0: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
-0000e800: 6c66 2e6d 7574 6174 696f 6e5f 7363 6865  lf.mutation_sche
-0000e810: 6d65 2069 6e20 6564 615f 6f70 6572 6174  me in eda_operat
-0000e820: 6f72 733a 0a20 2020 2020 2020 2020 2020  ors:.           
-0000e830: 2023 2044 6566 696e 6520 7468 6520 6372   # Define the cr
-0000e840: 6f73 736f 7665 7220 6f70 6572 6174 6f72  ossover operator
-0000e850: 2063 6f6d 6269 6e65 6420 7468 6520 4544   combined the ED
-0000e860: 4120 6f70 6572 6174 6f72 0a20 2020 2020  A operator.     
-0000e870: 2020 2020 2020 2069 6620 2742 6961 7365         if 'Biase
-0000e880: 6427 2069 6e20 7365 6c66 2e6d 7574 6174  d' in self.mutat
-0000e890: 696f 6e5f 7363 6865 6d65 3a0a 2020 2020  ion_scheme:.    
-0000e8a0: 2020 2020 2020 2020 2020 2020 746f 6f6c              tool
-0000e8b0: 626f 782e 7265 6769 7374 6572 2822 6d61  box.register("ma
-0000e8c0: 7465 222c 2063 784f 6e65 506f 696e 745f  te", cxOnePoint_
-0000e8d0: 6d75 6c74 6970 6c65 5f67 656e 655f 6269  multiple_gene_bi
-0000e8e0: 6173 6564 290a 2020 2020 2020 2020 2020  ased).          
-0000e8f0: 2020 656c 6966 2027 5361 6d65 5765 6967    elif 'SameWeig
-0000e900: 6874 2720 696e 2073 656c 662e 6d75 7461  ht' in self.muta
-0000e910: 7469 6f6e 5f73 6368 656d 653a 0a20 2020  tion_scheme:.   
-0000e920: 2020 2020 2020 2020 2020 2020 2074 6f6f               too
-0000e930: 6c62 6f78 2e72 6567 6973 7465 7228 226d  lbox.register("m
-0000e940: 6174 6522 2c20 6378 4f6e 6550 6f69 6e74  ate", cxOnePoint
-0000e950: 5f6d 756c 7469 706c 655f 6765 6e65 5f73  _multiple_gene_s
-0000e960: 616d 655f 7765 6967 6874 290a 2020 2020  ame_weight).    
-0000e970: 2020 2020 2020 2020 656c 6966 2027 546f          elif 'To
-0000e980: 7572 6e61 6d65 6e74 2720 696e 2073 656c  urnament' in sel
-0000e990: 662e 6d75 7461 7469 6f6e 5f73 6368 656d  f.mutation_schem
-0000e9a0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0000e9b0: 2020 2074 6f6f 6c62 6f78 2e72 6567 6973     toolbox.regis
-0000e9c0: 7465 7228 226d 6174 6522 2c20 6378 4f6e  ter("mate", cxOn
-0000e9d0: 6550 6f69 6e74 5f6d 756c 7469 706c 655f  ePoint_multiple_
-0000e9e0: 6765 6e65 5f74 6f75 726e 616d 656e 7429  gene_tournament)
-0000e9f0: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-0000ea00: 6620 7365 6c66 2e6d 7574 6174 696f 6e5f  f self.mutation_
-0000ea10: 7363 6865 6d65 2e65 6e64 7377 6974 6828  scheme.endswith(
-0000ea20: 272d 5343 2729 3a0a 2020 2020 2020 2020  '-SC'):.        
-0000ea30: 2020 2020 2020 2020 746f 6f6c 626f 782e          toolbox.
-0000ea40: 7265 6769 7374 6572 2822 6d61 7465 222c  register("mate",
-0000ea50: 2063 784f 6e65 506f 696e 745f 6d75 6c74   cxOnePoint_mult
-0000ea60: 6970 6c65 5f67 656e 655f 5343 290a 2020  iple_gene_SC).  
-0000ea70: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
-0000ea80: 656c 662e 6d75 7461 7469 6f6e 5f73 6368  elf.mutation_sch
-0000ea90: 656d 652e 656e 6473 7769 7468 2827 2d53  eme.endswith('-S
-0000eaa0: 432d 5753 2729 3a0a 2020 2020 2020 2020  C-WS'):.        
-0000eab0: 2020 2020 2020 2020 746f 6f6c 626f 782e          toolbox.
-0000eac0: 7265 6769 7374 6572 2822 6d61 7465 222c  register("mate",
-0000ead0: 2070 6172 7469 616c 2863 784f 6e65 506f   partial(cxOnePo
-0000eae0: 696e 745f 6d75 6c74 6970 6c65 5f67 656e  int_multiple_gen
-0000eaf0: 655f 5343 2c20 7465 6d70 6572 6174 7572  e_SC, temperatur
-0000eb00: 653d 3029 290a 2020 2020 2020 2020 2020  e=0)).          
-0000eb10: 2020 656c 6966 2073 656c 662e 6d75 7461    elif self.muta
-0000eb20: 7469 6f6e 5f73 6368 656d 652e 656e 6473  tion_scheme.ends
-0000eb30: 7769 7468 2827 2d53 432d 4e54 2729 3a0a  with('-SC-NT'):.
-0000eb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eb50: 746f 6f6c 626f 782e 7265 6769 7374 6572  toolbox.register
-0000eb60: 2822 6d61 7465 222c 2070 6172 7469 616c  ("mate", partial
-0000eb70: 2863 784f 6e65 506f 696e 745f 6d75 6c74  (cxOnePoint_mult
-0000eb80: 6970 6c65 5f67 656e 655f 5343 2c20 7465  iple_gene_SC, te
-0000eb90: 6d70 6572 6174 7572 653d 3129 290a 2020  mperature=1)).  
-0000eba0: 2020 2020 2020 2020 2020 656c 6966 2027            elif '
-0000ebb0: 5361 6d65 496e 6465 7827 2069 6e20 7365  SameIndex' in se
-0000ebc0: 6c66 2e6d 7574 6174 696f 6e5f 7363 6865  lf.mutation_sche
-0000ebd0: 6d65 3a0a 2020 2020 2020 2020 2020 2020  me:.            
-0000ebe0: 2020 2020 746f 6f6c 626f 782e 7265 6769      toolbox.regi
-0000ebf0: 7374 6572 2822 6d61 7465 222c 2063 784f  ster("mate", cxO
-0000ec00: 6e65 506f 696e 745f 6d75 6c74 6970 6c65  nePoint_multiple
-0000ec10: 5f67 656e 655f 7361 6d65 5f69 6e64 6578  _gene_same_index
-0000ec20: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
+00000000: 696d 706f 7274 2067 630a 6672 6f6d 2063  import gc.from c
+00000010: 6f6c 6c65 6374 696f 6e73 2069 6d70 6f72  ollections impor
+00000020: 7420 436f 756e 7465 720a 6672 6f6d 206d  t Counter.from m
+00000030: 756c 7469 7072 6f63 6573 7369 6e67 2069  ultiprocessing i
+00000040: 6d70 6f72 7420 506f 6f6c 0a66 726f 6d20  mport Pool.from 
+00000050: 7479 7069 6e67 2069 6d70 6f72 7420 556e  typing import Un
+00000060: 696f 6e0a 0a69 6d70 6f72 7420 6469 6c6c  ion..import dill
+00000070: 0a66 726f 6d20 6465 6170 2069 6d70 6f72  .from deap impor
+00000080: 7420 6770 0a66 726f 6d20 6465 6170 2069  t gp.from deap i
+00000090: 6d70 6f72 7420 746f 6f6c 730a 6672 6f6d  mport tools.from
+000000a0: 2064 6561 702e 616c 676f 7269 7468 6d73   deap.algorithms
+000000b0: 2069 6d70 6f72 7420 7661 7241 6e64 0a66   import varAnd.f
+000000c0: 726f 6d20 6465 6170 2e62 6173 6520 696d  rom deap.base im
+000000d0: 706f 7274 2054 6f6f 6c62 6f78 0a66 726f  port Toolbox.fro
+000000e0: 6d20 6465 6170 2e74 6f6f 6c73 2069 6d70  m deap.tools imp
+000000f0: 6f72 7420 7365 6c4e 5347 4132 2c20 4869  ort selNSGA2, Hi
+00000100: 7374 6f72 792c 2073 656c 4265 7374 2c20  story, selBest, 
+00000110: 6378 5477 6f50 6f69 6e74 2c20 6d75 7446  cxTwoPoint, mutF
+00000120: 6c69 7042 6974 2c20 7365 6c44 6f75 626c  lipBit, selDoubl
+00000130: 6554 6f75 726e 616d 656e 742c 2073 6f72  eTournament, sor
+00000140: 744e 6f6e 646f 6d69 6e61 7465 642c 205c  tNondominated, \
+00000150: 0a20 2020 2073 656c 5350 4541 320a 6672  .    selSPEA2.fr
+00000160: 6f6d 2067 706c 6561 726e 2e66 756e 6374  om gplearn.funct
+00000170: 696f 6e73 2069 6d70 6f72 7420 5f70 726f  ions import _pro
+00000180: 7465 6374 6564 5f73 7172 740a 6672 6f6d  tected_sqrt.from
+00000190: 206c 6967 6874 6762 6d20 696d 706f 7274   lightgbm import
+000001a0: 204c 4742 4d43 6c61 7373 6966 6965 722c   LGBMClassifier,
+000001b0: 204c 4742 4d52 6567 7265 7373 6f72 2c20   LGBMRegressor, 
+000001c0: 4c47 424d 4d6f 6465 6c0a 6672 6f6d 206c  LGBMModel.from l
+000001d0: 696e 6561 7274 7265 6520 696d 706f 7274  ineartree import
+000001e0: 204c 696e 6561 7254 7265 6552 6567 7265   LinearTreeRegre
+000001f0: 7373 6f72 0a66 726f 6d20 6e75 6d70 792e  ssor.from numpy.
+00000200: 6c69 6e61 6c67 2069 6d70 6f72 7420 6e6f  linalg import no
+00000210: 726d 0a66 726f 6d20 7363 6970 7920 696d  rm.from scipy im
+00000220: 706f 7274 2073 7461 7473 0a66 726f 6d20  port stats.from 
+00000230: 7363 6970 792e 7370 6174 6961 6c2e 6469  scipy.spatial.di
+00000240: 7374 616e 6365 2069 6d70 6f72 7420 636f  stance import co
+00000250: 7369 6e65 0a66 726f 6d20 7363 6970 792e  sine.from scipy.
+00000260: 7374 6174 7320 696d 706f 7274 2073 7065  stats import spe
+00000270: 6172 6d61 6e72 2c20 6b65 6e64 616c 6c74  armanr, kendallt
+00000280: 6175 2c20 7261 6e6b 6461 7461 2c20 7261  au, rankdata, ra
+00000290: 6e6b 7375 6d73 0a66 726f 6d20 736b 6c65  nksums.from skle
+000002a0: 6172 6e2e 6261 7365 2069 6d70 6f72 7420  arn.base import 
+000002b0: 5265 6772 6573 736f 724d 6978 696e 2c20  RegressorMixin, 
+000002c0: 4261 7365 4573 7469 6d61 746f 722c 2043  BaseEstimator, C
+000002d0: 6c61 7373 6966 6965 724d 6978 696e 2c20  lassifierMixin, 
+000002e0: 5472 616e 7366 6f72 6d65 724d 6978 696e  TransformerMixin
+000002f0: 0a66 726f 6d20 736b 6c65 6172 6e2e 636c  .from sklearn.cl
+00000300: 7573 7465 7220 696d 706f 7274 204b 4d65  uster import KMe
+00000310: 616e 730a 6672 6f6d 2073 6b6c 6561 726e  ans.from sklearn
+00000320: 2e63 6f6d 706f 7365 2e74 6573 7473 2e74  .compose.tests.t
+00000330: 6573 745f 7461 7267 6574 2069 6d70 6f72  est_target impor
+00000340: 7420 4475 6d6d 7954 7261 6e73 666f 726d  t DummyTransform
+00000350: 6572 0a66 726f 6d20 736b 6c65 6172 6e2e  er.from sklearn.
+00000360: 6465 636f 6d70 6f73 6974 696f 6e20 696d  decomposition im
+00000370: 706f 7274 2050 4341 0a66 726f 6d20 736b  port PCA.from sk
+00000380: 6c65 6172 6e2e 656e 7365 6d62 6c65 2069  learn.ensemble i
+00000390: 6d70 6f72 7420 4578 7472 6154 7265 6573  mport ExtraTrees
+000003a0: 5265 6772 6573 736f 722c 2047 7261 6469  Regressor, Gradi
+000003b0: 656e 7442 6f6f 7374 696e 6752 6567 7265  entBoostingRegre
+000003c0: 7373 6f72 2c20 5261 6e64 6f6d 466f 7265  ssor, RandomFore
+000003d0: 7374 436c 6173 7369 6669 6572 2c20 5c0a  stClassifier, \.
+000003e0: 2020 2020 5261 6e64 6f6d 466f 7265 7374      RandomForest
+000003f0: 5265 6772 6573 736f 720a 6672 6f6d 2073  Regressor.from s
+00000400: 6b6c 6561 726e 2e65 7863 6570 7469 6f6e  klearn.exception
+00000410: 7320 696d 706f 7274 204e 6f74 4669 7474  s import NotFitt
+00000420: 6564 4572 726f 720a 6672 6f6d 2073 6b6c  edError.from skl
+00000430: 6561 726e 2e6c 696e 6561 725f 6d6f 6465  earn.linear_mode
+00000440: 6c20 696d 706f 7274 2052 6964 6765 2c20  l import Ridge, 
+00000450: 4c6f 6769 7374 6963 5265 6772 6573 7369  LogisticRegressi
+00000460: 6f6e 2c20 4c6f 6769 7374 6963 5265 6772  on, LogisticRegr
+00000470: 6573 7369 6f6e 4356 2c20 4875 6265 7252  essionCV, HuberR
+00000480: 6567 7265 7373 6f72 2c20 5c0a 2020 2020  egressor, \.    
+00000490: 4c61 7373 6f2c 204c 6173 736f 4356 2c20  Lasso, LassoCV, 
+000004a0: 456c 6173 7469 634e 6574 4356 0a66 726f  ElasticNetCV.fro
+000004b0: 6d20 736b 6c65 6172 6e2e 6c69 6e65 6172  m sklearn.linear
+000004c0: 5f6d 6f64 656c 2e5f 6261 7365 2069 6d70  _model._base imp
+000004d0: 6f72 7420 4c69 6e65 6172 4d6f 6465 6c2c  ort LinearModel,
+000004e0: 204c 696e 6561 7243 6c61 7373 6966 6965   LinearClassifie
+000004f0: 724d 6978 696e 0a66 726f 6d20 736b 6c65  rMixin.from skle
+00000500: 6172 6e2e 6d65 7472 6963 7320 696d 706f  arn.metrics impo
+00000510: 7274 202a 0a66 726f 6d20 736b 6c65 6172  rt *.from sklear
+00000520: 6e2e 6d65 7472 6963 732e 7061 6972 7769  n.metrics.pairwi
+00000530: 7365 2069 6d70 6f72 7420 636f 7369 6e65  se import cosine
+00000540: 5f73 696d 696c 6172 6974 790a 6672 6f6d  _similarity.from
+00000550: 2073 6b6c 6561 726e 2e6d 6f64 656c 5f73   sklearn.model_s
+00000560: 656c 6563 7469 6f6e 2069 6d70 6f72 7420  election import 
+00000570: 6372 6f73 735f 7661 6c5f 7363 6f72 652c  cross_val_score,
+00000580: 2050 6172 616d 6574 6572 4772 6964 2c20   ParameterGrid, 
+00000590: 7472 6169 6e5f 7465 7374 5f73 706c 6974  train_test_split
+000005a0: 0a66 726f 6d20 736b 6c65 6172 6e2e 6e65  .from sklearn.ne
+000005b0: 6967 6862 6f72 7320 696d 706f 7274 204b  ighbors import K
+000005c0: 4e65 6967 6862 6f72 7352 6567 7265 7373  NeighborsRegress
+000005d0: 6f72 2c20 4b44 5472 6565 0a66 726f 6d20  or, KDTree.from 
+000005e0: 736b 6c65 6172 6e2e 6e65 7572 616c 5f6e  sklearn.neural_n
+000005f0: 6574 776f 726b 2069 6d70 6f72 7420 4d4c  etwork import ML
+00000600: 5052 6567 7265 7373 6f72 0a66 726f 6d20  PRegressor.from 
+00000610: 736b 6c65 6172 6e2e 7072 6570 726f 6365  sklearn.preproce
+00000620: 7373 696e 6720 696d 706f 7274 204d 696e  ssing import Min
+00000630: 4d61 7853 6361 6c65 720a 6672 6f6d 2073  MaxScaler.from s
+00000640: 6b6c 6561 726e 2e73 766d 2069 6d70 6f72  klearn.svm impor
+00000650: 7420 5356 520a 6672 6f6d 2073 6b6c 6561  t SVR.from sklea
+00000660: 726e 2e74 7265 6520 696d 706f 7274 2044  rn.tree import D
+00000670: 6563 6973 696f 6e54 7265 6543 6c61 7373  ecisionTreeClass
+00000680: 6966 6965 722c 2042 6173 6544 6563 6973  ifier, BaseDecis
+00000690: 696f 6e54 7265 650a 6672 6f6d 2073 6b6c  ionTree.from skl
+000006a0: 6561 726e 2e75 7469 6c73 2069 6d70 6f72  earn.utils impor
+000006b0: 7420 636f 6d70 7574 655f 7361 6d70 6c65  t compute_sample
+000006c0: 5f77 6569 6768 740a 6672 6f6d 2073 6b6c  _weight.from skl
+000006d0: 6561 726e 3270 6d6d 6c2e 656e 7365 6d62  earn2pmml.ensemb
+000006e0: 6c65 2069 6d70 6f72 7420 4742 4454 4c52  le import GBDTLR
+000006f0: 436c 6173 7369 6669 6572 0a66 726f 6d20  Classifier.from 
+00000700: 7379 6d70 7920 696d 706f 7274 2070 6172  sympy import par
+00000710: 7365 5f65 7870 720a 6672 6f6d 2074 706f  se_expr.from tpo
+00000720: 7420 696d 706f 7274 2054 504f 5443 6c61  t import TPOTCla
+00000730: 7373 6966 6965 722c 2054 504f 5452 6567  ssifier, TPOTReg
+00000740: 7265 7373 6f72 0a0a 6672 6f6d 2065 766f  ressor..from evo
+00000750: 6c75 7469 6f6e 6172 795f 666f 7265 7374  lutionary_forest
+00000760: 2e63 6f6d 706f 6e65 6e74 2e61 7263 6869  .component.archi
+00000770: 7665 2069 6d70 6f72 7420 2a0a 6672 6f6d  ve import *.from
+00000780: 2065 766f 6c75 7469 6f6e 6172 795f 666f   evolutionary_fo
+00000790: 7265 7374 2e63 6f6d 706f 6e65 6e74 2e61  rest.component.a
+000007a0: 7263 6869 7665 2069 6d70 6f72 7420 4452  rchive import DR
+000007b0: 4550 4861 6c6c 4f66 4661 6d65 2c20 4e6f  EPHallOfFame, No
+000007c0: 7665 6c74 7948 616c 6c4f 6646 616d 652c  veltyHallOfFame,
+000007d0: 204f 4f42 4861 6c6c 4f66 4661 6d65 2c20   OOBHallOfFame, 
+000007e0: 426f 6f74 7374 7261 7048 616c 6c4f 6646  BootstrapHallOfF
+000007f0: 616d 650a 6672 6f6d 2065 766f 6c75 7469  ame.from evoluti
+00000800: 6f6e 6172 795f 666f 7265 7374 2e63 6f6d  onary_forest.com
+00000810: 706f 6e65 6e74 2e63 6f6e 6669 6775 7261  ponent.configura
+00000820: 7469 6f6e 2069 6d70 6f72 7420 4372 6f73  tion import Cros
+00000830: 736f 7665 724d 6f64 652c 2041 7263 6869  soverMode, Archi
+00000840: 7665 436f 6e66 6967 7572 6174 696f 6e2c  veConfiguration,
+00000850: 2049 6d62 616c 616e 6365 6443 6f6e 6669   ImbalancedConfi
+00000860: 6775 7261 7469 6f6e 2c20 5c0a 2020 2020  guration, \.    
+00000870: 4576 616c 7561 7469 6f6e 436f 6e66 6967  EvaluationConfig
+00000880: 7572 6174 696f 6e2c 2063 6865 636b 5f73  uration, check_s
+00000890: 656d 616e 7469 635f 6261 7365 645f 6263  emantic_based_bc
+000008a0: 2c20 426c 6f61 7443 6f6e 7472 6f6c 436f  , BloatControlCo
+000008b0: 6e66 6967 7572 6174 696f 6e2c 2053 656c  nfiguration, Sel
+000008c0: 6563 7469 6f6e 4d6f 6465 0a66 726f 6d20  ectionMode.from 
+000008d0: 6576 6f6c 7574 696f 6e61 7279 5f66 6f72  evolutionary_for
+000008e0: 6573 742e 636f 6d70 6f6e 656e 742e 6372  est.component.cr
+000008f0: 6f73 736f 7665 725f 6d75 7461 7469 6f6e  ossover_mutation
+00000900: 2069 6d70 6f72 7420 686f 6973 744d 7574   import hoistMut
+00000910: 6174 696f 6e2c 2068 6f69 7374 4d75 7461  ation, hoistMuta
+00000920: 7469 6f6e 5769 7468 5465 726d 696e 616c  tionWithTerminal
+00000930: 2c20 5c0a 2020 2020 696e 6469 7669 6475  , \.    individu
+00000940: 616c 5f63 6f6d 6269 6e61 7469 6f6e 0a66  al_combination.f
+00000950: 726f 6d20 6576 6f6c 7574 696f 6e61 7279  rom evolutionary
+00000960: 5f66 6f72 6573 742e 636f 6d70 6f6e 656e  _forest.componen
+00000970: 742e 6576 616c 7561 7469 6f6e 2069 6d70  t.evaluation imp
+00000980: 6f72 7420 6361 6c63 756c 6174 655f 7363  ort calculate_sc
+00000990: 6f72 652c 2067 6574 5f63 765f 7370 6c69  ore, get_cv_spli
+000009a0: 7474 6572 2c20 7175 6963 6b5f 7265 7375  tter, quick_resu
+000009b0: 6c74 5f63 616c 6375 6c61 7469 6f6e 2c20  lt_calculation, 
+000009c0: 5c0a 2020 2020 7069 7065 5f63 6f6d 6269  \.    pipe_combi
+000009d0: 6e65 2c20 7175 6963 6b5f 6576 616c 7561  ne, quick_evalua
+000009e0: 7465 2c20 4576 616c 7561 7469 6f6e 5265  te, EvaluationRe
+000009f0: 7375 6c74 732c 205c 0a20 2020 2073 656c  sults, \.    sel
+00000a00: 6563 745f 6672 6f6d 5f61 7272 6179 2c20  ect_from_array, 
+00000a10: 6765 745f 7361 6d70 6c65 5f77 6569 6768  get_sample_weigh
+00000a20: 740a 6672 6f6d 2065 766f 6c75 7469 6f6e  t.from evolution
+00000a30: 6172 795f 666f 7265 7374 2e63 6f6d 706f  ary_forest.compo
+00000a40: 6e65 6e74 2e67 656e 6572 6174 696f 6e20  nent.generation 
+00000a50: 696d 706f 7274 2076 6172 416e 6450 6c75  import varAndPlu
+00000a60: 730a 6672 6f6d 2065 766f 6c75 7469 6f6e  s.from evolution
+00000a70: 6172 795f 666f 7265 7374 2e63 6f6d 706f  ary_forest.compo
+00000a80: 6e65 6e74 2e70 7269 6d69 7469 7665 7320  nent.primitives 
+00000a90: 696d 706f 7274 202a 0a66 726f 6d20 6576  import *.from ev
+00000aa0: 6f6c 7574 696f 6e61 7279 5f66 6f72 6573  olutionary_fores
+00000ab0: 742e 636f 6d70 6f6e 656e 742e 7072 696d  t.component.prim
+00000ac0: 6974 6976 6573 2069 6d70 6f72 7420 6e70  itives import np
+00000ad0: 5f6d 6561 6e2c 2061 6464 5f65 7874 656e  _mean, add_exten
+00000ae0: 645f 6f70 6572 6174 6f72 730a 6672 6f6d  d_operators.from
+00000af0: 2065 766f 6c75 7469 6f6e 6172 795f 666f   evolutionary_fo
+00000b00: 7265 7374 2e63 6f6d 706f 6e65 6e74 2e73  rest.component.s
+00000b10: 656c 6563 7469 6f6e 2069 6d70 6f72 7420  election import 
+00000b20: 6261 7463 685f 746f 7572 6e61 6d65 6e74  batch_tournament
+00000b30: 5f73 656c 6563 7469 6f6e 2c20 7365 6c41  _selection, selA
+00000b40: 7574 6f6d 6174 6963 4570 7369 6c6f 6e4c  utomaticEpsilonL
+00000b50: 6578 6963 6173 654b 2c20 5c0a 2020 2020  exicaseK, \.    
+00000b60: 7365 6c54 6f75 726e 616d 656e 7450 6c75  selTournamentPlu
+00000b70: 732c 2073 656c 4175 746f 6d61 7469 6345  s, selAutomaticE
+00000b80: 7073 696c 6f6e 4c65 7869 6361 7365 4661  psilonLexicaseFa
+00000b90: 7374 2c20 7365 6c44 6f75 626c 6552 6f75  st, selDoubleRou
+00000ba0: 6e64 2c20 7365 6c52 616e 646f 6d50 6c75  nd, selRandomPlu
+00000bb0: 732c 2073 656c 4261 6767 696e 672c 2073  s, selBagging, s
+00000bc0: 656c 546f 7572 6e61 6d65 6e74 4e6f 7665  elTournamentNove
+00000bd0: 6c74 792c 205c 0a20 2020 2073 656c 4879  lty, \.    selHy
+00000be0: 6272 6964 2c20 7365 6c47 5045 442c 2073  brid, selGPED, s
+00000bf0: 656c 4d41 5045 6c69 7465 732c 2073 656c  elMAPElites, sel
+00000c00: 4d41 5045 6c69 7465 436c 7573 7465 7269  MAPEliteClusteri
+00000c10: 6e67 2c20 7365 6c4b 6e6f 636b 6f75 742c  ng, selKnockout,
+00000c20: 2073 656c 526f 756c 6574 7465 2c20 7365   selRoulette, se
+00000c30: 6c4d 6178 416e 676c 6553 656c 6563 7469  lMaxAngleSelecti
+00000c40: 6f6e 2c20 5c0a 2020 2020 7365 6c41 6e67  on, \.    selAng
+00000c50: 6c65 4472 6976 656e 5365 6c65 6374 696f  leDrivenSelectio
+00000c60: 6e2c 2073 656c 5374 6174 6973 7469 6373  n, selStatistics
+00000c70: 546f 7572 6e61 6d65 6e74 2c20 7365 6c4c  Tournament, selL
+00000c80: 6578 6963 6f67 7261 7068 6963 5061 7273  exicographicPars
+00000c90: 696d 6f6e 7950 7265 7373 7572 652c 2074  imonyPressure, t
+00000ca0: 6f75 726e 616d 656e 745f 6c65 7869 6361  ournament_lexica
+00000cb0: 7365 5f73 656c 6563 7469 6f6e 2c20 5c0a  se_selection, \.
+00000cc0: 2020 2020 5365 6c65 6374 696f 6e43 6f6e      SelectionCon
+00000cd0: 6669 6775 7261 7469 6f6e 0a66 726f 6d20  figuration.from 
+00000ce0: 6576 6f6c 7574 696f 6e61 7279 5f66 6f72  evolutionary_for
+00000cf0: 6573 742e 636f 6d70 6f6e 656e 742e 7374  est.component.st
+00000d00: 6174 6566 756c 5f67 7020 696d 706f 7274  ateful_gp import
+00000d10: 206d 616b 655f 636c 6173 732c 2054 6172   make_class, Tar
+00000d20: 6765 7445 6e63 6f64 6572 4e75 6d70 790a  getEncoderNumpy.
+00000d30: 6672 6f6d 2065 766f 6c75 7469 6f6e 6172  from evolutionar
+00000d40: 795f 666f 7265 7374 2e63 6f6d 706f 6e65  y_forest.compone
+00000d50: 6e74 2e74 6f6f 6c62 6f78 2069 6d70 6f72  nt.toolbox impor
+00000d60: 7420 5479 7065 6454 6f6f 6c62 6f78 0a66  t TypedToolbox.f
+00000d70: 726f 6d20 6576 6f6c 7574 696f 6e61 7279  rom evolutionary
+00000d80: 5f66 6f72 6573 742e 6d6f 6465 6c2e 504c  _forest.model.PL
+00000d90: 5472 6565 2069 6d70 6f72 7420 536f 6674  Tree import Soft
+00000da0: 504c 5472 6565 5265 6772 6573 736f 722c  PLTreeRegressor,
+00000db0: 2053 6f66 7450 4c54 7265 6552 6567 7265   SoftPLTreeRegre
+00000dc0: 7373 6f72 454d 2c20 504c 5472 6565 5265  ssorEM, PLTreeRe
+00000dd0: 6772 6573 736f 722c 2052 6964 6765 4454  gressor, RidgeDT
+00000de0: 2c20 5c0a 2020 2020 4c52 4454 436c 6173  , \.    LRDTClas
+00000df0: 7369 6669 6572 2c20 5269 6467 6544 5450  sifier, RidgeDTP
+00000e00: 6c75 732c 2052 616e 646f 6d57 6569 6768  lus, RandomWeigh
+00000e10: 7452 6964 6765 0a66 726f 6d20 6576 6f6c  tRidge.from evol
+00000e20: 7574 696f 6e61 7279 5f66 6f72 6573 742e  utionary_forest.
+00000e30: 6d6f 6465 6c2e 5242 464e 2069 6d70 6f72  model.RBFN impor
+00000e40: 7420 5242 464e 0a66 726f 6d20 6576 6f6c  t RBFN.from evol
+00000e50: 7574 696f 6e61 7279 5f66 6f72 6573 742e  utionary_forest.
+00000e60: 6d6f 6465 6c2e 5361 6665 7479 4c52 2069  model.SafetyLR i
+00000e70: 6d70 6f72 7420 5361 6665 7479 4c6f 6769  mport SafetyLogi
+00000e80: 7374 6963 5265 6772 6573 7369 6f6e 0a66  sticRegression.f
+00000e90: 726f 6d20 6576 6f6c 7574 696f 6e61 7279  rom evolutionary
+00000ea0: 5f66 6f72 6573 742e 6d6f 6465 6c2e 5361  _forest.model.Sa
+00000eb0: 6665 7479 5363 616c 6572 2069 6d70 6f72  fetyScaler impor
+00000ec0: 7420 5361 6665 7479 5363 616c 6572 0a66  t SafetyScaler.f
+00000ed0: 726f 6d20 6576 6f6c 7574 696f 6e61 7279  rom evolutionary
+00000ee0: 5f66 6f72 6573 742e 6d75 6c74 6967 656e  _forest.multigen
+00000ef0: 655f 6770 2069 6d70 6f72 7420 2a0a 6672  e_gp import *.fr
+00000f00: 6f6d 2065 766f 6c75 7469 6f6e 6172 795f  om evolutionary_
+00000f10: 666f 7265 7374 2e70 7265 7072 6f63 6573  forest.preproces
+00000f20: 735f 7574 696c 7320 696d 706f 7274 2047  s_utils import G
+00000f30: 656e 6572 616c 4665 6174 7572 652c 2043  eneralFeature, C
+00000f40: 6174 6567 6f72 6963 616c 4665 6174 7572  ategoricalFeatur
+00000f50: 652c 2042 6f6f 6c65 616e 4665 6174 7572  e, BooleanFeatur
+00000f60: 652c 205c 0a20 2020 204e 756d 6572 6963  e, \.    Numeric
+00000f70: 616c 4665 6174 7572 652c 2046 6561 7475  alFeature, Featu
+00000f80: 7265 5472 616e 7366 6f72 6d65 720a 6672  reTransformer.fr
+00000f90: 6f6d 2065 766f 6c75 7469 6f6e 6172 795f  om evolutionary_
+00000fa0: 666f 7265 7374 2e70 726f 6261 6269 6c69  forest.probabili
+00000fb0: 7479 5f67 7020 696d 706f 7274 2067 656e  ty_gp import gen
+00000fc0: 4861 6c66 416e 6448 616c 662c 2067 656e  HalfAndHalf, gen
+00000fd0: 4675 6c6c 0a66 726f 6d20 6576 6f6c 7574  Full.from evolut
+00000fe0: 696f 6e61 7279 5f66 6f72 6573 742e 7072  ionary_forest.pr
+00000ff0: 756e 696e 6720 696d 706f 7274 206f 6f62  uning import oob
+00001000: 5f70 7275 6e69 6e67 0a66 726f 6d20 6576  _pruning.from ev
+00001010: 6f6c 7574 696f 6e61 7279 5f66 6f72 6573  olutionary_fores
+00001020: 742e 7374 7261 7465 6769 6573 2e65 7374  t.strategies.est
+00001030: 696d 6174 696f 6e5f 6f66 5f64 6973 7472  imation_of_distr
+00001040: 6962 7574 696f 6e20 696d 706f 7274 2045  ibution import E
+00001050: 7374 696d 6174 696f 6e4f 6644 6973 7472  stimationOfDistr
+00001060: 6962 7574 696f 6e0a 6672 6f6d 2065 766f  ibution.from evo
+00001070: 6c75 7469 6f6e 6172 795f 666f 7265 7374  lutionary_forest
+00001080: 2e73 7472 6174 6567 6965 732e 7370 6163  .strategies.spac
+00001090: 655f 7061 7274 6974 696f 6e20 696d 706f  e_partition impo
+000010a0: 7274 2053 7061 6365 5061 7274 6974 696f  rt SpacePartitio
+000010b0: 6e2c 2070 6172 7469 7469 6f6e 5f73 6368  n, partition_sch
+000010c0: 656d 655f 7661 7241 6e64 2c20 5c0a 2020  eme_varAnd, \.  
+000010d0: 2020 7061 7274 6974 696f 6e5f 7363 6865    partition_sche
+000010e0: 6d65 5f74 6f6f 6c62 6f78 0a66 726f 6d20  me_toolbox.from 
+000010f0: 6576 6f6c 7574 696f 6e61 7279 5f66 6f72  evolutionary_for
+00001100: 6573 742e 7374 7261 7465 6769 6573 2e73  est.strategies.s
+00001110: 7572 726f 6761 7465 5f6d 6f64 656c 2069  urrogate_model i
+00001120: 6d70 6f72 7420 5375 7272 6f67 6174 654d  mport SurrogateM
+00001130: 6f64 656c 0a66 726f 6d20 6576 6f6c 7574  odel.from evolut
+00001140: 696f 6e61 7279 5f66 6f72 6573 742e 7574  ionary_forest.ut
+00001150: 696c 7320 696d 706f 7274 2067 6574 5f66  ils import get_f
+00001160: 6561 7475 7265 5f69 6d70 6f72 7461 6e63  eature_importanc
+00001170: 652c 2066 6561 7475 7265 5f61 7070 656e  e, feature_appen
+00001180: 642c 2073 656c 6563 745f 746f 705f 6665  d, select_top_fe
+00001190: 6174 7572 6573 2c20 6566 6669 6369 656e  atures, efficien
+000011a0: 745f 6465 6570 636f 7079 2c20 5c0a 2020  t_deepcopy, \.  
+000011b0: 2020 6765 6e65 5f74 6f5f 7374 7269 6e67    gene_to_string
+000011c0: 2c20 6765 745f 6163 7469 7661 7469 6f6e  , get_activation
+000011d0: 732c 2072 6573 6574 5f72 616e 646f 6d2c  s, reset_random,
+000011e0: 2077 6569 6768 7465 645f 6176 675f 616e   weighted_avg_an
+000011f0: 645f 7374 642c 2073 6176 655f 6172 7261  d_std, save_arra
+00001200: 792c 2069 735f 666c 6f61 742c 2063 726f  y, is_float, cro
+00001210: 7373 5f73 6361 6c65 2c20 5c0a 2020 2020  ss_scale, \.    
+00001220: 6578 7472 6163 745f 6e75 6d62 6572 732c  extract_numbers,
+00001230: 2070 6963 6b6c 655f 6465 6570 636f 7079   pickle_deepcopy
+00001240: 0a0a 6564 615f 6f70 6572 6174 6f72 7320  ..eda_operators 
+00001250: 3d20 5b27 7072 6f62 6162 696c 6974 792d  = ['probability-
+00001260: 5453 272c 2027 4544 412d 5072 696d 6974  TS', 'EDA-Primit
+00001270: 6976 6527 2c20 2745 4441 2d54 6572 6d69  ive', 'EDA-Termi
+00001280: 6e61 6c27 2c20 2745 4441 2d50 4d27 2c0a  nal', 'EDA-PM',.
+00001290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000012a0: 2027 4544 412d 5465 726d 696e 616c 2d50   'EDA-Terminal-P
+000012b0: 4d27 2c0a 2020 2020 2020 2020 2020 2020  M',.            
+000012c0: 2020 2020 2023 2055 7369 6e67 206d 6561       # Using mea
+000012d0: 6e20 696d 706f 7274 616e 6365 2076 616c  n importance val
+000012e0: 7565 2c20 7768 6963 6820 6973 206d 6f72  ue, which is mor
+000012f0: 6520 7265 6173 6f6e 6162 6c65 0a20 2020  e reasonable.   
+00001300: 2020 2020 2020 2020 2020 2020 2020 2745                'E
+00001310: 4441 2d54 6572 6d69 6e61 6c2d 504d 2127  DA-Terminal-PM!'
+00001320: 2c20 2745 4441 2d54 6572 6d69 6e61 6c2d  , 'EDA-Terminal-
+00001330: 504d 2121 272c 0a20 2020 2020 2020 2020  PM!!',.         
+00001340: 2020 2020 2020 2020 2745 4441 2d54 6572          'EDA-Ter
+00001350: 6d69 6e61 6c2d 4261 6c61 6e63 6564 272c  minal-Balanced',
+00001360: 2027 4544 412d 5465 726d 696e 616c 2d53   'EDA-Terminal-S
+00001370: 616d 6557 6569 6768 7427 2c20 2745 4441  ameWeight', 'EDA
+00001380: 2d54 6572 6d69 6e61 6c2d 504d 4927 2c0a  -Terminal-PMI',.
+00001390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000013a0: 2027 4544 412d 5465 726d 696e 616c 2d50   'EDA-Terminal-P
+000013b0: 4d2d 4269 6173 6564 272c 2027 4544 412d  M-Biased', 'EDA-
+000013c0: 5465 726d 696e 616c 2d50 4d2d 506f 7075  Terminal-PM-Popu
+000013d0: 6c61 7469 6f6e 272c 2027 4544 412d 504d  lation', 'EDA-PM
+000013e0: 2d50 6f70 756c 6174 696f 6e27 2c0a 2020  -Population',.  
+000013f0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00001400: 4544 412d 5465 726d 696e 616c 2d50 4d2d  EDA-Terminal-PM-
+00001410: 4672 6571 7565 6e63 7927 2c20 2745 4441  Frequency', 'EDA
+00001420: 2d54 6572 6d69 6e61 6c2d 504d 2d54 6f75  -Terminal-PM-Tou
+00001430: 726e 616d 656e 7427 2c0a 2020 2020 2020  rnament',.      
+00001440: 2020 2020 2020 2020 2020 2027 4544 412d             'EDA-
+00001450: 5465 726d 696e 616c 2d50 4d2d 5343 272c  Terminal-PM-SC',
+00001460: 2027 4544 412d 5465 726d 696e 616c 2d50   'EDA-Terminal-P
+00001470: 4d2d 5343 2d57 5327 2c20 2745 4441 2d54  M-SC-WS', 'EDA-T
+00001480: 6572 6d69 6e61 6c2d 504d 2d53 432d 4e54  erminal-PM-SC-NT
+00001490: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+000014a0: 2020 2020 2745 4441 2d54 6572 6d69 6e61      'EDA-Termina
+000014b0: 6c2d 504d 2d53 616d 6549 6e64 6578 275d  l-PM-SameIndex']
+000014c0: 0a6d 6170 5f65 6c69 7465 5f73 6572 6965  .map_elite_serie
+000014d0: 7320 3d20 5b27 4d41 502d 456c 6974 652d  s = ['MAP-Elite-
+000014e0: 4c65 7869 6361 7365 272c 2027 4d41 502d  Lexicase', 'MAP-
+000014f0: 456c 6974 652d 546f 7572 6e61 6d65 6e74  Elite-Tournament
+00001500: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+00001510: 2020 2020 2020 2027 4d41 502d 456c 6974         'MAP-Elit
+00001520: 652d 526f 756c 6574 7465 272c 2027 4d41  e-Roulette', 'MA
+00001530: 502d 456c 6974 652d 546f 7572 6e61 6d65  P-Elite-Tourname
+00001540: 6e74 2d33 272c 2027 4d41 502d 456c 6974  nt-3', 'MAP-Elit
+00001550: 652d 546f 7572 6e61 6d65 6e74 2d37 272c  e-Tournament-7',
+00001560: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001570: 2020 2020 2027 4d41 502d 456c 6974 652d       'MAP-Elite-
+00001580: 5261 6e64 6f6d 272c 2027 4d41 502d 456c  Random', 'MAP-El
+00001590: 6974 652d 4b6e 6f63 6b6f 7574 272c 2027  ite-Knockout', '
+000015a0: 4d41 502d 456c 6974 652d 4b6e 6f63 6b6f  MAP-Elite-Knocko
+000015b0: 7574 2d53 272c 0a20 2020 2020 2020 2020  ut-S',.         
+000015c0: 2020 2020 2020 2020 2020 2027 4d41 502d             'MAP-
+000015d0: 456c 6974 652d 4b6e 6f63 6b6f 7574 2d41  Elite-Knockout-A
+000015e0: 272c 2027 4d41 502d 456c 6974 652d 4b6e  ', 'MAP-Elite-Kn
+000015f0: 6f63 6b6f 7574 2d53 4127 2c0a 2020 2020  ockout-SA',.    
+00001600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001610: 2741 7574 6f27 2c20 2741 7574 6f2d 4d43  'Auto', 'Auto-MC
+00001620: 5453 275d 0a72 6573 6574 5f72 616e 646f  TS'].reset_rando
+00001630: 6d28 3029 0a0a 0a63 6c61 7373 2047 4244  m(0)...class GBD
+00001640: 544c 5243 6c61 7373 6966 6965 7258 2847  TLRClassifierX(G
+00001650: 4244 544c 5243 6c61 7373 6966 6965 7229  BDTLRClassifier)
+00001660: 3a0a 0a20 2020 2064 6566 2066 6974 2873  :..    def fit(s
+00001670: 656c 662c 2058 2c20 792c 202a 2a66 6974  elf, X, y, **fit
+00001680: 5f70 6172 616d 7329 3a0a 2020 2020 2020  _params):.      
+00001690: 2020 7375 7065 7228 292e 6669 7428 582c    super().fit(X,
+000016a0: 2079 2c20 2a2a 6669 745f 7061 7261 6d73   y, **fit_params
+000016b0: 290a 2020 2020 2020 2020 7365 6c66 2e63  ).        self.c
+000016c0: 6c61 7373 6573 5f20 3d20 7365 6c66 2e67  lasses_ = self.g
+000016d0: 6264 745f 2e63 6c61 7373 6573 5f0a 2020  bdt_.classes_.  
+000016e0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000016f0: 660a 0a0a 636c 6173 7320 5374 6174 6963  f...class Static
+00001700: 5261 6e64 6f6d 5072 6f6a 6563 7469 6f6e  RandomProjection
+00001710: 2854 7261 6e73 666f 726d 6572 4d69 7869  (TransformerMixi
+00001720: 6e2c 2042 6173 6545 7374 696d 6174 6f72  n, BaseEstimator
+00001730: 293a 0a0a 2020 2020 6465 6620 5f5f 696e  ):..    def __in
+00001740: 6974 5f5f 2873 656c 662c 2063 6f6d 706f  it__(self, compo
+00001750: 6e65 6e74 735f 3a20 696e 7429 3a0a 2020  nents_: int):.  
+00001760: 2020 2020 2020 7365 6c66 2e63 6f6d 706f        self.compo
+00001770: 6e65 6e74 735f 203d 2063 6f6d 706f 6e65  nents_ = compone
+00001780: 6e74 735f 0a0a 2020 2020 6465 6620 5f6d  nts_..    def _m
+00001790: 616b 655f 7261 6e64 6f6d 5f6d 6174 7269  ake_random_matri
+000017a0: 7828 7365 6c66 2c20 6e5f 636f 6d70 6f6e  x(self, n_compon
+000017b0: 656e 7473 2c20 6e5f 6665 6174 7572 6573  ents, n_features
+000017c0: 293a 0a20 2020 2020 2020 2070 6173 730a  ):.        pass.
+000017d0: 0a20 2020 2064 6566 2066 6974 2873 656c  .    def fit(sel
+000017e0: 662c 2058 2c20 793d 4e6f 6e65 293a 0a20  f, X, y=None):. 
+000017f0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00001800: 6c66 0a0a 2020 2020 6465 6620 7472 616e  lf..    def tran
+00001810: 7366 6f72 6d28 7365 6c66 2c20 5829 3a0a  sform(self, X):.
+00001820: 2020 2020 2020 2020 7265 7475 726e 2058          return X
+00001830: 2040 2073 656c 662e 636f 6d70 6f6e 656e   @ self.componen
+00001840: 7473 5f0a 0a0a 636c 6173 7320 456e 7365  ts_...class Ense
+00001850: 6d62 6c65 5265 6772 6573 736f 7228 5265  mbleRegressor(Re
+00001860: 6772 6573 736f 724d 6978 696e 2c20 4261  gressorMixin, Ba
+00001870: 7365 4573 7469 6d61 746f 7229 3a0a 2020  seEstimator):.  
+00001880: 2020 2222 220a 2020 2020 436f 6d62 696e    """.    Combin
+00001890: 696e 6720 7365 7665 7261 6c20 6d6f 6465  ing several mode
+000018a0: 6c73 2067 656e 6572 6174 6564 2062 7920  ls generated by 
+000018b0: 352d 666f 6c64 2043 5620 746f 2066 6f72  5-fold CV to for
+000018c0: 6d20 6120 6669 6e61 6c20 656e 7365 6d62  m a final ensemb
+000018d0: 6c65 206d 6f64 656c 0a20 2020 2022 2222  le model.    """
+000018e0: 0a0a 2020 2020 6465 6620 5f5f 696e 6974  ..    def __init
+000018f0: 5f5f 2873 656c 662c 2074 7265 6573 293a  __(self, trees):
+00001900: 0a20 2020 2020 2020 2073 656c 662e 7472  .        self.tr
+00001910: 6565 7320 3d20 7472 6565 730a 0a20 2020  ees = trees..   
+00001920: 2064 6566 2066 6974 2873 656c 662c 2058   def fit(self, X
+00001930: 2c20 7929 3a0a 2020 2020 2020 2020 7061  , y):.        pa
+00001940: 7373 0a0a 2020 2020 6465 6620 7072 6564  ss..    def pred
+00001950: 6963 7428 7365 6c66 2c20 5829 3a0a 2020  ict(self, X):.  
+00001960: 2020 2020 2020 7072 6564 6963 7469 6f6e        prediction
+00001970: 7320 3d20 5b5d 0a20 2020 2020 2020 2074  s = [].        t
+00001980: 3a20 4465 6369 7369 6f6e 5472 6565 5265  : DecisionTreeRe
+00001990: 6772 6573 736f 720a 2020 2020 2020 2020  gressor.        
+000019a0: 666f 7220 7420 696e 2073 656c 662e 7472  for t in self.tr
+000019b0: 6565 733a 0a20 2020 2020 2020 2020 2020  ees:.           
+000019c0: 2070 7265 6469 6374 696f 6e73 2e61 7070   predictions.app
+000019d0: 656e 6428 742e 7072 6564 6963 7428 5829  end(t.predict(X)
+000019e0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+000019f0: 206e 702e 6d65 616e 2870 7265 6469 6374   np.mean(predict
+00001a00: 696f 6e73 2c20 6178 6973 3d30 290a 0a0a  ions, axis=0)...
+00001a10: 636c 6173 7320 456e 7365 6d62 6c65 436c  class EnsembleCl
+00001a20: 6173 7369 6669 6572 2843 6c61 7373 6966  assifier(Classif
+00001a30: 6965 724d 6978 696e 2c20 4261 7365 4573  ierMixin, BaseEs
+00001a40: 7469 6d61 746f 7229 3a0a 2020 2020 2222  timator):.    ""
+00001a50: 220a 2020 2020 436f 6d62 696e 696e 6720  ".    Combining 
+00001a60: 7365 7665 7261 6c20 6d6f 6465 6c73 2067  several models g
+00001a70: 656e 6572 6174 6564 2062 7920 352d 666f  enerated by 5-fo
+00001a80: 6c64 2043 5620 746f 2066 6f72 6d20 6120  ld CV to form a 
+00001a90: 6669 6e61 6c20 656e 7365 6d62 6c65 206d  final ensemble m
+00001aa0: 6f64 656c 0a20 2020 2022 2222 0a0a 2020  odel.    """..  
+00001ab0: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
+00001ac0: 656c 662c 2074 7265 6573 293a 0a20 2020  elf, trees):.   
+00001ad0: 2020 2020 2073 656c 662e 7472 6565 7320       self.trees 
+00001ae0: 3d20 7472 6565 730a 0a20 2020 2064 6566  = trees..    def
+00001af0: 2066 6974 2873 656c 662c 2058 2c20 7929   fit(self, X, y)
+00001b00: 3a0a 2020 2020 2020 2020 7061 7373 0a0a  :.        pass..
+00001b10: 2020 2020 6465 6620 7072 6564 6963 7428      def predict(
+00001b20: 7365 6c66 2c20 5829 3a0a 2020 2020 2020  self, X):.      
+00001b30: 2020 7072 6564 6963 7469 6f6e 7320 3d20    predictions = 
+00001b40: 5b5d 0a20 2020 2020 2020 2074 3a20 4465  [].        t: De
+00001b50: 6369 7369 6f6e 5472 6565 436c 6173 7369  cisionTreeClassi
+00001b60: 6669 6572 0a20 2020 2020 2020 2066 6f72  fier.        for
+00001b70: 2074 2069 6e20 7365 6c66 2e74 7265 6573   t in self.trees
+00001b80: 3a0a 2020 2020 2020 2020 2020 2020 7072  :.            pr
+00001b90: 6564 6963 7469 6f6e 732e 6170 7065 6e64  edictions.append
+00001ba0: 2874 2e70 7265 6469 6374 2858 2929 0a20  (t.predict(X)). 
+00001bb0: 2020 2020 2020 2072 6574 7572 6e20 7374         return st
+00001bc0: 6174 732e 6d6f 6465 2870 7265 6469 6374  ats.mode(predict
+00001bd0: 696f 6e73 2c20 6178 6973 3d30 295b 305d  ions, axis=0)[0]
+00001be0: 2e66 6c61 7474 656e 2829 0a0a 0a64 6566  .flatten()...def
+00001bf0: 2073 696d 696c 6172 2861 2c20 6229 3a0a   similar(a, b):.
+00001c00: 2020 2020 7265 7475 726e 2063 6f73 696e      return cosin
+00001c10: 655f 7369 6d69 6c61 7269 7479 2861 2e63  e_similarity(a.c
+00001c20: 6173 655f 7661 6c75 6573 2e72 6573 6861  ase_values.resha
+00001c30: 7065 2831 2c20 2d31 292c 2062 2e63 6173  pe(1, -1), b.cas
+00001c40: 655f 7661 6c75 6573 2e72 6573 6861 7065  e_values.reshape
+00001c50: 2831 2c20 2d31 2929 5b30 5d5b 305d 203e  (1, -1))[0][0] >
+00001c60: 2030 2e39 0a0a 0a64 6566 2073 7065 6172   0.9...def spear
+00001c70: 6d61 6e28 7961 2c20 7962 293a 0a20 2020  man(ya, yb):.   
+00001c80: 2069 6620 7961 2e73 7464 2829 203c 2031   if ya.std() < 1
+00001c90: 652d 3130 3a0a 2020 2020 2020 2020 7265  e-10:.        re
+00001ca0: 7475 726e 2031 0a20 2020 2072 6574 7572  turn 1.    retur
+00001cb0: 6e20 7370 6561 726d 616e 7228 7961 2c20  n spearmanr(ya, 
+00001cc0: 7962 295b 305d 0a0a 0a64 6566 206b 656e  yb)[0]...def ken
+00001cd0: 6461 6c6c 2879 612c 2079 6229 3a0a 2020  dall(ya, yb):.  
+00001ce0: 2020 7265 7475 726e 206b 656e 6461 6c6c    return kendall
+00001cf0: 7461 7528 7961 2c20 7962 295b 305d 0a0a  tau(ya, yb)[0]..
+00001d00: 0a63 6c61 7373 2054 6573 7446 756e 6374  .class TestFunct
+00001d10: 696f 6e28 293a 0a20 2020 2064 6566 205f  ion():.    def _
+00001d20: 5f69 6e69 745f 5f28 7365 6c66 2c20 782c  _init__(self, x,
+00001d30: 2079 293a 0a20 2020 2020 2020 2073 656c   y):.        sel
+00001d40: 662e 7820 3d20 780a 2020 2020 2020 2020  f.x = x.        
+00001d50: 7365 6c66 2e79 203d 2079 0a20 2020 2020  self.y = y.     
+00001d60: 2020 2073 656c 662e 7265 6772 203d 204e     self.regr = N
+00001d70: 6f6e 650a 0a20 2020 2064 6566 2070 7265  one..    def pre
+00001d80: 6469 6374 5f6c 6f73 7328 7365 6c66 293a  dict_loss(self):
+00001d90: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+00001da0: 7365 6c66 2e78 2920 3e20 303a 0a20 2020  self.x) > 0:.   
+00001db0: 2020 2020 2020 2020 2079 5f70 203d 2073           y_p = s
+00001dc0: 656c 662e 7265 6772 2e70 7265 6469 6374  elf.regr.predict
+00001dd0: 2873 656c 662e 7829 0a20 2020 2020 2020  (self.x).       
+00001de0: 2020 2020 2072 6574 7572 6e20 7232 5f73       return r2_s
+00001df0: 636f 7265 2873 656c 662e 792c 2079 5f70  core(self.y, y_p
+00001e00: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+00001e10: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00001e20: 726e 2030 0a0a 2020 2020 6465 6620 5f5f  rn 0..    def __
+00001e30: 6465 6570 636f 7079 5f5f 2873 656c 662c  deepcopy__(self,
+00001e40: 206d 656d 6f64 6963 743d 7b7d 293a 0a20   memodict={}):. 
+00001e50: 2020 2020 2020 2072 6574 7572 6e20 636f         return co
+00001e60: 7079 2e64 6565 7063 6f70 7928 7365 6c66  py.deepcopy(self
+00001e70: 290a 0a0a 636c 6173 7320 4576 6f6c 7574  )...class Evolut
+00001e80: 696f 6e61 7279 466f 7265 7374 5265 6772  ionaryForestRegr
+00001e90: 6573 736f 7228 5265 6772 6573 736f 724d  essor(RegressorM
+00001ea0: 6978 696e 2c20 5472 616e 7366 6f72 6d65  ixin, Transforme
+00001eb0: 724d 6978 696e 2c20 4261 7365 4573 7469  rMixin, BaseEsti
+00001ec0: 6d61 746f 722c 0a20 2020 2020 2020 2020  mator,.         
+00001ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001ee0: 2020 2020 2020 2020 2053 7572 726f 6761           Surroga
+00001ef0: 7465 4d6f 6465 6c2c 2053 7061 6365 5061  teModel, SpacePa
+00001f00: 7274 6974 696f 6e2c 2045 7374 696d 6174  rtition, Estimat
+00001f10: 696f 6e4f 6644 6973 7472 6962 7574 696f  ionOfDistributio
+00001f20: 6e29 3a0a 2020 2020 2222 220a 2020 2020  n):.    """.    
+00001f30: 5375 7070 6f72 7420 626f 7468 2054 4750  Support both TGP
+00001f40: 2061 6e64 2061 2076 6172 6961 6e74 206f   and a variant o
+00001f50: 6620 4c47 5020 666f 7220 6576 6f6c 7574  f LGP for evolut
+00001f60: 696f 616e 7279 2066 6561 7475 7265 2063  ioanry feature c
+00001f70: 6f6e 7374 7275 6374 696f 6e0a 2020 2020  onstruction.    
+00001f80: 2222 220a 0a20 2020 2064 6566 205f 5f69  """..    def __i
+00001f90: 6e69 745f 5f28 7365 6c66 2c20 6e5f 706f  nit__(self, n_po
+00001fa0: 703d 3530 2c20 6e5f 6765 6e3d 3230 2c20  p=50, n_gen=20, 
+00001fb0: 7665 7262 6f73 653d 4661 6c73 652c 206d  verbose=False, m
+00001fc0: 6178 5f68 6569 6768 743d 382c 206d 696e  ax_height=8, min
+00001fd0: 5f68 6569 6768 743d 302c 0a20 2020 2020  _height=0,.     
+00001fe0: 2020 2020 2020 2020 2020 2020 6261 7369              basi
+00001ff0: 635f 7072 696d 6974 6976 6573 3d54 7275  c_primitives=Tru
+00002000: 652c 206e 6f72 6d61 6c69 7a65 3d54 7275  e, normalize=Tru
+00002010: 652c 2073 656c 6563 743d 2741 7574 6f6d  e, select='Autom
+00002020: 6174 6963 4c65 7869 6361 7365 4661 7374  aticLexicaseFast
+00002030: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+00002040: 2020 2020 6765 6e65 5f6e 756d 3d35 2c20      gene_num=5, 
+00002050: 6d75 7461 7469 6f6e 5f73 6368 656d 653d  mutation_scheme=
+00002060: 2775 6e69 666f 726d 272c 2065 6e73 656d  'uniform', ensem
+00002070: 626c 655f 7369 7a65 3d31 3030 2c0a 2020  ble_size=100,.  
+00002080: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00002090: 7874 6572 6e61 6c5f 6172 6368 6976 653d  xternal_archive=
+000020a0: 4e6f 6e65 2c20 6f72 6967 696e 616c 5f66  None, original_f
+000020b0: 6561 7475 7265 733d 4661 6c73 652c 2064  eatures=False, d
+000020c0: 6976 6572 7369 7479 5f73 6561 7263 683d  iversity_search=
+000020d0: 274e 6f6e 6527 2c20 6372 6f73 735f 7062  'None', cross_pb
+000020e0: 3d30 2e35 2c0a 2020 2020 2020 2020 2020  =0.5,.          
+000020f0: 2020 2020 2020 206d 7574 6174 696f 6e5f         mutation_
+00002100: 7062 3d30 2e31 2c20 7365 636f 6e64 5f6c  pb=0.1, second_l
+00002110: 6179 6572 3d4e 6f6e 652c 2065 6e73 656d  ayer=None, ensem
+00002120: 626c 655f 7365 6c65 6374 696f 6e3d 4e6f  ble_selection=No
+00002130: 6e65 2c20 7465 7374 5f66 756e 3d4e 6f6e  ne, test_fun=Non
+00002140: 652c 2062 6f6f 7473 7472 6170 5f74 7261  e, bootstrap_tra
+00002150: 696e 696e 673d 4661 6c73 652c 0a20 2020  ining=False,.   
+00002160: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+00002170: 616e 5f6d 6f64 656c 3d46 616c 7365 2c20  an_model=False, 
+00002180: 6561 726c 795f 7374 6f70 3d2d 312c 206d  early_stop=-1, m
+00002190: 696e 5f73 616d 706c 6573 5f6c 6561 663d  in_samples_leaf=
+000021a0: 312c 2062 6173 655f 6c65 6172 6e65 723d  1, base_learner=
+000021b0: 2752 616e 646f 6d2d 4454 272c 2073 636f  'Random-DT', sco
+000021c0: 7265 5f66 756e 633d 2752 3227 2c0a 2020  re_func='R2',.  
+000021d0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+000021e0: 6178 5f74 7265 655f 6465 7074 683d 4e6f  ax_tree_depth=No
+000021f0: 6e65 2c20 656e 7669 726f 6e6d 656e 7461  ne, environmenta
+00002200: 6c5f 7365 6c65 6374 696f 6e3d 4e6f 6e65  l_selection=None
+00002210: 2c20 7072 655f 7365 6c65 6374 696f 6e3d  , pre_selection=
+00002220: 4e6f 6e65 2c20 6561 6765 725f 7472 6169  None, eager_trai
+00002230: 6e69 6e67 3d46 616c 7365 2c0a 2020 2020  ning=False,.    
+00002240: 2020 2020 2020 2020 2020 2020 206e 5f70               n_p
+00002250: 726f 6365 7373 3d31 2c20 7573 656c 6573  rocess=1, useles
+00002260: 735f 6665 6174 7572 655f 7261 7469 6f3d  s_feature_ratio=
+00002270: 4e6f 6e65 2c20 7765 6967 6874 6564 5f63  None, weighted_c
+00002280: 6f65 663d 4661 6c73 652c 2066 6561 7475  oef=False, featu
+00002290: 7265 5f73 656c 6563 7469 6f6e 3d46 616c  re_selection=Fal
+000022a0: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
+000022b0: 2020 2020 2061 6c6c 6f77 5f72 6570 6574       allow_repet
+000022c0: 6974 6976 653d 4661 6c73 652c 2063 763d  itive=False, cv=
+000022d0: 352c 2065 6c69 7469 736d 3d30 2c20 7365  5, elitism=0, se
+000022e0: 6d61 6e74 6963 5f76 6172 6961 7469 6f6e  mantic_variation
+000022f0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+00002300: 2020 2020 2020 2020 2023 2053 6f66 742d           # Soft-
+00002310: 5053 2d54 7265 650a 2020 2020 2020 2020  PS-Tree.        
+00002320: 2020 2020 2020 2020 2070 6172 7469 7469           partiti
+00002330: 6f6e 5f6e 756d 6265 723d 342c 2070 735f  on_number=4, ps_
+00002340: 7472 6565 5f6c 6f63 616c 5f6d 6f64 656c  tree_local_model
+00002350: 3d27 5269 6467 6543 5627 2c0a 2020 2020  ='RidgeCV',.    
+00002360: 2020 2020 2020 2020 2020 2020 2064 796e               dyn
+00002370: 616d 6963 5f70 6172 7469 7469 6f6e 3d27  amic_partition='
+00002380: 5365 6c66 2d41 6461 7074 6976 6527 2c20  Self-Adaptive', 
+00002390: 6d61 785f 6c65 6166 5f6e 6f64 6573 3d4e  max_leaf_nodes=N
+000023a0: 6f6e 652c 2070 735f 7472 6565 5f63 765f  one, ps_tree_cv_
+000023b0: 6c61 6265 6c3d 5472 7565 2c0a 2020 2020  label=True,.    
+000023c0: 2020 2020 2020 2020 2020 2020 2070 735f               ps_
+000023d0: 7472 6565 5f70 6172 7469 7469 6f6e 5f6d  tree_partition_m
+000023e0: 6f64 656c 3d27 4465 6369 7369 6f6e 5472  odel='DecisionTr
+000023f0: 6565 272c 2070 735f 7472 6565 5f72 6174  ee', ps_tree_rat
+00002400: 696f 3d30 2e31 2c0a 2020 2020 2020 2020  io=0.1,.        
+00002410: 2020 2020 2020 2020 206f 6e6c 795f 6f72           only_or
+00002420: 6967 696e 616c 5f66 6561 7475 7265 733d  iginal_features=
+00002430: 5472 7565 2c20 7368 6172 6564 5f70 6172  True, shared_par
+00002440: 7469 7469 6f6e 5f73 6368 656d 653d 4661  tition_scheme=Fa
+00002450: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
+00002460: 2020 2020 2020 2320 4d6f 7265 2050 6172        # More Par
+00002470: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
+00002480: 2020 2020 2020 2020 2069 6e69 7469 616c           initial
+00002490: 5f74 7265 655f 7369 7a65 3d4e 6f6e 652c  _tree_size=None,
+000024a0: 2064 6563 6973 696f 6e5f 7472 6565 5f63   decision_tree_c
+000024b0: 6f75 6e74 3d30 2c20 6261 7369 635f 6765  ount=0, basic_ge
+000024c0: 6e65 5f6e 756d 3d30 2c0a 2020 2020 2020  ne_num=0,.      
+000024d0: 2020 2020 2020 2020 2020 2063 6c65 6172             clear
+000024e0: 696e 675f 636c 7573 7465 725f 7369 7a65  ing_cluster_size
+000024f0: 3d30 2c20 7265 6475 6374 696f 6e5f 7261  =0, reduction_ra
+00002500: 7469 6f3d 302c 0a20 2020 2020 2020 2020  tio=0,.         
+00002510: 2020 2020 2020 2020 7261 6e64 6f6d 5f73          random_s
+00002520: 7461 7465 3d4e 6f6e 652c 2063 6c61 7373  tate=None, class
+00002530: 5f77 6569 6768 743d 4e6f 6e65 2c20 6d61  _weight=None, ma
+00002540: 705f 656c 6974 655f 7061 7261 6d65 7465  p_elite_paramete
+00002550: 723d 4e6f 6e65 2c0a 2020 2020 2020 2020  r=None,.        
+00002560: 2020 2020 2020 2020 2023 2044 6570 7265           # Depre
+00002570: 6361 7465 6420 7061 7261 6d65 7465 7273  cated parameters
+00002580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002590: 2020 626f 6f73 745f 7369 7a65 3d4e 6f6e    boost_size=Non
+000025a0: 652c 2076 616c 6964 6174 696f 6e5f 7369  e, validation_si
+000025b0: 7a65 3d30 2c20 6d61 625f 7061 7261 6d65  ze=0, mab_parame
+000025c0: 7465 723d 4e6f 6e65 2c20 7365 6d61 6e74  ter=None, semant
+000025d0: 6963 5f64 6976 6572 7369 7479 3d4e 6f6e  ic_diversity=Non
+000025e0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+000025f0: 2020 2020 696e 7465 726c 6561 7669 6e67      interleaving
+00002600: 5f70 6572 696f 643d 302c 0a20 2020 2020  _period=0,.     
+00002610: 2020 2020 2020 2020 2020 2020 2320 4d47              # MG
+00002620: 5020 6879 7065 7270 6172 616d 6574 6572  P hyperparameter
+00002630: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
+00002640: 2020 206d 6770 5f6d 6f64 653d 4661 6c73     mgp_mode=Fals
+00002650: 652c 206d 6770 5f73 636f 7065 3d4e 6f6e  e, mgp_scope=Non
+00002660: 652c 206e 756d 6265 725f 6f66 5f72 6567  e, number_of_reg
+00002670: 6973 7465 723d 3130 2c20 696e 7472 6f6e  ister=10, intron
+00002680: 5f70 726f 6261 6269 6c69 7479 3d30 2c0a  _probability=0,.
+00002690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000026a0: 2072 6567 6973 7465 725f 6d75 7461 7469   register_mutati
+000026b0: 6f6e 5f70 726f 6261 6269 6c69 7479 3d30  on_probability=0
+000026c0: 2e31 2c20 6465 6c65 7465 5f69 7272 656c  .1, delete_irrel
+000026d0: 6576 616e 743d 4661 6c73 652c 0a20 2020  evant=False,.   
+000026e0: 2020 2020 2020 2020 2020 2020 2020 6465                de
+000026f0: 6c65 7465 5f72 6564 756e 6461 6e74 3d46  lete_redundant=F
+00002700: 616c 7365 2c20 6972 7265 6c65 7661 6e74  alse, irrelevant
+00002710: 5f66 6561 7475 7265 5f72 6174 696f 3d30  _feature_ratio=0
+00002720: 2e30 312c 2073 7472 6963 745f 6c61 7965  .01, strict_laye
+00002730: 725f 6d67 703d 5472 7565 2c0a 2020 2020  r_mgp=True,.    
+00002740: 2020 2020 2020 2020 2020 2020 2023 2055               # U
+00002750: 7369 6e67 2066 6f72 2070 7265 2d73 656c  sing for pre-sel
+00002760: 6563 7469 6f6e 0a20 2020 2020 2020 2020  ection.         
+00002770: 2020 2020 2020 2020 636f 7272 656c 6174          correlat
+00002780: 696f 6e5f 7468 7265 7368 6f6c 643d 4e6f  ion_threshold=No
+00002790: 6e65 2c20 636f 7272 656c 6174 696f 6e5f  ne, correlation_
+000027a0: 6d6f 6465 3d4e 6f6e 652c 0a20 2020 2020  mode=None,.     
+000027b0: 2020 2020 2020 2020 2020 2020 656e 7365              ense
+000027c0: 6d62 6c65 5f70 7265 6469 6374 696f 6e3d  mble_prediction=
+000027d0: 274d 6561 6e27 2c20 6e75 6d62 6572 5f6f  'Mean', number_o
+000027e0: 665f 7061 7265 6e74 733d 302c 206f 7574  f_parents=0, out
+000027f0: 6c69 6572 5f64 6574 6563 7469 6f6e 3d46  lier_detection=F
+00002800: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
+00002810: 2020 2020 2020 2063 6f6e 7374 616e 745f         constant_
+00002820: 7479 7065 3d27 496e 7427 2c20 7365 6d61  type='Int', sema
+00002830: 6e74 6963 5f72 6570 6169 723d 302c 0a20  ntic_repair=0,. 
+00002840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002850: 6479 6e61 6d69 635f 7265 6475 6374 696f  dynamic_reductio
+00002860: 6e3d 302c 2061 6374 6976 655f 6765 6e65  n=0, active_gene
+00002870: 5f6e 756d 3d30 2c20 696e 7472 6f6e 5f74  _num=0, intron_t
+00002880: 6872 6573 686f 6c64 3d30 2c0a 2020 2020  hreshold=0,.    
+00002890: 2020 2020 2020 2020 2020 2020 2062 6c6f               blo
+000028a0: 6174 5f63 6f6e 7472 6f6c 3d4e 6f6e 652c  at_control=None,
+000028b0: 2066 6f72 6365 5f73 725f 7472 6565 3d46   force_sr_tree=F
+000028c0: 616c 7365 2c20 6772 6164 6965 6e74 5f62  alse, gradient_b
+000028d0: 6f6f 7374 696e 673d 4661 6c73 652c 0a20  oosting=False,. 
+000028e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000028f0: 696e 7472 6f6e 5f67 703d 4661 6c73 652c  intron_gp=False,
+00002900: 2070 6f73 745f 7072 756e 655f 7468 7265   post_prune_thre
+00002910: 7368 6f6c 643d 302c 2070 6172 7369 6d6f  shold=0, parsimo
+00002920: 6e69 6f75 735f 7072 6f62 6162 696c 6974  nious_probabilit
+00002930: 793d 312c 0a20 2020 2020 2020 2020 2020  y=1,.           
+00002940: 2020 2020 2020 7265 6475 6e64 616e 745f        redundant_
+00002950: 686f 665f 7369 7a65 3d30 2c20 6465 6c65  hof_size=0, dele
+00002960: 7465 5f6c 6f77 5f73 696d 696c 6172 6974  te_low_similarit
+00002970: 793d 4661 6c73 652c 2069 6d70 6f72 7461  y=False, importa
+00002980: 6e63 655f 7072 6f70 6167 6174 696f 6e3d  nce_propagation=
+00002990: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
+000029a0: 2020 2020 2020 2020 7261 6e64 6f6d 5f66          random_f
+000029b0: 6978 3d54 7275 652c 2072 6964 6765 5f61  ix=True, ridge_a
+000029c0: 6c70 6861 733d 4e6f 6e65 2c20 7368 6172  lphas=None, shar
+000029d0: 6564 5f65 6461 3d46 616c 7365 2c20 2a2a  ed_eda=False, **
+000029e0: 7061 7261 6d73 293a 0a20 2020 2020 2020  params):.       
+000029f0: 2022 2222 0a20 2020 2020 2020 2042 6173   """.        Bas
+00002a00: 6963 2047 5020 5061 7261 6d65 7465 7273  ic GP Parameters
+00002a10: 3a0a 2020 2020 2020 2020 6e5f 706f 703a  :.        n_pop:
+00002a20: 2054 6865 2073 697a 6520 6f66 2074 6865   The size of the
+00002a30: 2070 6f70 756c 6174 696f 6e0a 2020 2020   population.    
+00002a40: 2020 2020 6e5f 6765 6e3a 2054 6865 206e      n_gen: The n
+00002a50: 756d 6265 7220 6f66 2067 656e 6572 6174  umber of generat
+00002a60: 696f 6e73 0a20 2020 2020 2020 2076 6572  ions.        ver
+00002a70: 626f 7365 3a20 5768 6574 6865 7220 746f  bose: Whether to
+00002a80: 2070 7269 6e74 2076 6572 626f 7365 2069   print verbose i
+00002a90: 6e66 6f72 6d61 7469 6f6e 0a20 2020 2020  nformation.     
+00002aa0: 2020 206d 6178 5f6c 6561 665f 6e6f 6465     max_leaf_node
+00002ab0: 733a 2054 6865 206d 6178 696d 756d 2068  s: The maximum h
+00002ac0: 6569 6768 7420 6f66 2065 6163 6820 4750  eight of each GP
+00002ad0: 2074 7265 650a 2020 2020 2020 2020 6261   tree.        ba
+00002ae0: 7369 635f 7072 696d 6974 6976 6573 3a20  sic_primitives: 
+00002af0: 5468 6520 7072 696d 6974 6976 6520 7365  The primitive se
+00002b00: 7420 7573 6564 2069 6e20 4750 0a20 2020  t used in GP.   
+00002b10: 2020 2020 206e 6f72 6d61 6c69 7a65 3a20       normalize: 
+00002b20: 4e6f 726d 616c 697a 6174 696f 6e20 6265  Normalization be
+00002b30: 666f 7265 2066 6974 7469 6e67 2061 206d  fore fitting a m
+00002b40: 6f64 656c 0a20 2020 2020 2020 2073 656c  odel.        sel
+00002b50: 6563 743a 2054 6865 206e 616d 6520 6f66  ect: The name of
+00002b60: 2074 6865 2073 656c 6563 7469 6f6e 206f   the selection o
+00002b70: 7065 7261 746f 722c 2073 7570 706f 7274  perator, support
+00002b80: 696e 6720 2254 6f75 726e 616d 656e 742d  ing "Tournament-
+00002b90: 2854 6f75 726e 616d 656e 7420 5369 7a65  (Tournament Size
+00002ba0: 2922 2c20 224c 6578 6963 6173 6522 0a20  )", "Lexicase". 
+00002bb0: 2020 2020 2020 2067 656e 655f 6e75 6d3a         gene_num:
+00002bc0: 2054 6865 206e 756d 6265 7220 6f66 2067   The number of g
+00002bd0: 656e 6573 2069 6e20 6561 6368 2047 5020  enes in each GP 
+00002be0: 696e 6469 7669 6475 616c 0a20 2020 2020  individual.     
+00002bf0: 2020 2065 6e73 656d 626c 655f 7369 7a65     ensemble_size
+00002c00: 3a20 5468 6520 7369 7a65 206f 6620 7468  : The size of th
+00002c10: 6520 656e 7365 6d62 6c65 206d 6f64 656c  e ensemble model
+00002c20: 0a20 2020 2020 2020 2065 7874 6572 6e61  .        externa
+00002c30: 6c5f 6172 6368 6976 653a 2055 7369 6e67  l_archive: Using
+00002c40: 2061 6e20 6578 7465 726e 616c 2061 7263   an external arc
+00002c50: 6869 7665 2074 6f20 7374 6f72 6520 6869  hive to store hi
+00002c60: 7374 6f72 6963 616c 2062 6573 7420 7265  storical best re
+00002c70: 7375 6c74 730a 2020 2020 2020 2020 6f72  sults.        or
+00002c80: 6967 696e 616c 5f66 6561 7475 7265 733a  iginal_features:
+00002c90: 2057 6865 7468 6572 2074 6f20 7573 6520   Whether to use 
+00002ca0: 6f72 6967 696e 616c 2066 6561 7475 7265  original feature
+00002cb0: 7320 696e 2074 6865 206d 6f64 656c 206f  s in the model o
+00002cc0: 7220 6e6f 740a 2020 2020 2020 2020 6469  r not.        di
+00002cd0: 7665 7273 6974 795f 7365 6172 6368 3a20  versity_search: 
+00002ce0: 5468 6520 6e61 6d65 2073 7472 6174 6567  The name strateg
+00002cf0: 7920 746f 2064 6972 6563 746c 7920 656e  y to directly en
+00002d00: 6861 6e63 6520 7468 6520 6469 7665 7273  hance the divers
+00002d10: 6974 790a 2020 2020 2020 2020 6372 6f73  ity.        cros
+00002d20: 735f 7062 3a20 5468 6520 7072 6f62 6162  s_pb: The probab
+00002d30: 696c 6974 7920 6f66 2063 726f 7373 6f76  ility of crossov
+00002d40: 6572 0a20 2020 2020 2020 206d 7574 6174  er.        mutat
+00002d50: 696f 6e5f 7062 3a20 5468 6520 7072 6f62  ion_pb: The prob
+00002d60: 6162 696c 6974 7920 6f66 206d 7574 6174  ability of mutat
+00002d70: 696f 6e0a 2020 2020 2020 2020 7365 636f  ion.        seco
+00002d80: 6e64 5f6c 6179 6572 3a20 5468 6520 7374  nd_layer: The st
+00002d90: 7261 7465 6779 2074 6f20 696e 6475 6365  rategy to induce
+00002da0: 2061 2073 6563 6f6e 6420 6c61 7965 7220   a second layer 
+00002db0: 746f 2061 7373 6967 6e20 6469 6666 6572  to assign differ
+00002dc0: 656e 7420 7765 6967 6874 7320 666f 7220  ent weights for 
+00002dd0: 7468 6520 6d65 6d62 6572 2069 6e20 7468  the member in th
+00002de0: 6520 656e 7365 6d62 6c65 0a20 2020 2020  e ensemble.     
+00002df0: 2020 2073 656d 616e 7469 635f 6469 7665     semantic_dive
+00002e00: 7273 6974 793a 2054 6865 2073 7472 6174  rsity: The strat
+00002e10: 6567 7920 746f 206d 6169 6e74 6169 6e20  egy to maintain 
+00002e20: 7468 6520 6469 7665 7273 6974 7920 6f66  the diversity of
+00002e30: 2074 6865 2065 6e73 656d 626c 6520 6d6f   the ensemble mo
+00002e40: 6465 6c0a 0a20 2020 2020 2020 2053 6f66  del..        Sof
+00002e50: 7420 5053 2d54 7265 6520 5061 7261 6d65  t PS-Tree Parame
+00002e60: 7465 7273 3a0a 2020 2020 2020 2020 7368  ters:.        sh
+00002e70: 6172 6564 5f70 6172 7469 7469 6f6e 5f73  ared_partition_s
+00002e80: 6368 656d 653a 2041 6c6c 2069 6e64 6976  cheme: All indiv
+00002e90: 6964 7561 6c73 2075 7365 2061 2073 6861  iduals use a sha
+00002ea0: 7265 6420 7061 7274 6974 696f 6e20 7363  red partition sc
+00002eb0: 6865 6d65 0a0a 2020 2020 2020 2020 504c  heme..        PL
+00002ec0: 2d54 7265 6520 5061 7261 6d65 7465 7273  -Tree Parameters
+00002ed0: 3a0a 2020 2020 2020 2020 6465 6369 7369  :.        decisi
+00002ee0: 6f6e 5f74 7265 655f 636f 756e 743a 204e  on_tree_count: N
+00002ef0: 756d 6265 7220 6f66 2070 6965 6365 7769  umber of piecewi
+00002f00: 7365 2074 7265 6573 2069 6e20 6120 504c  se trees in a PL
+00002f10: 2d54 7265 650a 0a20 2020 2020 2020 2045  -Tree..        E
+00002f20: 4120 5061 7261 6d65 7465 7273 3a0a 2020  A Parameters:.  
+00002f30: 2020 2020 2020 7265 6475 6374 696f 6e5f        reduction_
+00002f40: 7261 7469 6f3a 2050 7265 2d73 656c 6563  ratio: Pre-selec
+00002f50: 7469 6f6e 2062 6173 6564 206f 6e20 6669  tion based on fi
+00002f60: 6c74 6572 730a 0a20 2020 2020 2020 206d  lters..        m
+00002f70: 6170 5f65 6c69 7465 5f70 6172 616d 6574  ap_elite_paramet
+00002f80: 6572 3a20 4879 7065 722d 7061 7261 6d65  er: Hyper-parame
+00002f90: 7465 7273 2066 6f72 204d 4150 2d45 6c69  ters for MAP-Eli
+00002fa0: 7465 0a0a 2020 2020 2020 2020 6d67 705f  te..        mgp_
+00002fb0: 6d6f 6465 3a20 4120 6d6f 6475 6c61 7220  mode: A modular 
+00002fc0: 4750 2073 7973 7465 6d0a 2020 2020 2020  GP system.      
+00002fd0: 2020 2222 220a 2020 2020 2020 2020 5375    """.        Su
+00002fe0: 7272 6f67 6174 654d 6f64 656c 2e5f 5f69  rrogateModel.__i
+00002ff0: 6e69 745f 5f28 7365 6c66 290a 2020 2020  nit__(self).    
+00003000: 2020 2020 5370 6163 6550 6172 7469 7469      SpacePartiti
+00003010: 6f6e 2e5f 5f69 6e69 745f 5f28 7365 6c66  on.__init__(self
+00003020: 290a 2020 2020 2020 2020 4573 7469 6d61  ).        Estima
+00003030: 7469 6f6e 4f66 4469 7374 7269 6275 7469  tionOfDistributi
+00003040: 6f6e 2e5f 5f69 6e69 745f 5f28 7365 6c66  on.__init__(self
+00003050: 2c20 2a2a 7061 7261 6d73 290a 2020 2020  , **params).    
+00003060: 2020 2020 2320 4544 4120 6469 7374 7269      # EDA distri
+00003070: 6275 7469 6f6e 2061 7265 2073 6861 7265  bution are share
+00003080: 6420 6163 726f 7373 2064 6966 6665 7265  d across differe
+00003090: 6e74 2067 656e 6573 0a20 2020 2020 2020  nt genes.       
+000030a0: 2023 2054 6869 7320 6361 6e20 616c 6c65   # This can alle
+000030b0: 7669 6174 6520 7468 6520 6765 6e65 7469  viate the geneti
+000030c0: 6320 6472 6966 7420 6f6e 2061 2073 7065  c drift on a spe
+000030d0: 6369 6669 6320 6765 6e65 0a20 2020 2020  cific gene.     
+000030e0: 2020 2073 656c 662e 7368 6172 6564 5f65     self.shared_e
+000030f0: 6461 203d 2073 6861 7265 645f 6564 610a  da = shared_eda.
+00003100: 2020 2020 2020 2020 2320 6665 6174 7572          # featur
+00003110: 6520 626f 6f73 7469 6e67 206d 6561 6e73  e boosting means
+00003120: 2067 656e 6572 6174 6520 6461 7461 2069   generate data i
+00003130: 7465 7261 7469 7665 6c79 0a20 2020 2020  teratively.     
+00003140: 2020 2023 206f 6e6c 7920 666f 7220 7061     # only for pa
+00003150: 7273 696d 6f6e 696f 7573 206d 7574 6174  rsimonious mutat
+00003160: 696f 6e0a 2020 2020 2020 2020 7365 6c66  ion.        self
+00003170: 2e72 6964 6765 5f61 6c70 6861 7320 3d20  .ridge_alphas = 
+00003180: 7269 6467 655f 616c 7068 6173 0a20 2020  ridge_alphas.   
+00003190: 2020 2020 2073 656c 662e 7261 6e64 6f6d       self.random
+000031a0: 5f66 6978 203d 2072 616e 646f 6d5f 6669  _fix = random_fi
+000031b0: 780a 2020 2020 2020 2020 7365 6c66 2e69  x.        self.i
+000031c0: 6d70 6f72 7461 6e63 655f 7072 6f70 6167  mportance_propag
+000031d0: 6174 696f 6e20 3d20 696d 706f 7274 616e  ation = importan
+000031e0: 6365 5f70 726f 7061 6761 7469 6f6e 0a20  ce_propagation. 
+000031f0: 2020 2020 2020 2073 656c 662e 6465 6c65         self.dele
+00003200: 7465 5f6c 6f77 5f73 696d 696c 6172 6974  te_low_similarit
+00003210: 7920 3d20 6465 6c65 7465 5f6c 6f77 5f73  y = delete_low_s
+00003220: 696d 696c 6172 6974 790a 2020 2020 2020  imilarity.      
+00003230: 2020 7365 6c66 2e72 6564 756e 6461 6e74    self.redundant
+00003240: 5f68 6f66 5f73 697a 6520 3d20 7265 6475  _hof_size = redu
+00003250: 6e64 616e 745f 686f 665f 7369 7a65 0a20  ndant_hof_size. 
+00003260: 2020 2020 2020 2073 656c 662e 7061 7273         self.pars
+00003270: 696d 6f6e 696f 7573 5f70 726f 6261 6269  imonious_probabi
+00003280: 6c69 7479 203d 2070 6172 7369 6d6f 6e69  lity = parsimoni
+00003290: 6f75 735f 7072 6f62 6162 696c 6974 790a  ous_probability.
+000032a0: 2020 2020 2020 2020 7365 6c66 2e70 6f73          self.pos
+000032b0: 745f 7072 756e 655f 7468 7265 7368 6f6c  t_prune_threshol
+000032c0: 6420 3d20 706f 7374 5f70 7275 6e65 5f74  d = post_prune_t
+000032d0: 6872 6573 686f 6c64 0a20 2020 2020 2020  hreshold.       
+000032e0: 2073 656c 662e 6869 7374 6f72 6963 616c   self.historical
+000032f0: 5f6c 6172 6765 7374 203d 2030 0a20 2020  _largest = 0.   
+00003300: 2020 2020 2073 656c 662e 6869 7374 6f72       self.histor
+00003310: 6963 616c 5f73 6d61 6c6c 6573 7420 3d20  ical_smallest = 
+00003320: 6d61 7468 2e69 6e66 0a20 2020 2020 2020  math.inf.       
+00003330: 2073 656c 662e 696e 7472 6f6e 5f67 7020   self.intron_gp 
+00003340: 3d20 696e 7472 6f6e 5f67 700a 2020 2020  = intron_gp.    
+00003350: 2020 2020 7365 6c66 2e67 7261 6469 656e      self.gradien
+00003360: 745f 626f 6f73 7469 6e67 203d 2067 7261  t_boosting = gra
+00003370: 6469 656e 745f 626f 6f73 7469 6e67 0a20  dient_boosting. 
+00003380: 2020 2020 2020 2073 656c 662e 666f 7263         self.forc
+00003390: 655f 7372 5f74 7265 6520 3d20 666f 7263  e_sr_tree = forc
+000033a0: 655f 7372 5f74 7265 650a 2020 2020 2020  e_sr_tree.      
+000033b0: 2020 7365 6c66 2e62 6c6f 6174 5f63 6f6e    self.bloat_con
+000033c0: 7472 6f6c 203d 2062 6c6f 6174 5f63 6f6e  trol = bloat_con
+000033d0: 7472 6f6c 0a20 2020 2020 2020 2069 6620  trol.        if 
+000033e0: 626c 6f61 745f 636f 6e74 726f 6c20 6973  bloat_control is
+000033f0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+00003400: 2020 2020 2020 2073 656c 662e 626c 6f61         self.bloa
+00003410: 745f 636f 6e74 726f 6c5f 636f 6e66 6967  t_control_config
+00003420: 7572 6174 696f 6e20 3d20 426c 6f61 7443  uration = BloatC
+00003430: 6f6e 7472 6f6c 436f 6e66 6967 7572 6174  ontrolConfigurat
+00003440: 696f 6e28 2a2a 626c 6f61 745f 636f 6e74  ion(**bloat_cont
+00003450: 726f 6c29 0a20 2020 2020 2020 2065 6c73  rol).        els
+00003460: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+00003470: 656c 662e 626c 6f61 745f 636f 6e74 726f  elf.bloat_contro
+00003480: 6c5f 636f 6e66 6967 7572 6174 696f 6e20  l_configuration 
+00003490: 3d20 426c 6f61 7443 6f6e 7472 6f6c 436f  = BloatControlCo
+000034a0: 6e66 6967 7572 6174 696f 6e28 290a 2020  nfiguration().  
+000034b0: 2020 2020 2020 2320 6578 706c 6963 6974        # explicit
+000034c0: 6c79 2074 6f20 6d61 6b65 2073 6f6d 6520  ly to make some 
+000034d0: 6765 6e65 7320 6173 2069 6e74 726f 6e73  genes as introns
+000034e0: 0a20 2020 2020 2020 2073 656c 662e 696e  .        self.in
+000034f0: 7472 6f6e 5f74 6872 6573 686f 6c64 203d  tron_threshold =
+00003500: 2069 6e74 726f 6e5f 7468 7265 7368 6f6c   intron_threshol
+00003510: 640a 2020 2020 2020 2020 7365 6c66 2e61  d.        self.a
+00003520: 6374 6976 655f 6765 6e65 5f6e 756d 203d  ctive_gene_num =
+00003530: 2061 6374 6976 655f 6765 6e65 5f6e 756d   active_gene_num
+00003540: 0a20 2020 2020 2020 2073 656c 662e 6479  .        self.dy
+00003550: 6e61 6d69 635f 7265 6475 6374 696f 6e20  namic_reduction 
+00003560: 3d20 6479 6e61 6d69 635f 7265 6475 6374  = dynamic_reduct
+00003570: 696f 6e0a 2020 2020 2020 2020 7365 6c66  ion.        self
+00003580: 2e69 7272 656c 6576 616e 745f 6665 6174  .irrelevant_feat
+00003590: 7572 655f 7261 7469 6f20 3d20 6972 7265  ure_ratio = irre
+000035a0: 6c65 7661 6e74 5f66 6561 7475 7265 5f72  levant_feature_r
+000035b0: 6174 696f 0a20 2020 2020 2020 2073 656c  atio.        sel
+000035c0: 662e 7265 6475 6e64 616e 745f 6665 6174  f.redundant_feat
+000035d0: 7572 6573 203d 2030 0a20 2020 2020 2020  ures = 0.       
+000035e0: 2073 656c 662e 7265 6475 6e64 616e 745f   self.redundant_
+000035f0: 6665 6174 7572 6573 5f68 6973 746f 7279  features_history
+00003600: 203d 205b 5d0a 2020 2020 2020 2020 7365   = [].        se
+00003610: 6c66 2e69 7272 656c 6576 616e 745f 6665  lf.irrelevant_fe
+00003620: 6174 7572 6573 203d 2030 0a20 2020 2020  atures = 0.     
+00003630: 2020 2073 656c 662e 6972 7265 6c65 7661     self.irreleva
+00003640: 6e74 5f66 6561 7475 7265 735f 6869 7374  nt_features_hist
+00003650: 6f72 7920 3d20 5b5d 0a20 2020 2020 2020  ory = [].       
+00003660: 2073 656c 662e 6465 6c65 7465 5f69 7272   self.delete_irr
+00003670: 656c 6576 616e 7420 3d20 6465 6c65 7465  elevant = delete
+00003680: 5f69 7272 656c 6576 616e 740a 2020 2020  _irrelevant.    
+00003690: 2020 2020 7365 6c66 2e64 656c 6574 655f      self.delete_
+000036a0: 7265 6475 6e64 616e 7420 3d20 6465 6c65  redundant = dele
+000036b0: 7465 5f72 6564 756e 6461 6e74 0a20 2020  te_redundant.   
+000036c0: 2020 2020 2073 656c 662e 7265 6769 7374       self.regist
+000036d0: 6572 5f6d 7574 6174 696f 6e5f 7072 6f62  er_mutation_prob
+000036e0: 6162 696c 6974 7920 3d20 7265 6769 7374  ability = regist
+000036f0: 6572 5f6d 7574 6174 696f 6e5f 7072 6f62  er_mutation_prob
+00003700: 6162 696c 6974 790a 2020 2020 2020 2020  ability.        
+00003710: 7365 6c66 2e69 6e74 726f 6e5f 7072 6f62  self.intron_prob
+00003720: 6162 696c 6974 7920 3d20 696e 7472 6f6e  ability = intron
+00003730: 5f70 726f 6261 6269 6c69 7479 0a20 2020  _probability.   
+00003740: 2020 2020 2073 656c 662e 7374 7269 6374       self.strict
+00003750: 5f6c 6179 6572 5f6d 6770 203d 2073 7472  _layer_mgp = str
+00003760: 6963 745f 6c61 7965 725f 6d67 700a 2020  ict_layer_mgp.  
+00003770: 2020 2020 2020 7365 6c66 2e63 6f6e 7374        self.const
+00003780: 616e 745f 7479 7065 203d 2063 6f6e 7374  ant_type = const
+00003790: 616e 745f 7479 7065 0a20 2020 2020 2020  ant_type.       
+000037a0: 2073 656c 662e 6e75 6d62 6572 5f6f 665f   self.number_of_
+000037b0: 7061 7265 6e74 7320 3d20 6e75 6d62 6572  parents = number
+000037c0: 5f6f 665f 7061 7265 6e74 730a 2020 2020  _of_parents.    
+000037d0: 2020 2020 7365 6c66 2e65 6e73 656d 626c      self.ensembl
+000037e0: 655f 7072 6564 6963 7469 6f6e 203d 2065  e_prediction = e
+000037f0: 6e73 656d 626c 655f 7072 6564 6963 7469  nsemble_predicti
+00003800: 6f6e 0a20 2020 2020 2020 2073 656c 662e  on.        self.
+00003810: 6c61 7965 725f 6d67 7020 3d20 4661 6c73  layer_mgp = Fals
+00003820: 650a 2020 2020 2020 2020 6966 2069 7369  e.        if isi
+00003830: 6e73 7461 6e63 6528 6d67 705f 7363 6f70  nstance(mgp_scop
+00003840: 652c 2073 7472 293a 0a20 2020 2020 2020  e, str):.       
+00003850: 2020 2020 206d 6770 5f73 636f 7065 203d       mgp_scope =
+00003860: 2069 6e74 286d 6770 5f73 636f 7065 2e72   int(mgp_scope.r
+00003870: 6570 6c61 6365 2827 5374 7269 6374 2d27  eplace('Strict-'
+00003880: 2c20 2727 2929 0a20 2020 2020 2020 2020  , '')).         
+00003890: 2020 2023 2054 6865 2077 686f 6c65 2047     # The whole G
+000038a0: 5020 7072 6f67 7261 6d20 636f 6e73 6973  P program consis
+000038b0: 7473 206f 6620 6e20 6c61 7965 7273 0a20  ts of n layers. 
+000038c0: 2020 2020 2020 2020 2020 2023 2045 6163             # Eac
+000038d0: 6820 6c61 7965 7220 6361 6e20 6765 7420  h layer can get 
+000038e0: 696e 7075 7473 2066 726f 6d20 7072 6576  inputs from prev
+000038f0: 696f 7573 206c 6179 6572 730a 2020 2020  ious layers.    
+00003900: 2020 2020 2020 2020 7365 6c66 2e6c 6179          self.lay
+00003910: 6572 5f6d 6770 203d 2054 7275 650a 2020  er_mgp = True.  
+00003920: 2020 2020 2020 7365 6c66 2e6d 6770 5f73        self.mgp_s
+00003930: 636f 7065 203d 206d 6770 5f73 636f 7065  cope = mgp_scope
+00003940: 0a20 2020 2020 2020 2073 656c 662e 7365  .        self.se
+00003950: 6d61 6e74 6963 5f76 6172 6961 7469 6f6e  mantic_variation
+00003960: 203d 2073 656d 616e 7469 635f 7661 7269   = semantic_vari
+00003970: 6174 696f 6e0a 2020 2020 2020 2020 7365  ation.        se
+00003980: 6c66 2e6d 6162 5f70 6172 616d 6574 6572  lf.mab_parameter
+00003990: 203d 207b 7d20 6966 206d 6162 5f70 6172   = {} if mab_par
+000039a0: 616d 6574 6572 2069 7320 4e6f 6e65 2065  ameter is None e
+000039b0: 6c73 6520 6d61 625f 7061 7261 6d65 7465  lse mab_paramete
+000039c0: 720a 2020 2020 2020 2020 7365 6c66 2e76  r.        self.v
+000039d0: 616c 6964 6174 696f 6e5f 7369 7a65 203d  alidation_size =
+000039e0: 2076 616c 6964 6174 696f 6e5f 7369 7a65   validation_size
+000039f0: 0a20 2020 2020 2020 2073 656c 662e 636c  .        self.cl
+00003a00: 6173 735f 7765 6967 6874 203d 2063 6c61  ass_weight = cla
+00003a10: 7373 5f77 6569 6768 740a 2020 2020 2020  ss_weight.      
+00003a20: 2020 6966 2072 616e 646f 6d5f 7374 6174    if random_stat
+00003a30: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
+00003a40: 2020 2020 2020 2020 2020 2072 6573 6574             reset
+00003a50: 5f72 616e 646f 6d28 7261 6e64 6f6d 5f73  _random(random_s
+00003a60: 7461 7465 290a 2020 2020 2020 2020 7365  tate).        se
+00003a70: 6c66 2e72 616e 646f 6d5f 7374 6174 6520  lf.random_state 
+00003a80: 3d20 7261 6e64 6f6d 5f73 7461 7465 0a20  = random_state. 
+00003a90: 2020 2020 2020 2073 656c 662e 7265 6475         self.redu
+00003aa0: 6374 696f 6e5f 7261 7469 6f20 3d20 7265  ction_ratio = re
+00003ab0: 6475 6374 696f 6e5f 7261 7469 6f0a 2020  duction_ratio.  
+00003ac0: 2020 2020 2020 7365 6c66 2e63 6c65 6172        self.clear
+00003ad0: 696e 675f 636c 7573 7465 725f 7369 7a65  ing_cluster_size
+00003ae0: 203d 2063 6c65 6172 696e 675f 636c 7573   = clearing_clus
+00003af0: 7465 725f 7369 7a65 0a20 2020 2020 2020  ter_size.       
+00003b00: 2073 656c 662e 6d67 705f 6d6f 6465 203d   self.mgp_mode =
+00003b10: 206d 6770 5f6d 6f64 650a 2020 2020 2020   mgp_mode.      
+00003b20: 2020 7365 6c66 2e62 6173 6963 5f67 656e    self.basic_gen
+00003b30: 655f 6e75 6d20 3d20 6261 7369 635f 6765  e_num = basic_ge
+00003b40: 6e65 5f6e 756d 0a20 2020 2020 2020 2073  ne_num.        s
+00003b50: 656c 662e 6465 6369 7369 6f6e 5f74 7265  elf.decision_tre
+00003b60: 655f 636f 756e 7420 3d20 6465 6369 7369  e_count = decisi
+00003b70: 6f6e 5f74 7265 655f 636f 756e 740a 2020  on_tree_count.  
+00003b80: 2020 2020 2020 7365 6c66 2e73 6861 7265        self.share
+00003b90: 645f 7061 7274 6974 696f 6e5f 7363 6865  d_partition_sche
+00003ba0: 6d65 203d 2073 6861 7265 645f 7061 7274  me = shared_part
+00003bb0: 6974 696f 6e5f 7363 6865 6d65 0a20 2020  ition_scheme.   
+00003bc0: 2020 2020 2073 656c 662e 6f6e 6c79 5f6f       self.only_o
+00003bd0: 7269 6769 6e61 6c5f 6665 6174 7572 6573  riginal_features
+00003be0: 203d 206f 6e6c 795f 6f72 6967 696e 616c   = only_original
+00003bf0: 5f66 6561 7475 7265 730a 2020 2020 2020  _features.      
+00003c00: 2020 7365 6c66 2e69 6e69 7469 616c 5f74    self.initial_t
+00003c10: 7265 655f 7369 7a65 203d 2069 6e69 7469  ree_size = initi
+00003c20: 616c 5f74 7265 655f 7369 7a65 0a20 2020  al_tree_size.   
+00003c30: 2020 2020 2073 656c 662e 7073 5f74 7265       self.ps_tre
+00003c40: 655f 7061 7274 6974 696f 6e5f 6d6f 6465  e_partition_mode
+00003c50: 6c20 3d20 7073 5f74 7265 655f 7061 7274  l = ps_tree_part
+00003c60: 6974 696f 6e5f 6d6f 6465 6c0a 2020 2020  ition_model.    
+00003c70: 2020 2020 7365 6c66 2e70 735f 7472 6565      self.ps_tree
+00003c80: 5f63 765f 6c61 6265 6c20 3d20 7073 5f74  _cv_label = ps_t
+00003c90: 7265 655f 6376 5f6c 6162 656c 0a20 2020  ree_cv_label.   
+00003ca0: 2020 2020 2073 656c 662e 616c 6c6f 775f       self.allow_
+00003cb0: 7265 7065 7469 7469 7665 203d 2061 6c6c  repetitive = all
+00003cc0: 6f77 5f72 6570 6574 6974 6976 650a 2020  ow_repetitive.  
+00003cd0: 2020 2020 2020 7365 6c66 2e70 7265 5f73        self.pre_s
+00003ce0: 656c 6563 7469 6f6e 203d 2070 7265 5f73  election = pre_s
+00003cf0: 656c 6563 7469 6f6e 0a20 2020 2020 2020  election.       
+00003d00: 2073 656c 662e 6d61 785f 7472 6565 5f64   self.max_tree_d
+00003d10: 6570 7468 203d 206d 6178 5f74 7265 655f  epth = max_tree_
+00003d20: 6465 7074 680a 2020 2020 2020 2020 7365  depth.        se
+00003d30: 6c66 2e65 6c69 7469 736d 203d 2065 6c69  lf.elitism = eli
+00003d40: 7469 736d 0a20 2020 2020 2020 2073 656c  tism.        sel
+00003d50: 662e 7363 6f72 655f 6675 6e63 203d 2073  f.score_func = s
+00003d60: 636f 7265 5f66 756e 630a 2020 2020 2020  core_func.      
+00003d70: 2020 7365 6c66 2e6d 696e 5f73 616d 706c    self.min_sampl
+00003d80: 6573 5f6c 6561 6620 3d20 6d69 6e5f 7361  es_leaf = min_sa
+00003d90: 6d70 6c65 735f 6c65 6166 0a20 2020 2020  mples_leaf.     
+00003da0: 2020 2073 656c 662e 6d65 616e 5f6d 6f64     self.mean_mod
+00003db0: 656c 203d 206d 6561 6e5f 6d6f 6465 6c0a  el = mean_model.
+00003dc0: 2020 2020 2020 2020 7365 6c66 2e62 6173          self.bas
+00003dd0: 655f 6c65 6172 6e65 7220 3d20 6261 7365  e_learner = base
+00003de0: 5f6c 6561 726e 6572 0a20 2020 2020 2020  _learner.       
+00003df0: 2073 656c 662e 626f 6f74 7374 7261 705f   self.bootstrap_
+00003e00: 7472 6169 6e69 6e67 203d 2062 6f6f 7473  training = boots
+00003e10: 7472 6170 5f74 7261 696e 696e 670a 2020  trap_training.  
+00003e20: 2020 2020 2020 7365 6c66 2e73 656d 616e        self.seman
+00003e30: 7469 635f 6469 7665 7273 6974 7920 3d20  tic_diversity = 
+00003e40: 7365 6d61 6e74 6963 5f64 6976 6572 7369  semantic_diversi
+00003e50: 7479 0a20 2020 2020 2020 2073 656c 662e  ty.        self.
+00003e60: 656e 7365 6d62 6c65 5f73 656c 6563 7469  ensemble_selecti
+00003e70: 6f6e 203d 2065 6e73 656d 626c 655f 7365  on = ensemble_se
+00003e80: 6c65 6374 696f 6e20 6966 2073 656d 616e  lection if seman
+00003e90: 7469 635f 6469 7665 7273 6974 7920 6973  tic_diversity is
+00003ea0: 204e 6f6e 6520 656c 7365 2073 656d 616e   None else seman
+00003eb0: 7469 635f 6469 7665 7273 6974 790a 2020  tic_diversity.  
+00003ec0: 2020 2020 2020 7365 6c66 2e6f 7269 6769        self.origi
+00003ed0: 6e61 6c5f 6665 6174 7572 6573 203d 206f  nal_features = o
+00003ee0: 7269 6769 6e61 6c5f 6665 6174 7572 6573  riginal_features
+00003ef0: 0a20 2020 2020 2020 2073 656c 662e 6578  .        self.ex
+00003f00: 7465 726e 616c 5f61 7263 6869 7665 203d  ternal_archive =
+00003f10: 2065 7874 6572 6e61 6c5f 6172 6368 6976   external_archiv
+00003f20: 650a 2020 2020 2020 2020 7365 6c66 2e62  e.        self.b
+00003f30: 6f6f 7374 5f73 697a 6520 3d20 626f 6f73  oost_size = boos
+00003f40: 745f 7369 7a65 0a20 2020 2020 2020 2073  t_size.        s
+00003f50: 656c 662e 656e 7365 6d62 6c65 5f73 697a  elf.ensemble_siz
+00003f60: 6520 3d20 656e 7365 6d62 6c65 5f73 697a  e = ensemble_siz
+00003f70: 6520 6966 2062 6f6f 7374 5f73 697a 6520  e if boost_size 
+00003f80: 6973 204e 6f6e 6520 656c 7365 2069 6e74  is None else int
+00003f90: 2862 6f6f 7374 5f73 697a 6529 0a20 2020  (boost_size).   
+00003fa0: 2020 2020 2073 656c 662e 6d75 7461 7469       self.mutati
+00003fb0: 6f6e 5f73 6368 656d 6520 3d20 6d75 7461  on_scheme = muta
+00003fc0: 7469 6f6e 5f73 6368 656d 650a 2020 2020  tion_scheme.    
+00003fd0: 2020 2020 7365 6c66 2e6e 5f70 6f70 203d      self.n_pop =
+00003fe0: 206e 5f70 6f70 0a20 2020 2020 2020 2073   n_pop.        s
+00003ff0: 656c 662e 6e5f 6765 6e20 3d20 6e5f 6765  elf.n_gen = n_ge
+00004000: 6e0a 2020 2020 2020 2020 7365 6c66 2e76  n.        self.v
+00004010: 6572 626f 7365 203d 2076 6572 626f 7365  erbose = verbose
+00004020: 0a20 2020 2020 2020 2073 656c 662e 6d61  .        self.ma
+00004030: 785f 6865 6967 6874 3a20 556e 696f 6e5b  x_height: Union[
+00004040: 7374 722c 2069 6e74 5d20 3d20 6d61 785f  str, int] = max_
+00004050: 6865 6967 6874 0a20 2020 2020 2020 2073  height.        s
+00004060: 656c 662e 6d69 6e5f 6865 6967 6874 203d  elf.min_height =
+00004070: 206d 696e 5f68 6569 6768 740a 2020 2020   min_height.    
+00004080: 2020 2020 7365 6c66 2e69 6e69 7469 616c      self.initial
+00004090: 697a 6564 203d 2046 616c 7365 0a20 2020  ized = False.   
+000040a0: 2020 2020 2073 656c 662e 6576 616c 7561       self.evalua
+000040b0: 7465 645f 706f 7020 3d20 7365 7428 290a  ted_pop = set().
+000040c0: 2020 2020 2020 2020 7365 6c66 2e67 656e          self.gen
+000040d0: 6572 6174 6564 5f66 6561 7475 7265 7320  erated_features 
+000040e0: 3d20 7365 7428 290a 2020 2020 2020 2020  = set().        
+000040f0: 7365 6c66 2e70 6f70 3a20 4c69 7374 5b4d  self.pop: List[M
+00004100: 756c 7469 706c 6547 656e 6547 505d 203d  ultipleGeneGP] =
+00004110: 205b 5d0a 2020 2020 2020 2020 7365 6c66   [].        self
+00004120: 2e62 6173 6963 5f70 7269 6d69 7469 7665  .basic_primitive
+00004130: 7320 3d20 6261 7369 635f 7072 696d 6974  s = basic_primit
+00004140: 6976 6573 0a20 2020 2020 2020 2073 656c  ives.        sel
+00004150: 662e 7365 6c65 6374 203d 2073 656c 6563  f.select = selec
+00004160: 740a 2020 2020 2020 2020 7365 6c66 2e67  t.        self.g
+00004170: 656e 655f 6e75 6d20 3d20 6765 6e65 5f6e  ene_num = gene_n
+00004180: 756d 0a20 2020 2020 2020 2073 656c 662e  um.        self.
+00004190: 7061 7261 6d20 3d20 7061 7261 6d73 0a20  param = params. 
+000041a0: 2020 2020 2020 2073 656c 662e 6469 7665         self.dive
+000041b0: 7273 6974 795f 7365 6172 6368 203d 2064  rsity_search = d
+000041c0: 6976 6572 7369 7479 5f73 6561 7263 680a  iversity_search.
+000041d0: 2020 2020 2020 2020 7365 6c66 2e73 6563          self.sec
+000041e0: 6f6e 645f 6c61 7965 7220 3d20 7365 636f  ond_layer = seco
+000041f0: 6e64 5f6c 6179 6572 0a20 2020 2020 2020  nd_layer.       
+00004200: 2073 656c 662e 7465 7374 5f66 756e 3a20   self.test_fun: 
+00004210: 4c69 7374 5b54 6573 7446 756e 6374 696f  List[TestFunctio
+00004220: 6e5d 203d 2074 6573 745f 6675 6e0a 2020  n] = test_fun.  
+00004230: 2020 2020 2020 7365 6c66 2e74 7261 696e        self.train
+00004240: 5f64 6174 615f 6869 7374 6f72 7920 3d20  _data_history = 
+00004250: 5b5d 0a20 2020 2020 2020 2073 656c 662e  [].        self.
+00004260: 7465 7374 5f64 6174 615f 6869 7374 6f72  test_data_histor
+00004270: 7920 3d20 5b5d 0a20 2020 2020 2020 2023  y = [].        #
+00004280: 2061 7665 7261 6765 2066 6974 6e65 7373   average fitness
+00004290: 206f 6620 7468 6520 656e 7365 6d62 6c65   of the ensemble
+000042a0: 206d 6f64 656c 0a20 2020 2020 2020 2073   model.        s
+000042b0: 656c 662e 6172 6368 6976 655f 6669 746e  elf.archive_fitn
+000042c0: 6573 735f 6869 7374 6f72 7920 3d20 5b5d  ess_history = []
+000042d0: 0a20 2020 2020 2020 2023 2061 7665 7261  .        # avera
+000042e0: 6765 2064 6976 6572 7369 7479 206f 6620  ge diversity of 
+000042f0: 7468 6520 656e 7365 6d62 6c65 206d 6f64  the ensemble mod
+00004300: 656c 0a20 2020 2020 2020 2073 656c 662e  el.        self.
+00004310: 6172 6368 6976 655f 6469 7665 7273 6974  archive_diversit
+00004320: 795f 6869 7374 6f72 7920 3d20 5b5d 0a20  y_history = []. 
+00004330: 2020 2020 2020 2023 2061 7665 7261 6765         # average
+00004340: 2064 6976 6572 7369 7479 206f 6620 7468   diversity of th
+00004350: 6520 656e 7365 6d62 6c65 206d 6f64 656c  e ensemble model
+00004360: 0a20 2020 2020 2020 2073 656c 662e 6172  .        self.ar
+00004370: 6368 6976 655f 636f 735f 7369 6d69 6c61  chive_cos_simila
+00004380: 7269 7479 5f68 6973 746f 7279 203d 205b  rity_history = [
+00004390: 5d0a 2020 2020 2020 2020 2320 6176 6572  ].        # aver
+000043a0: 6167 6520 6669 746e 6573 7320 6f66 2074  age fitness of t
+000043b0: 6865 2070 6f70 756c 6174 696f 6e0a 2020  he population.  
+000043c0: 2020 2020 2020 7365 6c66 2e66 6974 6e65        self.fitne
+000043d0: 7373 5f68 6973 746f 7279 203d 205b 5d0a  ss_history = [].
+000043e0: 2020 2020 2020 2020 2320 6176 6572 6167          # averag
+000043f0: 6520 6469 7665 7273 6974 7920 6f66 2074  e diversity of t
+00004400: 6865 2070 6f70 756c 6174 696f 6e0a 2020  he population.  
+00004410: 2020 2020 2020 7365 6c66 2e64 6976 6572        self.diver
+00004420: 7369 7479 5f68 6973 746f 7279 203d 205b  sity_history = [
+00004430: 5d0a 2020 2020 2020 2020 2320 6176 6572  ].        # aver
+00004440: 6167 6520 636f 7369 6e65 2064 6976 6572  age cosine diver
+00004450: 7369 7479 206f 6620 7468 6520 706f 7075  sity of the popu
+00004460: 6c61 7469 6f6e 0a20 2020 2020 2020 2073  lation.        s
+00004470: 656c 662e 636f 735f 7369 6d69 6c61 7269  elf.cos_similari
+00004480: 7479 5f68 6973 746f 7279 203d 205b 5d0a  ty_history = [].
+00004490: 2020 2020 2020 2020 7365 6c66 2e74 7265          self.tre
+000044a0: 655f 6765 6e6f 7479 7069 635f 6469 7665  e_genotypic_dive
+000044b0: 7273 6974 7920 3d20 5b5d 0a20 2020 2020  rsity = [].     
+000044c0: 2020 2073 656c 662e 7472 6565 5f70 6865     self.tree_phe
+000044d0: 6e6f 7479 7069 635f 6469 7665 7273 6974  notypic_diversit
+000044e0: 7920 3d20 5b5d 0a20 2020 2020 2020 2073  y = [].        s
+000044f0: 656c 662e 6176 675f 7472 6565 5f73 697a  elf.avg_tree_siz
+00004500: 655f 6869 7374 6f72 7920 3d20 5b5d 0a20  e_history = []. 
+00004510: 2020 2020 2020 2023 2062 6573 7420 6669         # best fi
+00004520: 746e 6573 7320 6f66 2074 6865 2065 6e73  tness of the ens
+00004530: 656d 626c 6520 6d6f 6465 6c0a 2020 2020  emble model.    
+00004540: 2020 2020 7365 6c66 2e62 6573 745f 6669      self.best_fi
+00004550: 746e 6573 735f 6869 7374 6f72 7920 3d20  tness_history = 
+00004560: 5b5d 0a20 2020 2020 2020 2073 656c 662e  [].        self.
+00004570: 6f70 6572 6174 6f72 5f73 656c 6563 7469  operator_selecti
+00004580: 6f6e 5f68 6973 746f 7279 203d 205b 5d0a  on_history = [].
+00004590: 2020 2020 2020 2020 2320 6176 6572 6167          # averag
+000045a0: 6520 6669 746e 6573 7320 6f66 2069 6e64  e fitness of ind
+000045b0: 6976 6964 7561 6c73 2069 6e20 6772 6964  ividuals in grid
+000045c0: 0a20 2020 2020 2020 2073 656c 662e 656c  .        self.el
+000045d0: 6974 655f 6772 6964 5f61 7667 5f66 6974  ite_grid_avg_fit
+000045e0: 6e65 7373 5f68 6973 746f 7279 203d 205b  ness_history = [
+000045f0: 5d0a 2020 2020 2020 2020 2320 6176 6572  ].        # aver
+00004600: 6167 6520 6469 7665 7273 6974 7920 6f66  age diversity of
+00004610: 2069 6e64 6976 6964 7561 6c73 2069 6e20   individuals in 
+00004620: 6772 6964 0a20 2020 2020 2020 2073 656c  grid.        sel
+00004630: 662e 656c 6974 655f 6772 6964 5f61 7667  f.elite_grid_avg
+00004640: 5f64 6976 6572 7369 7479 5f68 6973 746f  _diversity_histo
+00004650: 7279 203d 205b 5d0a 2020 2020 2020 2020  ry = [].        
+00004660: 2320 7375 6363 6573 7366 756c 2072 6174  # successful rat
+00004670: 6520 6f66 206d 6163 726f 2d63 726f 7373  e of macro-cross
+00004680: 6f76 6572 2061 6e64 206d 6963 726f 2d63  over and micro-c
+00004690: 726f 7373 6f76 6572 0a20 2020 2020 2020  rossover.       
+000046a0: 2073 656c 662e 6d61 6372 6f5f 6372 6f73   self.macro_cros
+000046b0: 736f 7665 725f 7375 6363 6573 7366 756c  sover_successful
+000046c0: 5f72 6174 6520 3d20 5b5d 0a20 2020 2020  _rate = [].     
+000046d0: 2020 2073 656c 662e 6d69 6372 6f5f 6372     self.micro_cr
+000046e0: 6f73 736f 7665 725f 7375 6363 6573 7366  ossover_successf
+000046f0: 756c 5f72 6174 6520 3d20 5b5d 0a20 2020  ul_rate = [].   
+00004700: 2020 2020 2023 2073 7563 6365 7373 6675       # successfu
+00004710: 6c20 7261 7465 206f 6620 6372 6f73 736f  l rate of crosso
+00004720: 7665 720a 2020 2020 2020 2020 7365 6c66  ver.        self
+00004730: 2e63 726f 7373 6f76 6572 5f73 7563 6365  .crossover_succe
+00004740: 7373 6675 6c5f 7261 7465 203d 205b 5d0a  ssful_rate = [].
+00004750: 2020 2020 2020 2020 7365 6c66 2e6d 7574          self.mut
+00004760: 6174 696f 6e5f 7375 6363 6573 7366 756c  ation_successful
+00004770: 5f72 6174 6520 3d20 5b5d 0a20 2020 2020  _rate = [].     
+00004780: 2020 2023 2066 696e 616c 204d 4150 2d45     # final MAP-E
+00004790: 6c69 7465 2067 7269 640a 2020 2020 2020  lite grid.      
+000047a0: 2020 7365 6c66 2e66 696e 616c 5f65 6c69    self.final_eli
+000047b0: 7465 5f67 7269 6420 3d20 5b5d 0a20 2020  te_grid = [].   
+000047c0: 2020 2020 2073 656c 662e 6561 726c 795f       self.early_
+000047d0: 7374 6f70 203d 2065 6172 6c79 5f73 746f  stop = early_sto
+000047e0: 700a 2020 2020 2020 2020 7365 6c66 2e65  p.        self.e
+000047f0: 6e76 6972 6f6e 6d65 6e74 616c 5f73 656c  nvironmental_sel
+00004800: 6563 7469 6f6e 203d 2065 6e76 6972 6f6e  ection = environ
+00004810: 6d65 6e74 616c 5f73 656c 6563 7469 6f6e  mental_selection
+00004820: 0a20 2020 2020 2020 2073 656c 662e 6561  .        self.ea
+00004830: 6765 725f 7472 6169 6e69 6e67 203d 2065  ger_training = e
+00004840: 6167 6572 5f74 7261 696e 696e 670a 2020  ager_training.  
+00004850: 2020 2020 2020 7365 6c66 2e63 7572 7265        self.curre
+00004860: 6e74 5f68 6569 6768 7420 3d20 310a 2020  nt_height = 1.  
+00004870: 2020 2020 2020 7365 6c66 2e72 6570 6574        self.repet
+00004880: 6974 6976 655f 6665 6174 7572 655f 636f  itive_feature_co
+00004890: 756e 7420 3d20 5b5d 0a20 2020 2020 2020  unt = [].       
+000048a0: 2073 656c 662e 7573 656c 6573 735f 6665   self.useless_fe
+000048b0: 6174 7572 655f 7261 7469 6f20 3d20 7573  ature_ratio = us
+000048c0: 656c 6573 735f 6665 6174 7572 655f 7261  eless_feature_ra
+000048d0: 7469 6f0a 2020 2020 2020 2020 7365 6c66  tio.        self
+000048e0: 2e77 6569 6768 7465 645f 636f 6566 203d  .weighted_coef =
+000048f0: 2077 6569 6768 7465 645f 636f 6566 0a20   weighted_coef. 
+00004900: 2020 2020 2020 2073 656c 662e 6665 6174         self.feat
+00004910: 7572 655f 7365 6c65 6374 696f 6e20 3d20  ure_selection = 
+00004920: 6665 6174 7572 655f 7365 6c65 6374 696f  feature_selectio
+00004930: 6e0a 2020 2020 2020 2020 7365 6c66 2e63  n.        self.c
+00004940: 7620 3d20 6376 0a20 2020 2020 2020 2073  v = cv.        s
+00004950: 656c 662e 7374 6167 655f 666c 6167 203d  elf.stage_flag =
+00004960: 2046 616c 7365 0a20 2020 2020 2020 2073   False.        s
+00004970: 656c 662e 6d61 705f 656c 6974 655f 7061  elf.map_elite_pa
+00004980: 7261 6d65 7465 7220 3d20 7b7d 2069 6620  rameter = {} if 
+00004990: 6d61 705f 656c 6974 655f 7061 7261 6d65  map_elite_parame
+000049a0: 7465 7220 6973 204e 6f6e 6520 656c 7365  ter is None else
+000049b0: 206d 6170 5f65 6c69 7465 5f70 6172 616d   map_elite_param
+000049c0: 6574 6572 0a20 2020 2020 2020 2073 656c  eter.        sel
+000049d0: 662e 6e75 6d62 6572 5f6f 665f 7265 6769  f.number_of_regi
+000049e0: 7374 6572 203d 206e 756d 6265 725f 6f66  ster = number_of
+000049f0: 5f72 6567 6973 7465 720a 2020 2020 2020  _register.      
+00004a00: 2020 7365 6c66 2e63 6f72 7265 6c61 7469    self.correlati
+00004a10: 6f6e 5f74 6872 6573 686f 6c64 203d 2063  on_threshold = c
+00004a20: 6f72 7265 6c61 7469 6f6e 5f74 6872 6573  orrelation_thres
+00004a30: 686f 6c64 0a20 2020 2020 2020 2073 656c  hold.        sel
+00004a40: 662e 636f 7272 656c 6174 696f 6e5f 6d6f  f.correlation_mo
+00004a50: 6465 203d 2063 6f72 7265 6c61 7469 6f6e  de = correlation
+00004a60: 5f6d 6f64 650a 2020 2020 2020 2020 7365  _mode.        se
+00004a70: 6c66 2e6f 7574 6c69 6572 5f64 6574 6563  lf.outlier_detec
+00004a80: 7469 6f6e 203d 206f 7574 6c69 6572 5f64  tion = outlier_d
+00004a90: 6574 6563 7469 6f6e 0a20 2020 2020 2020  etection.       
+00004aa0: 2073 656c 662e 696e 7472 6f6e 5f6e 6f64   self.intron_nod
+00004ab0: 6573 5f63 6f75 6e74 6572 203d 2030 0a20  es_counter = 0. 
+00004ac0: 2020 2020 2020 2073 656c 662e 616c 6c5f         self.all_
+00004ad0: 6e6f 6465 735f 636f 756e 7465 7220 3d20  nodes_counter = 
+00004ae0: 300a 0a20 2020 2020 2020 2073 656c 662e  0..        self.
+00004af0: 6372 6f73 735f 7062 203d 2063 726f 7373  cross_pb = cross
+00004b00: 5f70 620a 2020 2020 2020 2020 7365 6c66  _pb.        self
+00004b10: 2e6d 7574 6174 696f 6e5f 7062 203d 206d  .mutation_pb = m
+00004b20: 7574 6174 696f 6e5f 7062 0a20 2020 2020  utation_pb.     
+00004b30: 2020 2073 656c 662e 6375 7272 656e 745f     self.current_
+00004b40: 6765 6e20 3d20 300a 2020 2020 2020 2020  gen = 0.        
+00004b50: 7365 6c66 2e70 6172 7469 7469 6f6e 5f6e  self.partition_n
+00004b60: 756d 6265 7220 3d20 7061 7274 6974 696f  umber = partitio
+00004b70: 6e5f 6e75 6d62 6572 0a20 2020 2020 2020  n_number.       
+00004b80: 2073 656c 662e 7073 5f74 7265 655f 6c6f   self.ps_tree_lo
+00004b90: 6361 6c5f 6d6f 6465 6c20 3d20 7073 5f74  cal_model = ps_t
+00004ba0: 7265 655f 6c6f 6361 6c5f 6d6f 6465 6c0a  ree_local_model.
+00004bb0: 2020 2020 2020 2020 7365 6c66 2e64 796e          self.dyn
+00004bc0: 616d 6963 5f70 6172 7469 7469 6f6e 203d  amic_partition =
+00004bd0: 2064 796e 616d 6963 5f70 6172 7469 7469   dynamic_partiti
+00004be0: 6f6e 0a20 2020 2020 2020 2073 656c 662e  on.        self.
+00004bf0: 6d61 785f 6c65 6166 5f6e 6f64 6573 203d  max_leaf_nodes =
+00004c00: 206d 6178 5f6c 6561 665f 6e6f 6465 730a   max_leaf_nodes.
+00004c10: 2020 2020 2020 2020 7365 6c66 2e70 735f          self.ps_
+00004c20: 7472 6565 5f72 6174 696f 203d 2070 735f  tree_ratio = ps_
+00004c30: 7472 6565 5f72 6174 696f 0a20 2020 2020  tree_ratio.     
+00004c40: 2020 2073 656c 662e 7365 6d61 6e74 6963     self.semantic
+00004c50: 5f72 6570 6169 7220 3d20 7365 6d61 6e74  _repair = semant
+00004c60: 6963 5f72 6570 6169 720a 2020 2020 2020  ic_repair.      
+00004c70: 2020 7365 6c66 2e73 7563 6365 7373 6675    self.successfu
+00004c80: 6c5f 7265 7061 6972 203d 2030 0a20 2020  l_repair = 0.   
+00004c90: 2020 2020 2073 656c 662e 6661 696c 6564       self.failed
+00004ca0: 5f72 6570 6169 7220 3d20 300a 2020 2020  _repair = 0.    
+00004cb0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00004cc0: 6528 7365 6c66 2e70 735f 7472 6565 5f72  e(self.ps_tree_r
+00004cd0: 6174 696f 2c20 7374 7229 2061 6e64 2027  atio, str) and '
+00004ce0: 496e 7465 726c 6561 7665 2720 696e 2073  Interleave' in s
+00004cf0: 656c 662e 7073 5f74 7265 655f 7261 7469  elf.ps_tree_rati
+00004d00: 6f3a 0a20 2020 2020 2020 2020 2020 2069  o:.            i
+00004d10: 6e74 6572 6c65 6176 696e 675f 7065 7269  nterleaving_peri
+00004d20: 6f64 203d 2069 6e74 286e 702e 726f 756e  od = int(np.roun
+00004d30: 6428 6e5f 6765 6e20 2f20 286e 5f67 656e  d(n_gen / (n_gen
+00004d40: 202a 2066 6c6f 6174 2873 656c 662e 7073   * float(self.ps
+00004d50: 5f74 7265 655f 7261 7469 6f2e 7265 706c  _tree_ratio.repl
+00004d60: 6163 6528 2749 6e74 6572 6c65 6176 652d  ace('Interleave-
+00004d70: 272c 2027 2729 2929 2929 0a20 2020 2020  ', ''))))).     
+00004d80: 2020 2073 656c 662e 696e 7465 726c 6561     self.interlea
+00004d90: 7669 6e67 5f70 6572 696f 6420 3d20 696e  ving_period = in
+00004da0: 7465 726c 6561 7669 6e67 5f70 6572 696f  terleaving_perio
+00004db0: 640a 2020 2020 2020 2020 7365 6c66 2e74  d.        self.t
+00004dc0: 6573 745f 6461 7461 5f73 697a 6520 3d20  est_data_size = 
+00004dd0: 300a 0a20 2020 2020 2020 2069 6620 7061  0..        if pa
+00004de0: 7261 6d73 2e67 6574 2827 7265 636f 7264  rams.get('record
+00004df0: 5f74 7261 696e 696e 675f 6461 7461 272c  _training_data',
+00004e00: 2046 616c 7365 293a 0a20 2020 2020 2020   False):.       
+00004e10: 2020 2020 2073 656c 662e 7465 7374 5f66       self.test_f
+00004e20: 756e 5b30 5d2e 7265 6772 203d 2073 656c  un[0].regr = sel
+00004e30: 660a 2020 2020 2020 2020 2020 2020 7365  f.            se
+00004e40: 6c66 2e74 6573 745f 6675 6e5b 315d 2e72  lf.test_fun[1].r
+00004e50: 6567 7220 3d20 7365 6c66 0a0a 2020 2020  egr = self..    
+00004e60: 2020 2020 7365 6c66 2e6e 6f72 6d61 6c69      self.normali
+00004e70: 7a65 203d 206e 6f72 6d61 6c69 7a65 0a20  ze = normalize. 
+00004e80: 2020 2020 2020 2073 656c 662e 7469 6d65         self.time
+00004e90: 5f73 7461 7469 7374 6963 7320 3d20 7b0a  _statistics = {.
+00004ea0: 2020 2020 2020 2020 2020 2020 2747 5020              'GP 
+00004eb0: 4576 616c 7561 7469 6f6e 273a 205b 5d2c  Evaluation': [],
+00004ec0: 0a20 2020 2020 2020 2020 2020 2027 4d4c  .            'ML
+00004ed0: 2045 7661 6c75 6174 696f 6e27 3a20 5b5d   Evaluation': []
+00004ee0: 2c0a 2020 2020 2020 2020 2020 2020 2747  ,.            'G
+00004ef0: 5020 4765 6e65 7261 7469 6f6e 273a 205b  P Generation': [
+00004f00: 5d2c 0a20 2020 2020 2020 207d 0a20 2020  ],.        }.   
+00004f10: 2020 2020 2069 6620 6e6f 726d 616c 697a       if normaliz
+00004f20: 6520 6973 2054 7275 653a 0a20 2020 2020  e is True:.     
+00004f30: 2020 2020 2020 2073 656c 662e 785f 7363         self.x_sc
+00004f40: 616c 6572 203d 2053 7461 6e64 6172 6453  aler = StandardS
+00004f50: 6361 6c65 7228 290a 2020 2020 2020 2020  caler().        
+00004f60: 2020 2020 7365 6c66 2e79 5f73 6361 6c65      self.y_scale
+00004f70: 7220 3d20 5374 616e 6461 7264 5363 616c  r = StandardScal
+00004f80: 6572 2829 0a20 2020 2020 2020 2065 6c69  er().        eli
+00004f90: 6620 6e6f 726d 616c 697a 6520 3d3d 2027  f normalize == '
+00004fa0: 4d69 6e4d 6178 273a 0a20 2020 2020 2020  MinMax':.       
+00004fb0: 2020 2020 2073 656c 662e 785f 7363 616c       self.x_scal
+00004fc0: 6572 203d 204d 696e 4d61 7853 6361 6c65  er = MinMaxScale
+00004fd0: 7228 290a 2020 2020 2020 2020 2020 2020  r().            
+00004fe0: 7365 6c66 2e79 5f73 6361 6c65 7220 3d20  self.y_scaler = 
+00004ff0: 4d69 6e4d 6178 5363 616c 6572 2829 0a20  MinMaxScaler(). 
+00005000: 2020 2020 2020 2065 6c69 6620 6e6f 726d         elif norm
+00005010: 616c 697a 6520 696e 205b 0a20 2020 2020  alize in [.     
+00005020: 2020 2020 2020 2027 4261 636b 7761 7264         'Backward
+00005030: 4469 6666 6572 656e 6365 456e 636f 6465  DifferenceEncode
+00005040: 7227 2c0a 2020 2020 2020 2020 2020 2020  r',.            
+00005050: 2742 696e 6172 7945 6e63 6f64 6572 272c  'BinaryEncoder',
+00005060: 0a20 2020 2020 2020 2020 2020 2027 4361  .            'Ca
+00005070: 7442 6f6f 7374 456e 636f 6465 7227 2c0a  tBoostEncoder',.
+00005080: 2020 2020 2020 2020 2020 2020 2743 6f75              'Cou
+00005090: 6e74 456e 636f 6465 7227 2c0a 2020 2020  ntEncoder',.    
+000050a0: 2020 2020 2020 2020 2748 6173 6869 6e67          'Hashing
+000050b0: 456e 636f 6465 7227 2c0a 2020 2020 2020  Encoder',.      
+000050c0: 2020 2020 2020 2748 656c 6d65 7274 456e        'HelmertEn
+000050d0: 636f 6465 7227 2c0a 2020 2020 2020 2020  coder',.        
+000050e0: 2020 2020 274a 616d 6573 5374 6569 6e45      'JamesSteinE
+000050f0: 6e63 6f64 6572 272c 0a20 2020 2020 2020  ncoder',.       
+00005100: 2020 2020 2027 4c65 6176 654f 6e65 4f75       'LeaveOneOu
+00005110: 7445 6e63 6f64 6572 272c 0a20 2020 2020  tEncoder',.     
+00005120: 2020 2020 2020 2027 4d45 7374 696d 6174         'MEstimat
+00005130: 6545 6e63 6f64 6572 272c 0a20 2020 2020  eEncoder',.     
+00005140: 2020 2020 2020 2027 4f6e 6548 6f74 456e         'OneHotEn
+00005150: 636f 6465 7227 2c0a 2020 2020 2020 2020  coder',.        
+00005160: 2020 2020 274f 7264 696e 616c 456e 636f      'OrdinalEnco
+00005170: 6465 7227 2c0a 2020 2020 2020 2020 2020  der',.          
+00005180: 2020 2750 6f6c 796e 6f6d 6961 6c45 6e63    'PolynomialEnc
+00005190: 6f64 6572 272c 0a20 2020 2020 2020 2020  oder',.         
+000051a0: 2020 2027 5175 616e 7469 6c65 456e 636f     'QuantileEnco
+000051b0: 6465 7227 2c0a 2020 2020 2020 2020 2020  der',.          
+000051c0: 2020 2753 756d 456e 636f 6465 7227 2c0a    'SumEncoder',.
+000051d0: 2020 2020 2020 2020 2020 2020 2753 756d              'Sum
+000051e0: 6d61 7279 456e 636f 6465 7227 2c0a 2020  maryEncoder',.  
+000051f0: 2020 2020 2020 2020 2020 2754 6172 6765            'Targe
+00005200: 7445 6e63 6f64 6572 272c 0a20 2020 2020  tEncoder',.     
+00005210: 2020 205d 3a0a 2020 2020 2020 2020 2020     ]:.          
+00005220: 2020 7365 6c66 2e78 5f73 6361 6c65 7220    self.x_scaler 
+00005230: 3d20 4665 6174 7572 6554 7261 6e73 666f  = FeatureTransfo
+00005240: 726d 6572 2865 6e63 6f64 696e 675f 7363  rmer(encoding_sc
+00005250: 6865 6d65 3d6e 6f72 6d61 6c69 7a65 290a  heme=normalize).
+00005260: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00005270: 2e79 5f73 6361 6c65 7220 3d20 5374 616e  .y_scaler = Stan
+00005280: 6461 7264 5363 616c 6572 2829 0a20 2020  dardScaler().   
+00005290: 2020 2020 2065 6c69 6620 6e6f 726d 616c       elif normal
+000052a0: 697a 6520 6973 2046 616c 7365 3a0a 2020  ize is False:.  
+000052b0: 2020 2020 2020 2020 2020 7061 7373 0a20            pass. 
+000052c0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000052d0: 2020 2020 2020 2020 2072 6169 7365 2045           raise E
+000052e0: 7863 6570 7469 6f6e 0a0a 2020 2020 2020  xception..      
+000052f0: 2020 7374 6174 6973 7469 6361 6c5f 6665    statistical_fe
+00005300: 6174 7572 6520 3d20 7365 6c66 2e70 6172  ature = self.par
+00005310: 616d 2e67 6574 2827 7374 6174 6973 7469  am.get('statisti
+00005320: 6361 6c5f 6665 6174 7572 6527 2c20 4661  cal_feature', Fa
+00005330: 6c73 6529 0a20 2020 2020 2020 2069 6620  lse).        if 
+00005340: 7374 6174 6973 7469 6361 6c5f 6665 6174  statistical_feat
+00005350: 7572 653a 0a20 2020 2020 2020 2020 2020  ure:.           
+00005360: 2066 726f 6d20 6175 746f 782e 6175 746f   from autox.auto
+00005370: 785f 636f 6d70 6574 6974 696f 6e2e 6665  x_competition.fe
+00005380: 6174 7572 655f 656e 6769 6e65 6572 2069  ature_engineer i
+00005390: 6d70 6f72 7420 4665 6174 7572 6553 7461  mport FeatureSta
+000053a0: 740a 2020 2020 2020 2020 2020 2020 636c  t.            cl
+000053b0: 6173 7320 4665 6174 7572 6553 7461 7446  ass FeatureStatF
+000053c0: 6978 6564 2846 6561 7475 7265 5374 6174  ixed(FeatureStat
+000053d0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+000053e0: 2020 2064 6566 2066 6974 5f74 7261 6e73     def fit_trans
+000053f0: 666f 726d 2873 656c 662c 2064 662c 2074  form(self, df, t
+00005400: 6172 6765 743d 4e6f 6e65 2c20 6466 5f66  arget=None, df_f
+00005410: 6561 7475 7265 5f74 7970 653d 4e6f 6e65  eature_type=None
+00005420: 2c20 7369 6c65 6e63 655f 6772 6f75 705f  , silence_group_
+00005430: 636f 6c73 3d5b 5d2c 0a20 2020 2020 2020  cols=[],.       
+00005440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005450: 2020 2020 2020 2020 2020 2073 696c 656e             silen
+00005460: 6365 5f61 6767 5f63 6f6c 733d 5b5d 2c20  ce_agg_cols=[], 
+00005470: 7365 6c65 6374 5f61 6c6c 3d54 7275 652c  select_all=True,
+00005480: 206d 6178 5f6e 756d 3d4e 6f6e 6529 3a0a   max_num=None):.
+00005490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000054a0: 2020 2020 7265 7475 726e 2073 7570 6572      return super
+000054b0: 2829 2e66 6974 5f74 7261 6e73 666f 726d  ().fit_transform
+000054c0: 2864 662c 2074 6172 6765 742c 2064 665f  (df, target, df_
+000054d0: 6665 6174 7572 655f 7479 7065 2c20 7369  feature_type, si
+000054e0: 6c65 6e63 655f 6772 6f75 705f 636f 6c73  lence_group_cols
+000054f0: 2c20 7369 6c65 6e63 655f 6167 675f 636f  , silence_agg_co
+00005500: 6c73 2c0a 2020 2020 2020 2020 2020 2020  ls,.            
+00005510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005530: 2020 2020 2073 656c 6563 745f 616c 6c2c       select_all,
+00005540: 206d 6178 5f6e 756d 290a 0a20 2020 2020   max_num)..     
+00005550: 2020 2020 2020 2073 656c 662e 785f 7363         self.x_sc
+00005560: 616c 6572 203d 2050 6970 656c 696e 6528  aler = Pipeline(
+00005570: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00005580: 2020 2822 5374 6174 6973 7469 6361 6c46    ("StatisticalF
+00005590: 6561 7475 7265 7322 2c20 4665 6174 7572  eatures", Featur
+000055a0: 6553 7461 7446 6978 6564 2829 292c 0a20  eStatFixed()),. 
+000055b0: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+000055c0: 2243 6174 6567 6f72 6963 616c 456e 636f  "CategoricalEnco
+000055d0: 6465 7222 2c20 7365 6c66 2e78 5f73 6361  der", self.x_sca
+000055e0: 6c65 7229 0a20 2020 2020 2020 2020 2020  ler).           
+000055f0: 205d 290a 0a20 2020 2020 2020 2073 656c   ])..        sel
+00005600: 662e 6e5f 7072 6f63 6573 7320 3d20 6e5f  f.n_process = n_
+00005610: 7072 6f63 6573 730a 0a20 2020 2020 2020  process..       
+00005620: 2069 6620 7365 6c66 2e62 6173 655f 6c65   if self.base_le
+00005630: 6172 6e65 7220 3d3d 2027 4e4e 273a 0a20  arner == 'NN':. 
+00005640: 2020 2020 2020 2020 2020 2023 2057 6964             # Wid
+00005650: 6526 4465 6570 0a20 2020 2020 2020 2020  e&Deep.         
+00005660: 2020 2073 656c 662e 6869 6464 656e 5f6c     self.hidden_l
+00005670: 6179 6572 7320 3d20 5b31 362c 2034 5d0a  ayers = [16, 4].
+00005680: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00005690: 2e6e 6575 7261 6c5f 6e65 7477 6f72 6b20  .neural_network 
+000056a0: 3d20 4d4c 5052 6567 7265 7373 6f72 2873  = MLPRegressor(s
+000056b0: 656c 662e 6869 6464 656e 5f6c 6179 6572  elf.hidden_layer
+000056c0: 732c 2061 6374 6976 6174 696f 6e3d 276c  s, activation='l
+000056d0: 6f67 6973 7469 6327 2c0a 2020 2020 2020  ogistic',.      
+000056e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000056f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005700: 2020 2020 2020 2020 206d 6178 5f69 7465           max_ite
+00005710: 723d 3130 3030 2c20 6561 726c 795f 7374  r=1000, early_st
+00005720: 6f70 7069 6e67 3d54 7275 6529 0a0a 2020  opping=True)..  
+00005730: 2020 2020 2020 6966 2073 656c 662e 6d75        if self.mu
+00005740: 7461 7469 6f6e 5f73 6368 656d 6520 3d3d  tation_scheme ==
+00005750: 2027 5472 616e 7366 6f72 6d65 7227 3a0a   'Transformer':.
+00005760: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00005770: 2e74 7261 6e73 666f 726d 6572 5f73 7769  .transformer_swi
+00005780: 7463 6820 3d20 5472 7565 0a20 2020 2020  tch = True.     
+00005790: 2020 2020 2020 2073 656c 662e 6d75 7461         self.muta
+000057a0: 7469 6f6e 5f73 6368 656d 6520 3d20 2775  tion_scheme = 'u
+000057b0: 6e69 666f 726d 2d70 6c75 7327 0a20 2020  niform-plus'.   
+000057c0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+000057d0: 2020 2020 2020 2073 656c 662e 7472 616e         self.tran
+000057e0: 7366 6f72 6d65 725f 7377 6974 6368 203d  sformer_switch =
+000057f0: 2046 616c 7365 0a0a 2020 2020 2020 2020   False..        
+00005800: 7365 6c66 2e6e 6f76 656c 7479 5f77 6569  self.novelty_wei
+00005810: 6768 7420 3d20 310a 2020 2020 2020 2020  ght = 1.        
+00005820: 7365 6c66 2e64 796e 616d 6963 5f74 6172  self.dynamic_tar
+00005830: 6765 7420 3d20 4661 6c73 650a 2020 2020  get = False.    
+00005840: 2020 2020 7365 6c66 2e65 6e73 656d 626c      self.ensembl
+00005850: 655f 636f 6f70 6572 6174 696f 6e20 3d20  e_cooperation = 
+00005860: 4661 6c73 650a 2020 2020 2020 2020 7365  False.        se
+00005870: 6c66 2e64 6976 6572 7369 7479 5f6d 6574  lf.diversity_met
+00005880: 7269 6320 3d20 2743 6f73 696e 6553 696d  ric = 'CosineSim
+00005890: 696c 6172 6974 7927 0a20 2020 2020 2020  ilarity'.       
+000058a0: 2069 6620 6973 696e 7374 616e 6365 2873   if isinstance(s
+000058b0: 656c 662e 7363 6f72 655f 6675 6e63 2c20  elf.score_func, 
+000058c0: 7374 7229 2061 6e64 2027 2d4b 4c27 2069  str) and '-KL' i
+000058d0: 6e20 7365 6c66 2e73 636f 7265 5f66 756e  n self.score_fun
+000058e0: 633a 0a20 2020 2020 2020 2020 2020 2073  c:.            s
+000058f0: 656c 662e 7363 6f72 655f 6675 6e63 203d  elf.score_func =
+00005900: 2073 656c 662e 7363 6f72 655f 6675 6e63   self.score_func
+00005910: 2e72 6570 6c61 6365 2827 2d4b 4c27 2c20  .replace('-KL', 
+00005920: 2727 290a 2020 2020 2020 2020 2020 2020  '').            
+00005930: 7365 6c66 2e64 6976 6572 7369 7479 5f6d  self.diversity_m
+00005940: 6574 7269 6320 3d20 274b 4c2d 4469 7665  etric = 'KL-Dive
+00005950: 7267 656e 6365 270a 0a20 2020 2020 2020  rgence'..       
+00005960: 2069 6620 7365 6c66 2e73 636f 7265 5f66   if self.score_f
+00005970: 756e 6320 3d3d 2027 4e6f 7665 6c74 7953  unc == 'NoveltyS
+00005980: 6561 7263 682d 4479 6e61 6d69 6327 3a0a  earch-Dynamic':.
+00005990: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000059a0: 2e64 796e 616d 6963 5f74 6172 6765 7420  .dynamic_target 
+000059b0: 3d20 5472 7565 0a20 2020 2020 2020 2020  = True.         
+000059c0: 2020 2073 656c 662e 7363 6f72 655f 6675     self.score_fu
+000059d0: 6e63 203d 2027 4e6f 7665 6c74 7953 6561  nc = 'NoveltySea
+000059e0: 7263 6827 0a20 2020 2020 2020 2065 6c69  rch'.        eli
+000059f0: 6620 2757 6569 6768 7465 644e 6f76 656c  f 'WeightedNovel
+00005a00: 7479 5365 6172 6368 2d27 2069 6e20 7365  tySearch-' in se
+00005a10: 6c66 2e73 636f 7265 5f66 756e 633a 0a20  lf.score_func:. 
+00005a20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00005a30: 6e6f 7665 6c74 795f 7765 6967 6874 203d  novelty_weight =
+00005a40: 2066 6c6f 6174 2873 656c 662e 7363 6f72   float(self.scor
+00005a50: 655f 6675 6e63 2e73 706c 6974 2827 2d27  e_func.split('-'
+00005a60: 295b 315d 290a 2020 2020 2020 2020 2020  )[1]).          
+00005a70: 2020 7365 6c66 2e73 636f 7265 5f66 756e    self.score_fun
+00005a80: 6320 3d20 274e 6f76 656c 7479 5365 6172  c = 'NoveltySear
+00005a90: 6368 270a 2020 2020 2020 2020 656c 6966  ch'.        elif
+00005aa0: 2027 5765 6967 6874 6564 436f 6f70 6572   'WeightedCooper
+00005ab0: 6174 696f 6e53 6561 7263 682d 2720 696e  ationSearch-' in
+00005ac0: 2073 656c 662e 7363 6f72 655f 6675 6e63   self.score_func
+00005ad0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00005ae0: 6c66 2e6e 6f76 656c 7479 5f77 6569 6768  lf.novelty_weigh
+00005af0: 7420 3d20 666c 6f61 7428 7365 6c66 2e73  t = float(self.s
+00005b00: 636f 7265 5f66 756e 632e 7370 6c69 7428  core_func.split(
+00005b10: 272d 2729 5b31 5d29 0a20 2020 2020 2020  '-')[1]).       
+00005b20: 2020 2020 2073 656c 662e 7363 6f72 655f       self.score_
+00005b30: 6675 6e63 203d 2027 4e6f 7665 6c74 7953  func = 'NoveltyS
+00005b40: 6561 7263 6827 0a20 2020 2020 2020 2020  earch'.         
+00005b50: 2020 2073 656c 662e 656e 7365 6d62 6c65     self.ensemble
+00005b60: 5f63 6f6f 7065 7261 7469 6f6e 203d 2054  _cooperation = T
+00005b70: 7275 650a 0a20 2020 2020 2020 2069 6620  rue..        if 
+00005b80: 7365 6c66 2e62 6173 655f 6c65 6172 6e65  self.base_learne
+00005b90: 7220 3d3d 2027 4879 6272 6964 273a 0a20  r == 'Hybrid':. 
+00005ba0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00005bb0: 7470 6f74 5f6d 6f64 656c 203d 2054 504f  tpot_model = TPO
+00005bc0: 5452 6567 7265 7373 6f72 2829 0a20 2020  TRegressor().   
+00005bd0: 2020 2020 2020 2020 2073 656c 662e 7470           self.tp
+00005be0: 6f74 5f6d 6f64 656c 2e5f 6669 745f 696e  ot_model._fit_in
+00005bf0: 6974 2829 0a20 2020 2020 2020 2065 6c73  it().        els
+00005c00: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+00005c10: 656c 662e 7470 6f74 5f6d 6f64 656c 203d  elf.tpot_model =
+00005c20: 204e 6f6e 650a 0a20 2020 2020 2020 2022   None..        "
+00005c30: 2222 0a20 2020 2020 2020 2053 6f6d 6520  "".        Some 
+00005c40: 7061 7261 6d65 7465 7273 2073 7570 706f  parameters suppo
+00005c50: 7274 204d 756c 7469 2d74 6173 6b20 7363  rt Multi-task sc
+00005c60: 6865 6d65 0a20 2020 2020 2020 2048 6f77  heme.        How
+00005c70: 6576 6572 2c20 736f 6d65 2070 6172 616d  ever, some param
+00005c80: 6574 6572 7320 646f 206e 6f74 2063 6f6e  eters do not con
+00005c90: 7369 6465 7220 7468 6973 0a20 2020 2020  sider this.     
+00005ca0: 2020 2022 2222 0a20 2020 2020 2020 2073     """.        s
+00005cb0: 656c 662e 6261 7365 5f6d 6f64 656c 5f64  elf.base_model_d
+00005cc0: 6963 7420 3d20 7b7d 0a20 2020 2020 2020  ict = {}.       
+00005cd0: 2069 6620 6973 696e 7374 616e 6365 2873   if isinstance(s
+00005ce0: 656c 662e 6261 7365 5f6c 6561 726e 6572  elf.base_learner
+00005cf0: 2c20 4261 7365 4573 7469 6d61 746f 7229  , BaseEstimator)
+00005d00: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00005d10: 6c66 2e62 6173 655f 6d6f 6465 6c5f 6c69  lf.base_model_li
+00005d20: 7374 203d 204e 6f6e 650a 2020 2020 2020  st = None.      
+00005d30: 2020 2020 2020 7365 6c66 2e62 6173 655f        self.base_
+00005d40: 6d6f 6465 6c5f 6469 6374 5b73 656c 662e  model_dict[self.
+00005d50: 6261 7365 5f6c 6561 726e 6572 2e5f 5f63  base_learner.__c
+00005d60: 6c61 7373 5f5f 2e5f 5f6e 616d 655f 5f5d  lass__.__name__]
+00005d70: 203d 2073 656c 662e 6261 7365 5f6c 6561   = self.base_lea
+00005d80: 726e 6572 0a20 2020 2020 2020 2020 2020  rner.           
+00005d90: 2073 656c 662e 6261 7365 5f6c 6561 726e   self.base_learn
+00005da0: 6572 203d 2073 656c 662e 6261 7365 5f6c  er = self.base_l
+00005db0: 6561 726e 6572 2e5f 5f63 6c61 7373 5f5f  earner.__class__
+00005dc0: 2e5f 5f6e 616d 655f 5f0a 2020 2020 2020  .__name__.      
+00005dd0: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
+00005de0: 6528 7365 6c66 2e62 6173 655f 6c65 6172  e(self.base_lear
+00005df0: 6e65 722c 206c 6973 7429 3a0a 2020 2020  ner, list):.    
+00005e00: 2020 2020 2020 2020 7365 6c66 2e72 6d70          self.rmp
+00005e10: 5f72 6174 696f 203d 2030 2e35 0a20 2020  _ratio = 0.5.   
+00005e20: 2020 2020 2020 2020 2073 656c 662e 6261           self.ba
+00005e30: 7365 5f6d 6f64 656c 5f64 6963 7420 3d20  se_model_dict = 
+00005e40: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+00005e50: 2020 6c65 6172 6e65 722e 5f5f 636c 6173    learner.__clas
+00005e60: 735f 5f2e 5f5f 6e61 6d65 5f5f 3a20 6c65  s__.__name__: le
+00005e70: 6172 6e65 7220 666f 7220 6c65 6172 6e65  arner for learne
+00005e80: 7220 696e 2073 656c 662e 6261 7365 5f6c  r in self.base_l
+00005e90: 6561 726e 6572 0a20 2020 2020 2020 2020  earner.         
+00005ea0: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
+00005eb0: 2073 656c 662e 6261 7365 5f6d 6f64 656c   self.base_model
+00005ec0: 5f6c 6973 7420 3d20 272c 272e 6a6f 696e  _list = ','.join
+00005ed0: 285b 6c65 6172 6e65 722e 5f5f 636c 6173  ([learner.__clas
+00005ee0: 735f 5f2e 5f5f 6e61 6d65 5f5f 2066 6f72  s__.__name__ for
+00005ef0: 206c 6561 726e 6572 2069 6e20 7365 6c66   learner in self
+00005f00: 2e62 6173 655f 6c65 6172 6e65 725d 290a  .base_learner]).
+00005f10: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
+00005f20: 662e 6261 7365 5f6c 6561 726e 6572 2e73  f.base_learner.s
+00005f30: 7461 7274 7377 6974 6828 2744 542d 4c52  tartswith('DT-LR
+00005f40: 2d27 293a 0a20 2020 2020 2020 2020 2020  -'):.           
+00005f50: 2073 656c 662e 726d 705f 7261 7469 6f20   self.rmp_ratio 
+00005f60: 3d20 666c 6f61 7428 7365 6c66 2e62 6173  = float(self.bas
+00005f70: 655f 6c65 6172 6e65 722e 7370 6c69 7428  e_learner.split(
+00005f80: 272d 2729 5b2d 315d 290a 2020 2020 2020  '-')[-1]).      
+00005f90: 2020 2020 2020 7365 6c66 2e62 6173 655f        self.base_
+00005fa0: 6c65 6172 6e65 7220 3d20 272d 272e 6a6f  learner = '-'.jo
+00005fb0: 696e 2873 656c 662e 6261 7365 5f6c 6561  in(self.base_lea
+00005fc0: 726e 6572 2e73 706c 6974 2827 2d27 295b  rner.split('-')[
+00005fd0: 3a2d 315d 290a 2020 2020 2020 2020 2020  :-1]).          
+00005fe0: 2020 7365 6c66 2e62 6173 655f 6d6f 6465    self.base_mode
+00005ff0: 6c5f 6c69 7374 203d 2027 5261 6e64 6f6d  l_list = 'Random
+00006000: 2d44 542c 4c6f 6769 7374 6963 5265 6772  -DT,LogisticRegr
+00006010: 6573 7369 6f6e 270a 2020 2020 2020 2020  ession'.        
+00006020: 656c 6966 2073 656c 662e 6261 7365 5f6c  elif self.base_l
+00006030: 6561 726e 6572 2e73 7461 7274 7377 6974  earner.startswit
+00006040: 6828 2742 616c 616e 6365 642d 4454 2d4c  h('Balanced-DT-L
+00006050: 522d 2729 3a0a 2020 2020 2020 2020 2020  R-'):.          
+00006060: 2020 7365 6c66 2e72 6d70 5f72 6174 696f    self.rmp_ratio
+00006070: 203d 2066 6c6f 6174 2873 656c 662e 6261   = float(self.ba
+00006080: 7365 5f6c 6561 726e 6572 2e73 706c 6974  se_learner.split
+00006090: 2827 2d27 295b 2d31 5d29 0a20 2020 2020  ('-')[-1]).     
+000060a0: 2020 2020 2020 2073 656c 662e 6261 7365         self.base
+000060b0: 5f6c 6561 726e 6572 203d 2027 2d27 2e6a  _learner = '-'.j
+000060c0: 6f69 6e28 7365 6c66 2e62 6173 655f 6c65  oin(self.base_le
+000060d0: 6172 6e65 722e 7370 6c69 7428 272d 2729  arner.split('-')
+000060e0: 5b3a 2d31 5d29 0a20 2020 2020 2020 2020  [:-1]).         
+000060f0: 2020 2073 656c 662e 6261 7365 5f6d 6f64     self.base_mod
+00006100: 656c 5f6c 6973 7420 3d20 2742 616c 616e  el_list = 'Balan
+00006110: 6365 642d 5261 6e64 6f6d 2d44 542c 4261  ced-Random-DT,Ba
+00006120: 6c61 6e63 6564 2d4c 6f67 6973 7469 6352  lanced-LogisticR
+00006130: 6567 7265 7373 696f 6e27 0a20 2020 2020  egression'.     
+00006140: 2020 2065 6c69 6620 7365 6c66 2e62 6173     elif self.bas
+00006150: 655f 6c65 6172 6e65 7220 3d3d 2027 4454  e_learner == 'DT
+00006160: 2d4c 5227 3a0a 2020 2020 2020 2020 2020  -LR':.          
+00006170: 2020 7365 6c66 2e72 6d70 5f72 6174 696f    self.rmp_ratio
+00006180: 203d 2030 2e35 0a20 2020 2020 2020 2020   = 0.5.         
+00006190: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+000061a0: 2873 656c 662c 2045 766f 6c75 7469 6f6e  (self, Evolution
+000061b0: 6172 7946 6f72 6573 7443 6c61 7373 6966  aryForestClassif
+000061c0: 6965 7229 3a0a 2020 2020 2020 2020 2020  ier):.          
+000061d0: 2020 2020 2020 7365 6c66 2e62 6173 655f        self.base_
+000061e0: 6d6f 6465 6c5f 6c69 7374 203d 2027 4454  model_list = 'DT
+000061f0: 2c4c 6f67 6973 7469 6352 6567 7265 7373  ,LogisticRegress
+00006200: 696f 6e27 0a20 2020 2020 2020 2020 2020  ion'.           
+00006210: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00006220: 2020 2020 2020 2073 656c 662e 6261 7365         self.base
+00006230: 5f6d 6f64 656c 5f6c 6973 7420 3d20 2744  _model_list = 'D
+00006240: 542c 5269 6467 6527 0a20 2020 2020 2020  T,Ridge'.       
+00006250: 2065 6c69 6620 7365 6c66 2e62 6173 655f   elif self.base_
+00006260: 6c65 6172 6e65 7220 3d3d 2027 5244 542d  learner == 'RDT-
+00006270: 4c52 273a 0a20 2020 2020 2020 2020 2020  LR':.           
+00006280: 2073 656c 662e 726d 705f 7261 7469 6f20   self.rmp_ratio 
+00006290: 3d20 302e 350a 2020 2020 2020 2020 2020  = 0.5.          
+000062a0: 2020 7365 6c66 2e62 6173 655f 6d6f 6465    self.base_mode
+000062b0: 6c5f 6c69 7374 203d 2027 5261 6e64 6f6d  l_list = 'Random
+000062c0: 2d44 542c 4c6f 6769 7374 6963 5265 6772  -DT,LogisticRegr
+000062d0: 6573 7369 6f6e 270a 2020 2020 2020 2020  ession'.        
+000062e0: 656c 6966 2073 656c 662e 6261 7365 5f6c  elif self.base_l
+000062f0: 6561 726e 6572 203d 3d20 2742 616c 616e  earner == 'Balan
+00006300: 6365 642d 5244 542d 4c52 273a 0a20 2020  ced-RDT-LR':.   
+00006310: 2020 2020 2020 2020 2073 656c 662e 726d           self.rm
+00006320: 705f 7261 7469 6f20 3d20 302e 350a 2020  p_ratio = 0.5.  
+00006330: 2020 2020 2020 2020 2020 7365 6c66 2e62            self.b
+00006340: 6173 655f 6d6f 6465 6c5f 6c69 7374 203d  ase_model_list =
+00006350: 2027 4261 6c61 6e63 6564 2d52 616e 646f   'Balanced-Rando
+00006360: 6d2d 4454 2c42 616c 616e 6365 642d 4c6f  m-DT,Balanced-Lo
+00006370: 6769 7374 6963 5265 6772 6573 7369 6f6e  gisticRegression
+00006380: 270a 2020 2020 2020 2020 656c 6966 2073  '.        elif s
+00006390: 656c 662e 6261 7365 5f6c 6561 726e 6572  elf.base_learner
+000063a0: 203d 3d20 2742 616c 616e 6365 642d 4454   == 'Balanced-DT
+000063b0: 2d4c 5227 3a0a 2020 2020 2020 2020 2020  -LR':.          
+000063c0: 2020 7365 6c66 2e72 6d70 5f72 6174 696f    self.rmp_ratio
+000063d0: 203d 2030 2e35 0a20 2020 2020 2020 2020   = 0.5.         
+000063e0: 2020 2073 656c 662e 6261 7365 5f6d 6f64     self.base_mod
+000063f0: 656c 5f6c 6973 7420 3d20 2742 616c 616e  el_list = 'Balan
+00006400: 6365 642d 4454 2c42 616c 616e 6365 642d  ced-DT,Balanced-
+00006410: 4c6f 6769 7374 6963 5265 6772 6573 7369  LogisticRegressi
+00006420: 6f6e 270a 2020 2020 2020 2020 656c 6966  on'.        elif
+00006430: 2073 656c 662e 6261 7365 5f6c 6561 726e   self.base_learn
+00006440: 6572 203d 3d20 2744 542d 4c47 424d 273a  er == 'DT-LGBM':
+00006450: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00006460: 662e 6261 7365 5f6d 6f64 656c 5f6c 6973  f.base_model_lis
+00006470: 7420 3d20 2752 616e 646f 6d2d 4454 2c4c  t = 'Random-DT,L
+00006480: 6967 6874 4742 4d2d 5374 756d 702c 4454  ightGBM-Stump,DT
+00006490: 270a 2020 2020 2020 2020 656c 7365 3a0a  '.        else:.
+000064a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000064b0: 2e62 6173 655f 6d6f 6465 6c5f 6c69 7374  .base_model_list
+000064c0: 203d 204e 6f6e 650a 0a20 2020 2020 2020   = None..       
+000064d0: 2064 656c 6574 655f 6b65 7973 203d 205b   delete_keys = [
+000064e0: 5d0a 2020 2020 2020 2020 666f 7220 6b20  ].        for k 
+000064f0: 696e 2070 6172 616d 732e 6b65 7973 2829  in params.keys()
+00006500: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00006510: 206b 2069 6e20 7661 7273 2873 656c 6629   k in vars(self)
+00006520: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00006530: 2020 6465 6c65 7465 5f6b 6579 732e 6170    delete_keys.ap
+00006540: 7065 6e64 286b 290a 2020 2020 2020 2020  pend(k).        
+00006550: 666f 7220 6b20 696e 2064 656c 6574 655f  for k in delete_
+00006560: 6b65 7973 3a0a 2020 2020 2020 2020 2020  keys:.          
+00006570: 2020 6465 6c20 7061 7261 6d73 5b6b 5d0a    del params[k].
+00006580: 0a20 2020 2020 2020 2023 2068 6973 746f  .        # histo
+00006590: 7279 206f 6620 6164 6170 7469 7665 2063  ry of adaptive c
+000065a0: 726f 7373 6f76 6572 2070 726f 6261 6269  rossover probabi
+000065b0: 6c69 7479 0a20 2020 2020 2020 2073 656c  lity.        sel
+000065c0: 662e 6164 6170 7469 7665 5f70 726f 6261  f.adaptive_proba
+000065d0: 6269 6c69 7479 5f68 6973 746f 7279 203d  bility_history =
+000065e0: 205b 5b5d 2c20 5b5d 5d0a 0a20 2020 2020   [[], []]..     
+000065f0: 2020 2073 656c 662e 6372 6f73 736f 7665     self.crossove
+00006600: 725f 636f 6e66 6967 7572 6174 696f 6e20  r_configuration 
+00006610: 3d20 4372 6f73 736f 7665 7243 6f6e 6669  = CrossoverConfi
+00006620: 6775 7261 7469 6f6e 280a 2020 2020 2020  guration(.      
+00006630: 2020 2020 2020 696e 7472 6f6e 5f70 6172        intron_par
+00006640: 616d 6574 6572 733d 626c 6f61 745f 636f  ameters=bloat_co
+00006650: 6e74 726f 6c2c 0a20 2020 2020 2020 2020  ntrol,.         
+00006660: 2020 202a 2a70 6172 616d 732c 0a20 2020     **params,.   
+00006670: 2020 2020 2020 2020 202a 2a76 6172 7328           **vars(
+00006680: 7365 6c66 292c 0a20 2020 2020 2020 2029  self),.        )
+00006690: 0a20 2020 2020 2020 2073 656c 662e 6d75  .        self.mu
+000066a0: 7461 7469 6f6e 5f63 6f6e 6669 6775 7261  tation_configura
+000066b0: 7469 6f6e 203d 204d 7574 6174 696f 6e43  tion = MutationC
+000066c0: 6f6e 6669 6775 7261 7469 6f6e 280a 2020  onfiguration(.  
+000066d0: 2020 2020 2020 2020 2020 2a2a 7061 7261            **para
+000066e0: 6d73 2c0a 2020 2020 2020 2020 2020 2020  ms,.            
+000066f0: 2a2a 7661 7273 2873 656c 6629 2c0a 2020  **vars(self),.  
+00006700: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00006710: 7365 6c66 2e65 7661 6c75 6174 696f 6e5f  self.evaluation_
+00006720: 636f 6e66 6967 7572 6174 696f 6e20 3d20  configuration = 
+00006730: 4576 616c 7561 7469 6f6e 436f 6e66 6967  EvaluationConfig
+00006740: 7572 6174 696f 6e28 0a20 2020 2020 2020  uration(.       
+00006750: 2020 2020 202a 2a70 6172 616d 732c 0a20       **params,. 
+00006760: 2020 2020 2020 2020 2020 202a 2a76 6172             **var
+00006770: 7328 7365 6c66 292c 0a20 2020 2020 2020  s(self),.       
+00006780: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
+00006790: 6172 6368 6976 655f 636f 6e66 6967 7572  archive_configur
+000067a0: 6174 696f 6e20 3d20 4172 6368 6976 6543  ation = ArchiveC
+000067b0: 6f6e 6669 6775 7261 7469 6f6e 280a 2020  onfiguration(.  
+000067c0: 2020 2020 2020 2020 2020 2a2a 7061 7261            **para
+000067d0: 6d73 2c0a 2020 2020 2020 2020 2020 2020  ms,.            
+000067e0: 2a2a 7661 7273 2873 656c 6629 2c0a 2020  **vars(self),.  
+000067f0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00006800: 7365 6c66 2e73 656c 6563 7469 6f6e 5f63  self.selection_c
+00006810: 6f6e 6669 6775 7261 7469 6f6e 203d 2053  onfiguration = S
+00006820: 656c 6563 7469 6f6e 436f 6e66 6967 7572  electionConfigur
+00006830: 6174 696f 6e28 0a20 2020 2020 2020 2020  ation(.         
+00006840: 2020 202a 2a70 6172 616d 732c 0a20 2020     **params,.   
+00006850: 2020 2020 2020 2020 202a 2a76 6172 7328           **vars(
+00006860: 7365 6c66 292c 0a20 2020 2020 2020 2029  self),.        )
+00006870: 0a20 2020 2020 2020 2073 656c 662e 696d  .        self.im
+00006880: 6261 6c61 6e63 6564 5f63 6f6e 6669 6775  balanced_configu
+00006890: 7261 7469 6f6e 203d 2049 6d62 616c 616e  ration = Imbalan
+000068a0: 6365 6443 6f6e 6669 6775 7261 7469 6f6e  cedConfiguration
+000068b0: 280a 2020 2020 2020 2020 2020 2020 2a2a  (.            **
+000068c0: 7061 7261 6d73 2c0a 2020 2020 2020 2020  params,.        
+000068d0: 2020 2020 2a2a 7661 7273 2873 656c 6629      **vars(self)
+000068e0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+000068f0: 2064 6566 2063 616c 6375 6c61 7465 5f64   def calculate_d
+00006900: 6976 6572 7369 7479 2873 656c 662c 2070  iversity(self, p
+00006910: 6f70 756c 6174 696f 6e29 3a0a 2020 2020  opulation):.    
+00006920: 2020 2020 696e 6473 203d 205b 5d0a 2020      inds = [].  
+00006930: 2020 2020 2020 666f 7220 7020 696e 2070        for p in p
+00006940: 6f70 756c 6174 696f 6e3a 0a20 2020 2020  opulation:.     
+00006950: 2020 2020 2020 2069 6e64 732e 6170 7065         inds.appe
+00006960: 6e64 2870 2e63 6173 655f 7661 6c75 6573  nd(p.case_values
+00006970: 2e66 6c61 7474 656e 2829 290a 2020 2020  .flatten()).    
+00006980: 2020 2020 696e 6473 203d 206e 702e 6172      inds = np.ar
+00006990: 7261 7928 696e 6473 290a 2020 2020 2020  ray(inds).      
+000069a0: 2020 7472 6565 203d 204b 4454 7265 6528    tree = KDTree(
+000069b0: 696e 6473 290a 2020 2020 2020 2020 6e65  inds).        ne
+000069c0: 6967 6862 6f72 7320 3d20 7472 6565 2e71  ighbors = tree.q
+000069d0: 7565 7279 2869 6e64 732c 206b 3d33 202b  uery(inds, k=3 +
+000069e0: 2031 295b 305d 0a20 2020 2020 2020 206d   1)[0].        m
+000069f0: 6561 6e5f 6469 7665 7273 6974 7920 3d20  ean_diversity = 
+00006a00: 6e70 2e6d 6561 6e28 6e65 6967 6862 6f72  np.mean(neighbor
+00006a10: 732c 2061 7869 733d 3129 0a20 2020 2020  s, axis=1).     
+00006a20: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
+00006a30: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00006a40: 7072 696e 7428 276d 6561 6e5f 6469 7665  print('mean_dive
+00006a50: 7273 6974 7927 2c20 6e70 2e6d 6561 6e28  rsity', np.mean(
+00006a60: 6d65 616e 5f64 6976 6572 7369 7479 2929  mean_diversity))
+00006a70: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00006a80: 6d65 616e 5f64 6976 6572 7369 7479 0a0a  mean_diversity..
+00006a90: 2020 2020 6465 6620 6f6f 625f 6572 726f      def oob_erro
+00006aa0: 7228 7365 6c66 2c20 706f 7029 3a0a 2020  r(self, pop):.  
+00006ab0: 2020 2020 2020 7072 6564 6963 7469 6f6e        prediction
+00006ac0: 203d 206e 702e 6675 6c6c 2828 6c65 6e28   = np.full((len(
+00006ad0: 706f 7029 2c20 6c65 6e28 7365 6c66 2e79  pop), len(self.y
+00006ae0: 2929 2c20 6e70 2e6e 616e 2c20 6474 7970  )), np.nan, dtyp
+00006af0: 653d 6e70 2e66 6c6f 6174 290a 2020 2020  e=np.float).    
+00006b00: 2020 2020 666f 7220 692c 2078 2069 6e20      for i, x in 
+00006b10: 656e 756d 6572 6174 6528 706f 7029 3a0a  enumerate(pop):.
+00006b20: 2020 2020 2020 2020 2020 2020 696e 6465              inde
+00006b30: 7820 3d20 782e 6f75 745f 6f66 5f62 6167  x = x.out_of_bag
+00006b40: 0a20 2020 2020 2020 2020 2020 2070 7265  .            pre
+00006b50: 6469 6374 696f 6e5b 695d 5b69 6e64 6578  diction[i][index
+00006b60: 5d20 3d20 782e 6f6f 625f 7072 6564 6963  ] = x.oob_predic
+00006b70: 7469 6f6e 0a20 2020 2020 2020 206c 6162  tion.        lab
+00006b80: 656c 203d 206e 702e 6e61 6e6d 6561 6e28  el = np.nanmean(
+00006b90: 7072 6564 6963 7469 6f6e 2c20 6178 6973  prediction, axis
+00006ba0: 3d30 290a 2020 2020 2020 2020 6c61 6265  =0).        labe
+00006bb0: 6c20 3d20 6e70 2e6e 616e 5f74 6f5f 6e75  l = np.nan_to_nu
+00006bc0: 6d28 6c61 6265 6c29 0a20 2020 2020 2020  m(label).       
+00006bd0: 2061 6363 7572 6163 7920 3d20 7232 5f73   accuracy = r2_s
+00006be0: 636f 7265 2873 656c 662e 792c 206c 6162  core(self.y, lab
+00006bf0: 656c 290a 2020 2020 2020 2020 6966 2073  el).        if s
+00006c00: 656c 662e 7665 7262 6f73 653a 0a20 2020  elf.verbose:.   
+00006c10: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+00006c20: 6f6f 6220 7363 6f72 6527 2c20 6163 6375  oob score', accu
+00006c30: 7261 6379 290a 2020 2020 2020 2020 7265  racy).        re
+00006c40: 7475 726e 2061 6363 7572 6163 790a 0a20  turn accuracy.. 
+00006c50: 2020 2064 6566 2066 6561 7475 7265 5f71     def feature_q
+00006c60: 7569 636b 5f65 7661 6c75 6174 696f 6e28  uick_evaluation(
+00006c70: 7365 6c66 2c20 6765 6e65 293a 0a20 2020  self, gene):.   
+00006c80: 2020 2020 2023 2071 7569 636b 6c79 2065       # quickly e
+00006c90: 7661 6c75 6174 6520 7365 6d61 6e74 6963  valuate semantic
+00006ca0: 2069 6e66 6f72 6d61 7469 6f6e 206f 6620   information of 
+00006cb0: 616e 2069 6e64 6976 6964 7561 6c20 6261  an individual ba
+00006cc0: 7365 6420 6f6e 2066 6972 7374 2032 3020  sed on first 20 
+00006cd0: 6461 7461 2069 7465 6d73 0a20 2020 2020  data items.     
+00006ce0: 2020 2023 2075 7361 6765 3a20 7375 7272     # usage: surr
+00006cf0: 6f67 6174 6520 6d6f 6465 6c0a 2020 2020  ogate model.    
+00006d00: 2020 2020 6675 6e63 203d 2063 6f6d 7069      func = compi
+00006d10: 6c65 2867 656e 652c 2073 656c 662e 7073  le(gene, self.ps
+00006d20: 6574 290a 2020 2020 2020 2020 5970 203d  et).        Yp =
+00006d30: 2072 6573 756c 745f 6361 6c63 756c 6174   result_calculat
+00006d40: 696f 6e28 5b66 756e 635d 2c20 7365 6c66  ion([func], self
+00006d50: 2e58 5b3a 3230 5d2c 2046 616c 7365 290a  .X[:20], False).
+00006d60: 2020 2020 2020 2020 7265 7475 726e 2074          return t
+00006d70: 7570 6c65 2859 702e 666c 6174 7465 6e28  uple(Yp.flatten(
+00006d80: 2929 0a0a 2020 2020 6465 6620 6765 745f  ))..    def get_
+00006d90: 6d6f 6465 6c5f 636f 6566 6669 6369 656e  model_coefficien
+00006da0: 7428 7365 6c66 2c20 7829 3a0a 2020 2020  t(self, x):.    
+00006db0: 2020 2020 6966 2073 656c 662e 6261 7369      if self.basi
+00006dc0: 635f 7072 696d 6974 6976 6573 203d 3d20  c_primitives == 
+00006dd0: 274d 4c27 3a0a 2020 2020 2020 2020 2020  'ML':.          
+00006de0: 2020 7269 6467 655f 203d 2078 5b27 6d6f    ridge_ = x['mo
+00006df0: 6465 6c27 5d5b 2752 6964 6765 275d 0a20  del']['Ridge']. 
+00006e00: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00006e10: 2020 2020 2020 2020 2072 6964 6765 5f20           ridge_ 
+00006e20: 3d20 785b 2752 6964 6765 275d 0a20 2020  = x['Ridge'].   
+00006e30: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00006e40: 6365 2872 6964 6765 5f2c 2050 6970 656c  ce(ridge_, Pipel
+00006e50: 696e 6529 3a0a 2020 2020 2020 2020 2020  ine):.          
+00006e60: 2020 6261 7365 5f6c 6561 726e 6572 203d    base_learner =
+00006e70: 2072 6964 6765 5f5b 2d31 5d0a 2020 2020   ridge_[-1].    
+00006e80: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00006e90: 2020 2020 2020 6261 7365 5f6c 6561 726e        base_learn
+00006ea0: 6572 203d 2072 6964 6765 5f0a 0a20 2020  er = ridge_..   
+00006eb0: 2020 2020 2069 6620 6861 7361 7474 7228       if hasattr(
+00006ec0: 6261 7365 5f6c 6561 726e 6572 2c20 2773  base_learner, 's
+00006ed0: 6861 705f 7661 6c75 6573 2729 3a0a 2020  hap_values'):.  
+00006ee0: 2020 2020 2020 2020 2020 636f 6566 203d            coef =
+00006ef0: 2062 6173 655f 6c65 6172 6e65 722e 7368   base_learner.sh
+00006f00: 6170 5f76 616c 7565 730a 2020 2020 2020  ap_values.      
+00006f10: 2020 656c 6966 2068 6173 6174 7472 2862    elif hasattr(b
+00006f20: 6173 655f 6c65 6172 6e65 722c 2027 7069  ase_learner, 'pi
+00006f30: 5f76 616c 7565 7327 293a 0a20 2020 2020  _values'):.     
+00006f40: 2020 2020 2020 2023 2070 6572 6d75 7461         # permuta
+00006f50: 7469 6f6e 2069 6d70 6f72 7461 6e63 650a  tion importance.
+00006f60: 2020 2020 2020 2020 2020 2020 636f 6566              coef
+00006f70: 203d 2062 6173 655f 6c65 6172 6e65 722e   = base_learner.
+00006f80: 7069 5f76 616c 7565 730a 2020 2020 2020  pi_values.      
+00006f90: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
+00006fa0: 6528 6261 7365 5f6c 6561 726e 6572 2c20  e(base_learner, 
+00006fb0: 284c 696e 6561 724d 6f64 656c 2c20 4c69  (LinearModel, Li
+00006fc0: 6e65 6172 436c 6173 7369 6669 6572 4d69  nearClassifierMi
+00006fd0: 7869 6e29 293a 0a20 2020 2020 2020 2020  xin)):.         
+00006fe0: 2020 2069 6620 6c65 6e28 6261 7365 5f6c     if len(base_l
+00006ff0: 6561 726e 6572 2e63 6f65 665f 2e73 6861  earner.coef_.sha
+00007000: 7065 2920 3d3d 2032 3a0a 2020 2020 2020  pe) == 2:.      
+00007010: 2020 2020 2020 2020 2020 636f 6566 203d            coef =
+00007020: 206e 702e 6d61 7828 6e70 2e61 6273 2862   np.max(np.abs(b
+00007030: 6173 655f 6c65 6172 6e65 722e 636f 6566  ase_learner.coef
+00007040: 5f29 2c20 6178 6973 3d30 295b 3a73 656c  _), axis=0)[:sel
+00007050: 662e 6765 6e65 5f6e 756d 5d0a 2020 2020  f.gene_num].    
+00007060: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00007070: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00007080: 6566 203d 206e 702e 6162 7328 6261 7365  ef = np.abs(base
+00007090: 5f6c 6561 726e 6572 2e63 6f65 665f 295b  _learner.coef_)[
+000070a0: 3a73 656c 662e 6765 6e65 5f6e 756d 5d0a  :self.gene_num].
+000070b0: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
+000070c0: 6e73 7461 6e63 6528 6261 7365 5f6c 6561  nstance(base_lea
+000070d0: 726e 6572 2c20 2842 6173 6544 6563 6973  rner, (BaseDecis
+000070e0: 696f 6e54 7265 652c 204c 4742 4d4d 6f64  ionTree, LGBMMod
+000070f0: 656c 2929 3a0a 2020 2020 2020 2020 2020  el)):.          
+00007100: 2020 636f 6566 203d 2062 6173 655f 6c65    coef = base_le
+00007110: 6172 6e65 722e 6665 6174 7572 655f 696d  arner.feature_im
+00007120: 706f 7274 616e 6365 735f 5b3a 7365 6c66  portances_[:self
+00007130: 2e67 656e 655f 6e75 6d5d 0a20 2020 2020  .gene_num].     
+00007140: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
+00007150: 6365 2862 6173 655f 6c65 6172 6e65 722c  ce(base_learner,
+00007160: 2028 4742 4454 4c52 436c 6173 7369 6669   (GBDTLRClassifi
+00007170: 6572 2929 3a0a 2020 2020 2020 2020 2020  er)):.          
+00007180: 2020 636f 6566 203d 2062 6173 655f 6c65    coef = base_le
+00007190: 6172 6e65 722e 6762 6474 5f2e 6665 6174  arner.gbdt_.feat
+000071a0: 7572 655f 696d 706f 7274 616e 6365 735f  ure_importances_
+000071b0: 5b3a 7365 6c66 2e67 656e 655f 6e75 6d5d  [:self.gene_num]
+000071c0: 0a20 2020 2020 2020 2065 6c69 6620 6973  .        elif is
+000071d0: 696e 7374 616e 6365 2862 6173 655f 6c65  instance(base_le
+000071e0: 6172 6e65 722c 2053 5652 293a 0a20 2020  arner, SVR):.   
+000071f0: 2020 2020 2020 2020 2063 6f65 6620 3d20           coef = 
+00007200: 6e70 2e6f 6e65 7328 7365 6c66 2e58 2e73  np.ones(self.X.s
+00007210: 6861 7065 5b31 5d29 0a20 2020 2020 2020  hape[1]).       
+00007220: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
+00007230: 2862 6173 655f 6c65 6172 6e65 722c 2028  (base_learner, (
+00007240: 5269 6467 6544 542c 204c 5244 5443 6c61  RidgeDT, LRDTCla
+00007250: 7373 6966 6965 7229 293a 0a20 2020 2020  ssifier)):.     
+00007260: 2020 2020 2020 2063 6f65 6620 3d20 6261         coef = ba
+00007270: 7365 5f6c 6561 726e 6572 2e66 6561 7475  se_learner.featu
+00007280: 7265 5f69 6d70 6f72 7461 6e63 650a 2020  re_importance.  
+00007290: 2020 2020 2020 656c 6966 2068 6173 6174        elif hasat
+000072a0: 7472 2862 6173 655f 6c65 6172 6e65 722c  tr(base_learner,
+000072b0: 2027 6665 6174 7572 655f 696d 706f 7274   'feature_import
+000072c0: 616e 6365 735f 2729 3a0a 2020 2020 2020  ances_'):.      
+000072d0: 2020 2020 2020 636f 6566 203d 2062 6173        coef = bas
+000072e0: 655f 6c65 6172 6e65 722e 6665 6174 7572  e_learner.featur
+000072f0: 655f 696d 706f 7274 616e 6365 735f 0a20  e_importances_. 
+00007300: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
+00007310: 7374 616e 6365 2862 6173 655f 6c65 6172  stance(base_lear
+00007320: 6e65 722c 204b 4e65 6967 6862 6f72 7352  ner, KNeighborsR
+00007330: 6567 7265 7373 6f72 293a 0a20 2020 2020  egressor):.     
+00007340: 2020 2020 2020 2023 2054 656d 706f 7261         # Tempora
+00007350: 7269 6c79 2073 6574 2061 6c6c 2066 6561  rily set all fea
+00007360: 7475 7265 7320 746f 2068 6176 6520 6571  tures to have eq
+00007370: 7561 6c20 696d 706f 7274 616e 6365 2076  ual importance v
+00007380: 616c 7565 730a 2020 2020 2020 2020 2020  alues.          
+00007390: 2020 636f 6566 203d 206e 702e 6f6e 6573    coef = np.ones
+000073a0: 2873 656c 662e 6765 6e65 5f6e 756d 290a  (self.gene_num).
+000073b0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+000073c0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+000073d0: 4578 6365 7074 696f 6e0a 2020 2020 2020  Exception.      
+000073e0: 2020 7265 7475 726e 2063 6f65 660a 0a20    return coef.. 
+000073f0: 2020 2064 6566 2066 6974 6e65 7373 5f65     def fitness_e
+00007400: 7661 6c75 6174 696f 6e28 7365 6c66 2c20  valuation(self, 
+00007410: 696e 6469 7669 6475 616c 3a20 4d75 6c74  individual: Mult
+00007420: 6970 6c65 4765 6e65 4750 293a 0a20 2020  ipleGeneGP):.   
+00007430: 2020 2020 2023 2073 696e 676c 6520 696e       # single in
+00007440: 6469 7669 6475 616c 2065 7661 6c75 6174  dividual evaluat
+00007450: 696f 6e0a 2020 2020 2020 2020 582c 2059  ion.        X, Y
+00007460: 203d 2073 656c 662e 582c 2073 656c 662e   = self.X, self.
+00007470: 790a 2020 2020 2020 2020 5920 3d20 592e  y.        Y = Y.
+00007480: 666c 6174 7465 6e28 290a 0a20 2020 2020  flatten()..     
+00007490: 2020 2023 2066 756e 6320 3d20 7365 6c66     # func = self
+000074a0: 2e74 6f6f 6c62 6f78 2e63 6f6d 7069 6c65  .toolbox.compile
+000074b0: 2869 6e64 6976 6964 7561 6c29 0a20 2020  (individual).   
+000074c0: 2020 2020 2070 6970 653a 2047 5050 6970       pipe: GPPip
+000074d0: 656c 696e 650a 2020 2020 2020 2020 6966  eline.        if
+000074e0: 2073 656c 662e 6261 7365 5f6c 6561 726e   self.base_learn
+000074f0: 6572 203d 3d20 2744 796e 616d 6963 2d44  er == 'Dynamic-D
+00007500: 5427 3a0a 2020 2020 2020 2020 2020 2020  T':.            
+00007510: 7365 6c66 2e6d 696e 5f73 616d 706c 6573  self.min_samples
+00007520: 5f6c 6561 6620 3d20 696e 6469 7669 6475  _leaf = individu
+00007530: 616c 2e64 796e 616d 6963 5f6c 6561 665f  al.dynamic_leaf_
+00007540: 7369 7a65 0a20 2020 2020 2020 2020 2020  size.           
+00007550: 2070 6970 6520 3d20 7365 6c66 2e67 6574   pipe = self.get
+00007560: 5f62 6173 655f 6d6f 6465 6c28 290a 2020  _base_model().  
+00007570: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00007580: 696e 5f73 616d 706c 6573 5f6c 6561 6620  in_samples_leaf 
+00007590: 3d20 310a 2020 2020 2020 2020 656c 6966  = 1.        elif
+000075a0: 2073 656c 662e 6261 7365 5f6c 6561 726e   self.base_learn
+000075b0: 6572 203d 3d20 2748 7962 7269 6427 3a0a  er == 'Hybrid':.
+000075c0: 2020 2020 2020 2020 2020 2020 7069 7065              pipe
+000075d0: 203d 2073 656c 662e 6765 745f 6261 7365   = self.get_base
+000075e0: 5f6d 6f64 656c 2862 6173 655f 6d6f 6465  _model(base_mode
+000075f0: 6c3d 696e 6469 7669 6475 616c 2e62 6173  l=individual.bas
+00007600: 655f 6d6f 6465 6c29 0a20 2020 2020 2020  e_model).       
+00007610: 2065 6c69 6620 7365 6c66 2e62 6173 655f   elif self.base_
+00007620: 6c65 6172 6e65 7220 696e 205b 2744 542d  learner in ['DT-
+00007630: 4c52 272c 2027 4261 6c61 6e63 6564 2d44  LR', 'Balanced-D
+00007640: 542d 4c52 272c 2027 4261 6c61 6e63 6564  T-LR', 'Balanced
+00007650: 2d52 4454 2d4c 5227 2c20 2744 542d 4c47  -RDT-LR', 'DT-LG
+00007660: 424d 272c 0a20 2020 2020 2020 2020 2020  BM',.           
+00007670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007680: 2020 2020 2020 2020 2752 4454 7e4c 6967          'RDT~Lig
+00007690: 6874 4742 4d2d 5374 756d 7027 5d20 6f72  htGBM-Stump'] or
+000076a0: 205c 0a20 2020 2020 2020 2020 2020 2069   \.            i
+000076b0: 7369 6e73 7461 6e63 6528 7365 6c66 2e62  sinstance(self.b
+000076c0: 6173 655f 6c65 6172 6e65 722c 206c 6973  ase_learner, lis
+000076d0: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
+000076e0: 7069 7065 203d 2073 656c 662e 6765 745f  pipe = self.get_
+000076f0: 6261 7365 5f6d 6f64 656c 2862 6173 655f  base_model(base_
+00007700: 6d6f 6465 6c3d 696e 6469 7669 6475 616c  model=individual
+00007710: 2e62 6173 655f 6d6f 6465 6c29 0a20 2020  .base_model).   
+00007720: 2020 2020 2065 6c69 6620 7365 6c66 2e62       elif self.b
+00007730: 6173 655f 6c65 6172 6e65 7220 3d3d 2027  ase_learner == '
+00007740: 4479 6e61 6d69 632d 4c6f 6769 7374 6963  Dynamic-Logistic
+00007750: 5265 6772 6573 7369 6f6e 273a 0a20 2020  Regression':.   
+00007760: 2020 2020 2020 2020 2070 6970 6520 3d20           pipe = 
+00007770: 7365 6c66 2e67 6574 5f62 6173 655f 6d6f  self.get_base_mo
+00007780: 6465 6c28 7265 6775 6c61 7269 7a61 7469  del(regularizati
+00007790: 6f6e 5f72 6174 696f 3d69 6e64 6976 6964  on_ratio=individ
+000077a0: 7561 6c2e 6479 6e61 6d69 635f 7265 6775  ual.dynamic_regu
+000077b0: 6c61 7269 7a61 7469 6f6e 290a 2020 2020  larization).    
+000077c0: 2020 2020 656c 6966 2073 656c 662e 6261      elif self.ba
+000077d0: 7365 5f6c 6561 726e 6572 203d 3d20 2741  se_learner == 'A
+000077e0: 6461 7074 6976 654c 6173 736f 273a 0a20  daptiveLasso':. 
+000077f0: 2020 2020 2020 2020 2020 2070 6970 6520             pipe 
+00007800: 3d20 7365 6c66 2e67 6574 5f62 6173 655f  = self.get_base_
+00007810: 6d6f 6465 6c28 6c61 7373 6f5f 616c 7068  model(lasso_alph
+00007820: 613d 6e70 2e70 6f77 6572 2831 302c 2069  a=np.power(10, i
+00007830: 6e64 6976 6964 7561 6c2e 7061 7261 6d65  ndividual.parame
+00007840: 7465 7273 5b27 4c61 7373 6f27 5d29 290a  ters['Lasso'])).
+00007850: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00007860: 2020 2020 2020 2020 2020 7069 7065 203d            pipe =
+00007870: 2073 656c 662e 6765 745f 6261 7365 5f6d   self.get_base_m
+00007880: 6f64 656c 2829 0a0a 2020 2020 2020 2020  odel()..        
+00007890: 6966 2073 656c 662e 6261 7365 5f6c 6561  if self.base_lea
+000078a0: 726e 6572 203d 3d20 2753 6f66 742d 504c  rner == 'Soft-PL
+000078b0: 5472 6565 273a 0a20 2020 2020 2020 2020  Tree':.         
+000078c0: 2020 2070 6970 652e 7061 7274 6974 696f     pipe.partitio
+000078d0: 6e5f 7363 6865 6d65 203d 2069 6e64 6976  n_scheme = indiv
+000078e0: 6964 7561 6c2e 7061 7274 6974 696f 6e5f  idual.partition_
+000078f0: 7363 6865 6d65 0a0a 2020 2020 2020 2020  scheme..        
+00007900: 6966 2073 656c 662e 6d67 705f 6d6f 6465  if self.mgp_mode
+00007910: 203d 3d20 2752 6567 6973 7465 7227 3a0a   == 'Register':.
+00007920: 2020 2020 2020 2020 2020 2020 7069 7065              pipe
+00007930: 2e72 6567 6973 7465 7220 3d20 696e 6469  .register = indi
+00007940: 7669 6475 616c 2e70 6172 616d 6574 6572  vidual.parameter
+00007950: 735b 2752 6567 6973 7465 7227 5d0a 0a20  s['Register'].. 
+00007960: 2020 2020 2020 2069 6620 7365 6c66 2e69         if self.i
+00007970: 6e74 726f 6e5f 7072 6f62 6162 696c 6974  ntron_probabilit
+00007980: 7920 3e20 303a 0a20 2020 2020 2020 2020  y > 0:.         
+00007990: 2020 2070 6970 652e 6163 7469 7665 5f67     pipe.active_g
+000079a0: 656e 6520 3d20 696e 6469 7669 6475 616c  ene = individual
+000079b0: 2e61 6374 6976 655f 6765 6e65 0a0a 2020  .active_gene..  
+000079c0: 2020 2020 2020 2320 7365 6e64 2074 6173        # send tas
+000079d0: 6b20 746f 2074 6865 206a 6f62 2070 6f6f  k to the job poo
+000079e0: 6c20 616e 6420 7761 6974 696e 6720 7265  l and waiting re
+000079f0: 7375 6c74 730a 2020 2020 2020 2020 6966  sults.        if
+00007a00: 2069 6e64 6976 6964 7561 6c2e 6163 7469   individual.acti
+00007a10: 7665 5f67 656e 655f 6e75 6d20 3e20 303a  ve_gene_num > 0:
+00007a20: 0a20 2020 2020 2020 2020 2020 2067 656e  .            gen
+00007a30: 6573 203d 2069 6e64 6976 6964 7561 6c2e  es = individual.
+00007a40: 6765 6e65 5b3a 696e 6469 7669 6475 616c  gene[:individual
+00007a50: 2e61 6374 6976 655f 6765 6e65 5f6e 756d  .active_gene_num
+00007a60: 5d0a 2020 2020 2020 2020 656c 7365 3a0a  ].        else:.
+00007a70: 2020 2020 2020 2020 2020 2020 6765 6e65              gene
+00007a80: 7320 3d20 696e 6469 7669 6475 616c 2e67  s = individual.g
+00007a90: 656e 650a 0a20 2020 2020 2020 2069 6e66  ene..        inf
+00007aa0: 6f72 6d61 7469 6f6e 3a20 4576 616c 7561  ormation: Evalua
+00007ab0: 7469 6f6e 5265 7375 6c74 730a 2020 2020  tionResults.    
+00007ac0: 2020 2020 6966 2073 656c 662e 6e5f 7072      if self.n_pr
+00007ad0: 6f63 6573 7320 3e20 313a 0a20 2020 2020  ocess > 1:.     
+00007ae0: 2020 2020 2020 2079 5f70 7265 642c 2065         y_pred, e
+00007af0: 7374 696d 6174 6f72 732c 2069 6e66 6f72  stimators, infor
+00007b00: 6d61 7469 6f6e 203d 2079 6965 6c64 2070  mation = yield p
+00007b10: 6970 652c 2064 696c 6c2e 6475 6d70 7328  ipe, dill.dumps(
+00007b20: 6765 6e65 732c 2070 726f 746f 636f 6c3d  genes, protocol=
+00007b30: 2d31 290a 2020 2020 2020 2020 656c 7365  -1).        else
+00007b40: 3a0a 2020 2020 2020 2020 2020 2020 795f  :.            y_
+00007b50: 7072 6564 2c20 6573 7469 6d61 746f 7273  pred, estimators
+00007b60: 2c20 696e 666f 726d 6174 696f 6e20 3d20  , information = 
+00007b70: 7969 656c 6420 7069 7065 2c20 6765 6e65  yield pipe, gene
+00007b80: 730a 0a20 2020 2020 2020 2069 6620 6c65  s..        if le
+00007b90: 6e28 795f 7072 6564 2e73 6861 7065 2920  n(y_pred.shape) 
+00007ba0: 3d3d 2032 2061 6e64 2079 5f70 7265 642e  == 2 and y_pred.
+00007bb0: 7368 6170 655b 315d 203d 3d20 313a 0a20  shape[1] == 1:. 
+00007bc0: 2020 2020 2020 2020 2020 2079 5f70 7265             y_pre
+00007bd0: 6420 3d20 795f 7072 6564 2e66 6c61 7474  d = y_pred.flatt
+00007be0: 656e 2829 0a20 2020 2020 2020 2069 6620  en().        if 
+00007bf0: 6e6f 7420 2743 5627 2069 6e20 7365 6c66  not 'CV' in self
+00007c00: 2e73 636f 7265 5f66 756e 633a 0a20 2020  .score_func:.   
+00007c10: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00007c20: 2e65 7661 6c75 6174 696f 6e5f 636f 6e66  .evaluation_conf
+00007c30: 6967 7572 6174 696f 6e2e 6d69 6e69 5f62  iguration.mini_b
+00007c40: 6174 6368 3a0a 2020 2020 2020 2020 2020  atch:.          
+00007c50: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
+00007c60: 2879 5f70 7265 6429 203d 3d20 7365 6c66  (y_pred) == self
+00007c70: 2e65 7661 6c75 6174 696f 6e5f 636f 6e66  .evaluation_conf
+00007c80: 6967 7572 6174 696f 6e2e 6261 7463 685f  iguration.batch_
+00007c90: 7369 7a65 2c20 5c0a 2020 2020 2020 2020  size, \.        
+00007ca0: 2020 2020 2020 2020 2020 2020 286c 656e              (len
+00007cb0: 2879 5f70 7265 6429 2c20 7365 6c66 2e65  (y_pred), self.e
+00007cc0: 7661 6c75 6174 696f 6e5f 636f 6e66 6967  valuation_config
+00007cd0: 7572 6174 696f 6e2e 6261 7463 685f 7369  uration.batch_si
+00007ce0: 7a65 290a 2020 2020 2020 2020 2020 2020  ze).            
+00007cf0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00007d00: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
+00007d10: 2879 5f70 7265 6429 203d 3d20 6c65 6e28  (y_pred) == len(
+00007d20: 5929 2c20 286c 656e 2879 5f70 7265 6429  Y), (len(y_pred)
+00007d30: 2c20 6c65 6e28 5929 290a 2020 2020 2020  , len(Y)).      
+00007d40: 2020 696e 6469 7669 6475 616c 2e65 7661    individual.eva
+00007d50: 6c75 6174 696f 6e5f 7469 6d65 203d 2069  luation_time = i
+00007d60: 6e66 6f72 6d61 7469 6f6e 2e67 705f 6576  nformation.gp_ev
+00007d70: 616c 7561 7469 6f6e 5f74 696d 6520 2b20  aluation_time + 
+00007d80: 696e 666f 726d 6174 696f 6e2e 6d6c 5f65  information.ml_e
+00007d90: 7661 6c75 6174 696f 6e5f 7469 6d65 0a20  valuation_time. 
+00007da0: 2020 2020 2020 2073 656c 662e 7469 6d65         self.time
+00007db0: 5f73 7461 7469 7374 6963 735b 2747 5020  _statistics['GP 
+00007dc0: 4576 616c 7561 7469 6f6e 275d 2e61 7070  Evaluation'].app
+00007dd0: 656e 6428 696e 666f 726d 6174 696f 6e2e  end(information.
+00007de0: 6770 5f65 7661 6c75 6174 696f 6e5f 7469  gp_evaluation_ti
+00007df0: 6d65 290a 2020 2020 2020 2020 7365 6c66  me).        self
+00007e00: 2e74 696d 655f 7374 6174 6973 7469 6373  .time_statistics
+00007e10: 5b27 4d4c 2045 7661 6c75 6174 696f 6e27  ['ML Evaluation'
+00007e20: 5d2e 6170 7065 6e64 2869 6e66 6f72 6d61  ].append(informa
+00007e30: 7469 6f6e 2e6d 6c5f 6576 616c 7561 7469  tion.ml_evaluati
+00007e40: 6f6e 5f74 696d 6529 0a0a 2020 2020 2020  on_time)..      
+00007e50: 2020 2320 6361 6c63 756c 6174 6520 7465    # calculate te
+00007e60: 726d 696e 616c 2069 6d70 6f72 7461 6e63  rminal importanc
+00007e70: 6520 6261 7365 6420 6f6e 2074 6865 2070  e based on the p
+00007e80: 6572 6d75 7461 7469 6f6e 2069 6d70 6f72  ermutation impor
+00007e90: 7461 6e63 6520 6d65 7468 6f64 0a20 2020  tance method.   
+00007ea0: 2020 2020 2069 6620 7365 6c66 2e6d 7574       if self.mut
+00007eb0: 6174 696f 6e5f 7363 6865 6d65 203d 3d20  ation_scheme == 
+00007ec0: 2745 4441 2d54 6572 6d69 6e61 6c2d 504d  'EDA-Terminal-PM
+00007ed0: 4927 3a0a 2020 2020 2020 2020 2020 2020  I':.            
+00007ee0: 696e 6469 7669 6475 616c 2e65 7374 696d  individual.estim
+00007ef0: 6174 6f72 7320 3d20 6573 7469 6d61 746f  ators = estimato
+00007f00: 7273 0a0a 2020 2020 2020 2020 6966 2073  rs..        if s
+00007f10: 656c 662e 6261 7365 5f6c 6561 726e 6572  elf.base_learner
+00007f20: 203d 3d20 2744 542d 5261 6e64 6f6d 4454   == 'DT-RandomDT
+00007f30: 273a 0a20 2020 2020 2020 2020 2020 2073  ':.            s
+00007f40: 656c 662e 6261 7365 5f6c 6561 726e 6572  elf.base_learner
+00007f50: 203d 2027 5261 6e64 6f6d 2d44 5427 0a20   = 'Random-DT'. 
+00007f60: 2020 2020 2020 2020 2020 2069 6e64 6976             indiv
+00007f70: 6964 7561 6c2e 7069 7065 203d 2073 656c  idual.pipe = sel
+00007f80: 662e 6765 745f 6261 7365 5f6d 6f64 656c  f.get_base_model
+00007f90: 2829 0a20 2020 2020 2020 2020 2020 2073  ().            s
+00007fa0: 656c 662e 6261 7365 5f6c 6561 726e 6572  elf.base_learner
+00007fb0: 203d 2027 4454 2d52 616e 646f 6d44 5427   = 'DT-RandomDT'
+00007fc0: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
+00007fd0: 6c66 2e62 6173 655f 6c65 6172 6e65 7220  lf.base_learner 
+00007fe0: 3d3d 2027 5261 6e64 6f6d 4454 2d44 5427  == 'RandomDT-DT'
+00007ff0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00008000: 6c66 2e62 6173 655f 6c65 6172 6e65 7220  lf.base_learner 
+00008010: 3d20 2744 5427 0a20 2020 2020 2020 2020  = 'DT'.         
+00008020: 2020 2069 6e64 6976 6964 7561 6c2e 7069     individual.pi
+00008030: 7065 203d 2073 656c 662e 6765 745f 6261  pe = self.get_ba
+00008040: 7365 5f6d 6f64 656c 2829 0a20 2020 2020  se_model().     
+00008050: 2020 2020 2020 2073 656c 662e 6261 7365         self.base
+00008060: 5f6c 6561 726e 6572 203d 2027 5261 6e64  _learner = 'Rand
+00008070: 6f6d 4454 2d44 5427 0a20 2020 2020 2020  omDT-DT'.       
+00008080: 2065 6c69 6620 7365 6c66 2e62 6173 655f   elif self.base_
+00008090: 6c65 6172 6e65 7220 3d3d 2027 5369 6d70  learner == 'Simp
+000080a0: 6c65 4454 2d52 616e 646f 6d44 5427 3a0a  leDT-RandomDT':.
+000080b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000080c0: 2e62 6173 655f 6c65 6172 6e65 7220 3d20  .base_learner = 
+000080d0: 2752 616e 646f 6d2d 4454 270a 2020 2020  'Random-DT'.    
+000080e0: 2020 2020 2020 2020 696e 6469 7669 6475          individu
+000080f0: 616c 2e70 6970 6520 3d20 7365 6c66 2e67  al.pipe = self.g
+00008100: 6574 5f62 6173 655f 6d6f 6465 6c28 290a  et_base_model().
+00008110: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00008120: 2e62 6173 655f 6c65 6172 6e65 7220 3d20  .base_learner = 
+00008130: 2753 696d 706c 6544 542d 5261 6e64 6f6d  'SimpleDT-Random
+00008140: 4454 270a 2020 2020 2020 2020 656c 7365  DT'.        else
+00008150: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00008160: 2073 656c 662e 6376 203d 3d20 313a 0a20   self.cv == 1:. 
+00008170: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00008180: 6e64 6976 6964 7561 6c2e 7069 7065 203d  ndividual.pipe =
+00008190: 2065 7374 696d 6174 6f72 735b 305d 0a20   estimators[0]. 
+000081a0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+000081b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000081c0: 2069 6e64 6976 6964 7561 6c2e 7069 7065   individual.pipe
+000081d0: 203d 2070 6970 650a 0a20 2020 2020 2020   = pipe..       
+000081e0: 2069 6620 7365 6c66 2e62 6f6f 7473 7472   if self.bootstr
+000081f0: 6170 5f74 7261 696e 696e 6720 6f72 2073  ap_training or s
+00008200: 656c 662e 6561 6765 725f 7472 6169 6e69  elf.eager_traini
+00008210: 6e67 3a0a 2020 2020 2020 2020 2020 2020  ng:.            
+00008220: 5970 203d 2071 7569 636b 5f72 6573 756c  Yp = quick_resul
+00008230: 745f 6361 6c63 756c 6174 696f 6e28 6765  t_calculation(ge
+00008240: 6e65 732c 2073 656c 662e 7073 6574 2c20  nes, self.pset, 
+00008250: 582c 2073 656c 662e 6f72 6967 696e 616c  X, self.original
+00008260: 5f66 6561 7475 7265 732c 0a20 2020 2020  _features,.     
+00008270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008290: 2020 2020 2073 6b6c 6561 726e 5f66 6f72       sklearn_for
+000082a0: 6d61 743d 7365 6c66 2e62 6173 6963 5f70  mat=self.basic_p
+000082b0: 7269 6d69 7469 7665 7320 3d3d 2027 4d4c  rimitives == 'ML
+000082c0: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+000082d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000082e0: 2020 2020 2020 2020 2020 2020 2072 6567               reg
+000082f0: 6973 7465 725f 6172 7261 793d 696e 6469  ister_array=indi
+00008300: 7669 6475 616c 2e70 6172 616d 6574 6572  vidual.parameter
+00008310: 735b 2752 6567 6973 7465 7227 5d0a 2020  s['Register'].  
+00008320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008340: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00008350: 6d67 705f 6d6f 6465 203d 3d20 2752 6567  mgp_mode == 'Reg
+00008360: 6973 7465 7227 2065 6c73 6520 4e6f 6e65  ister' else None
+00008370: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00008380: 6c66 2e74 7261 696e 5f66 696e 616c 5f6d  lf.train_final_m
+00008390: 6f64 656c 2869 6e64 6976 6964 7561 6c2c  odel(individual,
+000083a0: 2059 702c 2059 290a 0a20 2020 2020 2020   Yp, Y)..       
+000083b0: 2069 6620 7365 6c66 2e62 6f6f 7473 7472   if self.bootstr
+000083c0: 6170 5f74 7261 696e 696e 673a 0a20 2020  ap_training:.   
+000083d0: 2020 2020 2020 2020 2023 2063 616c 6375           # calcu
+000083e0: 6c61 7465 2070 7265 6469 6374 696f 6e0a  late prediction.
+000083f0: 2020 2020 2020 2020 2020 2020 5970 5f6f              Yp_o
+00008400: 6f62 203d 2059 705b 696e 6469 7669 6475  ob = Yp[individu
+00008410: 616c 2e6f 7574 5f6f 665f 6261 675d 0a20  al.out_of_bag]. 
+00008420: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+00008430: 696e 7374 616e 6365 2873 656c 662c 2043  instance(self, C
+00008440: 6c61 7373 6966 6965 724d 6978 696e 293a  lassifierMixin):
+00008450: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008460: 2069 6e64 6976 6964 7561 6c2e 6f6f 625f   individual.oob_
+00008470: 7072 6564 6963 7469 6f6e 203d 2069 6e64  prediction = ind
+00008480: 6976 6964 7561 6c2e 7069 7065 2e70 7265  ividual.pipe.pre
+00008490: 6469 6374 5f70 726f 6261 2859 705f 6f6f  dict_proba(Yp_oo
+000084a0: 6229 0a20 2020 2020 2020 2020 2020 2065  b).            e
+000084b0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+000084c0: 2020 2020 2069 6e64 6976 6964 7561 6c2e       individual.
+000084d0: 6f6f 625f 7072 6564 6963 7469 6f6e 203d  oob_prediction =
+000084e0: 2069 6e64 6976 6964 7561 6c2e 7069 7065   individual.pipe
+000084f0: 2e70 7265 6469 6374 2859 705f 6f6f 6229  .predict(Yp_oob)
+00008500: 0a0a 2020 2020 2020 2020 696e 6469 7669  ..        indivi
+00008510: 6475 616c 2e70 7265 6469 6374 6564 5f76  dual.predicted_v
+00008520: 616c 7565 7320 3d20 795f 7072 6564 0a0a  alues = y_pred..
+00008530: 2020 2020 2020 2020 2320 6d69 6e69 6d69          # minimi
+00008540: 7a65 206f 626a 6563 7469 7665 2066 756e  ze objective fun
+00008550: 6374 696f 6e0a 2020 2020 2020 2020 6966  ction.        if
+00008560: 2073 656c 662e 6576 616c 7561 7469 6f6e   self.evaluation
+00008570: 5f63 6f6e 6669 6775 7261 7469 6f6e 2e6d  _configuration.m
+00008580: 696e 695f 6261 7463 683a 0a20 2020 2020  ini_batch:.     
+00008590: 2020 2020 2020 206d 696e 695f 6261 7463         mini_batc
+000085a0: 685f 7920 3d20 7365 6c66 2e67 6574 5f6d  h_y = self.get_m
+000085b0: 696e 695f 6261 7463 685f 7928 290a 2020  ini_batch_y().  
+000085c0: 2020 2020 2020 2020 2020 7365 6c66 2e63            self.c
+000085d0: 616c 6375 6c61 7465 5f63 6173 655f 7661  alculate_case_va
+000085e0: 6c75 6573 2869 6e64 6976 6964 7561 6c2c  lues(individual,
+000085f0: 206d 696e 695f 6261 7463 685f 792c 2079   mini_batch_y, y
+00008600: 5f70 7265 6429 0a20 2020 2020 2020 2065  _pred).        e
+00008610: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00008620: 2073 656c 662e 6361 6c63 756c 6174 655f   self.calculate_
+00008630: 6361 7365 5f76 616c 7565 7328 696e 6469  case_values(indi
+00008640: 7669 6475 616c 2c20 592c 2079 5f70 7265  vidual, Y, y_pre
+00008650: 6429 0a0a 2020 2020 2020 2020 6966 2027  d)..        if '
+00008660: 4356 2720 696e 2073 656c 662e 7363 6f72  CV' in self.scor
+00008670: 655f 6675 6e63 3a0a 2020 2020 2020 2020  e_func:.        
+00008680: 2020 2020 6173 7365 7274 206c 656e 2869      assert len(i
+00008690: 6e64 6976 6964 7561 6c2e 6361 7365 5f76  ndividual.case_v
+000086a0: 616c 7565 7329 2025 2035 203d 3d20 300a  alues) % 5 == 0.
+000086b0: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
+000086c0: 662e 7363 6f72 655f 6675 6e63 203d 3d20  f.score_func == 
+000086d0: 2743 4446 4327 3a0a 2020 2020 2020 2020  'CDFC':.        
+000086e0: 2020 2020 6173 7365 7274 206c 656e 2869      assert len(i
+000086f0: 6e64 6976 6964 7561 6c2e 6361 7365 5f76  ndividual.case_v
+00008700: 616c 7565 7329 203d 3d20 6c65 6e28 6e70  alues) == len(np
+00008710: 2e75 6e69 7175 6528 5929 290a 2020 2020  .unique(Y)).    
+00008720: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00008730: 2020 2020 2020 6966 2073 656c 662e 6576        if self.ev
+00008740: 616c 7561 7469 6f6e 5f63 6f6e 6669 6775  aluation_configu
+00008750: 7261 7469 6f6e 2e6d 696e 695f 6261 7463  ration.mini_batc
+00008760: 683a 0a20 2020 2020 2020 2020 2020 2020  h:.             
+00008770: 2020 2061 7373 6572 7420 6c65 6e28 696e     assert len(in
+00008780: 6469 7669 6475 616c 2e63 6173 655f 7661  dividual.case_va
+00008790: 6c75 6573 2920 3d3d 2073 656c 662e 6576  lues) == self.ev
+000087a0: 616c 7561 7469 6f6e 5f63 6f6e 6669 6775  aluation_configu
+000087b0: 7261 7469 6f6e 2e62 6174 6368 5f73 697a  ration.batch_siz
+000087c0: 652c 205c 0a20 2020 2020 2020 2020 2020  e, \.           
+000087d0: 2020 2020 2020 2020 206c 656e 2869 6e64           len(ind
+000087e0: 6976 6964 7561 6c2e 6361 7365 5f76 616c  ividual.case_val
+000087f0: 7565 7329 0a20 2020 2020 2020 2020 2020  ues).           
+00008800: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00008810: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
+00008820: 6e28 696e 6469 7669 6475 616c 2e63 6173  n(individual.cas
+00008830: 655f 7661 6c75 6573 2920 3d3d 206c 656e  e_values) == len
+00008840: 2859 292c 206c 656e 2869 6e64 6976 6964  (Y), len(individ
+00008850: 7561 6c2e 6361 7365 5f76 616c 7565 7329  ual.case_values)
+00008860: 0a0a 2020 2020 2020 2020 696e 6469 7669  ..        indivi
+00008870: 6475 616c 2e68 6173 685f 7265 7375 6c74  dual.hash_result
+00008880: 203d 2069 6e66 6f72 6d61 7469 6f6e 2e68   = information.h
+00008890: 6173 685f 7265 7375 6c74 0a20 2020 2020  ash_result.     
+000088a0: 2020 2069 6e64 6976 6964 7561 6c2e 7365     individual.se
+000088b0: 6d61 6e74 6963 7320 3d20 696e 666f 726d  mantics = inform
+000088c0: 6174 696f 6e2e 7365 6d61 6e74 6963 5f72  ation.semantic_r
+000088d0: 6573 756c 7473 0a20 2020 2020 2020 2069  esults.        i
+000088e0: 6e64 6976 6964 7561 6c2e 636f 7272 656c  ndividual.correl
+000088f0: 6174 696f 6e5f 7265 7375 6c74 7320 3d20  ation_results = 
+00008900: 696e 666f 726d 6174 696f 6e2e 636f 7272  information.corr
+00008910: 656c 6174 696f 6e5f 7265 7375 6c74 730a  elation_results.
+00008920: 2020 2020 2020 2020 7365 6c66 2e69 6d70          self.imp
+00008930: 6f72 7461 6e63 655f 706f 7374 5f70 726f  ortance_post_pro
+00008940: 6365 7373 2869 6e64 6976 6964 7561 6c2c  cess(individual,
+00008950: 2065 7374 696d 6174 6f72 7329 0a0a 2020   estimators)..  
+00008960: 2020 2020 2020 6966 2073 656c 662e 6d67        if self.mg
+00008970: 705f 6d6f 6465 2061 6e64 2073 656c 662e  p_mode and self.
+00008980: 696d 706f 7274 616e 6365 5f70 726f 7061  importance_propa
+00008990: 6761 7469 6f6e 3a0a 2020 2020 2020 2020  gation:.        
+000089a0: 2020 2020 2320 496d 706f 7274 616e 6365      # Importance
+000089b0: 2050 726f 7061 6761 7469 6f6e 0a20 2020   Propagation.   
+000089c0: 2020 2020 2020 2020 2023 2054 6869 7320           # This 
+000089d0: 7072 6f70 6167 6174 696f 6e20 7769 6c6c  propagation will
+000089e0: 2069 6e66 6c75 656e 6365 2074 6572 6d69   influence termi
+000089f0: 6e61 6c20 7661 7269 6162 6c65 2073 656c  nal variable sel
+00008a00: 6563 7469 6f6e 2061 7320 7765 6c6c 2061  ection as well a
+00008a10: 7320 6d75 6c74 692d 7061 7265 6e74 2063  s multi-parent c
+00008a20: 726f 7373 6f76 6572 0a20 2020 2020 2020  rossover.       
+00008a30: 2020 2020 2066 6f72 2069 2c20 6765 6e65       for i, gene
+00008a40: 2069 6e20 656e 756d 6572 6174 6528 7265   in enumerate(re
+00008a50: 7665 7273 6564 2869 6e64 6976 6964 7561  versed(individua
+00008a60: 6c2e 6765 6e65 2929 3a0a 2020 2020 2020  l.gene)):.      
+00008a70: 2020 2020 2020 2020 2020 636f 6566 203d            coef =
+00008a80: 2069 6e64 6976 6964 7561 6c2e 636f 6566   individual.coef
+00008a90: 5b69 5d0a 2020 2020 2020 2020 2020 2020  [i].            
+00008aa0: 2020 2020 7573 6564 5f69 6420 3d20 7365      used_id = se
+00008ab0: 7428 290a 2020 2020 2020 2020 2020 2020  t().            
+00008ac0: 2020 2020 666f 7220 7465 726d 696e 616c      for terminal
+00008ad0: 2069 6e20 6765 6e65 3a0a 2020 2020 2020   in gene:.      
+00008ae0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00008af0: 2069 7369 6e73 7461 6e63 6528 7465 726d   isinstance(term
+00008b00: 696e 616c 2c20 5465 726d 696e 616c 2920  inal, Terminal) 
+00008b10: 616e 6420 7465 726d 696e 616c 2e6e 616d  and terminal.nam
+00008b20: 652e 7374 6172 7473 7769 7468 2822 4152  e.startswith("AR
+00008b30: 4722 293a 0a20 2020 2020 2020 2020 2020  G"):.           
+00008b40: 2020 2020 2020 2020 2020 2020 2023 2070               # p
+00008b50: 7269 6e74 2822 4665 6174 7572 6520 4f63  rint("Feature Oc
+00008b60: 6375 7272 6564 222c 2074 6572 6d69 6e61  curred", termina
+00008b70: 6c2e 6e61 6d65 290a 2020 2020 2020 2020  l.name).        
+00008b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008b90: 7465 726d 696e 616c 5f69 6420 3d20 696e  terminal_id = in
+00008ba0: 7428 7465 726d 696e 616c 2e6e 616d 652e  t(terminal.name.
+00008bb0: 7265 706c 6163 6528 2241 5247 222c 2022  replace("ARG", "
+00008bc0: 2229 290a 2020 2020 2020 2020 2020 2020  ")).            
+00008bd0: 2020 2020 2020 2020 2020 2020 6966 2074              if t
+00008be0: 6572 6d69 6e61 6c5f 6964 203e 3d20 7365  erminal_id >= se
+00008bf0: 6c66 2e58 2e73 6861 7065 5b31 5d20 616e  lf.X.shape[1] an
+00008c00: 6420 7465 726d 696e 616c 5f69 6420 6e6f  d terminal_id no
+00008c10: 7420 696e 2075 7365 645f 6964 3a0a 2020  t in used_id:.  
+00008c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008c30: 2020 2020 2020 2020 2020 2320 6966 206f            # if o
+00008c40: 6e65 2074 6572 6d69 6e61 6c20 6861 7320  ne terminal has 
+00008c50: 6265 656e 2063 6f75 6e74 6564 2c20 6e6f  been counted, no
+00008c60: 7420 746f 2063 6f75 6e74 2069 7420 6167  t to count it ag
+00008c70: 6169 6e0a 2020 2020 2020 2020 2020 2020  ain.            
+00008c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008c90: 7573 6564 5f69 642e 6164 6428 7465 726d  used_id.add(term
+00008ca0: 696e 616c 5f69 6429 0a20 2020 2020 2020  inal_id).       
+00008cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008cc0: 2020 2020 2074 6572 6d69 6e61 6c5f 6964       terminal_id
+00008cd0: 202d 3d20 7365 6c66 2e58 2e73 6861 7065   -= self.X.shape
+00008ce0: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
+00008cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008d00: 696e 6469 7669 6475 616c 2e63 6f65 665b  individual.coef[
+00008d10: 7465 726d 696e 616c 5f69 645d 202b 3d20  terminal_id] += 
+00008d20: 636f 6566 0a0a 2020 2020 2020 2020 6966  coef..        if
+00008d30: 2073 656c 662e 7665 7262 6f73 653a 0a20   self.verbose:. 
+00008d40: 2020 2020 2020 2020 2020 2070 6173 730a             pass.
+00008d50: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00008d60: 2e62 6173 655f 6c65 6172 6e65 7220 3d3d  .base_learner ==
+00008d70: 2027 5261 6e64 6f6d 2d44 542d 506c 7573   'Random-DT-Plus
+00008d80: 273a 0a20 2020 2020 2020 2020 2020 2069  ':.            i
+00008d90: 6620 6973 696e 7374 616e 6365 2873 656c  f isinstance(sel
+00008da0: 662c 2043 6c61 7373 6966 6965 724d 6978  f, ClassifierMix
+00008db0: 696e 293a 0a20 2020 2020 2020 2020 2020  in):.           
+00008dc0: 2020 2020 2069 6e64 6976 6964 7561 6c2e       individual.
+00008dd0: 7069 7065 203d 2045 6e73 656d 626c 6543  pipe = EnsembleC
+00008de0: 6c61 7373 6966 6965 7228 6573 7469 6d61  lassifier(estima
+00008df0: 746f 7273 290a 2020 2020 2020 2020 2020  tors).          
+00008e00: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
+00008e10: 6528 7365 6c66 2c20 5265 6772 6573 736f  e(self, Regresso
+00008e20: 724d 6978 696e 293a 0a20 2020 2020 2020  rMixin):.       
+00008e30: 2020 2020 2020 2020 2069 6e64 6976 6964           individ
+00008e40: 7561 6c2e 7069 7065 203d 2045 6e73 656d  ual.pipe = Ensem
+00008e50: 626c 6552 6567 7265 7373 6f72 2865 7374  bleRegressor(est
+00008e60: 696d 6174 6f72 7329 0a20 2020 2020 2020  imators).       
+00008e70: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00008e80: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00008e90: 2045 7863 6570 7469 6f6e 0a0a 2020 2020   Exception..    
+00008ea0: 2020 2020 2320 636f 756e 7420 7468 6520      # count the 
+00008eb0: 6e75 6d62 6572 206f 6620 6e6f 6465 7320  number of nodes 
+00008ec0: 696e 2064 6563 6973 696f 6e20 7472 6565  in decision tree
+00008ed0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00008ee0: 2e62 6173 6963 5f70 7269 6d69 7469 7665  .basic_primitive
+00008ef0: 7320 213d 2027 4d4c 2720 616e 6420 6861  s != 'ML' and ha
+00008f00: 7361 7474 7228 6573 7469 6d61 746f 7273  sattr(estimators
+00008f10: 5b30 5d5b 2752 6964 6765 275d 2c20 2774  [0]['Ridge'], 't
+00008f20: 7265 655f 2729 3a0a 2020 2020 2020 2020  ree_'):.        
+00008f30: 2020 2020 696e 6469 7669 6475 616c 2e6e      individual.n
+00008f40: 6f64 655f 636f 756e 7420 3d20 5b65 7374  ode_count = [est
+00008f50: 696d 6174 6f72 735b 695d 5b27 5269 6467  imators[i]['Ridg
+00008f60: 6527 5d2e 7472 6565 5f2e 6e6f 6465 5f63  e'].tree_.node_c
+00008f70: 6f75 6e74 2066 6f72 2069 2069 6e20 7261  ount for i in ra
+00008f80: 6e67 6528 6c65 6e28 6573 7469 6d61 746f  nge(len(estimato
+00008f90: 7273 2929 5d0a 2020 2020 2020 2020 6966  rs))].        if
+00008fa0: 2063 6865 636b 5f73 656d 616e 7469 635f   check_semantic_
+00008fb0: 6261 7365 645f 6263 2873 656c 662e 626c  based_bc(self.bl
+00008fc0: 6f61 745f 636f 6e74 726f 6c29 206f 7220  oat_control) or 
+00008fd0: 7365 6c66 2e69 6e74 726f 6e5f 6770 3a0a  self.intron_gp:.
+00008fe0: 2020 2020 2020 2020 2020 2020 2320 6f6e              # on
+00008ff0: 6c79 2064 6f20 7468 6973 2069 6e20 696e  ly do this in in
+00009000: 7472 6f6e 206d 6f64 650a 2020 2020 2020  tron mode.      
+00009010: 2020 2020 2020 696e 7472 6f6e 5f69 6473        intron_ids
+00009020: 203d 2069 6e66 6f72 6d61 7469 6f6e 2e69   = information.i
+00009030: 6e74 726f 6e73 5f72 6573 756c 7473 0a20  ntrons_results. 
+00009040: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00009050: 6c66 2e69 6e74 726f 6e5f 6770 206f 7220  lf.intron_gp or 
+00009060: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
+00009070: 2020 7365 6c66 2e62 6c6f 6174 5f63 6f6e    self.bloat_con
+00009080: 7472 6f6c 2e67 6574 2827 6578 6f6e 5f74  trol.get('exon_t
+00009090: 6f75 726e 616d 656e 7427 2c20 4661 6c73  ournament', Fals
+000090a0: 6529 206f 7220 5c0a 2020 2020 2020 2020  e) or \.        
+000090b0: 2020 2020 2020 2020 7365 6c66 2e62 6c6f          self.blo
+000090c0: 6174 5f63 6f6e 7472 6f6c 2e67 6574 2827  at_control.get('
+000090d0: 6578 6f6e 5f74 6f75 726e 616d 656e 745f  exon_tournament_
+000090e0: 5632 272c 2046 616c 7365 2920 6f72 205c  V2', False) or \
+000090f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009100: 2073 656c 662e 626c 6f61 745f 636f 6e74   self.bloat_cont
+00009110: 726f 6c2e 6765 7428 276d 7574 6174 696f  rol.get('mutatio
+00009120: 6e5f 776f 7273 7427 2c20 4661 6c73 6529  n_worst', False)
+00009130: 206f 7220 5c0a 2020 2020 2020 2020 2020   or \.          
+00009140: 2020 2020 2020 7365 6c66 2e62 6c6f 6174        self.bloat
+00009150: 5f63 6f6e 7472 6f6c 2e67 6574 2827 686f  _control.get('ho
+00009160: 6973 745f 6f6e 655f 6c61 7965 7227 2c20  ist_one_layer', 
+00009170: 4661 6c73 6529 206f 7220 5c0a 2020 2020  False) or \.    
+00009180: 2020 2020 2020 2020 2020 2020 6368 6563              chec
+00009190: 6b5f 7365 6d61 6e74 6963 5f62 6173 6564  k_semantic_based
+000091a0: 5f62 6328 7365 6c66 2e62 6c6f 6174 5f63  _bc(self.bloat_c
+000091b0: 6f6e 7472 6f6c 293a 0a20 2020 2020 2020  ontrol):.       
+000091c0: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+000091d0: 6c65 6e28 696e 7472 6f6e 5f69 6473 2920  len(intron_ids) 
+000091e0: 3d3d 206c 656e 2869 6e64 6976 6964 7561  == len(individua
+000091f0: 6c2e 6765 6e65 290a 2020 2020 2020 2020  l.gene).        
+00009200: 2020 2020 2020 2020 2320 6d61 726b 206c          # mark l
+00009210: 6576 656c 2074 6f20 616c 6c20 6765 6e65  evel to all gene
+00009220: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
+00009230: 2020 666f 7220 6765 6e65 5f69 6e74 726f    for gene_intro
+00009240: 6e73 2c20 6765 6e65 2069 6e20 7a69 7028  ns, gene in zip(
+00009250: 696e 7472 6f6e 5f69 6473 2c20 696e 6469  intron_ids, indi
+00009260: 7669 6475 616c 2e67 656e 6529 3a0a 2020  vidual.gene):.  
+00009270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009280: 2020 7120 3d20 5b5d 0a20 2020 2020 2020    q = [].       
+00009290: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+000092a0: 2069 642c 2063 6f65 6620 696e 2073 6f72   id, coef in sor
+000092b0: 7465 6428 6765 6e65 5f69 6e74 726f 6e73  ted(gene_introns
+000092c0: 2e69 7465 6d73 2829 2c20 6b65 793d 6c61  .items(), key=la
+000092d0: 6d62 6461 2078 3a20 785b 305d 293a 0a20  mbda x: x[0]):. 
+000092e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000092f0: 2020 2020 2020 2073 203d 2069 640a 2020         s = id.  
+00009300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009310: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+00009320: 6e63 6528 6765 6e65 5b73 5d2c 2050 7269  nce(gene[s], Pri
+00009330: 6d69 7469 7665 293a 0a20 2020 2020 2020  mitive):.       
+00009340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009350: 2020 2020 2067 656e 655b 735d 203d 2049       gene[s] = I
+00009360: 6e74 726f 6e50 7269 6d69 7469 7665 2867  ntronPrimitive(g
+00009370: 656e 655b 735d 2e6e 616d 652c 2067 656e  ene[s].name, gen
+00009380: 655b 735d 2e61 7267 732c 2067 656e 655b  e[s].args, gene[
+00009390: 735d 2e72 6574 290a 2020 2020 2020 2020  s].ret).        
+000093a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000093b0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+000093c0: 6528 636f 6566 2c20 7475 706c 6529 2061  e(coef, tuple) a
+000093d0: 6e64 206c 656e 2863 6f65 6629 203d 3d20  nd len(coef) == 
+000093e0: 333a 0a20 2020 2020 2020 2020 2020 2020  3:.             
+000093f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009400: 2020 2067 656e 655b 735d 2e65 7175 616c     gene[s].equal
+00009410: 5f73 7562 7472 6565 203d 2063 6f65 665b  _subtree = coef[
+00009420: 315d 0a20 2020 2020 2020 2020 2020 2020  1].             
+00009430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009440: 2020 2063 6f65 6620 3d20 636f 6566 5b30     coef = coef[0
+00009450: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00009460: 2020 2020 2020 2020 2020 656c 6966 2069            elif i
+00009470: 7369 6e73 7461 6e63 6528 6765 6e65 5b73  sinstance(gene[s
+00009480: 5d2c 2054 6572 6d69 6e61 6c29 3a0a 2020  ], Terminal):.  
+00009490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000094a0: 2020 2020 2020 2020 2020 6765 6e65 5b73            gene[s
+000094b0: 5d20 3d20 496e 7472 6f6e 5465 726d 696e  ] = IntronTermin
+000094c0: 616c 2867 656e 655b 735d 2e6e 616d 652c  al(gene[s].name,
+000094d0: 2067 6574 6174 7472 2867 656e 655b 735d   getattr(gene[s]
+000094e0: 2c20 2763 6f6e 765f 6663 7427 2920 3d3d  , 'conv_fct') ==
+000094f0: 2073 7472 2c20 6765 6e65 5b73 5d2e 7265   str, gene[s].re
+00009500: 7429 0a20 2020 2020 2020 2020 2020 2020  t).             
+00009510: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+00009520: 696e 7374 616e 6365 2863 6f65 662c 2074  instance(coef, t
+00009530: 7570 6c65 293a 0a20 2020 2020 2020 2020  uple):.         
+00009540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009550: 2020 2067 656e 655b 735d 2e63 6f72 7220     gene[s].corr 
+00009560: 3d20 636f 6566 5b30 5d0a 2020 2020 2020  = coef[0].      
+00009570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009580: 2020 2020 2020 2320 6c6f 6361 6c69 7479        # locality
+00009590: 2073 656e 7369 7469 7665 2068 6173 680a   sensitive hash.
+000095a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000095b0: 2020 2020 2020 2020 2020 2020 6765 6e65              gene
+000095c0: 5b73 5d2e 6861 7368 5f69 6420 3d20 636f  [s].hash_id = co
+000095d0: 6566 5b31 5d0a 2020 2020 2020 2020 2020  ef[1].          
+000095e0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+000095f0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00009600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009610: 6765 6e65 5b73 5d2e 636f 7272 203d 2063  gene[s].corr = c
+00009620: 6f65 660a 2020 2020 2020 2020 2020 2020  oef.            
+00009630: 2020 2020 2020 2020 2020 2020 6765 6e65              gene
+00009640: 5b73 5d2e 6c65 7665 6c20 3d20 6c65 6e28  [s].level = len(
+00009650: 7129 0a20 2020 2020 2020 2020 2020 2020  q).             
+00009660: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+00009670: 696e 7374 616e 6365 2867 656e 655b 735d  instance(gene[s]
+00009680: 2c20 5072 696d 6974 6976 6529 3a0a 2020  , Primitive):.  
+00009690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000096a0: 2020 2020 2020 2020 2020 6966 206c 656e            if len
+000096b0: 2871 2920 3e20 303a 0a20 2020 2020 2020  (q) > 0:.       
+000096c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000096d0: 2020 2020 2020 2020 2071 5b2d 315d 202d           q[-1] -
+000096e0: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
+000096f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009700: 712e 6170 7065 6e64 2867 656e 655b 735d  q.append(gene[s]
+00009710: 2e61 7269 7479 290a 2020 2020 2020 2020  .arity).        
+00009720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009730: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
+00009740: 6765 6e65 5b73 5d2c 2054 6572 6d69 6e61  gene[s], Termina
+00009750: 6c29 3a0a 2020 2020 2020 2020 2020 2020  l):.            
+00009760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009770: 6966 206c 656e 2871 2920 3e20 303a 0a20  if len(q) > 0:. 
+00009780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009790: 2020 2020 2020 2020 2020 2020 2020 2071                 q
+000097a0: 5b2d 315d 202d 3d20 310a 2020 2020 2020  [-1] -= 1.      
+000097b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000097c0: 2020 2020 2020 7768 696c 6520 6c65 6e28        while len(
+000097d0: 7129 203e 2030 2061 6e64 2071 5b2d 315d  q) > 0 and q[-1]
+000097e0: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
+000097f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009800: 2020 2020 2020 2071 2e70 6f70 282d 3129         q.pop(-1)
+00009810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009820: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
+00009830: 7129 203d 3d20 300a 2020 2020 2020 2020  q) == 0.        
+00009840: 2020 2020 656c 6966 2073 656c 662e 626c      elif self.bl
+00009850: 6f61 745f 636f 6e74 726f 6c2e 6765 7428  oat_control.get(
+00009860: 2769 6e74 726f 6e5f 6d75 7461 7469 6f6e  'intron_mutation
+00009870: 272c 2046 616c 7365 2920 6f72 205c 0a20  ', False) or \. 
+00009880: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00009890: 656c 662e 626c 6f61 745f 636f 6e74 726f  elf.bloat_contro
+000098a0: 6c2e 6765 7428 2769 6e74 726f 6e5f 6372  l.get('intron_cr
+000098b0: 6f73 736f 7665 7227 2c20 4661 6c73 6529  ossover', False)
+000098c0: 206f 7220 5c0a 2020 2020 2020 2020 2020   or \.          
+000098d0: 2020 2020 2020 7365 6c66 2e62 6c6f 6174        self.bloat
+000098e0: 5f63 6f6e 7472 6f6c 2e67 6574 2827 6578  _control.get('ex
+000098f0: 6f6e 5f63 726f 7373 6f76 6572 272c 2046  on_crossover', F
+00009900: 616c 7365 2920 6f72 205c 0a20 2020 2020  alse) or \.     
+00009910: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00009920: 626c 6f61 745f 636f 6e74 726f 6c2e 6765  bloat_control.ge
+00009930: 7428 2765 786f 6e5f 6d75 7461 7469 6f6e  t('exon_mutation
+00009940: 272c 2046 616c 7365 293a 0a20 2020 2020  ', False):.     
+00009950: 2020 2020 2020 2020 2020 2066 6f72 2067             for g
+00009960: 656e 655f 696e 7472 6f6e 732c 2067 656e  ene_introns, gen
+00009970: 6520 696e 207a 6970 2869 6e74 726f 6e5f  e in zip(intron_
+00009980: 6964 732c 2069 6e64 6976 6964 7561 6c2e  ids, individual.
+00009990: 6765 6e65 293a 0a20 2020 2020 2020 2020  gene):.         
+000099a0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000099b0: 616c 6c5f 6e6f 6465 735f 636f 756e 7465  all_nodes_counte
+000099c0: 7220 2b3d 206c 656e 2867 656e 655f 696e  r += len(gene_in
+000099d0: 7472 6f6e 7329 0a20 2020 2020 2020 2020  trons).         
+000099e0: 2020 2020 2020 2020 2020 2067 656e 655f             gene_
+000099f0: 696e 7472 6f6e 7320 3d20 6c69 7374 2866  introns = list(f
+00009a00: 696c 7465 7228 6c61 6d62 6461 2069 743a  ilter(lambda it:
+00009a10: 2069 745b 315d 203c 2030 2e30 312c 2067   it[1] < 0.01, g
+00009a20: 656e 655f 696e 7472 6f6e 732e 6974 656d  ene_introns.item
+00009a30: 7328 2929 290a 2020 2020 2020 2020 2020  s())).          
+00009a40: 2020 2020 2020 2020 2020 7365 6c66 2e69            self.i
+00009a50: 6e74 726f 6e5f 6e6f 6465 735f 636f 756e  ntron_nodes_coun
+00009a60: 7465 7220 2b3d 206c 656e 2867 656e 655f  ter += len(gene_
+00009a70: 696e 7472 6f6e 7329 0a20 2020 2020 2020  introns).       
+00009a80: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00009a90: 2078 2c20 7620 696e 2067 656e 655f 696e   x, v in gene_in
+00009aa0: 7472 6f6e 733a 0a20 2020 2020 2020 2020  trons:.         
+00009ab0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00009ac0: 2073 7562 5f74 7265 6573 203d 2067 656e   sub_trees = gen
+00009ad0: 652e 7365 6172 6368 5375 6274 7265 6528  e.searchSubtree(
+00009ae0: 7829 0a20 2020 2020 2020 2020 2020 2020  x).             
+00009af0: 2020 2020 2020 2020 2020 2023 2066 6f72             # for
+00009b00: 2073 2069 6e20 7261 6e67 6528 7375 625f   s in range(sub_
+00009b10: 7472 6565 732e 7374 6172 742c 2073 7562  trees.start, sub
+00009b20: 5f74 7265 6573 2e73 746f 7029 3a0a 2020  _trees.stop):.  
+00009b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009b40: 2020 2020 2020 7320 3d20 780a 2020 2020        s = x.    
+00009b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009b60: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00009b70: 6528 6765 6e65 5b73 5d2c 2050 7269 6d69  e(gene[s], Primi
+00009b80: 7469 7665 293a 0a20 2020 2020 2020 2020  tive):.         
+00009b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009ba0: 2020 2067 656e 655b 735d 203d 2049 6e74     gene[s] = Int
+00009bb0: 726f 6e50 7269 6d69 7469 7665 2867 656e  ronPrimitive(gen
+00009bc0: 655b 735d 2e6e 616d 652c 2067 656e 655b  e[s].name, gene[
+00009bd0: 735d 2e61 7267 732c 2067 656e 655b 735d  s].args, gene[s]
+00009be0: 2e72 6574 290a 2020 2020 2020 2020 2020  .ret).          
+00009bf0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00009c00: 6966 2069 7369 6e73 7461 6e63 6528 6765  if isinstance(ge
+00009c10: 6e65 5b73 5d2c 2054 6572 6d69 6e61 6c29  ne[s], Terminal)
+00009c20: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00009c30: 2020 2020 2020 2020 2020 2020 2020 6765                ge
+00009c40: 6e65 5b73 5d20 3d20 496e 7472 6f6e 5465  ne[s] = IntronTe
+00009c50: 726d 696e 616c 2867 656e 655b 735d 2e6e  rminal(gene[s].n
+00009c60: 616d 652c 2067 6574 6174 7472 2867 656e  ame, getattr(gen
+00009c70: 655b 735d 2c20 2763 6f6e 765f 6663 7427  e[s], 'conv_fct'
+00009c80: 2920 3d3d 2073 7472 2c20 6765 6e65 5b73  ) == str, gene[s
+00009c90: 5d2e 7265 7429 0a20 2020 2020 2020 2020  ].ret).         
+00009ca0: 2020 2020 2020 2020 2020 2020 2020 2067                 g
+00009cb0: 656e 655b 735d 2e63 6f72 7220 3d20 760a  ene[s].corr = v.
+00009cc0: 0a20 2020 2020 2020 2023 2066 696e 616c  .        # final
+00009cd0: 2073 636f 7265 0a20 2020 2020 2020 2069   score.        i
+00009ce0: 6620 7365 6c66 2e65 7661 6c75 6174 696f  f self.evaluatio
+00009cf0: 6e5f 636f 6e66 6967 7572 6174 696f 6e2e  n_configuration.
+00009d00: 6d69 6e69 5f62 6174 6368 3a0a 2020 2020  mini_batch:.    
+00009d10: 2020 2020 2020 2020 6d69 6e69 5f62 6174          mini_bat
+00009d20: 6368 5f79 203d 2073 656c 662e 6765 745f  ch_y = self.get_
+00009d30: 6d69 6e69 5f62 6174 6368 5f79 2829 0a20  mini_batch_y(). 
+00009d40: 2020 2020 2020 2020 2020 2079 6965 6c64             yield
+00009d50: 2073 656c 662e 6361 6c63 756c 6174 655f   self.calculate_
+00009d60: 6669 746e 6573 735f 7661 6c75 6528 696e  fitness_value(in
+00009d70: 6469 7669 6475 616c 2c20 6573 7469 6d61  dividual, estima
+00009d80: 746f 7273 2c20 6d69 6e69 5f62 6174 6368  tors, mini_batch
+00009d90: 5f79 2c20 795f 7072 6564 290a 2020 2020  _y, y_pred).    
+00009da0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00009db0: 2020 2020 2020 7969 656c 6420 7365 6c66        yield self
+00009dc0: 2e63 616c 6375 6c61 7465 5f66 6974 6e65  .calculate_fitne
+00009dd0: 7373 5f76 616c 7565 2869 6e64 6976 6964  ss_value(individ
+00009de0: 7561 6c2c 2065 7374 696d 6174 6f72 732c  ual, estimators,
+00009df0: 2059 2c20 795f 7072 6564 290a 0a20 2020   Y, y_pred)..   
+00009e00: 2064 6566 2067 6574 5f6d 696e 695f 6261   def get_mini_ba
+00009e10: 7463 685f 7928 7365 6c66 293a 0a20 2020  tch_y(self):.   
+00009e20: 2020 2020 2063 6f6e 6669 6775 7261 7469       configurati
+00009e30: 6f6e 203d 2073 656c 662e 6576 616c 7561  on = self.evalua
+00009e40: 7469 6f6e 5f63 6f6e 6669 6775 7261 7469  tion_configurati
+00009e50: 6f6e 0a20 2020 2020 2020 206d 696e 695f  on.        mini_
+00009e60: 6261 7463 685f 7920 3d20 7365 6c65 6374  batch_y = select
+00009e70: 5f66 726f 6d5f 6172 7261 7928 7365 6c66  _from_array(self
+00009e80: 2e79 2c20 636f 6e66 6967 7572 6174 696f  .y, configuratio
+00009e90: 6e2e 6375 7272 656e 745f 6765 6e65 7261  n.current_genera
+00009ea0: 7469 6f6e 202a 2063 6f6e 6669 6775 7261  tion * configura
+00009eb0: 7469 6f6e 2e62 6174 6368 5f73 697a 6520  tion.batch_size 
+00009ec0: 2f2f 2034 2c0a 2020 2020 2020 2020 2020  // 4,.          
+00009ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009ee0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00009ef0: 6f6e 6669 6775 7261 7469 6f6e 2e62 6174  onfiguration.bat
+00009f00: 6368 5f73 697a 6529 0a20 2020 2020 2020  ch_size).       
+00009f10: 2072 6574 7572 6e20 6d69 6e69 5f62 6174   return mini_bat
+00009f20: 6368 5f79 0a0a 2020 2020 6465 6620 696d  ch_y..    def im
+00009f30: 706f 7274 616e 6365 5f70 6f73 745f 7072  portance_post_pr
+00009f40: 6f63 6573 7328 7365 6c66 2c20 696e 6469  ocess(self, indi
+00009f50: 7669 6475 616c 3a20 4d75 6c74 6970 6c65  vidual: Multiple
+00009f60: 4765 6e65 4750 2c20 6573 7469 6d61 746f  GeneGP, estimato
+00009f70: 7273 293a 0a20 2020 2020 2020 2064 6566  rs):.        def
+00009f80: 206d 6572 6765 5f63 6f65 6628 636f 6566   merge_coef(coef
+00009f90: 2c20 6861 7368 5f76 616c 7565 293a 0a20  , hash_value):. 
+00009fa0: 2020 2020 2020 2020 2020 2068 6173 685f             hash_
+00009fb0: 6469 6374 203d 2064 6566 6175 6c74 6469  dict = defaultdi
+00009fc0: 6374 2869 6e74 290a 2020 2020 2020 2020  ct(int).        
+00009fd0: 2020 2020 666f 7220 692c 2068 2069 6e20      for i, h in 
+00009fe0: 656e 756d 6572 6174 6528 6861 7368 5f76  enumerate(hash_v
+00009ff0: 616c 7565 293a 0a20 2020 2020 2020 2020  alue):.         
+0000a000: 2020 2020 2020 2068 6173 685f 6469 6374         hash_dict
+0000a010: 5b68 5d20 2b3d 2063 6f65 665b 695d 0a20  [h] += coef[i]. 
+0000a020: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+0000a030: 7420 3d20 5b30 5d20 2a20 6c65 6e28 636f  t = [0] * len(co
+0000a040: 6566 290a 2020 2020 2020 2020 2020 2020  ef).            
+0000a050: 666f 7220 692c 2068 2069 6e20 656e 756d  for i, h in enum
+0000a060: 6572 6174 6528 6861 7368 5f76 616c 7565  erate(hash_value
+0000a070: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0000a080: 2020 2072 6573 756c 745b 695d 203d 2068     result[i] = h
+0000a090: 6173 685f 6469 6374 5b68 5d0a 2020 2020  ash_dict[h].    
+0000a0a0: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+0000a0b0: 702e 6172 7261 7928 7265 7375 6c74 290a  p.array(result).
+0000a0c0: 0a20 2020 2020 2020 2023 206d 6178 2069  .        # max i
+0000a0d0: 7320 6e6f 7420 616e 2061 7070 726f 7072  s not an appropr
+0000a0e0: 6961 7465 2069 6e64 6963 6174 6f72 2c20  iate indicator, 
+0000a0f0: 6265 6361 7573 6520 6974 2077 696c 6c20  because it will 
+0000a100: 6869 6768 6c69 6768 7420 6e6f 7420 726f  highlight not ro
+0000a110: 6275 7374 2066 6561 7475 7265 730a 2020  bust features.  
+0000a120: 2020 2020 2020 696d 706f 7274 616e 6365        importance
+0000a130: 5f76 616c 7565 7320 3d20 5b73 656c 662e  _values = [self.
+0000a140: 6765 745f 6d6f 6465 6c5f 636f 6566 6669  get_model_coeffi
+0000a150: 6369 656e 7428 7829 2066 6f72 2078 2069  cient(x) for x i
+0000a160: 6e20 6573 7469 6d61 746f 7273 5d0a 2020  n estimators].  
+0000a170: 2020 2020 2020 696e 6469 7669 6475 616c        individual
+0000a180: 2e6d 6561 6e5f 636f 6566 203d 206e 702e  .mean_coef = np.
+0000a190: 6d65 616e 2869 6d70 6f72 7461 6e63 655f  mean(importance_
+0000a1a0: 7661 6c75 6573 2c20 6178 6973 3d30 290a  values, axis=0).
+0000a1b0: 2020 2020 2020 2020 696e 6469 7669 6475          individu
+0000a1c0: 616c 2e63 6f65 6620 3d20 6e70 2e6d 6178  al.coef = np.max
+0000a1d0: 2869 6d70 6f72 7461 6e63 655f 7661 6c75  (importance_valu
+0000a1e0: 6573 2c20 6178 6973 3d30 290a 0a20 2020  es, axis=0)..   
+0000a1f0: 2020 2020 2069 6620 696e 6469 7669 6475       if individu
+0000a200: 616c 2e69 6e74 726f 6e5f 7072 6f62 6162  al.intron_probab
+0000a210: 696c 6974 7920 3e20 303a 0a20 2020 2020  ility > 0:.     
+0000a220: 2020 2020 2020 2063 6f65 6620 3d20 6e70         coef = np
+0000a230: 2e7a 6572 6f73 5f6c 696b 6528 696e 6469  .zeros_like(indi
+0000a240: 7669 6475 616c 2e61 6374 6976 655f 6765  vidual.active_ge
+0000a250: 6e65 2c20 6474 7970 653d 6e70 2e66 6c6f  ne, dtype=np.flo
+0000a260: 6174 3332 290a 2020 2020 2020 2020 2020  at32).          
+0000a270: 2020 6920 3d20 300a 2020 2020 2020 2020    i = 0.        
+0000a280: 2020 2020 666f 7220 6964 2c20 6120 696e      for id, a in
+0000a290: 207a 6970 2872 616e 6765 2830 2c20 6c65   zip(range(0, le
+0000a2a0: 6e28 696e 6469 7669 6475 616c 2e61 6374  n(individual.act
+0000a2b0: 6976 655f 6765 6e65 2929 2c20 696e 6469  ive_gene)), indi
+0000a2c0: 7669 6475 616c 2e61 6374 6976 655f 6765  vidual.active_ge
+0000a2d0: 6e65 293a 0a20 2020 2020 2020 2020 2020  ne):.           
+0000a2e0: 2020 2020 2069 6620 613a 0a20 2020 2020       if a:.     
+0000a2f0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0000a300: 6f65 665b 6964 5d20 3d20 696e 6469 7669  oef[id] = indivi
+0000a310: 6475 616c 2e63 6f65 665b 695d 0a20 2020  dual.coef[i].   
+0000a320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a330: 2069 202b 3d20 310a 2020 2020 2020 2020   i += 1.        
+0000a340: 2020 2020 696e 6469 7669 6475 616c 2e63      individual.c
+0000a350: 6f65 6620 3d20 636f 6566 0a20 2020 2020  oef = coef.     
+0000a360: 2020 2020 2020 2061 7373 6572 7420 6920         assert i 
+0000a370: 3d3d 2069 6e74 2873 756d 2869 6e64 6976  == int(sum(indiv
+0000a380: 6964 7561 6c2e 6163 7469 7665 5f67 656e  idual.active_gen
+0000a390: 6529 290a 0a20 2020 2020 2020 2023 2069  e))..        # i
+0000a3a0: 6620 7365 6c66 2e64 656c 6574 655f 6972  f self.delete_ir
+0000a3b0: 7265 6c65 7661 6e74 206f 7220 7365 6c66  relevant or self
+0000a3c0: 2e64 656c 6574 655f 7265 6475 6e64 616e  .delete_redundan
+0000a3d0: 743a 0a20 2020 2020 2020 2023 2020 2020  t:.        #    
+0000a3e0: 2023 2074 656d 706f 7261 7269 6c79 206f   # temporarily o
+0000a3f0: 6e6c 7920 6170 706c 6963 6162 6c65 2066  nly applicable f
+0000a400: 6f72 204d 4750 0a20 2020 2020 2020 2023  or MGP.        #
+0000a410: 2020 2020 2069 6e64 6976 6964 7561 6c2e       individual.
+0000a420: 636f 6566 203d 206d 6572 6765 5f63 6f65  coef = merge_coe
+0000a430: 6628 6c69 7374 2869 6e64 6976 6964 7561  f(list(individua
+0000a440: 6c2e 636f 6566 292c 2069 6e64 6976 6964  l.coef), individ
+0000a450: 7561 6c2e 6861 7368 5f72 6573 756c 7429  ual.hash_result)
+0000a460: 0a0a 2020 2020 2020 2020 6465 6620 636f  ..        def co
+0000a470: 6566 6669 6369 656e 745f 7072 6f63 6573  efficient_proces
+0000a480: 7328 636f 6566 6669 6369 656e 7429 3a0a  s(coefficient):.
+0000a490: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0000a4a0: 756d 2863 6f65 6666 6963 6965 6e74 2920  um(coefficient) 
+0000a4b0: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
+0000a4c0: 2020 2020 2020 636f 6566 6669 6369 656e        coefficien
+0000a4d0: 7420 3d20 6e70 2e6f 6e65 735f 6c69 6b65  t = np.ones_like
+0000a4e0: 2863 6f65 6666 6963 6965 6e74 290a 2020  (coefficient).  
+0000a4f0: 2020 2020 2020 2020 2020 636f 6566 6669            coeffi
+0000a500: 6369 656e 7420 3d20 636f 6566 6669 6369  cient = coeffici
+0000a510: 656e 7420 2f20 6e70 2e73 756d 2863 6f65  ent / np.sum(coe
+0000a520: 6666 6963 6965 6e74 290a 2020 2020 2020  fficient).      
+0000a530: 2020 2020 2020 636f 6566 6669 6369 656e        coefficien
+0000a540: 7420 3d20 6e70 2e6e 616e 5f74 6f5f 6e75  t = np.nan_to_nu
+0000a550: 6d28 636f 6566 6669 6369 656e 742c 2070  m(coefficient, p
+0000a560: 6f73 696e 663d 302c 206e 6567 696e 663d  osinf=0, neginf=
+0000a570: 3029 0a20 2020 2020 2020 2020 2020 2072  0).            r
+0000a580: 6574 7572 6e20 636f 6566 6669 6369 656e  eturn coefficien
+0000a590: 740a 0a20 2020 2020 2020 2069 6e64 6976  t..        indiv
+0000a5a0: 6964 7561 6c2e 636f 6566 203d 2063 6f65  idual.coef = coe
+0000a5b0: 6666 6963 6965 6e74 5f70 726f 6365 7373  fficient_process
+0000a5c0: 2869 6e64 6976 6964 7561 6c2e 636f 6566  (individual.coef
+0000a5d0: 290a 2020 2020 2020 2020 696e 6469 7669  ).        indivi
+0000a5e0: 6475 616c 2e6d 6561 6e5f 636f 6566 203d  dual.mean_coef =
+0000a5f0: 2063 6f65 6666 6963 6965 6e74 5f70 726f   coefficient_pro
+0000a600: 6365 7373 2869 6e64 6976 6964 7561 6c2e  cess(individual.
+0000a610: 6d65 616e 5f63 6f65 6629 0a0a 2020 2020  mean_coef)..    
+0000a620: 6465 6620 6361 6c63 756c 6174 655f 6669  def calculate_fi
+0000a630: 746e 6573 735f 7661 6c75 6528 7365 6c66  tness_value(self
+0000a640: 2c20 696e 6469 7669 6475 616c 2c20 6573  , individual, es
+0000a650: 7469 6d61 746f 7273 2c20 592c 2079 5f70  timators, Y, y_p
+0000a660: 7265 6429 3a0a 2020 2020 2020 2020 2222  red):.        ""
+0000a670: 220a 2020 2020 2020 2020 536d 616c 6c65  ".        Smalle
+0000a680: 7220 6973 2062 6574 7465 7220 6265 6361  r is better beca
+0000a690: 7573 6520 7468 6520 7765 6967 6874 2069  use the weight i
+0000a6a0: 7320 2d31 2e0a 2020 2020 2020 2020 2222  s -1..        ""
+0000a6b0: 220a 2020 2020 2020 2020 6966 2073 656c  ".        if sel
+0000a6c0: 662e 7363 6f72 655f 6675 6e63 203d 3d20  f.score_func == 
+0000a6d0: 2752 3227 206f 7220 7365 6c66 2e73 636f  'R2' or self.sco
+0000a6e0: 7265 5f66 756e 6320 3d3d 2027 4e6f 7665  re_func == 'Nove
+0000a6f0: 6c74 7953 6561 7263 6827 206f 7220 7365  ltySearch' or se
+0000a700: 6c66 2e73 636f 7265 5f66 756e 6320 3d3d  lf.score_func ==
+0000a710: 2027 4d41 4527 3a0a 2020 2020 2020 2020   'MAE':.        
+0000a720: 2020 2020 6966 2073 656c 662e 696d 6261      if self.imba
+0000a730: 6c61 6e63 6564 5f63 6f6e 6669 6775 7261  lanced_configura
+0000a740: 7469 6f6e 2e62 616c 616e 6365 645f 6669  tion.balanced_fi
+0000a750: 746e 6573 733a 0a20 2020 2020 2020 2020  tness:.         
+0000a760: 2020 2020 2020 2073 616d 706c 655f 7765         sample_we
+0000a770: 6967 6874 203d 2067 6574 5f73 616d 706c  ight = get_sampl
+0000a780: 655f 7765 6967 6874 2873 656c 662e 582c  e_weight(self.X,
+0000a790: 2073 656c 662e 7465 7374 5f58 2c20 7365   self.test_X, se
+0000a7a0: 6c66 2e79 2c0a 2020 2020 2020 2020 2020  lf.y,.          
+0000a7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a7d0: 2020 2020 2020 2020 7365 6c66 2e69 6d62          self.imb
+0000a7e0: 616c 616e 6365 645f 636f 6e66 6967 7572  alanced_configur
+0000a7f0: 6174 696f 6e29 0a20 2020 2020 2020 2020  ation).         
+0000a800: 2020 2020 2020 2073 636f 7265 203d 2072         score = r
+0000a810: 325f 7363 6f72 6528 592c 2079 5f70 7265  2_score(Y, y_pre
+0000a820: 642c 2073 616d 706c 655f 7765 6967 6874  d, sample_weight
+0000a830: 3d73 616d 706c 655f 7765 6967 6874 290a  =sample_weight).
+0000a840: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0000a850: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000a860: 2020 7363 6f72 6520 3d20 7232 5f73 636f    score = r2_sco
+0000a870: 7265 2859 2c20 795f 7072 6564 290a 2020  re(Y, y_pred).  
+0000a880: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+0000a890: 662e 7765 6967 6874 6564 5f63 6f65 663a  f.weighted_coef:
+0000a8a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a8b0: 2069 6e64 6976 6964 7561 6c2e 636f 6566   individual.coef
+0000a8c0: 203d 206e 702e 6172 7261 7928 696e 6469   = np.array(indi
+0000a8d0: 7669 6475 616c 2e63 6f65 6629 202a 2073  vidual.coef) * s
+0000a8e0: 636f 7265 0a20 2020 2020 2020 2020 2020  core.           
+0000a8f0: 2023 2070 7269 6e74 2827 7232 5f73 636f   # print('r2_sco
+0000a900: 7265 272c 7363 6f72 6529 0a20 2020 2020  re',score).     
+0000a910: 2020 2020 2020 2072 6574 7572 6e20 2d31         return -1
+0000a920: 202a 2073 636f 7265 2c0a 2020 2020 2020   * score,.      
+0000a930: 2020 2020 2020 2320 7265 7475 726e 206e        # return n
+0000a940: 702e 6d65 616e 2828 5920 2d20 795f 7072  p.mean((Y - y_pr
+0000a950: 6564 2920 2a2a 2034 292c 0a20 2020 2020  ed) ** 4),.     
+0000a960: 2020 2065 6c69 6620 7365 6c66 2e73 636f     elif self.sco
+0000a970: 7265 5f66 756e 6320 3d3d 2027 4d53 452d  re_func == 'MSE-
+0000a980: 5661 7269 616e 6365 273a 0a20 2020 2020  Variance':.     
+0000a990: 2020 2020 2020 2065 7272 6f72 203d 206d         error = m
+0000a9a0: 6561 6e5f 7371 7561 7265 645f 6572 726f  ean_squared_erro
+0000a9b0: 7228 592c 2079 5f70 7265 6429 0a20 2020  r(Y, y_pred).   
+0000a9c0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0000a9d0: 6e70 2e6d 6561 6e28 6572 726f 7229 202b  np.mean(error) +
+0000a9e0: 2030 2e30 3120 2a20 6e70 2e73 7464 2865   0.01 * np.std(e
+0000a9f0: 7272 6f72 292c 0a20 2020 2020 2020 2065  rror),.        e
+0000aa00: 6c69 6620 7365 6c66 2e73 636f 7265 5f66  lif self.score_f
+0000aa10: 756e 6320 3d3d 2027 4c6f 7765 722d 426f  unc == 'Lower-Bo
+0000aa20: 756e 6427 3a0a 2020 2020 2020 2020 2020  und':.          
+0000aa30: 2020 7265 7475 726e 206e 702e 6d61 7828    return np.max(
+0000aa40: 6d65 616e 5f73 7175 6172 6564 5f65 7272  mean_squared_err
+0000aa50: 6f72 2859 2c20 795f 7072 6564 2929 2c0a  or(Y, y_pred)),.
+0000aa60: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
+0000aa70: 662e 7363 6f72 655f 6675 6e63 203d 3d20  f.score_func == 
+0000aa80: 2753 7065 6172 6d61 6e27 3a0a 2020 2020  'Spearman':.    
+0000aa90: 2020 2020 2020 2020 7265 7475 726e 202d          return -
+0000aaa0: 3120 2a20 7370 6561 726d 616e 2859 2c20  1 * spearman(Y, 
+0000aab0: 795f 7072 6564 292c 0a20 2020 2020 2020  y_pred),.       
+0000aac0: 2065 6c69 6620 7365 6c66 2e73 636f 7265   elif self.score
+0000aad0: 5f66 756e 6320 3d3d 2027 4356 2d4e 6f64  _func == 'CV-Nod
+0000aae0: 6543 6f75 6e74 273a 0a20 2020 2020 2020  eCount':.       
+0000aaf0: 2020 2020 2072 6574 7572 6e20 5b65 7374       return [est
+0000ab00: 696d 6174 6f72 735b 695d 5b27 5269 6467  imators[i]['Ridg
+0000ab10: 6527 5d2e 7472 6565 5f2e 6e6f 6465 5f63  e'].tree_.node_c
+0000ab20: 6f75 6e74 2066 6f72 2069 2069 6e20 7261  ount for i in ra
+0000ab30: 6e67 6528 6c65 6e28 6573 7469 6d61 746f  nge(len(estimato
+0000ab40: 7273 2929 5d0a 2020 2020 2020 2020 656c  rs))].        el
+0000ab50: 6966 2027 4356 2720 696e 2073 656c 662e  if 'CV' in self.
+0000ab60: 7363 6f72 655f 6675 6e63 3a0a 2020 2020  score_func:.    
+0000ab70: 2020 2020 2020 2020 7265 7475 726e 202d          return -
+0000ab80: 3120 2a20 6e70 2e6d 6561 6e28 795f 7072  1 * np.mean(y_pr
+0000ab90: 6564 292c 0a20 2020 2020 2020 2065 6c73  ed),.        els
+0000aba0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+0000abb0: 6169 7365 2045 7863 6570 7469 6f6e 0a0a  aise Exception..
+0000abc0: 2020 2020 6465 6620 6361 6c63 756c 6174      def calculat
+0000abd0: 655f 6361 7365 5f76 616c 7565 7328 7365  e_case_values(se
+0000abe0: 6c66 2c20 696e 6469 7669 6475 616c 2c20  lf, individual, 
+0000abf0: 592c 2079 5f70 7265 6429 3a0a 2020 2020  Y, y_pred):.    
+0000ac00: 2020 2020 2320 4d69 6e69 6d69 7a65 2066      # Minimize f
+0000ac10: 6974 6e65 7373 2076 616c 7565 730a 2020  itness values.  
+0000ac20: 2020 2020 2020 6966 2073 656c 662e 7363        if self.sc
+0000ac30: 6f72 655f 6675 6e63 203d 3d20 2752 3227  ore_func == 'R2'
+0000ac40: 206f 7220 7365 6c66 2e73 636f 7265 5f66   or self.score_f
+0000ac50: 756e 6320 3d3d 2027 4d53 452d 5661 7269  unc == 'MSE-Vari
+0000ac60: 616e 6365 2720 6f72 2073 656c 662e 7363  ance' or self.sc
+0000ac70: 6f72 655f 6675 6e63 203d 3d20 274c 6f77  ore_func == 'Low
+0000ac80: 6572 2d42 6f75 6e64 273a 0a20 2020 2020  er-Bound':.     
+0000ac90: 2020 2020 2020 2069 6e64 6976 6964 7561         individua
+0000aca0: 6c2e 6361 7365 5f76 616c 7565 7320 3d20  l.case_values = 
+0000acb0: 2828 795f 7072 6564 202d 2059 2e66 6c61  ((y_pred - Y.fla
+0000acc0: 7474 656e 2829 292e 666c 6174 7465 6e28  tten()).flatten(
+0000acd0: 2929 202a 2a20 320a 2020 2020 2020 2020  )) ** 2.        
+0000ace0: 2020 2020 2320 696e 6469 7669 6475 616c      # individual
+0000acf0: 2e63 6173 655f 7661 6c75 6573 203d 2028  .case_values = (
+0000ad00: 2879 5f70 7265 6420 2d20 592e 666c 6174  (y_pred - Y.flat
+0000ad10: 7465 6e28 2929 2e66 6c61 7474 656e 2829  ten()).flatten()
+0000ad20: 2920 2a2a 2034 0a20 2020 2020 2020 2065  ) ** 4.        e
+0000ad30: 6c69 6620 7365 6c66 2e73 636f 7265 5f66  lif self.score_f
+0000ad40: 756e 6320 3d3d 2027 4d41 4527 3a0a 2020  unc == 'MAE':.  
+0000ad50: 2020 2020 2020 2020 2020 696e 6469 7669            indivi
+0000ad60: 6475 616c 2e63 6173 655f 7661 6c75 6573  dual.case_values
+0000ad70: 203d 206e 702e 6162 7328 2828 795f 7072   = np.abs(((y_pr
+0000ad80: 6564 202d 2059 2e66 6c61 7474 656e 2829  ed - Y.flatten()
+0000ad90: 292e 666c 6174 7465 6e28 2929 290a 2020  ).flatten())).  
+0000ada0: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
+0000adb0: 7363 6f72 655f 6675 6e63 203d 3d20 2753  score_func == 'S
+0000adc0: 7065 6172 6d61 6e27 3a0a 2020 2020 2020  pearman':.      
+0000add0: 2020 2020 2020 696e 6469 7669 6475 616c        individual
+0000ade0: 2e63 6173 655f 7661 6c75 6573 203d 206e  .case_values = n
+0000adf0: 702e 6162 7328 7261 6e6b 6461 7461 2879  p.abs(rankdata(y
+0000ae00: 5f70 7265 6429 202d 2072 616e 6b64 6174  _pred) - rankdat
+0000ae10: 6128 592e 666c 6174 7465 6e28 2929 292e  a(Y.flatten())).
+0000ae20: 666c 6174 7465 6e28 290a 2020 2020 2020  flatten().      
+0000ae30: 2020 656c 6966 2027 4356 2720 696e 2073    elif 'CV' in s
+0000ae40: 656c 662e 7363 6f72 655f 6675 6e63 3a0a  elf.score_func:.
+0000ae50: 2020 2020 2020 2020 2020 2020 696e 6469              indi
+0000ae60: 7669 6475 616c 2e63 6173 655f 7661 6c75  vidual.case_valu
+0000ae70: 6573 203d 202d 3120 2a20 795f 7072 6564  es = -1 * y_pred
+0000ae80: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
+0000ae90: 6c66 2e73 636f 7265 5f66 756e 6320 3d3d  lf.score_func ==
+0000aea0: 2027 4e6f 7665 6c74 7953 6561 7263 6827   'NoveltySearch'
+0000aeb0: 3a0a 2020 2020 2020 2020 2020 2020 6261  :.            ba
+0000aec0: 7365 5f76 616c 7565 7320 3d20 2879 5f70  se_values = (y_p
+0000aed0: 7265 642e 666c 6174 7465 6e28 2920 2d20  red.flatten() - 
+0000aee0: 592e 666c 6174 7465 6e28 2929 202a 2a20  Y.flatten()) ** 
+0000aef0: 320a 2020 2020 2020 2020 2020 2020 6966  2.            if
+0000af00: 206c 656e 2873 656c 662e 686f 6629 203d   len(self.hof) =
+0000af10: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
+0000af20: 2020 2020 2023 2066 6972 7374 2067 656e       # first gen
+0000af30: 6572 6174 696f 6e0a 2020 2020 2020 2020  eration.        
+0000af40: 2020 2020 2020 2020 696e 6469 7669 6475          individu
+0000af50: 616c 2e63 6173 655f 7661 6c75 6573 203d  al.case_values =
+0000af60: 206e 702e 636f 6e63 6174 656e 6174 6528   np.concatenate(
+0000af70: 5b62 6173 655f 7661 6c75 6573 2c20 6e70  [base_values, np
+0000af80: 2e66 756c 6c5f 6c69 6b65 2862 6173 655f  .full_like(base_
+0000af90: 7661 6c75 6573 2c20 3029 5d29 0a20 2020  values, 0)]).   
+0000afa0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0000afb0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0000afc0: 206d 6178 696d 697a 6520 6372 6f73 7320   maximize cross 
+0000afd0: 656e 7472 6f70 790a 2020 2020 2020 2020  entropy.        
+0000afe0: 2020 2020 2020 2020 656e 7365 6d62 6c65          ensemble
+0000aff0: 5f76 616c 7565 203d 206e 702e 6d65 616e  _value = np.mean
+0000b000: 285b 782e 7072 6564 6963 7465 645f 7661  ([x.predicted_va
+0000b010: 6c75 6573 2066 6f72 2078 2069 6e20 7365  lues for x in se
+0000b020: 6c66 2e68 6f66 5d2c 2061 7869 733d 3029  lf.hof], axis=0)
+0000b030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b040: 2061 6d62 6967 7569 7479 203d 2028 795f   ambiguity = (y_
+0000b050: 7072 6564 2e66 6c61 7474 656e 2829 202d  pred.flatten() -
+0000b060: 2065 6e73 656d 626c 655f 7661 6c75 6529   ensemble_value)
+0000b070: 202a 2a20 320a 2020 2020 2020 2020 2020   ** 2.          
+0000b080: 2020 2020 2020 616d 6269 6775 6974 7920        ambiguity 
+0000b090: 2a3d 2073 656c 662e 6e6f 7665 6c74 795f  *= self.novelty_
+0000b0a0: 7765 6967 6874 0a20 2020 2020 2020 2020  weight.         
+0000b0b0: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
+0000b0c0: 6e28 616d 6269 6775 6974 7929 203d 3d20  n(ambiguity) == 
+0000b0d0: 6c65 6e28 795f 7072 6564 2e66 6c61 7474  len(y_pred.flatt
+0000b0e0: 656e 2829 290a 2020 2020 2020 2020 2020  en()).          
+0000b0f0: 2020 2020 2020 696e 6469 7669 6475 616c        individual
+0000b100: 2e63 6173 655f 7661 6c75 6573 203d 206e  .case_values = n
+0000b110: 702e 636f 6e63 6174 656e 6174 6528 5b62  p.concatenate([b
+0000b120: 6173 655f 7661 6c75 6573 2c20 2d31 202a  ase_values, -1 *
+0000b130: 2061 6d62 6967 7569 7479 5d29 0a20 2020   ambiguity]).   
+0000b140: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0000b150: 2020 2020 2020 2072 6169 7365 2045 7863         raise Exc
+0000b160: 6570 7469 6f6e 0a0a 2020 2020 6465 6620  eption..    def 
+0000b170: 7472 6169 6e5f 6669 6e61 6c5f 6d6f 6465  train_final_mode
+0000b180: 6c28 7365 6c66 2c20 696e 6469 7669 6475  l(self, individu
+0000b190: 616c 3a20 4d75 6c74 6970 6c65 4765 6e65  al: MultipleGene
+0000b1a0: 4750 2c20 5970 2c20 592c 2066 6f72 6365  GP, Yp, Y, force
+0000b1b0: 5f74 7261 696e 696e 673d 4661 6c73 6529  _training=False)
+0000b1c0: 3a0a 2020 2020 2020 2020 6966 2073 656c  :.        if sel
+0000b1d0: 662e 6261 7365 5f6c 6561 726e 6572 203d  f.base_learner =
+0000b1e0: 3d20 2746 6173 742d 536f 6674 2d50 4c54  = 'Fast-Soft-PLT
+0000b1f0: 7265 652d 454d 273a 0a20 2020 2020 2020  ree-EM':.       
+0000b200: 2020 2020 2073 656c 662e 6261 7365 5f6c       self.base_l
+0000b210: 6561 726e 6572 203d 2027 536f 6674 2d50  earner = 'Soft-P
+0000b220: 4c54 7265 652d 454d 270a 2020 2020 2020  LTree-EM'.      
+0000b230: 2020 2020 2020 696e 6469 7669 6475 616c        individual
+0000b240: 2e70 6970 6520 3d20 7365 6c66 2e67 6574  .pipe = self.get
+0000b250: 5f62 6173 655f 6d6f 6465 6c28 290a 2020  _base_model().  
+0000b260: 2020 2020 2020 6966 2073 656c 662e 6261        if self.ba
+0000b270: 7365 5f6c 6561 726e 6572 203d 3d20 274c  se_learner == 'L
+0000b280: 6173 736f 2d52 6964 6765 4356 273a 0a20  asso-RidgeCV':. 
+0000b290: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000b2a0: 6261 7365 5f6c 6561 726e 6572 203d 2027  base_learner = '
+0000b2b0: 5269 6467 6543 5627 0a20 2020 2020 2020  RidgeCV'.       
+0000b2c0: 2020 2020 2069 6e64 6976 6964 7561 6c2e       individual.
+0000b2d0: 7069 7065 203d 2073 656c 662e 6765 745f  pipe = self.get_
+0000b2e0: 6261 7365 5f6d 6f64 656c 2829 0a20 2020  base_model().   
+0000b2f0: 2020 2020 2020 2020 2073 656c 662e 6261           self.ba
+0000b300: 7365 5f6c 6561 726e 6572 203d 2027 4c61  se_learner = 'La
+0000b310: 7373 6f2d 5269 6467 6543 5627 0a20 2020  sso-RidgeCV'.   
+0000b320: 2020 2020 2069 6620 7365 6c66 2e62 6173       if self.bas
+0000b330: 655f 6c65 6172 6e65 7220 3d3d 2027 5269  e_learner == 'Ri
+0000b340: 6467 6543 562d 454e 6574 273a 0a20 2020  dgeCV-ENet':.   
+0000b350: 2020 2020 2020 2020 2073 656c 662e 6261           self.ba
+0000b360: 7365 5f6c 6561 726e 6572 203d 2027 456c  se_learner = 'El
+0000b370: 6173 7469 634e 6574 4356 270a 2020 2020  asticNetCV'.    
+0000b380: 2020 2020 2020 2020 696e 6469 7669 6475          individu
+0000b390: 616c 2e70 6970 6520 3d20 7365 6c66 2e67  al.pipe = self.g
+0000b3a0: 6574 5f62 6173 655f 6d6f 6465 6c28 290a  et_base_model().
+0000b3b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000b3c0: 2e62 6173 655f 6c65 6172 6e65 7220 3d20  .base_learner = 
+0000b3d0: 2752 6964 6765 4356 2d45 4e65 7427 0a20  'RidgeCV-ENet'. 
+0000b3e0: 2020 2020 2020 2069 6620 7365 6c66 2e69         if self.i
+0000b3f0: 6d62 616c 616e 6365 645f 636f 6e66 6967  mbalanced_config
+0000b400: 7572 6174 696f 6e2e 6261 6c61 6e63 6564  uration.balanced
+0000b410: 5f66 696e 616c 5f74 7261 696e 696e 673a  _final_training:
+0000b420: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
+0000b430: 6976 6964 7561 6c2e 7069 7065 203d 2073  ividual.pipe = s
+0000b440: 656c 662e 6765 745f 6261 7365 5f6d 6f64  elf.get_base_mod
+0000b450: 656c 2829 0a20 2020 2020 2020 2023 2061  el().        # a
+0000b460: 766f 6964 2072 652d 7472 6169 6e69 6e67  void re-training
+0000b470: 0a20 2020 2020 2020 206d 6f64 656c 203d  .        model =
+0000b480: 2069 6e64 6976 6964 7561 6c2e 7069 7065   individual.pipe
+0000b490: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+0000b4a0: 2e62 6173 6963 5f70 7269 6d69 7469 7665  .basic_primitive
+0000b4b0: 7320 3d3d 2027 4d4c 2720 616e 6420 6d6f  s == 'ML' and mo
+0000b4c0: 6465 6c2e 7374 6570 735b 305d 5b30 5d20  del.steps[0][0] 
+0000b4d0: 213d 2027 6665 6174 7572 6527 3a0a 2020  != 'feature':.  
+0000b4e0: 2020 2020 2020 2020 2020 696e 6469 7669            indivi
+0000b4f0: 6475 616c 2e70 6970 6520 3d20 7069 7065  dual.pipe = pipe
+0000b500: 5f63 6f6d 6269 6e65 2859 702c 206d 6f64  _combine(Yp, mod
+0000b510: 656c 290a 2020 2020 2020 2020 2020 2020  el).            
+0000b520: 6d6f 6465 6c20 3d20 696e 6469 7669 6475  model = individu
+0000b530: 616c 2e70 6970 650a 2020 2020 2020 2020  al.pipe.        
+0000b540: 2020 2020 5970 203d 2073 656c 662e 580a      Yp = self.X.
+0000b550: 2020 2020 2020 2020 6966 206e 6f74 2066          if not f
+0000b560: 6f72 6365 5f74 7261 696e 696e 673a 0a20  orce_training:. 
+0000b570: 2020 2020 2020 2020 2020 2023 2063 6865             # che
+0000b580: 636b 2074 6865 206e 6563 6573 7369 7479  ck the necessity
+0000b590: 206f 6620 7472 6169 6e69 6e67 0a20 2020   of training.   
+0000b5a0: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
+0000b5b0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0000b5c0: 2068 6173 6174 7472 2869 6e64 6976 6964   hasattr(individ
+0000b5d0: 7561 6c2c 2027 6163 7469 7665 5f67 656e  ual, 'active_gen
+0000b5e0: 655f 6e75 6d27 2920 616e 6420 696e 6469  e_num') and indi
+0000b5f0: 7669 6475 616c 2e61 6374 6976 655f 6765  vidual.active_ge
+0000b600: 6e65 5f6e 756d 203e 2030 3a0a 2020 2020  ne_num > 0:.    
+0000b610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b620: 696e 7075 745f 7369 7a65 203d 2069 6e64  input_size = ind
+0000b630: 6976 6964 7561 6c2e 6163 7469 7665 5f67  ividual.active_g
+0000b640: 656e 655f 6e75 6d0a 2020 2020 2020 2020  ene_num.        
+0000b650: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0000b660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b670: 2020 696e 7075 745f 7369 7a65 203d 206c    input_size = l
+0000b680: 656e 2869 6e64 6976 6964 7561 6c2e 6765  en(individual.ge
+0000b690: 6e65 290a 2020 2020 2020 2020 2020 2020  ne).            
+0000b6a0: 2020 2020 6966 2073 656c 662e 6261 7365      if self.base
+0000b6b0: 5f6c 6561 726e 6572 203d 3d20 274e 4e27  _learner == 'NN'
+0000b6c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000b6d0: 2020 2020 2020 696e 7075 745f 7369 7a65        input_size
+0000b6e0: 202b 3d20 7365 6c66 2e68 6964 6465 6e5f   += self.hidden_
+0000b6f0: 6c61 7965 7273 5b2d 315d 0a20 2020 2020  layers[-1].     
+0000b700: 2020 2020 2020 2020 2020 2069 6620 6861             if ha
+0000b710: 7361 7474 7228 6d6f 6465 6c2c 2027 7061  sattr(model, 'pa
+0000b720: 7274 6974 696f 6e5f 7363 6865 6d65 2729  rtition_scheme')
+0000b730: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000b740: 2020 2020 2020 696e 7075 745f 7369 7a65        input_size
+0000b750: 202b 3d20 310a 2020 2020 2020 2020 2020   += 1.          
+0000b760: 2020 2020 2020 6966 2073 656c 662e 6f72        if self.or
+0000b770: 6967 696e 616c 5f66 6561 7475 7265 733a  iginal_features:
+0000b780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b790: 2020 2020 2069 6e70 7574 5f73 697a 6520       input_size 
+0000b7a0: 2b3d 2073 656c 662e 582e 7368 6170 655b  += self.X.shape[
+0000b7b0: 315d 0a20 2020 2020 2020 2020 2020 2020  1].             
+0000b7c0: 2020 2069 6620 7365 6c66 2e69 6e74 726f     if self.intro
+0000b7d0: 6e5f 7072 6f62 6162 696c 6974 7920 3e20  n_probability > 
+0000b7e0: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
+0000b7f0: 2020 2020 2020 2069 6e70 7574 5f73 697a         input_siz
+0000b800: 6520 3d20 696e 6469 7669 6475 616c 2e61  e = individual.a
+0000b810: 6374 6976 655f 6765 6e65 2e73 756d 2829  ctive_gene.sum()
+0000b820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b830: 2069 6620 7365 6c66 2e62 6173 6963 5f70   if self.basic_p
+0000b840: 7269 6d69 7469 7665 7320 3d3d 2027 4d4c  rimitives == 'ML
+0000b850: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
+0000b860: 2020 2020 2020 2069 6e70 7574 5f73 697a         input_siz
+0000b870: 6520 3d20 7365 6c66 2e58 2e73 6861 7065  e = self.X.shape
+0000b880: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
+0000b890: 2020 2020 6966 2073 656c 662e 6d67 705f      if self.mgp_
+0000b8a0: 6d6f 6465 203d 3d20 2752 6567 6973 7465  mode == 'Registe
+0000b8b0: 7227 3a0a 2020 2020 2020 2020 2020 2020  r':.            
+0000b8c0: 2020 2020 2020 2020 696e 7075 745f 7369          input_si
+0000b8d0: 7a65 203d 2073 656c 662e 6e75 6d62 6572  ze = self.number
+0000b8e0: 5f6f 665f 7265 6769 7374 6572 0a20 2020  _of_register.   
+0000b8f0: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
+0000b900: 656c 2e70 7265 6469 6374 286e 702e 6f6e  el.predict(np.on
+0000b910: 6573 2828 312c 2069 6e70 7574 5f73 697a  es((1, input_siz
+0000b920: 6529 2929 0a20 2020 2020 2020 2020 2020  e))).           
+0000b930: 2020 2020 2072 6574 7572 6e20 4e6f 6e65       return None
+0000b940: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
+0000b950: 6570 7420 4e6f 7446 6974 7465 6445 7272  ept NotFittedErr
+0000b960: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
+0000b970: 2020 2020 7061 7373 0a0a 2020 2020 2020      pass..      
+0000b980: 2020 2320 656e 7375 7265 2065 6e73 656d    # ensure ensem
+0000b990: 626c 6520 6261 7365 206c 6561 6e65 7220  ble base leaner 
+0000b9a0: 7769 6c6c 206e 6f74 2062 6520 7265 7472  will not be retr
+0000b9b0: 6169 6e65 640a 2020 2020 2020 2020 6173  ained.        as
+0000b9c0: 7365 7274 2073 656c 662e 6261 7365 5f6c  sert self.base_l
+0000b9d0: 6561 726e 6572 2021 3d20 2752 616e 646f  earner != 'Rando
+0000b9e0: 6d2d 4454 2d50 6c75 7327 0a0a 2020 2020  m-DT-Plus'..    
+0000b9f0: 2020 2020 6966 2073 656c 662e 6261 7365      if self.base
+0000ba00: 5f6c 6561 726e 6572 203d 3d20 274e 4e27  _learner == 'NN'
+0000ba10: 3a0a 2020 2020 2020 2020 2020 2020 6e6e  :.            nn
+0000ba20: 5f70 7265 6469 6374 696f 6e20 3d20 6765  _prediction = ge
+0000ba30: 745f 6163 7469 7661 7469 6f6e 7328 7365  t_activations(se
+0000ba40: 6c66 2e6e 6575 7261 6c5f 6e65 7477 6f72  lf.neural_networ
+0000ba50: 6b2c 2073 656c 662e 5829 5b2d 325d 0a20  k, self.X)[-2]. 
+0000ba60: 2020 2020 2020 2020 2020 2059 7020 3d20             Yp = 
+0000ba70: 6e70 2e63 6f6e 6361 7465 6e61 7465 285b  np.concatenate([
+0000ba80: 5970 2c20 6e6e 5f70 7265 6469 6374 696f  Yp, nn_predictio
+0000ba90: 6e5d 2c20 6178 6973 3d31 290a 0a20 2020  n], axis=1)..   
+0000baa0: 2020 2020 2069 6620 6861 7361 7474 7228       if hasattr(
+0000bab0: 6d6f 6465 6c2c 2027 7061 7274 6974 696f  model, 'partitio
+0000bac0: 6e5f 7363 6865 6d65 2729 3a0a 2020 2020  n_scheme'):.    
+0000bad0: 2020 2020 2020 2020 7061 7274 6974 696f          partitio
+0000bae0: 6e5f 7363 6865 6d65 203d 206d 6f64 656c  n_scheme = model
+0000baf0: 2e70 6172 7469 7469 6f6e 5f73 6368 656d  .partition_schem
+0000bb00: 650a 2020 2020 2020 2020 2020 2020 5970  e.            Yp
+0000bb10: 203d 206e 702e 636f 6e63 6174 656e 6174   = np.concatenat
+0000bb20: 6528 5b59 702c 206e 702e 7265 7368 6170  e([Yp, np.reshap
+0000bb30: 6528 7061 7274 6974 696f 6e5f 7363 6865  e(partition_sche
+0000bb40: 6d65 2c20 282d 312c 2031 2929 5d2c 2061  me, (-1, 1))], a
+0000bb50: 7869 733d 3129 0a0a 2020 2020 2020 2020  xis=1)..        
+0000bb60: 6966 2073 656c 662e 696e 7472 6f6e 5f70  if self.intron_p
+0000bb70: 726f 6261 6269 6c69 7479 203e 2030 3a0a  robability > 0:.
+0000bb80: 2020 2020 2020 2020 2020 2020 5970 203d              Yp =
+0000bb90: 2059 705b 3a2c 2069 6e64 6976 6964 7561   Yp[:, individua
+0000bba0: 6c2e 6163 7469 7665 5f67 656e 655d 0a0a  l.active_gene]..
+0000bbb0: 2020 2020 2020 2020 2320 7472 6169 6e20          # train 
+0000bbc0: 6669 6e61 6c20 6d6f 6465 6c0a 2020 2020  final model.    
+0000bbd0: 2020 2020 6966 2073 656c 662e 626f 6f74      if self.boot
+0000bbe0: 7374 7261 705f 7472 6169 6e69 6e67 2061  strap_training a
+0000bbf0: 6e64 206e 6f74 2066 6f72 6365 5f74 7261  nd not force_tra
+0000bc00: 696e 696e 673a 0a20 2020 2020 2020 2020  ining:.         
+0000bc10: 2020 2073 616d 706c 6520 3d20 6e70 2e72     sample = np.r
+0000bc20: 616e 646f 6d2e 7261 6e64 696e 7428 302c  andom.randint(0,
+0000bc30: 206c 656e 2859 292c 2073 697a 653d 286c   len(Y), size=(l
+0000bc40: 656e 2859 2929 290a 0a20 2020 2020 2020  en(Y)))..       
+0000bc50: 2020 2020 2023 2067 6574 206f 7574 2d6f       # get out-o
+0000bc60: 662d 6261 6720 696e 6469 6365 730a 2020  f-bag indices.  
+0000bc70: 2020 2020 2020 2020 2020 6368 6f73 656e            chosen
+0000bc80: 203d 206e 702e 7a65 726f 735f 6c69 6b65   = np.zeros_like
+0000bc90: 2859 290a 2020 2020 2020 2020 2020 2020  (Y).            
+0000bca0: 6368 6f73 656e 5b73 616d 706c 655d 203d  chosen[sample] =
+0000bcb0: 2031 0a20 2020 2020 2020 2020 2020 206f   1.            o
+0000bcc0: 7574 5f6f 665f 6261 6720 3d20 6e70 2e77  ut_of_bag = np.w
+0000bcd0: 6865 7265 2863 686f 7365 6e20 3d3d 2030  here(chosen == 0
+0000bce0: 295b 305d 0a20 2020 2020 2020 2020 2020  )[0].           
+0000bcf0: 2069 6e64 6976 6964 7561 6c2e 6f75 745f   individual.out_
+0000bd00: 6f66 5f62 6167 203d 206f 7574 5f6f 665f  of_bag = out_of_
+0000bd10: 6261 670a 0a20 2020 2020 2020 2020 2020  bag..           
+0000bd20: 2023 2063 6f6e 7665 7274 2073 616d 706c   # convert sampl
+0000bd30: 6520 696e 6465 7820 746f 2077 6569 6768  e index to weigh
+0000bd40: 740a 2020 2020 2020 2020 2020 2020 6e5f  t.            n_
+0000bd50: 7361 6d70 6c65 7320 3d20 6c65 6e28 5929  samples = len(Y)
+0000bd60: 0a20 2020 2020 2020 2020 2020 2063 7572  .            cur
+0000bd70: 725f 7361 6d70 6c65 5f77 6569 6768 7420  r_sample_weight 
+0000bd80: 3d20 6e70 2e6f 6e65 7328 286e 5f73 616d  = np.ones((n_sam
+0000bd90: 706c 6573 2c29 2c20 6474 7970 653d 6e70  ples,), dtype=np
+0000bda0: 2e66 6c6f 6174 3634 290a 2020 2020 2020  .float64).      
+0000bdb0: 2020 2020 2020 7361 6d70 6c65 5f63 6f75        sample_cou
+0000bdc0: 6e74 7320 3d20 6e70 2e62 696e 636f 756e  nts = np.bincoun
+0000bdd0: 7428 7361 6d70 6c65 2c20 6d69 6e6c 656e  t(sample, minlen
+0000bde0: 6774 683d 6e5f 7361 6d70 6c65 7329 0a20  gth=n_samples). 
+0000bdf0: 2020 2020 2020 2020 2020 2063 7572 725f             curr_
+0000be00: 7361 6d70 6c65 5f77 6569 6768 7420 2a3d  sample_weight *=
+0000be10: 2073 616d 706c 655f 636f 756e 7473 0a0a   sample_counts..
+0000be20: 2020 2020 2020 2020 2020 2020 696e 6469              indi
+0000be30: 7669 6475 616c 2e70 6970 652e 6669 7428  vidual.pipe.fit(
+0000be40: 5970 2c20 592c 2052 6964 6765 5f5f 7361  Yp, Y, Ridge__sa
+0000be50: 6d70 6c65 5f77 6569 6768 743d 6375 7272  mple_weight=curr
+0000be60: 5f73 616d 706c 655f 7765 6967 6874 290a  _sample_weight).
+0000be70: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0000be80: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+0000be90: 662e 696d 6261 6c61 6e63 6564 5f63 6f6e  f.imbalanced_con
+0000bea0: 6669 6775 7261 7469 6f6e 2e62 616c 616e  figuration.balan
+0000beb0: 6365 645f 6669 6e61 6c5f 7472 6169 6e69  ced_final_traini
+0000bec0: 6e67 3a0a 2020 2020 2020 2020 2020 2020  ng:.            
+0000bed0: 2020 2020 7361 6d70 6c65 5f77 6569 6768      sample_weigh
+0000bee0: 7420 3d20 6765 745f 7361 6d70 6c65 5f77  t = get_sample_w
+0000bef0: 6569 6768 7428 7365 6c66 2e58 2c20 7365  eight(self.X, se
+0000bf00: 6c66 2e74 6573 745f 582c 2073 656c 662e  lf.test_X, self.
+0000bf10: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
+0000bf20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bf30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bf40: 2020 2020 2073 656c 662e 696d 6261 6c61       self.imbala
+0000bf50: 6e63 6564 5f63 6f6e 6669 6775 7261 7469  nced_configurati
+0000bf60: 6f6e 290a 2020 2020 2020 2020 2020 2020  on).            
+0000bf70: 2020 2020 696e 6469 7669 6475 616c 2e70      individual.p
+0000bf80: 6970 652e 6669 7428 5970 2c20 592c 2052  ipe.fit(Yp, Y, R
+0000bf90: 6964 6765 5f5f 7361 6d70 6c65 5f77 6569  idge__sample_wei
+0000bfa0: 6768 743d 7361 6d70 6c65 5f77 6569 6768  ght=sample_weigh
+0000bfb0: 7429 0a20 2020 2020 2020 2020 2020 2065  t).            e
+0000bfc0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0000bfd0: 2020 2020 2069 6e64 6976 6964 7561 6c2e       individual.
+0000bfe0: 7069 7065 2e66 6974 2859 702c 2059 290a  pipe.fit(Yp, Y).
+0000bff0: 2020 2020 2020 2020 2020 2020 6f75 745f              out_
+0000c000: 6f66 5f62 6167 203d 204e 6f6e 650a 0a20  of_bag = None.. 
+0000c010: 2020 2020 2020 2023 2066 6561 7475 7265         # feature
+0000c020: 2069 6d70 6f72 7461 6e63 6520 6765 6e65   importance gene
+0000c030: 7261 7469 6f6e 0a20 2020 2020 2020 2069  ration.        i
+0000c040: 6620 6d6f 6465 6c2e 7374 6570 735b 305d  f model.steps[0]
+0000c050: 5b30 5d20 3d3d 2027 6665 6174 7572 6527  [0] == 'feature'
+0000c060: 3a0a 2020 2020 2020 2020 2020 2020 6261  :.            ba
+0000c070: 7365 5f6d 6f64 656c 203d 206d 6f64 656c  se_model = model
+0000c080: 5b27 6d6f 6465 6c27 5d5b 2752 6964 6765  ['model']['Ridge
+0000c090: 275d 0a20 2020 2020 2020 2065 6c73 653a  '].        else:
+0000c0a0: 0a20 2020 2020 2020 2020 2020 2062 6173  .            bas
+0000c0b0: 655f 6d6f 6465 6c20 3d20 6d6f 6465 6c5b  e_model = model[
+0000c0c0: 2752 6964 6765 275d 0a20 2020 2020 2020  'Ridge'].       
+0000c0d0: 2069 6620 6861 7361 7474 7228 6261 7365   if hasattr(base
+0000c0e0: 5f6d 6f64 656c 2c20 2766 6561 7475 7265  _model, 'feature
+0000c0f0: 5f69 6d70 6f72 7461 6e63 6573 5f27 293a  _importances_'):
+0000c100: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
+0000c110: 6976 6964 7561 6c2e 636f 6566 203d 2062  ividual.coef = b
+0000c120: 6173 655f 6d6f 6465 6c2e 6665 6174 7572  ase_model.featur
+0000c130: 655f 696d 706f 7274 616e 6365 735f 5b3a  e_importances_[:
+0000c140: 7365 6c66 2e67 656e 655f 6e75 6d5d 0a20  self.gene_num]. 
+0000c150: 2020 2020 2020 2065 6c69 6620 6861 7361         elif hasa
+0000c160: 7474 7228 6261 7365 5f6d 6f64 656c 2c20  ttr(base_model, 
+0000c170: 2763 6f65 665f 2729 3a0a 2020 2020 2020  'coef_'):.      
+0000c180: 2020 2020 2020 696e 6469 7669 6475 616c        individual
+0000c190: 2e63 6f65 6620 3d20 6e70 2e61 6273 2862  .coef = np.abs(b
+0000c1a0: 6173 655f 6d6f 6465 6c2e 636f 6566 5f5b  ase_model.coef_[
+0000c1b0: 3a73 656c 662e 6765 6e65 5f6e 756d 5d29  :self.gene_num])
+0000c1c0: 2e66 6c61 7474 656e 2829 0a20 2020 2020  .flatten().     
+0000c1d0: 2020 2023 2061 7373 6572 7420 6c65 6e28     # assert len(
+0000c1e0: 696e 6469 7669 6475 616c 2e63 6f65 6629  individual.coef)
+0000c1f0: 203d 3d20 7365 6c66 2e67 656e 655f 6e75   == self.gene_nu
+0000c200: 6d0a 2020 2020 2020 2020 7265 7475 726e  m.        return
+0000c210: 206f 7574 5f6f 665f 6261 670a 0a20 2020   out_of_bag..   
+0000c220: 2064 6566 2065 6e74 726f 7079 5f63 616c   def entropy_cal
+0000c230: 6375 6c61 7469 6f6e 2873 656c 6629 3a0a  culation(self):.
+0000c240: 2020 2020 2020 2020 7061 7373 0a0a 2020          pass..  
+0000c250: 2020 6465 6620 6765 745f 6261 7365 5f6d    def get_base_m
+0000c260: 6f64 656c 2873 656c 662c 2072 6567 756c  odel(self, regul
+0000c270: 6172 697a 6174 696f 6e5f 7261 7469 6f3d  arization_ratio=
+0000c280: 312c 2062 6173 655f 6d6f 6465 6c3d 4e6f  1, base_model=No
+0000c290: 6e65 2c20 6c61 7373 6f5f 616c 7068 613d  ne, lasso_alpha=
+0000c2a0: 4e6f 6e65 293a 0a20 2020 2020 2020 2023  None):.        #
+0000c2b0: 2047 6574 2074 6865 2062 6173 6520 6d6f   Get the base mo
+0000c2c0: 6465 6c20 6261 7365 6420 6f6e 2074 6865  del based on the
+0000c2d0: 2068 7970 6572 7061 7261 6d65 7465 720a   hyperparameter.
+0000c2e0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0000c2f0: 6261 7365 5f6c 6561 726e 6572 2069 6e20  base_learner in 
+0000c300: 5b27 4454 272c 2027 4454 2d52 616e 646f  ['DT', 'DT-Rando
+0000c310: 6d44 5427 2c20 2750 4341 2d44 5427 5d20  mDT', 'PCA-DT'] 
+0000c320: 6f72 205c 0a20 2020 2020 2020 2020 2020  or \.           
+0000c330: 2062 6173 655f 6d6f 6465 6c20 696e 205b   base_model in [
+0000c340: 2744 5427 2c20 2744 542d 5261 6e64 6f6d  'DT', 'DT-Random
+0000c350: 4454 272c 2027 5043 412d 4454 275d 3a0a  DT', 'PCA-DT']:.
+0000c360: 2020 2020 2020 2020 2020 2020 7269 6467              ridg
+0000c370: 655f 6d6f 6465 6c20 3d20 4465 6369 7369  e_model = Decisi
+0000c380: 6f6e 5472 6565 5265 6772 6573 736f 7228  onTreeRegressor(
+0000c390: 6d61 785f 6465 7074 683d 7365 6c66 2e6d  max_depth=self.m
+0000c3a0: 6178 5f74 7265 655f 6465 7074 682c 0a20  ax_tree_depth,. 
+0000c3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c3d0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0000c3e0: 696e 5f73 616d 706c 6573 5f6c 6561 663d  in_samples_leaf=
+0000c3f0: 7365 6c66 2e6d 696e 5f73 616d 706c 6573  self.min_samples
+0000c400: 5f6c 6561 6629 0a20 2020 2020 2020 2065  _leaf).        e
+0000c410: 6c69 6620 7365 6c66 2e62 6173 655f 6c65  lif self.base_le
+0000c420: 6172 6e65 7220 3d3d 2027 5369 6d70 6c65  arner == 'Simple
+0000c430: 4454 2d52 616e 646f 6d44 5427 3a0a 2020  DT-RandomDT':.  
+0000c440: 2020 2020 2020 2020 2020 7269 6467 655f            ridge_
+0000c450: 6d6f 6465 6c20 3d20 4465 6369 7369 6f6e  model = Decision
+0000c460: 5472 6565 5265 6772 6573 736f 7228 6d61  TreeRegressor(ma
+0000c470: 785f 6465 7074 683d 3329 0a20 2020 2020  x_depth=3).     
+0000c480: 2020 2065 6c69 6620 7365 6c66 2e62 6173     elif self.bas
+0000c490: 655f 6c65 6172 6e65 7220 696e 205b 2752  e_learner in ['R
+0000c4a0: 616e 646f 6d2d 4454 272c 2027 5261 6e64  andom-DT', 'Rand
+0000c4b0: 6f6d 4454 2d44 5427 2c20 2752 616e 646f  omDT-DT', 'Rando
+0000c4c0: 6d2d 4454 2d50 6c75 7327 5d20 6f72 205c  m-DT-Plus'] or \
+0000c4d0: 0a20 2020 2020 2020 2020 2020 2062 6173  .            bas
+0000c4e0: 655f 6d6f 6465 6c20 696e 205b 2752 616e  e_model in ['Ran
+0000c4f0: 646f 6d2d 4454 272c 2027 5261 6e64 6f6d  dom-DT', 'Random
+0000c500: 4454 2d44 5427 2c20 2752 616e 646f 6d2d  DT-DT', 'Random-
+0000c510: 4454 2d50 6c75 7327 5d3a 0a20 2020 2020  DT-Plus']:.     
+0000c520: 2020 2020 2020 2072 6964 6765 5f6d 6f64         ridge_mod
+0000c530: 656c 203d 2044 6563 6973 696f 6e54 7265  el = DecisionTre
+0000c540: 6552 6567 7265 7373 6f72 2873 706c 6974  eRegressor(split
+0000c550: 7465 723d 2772 616e 646f 6d27 2c20 6d61  ter='random', ma
+0000c560: 785f 6465 7074 683d 7365 6c66 2e6d 6178  x_depth=self.max
+0000c570: 5f74 7265 655f 6465 7074 682c 0a20 2020  _tree_depth,.   
+0000c580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c5a0: 2020 2020 2020 2020 2020 2020 206d 696e               min
+0000c5b0: 5f73 616d 706c 6573 5f6c 6561 663d 7365  _samples_leaf=se
+0000c5c0: 6c66 2e6d 696e 5f73 616d 706c 6573 5f6c  lf.min_samples_l
+0000c5d0: 6561 6629 0a20 2020 2020 2020 2065 6c69  eaf).        eli
+0000c5e0: 6620 7365 6c66 2e62 6173 655f 6c65 6172  f self.base_lear
+0000c5f0: 6e65 7220 3d3d 2027 504c 2d54 7265 6527  ner == 'PL-Tree'
+0000c600: 3a0a 2020 2020 2020 2020 2020 2020 7269  :.            ri
+0000c610: 6467 655f 6d6f 6465 6c20 3d20 4c69 6e65  dge_model = Line
+0000c620: 6172 5472 6565 5265 6772 6573 736f 7228  arTreeRegressor(
+0000c630: 6261 7365 5f65 7374 696d 6174 6f72 3d4c  base_estimator=L
+0000c640: 696e 6561 7252 6567 7265 7373 696f 6e28  inearRegression(
+0000c650: 2929 0a20 2020 2020 2020 2065 6c69 6620  )).        elif 
+0000c660: 7365 6c66 2e62 6173 655f 6c65 6172 6e65  self.base_learne
+0000c670: 7220 3d3d 2027 5269 6467 6543 5627 206f  r == 'RidgeCV' o
+0000c680: 7220 7365 6c66 2e62 6173 655f 6c65 6172  r self.base_lear
+0000c690: 6e65 7220 3d3d 2027 5269 6467 6543 562d  ner == 'RidgeCV-
+0000c6a0: 454e 6574 273a 0a20 2020 2020 2020 2020  ENet':.         
+0000c6b0: 2020 2023 2066 726f 6d20 736b 6c65 6172     # from sklear
+0000c6c0: 6e2e 6c69 6e65 6172 5f6d 6f64 656c 2e5f  n.linear_model._
+0000c6d0: 636f 6f72 6469 6e61 7465 5f64 6573 6365  coordinate_desce
+0000c6e0: 6e74 2069 6d70 6f72 7420 5f61 6c70 6861  nt import _alpha
+0000c6f0: 5f67 7269 640a 2020 2020 2020 2020 2020  _grid.          
+0000c700: 2020 2320 616c 7068 6173 203d 205f 616c    # alphas = _al
+0000c710: 7068 615f 6772 6964 2873 656c 662e 582c  pha_grid(self.X,
+0000c720: 2073 656c 662e 792c 206e 6f72 6d61 6c69   self.y, normali
+0000c730: 7a65 3d54 7275 6529 0a20 2020 2020 2020  ze=True).       
+0000c740: 2020 2020 2069 6620 7365 6c66 2e72 6964       if self.rid
+0000c750: 6765 5f61 6c70 6861 7320 6973 204e 6f6e  ge_alphas is Non
+0000c760: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0000c770: 2020 2072 6964 6765 203d 205b 302e 312c     ridge = [0.1,
+0000c780: 2031 2c20 3130 5d0a 2020 2020 2020 2020   1, 10].        
+0000c790: 2020 2020 656c 6966 2073 656c 662e 7269      elif self.ri
+0000c7a0: 6467 655f 616c 7068 6173 203d 3d20 2741  dge_alphas == 'A
+0000c7b0: 7574 6f27 3a0a 2020 2020 2020 2020 2020  uto':.          
+0000c7c0: 2020 2020 2020 6966 2073 656c 662e 582e        if self.X.
+0000c7d0: 7368 6170 655b 305d 203c 2032 3030 3a0a  shape[0] < 200:.
+0000c7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c7f0: 2020 2020 7269 6467 6520 3d20 5b31 6531      ridge = [1e1
+0000c800: 2c20 3165 322c 2031 6533 5d0a 2020 2020  , 1e2, 1e3].    
+0000c810: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0000c820: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000c830: 2020 2020 2020 7269 6467 6520 3d20 5b30        ridge = [0
+0000c840: 2e31 2c20 312c 2031 305d 0a20 2020 2020  .1, 1, 10].     
+0000c850: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
+0000c860: 2e72 6964 6765 5f61 6c70 6861 7320 3d3d  .ridge_alphas ==
+0000c870: 2027 4175 746f 2d46 696e 6527 3a0a 2020   'Auto-Fine':.  
+0000c880: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0000c890: 2073 656c 662e 582e 7368 6170 655b 305d   self.X.shape[0]
+0000c8a0: 203c 2032 3030 3a0a 2020 2020 2020 2020   < 200:.        
+0000c8b0: 2020 2020 2020 2020 2020 2020 7269 6467              ridg
+0000c8c0: 6520 3d20 5b31 6531 2c20 3365 312c 2031  e = [1e1, 3e1, 1
+0000c8d0: 6532 2c20 3365 322c 2031 6533 5d0a 2020  e2, 3e2, 1e3].  
+0000c8e0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+0000c8f0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0000c900: 2020 2020 2020 2020 7269 6467 6520 3d20          ridge = 
+0000c910: 5b31 652d 312c 2033 652d 332c 2031 6530  [1e-1, 3e-3, 1e0
+0000c920: 2c20 3365 302c 2031 6531 5d0a 2020 2020  , 3e0, 1e1].    
+0000c930: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0000c940: 2020 2020 2020 2020 2020 2020 2020 7269                ri
+0000c950: 6467 6520 3d20 6576 616c 2873 656c 662e  dge = eval(self.
+0000c960: 7269 6467 655f 616c 7068 6173 290a 2020  ridge_alphas).  
+0000c970: 2020 2020 2020 2020 2020 7269 6467 655f            ridge_
+0000c980: 6d6f 6465 6c20 3d20 5269 6467 6543 5628  model = RidgeCV(
+0000c990: 616c 7068 6173 3d72 6964 6765 2c20 7374  alphas=ridge, st
+0000c9a0: 6f72 655f 6376 5f76 616c 7565 733d 5472  ore_cv_values=Tr
+0000c9b0: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
+0000c9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c9d0: 2020 2020 2020 7363 6f72 696e 673d 6d61        scoring=ma
+0000c9e0: 6b65 5f73 636f 7265 7228 7232 5f73 636f  ke_scorer(r2_sco
+0000c9f0: 7265 2929 0a20 2020 2020 2020 2065 6c69  re)).        eli
+0000ca00: 6620 7365 6c66 2e62 6173 655f 6c65 6172  f self.base_lear
+0000ca10: 6e65 7220 3d3d 2027 456c 6173 7469 634e  ner == 'ElasticN
+0000ca20: 6574 4356 273a 0a20 2020 2020 2020 2020  etCV':.         
+0000ca30: 2020 2072 6964 6765 5f6d 6f64 656c 203d     ridge_model =
+0000ca40: 2045 6c61 7374 6963 4e65 7443 5628 6c31   ElasticNetCV(l1
+0000ca50: 5f72 6174 696f 3d5b 2e31 2c20 2e35 2c20  _ratio=[.1, .5, 
+0000ca60: 2e37 2c20 2e39 2c20 2e39 352c 202e 3939  .7, .9, .95, .99
+0000ca70: 2c20 315d 2c20 6e5f 616c 7068 6173 3d31  , 1], n_alphas=1
+0000ca80: 3029 0a20 2020 2020 2020 2065 6c69 6620  0).        elif 
+0000ca90: 7365 6c66 2e62 6173 655f 6c65 6172 6e65  self.base_learne
+0000caa0: 7220 3d3d 2027 4c52 273a 0a20 2020 2020  r == 'LR':.     
+0000cab0: 2020 2020 2020 2072 6964 6765 5f6d 6f64         ridge_mod
+0000cac0: 656c 203d 204c 696e 6561 7252 6567 7265  el = LinearRegre
+0000cad0: 7373 696f 6e28 290a 2020 2020 2020 2020  ssion().        
+0000cae0: 656c 6966 2073 656c 662e 6261 7365 5f6c  elif self.base_l
+0000caf0: 6561 726e 6572 203d 3d20 274c 6173 736f  earner == 'Lasso
+0000cb00: 273a 0a20 2020 2020 2020 2020 2020 2072  ':.            r
+0000cb10: 6964 6765 5f6d 6f64 656c 203d 204c 6173  idge_model = Las
+0000cb20: 736f 4356 286e 5f61 6c70 6861 733d 3130  soCV(n_alphas=10
+0000cb30: 2c20 6d61 785f 6974 6572 3d31 3030 3029  , max_iter=1000)
+0000cb40: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
+0000cb50: 6c66 2e62 6173 655f 6c65 6172 6e65 7220  lf.base_learner 
+0000cb60: 3d3d 2027 4164 6170 7469 7665 4c61 7373  == 'AdaptiveLass
+0000cb70: 6f27 3a0a 2020 2020 2020 2020 2020 2020  o':.            
+0000cb80: 7269 6467 655f 6d6f 6465 6c20 3d20 4c61  ridge_model = La
+0000cb90: 7373 6f28 6c61 7373 6f5f 616c 7068 612c  sso(lasso_alpha,
+0000cba0: 2070 7265 636f 6d70 7574 653d 5472 7565   precompute=True
+0000cbb0: 2c20 6d61 785f 6974 6572 3d31 3030 3029  , max_iter=1000)
+0000cbc0: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
+0000cbd0: 6c66 2e62 6173 655f 6c65 6172 6e65 7220  lf.base_learner 
+0000cbe0: 3d3d 2027 5261 6e64 6f6d 5765 6967 6874  == 'RandomWeight
+0000cbf0: 5269 6467 6527 3a0a 2020 2020 2020 2020  Ridge':.        
+0000cc00: 2020 2020 7269 6467 655f 6d6f 6465 6c20      ridge_model 
+0000cc10: 3d20 5261 6e64 6f6d 5765 6967 6874 5269  = RandomWeightRi
+0000cc20: 6467 6528 290a 2020 2020 2020 2020 656c  dge().        el
+0000cc30: 6966 2073 656c 662e 6261 7365 5f6c 6561  if self.base_lea
+0000cc40: 726e 6572 203d 3d20 2752 6964 6765 2720  rner == 'Ridge' 
+0000cc50: 6f72 2062 6173 655f 6d6f 6465 6c20 3d3d  or base_model ==
+0000cc60: 2027 5269 6467 6527 205c 0a20 2020 2020   'Ridge' \.     
+0000cc70: 2020 2020 2020 206f 7220 7365 6c66 2e62         or self.b
+0000cc80: 6173 655f 6c65 6172 6e65 722e 7374 6172  ase_learner.star
+0000cc90: 7473 7769 7468 2827 4661 7374 2d27 2920  tswith('Fast-') 
+0000cca0: 5c0a 2020 2020 2020 2020 2020 2020 6f72  \.            or
+0000ccb0: 2073 656c 662e 6261 7365 5f6c 6561 726e   self.base_learn
+0000ccc0: 6572 203d 3d20 274e 4e27 3a0a 2020 2020  er == 'NN':.    
+0000ccd0: 2020 2020 2020 2020 7269 6467 655f 6d6f          ridge_mo
+0000cce0: 6465 6c20 3d20 5269 6467 6528 290a 2020  del = Ridge().  
+0000ccf0: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
+0000cd00: 6261 7365 5f6c 6561 726e 6572 203d 3d20  base_learner == 
+0000cd10: 2752 6964 6765 4454 273a 0a20 2020 2020  'RidgeDT':.     
+0000cd20: 2020 2020 2020 2072 6964 6765 5f6d 6f64         ridge_mod
+0000cd30: 656c 203d 2052 6964 6765 4454 2864 6563  el = RidgeDT(dec
+0000cd40: 6973 696f 6e5f 7472 6565 5f63 6f75 6e74  ision_tree_count
+0000cd50: 3d73 656c 662e 6465 6369 7369 6f6e 5f74  =self.decision_t
+0000cd60: 7265 655f 636f 756e 742c 0a20 2020 2020  ree_count,.     
+0000cd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cd80: 2020 2020 2020 2020 2020 2020 206d 6178               max
+0000cd90: 5f6c 6561 665f 6e6f 6465 733d 7365 6c66  _leaf_nodes=self
+0000cda0: 2e6d 6178 5f6c 6561 665f 6e6f 6465 7329  .max_leaf_nodes)
+0000cdb0: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
+0000cdc0: 6c66 2e62 6173 655f 6c65 6172 6e65 7220  lf.base_learner 
+0000cdd0: 3d3d 2027 5369 6d70 6c65 2d52 6964 6765  == 'Simple-Ridge
+0000cde0: 4454 273a 0a20 2020 2020 2020 2020 2020  DT':.           
+0000cdf0: 2072 6964 6765 5f6d 6f64 656c 203d 2052   ridge_model = R
+0000ce00: 6964 6765 4454 506c 7573 2864 6563 6973  idgeDTPlus(decis
+0000ce10: 696f 6e5f 7472 6565 5f63 6f75 6e74 3d30  ion_tree_count=0
+0000ce20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000ce30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ce40: 2020 2020 2020 2020 6d61 785f 6c65 6166          max_leaf
+0000ce50: 5f6e 6f64 6573 3d73 656c 662e 6d61 785f  _nodes=self.max_
+0000ce60: 6c65 6166 5f6e 6f64 6573 290a 2020 2020  leaf_nodes).    
+0000ce70: 2020 2020 656c 6966 2073 656c 662e 6261      elif self.ba
+0000ce80: 7365 5f6c 6561 726e 6572 203d 3d20 2752  se_learner == 'R
+0000ce90: 6964 6765 4454 2d50 6c75 7327 3a0a 2020  idgeDT-Plus':.  
+0000cea0: 2020 2020 2020 2020 2020 7269 6467 655f            ridge_
+0000ceb0: 6d6f 6465 6c20 3d20 5269 6467 6544 5450  model = RidgeDTP
+0000cec0: 6c75 7328 6465 6369 7369 6f6e 5f74 7265  lus(decision_tre
+0000ced0: 655f 636f 756e 743d 7365 6c66 2e64 6563  e_count=self.dec
+0000cee0: 6973 696f 6e5f 7472 6565 5f63 6f75 6e74  ision_tree_count
+0000cef0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000cf00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cf10: 2020 2020 2020 2020 6d61 785f 6c65 6166          max_leaf
+0000cf20: 5f6e 6f64 6573 3d73 656c 662e 6d61 785f  _nodes=self.max_
+0000cf30: 6c65 6166 5f6e 6f64 6573 290a 2020 2020  leaf_nodes).    
+0000cf40: 2020 2020 656c 6966 2073 656c 662e 6261      elif self.ba
+0000cf50: 7365 5f6c 6561 726e 6572 203d 3d20 2752  se_learner == 'R
+0000cf60: 6964 6765 4244 542d 506c 7573 273a 0a20  idgeBDT-Plus':. 
+0000cf70: 2020 2020 2020 2020 2020 2072 6964 6765             ridge
+0000cf80: 5f6d 6f64 656c 203d 2052 6964 6765 4454  _model = RidgeDT
+0000cf90: 506c 7573 2864 6563 6973 696f 6e5f 7472  Plus(decision_tr
+0000cfa0: 6565 5f63 6f75 6e74 3d73 656c 662e 6465  ee_count=self.de
+0000cfb0: 6369 7369 6f6e 5f74 7265 655f 636f 756e  cision_tree_coun
+0000cfc0: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+0000cfd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cfe0: 2020 2020 2020 2020 206d 6178 5f6c 6561           max_lea
+0000cff0: 665f 6e6f 6465 733d 7365 6c66 2e6d 6178  f_nodes=self.max
+0000d000: 5f6c 6561 665f 6e6f 6465 732c 0a20 2020  _leaf_nodes,.   
+0000d010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d030: 2020 2066 696e 616c 5f6d 6f64 656c 5f73     final_model_s
+0000d040: 706c 6974 7465 723d 2762 6573 7427 290a  plitter='best').
+0000d050: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
+0000d060: 662e 6261 7365 5f6c 6561 726e 6572 203d  f.base_learner =
+0000d070: 3d20 2745 5427 3a0a 2020 2020 2020 2020  = 'ET':.        
+0000d080: 2020 2020 7269 6467 655f 6d6f 6465 6c20      ridge_model 
+0000d090: 3d20 4578 7472 6154 7265 6573 5265 6772  = ExtraTreesRegr
+0000d0a0: 6573 736f 7228 6e5f 6573 7469 6d61 746f  essor(n_estimato
+0000d0b0: 7273 3d31 3030 290a 2020 2020 2020 2020  rs=100).        
+0000d0c0: 656c 6966 2073 656c 662e 6261 7365 5f6c  elif self.base_l
+0000d0d0: 6561 726e 6572 203d 3d20 2747 4244 5427  earner == 'GBDT'
+0000d0e0: 3a0a 2020 2020 2020 2020 2020 2020 7269  :.            ri
+0000d0f0: 6467 655f 6d6f 6465 6c20 3d20 4772 6164  dge_model = Grad
+0000d100: 6965 6e74 426f 6f73 7469 6e67 5265 6772  ientBoostingRegr
+0000d110: 6573 736f 7228 6c65 6172 6e69 6e67 5f72  essor(learning_r
+0000d120: 6174 653d 302e 382c 206e 5f65 7374 696d  ate=0.8, n_estim
+0000d130: 6174 6f72 733d 3529 0a20 2020 2020 2020  ators=5).       
+0000d140: 2065 6c69 6620 7365 6c66 2e62 6173 655f   elif self.base_
+0000d150: 6c65 6172 6e65 7220 3d3d 2027 4c69 6768  learner == 'Ligh
+0000d160: 7447 424d 273a 0a20 2020 2020 2020 2020  tGBM':.         
+0000d170: 2020 2072 6964 6765 5f6d 6f64 656c 203d     ridge_model =
+0000d180: 204c 4742 4d52 6567 7265 7373 6f72 286e   LGBMRegressor(n
+0000d190: 5f65 7374 696d 6174 6f72 733d 3130 2c20  _estimators=10, 
+0000d1a0: 6c65 6172 6e69 6e67 5f72 6174 653d 312c  learning_rate=1,
+0000d1b0: 206e 5f6a 6f62 733d 3129 0a20 2020 2020   n_jobs=1).     
+0000d1c0: 2020 2065 6c69 6620 7365 6c66 2e62 6173     elif self.bas
+0000d1d0: 655f 6c65 6172 6e65 7220 3d3d 2027 4c69  e_learner == 'Li
+0000d1e0: 6768 7447 424d 2d53 7475 6d70 2720 6f72  ghtGBM-Stump' or
+0000d1f0: 2062 6173 655f 6d6f 6465 6c20 3d3d 2027   base_model == '
+0000d200: 4c69 6768 7447 424d 2d53 7475 6d70 273a  LightGBM-Stump':
+0000d210: 0a20 2020 2020 2020 2020 2020 2072 6964  .            rid
+0000d220: 6765 5f6d 6f64 656c 203d 204c 4742 4d52  ge_model = LGBMR
+0000d230: 6567 7265 7373 6f72 286d 6178 5f64 6570  egressor(max_dep
+0000d240: 7468 3d31 2c20 6c65 6172 6e69 6e67 5f72  th=1, learning_r
+0000d250: 6174 653d 312c 0a20 2020 2020 2020 2020  ate=1,.         
+0000d260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d270: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0000d280: 5f65 7374 696d 6174 6f72 733d 6d61 7468  _estimators=math
+0000d290: 2e63 6569 6c28 6e70 2e6c 6f67 3228 7365  .ceil(np.log2(se
+0000d2a0: 6c66 2e58 2e73 6861 7065 5b30 5d29 292c  lf.X.shape[0])),
+0000d2b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d2d0: 2020 2020 2020 2020 206e 5f6a 6f62 733d           n_jobs=
+0000d2e0: 3129 0a20 2020 2020 2020 2065 6c69 6620  1).        elif 
+0000d2f0: 7365 6c66 2e62 6173 655f 6c65 6172 6e65  self.base_learne
+0000d300: 7220 3d3d 2027 4879 6272 6964 273a 0a20  r == 'Hybrid':. 
+0000d310: 2020 2020 2020 2020 2020 2072 6964 6765             ridge
+0000d320: 5f6d 6f64 656c 203d 2062 6173 655f 6d6f  _model = base_mo
+0000d330: 6465 6c0a 2020 2020 2020 2020 656c 6966  del.        elif
+0000d340: 2073 656c 662e 6261 7365 5f6c 6561 726e   self.base_learn
+0000d350: 6572 203d 3d20 2752 4246 273a 0a20 2020  er == 'RBF':.   
+0000d360: 2020 2020 2020 2020 2072 6964 6765 5f6d           ridge_m
+0000d370: 6f64 656c 203d 2052 4246 4e28 6d69 6e28  odel = RBFN(min(
+0000d380: 7365 6c66 2e58 2e73 6861 7065 5b30 5d2c  self.X.shape[0],
+0000d390: 2036 3429 290a 2020 2020 2020 2020 656c   64)).        el
+0000d3a0: 6966 2073 656c 662e 6261 7365 5f6c 6561  if self.base_lea
+0000d3b0: 726e 6572 203d 3d20 2753 5652 273a 0a20  rner == 'SVR':. 
+0000d3c0: 2020 2020 2020 2020 2020 2072 6964 6765             ridge
+0000d3d0: 5f6d 6f64 656c 203d 2053 5652 2829 0a20  _model = SVR(). 
+0000d3e0: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
+0000d3f0: 2e62 6173 655f 6c65 6172 6e65 7220 3d3d  .base_learner ==
+0000d400: 2027 4b4e 4e27 3a0a 2020 2020 2020 2020   'KNN':.        
+0000d410: 2020 2020 7269 6467 655f 6d6f 6465 6c20      ridge_model 
+0000d420: 3d20 4b4e 6569 6768 626f 7273 5265 6772  = KNeighborsRegr
+0000d430: 6573 736f 7228 290a 2020 2020 2020 2020  essor().        
+0000d440: 656c 6966 2073 656c 662e 6261 7365 5f6c  elif self.base_l
+0000d450: 6561 726e 6572 203d 3d20 2748 7562 6572  earner == 'Huber
+0000d460: 5265 6772 6573 736f 7227 3a0a 2020 2020  Regressor':.    
+0000d470: 2020 2020 2020 2020 7269 6467 655f 6d6f          ridge_mo
+0000d480: 6465 6c20 3d20 4875 6265 7252 6567 7265  del = HuberRegre
+0000d490: 7373 6f72 2829 0a20 2020 2020 2020 2065  ssor().        e
+0000d4a0: 6c69 6620 7365 6c66 2e62 6173 655f 6c65  lif self.base_le
+0000d4b0: 6172 6e65 7220 3d3d 2027 504c 5472 6565  arner == 'PLTree
+0000d4c0: 273a 0a20 2020 2020 2020 2020 2020 206d  ':.            m
+0000d4d0: 696e 5f73 616d 706c 6573 5f6c 6561 6620  in_samples_leaf 
+0000d4e0: 3d20 696e 7428 7365 6c66 2e70 6172 7469  = int(self.parti
+0000d4f0: 7469 6f6e 5f6e 756d 6265 722e 7370 6c69  tion_number.spli
+0000d500: 7428 272d 2729 5b31 5d29 0a20 2020 2020  t('-')[1]).     
+0000d510: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
+0000d520: 5f6e 756d 6265 7220 3d20 696e 7428 7365  _number = int(se
+0000d530: 6c66 2e70 6172 7469 7469 6f6e 5f6e 756d  lf.partition_num
+0000d540: 6265 722e 7370 6c69 7428 272d 2729 5b32  ber.split('-')[2
+0000d550: 5d29 0a20 2020 2020 2020 2020 2020 2072  ]).            r
+0000d560: 6964 6765 5f6d 6f64 656c 203d 2050 4c54  idge_model = PLT
+0000d570: 7265 6552 6567 7265 7373 6f72 286d 696e  reeRegressor(min
+0000d580: 5f73 616d 706c 6573 5f6c 6561 663d 6d69  _samples_leaf=mi
+0000d590: 6e5f 7361 6d70 6c65 735f 6c65 6166 2c0a  n_samples_leaf,.
+0000d5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d5c0: 2020 2020 2020 2020 2020 6d61 785f 6c65            max_le
+0000d5d0: 6166 5f6e 6f64 6573 3d70 6172 7469 7469  af_nodes=partiti
+0000d5e0: 6f6e 5f6e 756d 6265 7229 0a20 2020 2020  on_number).     
+0000d5f0: 2020 2065 6c69 6620 7365 6c66 2e62 6173     elif self.bas
+0000d600: 655f 6c65 6172 6e65 7220 3d3d 2027 536f  e_learner == 'So
+0000d610: 6674 2d50 4c54 7265 6527 206f 7220 7365  ft-PLTree' or se
+0000d620: 6c66 2e62 6173 655f 6c65 6172 6e65 7220  lf.base_learner 
+0000d630: 3d3d 2027 536f 6674 2d50 4c54 7265 652d  == 'Soft-PLTree-
+0000d640: 454d 273a 0a20 2020 2020 2020 2020 2020  EM':.           
+0000d650: 2069 6620 7365 6c66 2e62 6173 655f 6c65   if self.base_le
+0000d660: 6172 6e65 7220 3d3d 2027 536f 6674 2d50  arner == 'Soft-P
+0000d670: 4c54 7265 6527 3a0a 2020 2020 2020 2020  LTree':.        
+0000d680: 2020 2020 2020 2020 6d6f 6465 6c20 3d20          model = 
+0000d690: 536f 6674 504c 5472 6565 5265 6772 6573  SoftPLTreeRegres
+0000d6a0: 736f 720a 2020 2020 2020 2020 2020 2020  sor.            
+0000d6b0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0000d6c0: 2020 2020 2020 6d6f 6465 6c20 3d20 536f        model = So
+0000d6d0: 6674 504c 5472 6565 5265 6772 6573 736f  ftPLTreeRegresso
+0000d6e0: 7245 4d0a 2020 2020 2020 2020 2020 2020  rEM.            
+0000d6f0: 6665 6174 7572 655f 6e75 6d20 3d20 7365  feature_num = se
+0000d700: 6c66 2e67 656e 655f 6e75 6d0a 2020 2020  lf.gene_num.    
+0000d710: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0000d720: 6f72 6967 696e 616c 5f66 6561 7475 7265  original_feature
+0000d730: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+0000d740: 2020 2066 6561 7475 7265 5f6e 756d 202b     feature_num +
+0000d750: 3d20 7365 6c66 2e58 2e73 6861 7065 5b31  = self.X.shape[1
+0000d760: 5d0a 2020 2020 2020 2020 2020 2020 7269  ].            ri
+0000d770: 6467 655f 6d6f 6465 6c20 3d20 6d6f 6465  dge_model = mode
+0000d780: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
+0000d790: 2020 206d 696e 5f73 616d 706c 6573 5f6c     min_samples_l
+0000d7a0: 6561 663d 7365 6c66 2e6d 696e 5f73 616d  eaf=self.min_sam
+0000d7b0: 706c 6573 5f6c 6561 662c 0a20 2020 2020  ples_leaf,.     
+0000d7c0: 2020 2020 2020 2020 2020 206d 6178 5f6c             max_l
+0000d7d0: 6561 665f 6e6f 6465 733d 7365 6c66 2e6d  eaf_nodes=self.m
+0000d7e0: 6178 5f6c 6561 665f 6e6f 6465 732c 0a20  ax_leaf_nodes,. 
+0000d7f0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000d800: 6561 7475 7265 5f6e 756d 3d66 6561 7475  eature_num=featu
+0000d810: 7265 5f6e 756d 2c0a 2020 2020 2020 2020  re_num,.        
+0000d820: 2020 2020 2020 2020 6765 6e65 5f6e 756d          gene_num
+0000d830: 3d73 656c 662e 6765 6e65 5f6e 756d 2c0a  =self.gene_num,.
+0000d840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d850: 6261 7365 5f6d 6f64 656c 3d73 656c 662e  base_model=self.
+0000d860: 7073 5f74 7265 655f 6c6f 6361 6c5f 6d6f  ps_tree_local_mo
+0000d870: 6465 6c2c 0a20 2020 2020 2020 2020 2020  del,.           
+0000d880: 2020 2020 2070 6172 7469 7469 6f6e 5f6d       partition_m
+0000d890: 6f64 656c 3d73 656c 662e 7073 5f74 7265  odel=self.ps_tre
+0000d8a0: 655f 7061 7274 6974 696f 6e5f 6d6f 6465  e_partition_mode
+0000d8b0: 6c2c 0a20 2020 2020 2020 2020 2020 2020  l,.             
+0000d8c0: 2020 2070 6172 7469 7469 6f6e 5f6e 756d     partition_num
+0000d8d0: 6265 723d 7365 6c66 2e70 6172 7469 7469  ber=self.partiti
+0000d8e0: 6f6e 5f6e 756d 6265 722c 0a20 2020 2020  on_number,.     
+0000d8f0: 2020 2020 2020 2020 2020 206f 6e6c 795f             only_
+0000d900: 6f72 6967 696e 616c 5f66 6561 7475 7265  original_feature
+0000d910: 733d 7365 6c66 2e6f 6e6c 795f 6f72 6967  s=self.only_orig
+0000d920: 696e 616c 5f66 6561 7475 7265 7329 0a20  inal_features). 
+0000d930: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
+0000d940: 7374 616e 6365 2873 656c 662e 6261 7365  stance(self.base
+0000d950: 5f6c 6561 726e 6572 2c20 5265 6772 6573  _learner, Regres
+0000d960: 736f 724d 6978 696e 293a 0a20 2020 2020  sorMixin):.     
+0000d970: 2020 2020 2020 2072 6964 6765 5f6d 6f64         ridge_mod
+0000d980: 656c 203d 2073 656c 662e 6261 7365 5f6c  el = self.base_l
+0000d990: 6561 726e 6572 0a20 2020 2020 2020 2065  earner.        e
+0000d9a0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0000d9b0: 2072 6169 7365 2045 7863 6570 7469 6f6e   raise Exception
+0000d9c0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+0000d9d0: 2e62 6173 655f 6c65 6172 6e65 7220 3d3d  .base_learner ==
+0000d9e0: 2027 5043 412d 4454 273a 0a20 2020 2020   'PCA-DT':.     
+0000d9f0: 2020 2020 2020 2023 2070 726f 6a65 6374         # project
+0000da00: 696f 6e5f 6d61 7472 6978 203d 206e 702e  ion_matrix = np.
+0000da10: 7261 6e64 6f6d 2e72 616e 646f 6d28 2873  random.random((s
+0000da20: 656c 662e 6765 6e65 5f6e 756d 2c20 7365  elf.gene_num, se
+0000da30: 6c66 2e67 656e 655f 6e75 6d29 290a 2020  lf.gene_num)).  
+0000da40: 2020 2020 2020 2020 2020 2320 7261 6e64            # rand
+0000da50: 6f6d 5f70 726f 6a65 6374 696f 6e20 3d20  om_projection = 
+0000da60: 5374 6174 6963 5261 6e64 6f6d 5072 6f6a  StaticRandomProj
+0000da70: 6563 7469 6f6e 2870 726f 6a65 6374 696f  ection(projectio
+0000da80: 6e5f 6d61 7472 6978 290a 2020 2020 2020  n_matrix).      
+0000da90: 2020 2020 2020 7069 7065 203d 2047 5050        pipe = GPP
+0000daa0: 6970 656c 696e 6528 5b0a 2020 2020 2020  ipeline([.      
+0000dab0: 2020 2020 2020 2020 2020 2822 5363 616c            ("Scal
+0000dac0: 6572 222c 2053 7461 6e64 6172 6453 6361  er", StandardSca
+0000dad0: 6c65 7228 2929 2c0a 2020 2020 2020 2020  ler()),.        
+0000dae0: 2020 2020 2020 2020 2822 526f 7461 7469          ("Rotati
+0000daf0: 6f6e 222c 2050 4341 286e 5f63 6f6d 706f  on", PCA(n_compo
+0000db00: 6e65 6e74 733d 3529 292c 0a20 2020 2020  nents=5)),.     
+0000db10: 2020 2020 2020 2020 2020 2028 2252 6964             ("Rid
+0000db20: 6765 222c 2072 6964 6765 5f6d 6f64 656c  ge", ridge_model
+0000db30: 292c 0a20 2020 2020 2020 2020 2020 205d  ),.            ]
+0000db40: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+0000db50: 2020 2020 2020 2020 2020 2020 7069 7065              pipe
+0000db60: 203d 2047 5050 6970 656c 696e 6528 5b0a   = GPPipeline([.
+0000db70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000db80: 2822 5363 616c 6572 222c 2053 6166 6574  ("Scaler", Safet
+0000db90: 7953 6361 6c65 7228 2929 2c0a 2020 2020  yScaler()),.    
+0000dba0: 2020 2020 2020 2020 2020 2020 2822 5269              ("Ri
+0000dbb0: 6467 6522 2c20 7269 6467 655f 6d6f 6465  dge", ridge_mode
+0000dbc0: 6c29 2c0a 2020 2020 2020 2020 2020 2020  l),.            
+0000dbd0: 5d29 0a20 2020 2020 2020 2069 6620 6973  ]).        if is
+0000dbe0: 696e 7374 616e 6365 2870 6970 655b 2752  instance(pipe['R
+0000dbf0: 6964 6765 275d 2c20 4261 7365 4465 6369  idge'], BaseDeci
+0000dc00: 7369 6f6e 5472 6565 2920 616e 6420 7365  sionTree) and se
+0000dc10: 6c66 2e6d 6178 5f74 7265 655f 6465 7074  lf.max_tree_dept
+0000dc20: 6820 213d 204e 6f6e 653a 0a20 2020 2020  h != None:.     
+0000dc30: 2020 2020 2020 2061 7373 6572 7420 7069         assert pi
+0000dc40: 7065 5b27 5269 6467 6527 5d2e 6d61 785f  pe['Ridge'].max_
+0000dc50: 6465 7074 6820 3d3d 2073 656c 662e 6d61  depth == self.ma
+0000dc60: 785f 7472 6565 5f64 6570 7468 0a20 2020  x_tree_depth.   
+0000dc70: 2020 2020 2072 6574 7572 6e20 7069 7065       return pipe
+0000dc80: 0a0a 2020 2020 6465 6620 7472 616e 7366  ..    def transf
+0000dc90: 6f72 6d28 7365 6c66 2c20 582c 2072 6174  orm(self, X, rat
+0000dca0: 696f 3d30 2e35 293a 0a20 2020 2020 2020  io=0.5):.       
+0000dcb0: 2072 6174 696f 203d 2031 202d 2072 6174   ratio = 1 - rat
+0000dcc0: 696f 0a20 2020 2020 2020 2069 6620 7365  io.        if se
+0000dcd0: 6c66 2e6e 6f72 6d61 6c69 7a65 3a0a 2020  lf.normalize:.  
+0000dce0: 2020 2020 2020 2020 2020 5820 3d20 7365            X = se
+0000dcf0: 6c66 2e78 5f73 6361 6c65 722e 7472 616e  lf.x_scaler.tran
+0000dd00: 7366 6f72 6d28 5829 0a20 2020 2020 2020  sform(X).       
+0000dd10: 2063 6f64 655f 696d 706f 7274 616e 6365   code_importance
+0000dd20: 5f64 6963 7420 3d20 6765 745f 6665 6174  _dict = get_feat
+0000dd30: 7572 655f 696d 706f 7274 616e 6365 2873  ure_importance(s
+0000dd40: 656c 662c 206c 6174 6578 5f76 6572 7369  elf, latex_versi
+0000dd50: 6f6e 3d46 616c 7365 2c20 6669 746e 6573  on=False, fitnes
+0000dd60: 735f 7765 6967 6874 6564 3d46 616c 7365  s_weighted=False
+0000dd70: 290a 2020 2020 2020 2020 6966 2073 656c  ).        if sel
+0000dd80: 662e 656e 7365 6d62 6c65 5f73 697a 6520  f.ensemble_size 
+0000dd90: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
+0000dda0: 2020 746f 705f 6665 6174 7572 6573 203d    top_features =
+0000ddb0: 206c 6973 7428 636f 6465 5f69 6d70 6f72   list(code_impor
+0000ddc0: 7461 6e63 655f 6469 6374 2e6b 6579 7328  tance_dict.keys(
+0000ddd0: 2929 0a20 2020 2020 2020 2065 6c73 653a  )).        else:
+0000dde0: 0a20 2020 2020 2020 2020 2020 2074 6f70  .            top
+0000ddf0: 5f66 6561 7475 7265 7320 3d20 7365 6c65  _features = sele
+0000de00: 6374 5f74 6f70 5f66 6561 7475 7265 7328  ct_top_features(
+0000de10: 636f 6465 5f69 6d70 6f72 7461 6e63 655f  code_importance_
+0000de20: 6469 6374 2c20 7261 7469 6f29 0a20 2020  dict, ratio).   
+0000de30: 2020 2020 2074 7261 6e73 666f 726d 6564       transformed
+0000de40: 5f66 6561 7475 7265 7320 3d20 6665 6174  _features = feat
+0000de50: 7572 655f 6170 7065 6e64 2873 656c 662c  ure_append(self,
+0000de60: 2058 2c20 746f 705f 6665 6174 7572 6573   X, top_features
+0000de70: 2c20 6f6e 6c79 5f6e 6577 5f66 6561 7475  , only_new_featu
+0000de80: 7265 733d 5472 7565 290a 2020 2020 2020  res=True).      
+0000de90: 2020 7265 7475 726e 2074 7261 6e73 666f    return transfo
+0000dea0: 726d 6564 5f66 6561 7475 7265 730a 0a20  rmed_features.. 
+0000deb0: 2020 2064 6566 206c 617a 795f 696e 6974     def lazy_init
+0000dec0: 2873 656c 662c 2078 293a 0a20 2020 2020  (self, x):.     
+0000ded0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+0000dee0: 2873 656c 662e 6e5f 706f 702c 2073 7472  (self.n_pop, str
+0000def0: 2920 616e 6420 274e 2720 696e 2073 656c  ) and 'N' in sel
+0000df00: 662e 6e5f 706f 703a 0a20 2020 2020 2020  f.n_pop:.       
+0000df10: 2020 2020 2073 656c 662e 6e5f 706f 7020       self.n_pop 
+0000df20: 3d20 6578 7472 6163 745f 6e75 6d62 6572  = extract_number
+0000df30: 7328 782e 7368 6170 655b 315d 2c20 7365  s(x.shape[1], se
+0000df40: 6c66 2e6e 5f70 6f70 290a 2020 2020 2020  lf.n_pop).      
+0000df50: 2020 6966 2073 656c 662e 7365 6d61 6e74    if self.semant
+0000df60: 6963 5f72 6570 6169 7220 3e20 303a 0a20  ic_repair > 0:. 
+0000df70: 2020 2020 2020 2020 2020 2023 2053 616d             # Sam
+0000df80: 706c 696e 6720 736f 6d65 2064 6174 6120  pling some data 
+0000df90: 706f 696e 7420 666f 7220 7365 6d61 6e74  point for semant
+0000dfa0: 6963 2072 6570 6169 720a 2020 2020 2020  ic repair.      
+0000dfb0: 2020 2020 2020 6964 203d 206e 702e 7261        id = np.ra
+0000dfc0: 6e64 6f6d 2e72 616e 6469 6e74 2830 2c20  ndom.randint(0, 
+0000dfd0: 7365 6c66 2e58 2e73 6861 7065 5b30 5d2c  self.X.shape[0],
+0000dfe0: 2032 3029 0a20 2020 2020 2020 2020 2020   20).           
+0000dff0: 2073 656c 662e 7365 6d61 6e74 6963 5f72   self.semantic_r
+0000e000: 6570 6169 725f 696e 7075 7420 3d20 7365  epair_input = se
+0000e010: 6c66 2e58 5b69 645d 0a20 2020 2020 2020  lf.X[id].       
+0000e020: 2020 2020 2073 656c 662e 7365 6d61 6e74       self.semant
+0000e030: 6963 5f72 6570 6169 725f 7461 7267 6574  ic_repair_target
+0000e040: 203d 2073 656c 662e 795b 6964 5d0a 2020   = self.y[id].  
+0000e050: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000e060: 2020 2020 2020 2020 7365 6c66 2e73 656d          self.sem
+0000e070: 616e 7469 635f 7265 7061 6972 5f69 6e70  antic_repair_inp
+0000e080: 7574 203d 204e 6f6e 650a 0a20 2020 2020  ut = None..     
+0000e090: 2020 2069 6620 7365 6c66 2e67 656e 655f     if self.gene_
+0000e0a0: 6e75 6d20 3d3d 2027 4164 6170 7469 7665  num == 'Adaptive
+0000e0b0: 273a 0a20 2020 2020 2020 2020 2020 2073  ':.            s
+0000e0c0: 656c 662e 6765 6e65 5f6e 756d 203d 206d  elf.gene_num = m
+0000e0d0: 696e 2878 2e73 6861 7065 5b31 5d2c 2032  in(x.shape[1], 2
+0000e0e0: 3029 0a20 2020 2020 2020 2069 6620 6973  0).        if is
+0000e0f0: 696e 7374 616e 6365 2873 656c 662e 6765  instance(self.ge
+0000e100: 6e65 5f6e 756d 2c20 7374 7229 3a0a 2020  ne_num, str):.  
+0000e110: 2020 2020 2020 2020 2020 7365 6c66 2e67            self.g
+0000e120: 656e 655f 6e75 6d20 3d20 6d69 6e28 696e  ene_num = min(in
+0000e130: 7428 7365 6c66 2e67 656e 655f 6e75 6d2e  t(self.gene_num.
+0000e140: 7265 706c 6163 6528 2758 272c 2027 2729  replace('X', '')
+0000e150: 2920 2a20 7365 6c66 2e58 2e73 6861 7065  ) * self.X.shape
+0000e160: 5b31 5d2c 2033 3029 0a20 2020 2020 2020  [1], 30).       
+0000e170: 2070 7365 7420 3d20 7365 6c66 2e70 7269   pset = self.pri
+0000e180: 6d69 7469 7665 5f69 6e69 7469 616c 697a  mitive_initializ
+0000e190: 6174 696f 6e28 7829 0a0a 2020 2020 2020  ation(x)..      
+0000e1a0: 2020 2320 6861 6c6c 206f 6620 6661 6d65    # hall of fame
+0000e1b0: 2069 6e69 7469 616c 697a 6174 696f 6e0a   initialization.
+0000e1c0: 2020 2020 2020 2020 7365 6c66 2e61 7263          self.arc
+0000e1d0: 6869 7665 5f69 6e69 7469 616c 697a 6174  hive_initializat
+0000e1e0: 696f 6e28 290a 2020 2020 2020 2020 6966  ion().        if
+0000e1f0: 2073 656c 662e 7472 616e 7366 6f72 6d65   self.transforme
+0000e200: 725f 7377 6974 6368 3a0a 2020 2020 2020  r_switch:.      
+0000e210: 2020 2020 2020 7365 6c66 2e74 7261 6e73        self.trans
+0000e220: 666f 726d 6572 5f74 6f6f 6c20 3d20 5472  former_tool = Tr
+0000e230: 616e 7366 6f72 6d65 7254 6f6f 6c28 7365  ansformerTool(se
+0000e240: 6c66 2e58 2c20 7365 6c66 2e79 2c20 7365  lf.X, self.y, se
+0000e250: 6c66 2e68 6f66 2c20 7365 6c66 2e70 7365  lf.hof, self.pse
+0000e260: 7429 0a0a 2020 2020 2020 2020 2320 746f  t)..        # to
+0000e270: 6f6c 626f 7820 696e 6974 6961 6c69 7a61  olbox initializa
+0000e280: 7469 6f6e 0a20 2020 2020 2020 2074 6f6f  tion.        too
+0000e290: 6c62 6f78 203d 2054 7970 6564 546f 6f6c  lbox = TypedTool
+0000e2a0: 626f 7828 290a 2020 2020 2020 2020 7365  box().        se
+0000e2b0: 6c66 2e74 6f6f 6c62 6f78 203d 2074 6f6f  lf.toolbox = too
+0000e2c0: 6c62 6f78 0a20 2020 2020 2020 2069 6620  lbox.        if 
+0000e2d0: 7365 6c66 2e66 6561 7475 7265 5f73 656c  self.feature_sel
+0000e2e0: 6563 7469 6f6e 3a0a 2020 2020 2020 2020  ection:.        
+0000e2f0: 2020 2020 7465 726d 696e 616c 5f70 726f      terminal_pro
+0000e300: 6220 3d20 7365 6c66 2e67 6574 5f74 6572  b = self.get_ter
+0000e310: 6d69 6e61 6c5f 7072 6f62 6162 696c 6974  minal_probabilit
+0000e320: 7928 290a 2020 2020 2020 2020 2020 2020  y().            
+0000e330: 746f 6f6c 626f 782e 6578 7072 203d 2070  toolbox.expr = p
+0000e340: 6172 7469 616c 2867 656e 4861 6c66 416e  artial(genHalfAn
+0000e350: 6448 616c 662c 2070 7365 743d 7073 6574  dHalf, pset=pset
+0000e360: 2c20 6d69 6e5f 3d31 2c20 6d61 785f 3d32  , min_=1, max_=2
+0000e370: 2c20 7465 726d 696e 616c 5f70 726f 623d  , terminal_prob=
+0000e380: 7465 726d 696e 616c 5f70 726f 6229 0a20  terminal_prob). 
+0000e390: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0000e3a0: 2020 2020 2020 2020 2023 2067 656e 6572           # gener
+0000e3b0: 6174 6520 696e 6974 6961 6c20 706f 7075  ate initial popu
+0000e3c0: 6c61 7469 6f6e 0a20 2020 2020 2020 2020  lation.         
+0000e3d0: 2020 2069 6620 7365 6c66 2e69 6e69 7469     if self.initi
+0000e3e0: 616c 5f74 7265 655f 7369 7a65 2069 7320  al_tree_size is 
+0000e3f0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0000e400: 2020 2020 2020 746f 6f6c 626f 782e 6578        toolbox.ex
+0000e410: 7072 203d 2070 6172 7469 616c 2867 702e  pr = partial(gp.
+0000e420: 6765 6e48 616c 6641 6e64 4861 6c66 2c20  genHalfAndHalf, 
+0000e430: 7073 6574 3d70 7365 742c 206d 696e 5f3d  pset=pset, min_=
+0000e440: 312c 206d 6178 5f3d 3229 0a20 2020 2020  1, max_=2).     
+0000e450: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0000e460: 2020 2020 2020 2020 2020 2020 206d 696e               min
+0000e470: 5f68 6569 6768 742c 206d 6178 5f68 6569  _height, max_hei
+0000e480: 6768 7420 3d20 7365 6c66 2e69 6e69 7469  ght = self.initi
+0000e490: 616c 5f74 7265 655f 7369 7a65 2e73 706c  al_tree_size.spl
+0000e4a0: 6974 2827 2d27 290a 2020 2020 2020 2020  it('-').        
+0000e4b0: 2020 2020 2020 2020 6d69 6e5f 6865 6967          min_heig
+0000e4c0: 6874 203d 2069 6e74 286d 696e 5f68 6569  ht = int(min_hei
+0000e4d0: 6768 7429 0a20 2020 2020 2020 2020 2020  ght).           
+0000e4e0: 2020 2020 206d 6178 5f68 6569 6768 7420       max_height 
+0000e4f0: 3d20 696e 7428 6d61 785f 6865 6967 6874  = int(max_height
+0000e500: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0000e510: 2020 746f 6f6c 626f 782e 6578 7072 203d    toolbox.expr =
+0000e520: 2070 6172 7469 616c 2867 702e 6765 6e48   partial(gp.genH
+0000e530: 616c 6641 6e64 4861 6c66 2c20 7073 6574  alfAndHalf, pset
+0000e540: 3d70 7365 742c 206d 696e 5f3d 6d69 6e5f  =pset, min_=min_
+0000e550: 6865 6967 6874 2c20 6d61 785f 3d6d 6178  height, max_=max
+0000e560: 5f68 6569 6768 7429 0a0a 2020 2020 2020  _height)..      
+0000e570: 2020 2320 696e 6469 7669 6475 616c 2069    # individual i
+0000e580: 6e69 7469 616c 697a 6174 696f 6e0a 2020  nitialization.  
+0000e590: 2020 2020 2020 7061 7274 6974 696f 6e5f        partition_
+0000e5a0: 7363 6865 6d65 203d 2073 656c 662e 7061  scheme = self.pa
+0000e5b0: 7274 6974 696f 6e5f 7363 6865 6d65 5f69  rtition_scheme_i
+0000e5c0: 6e69 7469 616c 697a 6174 696f 6e28 290a  nitialization().
+0000e5d0: 2020 2020 2020 2020 746f 6f6c 626f 782e          toolbox.
+0000e5e0: 696e 6469 7669 6475 616c 203d 2070 6172  individual = par
+0000e5f0: 7469 616c 286d 756c 7469 706c 655f 6765  tial(multiple_ge
+0000e600: 6e65 5f69 6e69 7469 616c 697a 6174 696f  ne_initializatio
+0000e610: 6e2c 204d 756c 7469 706c 6547 656e 6547  n, MultipleGeneG
+0000e620: 502c 2074 6f6f 6c62 6f78 2e65 7870 722c  P, toolbox.expr,
+0000e630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e650: 2020 2020 2020 6765 6e65 5f6e 756d 3d73        gene_num=s
+0000e660: 656c 662e 6765 6e65 5f6e 756d 2c20 7470  elf.gene_num, tp
+0000e670: 6f74 5f6d 6f64 656c 3d73 656c 662e 7470  ot_model=self.tp
+0000e680: 6f74 5f6d 6f64 656c 2c0a 2020 2020 2020  ot_model,.      
+0000e690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e6a0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0000e6b0: 6172 7469 7469 6f6e 5f73 6368 656d 653d  artition_scheme=
+0000e6c0: 7061 7274 6974 696f 6e5f 7363 6865 6d65  partition_scheme
+0000e6d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000e6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e6f0: 2020 2020 2020 2062 6173 655f 6d6f 6465         base_mode
+0000e700: 6c5f 6c69 7374 3d73 656c 662e 6261 7365  l_list=self.base
+0000e710: 5f6d 6f64 656c 5f6c 6973 742c 206e 756d  _model_list, num
+0000e720: 6265 725f 6f66 5f72 6567 6973 7465 723d  ber_of_register=
+0000e730: 7365 6c66 2e6e 756d 6265 725f 6f66 5f72  self.number_of_r
+0000e740: 6567 6973 7465 722c 0a20 2020 2020 2020  egister,.       
+0000e750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e760: 2020 2020 2020 2020 2020 2020 2020 6163                ac
+0000e770: 7469 7665 5f67 656e 655f 6e75 6d3d 7365  tive_gene_num=se
+0000e780: 6c66 2e61 6374 6976 655f 6765 6e65 5f6e  lf.active_gene_n
+0000e790: 756d 2c20 696e 7472 6f6e 5f70 726f 6261  um, intron_proba
+0000e7a0: 6269 6c69 7479 3d73 656c 662e 696e 7472  bility=self.intr
+0000e7b0: 6f6e 5f70 726f 6261 6269 6c69 7479 2c0a  on_probability,.
+0000e7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e7e0: 2020 2020 2069 6e74 726f 6e5f 7468 7265       intron_thre
+0000e7f0: 7368 6f6c 643d 7365 6c66 2e69 6e74 726f  shold=self.intro
+0000e800: 6e5f 7468 7265 7368 6f6c 6429 0a20 2020  n_threshold).   
+0000e810: 2020 2020 2074 6f6f 6c62 6f78 2e70 6f70       toolbox.pop
+0000e820: 756c 6174 696f 6e20 3d20 7061 7274 6961  ulation = partia
+0000e830: 6c28 746f 6f6c 732e 696e 6974 5265 7065  l(tools.initRepe
+0000e840: 6174 2c20 6c69 7374 2c20 746f 6f6c 626f  at, list, toolbo
+0000e850: 782e 696e 6469 7669 6475 616c 290a 2020  x.individual).  
+0000e860: 2020 2020 2020 746f 6f6c 626f 782e 636f        toolbox.co
+0000e870: 6d70 696c 6520 3d20 7061 7274 6961 6c28  mpile = partial(
+0000e880: 6d75 6c74 6970 6c65 5f67 656e 655f 636f  multiple_gene_co
+0000e890: 6d70 696c 652c 2070 7365 743d 7073 6574  mpile, pset=pset
+0000e8a0: 290a 0a20 2020 2020 2020 2074 6f6f 6c62  )..        toolb
+0000e8b0: 6f78 2e72 6567 6973 7465 7228 2763 6c6f  ox.register('clo
+0000e8c0: 6e65 272c 2065 6666 6963 6965 6e74 5f64  ne', efficient_d
+0000e8d0: 6565 7063 6f70 7929 0a20 2020 2020 2020  eepcopy).       
+0000e8e0: 2074 6f6f 6c62 6f78 2e65 7661 6c75 6174   toolbox.evaluat
+0000e8f0: 6520 3d20 7365 6c66 2e66 6974 6e65 7373  e = self.fitness
+0000e900: 5f65 7661 6c75 6174 696f 6e0a 0a20 2020  _evaluation..   
+0000e910: 2020 2020 2073 656c 662e 7365 6c65 6374       self.select
+0000e920: 696f 6e5f 6f70 6572 6174 6f72 5f69 6e69  ion_operator_ini
+0000e930: 7469 616c 697a 6174 696f 6e28 746f 6f6c  tialization(tool
+0000e940: 626f 7829 0a0a 2020 2020 2020 2020 2320  box)..        # 
+0000e950: 6d75 7461 7469 6f6e 206f 7065 7261 746f  mutation operato
+0000e960: 7273 0a20 2020 2020 2020 2069 6620 2745  rs.        if 'E
+0000e970: 4441 2720 696e 2073 656c 662e 6d75 7461  DA' in self.muta
+0000e980: 7469 6f6e 5f73 6368 656d 653a 0a20 2020  tion_scheme:.   
+0000e990: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+0000e9a0: 7365 6c66 2e6d 7574 6174 696f 6e5f 7363  self.mutation_sc
+0000e9b0: 6865 6d65 2069 6e20 6564 615f 6f70 6572  heme in eda_oper
+0000e9c0: 6174 6f72 732c 2022 4544 412d 6261 7365  ators, "EDA-base
+0000e9d0: 6420 6d75 7461 7469 6f6e 206f 7065 7261  d mutation opera
+0000e9e0: 746f 7220 6d75 7374 2062 6520 6c69 7374  tor must be list
+0000e9f0: 6564 2122 0a20 2020 2020 2020 2073 656c  ed!".        sel
+0000ea00: 662e 7072 696d 6974 6976 655f 7072 6f62  f.primitive_prob
+0000ea10: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
+0000ea20: 7365 6c66 2e74 6572 6d69 6e61 6c5f 7072  self.terminal_pr
+0000ea30: 6f62 203d 204e 6f6e 650a 2020 2020 2020  ob = None.      
+0000ea40: 2020 6966 2027 756e 6966 6f72 6d27 2069    if 'uniform' i
+0000ea50: 6e20 7365 6c66 2e6d 7574 6174 696f 6e5f  n self.mutation_
+0000ea60: 7363 6865 6d65 206f 7220 2761 6c6c 5f67  scheme or 'all_g
+0000ea70: 656e 6527 2069 6e20 7365 6c66 2e6d 7574  ene' in self.mut
+0000ea80: 6174 696f 6e5f 7363 6865 6d65 3a0a 2020  ation_scheme:.  
+0000ea90: 2020 2020 2020 2020 2020 6465 6620 636f            def co
+0000eaa0: 6e76 6572 745f 746f 5f69 6e74 2873 293a  nvert_to_int(s):
+0000eab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000eac0: 2069 6620 732e 7265 706c 6163 6528 272e   if s.replace('.
+0000ead0: 272c 2027 2729 2e69 7364 6563 696d 616c  ', '').isdecimal
+0000eae0: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+0000eaf0: 2020 2020 2020 2020 7265 7475 726e 2066          return f
+0000eb00: 6c6f 6174 2873 290a 2020 2020 2020 2020  loat(s).        
+0000eb10: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0000eb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000eb30: 2020 7265 7475 726e 204e 6f6e 650a 0a20    return None.. 
+0000eb40: 2020 2020 2020 2020 2020 2023 2065 7874             # ext
+0000eb50: 7261 6374 206d 7574 6174 696f 6e20 6f70  ract mutation op
+0000eb60: 6572 6174 6f72 0a20 2020 2020 2020 2020  erator.         
+0000eb70: 2020 2069 6620 277c 2720 696e 2073 656c     if '|' in sel
+0000eb80: 662e 6d75 7461 7469 6f6e 5f73 6368 656d  f.mutation_schem
+0000eb90: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0000eba0: 2020 206d 7574 6174 696f 6e5f 6f70 6572     mutation_oper
+0000ebb0: 6174 6f72 203d 2073 656c 662e 6d75 7461  ator = self.muta
+0000ebc0: 7469 6f6e 5f73 6368 656d 652e 7370 6c69  tion_scheme.spli
+0000ebd0: 7428 277c 2729 5b31 5d0a 2020 2020 2020  t('|')[1].      
+0000ebe0: 2020 2020 2020 2020 2020 6372 6f73 736f            crosso
+0000ebf0: 7665 725f 6f70 6572 6174 6f72 203d 2073  ver_operator = s
+0000ec00: 656c 662e 6d75 7461 7469 6f6e 5f73 6368  elf.mutation_sch
+0000ec10: 656d 652e 7370 6c69 7428 277c 2729 5b30  eme.split('|')[0
+0000ec20: 5d0a 2020 2020 2020 2020 2020 2020 656c  ].            el
 0000ec30: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0000ec40: 2020 2020 746f 6f6c 626f 782e 7265 6769      toolbox.regi
-0000ec50: 7374 6572 2822 6d61 7465 222c 2063 784f  ster("mate", cxO
-0000ec60: 6e65 506f 696e 745f 6d75 6c74 6970 6c65  nePoint_multiple
-0000ec70: 5f67 656e 6529 0a20 2020 2020 2020 2020  _gene).         
-0000ec80: 2020 2073 656c 662e 7072 696d 6974 6976     self.primitiv
-0000ec90: 655f 7072 6f62 203d 206e 702e 7a65 726f  e_prob = np.zero
-0000eca0: 7328 7365 6c66 2e70 7365 742e 7072 696d  s(self.pset.prim
-0000ecb0: 735f 636f 756e 7429 0a20 2020 2020 2020  s_count).       
-0000ecc0: 2020 2020 2073 656c 662e 7465 726d 696e       self.termin
-0000ecd0: 616c 5f70 726f 6220 3d20 6e70 2e7a 6572  al_prob = np.zer
-0000ece0: 6f73 2873 656c 662e 7073 6574 2e74 6572  os(self.pset.ter
-0000ecf0: 6d73 5f63 6f75 6e74 290a 2020 2020 2020  ms_count).      
-0000ed00: 2020 2020 2020 6966 2027 5465 726d 696e        if 'Termin
-0000ed10: 616c 2720 696e 2073 656c 662e 6d75 7461  al' in self.muta
-0000ed20: 7469 6f6e 5f73 6368 656d 653a 0a20 2020  tion_scheme:.   
-0000ed30: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000ed40: 662e 7072 696d 6974 6976 655f 7072 6f62  f.primitive_prob
-0000ed50: 203d 206e 702e 6f6e 6573 2873 656c 662e   = np.ones(self.
-0000ed60: 7073 6574 2e70 7269 6d73 5f63 6f75 6e74  pset.prims_count
-0000ed70: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-0000ed80: 2073 656c 662e 6d75 7461 7469 6f6e 5f73   self.mutation_s
-0000ed90: 6368 656d 6520 3d3d 2027 4544 412d 5465  cheme == 'EDA-Te
-0000eda0: 726d 696e 616c 273a 0a20 2020 2020 2020  rminal':.       
-0000edb0: 2020 2020 2020 2020 2023 2053 616d 706c           # Sampl
-0000edc0: 6520 7465 726d 696e 616c 7320 6672 6f6d  e terminals from
-0000edd0: 2061 2064 6972 6963 686c 6574 2064 6973   a dirichlet dis
-0000ede0: 7472 6962 7574 696f 6e0a 2020 2020 2020  tribution.      
-0000edf0: 2020 2020 2020 2020 2020 2320 5468 6520            # The 
-0000ee00: 6164 7661 6e74 6167 6520 6973 2074 6861  advantage is tha
-0000ee10: 7420 7468 6973 206d 6574 686f 6420 7375  t this method su
-0000ee20: 7070 6f72 7473 2070 7269 6f72 2064 6973  pports prior dis
-0000ee30: 7472 6962 7574 696f 6e0a 2020 2020 2020  tribution.      
-0000ee40: 2020 2020 2020 2020 2020 7061 7274 6961            partia
-0000ee50: 6c5f 6675 6e63 203d 2070 6172 7469 616c  l_func = partial
-0000ee60: 2867 656e 4675 6c6c 5f77 6974 685f 7072  (genFull_with_pr
-0000ee70: 6f62 2c20 7072 696d 6974 6976 655f 7072  ob, primitive_pr
-0000ee80: 6f62 733d 7365 6c66 2e70 7269 6d69 7469  obs=self.primiti
-0000ee90: 7665 5f70 726f 622c 0a20 2020 2020 2020  ve_prob,.       
-0000eea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eeb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eec0: 7465 726d 696e 616c 5f70 726f 6273 3d73  terminal_probs=s
-0000eed0: 656c 662e 7465 726d 696e 616c 5f70 726f  elf.terminal_pro
-0000eee0: 622c 2073 616d 706c 655f 7479 7065 3d27  b, sample_type='
-0000eef0: 4469 7269 6368 6c65 7427 290a 2020 2020  Dirichlet').    
-0000ef00: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0000ef10: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-0000ef20: 7274 6961 6c5f 6675 6e63 203d 2070 6172  rtial_func = par
-0000ef30: 7469 616c 2867 656e 4675 6c6c 5f77 6974  tial(genFull_wit
-0000ef40: 685f 7072 6f62 2c20 7072 696d 6974 6976  h_prob, primitiv
-0000ef50: 655f 7072 6f62 733d 7365 6c66 2e70 7269  e_probs=self.pri
-0000ef60: 6d69 7469 7665 5f70 726f 622c 0a20 2020  mitive_prob,.   
-0000ef70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ef80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ef90: 2020 2020 7465 726d 696e 616c 5f70 726f      terminal_pro
-0000efa0: 6273 3d73 656c 662e 7465 726d 696e 616c  bs=self.terminal
-0000efb0: 5f70 726f 6229 0a20 2020 2020 2020 2020  _prob).         
-0000efc0: 2020 2074 6f6f 6c62 6f78 2e72 6567 6973     toolbox.regis
-0000efd0: 7465 7228 2265 7870 725f 6d75 7422 2c20  ter("expr_mut", 
-0000efe0: 7061 7274 6961 6c5f 6675 6e63 2c0a 2020  partial_func,.  
-0000eff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f000: 2020 2020 2020 2020 2020 206d 696e 5f3d             min_=
-0000f010: 302c 206d 6178 5f3d 3229 0a20 2020 2020  0, max_=2).     
-0000f020: 2020 2020 2020 2074 6f6f 6c62 6f78 2e72         toolbox.r
-0000f030: 6567 6973 7465 7228 226d 7574 6174 6522  egister("mutate"
-0000f040: 2c20 6d75 7455 6e69 666f 726d 5f6d 756c  , mutUniform_mul
-0000f050: 7469 706c 655f 6765 6e65 2c20 6578 7072  tiple_gene, expr
-0000f060: 3d74 6f6f 6c62 6f78 2e65 7870 725f 6d75  =toolbox.expr_mu
-0000f070: 742c 2070 7365 743d 7073 6574 290a 2020  t, pset=pset).  
-0000f080: 2020 2020 2020 2020 2020 2320 7368 7269            # shri
-0000f090: 6e6b 5f6d 7574 6174 696f 6e20 3d20 4661  nk_mutation = Fa
-0000f0a0: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
-0000f0b0: 2320 6966 2073 6872 696e 6b5f 6d75 7461  # if shrink_muta
-0000f0c0: 7469 6f6e 3a0a 2020 2020 2020 2020 2020  tion:.          
-0000f0d0: 2020 2320 2020 2020 746f 6f6c 626f 782e    #     toolbox.
-0000f0e0: 7265 6769 7374 6572 2822 6d75 7461 7465  register("mutate
-0000f0f0: 222c 206d 7574 5368 7269 6e6b 5f6d 756c  ", mutShrink_mul
-0000f100: 7469 706c 655f 6765 6e65 2c20 6578 7072  tiple_gene, expr
-0000f110: 3d74 6f6f 6c62 6f78 2e65 7870 725f 6d75  =toolbox.expr_mu
-0000f120: 742c 2070 7365 743d 7073 6574 290a 2020  t, pset=pset).  
-0000f130: 2020 2020 2020 2020 2020 2320 656c 7365            # else
-0000f140: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-0000f150: 2020 2020 746f 6f6c 626f 782e 7265 6769      toolbox.regi
-0000f160: 7374 6572 2822 6d75 7461 7465 222c 206d  ster("mutate", m
-0000f170: 7574 556e 6966 6f72 6d5f 6d75 6c74 6970  utUniform_multip
-0000f180: 6c65 5f67 656e 652c 2065 7870 723d 746f  le_gene, expr=to
-0000f190: 6f6c 626f 782e 6578 7072 5f6d 7574 2c20  olbox.expr_mut, 
-0000f1a0: 7073 6574 3d70 7365 7429 0a20 2020 2020  pset=pset).     
-0000f1b0: 2020 2065 6c69 6620 7365 6c66 2e6d 7574     elif self.mut
-0000f1c0: 6174 696f 6e5f 7363 6865 6d65 2069 6e20  ation_scheme in 
-0000f1d0: 5b27 7072 6f62 6162 696c 6974 7927 5d3a  ['probability']:
-0000f1e0: 0a20 2020 2020 2020 2020 2020 2074 6f6f  .            too
-0000f1f0: 6c62 6f78 2e72 6567 6973 7465 7228 226d  lbox.register("m
-0000f200: 6174 6522 2c20 6378 4f6e 6550 6f69 6e74  ate", cxOnePoint
-0000f210: 5f61 6c6c 5f67 656e 655f 7769 7468 5f70  _all_gene_with_p
-0000f220: 726f 6261 6269 6c69 7479 2c20 7072 6f62  robability, prob
-0000f230: 6162 696c 6974 793d 7365 6c66 2e63 726f  ability=self.cro
-0000f240: 7373 5f70 6229 0a20 2020 2020 2020 2020  ss_pb).         
-0000f250: 2020 2074 6f6f 6c62 6f78 2e72 6567 6973     toolbox.regis
-0000f260: 7465 7228 2265 7870 725f 6d75 7422 2c20  ter("expr_mut", 
-0000f270: 6770 2e67 656e 4675 6c6c 2c20 6d69 6e5f  gp.genFull, min_
-0000f280: 3d30 2c20 6d61 785f 3d32 290a 2020 2020  =0, max_=2).    
-0000f290: 2020 2020 2020 2020 746f 6f6c 626f 782e          toolbox.
-0000f2a0: 7265 6769 7374 6572 2822 6d75 7461 7465  register("mutate
-0000f2b0: 222c 206d 7574 556e 6966 6f72 6d5f 6d75  ", mutUniform_mu
-0000f2c0: 6c74 6970 6c65 5f67 656e 655f 7769 7468  ltiple_gene_with
-0000f2d0: 5f70 726f 6261 6269 6c69 7479 2c20 6578  _probability, ex
-0000f2e0: 7072 3d74 6f6f 6c62 6f78 2e65 7870 725f  pr=toolbox.expr_
-0000f2f0: 6d75 742c 2070 7365 743d 7073 6574 2c0a  mut, pset=pset,.
-0000f300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f310: 2020 2020 2020 2020 2020 2020 2070 726f               pro
-0000f320: 6261 6269 6c69 7479 3d73 656c 662e 6d75  bability=self.mu
-0000f330: 7461 7469 6f6e 5f70 6229 0a20 2020 2020  tation_pb).     
-0000f340: 2020 2020 2020 2073 656c 662e 6372 6f73         self.cros
-0000f350: 735f 7062 203d 2031 0a20 2020 2020 2020  s_pb = 1.       
-0000f360: 2020 2020 2073 656c 662e 6d75 7461 7469       self.mutati
-0000f370: 6f6e 5f70 6220 3d20 310a 2020 2020 2020  on_pb = 1.      
-0000f380: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0000f390: 2020 2020 7261 6973 6520 4578 6365 7074      raise Except
-0000f3a0: 696f 6e0a 0a20 2020 2020 2020 2064 6566  ion..        def
-0000f3b0: 2064 796e 616d 6963 5f68 6569 6768 7428   dynamic_height(
-0000f3c0: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-0000f3d0: 6620 6c65 6e28 7365 6c66 2e67 656e 6572  f len(self.gener
-0000f3e0: 6174 6564 5f66 6561 7475 7265 7329 203e  ated_features) >
-0000f3f0: 3d20 5c0a 2020 2020 2020 2020 2020 2020  = \.            
-0000f400: 2020 2020 6e70 2e6c 6f67 286c 656e 2873      np.log(len(s
-0000f410: 656c 662e 7073 6574 2e70 7269 6d69 7469  elf.pset.primiti
-0000f420: 7665 7329 202a 2028 3220 2a2a 2073 656c  ves) * (2 ** sel
-0000f430: 662e 6375 7272 656e 745f 6865 6967 6874  f.current_height
-0000f440: 202d 2031 2920 2a20 5c0a 2020 2020 2020   - 1) * \.      
-0000f450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f460: 206c 656e 2873 656c 662e 7073 6574 2e74   len(self.pset.t
-0000f470: 6572 6d69 6e61 6c73 2920 2a20 2832 202a  erminals) * (2 *
-0000f480: 2a20 7365 6c66 2e63 7572 7265 6e74 5f68  * self.current_h
-0000f490: 6569 6768 7429 2920 2f20 5c0a 2020 2020  eight)) / \.    
-0000f4a0: 2020 2020 2020 2020 2020 2020 6e70 2e6c              np.l
-0000f4b0: 6f67 2831 2e30 3129 3a0a 2020 2020 2020  og(1.01):.      
-0000f4c0: 2020 2020 2020 2020 2020 7365 6c66 2e63            self.c
-0000f4d0: 7572 7265 6e74 5f68 6569 6768 7420 2b3d  urrent_height +=
-0000f4e0: 2031 0a20 2020 2020 2020 2020 2020 2072   1.            r
-0000f4f0: 6574 7572 6e20 7365 6c66 2e63 7572 7265  eturn self.curre
-0000f500: 6e74 5f68 6569 6768 740a 0a20 2020 2020  nt_height..     
-0000f510: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
-0000f520: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0000f530: 6869 7374 6f72 7920 3d20 4869 7374 6f72  history = Histor
-0000f540: 7928 290a 2020 2020 2020 2020 2020 2020  y().            
-0000f550: 7365 6c66 2e68 6973 746f 7279 203d 2068  self.history = h
-0000f560: 6973 746f 7279 0a20 2020 2020 2020 2020  istory.         
-0000f570: 2020 2023 2044 6563 6f72 6174 6520 7468     # Decorate th
-0000f580: 6520 7661 7269 6174 696f 6e20 6f70 6572  e variation oper
-0000f590: 6174 6f72 730a 2020 2020 2020 2020 2020  ators.          
-0000f5a0: 2020 746f 6f6c 626f 782e 6465 636f 7261    toolbox.decora
-0000f5b0: 7465 2822 6d61 7465 222c 2068 6973 746f  te("mate", histo
-0000f5c0: 7279 2e64 6563 6f72 6174 6f72 290a 2020  ry.decorator).  
-0000f5d0: 2020 2020 2020 2020 2020 746f 6f6c 626f            toolbo
-0000f5e0: 782e 6465 636f 7261 7465 2822 6d75 7461  x.decorate("muta
-0000f5f0: 7465 222c 2068 6973 746f 7279 2e64 6563  te", history.dec
-0000f600: 6f72 6174 6f72 290a 0a20 2020 2020 2020  orator)..       
-0000f610: 2069 6620 7365 6c66 2e6d 756c 7469 5f67   if self.multi_g
-0000f620: 656e 655f 6d75 7461 7469 6f6e 2829 3a0a  ene_mutation():.
-0000f630: 2020 2020 2020 2020 2020 2020 7061 7373              pass
-0000f640: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
-0000f650: 6c66 2e6d 6178 5f68 6569 6768 7420 3d3d  lf.max_height ==
-0000f660: 2027 6479 6e61 6d69 6327 3a0a 2020 2020   'dynamic':.    
-0000f670: 2020 2020 2020 2020 746f 6f6c 626f 782e          toolbox.
-0000f680: 6465 636f 7261 7465 2822 6d61 7465 222c  decorate("mate",
-0000f690: 2073 7461 7469 634c 696d 6974 5f6d 756c   staticLimit_mul
-0000f6a0: 7469 706c 655f 6765 6e65 286b 6579 3d6f  tiple_gene(key=o
-0000f6b0: 7065 7261 746f 722e 6174 7472 6765 7474  perator.attrgett
-0000f6c0: 6572 2822 6865 6967 6874 2229 2c0a 2020  er("height"),.  
-0000f6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f700: 2020 2020 2020 2020 2020 2020 206d 6178               max
-0000f710: 5f76 616c 7565 3d64 796e 616d 6963 5f68  _value=dynamic_h
-0000f720: 6569 6768 7429 290a 2020 2020 2020 2020  eight)).        
-0000f730: 2020 2020 746f 6f6c 626f 782e 6465 636f      toolbox.deco
-0000f740: 7261 7465 2822 6d75 7461 7465 222c 2073  rate("mutate", s
-0000f750: 7461 7469 634c 696d 6974 5f6d 756c 7469  taticLimit_multi
-0000f760: 706c 655f 6765 6e65 286b 6579 3d6f 7065  ple_gene(key=ope
-0000f770: 7261 746f 722e 6174 7472 6765 7474 6572  rator.attrgetter
-0000f780: 2822 6865 6967 6874 2229 2c0a 2020 2020  ("height"),.    
-0000f790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f7c0: 2020 2020 2020 2020 2020 2020 206d 6178               max
-0000f7d0: 5f76 616c 7565 3d64 796e 616d 6963 5f68  _value=dynamic_h
-0000f7e0: 6569 6768 7429 290a 2020 2020 2020 2020  eight)).        
-0000f7f0: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
-0000f800: 7365 6c66 2e6d 6178 5f68 6569 6768 742c  self.max_height,
-0000f810: 2073 7472 2920 616e 6420 2773 697a 652d   str) and 'size-
-0000f820: 2720 696e 2073 656c 662e 6d61 785f 6865  ' in self.max_he
-0000f830: 6967 6874 3a0a 2020 2020 2020 2020 2020  ight:.          
-0000f840: 2020 7369 7a65 203d 2069 6e74 2873 656c    size = int(sel
-0000f850: 662e 6d61 785f 6865 6967 6874 2e73 706c  f.max_height.spl
-0000f860: 6974 2827 2d27 295b 315d 290a 2020 2020  it('-')[1]).    
-0000f870: 2020 2020 2020 2020 746f 6f6c 626f 782e          toolbox.
-0000f880: 6465 636f 7261 7465 2822 6d61 7465 222c  decorate("mate",
-0000f890: 2073 7461 7469 634c 696d 6974 5f6d 756c   staticLimit_mul
-0000f8a0: 7469 706c 655f 6765 6e65 286b 6579 3d6c  tiple_gene(key=l
-0000f8b0: 616d 6264 6120 783a 206c 656e 2878 292c  ambda x: len(x),
-0000f8c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f900: 6d61 785f 7661 6c75 653d 7369 7a65 2929  max_value=size))
-0000f910: 0a20 2020 2020 2020 2020 2020 2074 6f6f  .            too
-0000f920: 6c62 6f78 2e64 6563 6f72 6174 6528 226d  lbox.decorate("m
-0000f930: 7574 6174 6522 2c20 7374 6174 6963 4c69  utate", staticLi
-0000f940: 6d69 745f 6d75 6c74 6970 6c65 5f67 656e  mit_multiple_gen
-0000f950: 6528 6b65 793d 6c61 6d62 6461 2078 3a20  e(key=lambda x: 
-0000f960: 6c65 6e28 7829 2c0a 2020 2020 2020 2020  len(x),.        
-0000f970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f9a0: 2020 2020 2020 2020 206d 6178 5f76 616c           max_val
-0000f9b0: 7565 3d73 697a 6529 290a 2020 2020 2020  ue=size)).      
-0000f9c0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0000f9d0: 2020 2020 746f 6f6c 626f 782e 6465 636f      toolbox.deco
-0000f9e0: 7261 7465 2822 6d61 7465 222c 2073 7461  rate("mate", sta
-0000f9f0: 7469 634c 696d 6974 5f6d 756c 7469 706c  ticLimit_multipl
-0000fa00: 655f 6765 6e65 286b 6579 3d6f 7065 7261  e_gene(key=opera
-0000fa10: 746f 722e 6174 7472 6765 7474 6572 2822  tor.attrgetter("
-0000fa20: 6865 6967 6874 2229 2c0a 2020 2020 2020  height"),.      
-0000fa30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fa40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fa50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fa60: 2020 2020 2020 2020 206d 6178 5f76 616c           max_val
-0000fa70: 7565 3d73 656c 662e 6d61 785f 6865 6967  ue=self.max_heig
-0000fa80: 6874 2c0a 2020 2020 2020 2020 2020 2020  ht,.            
-0000fa90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000faa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fac0: 2020 206d 696e 5f76 616c 7565 3d73 656c     min_value=sel
-0000fad0: 662e 6d69 6e5f 6865 6967 6874 2929 0a20  f.min_height)). 
-0000fae0: 2020 2020 2020 2020 2020 2074 6f6f 6c62             toolb
-0000faf0: 6f78 2e64 6563 6f72 6174 6528 226d 7574  ox.decorate("mut
-0000fb00: 6174 6522 2c20 7374 6174 6963 4c69 6d69  ate", staticLimi
-0000fb10: 745f 6d75 6c74 6970 6c65 5f67 656e 6528  t_multiple_gene(
-0000fb20: 6b65 793d 6f70 6572 6174 6f72 2e61 7474  key=operator.att
-0000fb30: 7267 6574 7465 7228 2268 6569 6768 7422  rgetter("height"
-0000fb40: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-0000fb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fb80: 2020 2020 6d61 785f 7661 6c75 653d 7365      max_value=se
-0000fb90: 6c66 2e6d 6178 5f68 6569 6768 742c 0a20  lf.max_height,. 
-0000fba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fbd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fbe0: 6d69 6e5f 7661 6c75 653d 7365 6c66 2e6d  min_value=self.m
-0000fbf0: 696e 5f68 6569 6768 7429 290a 2020 2020  in_height)).    
-0000fc00: 2020 2020 6966 2073 656c 662e 696e 7472      if self.intr
-0000fc10: 6f6e 5f74 6872 6573 686f 6c64 203e 2030  on_threshold > 0
-0000fc20: 2061 6e64 2073 656c 662e 6d69 6e5f 6865   and self.min_he
-0000fc30: 6967 6874 203e 2030 3a0a 2020 2020 2020  ight > 0:.      
-0000fc40: 2020 2020 2020 7261 6973 6520 4578 6365        raise Exce
-0000fc50: 7074 696f 6e28 274e 6f74 2073 7570 706f  ption('Not suppo
-0000fc60: 7274 6564 2069 6e20 7374 6174 6963 206c  rted in static l
-0000fc70: 696d 6974 2729 0a20 2020 2020 2020 2073  imit').        s
-0000fc80: 656c 662e 6e65 7574 7261 6c5f 6d75 7461  elf.neutral_muta
-0000fc90: 7469 6f6e 203d 2073 7461 7469 634c 696d  tion = staticLim
-0000fca0: 6974 286b 6579 3d6f 7065 7261 746f 722e  it(key=operator.
-0000fcb0: 6174 7472 6765 7474 6572 2822 6865 6967  attrgetter("heig
-0000fcc0: 6874 2229 2c0a 2020 2020 2020 2020 2020  ht"),.          
-0000fcd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ec40: 2020 2020 6d75 7461 7469 6f6e 5f6f 7065      mutation_ope
+0000ec50: 7261 746f 7220 3d20 4e6f 6e65 0a20 2020  rator = None.   
+0000ec60: 2020 2020 2020 2020 2020 2020 2063 726f               cro
+0000ec70: 7373 6f76 6572 5f6f 7065 7261 746f 7220  ssover_operator 
+0000ec80: 3d20 7365 6c66 2e6d 7574 6174 696f 6e5f  = self.mutation_
+0000ec90: 7363 6865 6d65 0a0a 2020 2020 2020 2020  scheme..        
+0000eca0: 2020 2020 2320 6465 6369 7369 6f6e 2074      # decision t
+0000ecb0: 6872 6573 686f 6c64 2066 6f72 2066 6561  hreshold for fea
+0000ecc0: 7475 7265 2063 726f 7373 6f76 6572 2061  ture crossover a
+0000ecd0: 6e64 206d 7574 6174 696f 6e0a 2020 2020  nd mutation.    
+0000ece0: 2020 2020 2020 2020 7468 7265 7368 6f6c          threshol
+0000ecf0: 645f 7261 7469 6f20 3d20 636f 6e76 6572  d_ratio = conver
+0000ed00: 745f 746f 5f69 6e74 2863 726f 7373 6f76  t_to_int(crossov
+0000ed10: 6572 5f6f 7065 7261 746f 722e 7370 6c69  er_operator.spli
+0000ed20: 7428 272d 2729 5b2d 315d 290a 2020 2020  t('-')[-1]).    
+0000ed30: 2020 2020 2020 2020 6966 2074 6872 6573          if thres
+0000ed40: 686f 6c64 5f72 6174 696f 2069 7320 4e6f  hold_ratio is No
+0000ed50: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0000ed60: 2020 2020 7468 7265 7368 6f6c 645f 7261      threshold_ra
+0000ed70: 7469 6f20 3d20 302e 320a 2020 2020 2020  tio = 0.2.      
+0000ed80: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000ed90: 2020 2020 2020 2020 2020 2020 6372 6f73              cros
+0000eda0: 736f 7665 725f 6f70 6572 6174 6f72 203d  sover_operator =
+0000edb0: 2027 2d27 2e6a 6f69 6e28 6372 6f73 736f   '-'.join(crosso
+0000edc0: 7665 725f 6f70 6572 6174 6f72 2e73 706c  ver_operator.spl
+0000edd0: 6974 2827 2d27 295b 3a2d 315d 290a 2020  it('-')[:-1]).  
+0000ede0: 2020 2020 2020 2020 2020 2320 6361 6c63            # calc
+0000edf0: 756c 6174 6520 7468 6520 7468 7265 7368  ulate the thresh
+0000ee00: 6f6c 6420 666f 7220 6372 6f73 736f 7665  old for crossove
+0000ee10: 720a 2020 2020 2020 2020 2020 2020 7365  r.            se
+0000ee20: 6c66 2e63 785f 7468 7265 7368 6f6c 645f  lf.cx_threshold_
+0000ee30: 7261 7469 6f20 3d20 7468 7265 7368 6f6c  ratio = threshol
+0000ee40: 645f 7261 7469 6f0a 0a20 2020 2020 2020  d_ratio..       
+0000ee50: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
+0000ee60: 2e62 6173 6963 5f70 7269 6d69 7469 7665  .basic_primitive
+0000ee70: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+0000ee80: 2020 2074 6f6f 6c62 6f78 2e65 7870 725f     toolbox.expr_
+0000ee90: 6d75 7420 3d20 7061 7274 6961 6c28 6770  mut = partial(gp
+0000eea0: 2e67 656e 4675 6c6c 2c20 6d69 6e5f 3d31  .genFull, min_=1
+0000eeb0: 2c20 6d61 785f 3d33 290a 2020 2020 2020  , max_=3).      
+0000eec0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000eed0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0000eee0: 656c 662e 6d75 7461 7469 6f6e 5f63 6f6e  elf.mutation_con
+0000eef0: 6669 6775 7261 7469 6f6e 2e6d 7574 6174  figuration.mutat
+0000ef00: 696f 6e5f 6578 7072 5f68 6569 6768 7420  ion_expr_height 
+0000ef10: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0000ef20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ef30: 206d 696e 5f2c 206d 6178 5f20 3d20 7365   min_, max_ = se
+0000ef40: 6c66 2e6d 7574 6174 696f 6e5f 636f 6e66  lf.mutation_conf
+0000ef50: 6967 7572 6174 696f 6e2e 6d75 7461 7469  iguration.mutati
+0000ef60: 6f6e 5f65 7870 725f 6865 6967 6874 2e73  on_expr_height.s
+0000ef70: 706c 6974 2827 2d27 290a 2020 2020 2020  plit('-').      
+0000ef80: 2020 2020 2020 2020 2020 2020 2020 6d69                mi
+0000ef90: 6e5f 2c20 6d61 785f 203d 2069 6e74 286d  n_, max_ = int(m
+0000efa0: 696e 5f29 2c20 696e 7428 6d61 785f 290a  in_), int(max_).
+0000efb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000efc0: 2020 2020 746f 6f6c 626f 782e 6578 7072      toolbox.expr
+0000efd0: 5f6d 7574 203d 2070 6172 7469 616c 2867  _mut = partial(g
+0000efe0: 702e 6765 6e46 756c 6c2c 206d 696e 5f3d  p.genFull, min_=
+0000eff0: 6d69 6e5f 2c20 6d61 785f 3d6d 6178 5f29  min_, max_=max_)
+0000f000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f010: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0000f020: 2020 2020 2020 2020 2020 2074 6f6f 6c62             toolb
+0000f030: 6f78 2e65 7870 725f 6d75 7420 3d20 7061  ox.expr_mut = pa
+0000f040: 7274 6961 6c28 6770 2e67 656e 4675 6c6c  rtial(gp.genFull
+0000f050: 2c20 6d69 6e5f 3d30 2c20 6d61 785f 3d32  , min_=0, max_=2
+0000f060: 290a 2020 2020 2020 2020 2020 2020 746f  ).            to
+0000f070: 6f6c 626f 782e 7472 6565 5f67 656e 6572  olbox.tree_gener
+0000f080: 6174 696f 6e20 3d20 6770 2e67 656e 4675  ation = gp.genFu
+0000f090: 6c6c 0a0a 2020 2020 2020 2020 2020 2020  ll..            
+0000f0a0: 2320 7370 6563 6961 6c20 6372 6f73 736f  # special crosso
+0000f0b0: 7665 7220 6f70 6572 6174 6f72 730a 2020  ver operators.  
+0000f0c0: 2020 2020 2020 2020 2020 6966 2063 726f            if cro
+0000f0d0: 7373 6f76 6572 5f6f 7065 7261 746f 7220  ssover_operator 
+0000f0e0: 3d3d 2027 616c 6c5f 6765 6e65 273a 0a20  == 'all_gene':. 
+0000f0f0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+0000f100: 6f6f 6c62 6f78 2e72 6567 6973 7465 7228  oolbox.register(
+0000f110: 226d 6174 6522 2c20 6378 4f6e 6550 6f69  "mate", cxOnePoi
+0000f120: 6e74 5f61 6c6c 5f67 656e 6529 0a20 2020  nt_all_gene).   
+0000f130: 2020 2020 2020 2020 2065 6c69 6620 6372           elif cr
+0000f140: 6f73 736f 7665 725f 6f70 6572 6174 6f72  ossover_operator
+0000f150: 203d 3d20 2775 6e69 666f 726d 2d70 6c75   == 'uniform-plu
+0000f160: 732d 7361 6d65 2d69 6e64 6578 273a 0a20  s-same-index':. 
+0000f170: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+0000f180: 6f6f 6c62 6f78 2e72 6567 6973 7465 7228  oolbox.register(
+0000f190: 226d 6174 6522 2c20 6378 4f6e 6550 6f69  "mate", cxOnePoi
+0000f1a0: 6e74 5f6d 756c 7469 706c 655f 6765 6e65  nt_multiple_gene
+0000f1b0: 5f73 616d 655f 696e 6465 7829 0a20 2020  _same_index).   
+0000f1c0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0000f1d0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0000f1e0: 7373 6572 7420 2775 6e69 666f 726d 2720  ssert 'uniform' 
+0000f1f0: 696e 2063 726f 7373 6f76 6572 5f6f 7065  in crossover_ope
+0000f200: 7261 746f 720a 2020 2020 2020 2020 2020  rator.          
+0000f210: 2020 2020 2020 746f 6f6c 626f 782e 7265        toolbox.re
+0000f220: 6769 7374 6572 2822 6d61 7465 222c 2063  gister("mate", c
+0000f230: 784f 6e65 506f 696e 745f 6d75 6c74 6970  xOnePoint_multip
+0000f240: 6c65 5f67 656e 652c 0a20 2020 2020 2020  le_gene,.       
+0000f250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f260: 2020 2020 2020 2020 2020 7073 6574 3d73            pset=s
+0000f270: 656c 662e 7073 6574 2c0a 2020 2020 2020  elf.pset,.      
+0000f280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f290: 2020 2020 2020 2020 2020 2063 726f 7373             cross
+0000f2a0: 6f76 6572 5f63 6f6e 6669 6775 7261 7469  over_configurati
+0000f2b0: 6f6e 3d73 656c 662e 6765 745f 6372 6f73  on=self.get_cros
+0000f2c0: 736f 7665 725f 636f 6e66 6967 7572 6174  sover_configurat
+0000f2d0: 696f 6e28 2929 0a0a 2020 2020 2020 2020  ion())..        
+0000f2e0: 2020 2020 2320 7370 6563 6961 6c20 6d75      # special mu
+0000f2f0: 7461 7469 6f6e 206f 7065 7261 746f 7273  tation operators
+0000f300: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000f310: 7365 6c66 2e74 7261 6e73 666f 726d 6572  self.transformer
+0000f320: 5f73 7769 7463 683a 0a20 2020 2020 2020  _switch:.       
+0000f330: 2020 2020 2020 2020 2023 2075 7369 6e67           # using
+0000f340: 2074 7261 6e73 666f 726d 6572 2074 6f20   transformer to 
+0000f350: 6765 6e65 7261 7465 2073 7562 7472 6565  generate subtree
+0000f360: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
+0000f370: 2020 6465 6620 636f 6e64 6974 696f 6e5f    def condition_
+0000f380: 7072 6f62 6162 696c 6974 7928 293a 0a20  probability():. 
+0000f390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f3a0: 2020 2072 6574 7572 6e20 7365 6c66 2e63     return self.c
+0000f3b0: 7572 7265 6e74 5f67 656e 202f 2073 656c  urrent_gen / sel
+0000f3c0: 662e 6e5f 6765 6e0a 0a20 2020 2020 2020  f.n_gen..       
+0000f3d0: 2020 2020 2020 2020 2074 6f6f 6c62 6f78           toolbox
+0000f3e0: 2e72 6567 6973 7465 7228 226d 7574 6174  .register("mutat
+0000f3f0: 6522 2c20 6d75 7455 6e69 666f 726d 5f6d  e", mutUniform_m
+0000f400: 756c 7469 706c 655f 6765 6e65 5f74 7261  ultiple_gene_tra
+0000f410: 6e73 666f 726d 6572 2c20 6578 7072 3d74  nsformer, expr=t
+0000f420: 6f6f 6c62 6f78 2e65 7870 725f 6d75 742c  oolbox.expr_mut,
+0000f430: 2070 7365 743d 7073 6574 2c0a 2020 2020   pset=pset,.    
+0000f440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f450: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
+0000f460: 6469 7469 6f6e 5f70 726f 6261 6269 6c69  dition_probabili
+0000f470: 7479 3d63 6f6e 6469 7469 6f6e 5f70 726f  ty=condition_pro
+0000f480: 6261 6269 6c69 7479 2c20 7472 616e 7366  bability, transf
+0000f490: 6f72 6d65 723d 7365 6c66 2e74 7261 6e73  ormer=self.trans
+0000f4a0: 666f 726d 6572 5f74 6f6f 6c29 0a20 2020  former_tool).   
+0000f4b0: 2020 2020 2020 2020 2065 6c69 6620 6d75           elif mu
+0000f4c0: 7461 7469 6f6e 5f6f 7065 7261 746f 7220  tation_operator 
+0000f4d0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+0000f4e0: 2020 2020 2020 2020 2074 6f6f 6c62 6f78           toolbox
+0000f4f0: 2e72 6567 6973 7465 7228 226d 7574 6174  .register("mutat
+0000f500: 6522 2c20 6d75 7455 6e69 666f 726d 5f6d  e", mutUniform_m
+0000f510: 756c 7469 706c 655f 6765 6e65 2c20 6578  ultiple_gene, ex
+0000f520: 7072 3d74 6f6f 6c62 6f78 2e65 7870 725f  pr=toolbox.expr_
+0000f530: 6d75 742c 2070 7365 743d 7073 6574 2c0a  mut, pset=pset,.
+0000f540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f560: 2074 7265 655f 6765 6e65 7261 7469 6f6e   tree_generation
+0000f570: 3d67 702e 6765 6e46 756c 6c2c 2063 6f6e  =gp.genFull, con
+0000f580: 6669 6775 7261 7469 6f6e 3d73 656c 662e  figuration=self.
+0000f590: 6d75 7461 7469 6f6e 5f63 6f6e 6669 6775  mutation_configu
+0000f5a0: 7261 7469 6f6e 290a 2020 2020 2020 2020  ration).        
+0000f5b0: 2020 2020 656c 6966 206d 7574 6174 696f      elif mutatio
+0000f5c0: 6e5f 6f70 6572 6174 6f72 203d 3d20 2777  n_operator == 'w
+0000f5d0: 6f72 7374 273a 0a20 2020 2020 2020 2020  orst':.         
+0000f5e0: 2020 2020 2020 2074 6f6f 6c62 6f78 2e72         toolbox.r
+0000f5f0: 6567 6973 7465 7228 226d 7574 6174 6522  egister("mutate"
+0000f600: 2c20 6d75 7455 6e69 666f 726d 5f6d 756c  , mutUniform_mul
+0000f610: 7469 706c 655f 6765 6e65 5f77 6f72 7374  tiple_gene_worst
+0000f620: 2c20 6578 7072 3d74 6f6f 6c62 6f78 2e65  , expr=toolbox.e
+0000f630: 7870 725f 6d75 742c 2070 7365 743d 7073  xpr_mut, pset=ps
+0000f640: 6574 290a 2020 2020 2020 2020 2020 2020  et).            
+0000f650: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0000f660: 2020 2020 2020 7261 6973 6520 4578 6365        raise Exce
+0000f670: 7074 696f 6e0a 2020 2020 2020 2020 656c  ption.        el
+0000f680: 6966 2073 656c 662e 6d75 7461 7469 6f6e  if self.mutation
+0000f690: 5f73 6368 656d 6520 3d3d 2027 7061 7273  _scheme == 'pars
+0000f6a0: 696d 6f6e 696f 7573 5f6d 7574 6174 696f  imonious_mutatio
+0000f6b0: 6e27 3a0a 2020 2020 2020 2020 2020 2020  n':.            
+0000f6c0: 746f 6f6c 626f 782e 7265 6769 7374 6572  toolbox.register
+0000f6d0: 2822 6d61 7465 222c 2063 784f 6e65 506f  ("mate", cxOnePo
+0000f6e0: 696e 745f 6d75 6c74 6970 6c65 5f67 656e  int_multiple_gen
+0000f6f0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+0000f700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f710: 7073 6574 3d73 656c 662e 7073 6574 2c0a  pset=self.pset,.
+0000f720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f730: 2020 2020 2020 2020 2020 2020 2063 726f               cro
+0000f740: 7373 6f76 6572 5f63 6f6e 6669 6775 7261  ssover_configura
+0000f750: 7469 6f6e 3d73 656c 662e 6765 745f 6372  tion=self.get_cr
+0000f760: 6f73 736f 7665 725f 636f 6e66 6967 7572  ossover_configur
+0000f770: 6174 696f 6e28 2929 0a20 2020 2020 2020  ation()).       
+0000f780: 2020 2020 2074 6f6f 6c62 6f78 2e72 6567       toolbox.reg
+0000f790: 6973 7465 7228 226d 7574 6174 6522 2c20  ister("mutate", 
+0000f7a0: 6d75 7450 726f 6261 6269 6c69 7479 5f6d  mutProbability_m
+0000f7b0: 756c 7469 706c 655f 6765 6e65 2c20 7073  ultiple_gene, ps
+0000f7c0: 6574 3d70 7365 742c 0a20 2020 2020 2020  et=pset,.       
+0000f7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f7e0: 2020 2020 2020 7061 7273 696d 6f6e 696f        parsimonio
+0000f7f0: 7573 5f70 726f 6261 6269 6c69 7479 3d73  us_probability=s
+0000f800: 656c 662e 7061 7273 696d 6f6e 696f 7573  elf.parsimonious
+0000f810: 5f70 726f 6261 6269 6c69 7479 290a 2020  _probability).  
+0000f820: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
+0000f830: 6d75 7461 7469 6f6e 5f73 6368 656d 6520  mutation_scheme 
+0000f840: 696e 2065 6461 5f6f 7065 7261 746f 7273  in eda_operators
+0000f850: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+0000f860: 4465 6669 6e65 2074 6865 2063 726f 7373  Define the cross
+0000f870: 6f76 6572 206f 7065 7261 746f 7220 636f  over operator co
+0000f880: 6d62 696e 6564 2074 6865 2045 4441 206f  mbined the EDA o
+0000f890: 7065 7261 746f 720a 2020 2020 2020 2020  perator.        
+0000f8a0: 2020 2020 6966 2027 4269 6173 6564 2720      if 'Biased' 
+0000f8b0: 696e 2073 656c 662e 6d75 7461 7469 6f6e  in self.mutation
+0000f8c0: 5f73 6368 656d 653a 0a20 2020 2020 2020  _scheme:.       
+0000f8d0: 2020 2020 2020 2020 2074 6f6f 6c62 6f78           toolbox
+0000f8e0: 2e72 6567 6973 7465 7228 226d 6174 6522  .register("mate"
+0000f8f0: 2c20 6378 4f6e 6550 6f69 6e74 5f6d 756c  , cxOnePoint_mul
+0000f900: 7469 706c 655f 6765 6e65 5f62 6961 7365  tiple_gene_biase
+0000f910: 6429 0a20 2020 2020 2020 2020 2020 2065  d).            e
+0000f920: 6c69 6620 2753 616d 6557 6569 6768 7427  lif 'SameWeight'
+0000f930: 2069 6e20 7365 6c66 2e6d 7574 6174 696f   in self.mutatio
+0000f940: 6e5f 7363 6865 6d65 3a0a 2020 2020 2020  n_scheme:.      
+0000f950: 2020 2020 2020 2020 2020 746f 6f6c 626f            toolbo
+0000f960: 782e 7265 6769 7374 6572 2822 6d61 7465  x.register("mate
+0000f970: 222c 2063 784f 6e65 506f 696e 745f 6d75  ", cxOnePoint_mu
+0000f980: 6c74 6970 6c65 5f67 656e 655f 7361 6d65  ltiple_gene_same
+0000f990: 5f77 6569 6768 7429 0a20 2020 2020 2020  _weight).       
+0000f9a0: 2020 2020 2065 6c69 6620 2754 6f75 726e       elif 'Tourn
+0000f9b0: 616d 656e 7427 2069 6e20 7365 6c66 2e6d  ament' in self.m
+0000f9c0: 7574 6174 696f 6e5f 7363 6865 6d65 3a0a  utation_scheme:.
+0000f9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f9e0: 746f 6f6c 626f 782e 7265 6769 7374 6572  toolbox.register
+0000f9f0: 2822 6d61 7465 222c 2063 784f 6e65 506f  ("mate", cxOnePo
+0000fa00: 696e 745f 6d75 6c74 6970 6c65 5f67 656e  int_multiple_gen
+0000fa10: 655f 746f 7572 6e61 6d65 6e74 290a 2020  e_tournament).  
+0000fa20: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
+0000fa30: 656c 662e 6d75 7461 7469 6f6e 5f73 6368  elf.mutation_sch
+0000fa40: 656d 652e 656e 6473 7769 7468 2827 2d53  eme.endswith('-S
+0000fa50: 4327 293a 0a20 2020 2020 2020 2020 2020  C'):.           
+0000fa60: 2020 2020 2074 6f6f 6c62 6f78 2e72 6567       toolbox.reg
+0000fa70: 6973 7465 7228 226d 6174 6522 2c20 6378  ister("mate", cx
+0000fa80: 4f6e 6550 6f69 6e74 5f6d 756c 7469 706c  OnePoint_multipl
+0000fa90: 655f 6765 6e65 5f53 4329 0a20 2020 2020  e_gene_SC).     
+0000faa0: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
+0000fab0: 2e6d 7574 6174 696f 6e5f 7363 6865 6d65  .mutation_scheme
+0000fac0: 2e65 6e64 7377 6974 6828 272d 5343 2d57  .endswith('-SC-W
+0000fad0: 5327 293a 0a20 2020 2020 2020 2020 2020  S'):.           
+0000fae0: 2020 2020 2074 6f6f 6c62 6f78 2e72 6567       toolbox.reg
+0000faf0: 6973 7465 7228 226d 6174 6522 2c20 7061  ister("mate", pa
+0000fb00: 7274 6961 6c28 6378 4f6e 6550 6f69 6e74  rtial(cxOnePoint
+0000fb10: 5f6d 756c 7469 706c 655f 6765 6e65 5f53  _multiple_gene_S
+0000fb20: 432c 2074 656d 7065 7261 7475 7265 3d30  C, temperature=0
+0000fb30: 2929 0a20 2020 2020 2020 2020 2020 2065  )).            e
+0000fb40: 6c69 6620 7365 6c66 2e6d 7574 6174 696f  lif self.mutatio
+0000fb50: 6e5f 7363 6865 6d65 2e65 6e64 7377 6974  n_scheme.endswit
+0000fb60: 6828 272d 5343 2d4e 5427 293a 0a20 2020  h('-SC-NT'):.   
+0000fb70: 2020 2020 2020 2020 2020 2020 2074 6f6f               too
+0000fb80: 6c62 6f78 2e72 6567 6973 7465 7228 226d  lbox.register("m
+0000fb90: 6174 6522 2c20 7061 7274 6961 6c28 6378  ate", partial(cx
+0000fba0: 4f6e 6550 6f69 6e74 5f6d 756c 7469 706c  OnePoint_multipl
+0000fbb0: 655f 6765 6e65 5f53 432c 2074 656d 7065  e_gene_SC, tempe
+0000fbc0: 7261 7475 7265 3d31 2929 0a20 2020 2020  rature=1)).     
+0000fbd0: 2020 2020 2020 2065 6c69 6620 2753 616d         elif 'Sam
+0000fbe0: 6549 6e64 6578 2720 696e 2073 656c 662e  eIndex' in self.
+0000fbf0: 6d75 7461 7469 6f6e 5f73 6368 656d 653a  mutation_scheme:
+0000fc00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000fc10: 2074 6f6f 6c62 6f78 2e72 6567 6973 7465   toolbox.registe
+0000fc20: 7228 226d 6174 6522 2c20 6378 4f6e 6550  r("mate", cxOneP
+0000fc30: 6f69 6e74 5f6d 756c 7469 706c 655f 6765  oint_multiple_ge
+0000fc40: 6e65 5f73 616d 655f 696e 6465 7829 0a20  ne_same_index). 
+0000fc50: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0000fc60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000fc70: 2074 6f6f 6c62 6f78 2e72 6567 6973 7465   toolbox.registe
+0000fc80: 7228 226d 6174 6522 2c20 6378 4f6e 6550  r("mate", cxOneP
+0000fc90: 6f69 6e74 5f6d 756c 7469 706c 655f 6765  oint_multiple_ge
+0000fca0: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
+0000fcb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fcc0: 2020 2020 2070 7365 743d 7365 6c66 2e70       pset=self.p
+0000fcd0: 7365 742c 0a20 2020 2020 2020 2020 2020  set,.           
 0000fce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fcf0: 2020 6d61 785f 7661 6c75 653d 7365 6c66    max_value=self
-0000fd00: 2e6d 6178 5f68 6569 6768 742c 0a20 2020  .max_height,.   
-0000fd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fd30: 2020 2020 2020 2020 206d 696e 5f76 616c           min_val
-0000fd40: 7565 3d73 656c 662e 6d69 6e5f 6865 6967  ue=self.min_heig
-0000fd50: 6874 2928 6d75 7455 6e69 666f 726d 290a  ht)(mutUniform).
-0000fd60: 0a20 2020 2020 2020 2073 656c 662e 706f  .        self.po
-0000fd70: 7020 3d20 746f 6f6c 626f 782e 706f 7075  p = toolbox.popu
-0000fd80: 6c61 7469 6f6e 286e 3d73 656c 662e 6e5f  lation(n=self.n_
-0000fd90: 706f 7029 0a0a 2020 2020 2020 2020 7365  pop)..        se
-0000fda0: 6c66 2e72 616e 646f 6d5f 696e 6465 7820  lf.random_index 
-0000fdb0: 3d20 6e70 2e72 616e 646f 6d2e 7261 6e64  = np.random.rand
-0000fdc0: 696e 7428 302c 206c 656e 2873 656c 662e  int(0, len(self.
-0000fdd0: 5829 2c20 3529 0a0a 2020 2020 2020 2020  X), 5)..        
-0000fde0: 6465 6620 7368 7566 666c 655f 616c 6f6e  def shuffle_alon
-0000fdf0: 675f 6178 6973 2861 2c20 6178 6973 293a  g_axis(a, axis):
-0000fe00: 0a20 2020 2020 2020 2020 2020 2069 6478  .            idx
-0000fe10: 203d 206e 702e 7261 6e64 6f6d 2e72 616e   = np.random.ran
-0000fe20: 6428 2a61 2e73 6861 7065 292e 6172 6773  d(*a.shape).args
-0000fe30: 6f72 7428 6178 6973 3d61 7869 7329 0a20  ort(axis=axis). 
-0000fe40: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000fe50: 6e20 6e70 2e74 616b 655f 616c 6f6e 675f  n np.take_along_
-0000fe60: 6178 6973 2861 2c20 6964 782c 2061 7869  axis(a, idx, axi
-0000fe70: 733d 6178 6973 290a 0a20 2020 2020 2020  s=axis)..       
-0000fe80: 2073 656c 662e 7072 6564 6963 7469 6f6e   self.prediction
-0000fe90: 5f78 203d 2073 6875 6666 6c65 5f61 6c6f  _x = shuffle_alo
-0000fea0: 6e67 5f61 7869 7328 6e70 2e63 6f70 7928  ng_axis(np.copy(
-0000feb0: 7365 6c66 2e58 292c 2061 7869 733d 3029  self.X), axis=0)
-0000fec0: 0a0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-0000fed0: 662e 6261 7365 5f6c 6561 726e 6572 203d  f.base_learner =
-0000fee0: 3d20 274e 4e27 3a0a 2020 2020 2020 2020  = 'NN':.        
-0000fef0: 2020 2020 6376 203d 2067 6574 5f63 765f      cv = get_cv_
-0000ff00: 7370 6c69 7474 6572 2873 656c 662e 6e65  splitter(self.ne
-0000ff10: 7572 616c 5f6e 6574 776f 726b 2c20 7365  ural_network, se
-0000ff20: 6c66 2e63 7629 0a20 2020 2020 2020 2020  lf.cv).         
-0000ff30: 2020 2073 656c 662e 6e6e 5f70 7265 6469     self.nn_predi
-0000ff40: 6374 696f 6e20 3d20 6e70 2e7a 6572 6f73  ction = np.zeros
-0000ff50: 2828 6c65 6e28 7365 6c66 2e79 292c 2073  ((len(self.y), s
-0000ff60: 656c 662e 6869 6464 656e 5f6c 6179 6572  elf.hidden_layer
-0000ff70: 735b 2d31 5d29 290a 0a20 2020 2020 2020  s[-1]))..       
-0000ff80: 2020 2020 2058 2c20 7920 3d20 7365 6c66       X, y = self
-0000ff90: 2e58 2c20 7365 6c66 2e79 0a20 2020 2020  .X, self.y.     
-0000ffa0: 2020 2020 2020 2063 765f 6c6f 7373 203d         cv_loss =
-0000ffb0: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
-0000ffc0: 666f 7220 7472 6169 6e5f 696e 6465 782c  for train_index,
-0000ffd0: 2074 6573 745f 696e 6465 7820 696e 2063   test_index in c
-0000ffe0: 762e 7370 6c69 7428 5829 3a0a 2020 2020  v.split(X):.    
-0000fff0: 2020 2020 2020 2020 2020 2020 585f 7472              X_tr
-00010000: 6169 6e2c 2058 5f74 6573 7420 3d20 585b  ain, X_test = X[
-00010010: 7472 6169 6e5f 696e 6465 785d 2c20 585b  train_index], X[
-00010020: 7465 7374 5f69 6e64 6578 5d0a 2020 2020  test_index].    
-00010030: 2020 2020 2020 2020 2020 2020 795f 7472              y_tr
-00010040: 6169 6e2c 2079 5f74 6573 7420 3d20 795b  ain, y_test = y[
-00010050: 7472 6169 6e5f 696e 6465 785d 2c20 795b  train_index], y[
-00010060: 7465 7374 5f69 6e64 6578 5d0a 2020 2020  test_index].    
-00010070: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00010080: 2e6e 6575 7261 6c5f 6e65 7477 6f72 6b2e  .neural_network.
-00010090: 6669 7428 585f 7472 6169 6e2c 2079 5f74  fit(X_train, y_t
-000100a0: 7261 696e 290a 2020 2020 2020 2020 2020  rain).          
-000100b0: 2020 2020 2020 6376 5f6c 6f73 732e 6170        cv_loss.ap
-000100c0: 7065 6e64 2872 325f 7363 6f72 6528 795f  pend(r2_score(y_
-000100d0: 7465 7374 2c20 7365 6c66 2e6e 6575 7261  test, self.neura
-000100e0: 6c5f 6e65 7477 6f72 6b2e 7072 6564 6963  l_network.predic
-000100f0: 7428 585f 7465 7374 2929 290a 2020 2020  t(X_test))).    
-00010100: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00010110: 2e6e 6e5f 7072 6564 6963 7469 6f6e 5b74  .nn_prediction[t
-00010120: 6573 745f 696e 6465 785d 203d 2067 6574  est_index] = get
-00010130: 5f61 6374 6976 6174 696f 6e73 2873 656c  _activations(sel
-00010140: 662e 6e65 7572 616c 5f6e 6574 776f 726b  f.neural_network
-00010150: 2c20 585f 7465 7374 295b 2d32 5d0a 2020  , X_test)[-2].  
-00010160: 2020 2020 2020 2020 2020 2320 7072 696e            # prin
-00010170: 7428 274d 6561 6e20 4356 206c 6f73 7327  t('Mean CV loss'
-00010180: 2c20 6e70 2e6d 6561 6e28 6376 5f6c 6f73  , np.mean(cv_los
-00010190: 7329 290a 0a20 2020 2020 2020 2020 2020  s))..           
-000101a0: 2073 656c 662e 6e65 7572 616c 5f6e 6574   self.neural_net
-000101b0: 776f 726b 2e66 6974 2873 656c 662e 582c  work.fit(self.X,
-000101c0: 2073 656c 662e 7929 0a20 2020 2020 2020   self.y).       
-000101d0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-000101e0: 2020 2073 656c 662e 6e6e 5f70 7265 6469     self.nn_predi
-000101f0: 6374 696f 6e20 3d20 4e6f 6e65 0a20 2020  ction = None.   
-00010200: 2020 2020 2073 656c 662e 7468 7265 6164       self.thread
-00010210: 5f70 6f6f 6c5f 696e 6974 6961 6c69 7a61  _pool_initializa
-00010220: 7469 6f6e 2829 0a0a 2020 2020 6465 6620  tion()..    def 
-00010230: 7072 696d 6974 6976 655f 696e 6974 6961  primitive_initia
-00010240: 6c69 7a61 7469 6f6e 2873 656c 662c 2078  lization(self, x
-00010250: 293a 0a20 2020 2020 2020 2023 2069 6e69  ):.        # ini
-00010260: 7469 616c 697a 6520 7468 6520 7072 696d  tialize the prim
-00010270: 6974 6976 6520 7365 740a 2020 2020 2020  itive set.      
-00010280: 2020 6966 2073 656c 662e 6261 7369 635f    if self.basic_
-00010290: 7072 696d 6974 6976 6573 203d 3d20 2753  primitives == 'S
-000102a0: 7472 6f6e 6754 7970 6564 273a 0a20 2020  trongTyped':.   
-000102b0: 2020 2020 2020 2020 2066 6561 7475 7265           feature
-000102c0: 5f74 7970 6573 203d 2073 656c 662e 6665  _types = self.fe
-000102d0: 6174 7572 655f 7479 7065 730a 2020 2020  ature_types.    
-000102e0: 2020 2020 2020 2020 7073 6574 203d 2067          pset = g
-000102f0: 702e 5072 696d 6974 6976 6553 6574 5479  p.PrimitiveSetTy
-00010300: 7065 6428 224d 4149 4e22 2c20 6665 6174  ped("MAIN", feat
-00010310: 7572 655f 7479 7065 732c 2047 656e 6572  ure_types, Gener
-00010320: 616c 4665 6174 7572 6529 0a20 2020 2020  alFeature).     
-00010330: 2020 2020 2020 2068 6173 5f6e 756d 6572         has_numer
-00010340: 6963 616c 5f66 6561 7475 7265 203d 2046  ical_feature = F
-00010350: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-00010360: 2066 6f72 2078 2069 6e20 6665 6174 7572   for x in featur
-00010370: 655f 7479 7065 733a 0a20 2020 2020 2020  e_types:.       
-00010380: 2020 2020 2020 2020 2069 6620 7820 3d3d           if x ==
-00010390: 204e 756d 6572 6963 616c 4665 6174 7572   NumericalFeatur
-000103a0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000103b0: 2020 2020 2020 2068 6173 5f6e 756d 6572         has_numer
-000103c0: 6963 616c 5f66 6561 7475 7265 203d 2054  ical_feature = T
-000103d0: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
-000103e0: 6861 735f 6361 7465 676f 7269 6361 6c5f  has_categorical_
-000103f0: 6665 6174 7572 6520 3d20 4661 6c73 650a  feature = False.
-00010400: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00010410: 7820 696e 2066 6561 7475 7265 5f74 7970  x in feature_typ
-00010420: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-00010430: 2020 2020 6966 2078 203d 3d20 4361 7465      if x == Cate
-00010440: 676f 7269 6361 6c46 6561 7475 7265 3a0a  goricalFeature:.
-00010450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010460: 2020 2020 6861 735f 6361 7465 676f 7269      has_categori
-00010470: 6361 6c5f 6665 6174 7572 6520 3d20 5472  cal_feature = Tr
-00010480: 7565 0a20 2020 2020 2020 2020 2020 2068  ue.            h
-00010490: 6173 5f62 6f6f 6c65 616e 5f66 6561 7475  as_boolean_featu
-000104a0: 7265 203d 2046 616c 7365 0a20 2020 2020  re = False.     
-000104b0: 2020 2020 2020 2066 6f72 2078 2069 6e20         for x in 
-000104c0: 6665 6174 7572 655f 7479 7065 733a 0a20  feature_types:. 
-000104d0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000104e0: 6620 7820 3d3d 2042 6f6f 6c65 616e 4665  f x == BooleanFe
-000104f0: 6174 7572 653a 0a20 2020 2020 2020 2020  ature:.         
-00010500: 2020 2020 2020 2020 2020 2068 6173 5f62             has_b
-00010510: 6f6f 6c65 616e 5f66 6561 7475 7265 203d  oolean_feature =
-00010520: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
-00010530: 2020 6966 2068 6173 5f6e 756d 6572 6963    if has_numeric
-00010540: 616c 5f66 6561 7475 7265 3a0a 2020 2020  al_feature:.    
-00010550: 2020 2020 2020 2020 2020 2020 7073 6574              pset
-00010560: 2e61 6464 5072 696d 6974 6976 6528 6e70  .addPrimitive(np
-00010570: 2e61 6464 2c20 5b4e 756d 6572 6963 616c  .add, [Numerical
-00010580: 4665 6174 7572 652c 204e 756d 6572 6963  Feature, Numeric
-00010590: 616c 4665 6174 7572 655d 2c20 4e75 6d65  alFeature], Nume
-000105a0: 7269 6361 6c46 6561 7475 7265 290a 2020  ricalFeature).  
-000105b0: 2020 2020 2020 2020 2020 2020 2020 7073                ps
-000105c0: 6574 2e61 6464 5072 696d 6974 6976 6528  et.addPrimitive(
-000105d0: 6e70 2e73 7562 7472 6163 742c 205b 4e75  np.subtract, [Nu
-000105e0: 6d65 7269 6361 6c46 6561 7475 7265 2c20  mericalFeature, 
-000105f0: 4e75 6d65 7269 6361 6c46 6561 7475 7265  NumericalFeature
-00010600: 5d2c 204e 756d 6572 6963 616c 4665 6174  ], NumericalFeat
-00010610: 7572 6529 0a20 2020 2020 2020 2020 2020  ure).           
-00010620: 2020 2020 2070 7365 742e 6164 6450 7269       pset.addPri
-00010630: 6d69 7469 7665 286e 702e 6d75 6c74 6970  mitive(np.multip
-00010640: 6c79 2c20 5b4e 756d 6572 6963 616c 4665  ly, [NumericalFe
-00010650: 6174 7572 652c 204e 756d 6572 6963 616c  ature, Numerical
-00010660: 4665 6174 7572 655d 2c20 4e75 6d65 7269  Feature], Numeri
-00010670: 6361 6c46 6561 7475 7265 290a 2020 2020  calFeature).    
-00010680: 2020 2020 2020 2020 2020 2020 7073 6574              pset
-00010690: 2e61 6464 5072 696d 6974 6976 6528 616e  .addPrimitive(an
-000106a0: 616c 7974 6963 616c 5f71 756f 7469 656e  alytical_quotien
-000106b0: 742c 205b 4e75 6d65 7269 6361 6c46 6561  t, [NumericalFea
-000106c0: 7475 7265 2c20 4e75 6d65 7269 6361 6c46  ture, NumericalF
-000106d0: 6561 7475 7265 5d2c 204e 756d 6572 6963  eature], Numeric
-000106e0: 616c 4665 6174 7572 6529 0a20 2020 2020  alFeature).     
-000106f0: 2020 2020 2020 2020 2020 2070 7365 742e             pset.
-00010700: 6164 6450 7269 6d69 7469 7665 286e 702e  addPrimitive(np.
-00010710: 6d61 7869 6d75 6d2c 205b 4e75 6d65 7269  maximum, [Numeri
-00010720: 6361 6c46 6561 7475 7265 2c20 4e75 6d65  calFeature, Nume
-00010730: 7269 6361 6c46 6561 7475 7265 5d2c 204e  ricalFeature], N
-00010740: 756d 6572 6963 616c 4665 6174 7572 6529  umericalFeature)
+0000fcf0: 2020 2020 2020 6372 6f73 736f 7665 725f        crossover_
+0000fd00: 636f 6e66 6967 7572 6174 696f 6e3d 7365  configuration=se
+0000fd10: 6c66 2e67 6574 5f63 726f 7373 6f76 6572  lf.get_crossover
+0000fd20: 5f63 6f6e 6669 6775 7261 7469 6f6e 2829  _configuration()
+0000fd30: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+0000fd40: 6c66 2e70 7269 6d69 7469 7665 5f70 726f  lf.primitive_pro
+0000fd50: 6220 3d20 6e70 2e7a 6572 6f73 2873 656c  b = np.zeros(sel
+0000fd60: 662e 7073 6574 2e70 7269 6d73 5f63 6f75  f.pset.prims_cou
+0000fd70: 6e74 290a 2020 2020 2020 2020 2020 2020  nt).            
+0000fd80: 7365 6c66 2e74 6572 6d69 6e61 6c5f 7072  self.terminal_pr
+0000fd90: 6f62 203d 206e 702e 7a65 726f 7328 7365  ob = np.zeros(se
+0000fda0: 6c66 2e70 7365 742e 7465 726d 735f 636f  lf.pset.terms_co
+0000fdb0: 756e 7429 0a20 2020 2020 2020 2020 2020  unt).           
+0000fdc0: 2069 6620 7365 6c66 2e6d 6770 5f6d 6f64   if self.mgp_mod
+0000fdd0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0000fde0: 2020 2073 656c 662e 7465 726d 696e 616c     self.terminal
+0000fdf0: 5f70 726f 6220 3d20 5b5d 0a20 2020 2020  _prob = [].     
+0000fe00: 2020 2020 2020 2069 6620 2754 6572 6d69         if 'Termi
+0000fe10: 6e61 6c27 2069 6e20 7365 6c66 2e6d 7574  nal' in self.mut
+0000fe20: 6174 696f 6e5f 7363 6865 6d65 3a0a 2020  ation_scheme:.  
+0000fe30: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0000fe40: 6c66 2e70 7269 6d69 7469 7665 5f70 726f  lf.primitive_pro
+0000fe50: 6220 3d20 6e70 2e6f 6e65 7328 7365 6c66  b = np.ones(self
+0000fe60: 2e70 7365 742e 7072 696d 735f 636f 756e  .pset.prims_coun
+0000fe70: 7429 0a20 2020 2020 2020 2020 2020 2069  t).            i
+0000fe80: 6620 7365 6c66 2e6d 7574 6174 696f 6e5f  f self.mutation_
+0000fe90: 7363 6865 6d65 203d 3d20 2745 4441 2d54  scheme == 'EDA-T
+0000fea0: 6572 6d69 6e61 6c27 3a0a 2020 2020 2020  erminal':.      
+0000feb0: 2020 2020 2020 2020 2020 2320 5361 6d70            # Samp
+0000fec0: 6c65 2074 6572 6d69 6e61 6c73 2066 726f  le terminals fro
+0000fed0: 6d20 6120 6469 7269 6368 6c65 7420 6469  m a dirichlet di
+0000fee0: 7374 7269 6275 7469 6f6e 0a20 2020 2020  stribution.     
+0000fef0: 2020 2020 2020 2020 2020 2023 2054 6865             # The
+0000ff00: 2061 6476 616e 7461 6765 2069 7320 7468   advantage is th
+0000ff10: 6174 2074 6869 7320 6d65 7468 6f64 2073  at this method s
+0000ff20: 7570 706f 7274 7320 7072 696f 7220 6469  upports prior di
+0000ff30: 7374 7269 6275 7469 6f6e 0a20 2020 2020  stribution.     
+0000ff40: 2020 2020 2020 2020 2020 2070 6172 7469             parti
+0000ff50: 616c 5f66 756e 6320 3d20 7061 7274 6961  al_func = partia
+0000ff60: 6c28 6765 6e46 756c 6c5f 7769 7468 5f70  l(genFull_with_p
+0000ff70: 726f 622c 206d 6f64 656c 3d73 656c 662c  rob, model=self,
+0000ff80: 2073 616d 706c 655f 7479 7065 3d27 4469   sample_type='Di
+0000ff90: 7269 6368 6c65 7427 290a 2020 2020 2020  richlet').      
+0000ffa0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000ffb0: 2020 2020 2020 2020 2020 2020 7061 7274              part
+0000ffc0: 6961 6c5f 6675 6e63 203d 2070 6172 7469  ial_func = parti
+0000ffd0: 616c 2867 656e 4675 6c6c 5f77 6974 685f  al(genFull_with_
+0000ffe0: 7072 6f62 2c20 6d6f 6465 6c3d 7365 6c66  prob, model=self
+0000fff0: 290a 2020 2020 2020 2020 2020 2020 746f  ).            to
+00010000: 6f6c 626f 782e 7472 6565 5f67 656e 6572  olbox.tree_gener
+00010010: 6174 696f 6e20 3d20 7061 7274 6961 6c5f  ation = partial_
+00010020: 6675 6e63 0a20 2020 2020 2020 2020 2020  func.           
+00010030: 2069 6620 7365 6c66 2e6d 7574 6174 696f   if self.mutatio
+00010040: 6e5f 636f 6e66 6967 7572 6174 696f 6e2e  n_configuration.
+00010050: 6d75 7461 7469 6f6e 5f65 7870 725f 6865  mutation_expr_he
+00010060: 6967 6874 2069 7320 6e6f 7420 4e6f 6e65  ight is not None
+00010070: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00010080: 2020 6d69 6e5f 2c20 6d61 785f 203d 2073    min_, max_ = s
+00010090: 656c 662e 6d75 7461 7469 6f6e 5f63 6f6e  elf.mutation_con
+000100a0: 6669 6775 7261 7469 6f6e 2e6d 7574 6174  figuration.mutat
+000100b0: 696f 6e5f 6578 7072 5f68 6569 6768 742e  ion_expr_height.
+000100c0: 7370 6c69 7428 272d 2729 0a20 2020 2020  split('-').     
+000100d0: 2020 2020 2020 2020 2020 206d 696e 5f2c             min_,
+000100e0: 206d 6178 5f20 3d20 696e 7428 6d69 6e5f   max_ = int(min_
+000100f0: 292c 2069 6e74 286d 6178 5f29 0a20 2020  ), int(max_).   
+00010100: 2020 2020 2020 2020 2020 2020 2074 6f6f               too
+00010110: 6c62 6f78 2e65 7870 725f 6d75 7420 3d20  lbox.expr_mut = 
+00010120: 7061 7274 6961 6c28 7061 7274 6961 6c5f  partial(partial_
+00010130: 6675 6e63 2c20 6d69 6e5f 3d6d 696e 5f2c  func, min_=min_,
+00010140: 206d 6178 5f3d 6d61 785f 290a 2020 2020   max_=max_).    
+00010150: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00010160: 2020 2020 2020 2020 2020 2020 2020 746f                to
+00010170: 6f6c 626f 782e 6578 7072 5f6d 7574 203d  olbox.expr_mut =
+00010180: 2070 6172 7469 616c 2870 6172 7469 616c   partial(partial
+00010190: 5f66 756e 632c 206d 696e 5f3d 302c 206d  _func, min_=0, m
+000101a0: 6178 5f3d 3229 0a20 2020 2020 2020 2020  ax_=2).         
+000101b0: 2020 2074 6f6f 6c62 6f78 2e72 6567 6973     toolbox.regis
+000101c0: 7465 7228 226d 7574 6174 6522 2c20 6d75  ter("mutate", mu
+000101d0: 7455 6e69 666f 726d 5f6d 756c 7469 706c  tUniform_multipl
+000101e0: 655f 6765 6e65 2c20 6578 7072 3d74 6f6f  e_gene, expr=too
+000101f0: 6c62 6f78 2e65 7870 725f 6d75 742c 2070  lbox.expr_mut, p
+00010200: 7365 743d 7073 6574 2c0a 2020 2020 2020  set=pset,.      
+00010210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010220: 2020 2020 2020 2074 7265 655f 6765 6e65         tree_gene
+00010230: 7261 7469 6f6e 3d70 6172 7469 616c 5f66  ration=partial_f
+00010240: 756e 632c 2063 6f6e 6669 6775 7261 7469  unc, configurati
+00010250: 6f6e 3d73 656c 662e 6d75 7461 7469 6f6e  on=self.mutation
+00010260: 5f63 6f6e 6669 6775 7261 7469 6f6e 290a  _configuration).
+00010270: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00010280: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00010290: 4578 6365 7074 696f 6e0a 0a20 2020 2020  Exception..     
+000102a0: 2020 2064 6566 2064 796e 616d 6963 5f68     def dynamic_h
+000102b0: 6569 6768 7428 293a 0a20 2020 2020 2020  eight():.       
+000102c0: 2020 2020 2069 6620 6c65 6e28 7365 6c66       if len(self
+000102d0: 2e67 656e 6572 6174 6564 5f66 6561 7475  .generated_featu
+000102e0: 7265 7329 203e 3d20 5c0a 2020 2020 2020  res) >= \.      
+000102f0: 2020 2020 2020 2020 2020 6e70 2e6c 6f67            np.log
+00010300: 286c 656e 2873 656c 662e 7073 6574 2e70  (len(self.pset.p
+00010310: 7269 6d69 7469 7665 7329 202a 2028 3220  rimitives) * (2 
+00010320: 2a2a 2073 656c 662e 6375 7272 656e 745f  ** self.current_
+00010330: 6865 6967 6874 202d 2031 2920 2a20 5c0a  height - 1) * \.
+00010340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010350: 2020 2020 2020 206c 656e 2873 656c 662e         len(self.
+00010360: 7073 6574 2e74 6572 6d69 6e61 6c73 2920  pset.terminals) 
+00010370: 2a20 2832 202a 2a20 7365 6c66 2e63 7572  * (2 ** self.cur
+00010380: 7265 6e74 5f68 6569 6768 7429 2920 2f20  rent_height)) / 
+00010390: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
+000103a0: 2020 6e70 2e6c 6f67 2831 2e30 3129 3a0a    np.log(1.01):.
+000103b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000103c0: 7365 6c66 2e63 7572 7265 6e74 5f68 6569  self.current_hei
+000103d0: 6768 7420 2b3d 2031 0a20 2020 2020 2020  ght += 1.       
+000103e0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+000103f0: 2e63 7572 7265 6e74 5f68 6569 6768 740a  .current_height.
+00010400: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00010410: 2e76 6572 626f 7365 3a0a 2020 2020 2020  .verbose:.      
+00010420: 2020 2020 2020 6869 7374 6f72 7920 3d20        history = 
+00010430: 4869 7374 6f72 7928 290a 2020 2020 2020  History().      
+00010440: 2020 2020 2020 7365 6c66 2e68 6973 746f        self.histo
+00010450: 7279 203d 2068 6973 746f 7279 0a20 2020  ry = history.   
+00010460: 2020 2020 2020 2020 2023 2044 6563 6f72           # Decor
+00010470: 6174 6520 7468 6520 7661 7269 6174 696f  ate the variatio
+00010480: 6e20 6f70 6572 6174 6f72 730a 2020 2020  n operators.    
+00010490: 2020 2020 2020 2020 746f 6f6c 626f 782e          toolbox.
+000104a0: 6465 636f 7261 7465 2822 6d61 7465 222c  decorate("mate",
+000104b0: 2068 6973 746f 7279 2e64 6563 6f72 6174   history.decorat
+000104c0: 6f72 290a 2020 2020 2020 2020 2020 2020  or).            
+000104d0: 746f 6f6c 626f 782e 6465 636f 7261 7465  toolbox.decorate
+000104e0: 2822 6d75 7461 7465 222c 2068 6973 746f  ("mutate", histo
+000104f0: 7279 2e64 6563 6f72 6174 6f72 290a 0a20  ry.decorator).. 
+00010500: 2020 2020 2020 2073 656c 662e 7369 7a65         self.size
+00010510: 5f66 6169 6c75 7265 5f63 6f75 6e74 6572  _failure_counter
+00010520: 203d 2046 6169 6c75 7265 436f 756e 7465   = FailureCounte
+00010530: 7228 290a 2020 2020 2020 2020 6966 2069  r().        if i
+00010540: 7369 6e73 7461 6e63 6528 7365 6c66 2e6d  sinstance(self.m
+00010550: 6178 5f68 6569 6768 742c 2073 7472 2920  ax_height, str) 
+00010560: 616e 6420 7365 6c66 2e6d 6178 5f68 6569  and self.max_hei
+00010570: 6768 742e 7374 6172 7473 7769 7468 2822  ght.startswith("
+00010580: 6669 7822 293a 0a20 2020 2020 2020 2020  fix"):.         
+00010590: 2020 2073 656c 662e 6d61 785f 6865 6967     self.max_heig
+000105a0: 6874 203d 2069 6e74 2873 656c 662e 6d61  ht = int(self.ma
+000105b0: 785f 6865 6967 6874 2e73 706c 6974 2827  x_height.split('
+000105c0: 2d27 295b 315d 290a 2020 2020 2020 2020  -')[1]).        
+000105d0: 2020 2020 7365 6c66 2e73 7461 7469 635f      self.static_
+000105e0: 6c69 6d69 745f 6675 6e63 7469 6f6e 203d  limit_function =
+000105f0: 2073 7461 7469 634c 696d 6974 5f6d 756c   staticLimit_mul
+00010600: 7469 706c 655f 6765 6e65 280a 2020 2020  tiple_gene(.    
+00010610: 2020 2020 2020 2020 2020 2020 6b65 793d              key=
+00010620: 6f70 6572 6174 6f72 2e61 7474 7267 6574  operator.attrget
+00010630: 7465 7228 2268 6569 6768 7422 292c 0a20  ter("height"),. 
+00010640: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00010650: 6178 5f76 616c 7565 3d73 656c 662e 6d61  ax_value=self.ma
+00010660: 785f 6865 6967 6874 2c0a 2020 2020 2020  x_height,.      
+00010670: 2020 2020 2020 2020 2020 6d69 6e5f 7661            min_va
+00010680: 6c75 653d 7365 6c66 2e6d 696e 5f68 6569  lue=self.min_hei
+00010690: 6768 742c 0a20 2020 2020 2020 2020 2020  ght,.           
+000106a0: 2020 2020 2072 616e 646f 6d5f 6669 783d       random_fix=
+000106b0: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
+000106c0: 2020 2020 2020 2066 6169 6c75 7265 5f63         failure_c
+000106d0: 6f75 6e74 6572 3d73 656c 662e 7369 7a65  ounter=self.size
+000106e0: 5f66 6169 6c75 7265 5f63 6f75 6e74 6572  _failure_counter
+000106f0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00010700: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00010710: 2020 2020 2020 2020 2073 656c 662e 7374           self.st
+00010720: 6174 6963 5f6c 696d 6974 5f66 756e 6374  atic_limit_funct
+00010730: 696f 6e20 3d20 7374 6174 6963 4c69 6d69  ion = staticLimi
+00010740: 745f 6d75 6c74 6970 6c65 5f67 656e 6528  t_multiple_gene(
 00010750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010760: 2070 7365 742e 6164 6450 7269 6d69 7469   pset.addPrimiti
-00010770: 7665 286e 702e 6d69 6e69 6d75 6d2c 205b  ve(np.minimum, [
-00010780: 4e75 6d65 7269 6361 6c46 6561 7475 7265  NumericalFeature
-00010790: 2c20 4e75 6d65 7269 6361 6c46 6561 7475  , NumericalFeatu
-000107a0: 7265 5d2c 204e 756d 6572 6963 616c 4665  re], NumericalFe
-000107b0: 6174 7572 6529 0a20 2020 2020 2020 2020  ature).         
-000107c0: 2020 2020 2020 2070 7365 742e 6164 6450         pset.addP
-000107d0: 7269 6d69 7469 7665 286e 702e 7369 6e2c  rimitive(np.sin,
-000107e0: 205b 4e75 6d65 7269 6361 6c46 6561 7475   [NumericalFeatu
-000107f0: 7265 5d2c 204e 756d 6572 6963 616c 4665  re], NumericalFe
-00010800: 6174 7572 6529 0a20 2020 2020 2020 2020  ature).         
-00010810: 2020 2020 2020 2070 7365 742e 6164 6450         pset.addP
-00010820: 7269 6d69 7469 7665 286e 702e 636f 732c  rimitive(np.cos,
-00010830: 205b 4e75 6d65 7269 6361 6c46 6561 7475   [NumericalFeatu
-00010840: 7265 5d2c 204e 756d 6572 6963 616c 4665  re], NumericalFe
-00010850: 6174 7572 6529 0a20 2020 2020 2020 2020  ature).         
-00010860: 2020 2020 2020 2070 7365 742e 6164 6450         pset.addP
-00010870: 7269 6d69 7469 7665 285f 7072 6f74 6563  rimitive(_protec
-00010880: 7465 645f 7371 7274 2c20 5b4e 756d 6572  ted_sqrt, [Numer
-00010890: 6963 616c 4665 6174 7572 655d 2c20 4e75  icalFeature], Nu
-000108a0: 6d65 7269 6361 6c46 6561 7475 7265 290a  mericalFeature).
-000108b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000108c0: 7073 6574 2e61 6464 5072 696d 6974 6976  pset.addPrimitiv
-000108d0: 6528 6964 656e 7469 6361 6c5f 6e75 6d65  e(identical_nume
-000108e0: 7269 6361 6c2c 205b 4e75 6d65 7269 6361  rical, [Numerica
-000108f0: 6c46 6561 7475 7265 5d2c 2047 656e 6572  lFeature], Gener
-00010900: 616c 4665 6174 7572 6529 0a20 2020 2020  alFeature).     
-00010910: 2020 2020 2020 2069 6620 6861 735f 6361         if has_ca
-00010920: 7465 676f 7269 6361 6c5f 6665 6174 7572  tegorical_featur
-00010930: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00010940: 2020 2070 7365 742e 6164 6450 7269 6d69     pset.addPrimi
-00010950: 7469 7665 286e 705f 6269 745f 7772 6170  tive(np_bit_wrap
-00010960: 7065 7228 6e70 2e62 6974 7769 7365 5f61  per(np.bitwise_a
-00010970: 6e64 292c 205b 4361 7465 676f 7269 6361  nd), [Categorica
-00010980: 6c46 6561 7475 7265 2c20 4361 7465 676f  lFeature, Catego
-00010990: 7269 6361 6c46 6561 7475 7265 5d2c 0a20  ricalFeature],. 
+00010760: 206b 6579 3d6f 7065 7261 746f 722e 6174   key=operator.at
+00010770: 7472 6765 7474 6572 2822 6865 6967 6874  trgetter("height
+00010780: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
+00010790: 2020 2020 6d61 785f 7661 6c75 653d 7365      max_value=se
+000107a0: 6c66 2e6d 6178 5f68 6569 6768 742c 0a20  lf.max_height,. 
+000107b0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+000107c0: 696e 5f76 616c 7565 3d73 656c 662e 6d69  in_value=self.mi
+000107d0: 6e5f 6865 6967 6874 2c0a 2020 2020 2020  n_height,.      
+000107e0: 2020 2020 2020 2020 2020 7261 6e64 6f6d            random
+000107f0: 5f66 6978 3d73 656c 662e 7261 6e64 6f6d  _fix=self.random
+00010800: 5f66 6978 2c0a 2020 2020 2020 2020 2020  _fix,.          
+00010810: 2020 2020 2020 6661 696c 7572 655f 636f        failure_co
+00010820: 756e 7465 723d 7365 6c66 2e73 697a 655f  unter=self.size_
+00010830: 6661 696c 7572 655f 636f 756e 7465 720a  failure_counter.
+00010840: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00010850: 2020 2020 2020 6966 2073 656c 662e 6d75        if self.mu
+00010860: 6c74 695f 6765 6e65 5f6d 7574 6174 696f  lti_gene_mutatio
+00010870: 6e28 293a 0a20 2020 2020 2020 2020 2020  n():.           
+00010880: 2023 2046 6f72 206d 756c 7469 2d74 7265   # For multi-tre
+00010890: 6520 7661 7269 6174 696f 6e20 6f70 6572  e variation oper
+000108a0: 6174 6f72 732c 2068 6569 6768 7420 636f  ators, height co
+000108b0: 6e73 7472 6169 6e74 2069 7320 6170 706c  nstraint is appl
+000108c0: 6965 6420 7769 7468 2064 6563 6f72 6174  ied with decorat
+000108d0: 6f72 206d 6f64 650a 2020 2020 2020 2020  or mode.        
+000108e0: 2020 2020 7061 7373 0a20 2020 2020 2020      pass.       
+000108f0: 2065 6c69 6620 7365 6c66 2e6d 6178 5f68   elif self.max_h
+00010900: 6569 6768 7420 3d3d 2027 6479 6e61 6d69  eight == 'dynami
+00010910: 6327 3a0a 2020 2020 2020 2020 2020 2020  c':.            
+00010920: 746f 6f6c 626f 782e 6465 636f 7261 7465  toolbox.decorate
+00010930: 2822 6d61 7465 222c 2073 7461 7469 634c  ("mate", staticL
+00010940: 696d 6974 5f6d 756c 7469 706c 655f 6765  imit_multiple_ge
+00010950: 6e65 286b 6579 3d6f 7065 7261 746f 722e  ne(key=operator.
+00010960: 6174 7472 6765 7474 6572 2822 6865 6967  attrgetter("heig
+00010970: 6874 2229 2c0a 2020 2020 2020 2020 2020  ht"),.          
+00010980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010990: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000109a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000109b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000109c0: 2043 6174 6567 6f72 6963 616c 4665 6174   CategoricalFeat
-000109d0: 7572 6529 0a20 2020 2020 2020 2020 2020  ure).           
-000109e0: 2020 2020 2070 7365 742e 6164 6450 7269       pset.addPri
-000109f0: 6d69 7469 7665 286e 705f 6269 745f 7772  mitive(np_bit_wr
-00010a00: 6170 7065 7228 6e70 2e62 6974 7769 7365  apper(np.bitwise
-00010a10: 5f6f 7229 2c20 5b43 6174 6567 6f72 6963  _or), [Categoric
-00010a20: 616c 4665 6174 7572 652c 2043 6174 6567  alFeature, Categ
-00010a30: 6f72 6963 616c 4665 6174 7572 655d 2c0a  oricalFeature],.
+000109b0: 2020 2020 206d 6178 5f76 616c 7565 3d64       max_value=d
+000109c0: 796e 616d 6963 5f68 6569 6768 7429 290a  ynamic_height)).
+000109d0: 2020 2020 2020 2020 2020 2020 746f 6f6c              tool
+000109e0: 626f 782e 6465 636f 7261 7465 2822 6d75  box.decorate("mu
+000109f0: 7461 7465 222c 2073 7461 7469 634c 696d  tate", staticLim
+00010a00: 6974 5f6d 756c 7469 706c 655f 6765 6e65  it_multiple_gene
+00010a10: 286b 6579 3d6f 7065 7261 746f 722e 6174  (key=operator.at
+00010a20: 7472 6765 7474 6572 2822 6865 6967 6874  trgetter("height
+00010a30: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
 00010a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00010a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010a60: 2020 4361 7465 676f 7269 6361 6c46 6561    CategoricalFea
-00010a70: 7475 7265 290a 2020 2020 2020 2020 2020  ture).          
-00010a80: 2020 2020 2020 7073 6574 2e61 6464 5072        pset.addPr
-00010a90: 696d 6974 6976 6528 6e70 5f62 6974 5f77  imitive(np_bit_w
-00010aa0: 7261 7070 6572 286e 702e 6269 7477 6973  rapper(np.bitwis
-00010ab0: 655f 786f 7229 2c20 5b43 6174 6567 6f72  e_xor), [Categor
-00010ac0: 6963 616c 4665 6174 7572 652c 2043 6174  icalFeature, Cat
-00010ad0: 6567 6f72 6963 616c 4665 6174 7572 655d  egoricalFeature]
-00010ae0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00010af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010b00: 2020 2020 4361 7465 676f 7269 6361 6c46      CategoricalF
-00010b10: 6561 7475 7265 290a 2020 2020 2020 2020  eature).        
-00010b20: 2020 2020 2020 2020 7073 6574 2e61 6464          pset.add
-00010b30: 5072 696d 6974 6976 6528 6964 656e 7469  Primitive(identi
-00010b40: 6361 6c5f 6361 7465 676f 7269 6361 6c2c  cal_categorical,
-00010b50: 205b 4361 7465 676f 7269 6361 6c46 6561   [CategoricalFea
-00010b60: 7475 7265 5d2c 2047 656e 6572 616c 4665  ture], GeneralFe
-00010b70: 6174 7572 6529 0a20 2020 2020 2020 2020  ature).         
-00010b80: 2020 2069 6620 6861 735f 626f 6f6c 6561     if has_boolea
-00010b90: 6e5f 6665 6174 7572 653a 0a20 2020 2020  n_feature:.     
-00010ba0: 2020 2020 2020 2020 2020 2069 6620 6861             if ha
-00010bb0: 735f 6e75 6d65 7269 6361 6c5f 6665 6174  s_numerical_feat
-00010bc0: 7572 653a 0a20 2020 2020 2020 2020 2020  ure:.           
-00010bd0: 2020 2020 2020 2020 2070 7365 742e 6164           pset.ad
-00010be0: 6450 7269 6d69 7469 7665 286e 702e 6772  dPrimitive(np.gr
-00010bf0: 6561 7465 722c 205b 4e75 6d65 7269 6361  eater, [Numerica
-00010c00: 6c46 6561 7475 7265 2c20 4e75 6d65 7269  lFeature, Numeri
-00010c10: 6361 6c46 6561 7475 7265 5d2c 2042 6f6f  calFeature], Boo
-00010c20: 6c65 616e 4665 6174 7572 6529 0a20 2020  leanFeature).   
+00010a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010a70: 2020 2020 206d 6178 5f76 616c 7565 3d64       max_value=d
+00010a80: 796e 616d 6963 5f68 6569 6768 7429 290a  ynamic_height)).
+00010a90: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
+00010aa0: 6e73 7461 6e63 6528 7365 6c66 2e6d 6178  nstance(self.max
+00010ab0: 5f68 6569 6768 742c 2073 7472 2920 616e  _height, str) an
+00010ac0: 6420 2773 697a 652d 2720 696e 2073 656c  d 'size-' in sel
+00010ad0: 662e 6d61 785f 6865 6967 6874 3a0a 2020  f.max_height:.  
+00010ae0: 2020 2020 2020 2020 2020 7369 7a65 203d            size =
+00010af0: 2069 6e74 2873 656c 662e 6d61 785f 6865   int(self.max_he
+00010b00: 6967 6874 2e73 706c 6974 2827 2d27 295b  ight.split('-')[
+00010b10: 315d 290a 2020 2020 2020 2020 2020 2020  1]).            
+00010b20: 746f 6f6c 626f 782e 6465 636f 7261 7465  toolbox.decorate
+00010b30: 2822 6d61 7465 222c 2073 7461 7469 634c  ("mate", staticL
+00010b40: 696d 6974 5f6d 756c 7469 706c 655f 6765  imit_multiple_ge
+00010b50: 6e65 286b 6579 3d6c 616d 6264 6120 783a  ne(key=lambda x:
+00010b60: 206c 656e 2878 292c 0a20 2020 2020 2020   len(x),.       
+00010b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010ba0: 2020 2020 2020 2020 6d61 785f 7661 6c75          max_valu
+00010bb0: 653d 7369 7a65 2929 0a20 2020 2020 2020  e=size)).       
+00010bc0: 2020 2020 2074 6f6f 6c62 6f78 2e64 6563       toolbox.dec
+00010bd0: 6f72 6174 6528 226d 7574 6174 6522 2c20  orate("mutate", 
+00010be0: 7374 6174 6963 4c69 6d69 745f 6d75 6c74  staticLimit_mult
+00010bf0: 6970 6c65 5f67 656e 6528 6b65 793d 6c61  iple_gene(key=la
+00010c00: 6d62 6461 2078 3a20 6c65 6e28 7829 2c0a  mbda x: len(x),.
+00010c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00010c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010c40: 2070 7365 742e 6164 6450 7269 6d69 7469   pset.addPrimiti
-00010c50: 7665 286e 702e 6c65 7373 2c20 5b4e 756d  ve(np.less, [Num
-00010c60: 6572 6963 616c 4665 6174 7572 652c 204e  ericalFeature, N
-00010c70: 756d 6572 6963 616c 4665 6174 7572 655d  umericalFeature]
-00010c80: 2c20 426f 6f6c 6561 6e46 6561 7475 7265  , BooleanFeature
-00010c90: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00010ca0: 2020 7073 6574 2e61 6464 5072 696d 6974    pset.addPrimit
-00010cb0: 6976 6528 6e70 2e6c 6f67 6963 616c 5f61  ive(np.logical_a
-00010cc0: 6e64 2c20 5b42 6f6f 6c65 616e 4665 6174  nd, [BooleanFeat
-00010cd0: 7572 652c 2042 6f6f 6c65 616e 4665 6174  ure, BooleanFeat
-00010ce0: 7572 655d 2c20 426f 6f6c 6561 6e46 6561  ure], BooleanFea
-00010cf0: 7475 7265 290a 2020 2020 2020 2020 2020  ture).          
-00010d00: 2020 2020 2020 7073 6574 2e61 6464 5072        pset.addPr
-00010d10: 696d 6974 6976 6528 6e70 2e6c 6f67 6963  imitive(np.logic
-00010d20: 616c 5f6f 722c 205b 426f 6f6c 6561 6e46  al_or, [BooleanF
-00010d30: 6561 7475 7265 2c20 426f 6f6c 6561 6e46  eature, BooleanF
-00010d40: 6561 7475 7265 5d2c 2042 6f6f 6c65 616e  eature], Boolean
-00010d50: 4665 6174 7572 6529 0a20 2020 2020 2020  Feature).       
-00010d60: 2020 2020 2020 2020 2070 7365 742e 6164           pset.ad
-00010d70: 6450 7269 6d69 7469 7665 286e 702e 6c6f  dPrimitive(np.lo
-00010d80: 6769 6361 6c5f 786f 722c 205b 426f 6f6c  gical_xor, [Bool
-00010d90: 6561 6e46 6561 7475 7265 2c20 426f 6f6c  eanFeature, Bool
-00010da0: 6561 6e46 6561 7475 7265 5d2c 2042 6f6f  eanFeature], Boo
-00010db0: 6c65 616e 4665 6174 7572 6529 0a20 2020  leanFeature).   
-00010dc0: 2020 2020 2020 2020 2020 2020 2070 7365               pse
-00010dd0: 742e 6164 6450 7269 6d69 7469 7665 2869  t.addPrimitive(i
-00010de0: 6465 6e74 6963 616c 5f62 6f6f 6c65 616e  dentical_boolean
-00010df0: 2c20 5b42 6f6f 6c65 616e 4665 6174 7572  , [BooleanFeatur
-00010e00: 655d 2c20 4765 6e65 7261 6c46 6561 7475  e], GeneralFeatu
-00010e10: 7265 290a 2020 2020 2020 2020 656c 6966  re).        elif
-00010e20: 2073 656c 662e 6261 7369 635f 7072 696d   self.basic_prim
-00010e30: 6974 6976 6573 203d 3d20 2765 7874 656e  itives == 'exten
-00010e40: 6427 3a0a 2020 2020 2020 2020 2020 2020  d':.            
-00010e50: 7073 6574 203d 2050 7269 6d69 7469 7665  pset = Primitive
-00010e60: 5365 7428 224d 4149 4e22 2c20 782e 7368  Set("MAIN", x.sh
-00010e70: 6170 655b 315d 290a 2020 2020 2020 2020  ape[1]).        
-00010e80: 2020 2020 6164 645f 6261 7369 635f 6f70      add_basic_op
-00010e90: 6572 6174 6f72 7328 7073 6574 290a 2020  erators(pset).  
-00010ea0: 2020 2020 2020 2020 2020 6164 645f 6578            add_ex
-00010eb0: 7465 6e64 5f6f 7065 7261 746f 7273 2870  tend_operators(p
-00010ec0: 7365 7429 0a20 2020 2020 2020 2065 6c69  set).        eli
-00010ed0: 6620 7365 6c66 2e62 6173 6963 5f70 7269  f self.basic_pri
-00010ee0: 6d69 7469 7665 7320 3d3d 2027 6578 7465  mitives == 'exte
-00010ef0: 6e64 2d74 7269 706c 6527 3a0a 2020 2020  nd-triple':.    
-00010f00: 2020 2020 2020 2020 7073 6574 203d 2050          pset = P
-00010f10: 7269 6d69 7469 7665 5365 7428 224d 4149  rimitiveSet("MAI
-00010f20: 4e22 2c20 782e 7368 6170 655b 315d 290a  N", x.shape[1]).
-00010f30: 2020 2020 2020 2020 2020 2020 6164 645f              add_
-00010f40: 6261 7369 635f 6f70 6572 6174 6f72 7328  basic_operators(
-00010f50: 7073 6574 290a 2020 2020 2020 2020 2020  pset).          
-00010f60: 2020 6164 645f 6578 7465 6e64 5f6f 7065    add_extend_ope
-00010f70: 7261 746f 7273 2870 7365 742c 2074 7269  rators(pset, tri
-00010f80: 706c 655f 6772 6f75 7062 795f 6f70 6572  ple_groupby_oper
-00010f90: 6174 6f72 733d 5472 7565 290a 2020 2020  ators=True).    
-00010fa0: 2020 2020 656c 6966 2073 656c 662e 6261      elif self.ba
-00010fb0: 7369 635f 7072 696d 6974 6976 6573 203d  sic_primitives =
-00010fc0: 3d20 2765 7874 656e 642d 7369 6d70 6c65  = 'extend-simple
-00010fd0: 273a 0a20 2020 2020 2020 2020 2020 2070  ':.            p
-00010fe0: 7365 7420 3d20 5072 696d 6974 6976 6553  set = PrimitiveS
-00010ff0: 6574 2822 4d41 494e 222c 2078 2e73 6861  et("MAIN", x.sha
-00011000: 7065 5b31 5d29 0a20 2020 2020 2020 2020  pe[1]).         
-00011010: 2020 2061 6464 5f62 6173 6963 5f6f 7065     add_basic_ope
-00011020: 7261 746f 7273 2870 7365 7429 0a20 2020  rators(pset).   
-00011030: 2020 2020 2020 2020 2061 6464 5f65 7874           add_ext
-00011040: 656e 645f 6f70 6572 6174 6f72 7328 7073  end_operators(ps
-00011050: 6574 2c20 6772 6f75 7062 795f 6f70 6572  et, groupby_oper
-00011060: 6174 6f72 733d 4661 6c73 6529 0a20 2020  ators=False).   
-00011070: 2020 2020 2065 6c69 6620 6973 696e 7374       elif isinst
-00011080: 616e 6365 2873 656c 662e 6261 7369 635f  ance(self.basic_
-00011090: 7072 696d 6974 6976 6573 2c20 7374 7229  primitives, str)
-000110a0: 2061 6e64 2027 6f70 7469 6d61 6c27 2069   and 'optimal' i
-000110b0: 6e20 7365 6c66 2e62 6173 6963 5f70 7269  n self.basic_pri
-000110c0: 6d69 7469 7665 733a 0a20 2020 2020 2020  mitives:.       
-000110d0: 2020 2020 2070 7365 7420 3d20 5072 696d       pset = Prim
-000110e0: 6974 6976 6553 6574 2822 4d41 494e 222c  itiveSet("MAIN",
-000110f0: 2078 2e73 6861 7065 5b31 5d29 0a20 2020   x.shape[1]).   
-00011100: 2020 2020 2020 2020 2023 2073 7570 706f           # suppo
-00011110: 7274 206d 756c 7469 7661 7269 6174 6520  rt multivariate 
-00011120: 6675 6e63 7469 6f6e 730a 2020 2020 2020  functions.      
-00011130: 2020 2020 2020 636f 756e 7420 3d20 300a        count = 0.
-00011140: 2020 2020 2020 2020 2020 2020 6966 2027              if '
-00011150: 2d27 2069 6e20 7365 6c66 2e62 6173 6963  -' in self.basic
-00011160: 5f70 7269 6d69 7469 7665 733a 0a20 2020  _primitives:.   
-00011170: 2020 2020 2020 2020 2020 2020 2063 6f75               cou
-00011180: 6e74 203d 2069 6e74 2873 656c 662e 6261  nt = int(self.ba
-00011190: 7369 635f 7072 696d 6974 6976 6573 2e73  sic_primitives.s
-000111a0: 706c 6974 2827 2d27 295b 315d 290a 0a20  plit('-')[1]).. 
-000111b0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-000111c0: 6566 206e 705f 6164 645f 6d75 6c74 6970  ef np_add_multip
-000111d0: 6c65 282a 6172 6729 3a0a 2020 2020 2020  le(*arg):.      
-000111e0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-000111f0: 7475 726e 206e 702e 7375 6d28 6172 672c  turn np.sum(arg,
-00011200: 2061 7869 733d 3029 0a0a 2020 2020 2020   axis=0)..      
-00011210: 2020 2020 2020 2020 2020 6465 6620 6e70            def np
-00011220: 5f6d 6178 5f6d 756c 7469 706c 6528 2a61  _max_multiple(*a
-00011230: 7267 293a 0a20 2020 2020 2020 2020 2020  rg):.           
-00011240: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00011250: 6e70 2e6d 6178 2861 7267 2c20 6178 6973  np.max(arg, axis
-00011260: 3d30 290a 0a20 2020 2020 2020 2020 2020  =0)..           
-00011270: 2020 2020 2064 6566 206e 705f 6d69 6e5f       def np_min_
-00011280: 6d75 6c74 6970 6c65 282a 6172 6729 3a0a  multiple(*arg):.
-00011290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000112a0: 2020 2020 7265 7475 726e 206e 702e 6d69      return np.mi
-000112b0: 6e28 6172 672c 2061 7869 733d 3029 0a0a  n(arg, axis=0)..
-000112c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000112d0: 666f 7220 6920 696e 2072 616e 6765 2833  for i in range(3
-000112e0: 2c20 636f 756e 7420 2b20 3129 3a0a 2020  , count + 1):.  
-000112f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011300: 2020 6e70 5f61 6464 5f6d 756c 7469 706c    np_add_multipl
-00011310: 652e 5f5f 6e61 6d65 5f5f 203d 2066 276e  e.__name__ = f'n
-00011320: 705f 6164 645f 6d75 6c74 6970 6c65 5f7b  p_add_multiple_{
-00011330: 697d 270a 2020 2020 2020 2020 2020 2020  i}'.            
-00011340: 2020 2020 2020 2020 6e70 5f6d 6178 5f6d          np_max_m
-00011350: 756c 7469 706c 652e 5f5f 6e61 6d65 5f5f  ultiple.__name__
-00011360: 203d 2066 276e 705f 6d61 785f 6d75 6c74   = f'np_max_mult
-00011370: 6970 6c65 5f7b 697d 270a 2020 2020 2020  iple_{i}'.      
-00011380: 2020 2020 2020 2020 2020 2020 2020 6e70                np
-00011390: 5f6d 696e 5f6d 756c 7469 706c 652e 5f5f  _min_multiple.__
-000113a0: 6e61 6d65 5f5f 203d 2066 276e 705f 6d69  name__ = f'np_mi
-000113b0: 6e5f 6d75 6c74 6970 6c65 5f7b 697d 270a  n_multiple_{i}'.
-000113c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000113d0: 2020 2020 7073 6574 2e61 6464 5072 696d      pset.addPrim
-000113e0: 6974 6976 6528 6e70 5f61 6464 5f6d 756c  itive(np_add_mul
-000113f0: 7469 706c 652c 2069 290a 2020 2020 2020  tiple, i).      
-00011400: 2020 2020 2020 2020 2020 2020 2020 7073                ps
-00011410: 6574 2e61 6464 5072 696d 6974 6976 6528  et.addPrimitive(
-00011420: 6e70 5f6d 6178 5f6d 756c 7469 706c 652c  np_max_multiple,
-00011430: 2069 290a 2020 2020 2020 2020 2020 2020   i).            
-00011440: 2020 2020 2020 2020 7073 6574 2e61 6464          pset.add
-00011450: 5072 696d 6974 6976 6528 6e70 5f6d 696e  Primitive(np_min
-00011460: 5f6d 756c 7469 706c 652c 2069 290a 0a20  _multiple, i).. 
-00011470: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00011480: 6261 7369 635f 7072 696d 6974 6976 6573  basic_primitives
-00011490: 203d 2027 2c27 2e6a 6f69 6e28 5b0a 2020   = ','.join([.  
-000114a0: 2020 2020 2020 2020 2020 2020 2020 2761                'a
-000114b0: 6464 272c 2027 7375 6274 7261 6374 272c  dd', 'subtract',
-000114c0: 2027 6d75 6c74 6970 6c79 272c 2027 616e   'multiply', 'an
-000114d0: 616c 7974 6963 616c 5f71 756f 7469 656e  alytical_quotien
-000114e0: 7427 2c0a 2020 2020 2020 2020 2020 2020  t',.            
-000114f0: 2020 2020 2770 726f 7465 6374 5f73 7172      'protect_sqr
-00011500: 7427 2c20 2773 696e 272c 2027 636f 7327  t', 'sin', 'cos'
-00011510: 2c20 276d 6178 696d 756d 272c 2027 6d69  , 'maximum', 'mi
-00011520: 6e69 6d75 6d27 2c20 276e 6567 6174 6976  nimum', 'negativ
-00011530: 6527 2c0a 2020 2020 2020 2020 2020 2020  e',.            
-00011540: 5d29 0a20 2020 2020 2020 2020 2020 2073  ]).            s
-00011550: 656c 662e 6164 645f 7072 696d 6974 6976  elf.add_primitiv
-00011560: 6573 5f74 6f5f 7073 6574 2870 7365 7429  es_to_pset(pset)
-00011570: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00011580: 636f 756e 7420 213d 2030 3a0a 2020 2020  count != 0:.    
-00011590: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000115a0: 2e62 6173 6963 5f70 7269 6d69 7469 7665  .basic_primitive
-000115b0: 7320 3d20 6627 6f70 7469 6d61 6c2d 7b63  s = f'optimal-{c
-000115c0: 6f75 6e74 7d27 0a20 2020 2020 2020 2065  ount}'.        e
-000115d0: 6c69 6620 7365 6c66 2e62 6173 6963 5f70  lif self.basic_p
-000115e0: 7269 6d69 7469 7665 7320 3d3d 2027 4449  rimitives == 'DI
-000115f0: 4745 4e27 3a0a 2020 2020 2020 2020 2020  GEN':.          
-00011600: 2020 7073 6574 203d 2067 702e 5072 696d    pset = gp.Prim
-00011610: 6974 6976 6553 6574 2822 4d41 494e 222c  itiveSet("MAIN",
-00011620: 2078 2e73 6861 7065 5b31 5d29 0a20 2020   x.shape[1]).   
-00011630: 2020 2020 2020 2020 2073 656c 662e 6261           self.ba
-00011640: 7369 635f 7072 696d 6974 6976 6573 203d  sic_primitives =
-00011650: 2027 2c27 2e6a 6f69 6e28 5b0a 2020 2020   ','.join([.    
-00011660: 2020 2020 2020 2020 2020 2020 2761 6464              'add
-00011670: 272c 2027 7375 6274 7261 6374 272c 2027  ', 'subtract', '
-00011680: 6d75 6c74 6970 6c79 272c 2027 616e 616c  multiply', 'anal
-00011690: 7974 6963 616c 5f71 756f 7469 656e 7427  ytical_quotient'
-000116a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000116b0: 2020 2770 726f 7465 6374 5f73 7172 7427    'protect_sqrt'
-000116c0: 2c20 2773 696e 272c 2027 636f 7327 2c20  , 'sin', 'cos', 
-000116d0: 276d 6178 696d 756d 272c 2027 6d69 6e69  'maximum', 'mini
-000116e0: 6d75 6d27 2c20 276e 6567 6174 6976 6527  mum', 'negative'
-000116f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00011700: 2020 2767 7265 6174 6572 5f6f 725f 6571    'greater_or_eq
-00011710: 7561 6c5f 7468 616e 272c 2027 6c65 7373  ual_than', 'less
-00011720: 5f6f 725f 6571 7561 6c5f 7468 616e 270a  _or_equal_than'.
-00011730: 2020 2020 2020 2020 2020 2020 5d29 0a20              ]). 
-00011740: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00011750: 6164 645f 7072 696d 6974 6976 6573 5f74  add_primitives_t
-00011760: 6f5f 7073 6574 2870 7365 7429 0a20 2020  o_pset(pset).   
-00011770: 2020 2020 2065 6c69 6620 6973 696e 7374       elif isinst
-00011780: 616e 6365 2873 656c 662e 6261 7369 635f  ance(self.basic_
-00011790: 7072 696d 6974 6976 6573 2c20 7374 7229  primitives, str)
-000117a0: 2061 6e64 2073 656c 662e 6261 7369 635f   and self.basic_
-000117b0: 7072 696d 6974 6976 6573 2e73 7461 7274  primitives.start
-000117c0: 7377 6974 6828 274d 4c27 293a 0a20 2020  swith('ML'):.   
-000117d0: 2020 2020 2020 2020 2070 7365 7420 3d20           pset = 
-000117e0: 5072 696d 6974 6976 6553 6574 2822 4d41  PrimitiveSet("MA
-000117f0: 494e 222c 2078 2e73 6861 7065 5b31 5d29  IN", x.shape[1])
-00011800: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-00011810: 6d69 7469 7665 7320 3d20 272c 272e 6a6f  mitives = ','.jo
-00011820: 696e 285b 0a20 2020 2020 2020 2020 2020  in([.           
-00011830: 2020 2020 2027 6164 6427 2c20 2773 7562       'add', 'sub
-00011840: 7472 6163 7427 2c20 276d 756c 7469 706c  tract', 'multipl
-00011850: 7927 2c20 2761 6e61 6c79 7469 6361 6c5f  y', 'analytical_
-00011860: 7175 6f74 6965 6e74 272c 0a20 2020 2020  quotient',.     
-00011870: 2020 2020 2020 2020 2020 2027 7072 6f74             'prot
-00011880: 6563 745f 7371 7274 272c 2027 7369 6e27  ect_sqrt', 'sin'
-00011890: 2c20 2763 6f73 272c 2027 6d61 7869 6d75  , 'cos', 'maximu
-000118a0: 6d27 2c20 276d 696e 696d 756d 272c 2027  m', 'minimum', '
-000118b0: 6e65 6761 7469 7665 272c 0a20 2020 2020  negative',.     
-000118c0: 2020 2020 2020 205d 290a 2020 2020 2020         ]).      
-000118d0: 2020 2020 2020 6d6f 6465 6c73 203d 2073        models = s
-000118e0: 656c 662e 6261 7369 635f 7072 696d 6974  elf.basic_primit
-000118f0: 6976 6573 2e72 6570 6c61 6365 2827 4d4c  ives.replace('ML
-00011900: 2d27 2c20 2727 292e 7370 6c69 7428 272c  -', '').split(',
-00011910: 2729 0a20 2020 2020 2020 2020 2020 2066  ').            f
-00011920: 6f72 206d 2069 6e20 6d6f 6465 6c73 3a0a  or m in models:.
-00011930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011940: 6966 206d 203d 3d20 2754 6172 6765 7445  if m == 'TargetE
-00011950: 6e63 6f64 6572 273a 0a20 2020 2020 2020  ncoder':.       
-00011960: 2020 2020 2020 2020 2020 2020 2070 7365               pse
-00011970: 742e 6164 6450 7269 6d69 7469 7665 286d  t.addPrimitive(m
-00011980: 616b 655f 636c 6173 7328 5461 7267 6574  ake_class(Target
-00011990: 456e 636f 6465 724e 756d 7079 2c20 322c  EncoderNumpy, 2,
-000119a0: 2070 6172 616d 6574 6572 733d 6469 6374   parameters=dict
-000119b0: 2863 6f6c 733d 5b30 5d2c 2072 6574 7572  (cols=[0], retur
-000119c0: 6e5f 6466 3d46 616c 7365 2929 2c20 3229  n_df=False)), 2)
-000119d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000119e0: 2069 6620 6d20 3d3d 2027 4b4e 4e2d 3227   if m == 'KNN-2'
-000119f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00011a00: 2020 2020 2020 7073 6574 2e61 6464 5072        pset.addPr
-00011a10: 696d 6974 6976 6528 6d61 6b65 5f63 6c61  imitive(make_cla
-00011a20: 7373 284b 4e65 6967 6862 6f72 7352 6567  ss(KNeighborsReg
-00011a30: 7265 7373 6f72 2c20 3229 2c20 3229 0a20  ressor, 2), 2). 
-00011a40: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00011a50: 6620 6d20 3d3d 2027 4454 2d32 273a 0a20  f m == 'DT-2':. 
-00011a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011a70: 2020 2070 7365 742e 6164 6450 7269 6d69     pset.addPrimi
-00011a80: 7469 7665 286d 616b 655f 636c 6173 7328  tive(make_class(
-00011a90: 4465 6369 7369 6f6e 5472 6565 5265 6772  DecisionTreeRegr
-00011aa0: 6573 736f 722c 2032 292c 2032 290a 2020  essor, 2), 2).  
-00011ab0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00011ac0: 206d 203d 3d20 2752 6964 6765 2d32 273a   m == 'Ridge-2':
-00011ad0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011ae0: 2020 2020 2070 7365 742e 6164 6450 7269       pset.addPri
-00011af0: 6d69 7469 7665 286d 616b 655f 636c 6173  mitive(make_clas
-00011b00: 7328 5269 6467 652c 2032 292c 2032 290a  s(Ridge, 2), 2).
-00011b10: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00011b20: 2e61 6464 5f70 7269 6d69 7469 7665 735f  .add_primitives_
-00011b30: 746f 5f70 7365 7428 7073 6574 2c20 7072  to_pset(pset, pr
-00011b40: 696d 6974 6976 6573 2c20 7472 616e 7366  imitives, transf
-00011b50: 6f72 6d65 725f 7772 6170 7065 723d 5472  ormer_wrapper=Tr
-00011b60: 7565 290a 2020 2020 2020 2020 2020 2020  ue).            
-00011b70: 7365 6c66 2e62 6173 6963 5f70 7269 6d69  self.basic_primi
-00011b80: 7469 7665 7320 3d20 274d 4c27 0a20 2020  tives = 'ML'.   
-00011b90: 2020 2020 2065 6c69 6620 7365 6c66 2e62       elif self.b
-00011ba0: 6173 6963 5f70 7269 6d69 7469 7665 7320  asic_primitives 
-00011bb0: 3d3d 2027 4344 4643 273a 0a20 2020 2020  == 'CDFC':.     
-00011bc0: 2020 2020 2020 2023 2070 7269 6d69 7469         # primiti
-00011bd0: 7665 7320 7573 6564 2069 6e20 4344 4643  ves used in CDFC
-00011be0: 0a20 2020 2020 2020 2020 2020 2023 2022  .            # "
-00011bf0: 4765 6e65 7469 6320 7072 6f67 7261 6d6d  Genetic programm
-00011c00: 696e 6720 666f 7220 6d75 6c74 6970 6c65  ing for multiple
-00011c10: 2d66 6561 7475 7265 2063 6f6e 7374 7275  -feature constru
-00011c20: 6374 696f 6e20 6f6e 2068 6967 682d 6469  ction on high-di
-00011c30: 6d65 6e73 696f 6e61 6c20 636c 6173 7369  mensional classi
-00011c40: 6669 6361 7469 6f6e 220a 2020 2020 2020  fication".      
-00011c50: 2020 2020 2020 7073 6574 203d 2067 702e        pset = gp.
-00011c60: 5072 696d 6974 6976 6553 6574 2822 4d41  PrimitiveSet("MA
-00011c70: 494e 222c 2078 2e73 6861 7065 5b31 5d29  IN", x.shape[1])
-00011c80: 0a20 2020 2020 2020 2020 2020 2061 6464  .            add
-00011c90: 5f62 6173 6963 5f6f 7065 7261 746f 7273  _basic_operators
-00011ca0: 2870 7365 7429 0a20 2020 2020 2020 2020  (pset).         
-00011cb0: 2020 2070 7365 742e 6164 6450 7269 6d69     pset.addPrimi
-00011cc0: 7469 7665 286e 702e 6d61 7869 6d75 6d2c  tive(np.maximum,
-00011cd0: 2032 290a 2020 2020 2020 2020 2020 2020   2).            
-00011ce0: 7073 6574 2e61 6464 5072 696d 6974 6976  pset.addPrimitiv
-00011cf0: 6528 6966 5f66 756e 6374 696f 6e2c 2033  e(if_function, 3
-00011d00: 290a 2020 2020 2020 2020 656c 6966 2073  ).        elif s
-00011d10: 656c 662e 6261 7369 635f 7072 696d 6974  elf.basic_primit
-00011d20: 6976 6573 203d 3d20 276c 6f67 6963 616c  ives == 'logical
-00011d30: 273a 0a20 2020 2020 2020 2020 2020 2070  ':.            p
-00011d40: 7365 7420 3d20 6770 2e50 7269 6d69 7469  set = gp.Primiti
-00011d50: 7665 5365 7428 224d 4149 4e22 2c20 782e  veSet("MAIN", x.
-00011d60: 7368 6170 655b 315d 290a 2020 2020 2020  shape[1]).      
-00011d70: 2020 2020 2020 6164 645f 6c6f 6769 6361        add_logica
-00011d80: 6c5f 6f70 6572 6174 6f72 7328 7073 6574  l_operators(pset
-00011d90: 290a 2020 2020 2020 2020 656c 6966 2073  ).        elif s
-00011da0: 656c 662e 6261 7369 635f 7072 696d 6974  elf.basic_primit
-00011db0: 6976 6573 203d 3d20 2772 656c 6174 696f  ives == 'relatio
-00011dc0: 6e27 3a0a 2020 2020 2020 2020 2020 2020  n':.            
-00011dd0: 7073 6574 203d 2067 702e 5072 696d 6974  pset = gp.Primit
-00011de0: 6976 6553 6574 2822 4d41 494e 222c 2078  iveSet("MAIN", x
-00011df0: 2e73 6861 7065 5b31 5d29 0a20 2020 2020  .shape[1]).     
-00011e00: 2020 2020 2020 2061 6464 5f62 6173 6963         add_basic
-00011e10: 5f6f 7065 7261 746f 7273 2870 7365 7429  _operators(pset)
-00011e20: 0a20 2020 2020 2020 2020 2020 2061 6464  .            add
-00011e30: 5f72 656c 6174 696f 6e5f 6f70 6572 6174  _relation_operat
-00011e40: 6f72 7328 7073 6574 290a 2020 2020 2020  ors(pset).      
-00011e50: 2020 656c 6966 2073 656c 662e 6261 7369    elif self.basi
-00011e60: 635f 7072 696d 6974 6976 6573 203d 3d20  c_primitives == 
-00011e70: 276e 6f72 6d61 6c69 7a65 6427 3a0a 2020  'normalized':.  
-00011e80: 2020 2020 2020 2020 2020 7073 6574 203d            pset =
-00011e90: 2067 702e 5072 696d 6974 6976 6553 6574   gp.PrimitiveSet
-00011ea0: 2822 4d41 494e 222c 2078 2e73 6861 7065  ("MAIN", x.shape
-00011eb0: 5b31 5d29 0a0a 2020 2020 2020 2020 2020  [1])..          
-00011ec0: 2020 6465 6620 7461 6e68 5f77 7261 7070    def tanh_wrapp
-00011ed0: 6572 2866 756e 6329 3a0a 2020 2020 2020  er(func):.      
-00011ee0: 2020 2020 2020 2020 2020 6465 6620 7369            def si
-00011ef0: 6d70 6c65 5f66 756e 6328 7831 2c20 7832  mple_func(x1, x2
-00011f00: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00011f10: 2020 2020 2020 2072 6574 7572 6e20 6e70         return np
-00011f20: 2e74 616e 6828 6675 6e63 2878 312c 2078  .tanh(func(x1, x
-00011f30: 3229 290a 0a20 2020 2020 2020 2020 2020  2))..           
-00011f40: 2020 2020 2073 696d 706c 655f 6675 6e63       simple_func
-00011f50: 2e5f 5f6e 616d 655f 5f20 3d20 6627 7461  .__name__ = f'ta
-00011f60: 6e68 5f7b 6675 6e63 2e5f 5f6e 616d 655f  nh_{func.__name_
-00011f70: 5f7d 270a 2020 2020 2020 2020 2020 2020  _}'.            
-00011f80: 2020 2020 7265 7475 726e 2073 696d 706c      return simpl
-00011f90: 655f 6675 6e63 0a0a 2020 2020 2020 2020  e_func..        
-00011fa0: 2020 2020 7073 6574 2e61 6464 5072 696d      pset.addPrim
-00011fb0: 6974 6976 6528 7461 6e68 5f77 7261 7070  itive(tanh_wrapp
-00011fc0: 6572 286e 702e 6164 6429 2c20 3229 0a20  er(np.add), 2). 
-00011fd0: 2020 2020 2020 2020 2020 2070 7365 742e             pset.
-00011fe0: 6164 6450 7269 6d69 7469 7665 2874 616e  addPrimitive(tan
-00011ff0: 685f 7772 6170 7065 7228 6e70 2e73 7562  h_wrapper(np.sub
-00012000: 7472 6163 7429 2c20 3229 0a20 2020 2020  tract), 2).     
-00012010: 2020 2020 2020 2070 7365 742e 6164 6450         pset.addP
-00012020: 7269 6d69 7469 7665 2874 616e 685f 7772  rimitive(tanh_wr
-00012030: 6170 7065 7228 6e70 2e6d 756c 7469 706c  apper(np.multipl
-00012040: 7929 2c20 3229 0a20 2020 2020 2020 2020  y), 2).         
-00012050: 2020 2070 7365 742e 6164 6450 7269 6d69     pset.addPrimi
-00012060: 7469 7665 2874 616e 685f 7772 6170 7065  tive(tanh_wrappe
-00012070: 7228 616e 616c 7974 6963 616c 5f71 756f  r(analytical_quo
-00012080: 7469 656e 7429 2c20 3229 0a20 2020 2020  tient), 2).     
-00012090: 2020 2065 6c69 6620 7365 6c66 2e62 6173     elif self.bas
-000120a0: 6963 5f70 7269 6d69 7469 7665 7320 3d3d  ic_primitives ==
-000120b0: 2027 696e 7465 7270 7265 7461 626c 6527   'interpretable'
-000120c0: 3a0a 2020 2020 2020 2020 2020 2020 7073  :.            ps
-000120d0: 6574 203d 2067 702e 5072 696d 6974 6976  et = gp.Primitiv
-000120e0: 6553 6574 2822 4d41 494e 222c 2078 2e73  eSet("MAIN", x.s
-000120f0: 6861 7065 5b31 5d29 0a20 2020 2020 2020  hape[1]).       
-00012100: 2020 2020 2070 7365 742e 6164 6450 7269       pset.addPri
-00012110: 6d69 7469 7665 286e 702e 6164 642c 2032  mitive(np.add, 2
-00012120: 290a 2020 2020 2020 2020 2020 2020 7073  ).            ps
-00012130: 6574 2e61 6464 5072 696d 6974 6976 6528  et.addPrimitive(
-00012140: 6e70 2e73 7562 7472 6163 742c 2032 290a  np.subtract, 2).
-00012150: 2020 2020 2020 2020 2020 2020 7073 6574              pset
-00012160: 2e61 6464 5072 696d 6974 6976 6528 6e70  .addPrimitive(np
-00012170: 2e6d 756c 7469 706c 792c 2032 290a 2020  .multiply, 2).  
-00012180: 2020 2020 2020 2020 2020 7073 6574 2e61            pset.a
-00012190: 6464 5072 696d 6974 6976 6528 7072 6f74  ddPrimitive(prot
-000121a0: 6563 7465 645f 6469 7669 7369 6f6e 2c20  ected_division, 
-000121b0: 3229 0a20 2020 2020 2020 2065 6c69 6620  2).        elif 
-000121c0: 6973 696e 7374 616e 6365 2873 656c 662e  isinstance(self.
-000121d0: 6261 7369 635f 7072 696d 6974 6976 6573  basic_primitives
-000121e0: 2c20 7374 7229 2061 6e64 2027 2c27 2069  , str) and ',' i
-000121f0: 6e20 7365 6c66 2e62 6173 6963 5f70 7269  n self.basic_pri
-00012200: 6d69 7469 7665 733a 0a20 2020 2020 2020  mitives:.       
-00012210: 2020 2020 2023 2061 6e20 6172 7261 7920       # an array 
-00012220: 6f66 2062 6173 6963 2070 7269 6d69 7469  of basic primiti
-00012230: 7665 730a 2020 2020 2020 2020 2020 2020  ves.            
-00012240: 7073 6574 203d 2067 702e 5072 696d 6974  pset = gp.Primit
-00012250: 6976 6553 6574 2822 4d41 494e 222c 2078  iveSet("MAIN", x
-00012260: 2e73 6861 7065 5b31 5d29 0a20 2020 2020  .shape[1]).     
-00012270: 2020 2020 2020 2073 656c 662e 6164 645f         self.add_
-00012280: 7072 696d 6974 6976 6573 5f74 6f5f 7073  primitives_to_ps
-00012290: 6574 2870 7365 7429 0a20 2020 2020 2020  et(pset).       
-000122a0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-000122b0: 2020 2070 7365 7420 3d20 5072 696d 6974     pset = Primit
-000122c0: 6976 6553 6574 2822 4d41 494e 222c 2078  iveSet("MAIN", x
-000122d0: 2e73 6861 7065 5b31 5d29 0a20 2020 2020  .shape[1]).     
-000122e0: 2020 2020 2020 2061 6464 5f62 6173 6963         add_basic
-000122f0: 5f6f 7065 7261 746f 7273 2870 7365 7429  _operators(pset)
-00012300: 0a0a 2020 2020 2020 2020 2320 6164 6420  ..        # add 
-00012310: 636f 6e73 7461 6e74 0a20 2020 2020 2020  constant.       
-00012320: 2069 6620 6861 7361 7474 7228 6770 2c20   if hasattr(gp, 
-00012330: 2772 616e 6431 3031 2729 3a0a 2020 2020  'rand101'):.    
-00012340: 2020 2020 2020 2020 6465 6c61 7474 7228          delattr(
-00012350: 6770 2c20 2772 616e 6431 3031 2729 0a20  gp, 'rand101'). 
-00012360: 2020 2020 2020 2069 6620 7365 6c66 2e63         if self.c
-00012370: 6f6e 7374 616e 745f 7479 7065 2069 7320  onstant_type is 
-00012380: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00012390: 2020 7061 7373 0a20 2020 2020 2020 2065    pass.        e
-000123a0: 6c69 6620 7365 6c66 2e62 6173 6963 5f70  lif self.basic_p
-000123b0: 7269 6d69 7469 7665 7320 3d3d 2046 616c  rimitives == Fal
-000123c0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-000123d0: 7073 6574 2e61 6464 4570 6865 6d65 7261  pset.addEphemera
-000123e0: 6c43 6f6e 7374 616e 7428 2272 616e 6431  lConstant("rand1
-000123f0: 3031 222c 206c 616d 6264 613a 2072 616e  01", lambda: ran
-00012400: 646f 6d2e 7261 6e64 696e 7428 2d31 2c20  dom.randint(-1, 
-00012410: 3129 2c20 4e75 6d65 7269 6361 6c46 6561  1), NumericalFea
-00012420: 7475 7265 290a 2020 2020 2020 2020 656c  ture).        el
-00012430: 6966 2073 656c 662e 636f 6e73 7461 6e74  if self.constant
-00012440: 5f74 7970 6520 3d3d 2027 466c 6f61 7427  _type == 'Float'
-00012450: 3a0a 2020 2020 2020 2020 2020 2020 7073  :.            ps
-00012460: 6574 2e61 6464 4570 6865 6d65 7261 6c43  et.addEphemeralC
-00012470: 6f6e 7374 616e 7428 2272 616e 6431 3031  onstant("rand101
-00012480: 222c 206c 616d 6264 613a 2072 616e 646f  ", lambda: rando
-00012490: 6d2e 756e 6966 6f72 6d28 2d31 2c20 3129  m.uniform(-1, 1)
-000124a0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-000124b0: 2020 2020 2020 2020 2020 2020 7073 6574              pset
-000124c0: 2e61 6464 4570 6865 6d65 7261 6c43 6f6e  .addEphemeralCon
-000124d0: 7374 616e 7428 2272 616e 6431 3031 222c  stant("rand101",
-000124e0: 206c 616d 6264 613a 2072 616e 646f 6d2e   lambda: random.
-000124f0: 7261 6e64 696e 7428 2d31 2c20 3129 290a  randint(-1, 1)).
-00012500: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-00012510: 7374 616e 6365 2870 7365 742c 2050 7269  stance(pset, Pri
-00012520: 6d69 7469 7665 5365 7429 2061 6e64 2073  mitiveSet) and s
-00012530: 656c 662e 6c67 705f 6d6f 6465 2069 7320  elf.lgp_mode is 
-00012540: 5472 7565 3a0a 2020 2020 2020 2020 2020  True:.          
-00012550: 2020 2320 e5b0 9de8 af95 e999 90e5 88b6    # ............
-00012560: e58f aae8 83bd e4bd bfe7 94a8 e983 a8e5  ................
-00012570: 8886 e7bb 93e6 9e9c 0a20 2020 2020 2020  .........       
-00012580: 2020 2020 206e 6577 5f70 7365 7420 3d20       new_pset = 
-00012590: 4d75 6c74 6970 6c65 5072 696d 6974 6976  MultiplePrimitiv
-000125a0: 6553 6574 2822 4d41 494e 222c 2073 656c  eSet("MAIN", sel
-000125b0: 662e 582e 7368 6170 655b 315d 290a 2020  f.X.shape[1]).  
-000125c0: 2020 2020 2020 2020 2020 666f 7220 7820            for x 
-000125d0: 696e 2072 616e 6765 2873 656c 662e 6765  in range(self.ge
-000125e0: 6e65 5f6e 756d 293a 0a20 2020 2020 2020  ne_num):.       
-000125f0: 2020 2020 2020 2020 2062 6173 655f 636f           base_co
-00012600: 756e 7420 3d20 7365 6c66 2e58 2e73 6861  unt = self.X.sha
-00012610: 7065 5b31 5d0a 2020 2020 2020 2020 2020  pe[1].          
-00012620: 2020 2020 2020 6261 7365 5f70 7365 7420        base_pset 
-00012630: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
-00012640: 7073 6574 290a 2020 2020 2020 2020 2020  pset).          
-00012650: 2020 2020 2020 6966 2078 203e 3d20 7365        if x >= se
-00012660: 6c66 2e6c 6770 5f73 636f 7065 2061 6e64  lf.lgp_scope and
-00012670: 2073 656c 662e 7374 7269 6374 5f6c 6179   self.strict_lay
-00012680: 6572 5f6c 6770 3a0a 2020 2020 2020 2020  er_lgp:.        
-00012690: 2020 2020 2020 2020 2020 2020 6261 7365              base
-000126a0: 5f70 7365 742e 7465 726d 696e 616c 735b  _pset.terminals[
-000126b0: 6f62 6a65 6374 5d20 3d20 5b5d 0a20 2020  object] = [].   
-000126c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000126d0: 2062 6173 655f 7073 6574 2e61 7267 756d   base_pset.argum
-000126e0: 656e 7473 203d 205b 5d0a 2020 2020 2020  ents = [].      
-000126f0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00012700: 662e 6c67 705f 7363 6f70 6520 6973 206e  f.lgp_scope is n
-00012710: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-00012720: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00012730: 7365 6c66 2e6c 6179 6572 5f6c 6770 3a0a  self.layer_lgp:.
-00012740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012750: 2020 2020 2020 2020 2320 7374 7269 6374          # strict
-00012760: 206c 6179 6572 0a20 2020 2020 2020 2020   layer.         
-00012770: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00012780: 7461 7274 5f62 6173 6520 3d20 6d61 7828  tart_base = max(
-00012790: 6261 7365 5f63 6f75 6e74 202b 2028 2878  base_count + ((x
-000127a0: 202f 2f20 7365 6c66 2e6c 6770 5f73 636f   // self.lgp_sco
-000127b0: 7065 2920 2d20 3129 202a 2073 656c 662e  pe) - 1) * self.
-000127c0: 6c67 705f 7363 6f70 652c 2062 6173 655f  lgp_scope, base_
-000127d0: 636f 756e 7429 0a20 2020 2020 2020 2020  count).         
-000127e0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000127f0: 6e64 5f62 6173 6520 3d20 6d61 7828 6261  nd_base = max(ba
-00012800: 7365 5f63 6f75 6e74 202b 2028 7820 2f2f  se_count + (x //
-00012810: 2073 656c 662e 6c67 705f 7363 6f70 6529   self.lgp_scope)
-00012820: 202a 2073 656c 662e 6c67 705f 7363 6f70   * self.lgp_scop
-00012830: 652c 2062 6173 655f 636f 756e 7429 0a20  e, base_count). 
-00012840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012850: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00012860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012870: 2023 206e 6f20 636c 6561 7220 626f 756e   # no clear boun
-00012880: 6461 7279 2062 6574 7765 656e 2065 6163  dary between eac
-00012890: 6820 6c61 7965 720a 2020 2020 2020 2020  h layer.        
-000128a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000128b0: 7374 6172 745f 6261 7365 203d 206d 6178  start_base = max
-000128c0: 2862 6173 655f 636f 756e 7420 2b20 7820  (base_count + x 
-000128d0: 2d20 7365 6c66 2e6c 6770 5f73 636f 7065  - self.lgp_scope
-000128e0: 2c20 6261 7365 5f63 6f75 6e74 290a 2020  , base_count).  
-000128f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012900: 2020 2020 2020 656e 645f 6261 7365 203d        end_base =
-00012910: 2062 6173 655f 636f 756e 7420 2b20 780a   base_count + x.
-00012920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012930: 2020 2020 6173 7365 7274 2073 7461 7274      assert start
-00012940: 5f62 6173 6520 3e3d 2073 656c 662e 582e  _base >= self.X.
-00012950: 7368 6170 655b 315d 0a20 2020 2020 2020  shape[1].       
-00012960: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00012970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012980: 2020 2073 7461 7274 5f62 6173 6520 3d20     start_base = 
-00012990: 6261 7365 5f63 6f75 6e74 0a20 2020 2020  base_count.     
-000129a0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000129b0: 6e64 5f62 6173 6520 3d20 6261 7365 5f63  nd_base = base_c
-000129c0: 6f75 6e74 202b 2078 0a20 2020 2020 2020  ount + x.       
-000129d0: 2020 2020 2020 2020 2066 6f72 2069 2069           for i i
-000129e0: 6e20 7261 6e67 6528 7374 6172 745f 6261  n range(start_ba
-000129f0: 7365 2c20 656e 645f 6261 7365 293a 0a20  se, end_base):. 
-00012a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012a10: 2020 2062 6173 655f 7073 6574 2e61 6464     base_pset.add
-00012a20: 5465 726d 696e 616c 2866 2741 5247 7b69  Terminal(f'ARG{i
-00012a30: 7d27 2c20 6627 4152 477b 697d 2729 0a20  }', f'ARG{i}'). 
-00012a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012a50: 2020 2062 6173 655f 7073 6574 2e61 7267     base_pset.arg
-00012a60: 756d 656e 7473 2e61 7070 656e 6428 6627  uments.append(f'
-00012a70: 4152 477b 697d 2729 0a20 2020 2020 2020  ARG{i}').       
-00012a80: 2020 2020 2020 2020 206e 6577 5f70 7365           new_pse
-00012a90: 742e 7073 6574 5f6c 6973 742e 6170 7065  t.pset_list.appe
-00012aa0: 6e64 2862 6173 655f 7073 6574 290a 2020  nd(base_pset).  
-00012ab0: 2020 2020 2020 2020 2020 7073 6574 203d            pset =
-00012ac0: 206e 6577 5f70 7365 740a 2020 2020 2020   new_pset.      
-00012ad0: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
-00012ae0: 6528 7073 6574 2c20 5072 696d 6974 6976  e(pset, Primitiv
-00012af0: 6553 6574 2920 616e 6420 7365 6c66 2e6c  eSet) and self.l
-00012b00: 6770 5f6d 6f64 6520 3d3d 2027 5265 6769  gp_mode == 'Regi
-00012b10: 7374 6572 273a 0a20 2020 2020 2020 2020  ster':.         
-00012b20: 2020 2070 7365 742e 6e75 6d62 6572 5f6f     pset.number_o
-00012b30: 665f 7265 6769 7374 6572 203d 2073 656c  f_register = sel
-00012b40: 662e 6e75 6d62 6572 5f6f 665f 7265 6769  f.number_of_regi
-00012b50: 7374 6572 0a20 2020 2020 2020 2020 2020  ster.           
-00012b60: 2023 2049 6e70 7574 2072 6567 6973 7465   # Input registe
-00012b70: 7220 6973 2065 6173 7920 746f 2069 6d70  r is easy to imp
-00012b80: 6c65 6d65 6e74 0a20 2020 2020 2020 2020  lement.         
-00012b90: 2020 2062 6173 655f 636f 756e 7420 3d20     base_count = 
-00012ba0: 7365 6c66 2e58 2e73 6861 7065 5b31 5d0a  self.X.shape[1].
-00012bb0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00012bc0: 6920 696e 2072 616e 6765 2862 6173 655f  i in range(base_
-00012bd0: 636f 756e 742c 2062 6173 655f 636f 756e  count, base_coun
-00012be0: 7420 2b20 7365 6c66 2e6e 756d 6265 725f  t + self.number_
-00012bf0: 6f66 5f72 6567 6973 7465 7229 3a0a 2020  of_register):.  
-00012c00: 2020 2020 2020 2020 2020 2020 2020 7073                ps
-00012c10: 6574 2e61 6464 5465 726d 696e 616c 2866  et.addTerminal(f
-00012c20: 2741 5247 7b69 7d27 2c20 6627 4152 477b  'ARG{i}', f'ARG{
-00012c30: 697d 2729 0a20 2020 2020 2020 2020 2020  i}').           
-00012c40: 2020 2020 2070 7365 742e 6172 6775 6d65       pset.argume
-00012c50: 6e74 732e 6170 7065 6e64 2866 2741 5247  nts.append(f'ARG
-00012c60: 7b69 7d27 290a 2020 2020 2020 2020 7365  {i}').        se
-00012c70: 6c66 2e70 7365 7420 3d20 7073 6574 0a20  lf.pset = pset. 
-00012c80: 2020 2020 2020 2072 6574 7572 6e20 7073         return ps
-00012c90: 6574 0a0a 2020 2020 6465 6620 6164 645f  et..    def add_
-00012ca0: 7072 696d 6974 6976 6573 5f74 6f5f 7073  primitives_to_ps
-00012cb0: 6574 2873 656c 662c 2070 7365 742c 2070  et(self, pset, p
-00012cc0: 7269 6d69 7469 7665 733d 4e6f 6e65 2c20  rimitives=None, 
-00012cd0: 7472 616e 7366 6f72 6d65 725f 7772 6170  transformer_wrap
-00012ce0: 7065 723d 4661 6c73 6529 3a0a 2020 2020  per=False):.    
-00012cf0: 2020 2020 6966 2070 7269 6d69 7469 7665      if primitive
-00012d00: 7320 6973 204e 6f6e 653a 0a20 2020 2020  s is None:.     
-00012d10: 2020 2020 2020 2070 7269 6d69 7469 7665         primitive
-00012d20: 7320 3d20 7365 6c66 2e62 6173 6963 5f70  s = self.basic_p
-00012d30: 7269 6d69 7469 7665 730a 2020 2020 2020  rimitives.      
-00012d40: 2020 666f 7220 7020 696e 2070 7269 6d69    for p in primi
-00012d50: 7469 7665 732e 7370 6c69 7428 272c 2729  tives.split(',')
-00012d60: 3a0a 2020 2020 2020 2020 2020 2020 7020  :.            p 
-00012d70: 3d20 702e 7374 7269 7028 290a 2020 2020  = p.strip().    
-00012d80: 2020 2020 2020 2020 7072 696d 6974 6976          primitiv
-00012d90: 6520 3d20 7b0a 2020 2020 2020 2020 2020  e = {.          
-00012da0: 2020 2020 2020 2761 6464 273a 2028 6e70        'add': (np
-00012db0: 2e61 6464 2c20 3229 2c0a 2020 2020 2020  .add, 2),.      
-00012dc0: 2020 2020 2020 2020 2020 2773 7562 7472            'subtr
-00012dd0: 6163 7427 3a20 286e 702e 7375 6274 7261  act': (np.subtra
-00012de0: 6374 2c20 3229 2c0a 2020 2020 2020 2020  ct, 2),.        
-00012df0: 2020 2020 2020 2020 276d 756c 7469 706c          'multipl
-00012e00: 7927 3a20 286e 702e 6d75 6c74 6970 6c79  y': (np.multiply
-00012e10: 2c20 3229 2c0a 2020 2020 2020 2020 2020  , 2),.          
-00012e20: 2020 2020 2020 2761 6e61 6c79 7469 6361        'analytica
-00012e30: 6c5f 7175 6f74 6965 6e74 273a 2028 616e  l_quotient': (an
-00012e40: 616c 7974 6963 616c 5f71 756f 7469 656e  alytical_quotien
-00012e50: 742c 2032 292c 0a20 2020 2020 2020 2020  t, 2),.         
-00012e60: 2020 2020 2020 2027 7072 6f74 6563 745f         'protect_
-00012e70: 7371 7274 273a 2028 7072 6f74 6563 745f  sqrt': (protect_
-00012e80: 7371 7274 2c20 3129 2c0a 2020 2020 2020  sqrt, 1),.      
-00012e90: 2020 2020 2020 2020 2020 2761 6e61 6c79            'analy
-00012ea0: 7469 6361 6c5f 6c6f 6765 273a 2028 616e  tical_loge': (an
-00012eb0: 616c 7974 6963 616c 5f6c 6f67 652c 2031  alytical_loge, 1
-00012ec0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00012ed0: 2020 2027 7369 6e27 3a20 286e 702e 7369     'sin': (np.si
-00012ee0: 6e2c 2031 292c 0a20 2020 2020 2020 2020  n, 1),.         
-00012ef0: 2020 2020 2020 2027 636f 7327 3a20 286e         'cos': (n
-00012f00: 702e 636f 732c 2031 292c 0a20 2020 2020  p.cos, 1),.     
-00012f10: 2020 2020 2020 2020 2020 2027 6d61 7869             'maxi
-00012f20: 6d75 6d27 3a20 286e 702e 6d61 7869 6d75  mum': (np.maximu
-00012f30: 6d2c 2032 292c 0a20 2020 2020 2020 2020  m, 2),.         
-00012f40: 2020 2020 2020 2027 6d69 6e69 6d75 6d27         'minimum'
-00012f50: 3a20 286e 702e 6d69 6e69 6d75 6d2c 2032  : (np.minimum, 2
-00012f60: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00012f70: 2020 2027 6d65 616e 273a 2028 6e70 5f6d     'mean': (np_m
-00012f80: 6561 6e2c 2032 292c 0a20 2020 2020 2020  ean, 2),.       
-00012f90: 2020 2020 2020 2020 2027 6172 6374 616e           'arctan
-00012fa0: 273a 2028 6e70 2e61 7263 7461 6e2c 2031  ': (np.arctan, 1
-00012fb0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00012fc0: 2020 2027 7461 6e68 273a 2028 6e70 2e74     'tanh': (np.t
-00012fd0: 616e 682c 2031 292c 0a20 2020 2020 2020  anh, 1),.       
-00012fe0: 2020 2020 2020 2020 2027 6362 7274 273a           'cbrt':
-00012ff0: 2028 6e70 2e63 6272 742c 2031 292c 0a20   (np.cbrt, 1),. 
-00013000: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00013010: 7371 7561 7265 273a 2028 6e70 2e73 7175  square': (np.squ
-00013020: 6172 652c 2031 292c 0a20 2020 2020 2020  are, 1),.       
-00013030: 2020 2020 2020 2020 2027 6e65 6761 7469           'negati
-00013040: 7665 273a 2028 6e70 2e6e 6567 6174 6976  ve': (np.negativ
-00013050: 652c 2031 292c 0a20 2020 2020 2020 2020  e, 1),.         
-00013060: 2020 2020 2020 2027 7369 676d 6f69 6427         'sigmoid'
-00013070: 3a20 2873 6967 6d6f 6964 2c20 3129 2c0a  : (sigmoid, 1),.
-00013080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013090: 276c 6561 6b79 5f72 656c 7527 3a20 286c  'leaky_relu': (l
-000130a0: 6561 6b79 5f72 656c 752c 2031 292c 0a20  eaky_relu, 1),. 
-000130b0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-000130c0: 6772 6561 7465 725f 6f72 5f65 7175 616c  greater_or_equal
-000130d0: 5f74 6861 6e27 3a20 2867 7265 6174 6572  _than': (greater
-000130e0: 5f6f 725f 6571 7561 6c5f 7468 616e 2c20  _or_equal_than, 
-000130f0: 3229 2c0a 2020 2020 2020 2020 2020 2020  2),.            
-00013100: 2020 2020 276c 6573 735f 6f72 5f65 7175      'less_or_equ
-00013110: 616c 5f74 6861 6e27 3a20 286c 6573 735f  al_than': (less_
-00013120: 6f72 5f65 7175 616c 5f74 6861 6e2c 2032  or_equal_than, 2
-00013130: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00013140: 2020 2027 6772 6561 7465 725f 6f72 5f65     'greater_or_e
-00013150: 7175 616c 5f74 6861 6e5f 7175 6164 7275  qual_than_quadru
-00013160: 706c 655f 6127 3a20 2867 7265 6174 6572  ple_a': (greater
-00013170: 5f6f 725f 6571 7561 6c5f 7468 616e 5f71  _or_equal_than_q
-00013180: 7561 6472 7570 6c65 5f61 2c20 3429 2c0a  uadruple_a, 4),.
-00013190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000131a0: 2767 7265 6174 6572 5f6f 725f 6571 7561  'greater_or_equa
-000131b0: 6c5f 7468 616e 5f71 7561 6472 7570 6c65  l_than_quadruple
-000131c0: 5f62 273a 2028 6772 6561 7465 725f 6f72  _b': (greater_or
-000131d0: 5f65 7175 616c 5f74 6861 6e5f 7175 6164  _equal_than_quad
-000131e0: 7275 706c 655f 622c 2034 292c 0a20 2020  ruple_b, 4),.   
-000131f0: 2020 2020 2020 2020 2020 2020 2027 6772               'gr
-00013200: 6561 7465 725f 6f72 5f65 7175 616c 5f74  eater_or_equal_t
-00013210: 6861 6e5f 7175 6164 7275 706c 655f 6327  han_quadruple_c'
-00013220: 3a20 2867 7265 6174 6572 5f6f 725f 6571  : (greater_or_eq
-00013230: 7561 6c5f 7468 616e 5f71 7561 6472 7570  ual_than_quadrup
-00013240: 6c65 5f63 2c20 3429 2c0a 2020 2020 2020  le_c, 4),.      
-00013250: 2020 2020 2020 2020 2020 276c 6573 735f            'less_
-00013260: 7468 616e 5f71 7561 6472 7570 6c65 5f61  than_quadruple_a
-00013270: 273a 2028 6c65 7373 5f74 6861 6e5f 7175  ': (less_than_qu
-00013280: 6164 7275 706c 655f 612c 2034 292c 0a20  adruple_a, 4),. 
-00013290: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-000132a0: 6c65 7373 5f74 6861 6e5f 7175 6164 7275  less_than_quadru
-000132b0: 706c 655f 6227 3a20 286c 6573 735f 7468  ple_b': (less_th
-000132c0: 616e 5f71 7561 6472 7570 6c65 5f62 2c20  an_quadruple_b, 
-000132d0: 3429 2c0a 2020 2020 2020 2020 2020 2020  4),.            
-000132e0: 2020 2020 276c 6573 735f 7468 616e 5f71      'less_than_q
-000132f0: 7561 6472 7570 6c65 5f63 273a 2028 6c65  uadruple_c': (le
-00013300: 7373 5f74 6861 6e5f 7175 6164 7275 706c  ss_than_quadrupl
-00013310: 655f 632c 2034 292c 0a20 2020 2020 2020  e_c, 4),.       
-00013320: 2020 2020 2020 2020 2027 6772 6561 7465           'greate
-00013330: 725f 6f72 5f65 7175 616c 5f74 6861 6e5f  r_or_equal_than_
-00013340: 646f 7562 6c65 5f61 273a 2028 6772 6561  double_a': (grea
-00013350: 7465 725f 6f72 5f65 7175 616c 5f74 6861  ter_or_equal_tha
-00013360: 6e5f 646f 7562 6c65 5f61 2c20 3229 2c0a  n_double_a, 2),.
-00013370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013380: 2767 7265 6174 6572 5f6f 725f 6571 7561  'greater_or_equa
-00013390: 6c5f 7468 616e 5f64 6f75 626c 655f 6227  l_than_double_b'
-000133a0: 3a20 2867 7265 6174 6572 5f6f 725f 6571  : (greater_or_eq
-000133b0: 7561 6c5f 7468 616e 5f64 6f75 626c 655f  ual_than_double_
-000133c0: 622c 2032 292c 0a20 2020 2020 2020 2020  b, 2),.         
-000133d0: 2020 2020 2020 2027 6772 6561 7465 725f         'greater_
-000133e0: 6f72 5f65 7175 616c 5f74 6861 6e5f 646f  or_equal_than_do
-000133f0: 7562 6c65 5f63 273a 2028 6772 6561 7465  uble_c': (greate
-00013400: 725f 6f72 5f65 7175 616c 5f74 6861 6e5f  r_or_equal_than_
-00013410: 646f 7562 6c65 5f63 2c20 3229 2c0a 2020  double_c, 2),.  
-00013420: 2020 2020 2020 2020 2020 2020 2020 276c                'l
-00013430: 6573 735f 7468 616e 5f64 6f75 626c 655f  ess_than_double_
-00013440: 6127 3a20 286c 6573 735f 7468 616e 5f64  a': (less_than_d
-00013450: 6f75 626c 655f 612c 2032 292c 0a20 2020  ouble_a, 2),.   
-00013460: 2020 2020 2020 2020 2020 2020 2027 6c65               'le
-00013470: 7373 5f74 6861 6e5f 646f 7562 6c65 5f62  ss_than_double_b
-00013480: 273a 2028 6c65 7373 5f74 6861 6e5f 646f  ': (less_than_do
-00013490: 7562 6c65 5f62 2c20 3229 2c0a 2020 2020  uble_b, 2),.    
-000134a0: 2020 2020 2020 2020 2020 2020 276c 6573              'les
-000134b0: 735f 7468 616e 5f64 6f75 626c 655f 6327  s_than_double_c'
-000134c0: 3a20 286c 6573 735f 7468 616e 5f64 6f75  : (less_than_dou
-000134d0: 626c 655f 632c 2032 292c 0a20 2020 2020  ble_c, 2),.     
-000134e0: 2020 2020 2020 2020 2020 2027 7072 6f74             'prot
-000134f0: 6563 7465 645f 6469 7669 7369 6f6e 273a  ected_division':
-00013500: 2028 7072 6f74 6563 7465 645f 6469 7669   (protected_divi
-00013510: 7369 6f6e 2c20 3229 2c0a 2020 2020 2020  sion, 2),.      
-00013520: 2020 2020 2020 7d5b 705d 0a20 2020 2020        }[p].     
-00013530: 2020 2020 2020 206e 616d 6520 3d20 7b0a         name = {.
-00013540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013550: 2761 6e61 6c79 7469 6361 6c5f 7175 6f74  'analytical_quot
-00013560: 6965 6e74 273a 2027 4151 272c 0a20 2020  ient': 'AQ',.   
-00013570: 2020 2020 2020 2020 2020 2020 2027 616e               'an
-00013580: 616c 7974 6963 616c 5f6c 6f67 6527 3a20  alytical_loge': 
-00013590: 274c 6f67 272c 0a20 2020 2020 2020 2020  'Log',.         
-000135a0: 2020 2020 2020 2027 6d75 6c74 6970 6c79         'multiply
-000135b0: 273a 2027 4d75 6c27 2c0a 2020 2020 2020  ': 'Mul',.      
-000135c0: 2020 2020 2020 2020 2020 2761 6464 273a            'add':
-000135d0: 2027 4164 6427 2c0a 2020 2020 2020 2020   'Add',.        
-000135e0: 2020 2020 2020 2020 2773 7562 7472 6163          'subtrac
-000135f0: 7427 3a20 2753 7562 272c 0a20 2020 2020  t': 'Sub',.     
-00013600: 2020 2020 2020 2020 2020 2027 7072 6f74             'prot
-00013610: 6563 745f 7371 7274 273a 2027 5371 7274  ect_sqrt': 'Sqrt
-00013620: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-00013630: 2020 2027 6d69 6e69 6d75 6d27 3a20 224d     'minimum': "M
-00013640: 696e 222c 0a20 2020 2020 2020 2020 2020  in",.           
-00013650: 2020 2020 2027 6d61 7869 6d75 6d27 3a20       'maximum': 
-00013660: 224d 6178 222c 0a20 2020 2020 2020 2020  "Max",.         
-00013670: 2020 2020 2020 2027 7369 6e27 3a20 2253         'sin': "S
-00013680: 696e 222c 0a20 2020 2020 2020 2020 2020  in",.           
-00013690: 2020 2020 2027 636f 7327 3a20 2243 6f73       'cos': "Cos
-000136a0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-000136b0: 2020 2027 6e65 6761 7469 7665 273a 2022     'negative': "
-000136c0: 4e65 6722 2c0a 2020 2020 2020 2020 2020  Neg",.          
-000136d0: 2020 7d2e 6765 7428 7029 0a20 2020 2020    }.get(p).     
-000136e0: 2020 2020 2020 2069 6620 7472 616e 7366         if transf
-000136f0: 6f72 6d65 725f 7772 6170 7065 723a 0a20  ormer_wrapper:. 
-00013700: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00013710: 7365 742e 6164 6450 7269 6d69 7469 7665  set.addPrimitive
-00013720: 286d 616b 655f 636c 6173 7328 7072 696d  (make_class(prim
-00013730: 6974 6976 655b 305d 292c 2070 7269 6d69  itive[0]), primi
-00013740: 7469 7665 5b31 5d2c 206e 616d 653d 6e61  tive[1], name=na
-00013750: 6d65 290a 2020 2020 2020 2020 2020 2020  me).            
-00013760: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00013770: 2020 2020 2020 7073 6574 2e61 6464 5072        pset.addPr
-00013780: 696d 6974 6976 6528 7072 696d 6974 6976  imitive(primitiv
-00013790: 655b 305d 2c20 7072 696d 6974 6976 655b  e[0], primitive[
-000137a0: 315d 2c20 6e61 6d65 3d6e 616d 6529 0a0a  1], name=name)..
-000137b0: 2020 2020 6465 6620 6172 6368 6976 655f      def archive_
-000137c0: 696e 6974 6961 6c69 7a61 7469 6f6e 2873  initialization(s
-000137d0: 656c 6629 3a0a 2020 2020 2020 2020 2320  elf):.        # 
-000137e0: 6172 6368 6976 6520 696e 6974 6961 6c69  archive initiali
-000137f0: 7a61 7469 6f6e 0a20 2020 2020 2020 2069  zation.        i
-00013800: 6620 7365 6c66 2e65 6e73 656d 626c 655f  f self.ensemble_
-00013810: 7369 7a65 203d 3d20 2761 7574 6f27 3a0a  size == 'auto':.
-00013820: 2020 2020 2020 2020 2020 2020 2320 4175              # Au
-00013830: 746f 6d61 7469 6361 6c6c 7920 6465 7465  tomatically dete
-00013840: 726d 696e 6520 7468 6520 656e 7365 6d62  rmine the ensemb
-00013850: 6c65 2073 697a 650a 2020 2020 2020 2020  le size.        
-00013860: 2020 2020 7365 6c66 2e68 6f66 203d 204c      self.hof = L
-00013870: 6578 6963 6173 6548 4f46 2829 0a20 2020  exicaseHOF().   
-00013880: 2020 2020 2065 6c69 6620 7365 6c66 2e65       elif self.e
-00013890: 6e73 656d 626c 655f 7365 6c65 6374 696f  nsemble_selectio
-000138a0: 6e20 3d3d 2027 5374 7269 6374 6c79 496d  n == 'StrictlyIm
-000138b0: 7072 6f76 656d 656e 7427 3a0a 2020 2020  provement':.    
-000138c0: 2020 2020 2020 2020 7365 6c66 2e68 6f66          self.hof
-000138d0: 203d 2053 7472 6963 746c 7949 6d70 726f   = StrictlyImpro
-000138e0: 7665 6d65 6e74 484f 4628 7365 6c66 2e65  vementHOF(self.e
-000138f0: 6e73 656d 626c 655f 7369 7a65 290a 2020  nsemble_size).  
-00013900: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
-00013910: 656e 7365 6d62 6c65 5f73 656c 6563 7469  ensemble_selecti
-00013920: 6f6e 203d 3d20 2747 656e 6572 616c 697a  on == 'Generaliz
-00013930: 6174 696f 6e48 4f46 273a 0a20 2020 2020  ationHOF':.     
-00013940: 2020 2020 2020 2061 7373 6572 7420 7365         assert se
-00013950: 6c66 2e65 6e73 656d 626c 655f 7369 7a65  lf.ensemble_size
-00013960: 203d 3d20 310a 2020 2020 2020 2020 2020   == 1.          
-00013970: 2020 7365 6c66 2e68 6f66 203d 2047 656e    self.hof = Gen
-00013980: 6572 616c 697a 6174 696f 6e48 4f46 2873  eralizationHOF(s
-00013990: 656c 662e 582c 2073 656c 662e 792c 2073  elf.X, self.y, s
-000139a0: 656c 662e 7073 6574 2c20 7665 7262 6f73  elf.pset, verbos
-000139b0: 653d 7365 6c66 2e76 6572 626f 7365 290a  e=self.verbose).
-000139c0: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
-000139d0: 6e73 7461 6e63 6528 7365 6c66 2e65 6e73  nstance(self.ens
-000139e0: 656d 626c 655f 7365 6c65 6374 696f 6e2c  emble_selection,
-000139f0: 2073 7472 2920 616e 6420 2753 696d 696c   str) and 'Simil
-00013a00: 6172 2720 696e 2073 656c 662e 656e 7365  ar' in self.ense
-00013a10: 6d62 6c65 5f73 656c 6563 7469 6f6e 3a0a  mble_selection:.
-00013a20: 2020 2020 2020 2020 2020 2020 7261 7469              rati
-00013a30: 6f20 3d20 302e 3935 0a20 2020 2020 2020  o = 0.95.       
-00013a40: 2020 2020 2069 6620 272d 2720 696e 2073       if '-' in s
-00013a50: 656c 662e 656e 7365 6d62 6c65 5f73 656c  elf.ensemble_sel
-00013a60: 6563 7469 6f6e 3a0a 2020 2020 2020 2020  ection:.        
-00013a70: 2020 2020 2020 2020 7261 7469 6f20 3d20          ratio = 
-00013a80: 666c 6f61 7428 7365 6c66 2e65 6e73 656d  float(self.ensem
-00013a90: 626c 655f 7365 6c65 6374 696f 6e2e 7370  ble_selection.sp
-00013aa0: 6c69 7428 272d 2729 5b31 5d29 0a0a 2020  lit('-')[1])..  
-00013ab0: 2020 2020 2020 2020 2020 6465 6620 7369            def si
-00013ac0: 6d69 6c61 7228 612c 2062 293a 0a20 2020  milar(a, b):.   
-00013ad0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-00013ae0: 7572 6e20 6e70 2e64 6f74 2861 2e70 7265  urn np.dot(a.pre
-00013af0: 6469 6374 6564 5f76 616c 7565 732c 2062  dicted_values, b
-00013b00: 2e70 7265 6469 6374 6564 5f76 616c 7565  .predicted_value
-00013b10: 7329 202f 205c 0a20 2020 2020 2020 2020  s) / \.         
-00013b20: 2020 2020 2020 2020 2020 2020 2020 286e                (n
-00013b30: 6f72 6d28 612e 7072 6564 6963 7465 645f  orm(a.predicted_
-00013b40: 7661 6c75 6573 2920 2a20 6e6f 726d 2862  values) * norm(b
-00013b50: 2e70 7265 6469 6374 6564 5f76 616c 7565  .predicted_value
-00013b60: 7329 2920 3e20 7261 7469 6f0a 0a20 2020  s)) > ratio..   
-00013b70: 2020 2020 2020 2020 2073 656c 662e 686f           self.ho
-00013b80: 6620 3d20 4861 6c6c 4f66 4661 6d65 2873  f = HallOfFame(s
-00013b90: 656c 662e 656e 7365 6d62 6c65 5f73 697a  elf.ensemble_siz
-00013ba0: 652c 2073 696d 696c 6172 3d73 696d 696c  e, similar=simil
-00013bb0: 6172 290a 2020 2020 2020 2020 656c 6966  ar).        elif
-00013bc0: 2073 656c 662e 656e 7365 6d62 6c65 5f73   self.ensemble_s
-00013bd0: 656c 6563 7469 6f6e 203d 3d20 2745 7175  election == 'Equ
-00013be0: 616c 273a 0a20 2020 2020 2020 2020 2020  al':.           
-00013bf0: 2064 6566 2073 696d 696c 6172 2861 2c20   def similar(a, 
-00013c00: 6229 3a0a 2020 2020 2020 2020 2020 2020  b):.            
-00013c10: 2020 2020 7265 7475 726e 206e 702e 616c      return np.al
-00013c20: 6c28 6e70 2e65 7175 616c 2861 2e70 7265  l(np.equal(a.pre
-00013c30: 6469 6374 6564 5f76 616c 7565 732c 2062  dicted_values, b
-00013c40: 2e70 7265 6469 6374 6564 5f76 616c 7565  .predicted_value
-00013c50: 7329 290a 0a20 2020 2020 2020 2020 2020  s))..           
-00013c60: 2073 656c 662e 686f 6620 3d20 4861 6c6c   self.hof = Hall
-00013c70: 4f66 4661 6d65 2873 656c 662e 656e 7365  OfFame(self.ense
-00013c80: 6d62 6c65 5f73 697a 652c 2073 696d 696c  mble_size, simil
-00013c90: 6172 3d73 696d 696c 6172 290a 2020 2020  ar=similar).    
-00013ca0: 2020 2020 656c 6966 2073 656c 662e 656e      elif self.en
-00013cb0: 7365 6d62 6c65 5f73 656c 6563 7469 6f6e  semble_selection
-00013cc0: 203d 3d20 2742 6f6f 7473 7472 6170 273a   == 'Bootstrap':
-00013cd0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00013ce0: 662e 686f 6620 3d20 426f 6f74 7374 7261  f.hof = Bootstra
-00013cf0: 7048 616c 6c4f 6646 616d 6528 7365 6c66  pHallOfFame(self
-00013d00: 2e58 2c20 7365 6c66 2e65 6e73 656d 626c  .X, self.ensembl
-00013d10: 655f 7369 7a65 290a 2020 2020 2020 2020  e_size).        
-00013d20: 656c 6966 2073 656c 662e 656e 7365 6d62  elif self.ensemb
-00013d30: 6c65 5f73 656c 6563 7469 6f6e 203d 3d20  le_selection == 
-00013d40: 274f 4f42 273a 0a20 2020 2020 2020 2020  'OOB':.         
-00013d50: 2020 2073 656c 662e 686f 6620 3d20 4f4f     self.hof = OO
-00013d60: 4248 616c 6c4f 6646 616d 6528 7365 6c66  BHallOfFame(self
-00013d70: 2e58 2c20 7365 6c66 2e79 2c20 7365 6c66  .X, self.y, self
-00013d80: 2e74 6f6f 6c62 6f78 2c20 7365 6c66 2e65  .toolbox, self.e
-00013d90: 6e73 656d 626c 655f 7369 7a65 290a 2020  nsemble_size).  
-00013da0: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
-00013db0: 656e 7365 6d62 6c65 5f73 656c 6563 7469  ensemble_selecti
-00013dc0: 6f6e 203d 3d20 2747 7265 6564 7953 656c  on == 'GreedySel
-00013dd0: 6563 7469 6f6e 273a 0a20 2020 2020 2020  ection':.       
-00013de0: 2020 2020 2073 656c 662e 686f 6620 3d20       self.hof = 
-00013df0: 4772 6565 6479 5365 6c65 6374 696f 6e48  GreedySelectionH
-00013e00: 616c 6c4f 6646 616d 6528 7365 6c66 2e65  allOfFame(self.e
-00013e10: 6e73 656d 626c 655f 7369 7a65 2c20 7365  nsemble_size, se
-00013e20: 6c66 2e79 290a 2020 2020 2020 2020 2020  lf.y).          
-00013e30: 2020 7365 6c66 2e68 6f66 2e6e 6f76 656c    self.hof.novel
-00013e40: 7479 5f77 6569 6768 7420 3d20 7365 6c66  ty_weight = self
-00013e50: 2e6e 6f76 656c 7479 5f77 6569 6768 740a  .novelty_weight.
-00013e60: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
-00013e70: 662e 656e 7365 6d62 6c65 5f73 656c 6563  f.ensemble_selec
-00013e80: 7469 6f6e 203d 3d20 2747 7265 6564 7953  tion == 'GreedyS
-00013e90: 656c 6563 7469 6f6e 2d52 6573 616d 706c  election-Resampl
-00013ea0: 696e 6727 3a0a 2020 2020 2020 2020 2020  ing':.          
-00013eb0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00013ec0: 7365 6c66 2c20 436c 6173 7369 6669 6572  self, Classifier
-00013ed0: 4d69 7869 6e29 3a0a 2020 2020 2020 2020  Mixin):.        
-00013ee0: 2020 2020 2020 2020 7365 6c66 2e68 6f66          self.hof
-00013ef0: 203d 2047 7265 6564 7953 656c 6563 7469   = GreedySelecti
-00013f00: 6f6e 4861 6c6c 4f66 4661 6d65 2873 656c  onHallOfFame(sel
-00013f10: 662e 656e 7365 6d62 6c65 5f73 697a 652c  f.ensemble_size,
-00013f20: 2073 656c 662e 792c 0a20 2020 2020 2020   self.y,.       
-00013f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013f50: 2020 2020 2020 2020 2020 2020 2020 756e                un
-00013f60: 6971 7565 3d46 616c 7365 2c20 6261 6767  ique=False, bagg
-00013f70: 696e 675f 6974 6572 6174 696f 6e3d 3230  ing_iteration=20
-00013f80: 2c20 6c6f 7373 5f66 756e 6374 696f 6e3d  , loss_function=
-00013f90: 274d 5345 272c 0a20 2020 2020 2020 2020  'MSE',.         
-00013fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013fc0: 2020 2020 2020 2020 2020 2020 696e 6e65              inne
-00013fd0: 725f 7361 6d70 6c69 6e67 3d30 2e35 2c20  r_sampling=0.5, 
-00013fe0: 6f75 7465 725f 7361 6d70 6c69 6e67 3d30  outer_sampling=0
-00013ff0: 2e32 3529 0a20 2020 2020 2020 2020 2020  .25).           
-00014000: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00014010: 2020 2020 2020 2073 656c 662e 686f 6620         self.hof 
-00014020: 3d20 4772 6565 6479 5365 6c65 6374 696f  = GreedySelectio
-00014030: 6e48 616c 6c4f 6646 616d 6528 7365 6c66  nHallOfFame(self
-00014040: 2e65 6e73 656d 626c 655f 7369 7a65 2c20  .ensemble_size, 
-00014050: 7365 6c66 2e79 2c0a 2020 2020 2020 2020  self.y,.        
-00014060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014080: 2020 2020 2020 2020 2020 2020 2075 6e69               uni
-00014090: 7175 653d 4661 6c73 652c 2062 6167 6769  que=False, baggi
-000140a0: 6e67 5f69 7465 7261 7469 6f6e 3d32 302c  ng_iteration=20,
-000140b0: 206c 6f73 735f 6675 6e63 7469 6f6e 3d27   loss_function='
-000140c0: 4d53 4527 2c0a 2020 2020 2020 2020 2020  MSE',.          
-000140d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000140e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000140f0: 2020 2020 2020 2020 2020 2069 6e6e 6572             inner
-00014100: 5f73 616d 706c 696e 673d 302e 312c 206f  _sampling=0.1, o
-00014110: 7574 6572 5f73 616d 706c 696e 673d 302e  uter_sampling=0.
-00014120: 3235 290a 2020 2020 2020 2020 656c 6966  25).        elif
-00014130: 2073 656c 662e 656e 7365 6d62 6c65 5f73   self.ensemble_s
-00014140: 656c 6563 7469 6f6e 203d 3d20 2747 7265  election == 'Gre
-00014150: 6564 7953 656c 6563 7469 6f6e 2d52 6573  edySelection-Res
-00014160: 616d 706c 696e 672d 4d53 4527 3a0a 2020  ampling-MSE':.  
-00014170: 2020 2020 2020 2020 2020 7365 6c66 2e68            self.h
-00014180: 6f66 203d 2047 7265 6564 7953 656c 6563  of = GreedySelec
-00014190: 7469 6f6e 4861 6c6c 4f66 4661 6d65 2873  tionHallOfFame(s
-000141a0: 656c 662e 656e 7365 6d62 6c65 5f73 697a  elf.ensemble_siz
-000141b0: 652c 2073 656c 662e 792c 0a20 2020 2020  e, self.y,.     
-000141c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000141d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000141e0: 2020 2020 2020 2020 2020 2020 756e 6971              uniq
-000141f0: 7565 3d46 616c 7365 2c20 6261 6767 696e  ue=False, baggin
-00014200: 675f 6974 6572 6174 696f 6e3d 3230 2c20  g_iteration=20, 
-00014210: 6c6f 7373 5f66 756e 6374 696f 6e3d 274d  loss_function='M
-00014220: 5345 2729 0a20 2020 2020 2020 2065 6c69  SE').        eli
-00014230: 6620 7365 6c66 2e65 6e73 656d 626c 655f  f self.ensemble_
-00014240: 7365 6c65 6374 696f 6e20 3d3d 2027 4772  selection == 'Gr
-00014250: 6565 6479 5365 6c65 6374 696f 6e2d 5265  eedySelection-Re
-00014260: 7361 6d70 6c69 6e67 2d44 6976 6572 7365  sampling-Diverse
-00014270: 273a 0a20 2020 2020 2020 2020 2020 2073  ':.            s
-00014280: 656c 662e 686f 6620 3d20 4772 6565 6479  elf.hof = Greedy
-00014290: 5365 6c65 6374 696f 6e48 616c 6c4f 6646  SelectionHallOfF
-000142a0: 616d 6528 7365 6c66 2e65 6e73 656d 626c  ame(self.ensembl
-000142b0: 655f 7369 7a65 2c20 7365 6c66 2e79 2c20  e_size, self.y, 
-000142c0: 6469 7665 7273 6974 795f 7261 7469 6f3d  diversity_ratio=
-000142d0: 302e 352c 0a20 2020 2020 2020 2020 2020  0.5,.           
-000142e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000142f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014300: 2020 2020 2020 756e 6971 7565 3d46 616c        unique=Fal
-00014310: 7365 2c20 6261 6767 696e 675f 6974 6572  se, bagging_iter
-00014320: 6174 696f 6e3d 3230 2c20 6c6f 7373 5f66  ation=20, loss_f
-00014330: 756e 6374 696f 6e3d 274d 5345 272c 0a20  unction='MSE',. 
-00014340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014370: 696e 6e65 725f 7361 6d70 6c69 6e67 3d30  inner_sampling=0
-00014380: 2e35 2c20 6f75 7465 725f 7361 6d70 6c69  .5, outer_sampli
-00014390: 6e67 3d30 2e32 3529 0a20 2020 2020 2020  ng=0.25).       
-000143a0: 2065 6c69 6620 7365 6c66 2e65 6e73 656d   elif self.ensem
-000143b0: 626c 655f 7365 6c65 6374 696f 6e20 3d3d  ble_selection ==
-000143c0: 2027 4772 6565 6479 5365 6c65 6374 696f   'GreedySelectio
-000143d0: 6e2d 5265 7361 6d70 6c69 6e67 2d43 726f  n-Resampling-Cro
-000143e0: 7373 456e 7472 6f70 7927 3a0a 2020 2020  ssEntropy':.    
-000143f0: 2020 2020 2020 2020 7365 6c66 2e68 6f66          self.hof
-00014400: 203d 2047 7265 6564 7953 656c 6563 7469   = GreedySelecti
-00014410: 6f6e 4861 6c6c 4f66 4661 6d65 2873 656c  onHallOfFame(sel
-00014420: 662e 656e 7365 6d62 6c65 5f73 697a 652c  f.ensemble_size,
-00014430: 2073 656c 662e 792c 0a20 2020 2020 2020   self.y,.       
-00014440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014460: 2020 2020 2020 2020 2020 756e 6971 7565            unique
-00014470: 3d46 616c 7365 2c20 6261 6767 696e 675f  =False, bagging_
-00014480: 6974 6572 6174 696f 6e3d 3230 2c20 6c6f  iteration=20, lo
-00014490: 7373 5f66 756e 6374 696f 6e3d 2743 726f  ss_function='Cro
-000144a0: 7373 456e 7472 6f70 7927 290a 2020 2020  ssEntropy').    
-000144b0: 2020 2020 656c 6966 2073 656c 662e 656e      elif self.en
-000144c0: 7365 6d62 6c65 5f73 656c 6563 7469 6f6e  semble_selection
-000144d0: 203d 3d20 2747 7265 6564 7953 656c 6563   == 'GreedySelec
-000144e0: 7469 6f6e 2d52 6573 616d 706c 696e 672d  tion-Resampling-
-000144f0: 4869 6e67 6527 3a0a 2020 2020 2020 2020  Hinge':.        
-00014500: 2020 2020 7365 6c66 2e68 6f66 203d 2047      self.hof = G
-00014510: 7265 6564 7953 656c 6563 7469 6f6e 4861  reedySelectionHa
-00014520: 6c6c 4f66 4661 6d65 2873 656c 662e 656e  llOfFame(self.en
-00014530: 7365 6d62 6c65 5f73 697a 652c 2073 656c  semble_size, sel
-00014540: 662e 792c 0a20 2020 2020 2020 2020 2020  f.y,.           
-00014550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014570: 2020 2020 2020 756e 6971 7565 3d46 616c        unique=Fal
-00014580: 7365 2c20 6261 6767 696e 675f 6974 6572  se, bagging_iter
-00014590: 6174 696f 6e3d 3230 2c20 6c6f 7373 5f66  ation=20, loss_f
-000145a0: 756e 6374 696f 6e3d 2748 696e 6765 2729  unction='Hinge')
-000145b0: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
-000145c0: 6c66 2e65 6e73 656d 626c 655f 7365 6c65  lf.ensemble_sele
-000145d0: 6374 696f 6e20 3d3d 2027 4772 6565 6479  ction == 'Greedy
-000145e0: 5365 6c65 6374 696f 6e2d 5265 7361 6d70  Selection-Resamp
-000145f0: 6c69 6e67 2d5a 6572 6f4f 6e65 273a 0a20  ling-ZeroOne':. 
-00014600: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00014610: 686f 6620 3d20 4772 6565 6479 5365 6c65  hof = GreedySele
-00014620: 6374 696f 6e48 616c 6c4f 6646 616d 6528  ctionHallOfFame(
-00014630: 7365 6c66 2e65 6e73 656d 626c 655f 7369  self.ensemble_si
-00014640: 7a65 2c20 7365 6c66 2e79 2c0a 2020 2020  ze, self.y,.    
-00014650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014670: 2020 2020 2020 2020 2020 2020 2075 6e69               uni
-00014680: 7175 653d 4661 6c73 652c 2062 6167 6769  que=False, baggi
-00014690: 6e67 5f69 7465 7261 7469 6f6e 3d32 302c  ng_iteration=20,
-000146a0: 206c 6f73 735f 6675 6e63 7469 6f6e 3d27   loss_function='
-000146b0: 5a65 726f 4f6e 6527 290a 2020 2020 2020  ZeroOne').      
-000146c0: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
-000146d0: 6528 7365 6c66 2e65 6e73 656d 626c 655f  e(self.ensemble_
-000146e0: 7365 6c65 6374 696f 6e2c 2073 7472 2920  selection, str) 
-000146f0: 616e 6420 5c0a 2020 2020 2020 2020 2020  and \.          
-00014700: 2020 7365 6c66 2e65 6e73 656d 626c 655f    self.ensemble_
-00014710: 7365 6c65 6374 696f 6e2e 7374 6172 7473  selection.starts
-00014720: 7769 7468 2827 4772 6565 6479 5365 6c65  with('GreedySele
-00014730: 6374 696f 6e2d 5265 7361 6d70 6c69 6e67  ction-Resampling
-00014740: 2d4d 5345 2d43 7573 746f 6d2d 2729 3a0a  -MSE-Custom-'):.
-00014750: 2020 2020 2020 2020 2020 2020 7061 7261              para
-00014760: 6d65 7465 7220 3d20 7365 6c66 2e65 6e73  meter = self.ens
-00014770: 656d 626c 655f 7365 6c65 6374 696f 6e2e  emble_selection.
-00014780: 7265 706c 6163 6528 2747 7265 6564 7953  replace('GreedyS
-00014790: 656c 6563 7469 6f6e 2d52 6573 616d 706c  election-Resampl
-000147a0: 696e 672d 4d53 452d 4375 7374 6f6d 2d27  ing-MSE-Custom-'
-000147b0: 2c20 2727 290a 2020 2020 2020 2020 2020  , '').          
-000147c0: 2020 696e 6e65 725f 7361 6d70 6c69 6e67    inner_sampling
-000147d0: 2c20 6f75 7465 725f 7361 6d70 6c69 6e67  , outer_sampling
-000147e0: 2c20 6261 6767 696e 675f 6974 6572 6174  , bagging_iterat
-000147f0: 696f 6e20 3d20 7061 7261 6d65 7465 722e  ion = parameter.
-00014800: 7370 6c69 7428 272d 2729 0a20 2020 2020  split('-').     
-00014810: 2020 2020 2020 2069 6e6e 6572 5f73 616d         inner_sam
-00014820: 706c 696e 6720 3d20 666c 6f61 7428 696e  pling = float(in
-00014830: 6e65 725f 7361 6d70 6c69 6e67 290a 2020  ner_sampling).  
-00014840: 2020 2020 2020 2020 2020 6f75 7465 725f            outer_
-00014850: 7361 6d70 6c69 6e67 203d 2066 6c6f 6174  sampling = float
-00014860: 286f 7574 6572 5f73 616d 706c 696e 6729  (outer_sampling)
-00014870: 0a20 2020 2020 2020 2020 2020 2062 6167  .            bag
-00014880: 6769 6e67 5f69 7465 7261 7469 6f6e 203d  ging_iteration =
-00014890: 2069 6e74 2862 6167 6769 6e67 5f69 7465   int(bagging_ite
-000148a0: 7261 7469 6f6e 290a 2020 2020 2020 2020  ration).        
-000148b0: 2020 2020 7365 6c66 2e68 6f66 203d 2047      self.hof = G
-000148c0: 7265 6564 7953 656c 6563 7469 6f6e 4861  reedySelectionHa
-000148d0: 6c6c 4f66 4661 6d65 2873 656c 662e 656e  llOfFame(self.en
-000148e0: 7365 6d62 6c65 5f73 697a 652c 2073 656c  semble_size, sel
-000148f0: 662e 792c 2064 6976 6572 7369 7479 5f72  f.y, diversity_r
-00014900: 6174 696f 3d30 2c0a 2020 2020 2020 2020  atio=0,.        
-00014910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014930: 2020 2020 2020 2020 2075 6e69 7175 653d           unique=
-00014940: 4661 6c73 652c 2062 6167 6769 6e67 5f69  False, bagging_i
-00014950: 7465 7261 7469 6f6e 3d62 6167 6769 6e67  teration=bagging
-00014960: 5f69 7465 7261 7469 6f6e 2c20 6c6f 7373  _iteration, loss
-00014970: 5f66 756e 6374 696f 6e3d 274d 5345 272c  _function='MSE',
-00014980: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000149a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000149b0: 2020 696e 6e65 725f 7361 6d70 6c69 6e67    inner_sampling
-000149c0: 3d69 6e6e 6572 5f73 616d 706c 696e 672c  =inner_sampling,
-000149d0: 206f 7574 6572 5f73 616d 706c 696e 673d   outer_sampling=
-000149e0: 6f75 7465 725f 7361 6d70 6c69 6e67 290a  outer_sampling).
-000149f0: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
-00014a00: 6e73 7461 6e63 6528 7365 6c66 2e65 6e73  nstance(self.ens
-00014a10: 656d 626c 655f 7365 6c65 6374 696f 6e2c  emble_selection,
-00014a20: 2073 7472 2920 616e 6420 2747 7265 6564   str) and 'Greed
-00014a30: 7953 656c 6563 7469 6f6e 2d52 6573 616d  ySelection-Resam
-00014a40: 706c 696e 677e 2720 696e 2073 656c 662e  pling~' in self.
-00014a50: 656e 7365 6d62 6c65 5f73 656c 6563 7469  ensemble_selecti
-00014a60: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
-00014a70: 7365 6c66 2e65 6e73 656d 626c 655f 7365  self.ensemble_se
-00014a80: 6c65 6374 696f 6e2c 2069 6e69 7469 616c  lection, initial
-00014a90: 5f73 697a 6520 3d20 7365 6c66 2e65 6e73  _size = self.ens
-00014aa0: 656d 626c 655f 7365 6c65 6374 696f 6e2e  emble_selection.
-00014ab0: 7370 6c69 7428 277e 2729 0a20 2020 2020  split('~').     
-00014ac0: 2020 2020 2020 2069 6e69 7469 616c 5f73         initial_s
-00014ad0: 697a 6520 3d20 696e 7428 696e 6974 6961  ize = int(initia
-00014ae0: 6c5f 7369 7a65 290a 2020 2020 2020 2020  l_size).        
-00014af0: 2020 2020 7365 6c66 2e68 6f66 203d 2047      self.hof = G
-00014b00: 7265 6564 7953 656c 6563 7469 6f6e 4861  reedySelectionHa
-00014b10: 6c6c 4f66 4661 6d65 2873 656c 662e 656e  llOfFame(self.en
-00014b20: 7365 6d62 6c65 5f73 697a 652c 2073 656c  semble_size, sel
-00014b30: 662e 7929 0a20 2020 2020 2020 2020 2020  f.y).           
-00014b40: 2073 656c 662e 686f 662e 756e 6971 7565   self.hof.unique
-00014b50: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
-00014b60: 2020 2020 2073 656c 662e 686f 662e 6261       self.hof.ba
-00014b70: 6767 696e 675f 6974 6572 6174 696f 6e20  gging_iteration 
-00014b80: 3d20 3230 0a20 2020 2020 2020 2020 2020  = 20.           
-00014b90: 2073 656c 662e 686f 662e 696e 6974 6961   self.hof.initia
-00014ba0: 6c5f 7369 7a65 203d 2069 6e69 7469 616c  l_size = initial
-00014bb0: 5f73 697a 650a 2020 2020 2020 2020 656c  _size.        el
-00014bc0: 6966 2073 656c 662e 656e 7365 6d62 6c65  if self.ensemble
-00014bd0: 5f73 656c 6563 7469 6f6e 203d 3d20 274e  _selection == 'N
-00014be0: 6f76 656c 7479 5365 6c65 6374 696f 6e27  oveltySelection'
-00014bf0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00014c00: 6c66 2e68 6f66 203d 204e 6f76 656c 7479  lf.hof = Novelty
-00014c10: 4861 6c6c 4f66 4661 6d65 2873 656c 662e  HallOfFame(self.
-00014c20: 656e 7365 6d62 6c65 5f73 697a 652c 2073  ensemble_size, s
-00014c30: 656c 662e 7929 0a20 2020 2020 2020 2020  elf.y).         
-00014c40: 2020 2073 656c 662e 686f 662e 6e6f 7665     self.hof.nove
-00014c50: 6c74 795f 7765 6967 6874 203d 2073 656c  lty_weight = sel
-00014c60: 662e 6e6f 7665 6c74 795f 7765 6967 6874  f.novelty_weight
-00014c70: 0a20 2020 2020 2020 2065 6c69 6620 6973  .        elif is
-00014c80: 696e 7374 616e 6365 2873 656c 662e 656e  instance(self.en
-00014c90: 7365 6d62 6c65 5f73 656c 6563 7469 6f6e  semble_selection
-00014ca0: 2c20 7374 7229 2061 6e64 2028 2773 696d  , str) and ('sim
-00014cb0: 696c 6172 2720 696e 2073 656c 662e 656e  ilar' in self.en
-00014cc0: 7365 6d62 6c65 5f73 656c 6563 7469 6f6e  semble_selection
-00014cd0: 293a 0a20 2020 2020 2020 2020 2020 2023  ):.            #
-00014ce0: 2055 7369 6e67 2073 696d 696c 6172 6974   Using similarit
-00014cf0: 7920 6d65 7472 6963 2074 6f20 6669 6c74  y metric to filt
-00014d00: 6572 206f 7574 2069 6e64 6976 6964 7561  er out individua
-00014d10: 6c73 0a20 2020 2020 2020 2020 2020 2069  ls.            i
-00014d20: 6620 272d 2720 696e 2073 656c 662e 656e  f '-' in self.en
-00014d30: 7365 6d62 6c65 5f73 656c 6563 7469 6f6e  semble_selection
-00014d40: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00014d50: 2020 7261 7469 6f20 3d20 666c 6f61 7428    ratio = float(
-00014d60: 7365 6c66 2e65 6e73 656d 626c 655f 7365  self.ensemble_se
-00014d70: 6c65 6374 696f 6e2e 7370 6c69 7428 272d  lection.split('-
-00014d80: 2729 5b31 5d29 0a20 2020 2020 2020 2020  ')[1]).         
-00014d90: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00014da0: 2020 2020 2020 2020 2072 6174 696f 203d           ratio =
-00014db0: 2030 2e39 350a 0a20 2020 2020 2020 2020   0.95..         
-00014dc0: 2020 2064 6566 2073 696d 696c 6172 2861     def similar(a
-00014dd0: 2c20 6229 3a0a 2020 2020 2020 2020 2020  , b):.          
-00014de0: 2020 2020 2020 7265 7475 726e 2063 6f73        return cos
-00014df0: 696e 6528 612e 6361 7365 5f76 616c 7565  ine(a.case_value
-00014e00: 732c 2062 2e63 6173 655f 7661 6c75 6573  s, b.case_values
-00014e10: 2920 3e3d 2072 6174 696f 0a0a 2020 2020  ) >= ratio..    
-00014e20: 2020 2020 2020 2020 7365 6c66 2e68 6f66          self.hof
-00014e30: 203d 2048 616c 6c4f 6646 616d 6528 7365   = HallOfFame(se
-00014e40: 6c66 2e65 6e73 656d 626c 655f 7369 7a65  lf.ensemble_size
-00014e50: 2c20 7369 6d69 6c61 723d 7369 6d69 6c61  , similar=simila
-00014e60: 7229 0a20 2020 2020 2020 2065 6c69 6620  r).        elif 
-00014e70: 7365 6c66 2e73 636f 7265 5f66 756e 6320  self.score_func 
-00014e80: 3d3d 2027 4e6f 7665 6c74 7953 6561 7263  == 'NoveltySearc
-00014e90: 6827 3a0a 2020 2020 2020 2020 2020 2020  h':.            
-00014ea0: 6966 2073 656c 662e 656e 7365 6d62 6c65  if self.ensemble
-00014eb0: 5f73 656c 6563 7469 6f6e 203d 3d20 2744  _selection == 'D
-00014ec0: 5245 5027 3a0a 2020 2020 2020 2020 2020  REP':.          
-00014ed0: 2020 2020 2020 7365 6c66 2e68 6f66 203d        self.hof =
-00014ee0: 2044 5245 5048 616c 6c4f 6646 616d 6528   DREPHallOfFame(
-00014ef0: 7365 6c66 2e65 6e73 656d 626c 655f 7369  self.ensemble_si
-00014f00: 7a65 2c20 7365 6c66 2e79 290a 2020 2020  ze, self.y).    
-00014f10: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
-00014f20: 662e 656e 7365 6d62 6c65 5f73 656c 6563  f.ensemble_selec
-00014f30: 7469 6f6e 203d 3d20 2747 7265 6564 7953  tion == 'GreedyS
-00014f40: 656c 6563 7469 6f6e 273a 0a20 2020 2020  election':.     
-00014f50: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00014f60: 686f 6620 3d20 4772 6565 6479 5365 6c65  hof = GreedySele
-00014f70: 6374 696f 6e48 616c 6c4f 6646 616d 6528  ctionHallOfFame(
-00014f80: 7365 6c66 2e65 6e73 656d 626c 655f 7369  self.ensemble_si
-00014f90: 7a65 2c20 7365 6c66 2e79 290a 2020 2020  ze, self.y).    
-00014fa0: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
-00014fb0: 662e 656e 7365 6d62 6c65 5f73 656c 6563  f.ensemble_selec
-00014fc0: 7469 6f6e 203d 3d20 2754 7261 6469 7469  tion == 'Traditi
-00014fd0: 6f6e 616c 273a 0a20 2020 2020 2020 2020  onal':.         
-00014fe0: 2020 2020 2020 2073 656c 662e 686f 6620         self.hof 
-00014ff0: 3d20 4861 6c6c 4f66 4661 6d65 2873 656c  = HallOfFame(sel
-00015000: 662e 656e 7365 6d62 6c65 5f73 697a 6529  f.ensemble_size)
-00015010: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00015020: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00015030: 2020 2073 656c 662e 686f 6620 3d20 4e6f     self.hof = No
-00015040: 7665 6c74 7948 616c 6c4f 6646 616d 6528  veltyHallOfFame(
-00015050: 7365 6c66 2e65 6e73 656d 626c 655f 7369  self.ensemble_si
-00015060: 7a65 2c20 7365 6c66 2e79 290a 2020 2020  ze, self.y).    
-00015070: 2020 2020 2020 2020 7365 6c66 2e68 6f66          self.hof
-00015080: 2e6e 6f76 656c 7479 5f77 6569 6768 7420  .novelty_weight 
-00015090: 3d20 7365 6c66 2e6e 6f76 656c 7479 5f77  = self.novelty_w
-000150a0: 6569 6768 740a 2020 2020 2020 2020 656c  eight.        el
-000150b0: 6966 2073 656c 662e 656e 7365 6d62 6c65  if self.ensemble
-000150c0: 5f73 656c 6563 7469 6f6e 203d 3d20 4e6f  _selection == No
-000150d0: 6e65 206f 7220 7365 6c66 2e65 6e73 656d  ne or self.ensem
-000150e0: 626c 655f 7365 6c65 6374 696f 6e20 696e  ble_selection in
-000150f0: 205b 274e 6f6e 6527 2c20 276e 6f6e 6527   ['None', 'none'
-00015100: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00015110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015140: 2020 2020 2020 2020 2020 2020 2020 274d                'M
-00015150: 4150 2d45 6c69 7465 272c 2027 4861 6c66  AP-Elite', 'Half
-00015160: 2d4d 4150 2d45 6c69 7465 272c 0a20 2020  -MAP-Elite',.   
-00015170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000151a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000151b0: 2020 2020 2020 2020 2027 416e 676c 6544           'AngleD
-000151c0: 7269 7665 6e53 656c 6563 7469 6f6e 272c  rivenSelection',
-000151d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000151e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000151f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015210: 2020 2020 2020 2020 2020 2020 2027 4d61               'Ma
-00015220: 7841 6e67 6c65 5365 6c65 6374 696f 6e27  xAngleSelection'
-00015230: 5d3a 0a20 2020 2020 2020 2020 2020 2073  ]:.            s
-00015240: 656c 662e 686f 6620 3d20 4861 6c6c 4f66  elf.hof = HallOf
-00015250: 4661 6d65 2873 656c 662e 656e 7365 6d62  Fame(self.ensemb
-00015260: 6c65 5f73 697a 6529 0a20 2020 2020 2020  le_size).       
-00015270: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00015280: 2020 2072 6169 7365 2045 7863 6570 7469     raise Excepti
-00015290: 6f6e 0a20 2020 2020 2020 2069 6620 7365  on.        if se
-000152a0: 6c66 2e65 6e76 6972 6f6e 6d65 6e74 616c  lf.environmental
-000152b0: 5f73 656c 6563 7469 6f6e 2021 3d20 4e6f  _selection != No
-000152c0: 6e65 2061 6e64 2027 4265 7374 2720 6e6f  ne and 'Best' no
-000152d0: 7420 696e 2073 656c 662e 656e 7669 726f  t in self.enviro
-000152e0: 6e6d 656e 7461 6c5f 7365 6c65 6374 696f  nmental_selectio
-000152f0: 6e20 616e 6420 5c0a 2020 2020 2020 2020  n and \.        
-00015300: 2020 2020 7365 6c66 2e65 6e76 6972 6f6e      self.environ
-00015310: 6d65 6e74 616c 5f73 656c 6563 7469 6f6e  mental_selection
-00015320: 206e 6f74 2069 6e20 5b27 4e53 4741 322d   not in ['NSGA2-
-00015330: 4d69 7875 7027 5d3a 0a20 2020 2020 2020  Mixup']:.       
-00015340: 2020 2020 2073 656c 662e 686f 6620 3d20       self.hof = 
-00015350: 4e6f 6e65 0a20 2020 2020 2020 2069 6620  None.        if 
-00015360: 6973 696e 7374 616e 6365 2873 656c 662e  isinstance(self.
-00015370: 686f 662c 2045 6e73 656d 626c 6553 656c  hof, EnsembleSel
-00015380: 6563 7469 6f6e 4861 6c6c 4f66 4661 6d65  ectionHallOfFame
-00015390: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
-000153a0: 656c 662e 686f 662e 7665 7262 6f73 6520  elf.hof.verbose 
-000153b0: 3d20 7365 6c66 2e76 6572 626f 7365 0a0a  = self.verbose..
-000153c0: 2020 2020 6465 6620 6765 745f 7465 726d      def get_term
-000153d0: 696e 616c 5f70 726f 6261 6269 6c69 7479  inal_probability
-000153e0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-000153f0: 2222 220a 2020 2020 2020 2020 5573 696e  """.        Usin
-00015400: 6720 6665 6174 7572 6520 696d 706f 7274  g feature import
-00015410: 616e 6365 2061 7420 696e 6974 6961 6c69  ance at initiali
-00015420: 7a61 7469 6f6e 0a20 2020 2020 2020 2022  zation.        "
-00015430: 2222 0a20 2020 2020 2020 2023 2067 6574  "".        # get
-00015440: 2061 2070 726f 6261 6269 6c69 7479 2064   a probability d
-00015450: 6973 7472 6962 7574 696f 6e20 6261 7365  istribution base
-00015460: 6420 6f6e 2074 6865 2069 6d70 6f72 7461  d on the importa
-00015470: 6e63 6520 6f66 206f 7269 6769 6e61 6c20  nce of original 
-00015480: 6665 6174 7572 6573 2069 6e20 6120 7261  features in a ra
-00015490: 6e64 6f6d 2066 6f72 6573 740a 2020 2020  ndom forest.    
-000154a0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-000154b0: 6528 7365 6c66 2c20 4576 6f6c 7574 696f  e(self, Evolutio
-000154c0: 6e61 7279 466f 7265 7374 436c 6173 7369  naryForestClassi
-000154d0: 6669 6572 293a 0a20 2020 2020 2020 2020  fier):.         
-000154e0: 2020 2072 203d 2052 616e 646f 6d46 6f72     r = RandomFor
-000154f0: 6573 7443 6c61 7373 6966 6965 7228 6e5f  estClassifier(n_
-00015500: 6573 7469 6d61 746f 7273 3d35 290a 2020  estimators=5).  
-00015510: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00015520: 2020 2020 2020 2020 7220 3d20 5261 6e64          r = Rand
-00015530: 6f6d 466f 7265 7374 5265 6772 6573 736f  omForestRegresso
-00015540: 7228 6e5f 6573 7469 6d61 746f 7273 3d35  r(n_estimators=5
-00015550: 290a 2020 2020 2020 2020 722e 6669 7428  ).        r.fit(
-00015560: 7365 6c66 2e58 2c20 7365 6c66 2e79 290a  self.X, self.y).
-00015570: 2020 2020 2020 2020 7465 726d 696e 616c          terminal
-00015580: 5f70 726f 6220 3d20 6e70 2e61 7070 656e  _prob = np.appen
-00015590: 6428 722e 6665 6174 7572 655f 696d 706f  d(r.feature_impo
-000155a0: 7274 616e 6365 735f 2c20 302e 3129 0a20  rtances_, 0.1). 
-000155b0: 2020 2020 2020 2074 6572 6d69 6e61 6c5f         terminal_
-000155c0: 7072 6f62 203d 2074 6572 6d69 6e61 6c5f  prob = terminal_
-000155d0: 7072 6f62 202f 206e 702e 7375 6d28 7465  prob / np.sum(te
-000155e0: 726d 696e 616c 5f70 726f 6229 0a20 2020  rminal_prob).   
-000155f0: 2020 2020 2072 6574 7572 6e20 7465 726d       return term
-00015600: 696e 616c 5f70 726f 620a 0a20 2020 2064  inal_prob..    d
-00015610: 6566 2063 6f6e 7374 7275 6374 5f67 6c6f  ef construct_glo
-00015620: 6261 6c5f 6665 6174 7572 655f 706f 6f6c  bal_feature_pool
-00015630: 2873 656c 662c 2070 6f70 293a 0a20 2020  (self, pop):.   
-00015640: 2020 2020 2067 6f6f 645f 6665 6174 7572       good_featur
-00015650: 6573 2c20 7468 7265 7368 6f6c 6420 3d20  es, threshold = 
-00015660: 636f 6e73 7472 7563 745f 6665 6174 7572  construct_featur
-00015670: 655f 706f 6f6c 7328 706f 702c 2054 7275  e_pools(pop, Tru
-00015680: 652c 2074 6872 6573 686f 6c64 5f72 6174  e, threshold_rat
-00015690: 696f 3d73 656c 662e 6378 5f74 6872 6573  io=self.cx_thres
-000156a0: 686f 6c64 5f72 6174 696f 2c0a 2020 2020  hold_ratio,.    
-000156b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000156c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000156d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000156e0: 2020 2020 2020 2067 6f6f 645f 6665 6174         good_feat
-000156f0: 7572 6573 5f74 6872 6573 686f 6c64 3d73  ures_threshold=s
-00015700: 656c 662e 676f 6f64 5f66 6561 7475 7265  elf.good_feature
-00015710: 735f 7468 7265 7368 6f6c 6429 0a20 2020  s_threshold).   
-00015720: 2020 2020 2073 656c 662e 676f 6f64 5f66       self.good_f
-00015730: 6561 7475 7265 7320 3d20 676f 6f64 5f66  eatures = good_f
-00015740: 6561 7475 7265 730a 2020 2020 2020 2020  eatures.        
-00015750: 7365 6c66 2e63 785f 7468 7265 7368 6f6c  self.cx_threshol
-00015760: 6420 3d20 7468 7265 7368 6f6c 640a 0a20  d = threshold.. 
-00015770: 2020 2064 6566 2066 6974 2873 656c 662c     def fit(self,
-00015780: 2058 2c20 792c 2074 6573 745f 583d 4e6f   X, y, test_X=No
-00015790: 6e65 293a 0a20 2020 2020 2020 2073 656c  ne):.        sel
-000157a0: 662e 795f 7368 6170 6520 3d20 792e 7368  f.y_shape = y.sh
-000157b0: 6170 650a 2020 2020 2020 2020 2320 7365  ape.        # se
-000157c0: 6c66 2e66 6561 7475 7265 5f74 7970 6573  lf.feature_types
-000157d0: 203d 2074 7970 655f 6465 7465 6374 696f   = type_detectio
-000157e0: 6e28 5829 0a20 2020 2020 2020 2069 6620  n(X).        if 
-000157f0: 7365 6c66 2e6e 6f72 6d61 6c69 7a65 3a0a  self.normalize:.
-00015800: 2020 2020 2020 2020 2020 2020 5820 3d20              X = 
-00015810: 7365 6c66 2e78 5f73 6361 6c65 722e 6669  self.x_scaler.fi
-00015820: 745f 7472 616e 7366 6f72 6d28 582c 2079  t_transform(X, y
-00015830: 290a 2020 2020 2020 2020 2020 2020 7920  ).            y 
-00015840: 3d20 7365 6c66 2e79 5f73 6361 6c65 722e  = self.y_scaler.
-00015850: 6669 745f 7472 616e 7366 6f72 6d28 6e70  fit_transform(np
-00015860: 2e61 7272 6179 2879 292e 7265 7368 6170  .array(y).reshap
-00015870: 6528 2d31 2c20 3129 290a 2020 2020 2020  e(-1, 1)).      
-00015880: 2020 6966 2074 6573 745f 5820 6973 206e    if test_X is n
-00015890: 6f74 204e 6f6e 6520 616e 6420 7365 6c66  ot None and self
-000158a0: 2e65 6e76 6972 6f6e 6d65 6e74 616c 5f73  .environmental_s
-000158b0: 656c 6563 7469 6f6e 2021 3d20 274e 5347  election != 'NSG
-000158c0: 4132 2d4d 6978 7570 273a 0a20 2020 2020  A2-Mixup':.     
-000158d0: 2020 2020 2020 2023 2053 6f6d 6574 696d         # Sometim
-000158e0: 652c 2077 6520 6361 6e20 7461 6b65 2074  e, we can take t
-000158f0: 6573 7420 6461 7461 2069 6e74 6f20 636f  est data into co
-00015900: 6e73 6964 6572 6174 696f 6e0a 2020 2020  nsideration.    
-00015910: 2020 2020 2020 2020 7365 6c66 2e74 6573          self.tes
-00015920: 745f 6461 7461 5f73 697a 6520 3d20 6c65  t_data_size = le
-00015930: 6e28 7465 7374 5f58 290a 2020 2020 2020  n(test_X).      
-00015940: 2020 2020 2020 6966 2073 656c 662e 6e6f        if self.no
-00015950: 726d 616c 697a 653a 0a20 2020 2020 2020  rmalize:.       
-00015960: 2020 2020 2020 2020 2074 6573 745f 5820           test_X 
-00015970: 3d20 7365 6c66 2e78 5f73 6361 6c65 722e  = self.x_scaler.
-00015980: 7472 616e 7366 6f72 6d28 7465 7374 5f58  transform(test_X
-00015990: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-000159a0: 6c66 2e74 7261 696e 5820 3d20 580a 2020  lf.trainX = X.  
-000159b0: 2020 2020 2020 2020 2020 5820 3d20 6e70            X = np
-000159c0: 2e63 6f6e 6361 7465 6e61 7465 2828 5b58  .concatenate(([X
-000159d0: 2c20 7465 7374 5f58 5d29 2c20 6178 6973  , test_X]), axis
-000159e0: 3d30 290a 0a20 2020 2020 2020 2069 6620  =0)..        if 
-000159f0: 7365 6c66 2e76 616c 6964 6174 696f 6e5f  self.validation_
-00015a00: 7369 7a65 203e 2030 3a0a 2020 2020 2020  size > 0:.      
-00015a10: 2020 2020 2020 582c 2073 656c 662e 7661        X, self.va
-00015a20: 6c69 645f 782c 2079 2c20 7365 6c66 2e76  lid_x, y, self.v
-00015a30: 616c 6964 5f79 203d 2074 7261 696e 5f74  alid_y = train_t
-00015a40: 6573 745f 7370 6c69 7428 582c 2079 2c20  est_split(X, y, 
-00015a50: 7465 7374 5f73 697a 653d 7365 6c66 2e76  test_size=self.v
-00015a60: 616c 6964 6174 696f 6e5f 7369 7a65 290a  alidation_size).
-00015a70: 2020 2020 2020 2020 7365 6c66 2e58 2c20          self.X, 
-00015a80: 7365 6c66 2e79 203d 2058 2c20 792e 666c  self.y = X, y.fl
-00015a90: 6174 7465 6e28 290a 2020 2020 2020 2020  atten().        
-00015aa0: 6966 2073 656c 662e 656e 7669 726f 6e6d  if self.environm
-00015ab0: 656e 7461 6c5f 7365 6c65 6374 696f 6e20  ental_selection 
-00015ac0: 3d3d 2027 4e53 4741 322d 4d69 7875 7027  == 'NSGA2-Mixup'
-00015ad0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-00015ae0: 696e 6469 6365 7320 3d20 6e70 2e72 616e  indices = np.ran
-00015af0: 646f 6d2e 7261 6e64 696e 7428 302c 206c  dom.randint(0, l
-00015b00: 656e 2873 656c 662e 5829 2c20 286c 656e  en(self.X), (len
-00015b10: 2873 656c 662e 5829 2c20 3229 290a 2020  (self.X), 2)).  
-00015b20: 2020 2020 2020 2020 2020 2320 616c 7068            # alph
-00015b30: 6120 3d20 310a 2020 2020 2020 2020 2020  a = 1.          
-00015b40: 2020 2320 6c61 6d20 3d20 6e70 2e72 616e    # lam = np.ran
-00015b50: 646f 6d2e 6265 7461 2861 6c70 6861 2c20  dom.beta(alpha, 
-00015b60: 616c 7068 612c 206c 656e 2873 656c 662e  alpha, len(self.
-00015b70: 5829 292e 7265 7368 6170 6528 2d31 2c20  X)).reshape(-1, 
-00015b80: 3129 0a20 2020 2020 2020 2020 2020 2023  1).            #
-00015b90: 2073 656c 662e 6d69 7875 705f 7820 3d20   self.mixup_x = 
-00015ba0: 6c61 6d20 2a20 7365 6c66 2e58 5b69 6e64  lam * self.X[ind
-00015bb0: 6963 6573 5b3a 2c20 305d 5d20 2b20 2831  ices[:, 0]] + (1
-00015bc0: 202d 206c 616d 2920 2a20 7365 6c66 2e58   - lam) * self.X
-00015bd0: 5b69 6e64 6963 6573 5b3a 2c20 315d 5d0a  [indices[:, 1]].
-00015be0: 0a20 2020 2020 2020 2020 2020 2023 2064  .            # d
-00015bf0: 6566 2073 6875 6666 6c65 5f61 6c6f 6e67  ef shuffle_along
-00015c00: 5f61 7869 7328 612c 2061 7869 7329 3a0a  _axis(a, axis):.
-00015c10: 2020 2020 2020 2020 2020 2020 2320 2020              #   
-00015c20: 2020 6964 7820 3d20 6e70 2e72 616e 646f    idx = np.rando
-00015c30: 6d2e 7261 6e64 282a 612e 7368 6170 6529  m.rand(*a.shape)
-00015c40: 2e61 7267 736f 7274 2861 7869 733d 6178  .argsort(axis=ax
-00015c50: 6973 290a 2020 2020 2020 2020 2020 2020  is).            
-00015c60: 2320 2020 2020 7265 7475 726e 206e 702e  #     return np.
-00015c70: 7461 6b65 5f61 6c6f 6e67 5f61 7869 7328  take_along_axis(
-00015c80: 612c 2069 6478 2c20 6178 6973 3d61 7869  a, idx, axis=axi
-00015c90: 7329 0a20 2020 2020 2020 2020 2020 2023  s).            #
-00015ca0: 2073 656c 662e 6d69 7875 705f 7820 3d20   self.mixup_x = 
-00015cb0: 7368 7566 666c 655f 616c 6f6e 675f 6178  shuffle_along_ax
-00015cc0: 6973 2873 656c 662e 582c 2030 290a 2020  is(self.X, 0).  
-00015cd0: 2020 2020 2020 2020 2020 7265 6775 6c61            regula
-00015ce0: 7269 7a61 7469 6f6e 5f6d 6f64 656c 203d  rization_model =
-00015cf0: 2073 656c 662e 7061 7261 6d5b 2772 6567   self.param['reg
-00015d00: 756c 6172 697a 6174 696f 6e5f 6d6f 6465  ularization_mode
-00015d10: 6c27 5d0a 2020 2020 2020 2020 2020 2020  l'].            
-00015d20: 6966 2072 6567 756c 6172 697a 6174 696f  if regularizatio
-00015d30: 6e5f 6d6f 6465 6c20 3d3d 2027 4c47 424d  n_model == 'LGBM
-00015d40: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
-00015d50: 2020 206c 6762 6d20 3d20 4c47 424d 5265     lgbm = LGBMRe
-00015d60: 6772 6573 736f 7228 290a 2020 2020 2020  gressor().      
-00015d70: 2020 2020 2020 656c 6966 2072 6567 756c        elif regul
-00015d80: 6172 697a 6174 696f 6e5f 6d6f 6465 6c20  arization_model 
-00015d90: 3d3d 2027 5356 5227 3a0a 2020 2020 2020  == 'SVR':.      
-00015da0: 2020 2020 2020 2020 2020 6c67 626d 203d            lgbm =
-00015db0: 2053 5652 2829 0a20 2020 2020 2020 2020   SVR().         
-00015dc0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00015dd0: 2020 2020 2020 2020 2072 6169 7365 2045           raise E
-00015de0: 7863 6570 7469 6f6e 0a20 2020 2020 2020  xception.       
-00015df0: 2020 2020 206c 6762 6d2e 6669 7428 7365       lgbm.fit(se
-00015e00: 6c66 2e58 2c20 7365 6c66 2e79 290a 2020  lf.X, self.y).  
-00015e10: 2020 2020 2020 2020 2020 7365 6c66 2e74            self.t
-00015e20: 6573 745f 5820 3d20 7465 7374 5f58 0a20  est_X = test_X. 
-00015e30: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00015e40: 7073 6575 646f 5f6c 6162 656c 203d 206c  pseudo_label = l
-00015e50: 6762 6d2e 7072 6564 6963 7428 7365 6c66  gbm.predict(self
-00015e60: 2e78 5f73 6361 6c65 722e 7472 616e 7366  .x_scaler.transf
-00015e70: 6f72 6d28 7465 7374 5f58 2929 0a20 2020  orm(test_X)).   
-00015e80: 2020 2020 2020 2020 2023 2073 656c 662e           # self.
-00015e90: 6d69 7875 705f 7920 3d20 6c61 6d2e 666c  mixup_y = lam.fl
-00015ea0: 6174 7465 6e28 2920 2a20 7365 6c66 2e79  atten() * self.y
-00015eb0: 5b69 6e64 6963 6573 5b3a 2c20 305d 5d20  [indices[:, 0]] 
-00015ec0: 2b20 2831 202d 206c 616d 2e66 6c61 7474  + (1 - lam.flatt
-00015ed0: 656e 2829 2920 2a20 7365 6c66 2e79 5b69  en()) * self.y[i
-00015ee0: 6e64 6963 6573 5b3a 2c20 315d 5d0a 2020  ndices[:, 1]].  
-00015ef0: 2020 2020 2020 6966 2073 656c 662e 656e        if self.en
-00015f00: 7669 726f 6e6d 656e 7461 6c5f 7365 6c65  vironmental_sele
-00015f10: 6374 696f 6e20 3d3d 2027 4e53 4741 322d  ction == 'NSGA2-
-00015f20: 3130 3027 3a0a 2020 2020 2020 2020 2020  100':.          
-00015f30: 2020 7365 6c66 2e72 616e 646f 6d5f 6f62    self.random_ob
-00015f40: 6a65 6374 6976 6573 203d 206e 702e 7261  jectives = np.ra
-00015f50: 6e64 6f6d 2e75 6e69 666f 726d 2830 2c20  ndom.uniform(0, 
-00015f60: 312c 2073 697a 653d 286c 656e 2879 292c  1, size=(len(y),
-00015f70: 2031 3030 2929 0a20 2020 2020 2020 2069   100)).        i
-00015f80: 6620 7365 6c66 2e65 6e76 6972 6f6e 6d65  f self.environme
-00015f90: 6e74 616c 5f73 656c 6563 7469 6f6e 203d  ntal_selection =
-00015fa0: 3d20 274e 5347 4132 2d31 3030 2d4e 6f72  = 'NSGA2-100-Nor
-00015fb0: 6d61 6c27 3a0a 2020 2020 2020 2020 2020  mal':.          
-00015fc0: 2020 7365 6c66 2e72 616e 646f 6d5f 6f62    self.random_ob
-00015fd0: 6a65 6374 6976 6573 203d 2074 7275 6e63  jectives = trunc
-00015fe0: 6174 6564 5f6e 6f72 6d61 6c28 7361 6d70  ated_normal(samp
-00015ff0: 6c65 3d28 6c65 6e28 7929 2c20 3130 3029  le=(len(y), 100)
-00016000: 290a 2020 2020 2020 2020 6966 2073 656c  ).        if sel
-00016010: 662e 656e 7669 726f 6e6d 656e 7461 6c5f  f.environmental_
-00016020: 7365 6c65 6374 696f 6e20 3d3d 2027 4e53  selection == 'NS
-00016030: 4741 322d 3130 302d 4c48 5327 3a0a 2020  GA2-100-LHS':.  
-00016040: 2020 2020 2020 2020 2020 6672 6f6d 2073            from s
-00016050: 6d74 2e73 616d 706c 696e 675f 6d65 7468  mt.sampling_meth
-00016060: 6f64 7320 696d 706f 7274 204c 4853 0a20  ods import LHS. 
-00016070: 2020 2020 2020 2020 2020 2078 6c69 6d69             xlimi
-00016080: 7473 203d 206e 702e 7265 7065 6174 286e  ts = np.repeat(n
-00016090: 702e 6172 7261 7928 5b5b 302e 302c 2031  p.array([[0.0, 1
-000160a0: 2e30 5d5d 292c 206c 656e 2879 292c 2061  .0]]), len(y), a
-000160b0: 7869 733d 3029 0a20 2020 2020 2020 2020  xis=0).         
-000160c0: 2020 2073 616d 706c 696e 6720 3d20 4c48     sampling = LH
-000160d0: 5328 786c 696d 6974 733d 786c 696d 6974  S(xlimits=xlimit
-000160e0: 7329 0a20 2020 2020 2020 2020 2020 206e  s).            n
-000160f0: 756d 203d 2031 3030 0a20 2020 2020 2020  um = 100.       
-00016100: 2020 2020 2073 656c 662e 7261 6e64 6f6d       self.random
-00016110: 5f6f 626a 6563 7469 7665 7320 3d20 7361  _objectives = sa
-00016120: 6d70 6c69 6e67 286e 756d 292e 540a 0a20  mpling(num).T.. 
-00016130: 2020 2020 2020 2073 656c 662e 6c61 7a79         self.lazy
-00016140: 5f69 6e69 7428 5829 0a0a 2020 2020 2020  _init(X)..      
-00016150: 2020 7374 6174 735f 6669 7420 3d20 746f    stats_fit = to
-00016160: 6f6c 732e 5374 6174 6973 7469 6373 286c  ols.Statistics(l
-00016170: 616d 6264 6120 696e 643a 2069 6e64 2e66  ambda ind: ind.f
-00016180: 6974 6e65 7373 2e77 7661 6c75 6573 290a  itness.wvalues).
-00016190: 2020 2020 2020 2020 7374 6174 735f 7369          stats_si
-000161a0: 7a65 203d 2074 6f6f 6c73 2e53 7461 7469  ze = tools.Stati
-000161b0: 7374 6963 7328 6c61 6d62 6461 2078 3a20  stics(lambda x: 
-000161c0: 6c65 6e28 7829 202f 2f20 6c65 6e28 782e  len(x) // len(x.
-000161d0: 6765 6e65 2929 0a20 2020 2020 2020 206d  gene)).        m
-000161e0: 7374 6174 7320 3d20 746f 6f6c 732e 4d75  stats = tools.Mu
-000161f0: 6c74 6953 7461 7469 7374 6963 7328 6669  ltiStatistics(fi
-00016200: 746e 6573 733d 7374 6174 735f 6669 742c  tness=stats_fit,
-00016210: 2073 697a 653d 7374 6174 735f 7369 7a65   size=stats_size
-00016220: 290a 2020 2020 2020 2020 6d73 7461 7473  ).        mstats
-00016230: 2e72 6567 6973 7465 7228 2261 7667 222c  .register("avg",
-00016240: 206e 702e 6d65 616e 2c20 6178 6973 3d30   np.mean, axis=0
-00016250: 290a 2020 2020 2020 2020 6d73 7461 7473  ).        mstats
-00016260: 2e72 6567 6973 7465 7228 2273 7464 222c  .register("std",
-00016270: 206e 702e 7374 642c 2061 7869 733d 3029   np.std, axis=0)
-00016280: 0a20 2020 2020 2020 206d 7374 6174 732e  .        mstats.
-00016290: 7265 6769 7374 6572 2822 3235 2522 2c20  register("25%", 
-000162a0: 7061 7274 6961 6c28 6e70 2e71 7561 6e74  partial(np.quant
-000162b0: 696c 652c 2071 3d30 2e32 3529 2c20 6178  ile, q=0.25), ax
-000162c0: 6973 3d30 290a 2020 2020 2020 2020 6d73  is=0).        ms
-000162d0: 7461 7473 2e72 6567 6973 7465 7228 2237  tats.register("7
-000162e0: 3525 222c 2070 6172 7469 616c 286e 702e  5%", partial(np.
-000162f0: 7175 616e 7469 6c65 2c20 713d 302e 3735  quantile, q=0.75
-00016300: 292c 2061 7869 733d 3029 0a20 2020 2020  ), axis=0).     
-00016310: 2020 206d 7374 6174 732e 7265 6769 7374     mstats.regist
-00016320: 6572 2822 6d65 6469 616e 222c 206e 702e  er("median", np.
-00016330: 6d65 6469 616e 2c20 6178 6973 3d30 290a  median, axis=0).
-00016340: 2020 2020 2020 2020 6d73 7461 7473 2e72          mstats.r
-00016350: 6567 6973 7465 7228 226d 696e 222c 206e  egister("min", n
-00016360: 702e 6d69 6e2c 2061 7869 733d 3029 0a20  p.min, axis=0). 
-00016370: 2020 2020 2020 206d 7374 6174 732e 7265         mstats.re
-00016380: 6769 7374 6572 2822 6d61 7822 2c20 6e70  gister("max", np
-00016390: 2e6d 6178 2c20 6178 6973 3d30 290a 0a20  .max, axis=0).. 
-000163a0: 2020 2020 2020 2070 6f70 2c20 6c6f 6720         pop, log 
-000163b0: 3d20 7365 6c66 2e65 6153 696d 706c 6528  = self.eaSimple(
-000163c0: 7365 6c66 2e70 6f70 2c20 7365 6c66 2e74  self.pop, self.t
-000163d0: 6f6f 6c62 6f78 2c20 7365 6c66 2e63 726f  oolbox, self.cro
-000163e0: 7373 5f70 622c 2073 656c 662e 6d75 7461  ss_pb, self.muta
-000163f0: 7469 6f6e 5f70 622c 2073 656c 662e 6e5f  tion_pb, self.n_
-00016400: 6765 6e2c 0a20 2020 2020 2020 2020 2020  gen,.           
-00016410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016420: 2020 2020 2020 7374 6174 733d 6d73 7461        stats=msta
-00016430: 7473 2c20 6861 6c6c 6f66 6661 6d65 3d73  ts, halloffame=s
-00016440: 656c 662e 686f 662c 2076 6572 626f 7365  elf.hof, verbose
-00016450: 3d73 656c 662e 7665 7262 6f73 6529 0a20  =self.verbose). 
-00016460: 2020 2020 2020 2073 656c 662e 706f 7020         self.pop 
-00016470: 3d20 706f 700a 0a20 2020 2020 2020 2073  = pop..        s
-00016480: 656c 662e 6669 6e61 6c5f 6d6f 6465 6c5f  elf.final_model_
-00016490: 6c61 7a79 5f74 7261 696e 696e 6728 7365  lazy_training(se
-000164a0: 6c66 2e68 6f66 290a 2020 2020 2020 2020  lf.hof).        
-000164b0: 7365 6c66 2e73 6563 6f6e 645f 6c61 7965  self.second_laye
-000164c0: 725f 6765 6e65 7261 7469 6f6e 2858 2c20  r_generation(X, 
-000164d0: 7929 0a20 2020 2020 2020 2072 6574 7572  y).        retur
-000164e0: 6e20 7365 6c66 0a0a 2020 2020 6465 6620  n self..    def 
-000164f0: 7365 636f 6e64 5f6c 6179 6572 5f67 656e  second_layer_gen
-00016500: 6572 6174 696f 6e28 7365 6c66 2c20 582c  eration(self, X,
-00016510: 2079 293a 0a20 2020 2020 2020 2023 2061   y):.        # a
-00016520: 6e20 696e 7465 7265 7374 696e 6720 7175  n interesting qu
-00016530: 6573 7469 6f6e 2069 7320 686f 7720 746f  estion is how to
-00016540: 2063 6f6d 6269 6e65 2074 6865 7365 2062   combine these b
-00016550: 6173 6520 6c65 6172 6e65 7273 2074 6f20  ase learners to 
-00016560: 6163 6869 6576 6520 6120 676f 6f64 2065  achieve a good e
-00016570: 6e6f 7567 6820 7065 7266 6f72 6d61 6e63  nough performanc
-00016580: 650a 2020 2020 2020 2020 6966 2073 656c  e.        if sel
-00016590: 662e 7365 636f 6e64 5f6c 6179 6572 203d  f.second_layer =
-000165a0: 3d20 274e 6f6e 6527 206f 7220 7365 6c66  = 'None' or self
-000165b0: 2e73 6563 6f6e 645f 6c61 7965 7220 3d3d  .second_layer ==
-000165c0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-000165d0: 2020 2072 6574 7572 6e0a 2020 2020 2020     return.      
-000165e0: 2020 795f 6461 7461 203d 2073 656c 662e    y_data = self.
-000165f0: 790a 2020 2020 2020 2020 7072 6564 6963  y.        predic
-00016600: 7469 6f6e 7320 3d20 5b5d 0a20 2020 2020  tions = [].     
-00016610: 2020 2066 6f72 2069 6e64 6976 6964 7561     for individua
-00016620: 6c20 696e 2073 656c 662e 686f 663a 0a20  l in self.hof:. 
-00016630: 2020 2020 2020 2020 2020 2070 7265 6469             predi
-00016640: 6374 696f 6e73 2e61 7070 656e 6428 696e  ctions.append(in
-00016650: 6469 7669 6475 616c 2e70 7265 6469 6374  dividual.predict
-00016660: 6564 5f76 616c 7565 7329 0a20 2020 2020  ed_values).     
-00016670: 2020 2070 7265 6469 6374 696f 6e73 203d     predictions =
-00016680: 206e 702e 6172 7261 7928 7072 6564 6963   np.array(predic
-00016690: 7469 6f6e 7329 0a0a 2020 2020 2020 2020  tions)..        
-000166a0: 6966 2073 656c 662e 7365 636f 6e64 5f6c  if self.second_l
-000166b0: 6179 6572 203d 3d20 2744 5245 5027 3a0a  ayer == 'DREP':.
-000166c0: 2020 2020 2020 2020 2020 2020 2320 666f              # fo
-000166d0: 7277 6172 6420 7365 6c65 6374 696f 6e0a  rward selection.
-000166e0: 2020 2020 2020 2020 2020 2020 795f 7361              y_sa
-000166f0: 6d70 6c65 203d 2079 5f64 6174 612e 666c  mple = y_data.fl
-00016700: 6174 7465 6e28 290a 2020 2020 2020 2020  atten().        
-00016710: 2020 2020 6375 7272 656e 745f 7072 6564      current_pred
-00016720: 6963 7469 6f6e 203d 206e 702e 7a65 726f  iction = np.zero
-00016730: 735f 6c69 6b65 2879 5f73 616d 706c 6529  s_like(y_sample)
-00016740: 0a20 2020 2020 2020 2020 2020 2072 656d  .            rem
-00016750: 6169 6e5f 696e 6420 3d20 7365 7428 5b69  ain_ind = set([i
-00016760: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-00016770: 6c65 6e28 7365 6c66 2e68 6f66 2929 5d29  len(self.hof))])
-00016780: 0a20 2020 2020 2020 2020 2020 206d 696e  .            min
-00016790: 5f69 6e64 6578 203d 2030 0a20 2020 2020  _index = 0.     
-000167a0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-000167b0: 7265 6d61 696e 5f69 6e64 3a0a 2020 2020  remain_ind:.    
-000167c0: 2020 2020 2020 2020 2020 2020 6572 726f              erro
-000167d0: 7220 3d20 6e70 2e6d 6561 6e28 2870 7265  r = np.mean((pre
-000167e0: 6469 6374 696f 6e73 5b69 5d20 2d20 795f  dictions[i] - y_
-000167f0: 7361 6d70 6c65 2920 2a2a 2032 290a 2020  sample) ** 2).  
-00016800: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00016810: 2065 7272 6f72 203c 206e 702e 6d65 616e   error < np.mean
-00016820: 2828 6375 7272 656e 745f 7072 6564 6963  ((current_predic
-00016830: 7469 6f6e 202d 2079 5f73 616d 706c 6529  tion - y_sample)
-00016840: 202a 2a20 3229 3a0a 2020 2020 2020 2020   ** 2):.        
-00016850: 2020 2020 2020 2020 2020 2020 6375 7272              curr
-00016860: 656e 745f 7072 6564 6963 7469 6f6e 203d  ent_prediction =
-00016870: 2070 7265 6469 6374 696f 6e73 5b69 5d0a   predictions[i].
-00016880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016890: 2020 2020 6d69 6e5f 696e 6465 7820 3d20      min_index = 
-000168a0: 690a 2020 2020 2020 2020 2020 2020 7265  i.            re
-000168b0: 6d61 696e 5f69 6e64 2e72 656d 6f76 6528  main_ind.remove(
-000168c0: 6d69 6e5f 696e 6465 7829 0a0a 2020 2020  min_index)..    
-000168d0: 2020 2020 2020 2020 656e 7365 6d62 6c65          ensemble
-000168e0: 5f6c 6973 7420 3d20 6e70 2e7a 6572 6f73  _list = np.zeros
-000168f0: 286c 656e 2873 656c 662e 686f 6629 290a  (len(self.hof)).
-00016900: 2020 2020 2020 2020 2020 2020 656e 7365              ense
-00016910: 6d62 6c65 5f6c 6973 745b 6d69 6e5f 696e  mble_list[min_in
-00016920: 6465 785d 203d 2031 0a20 2020 2020 2020  dex] = 1.       
-00016930: 2020 2020 2077 6869 6c65 2054 7275 653a       while True:
-00016940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016950: 2064 6976 5f6c 6973 7420 3d20 5b5d 0a20   div_list = []. 
-00016960: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00016970: 6f72 2069 2069 6e20 7265 6d61 696e 5f69  or i in remain_i
-00016980: 6e64 3a0a 2020 2020 2020 2020 2020 2020  nd:.            
-00016990: 2020 2020 2020 2020 6469 7665 7273 6974          diversit
-000169a0: 7920 3d20 6e70 2e6d 6561 6e28 2828 6375  y = np.mean(((cu
-000169b0: 7272 656e 745f 7072 6564 6963 7469 6f6e  rrent_prediction
-000169c0: 202d 2070 7265 6469 6374 696f 6e73 5b69   - predictions[i
-000169d0: 5d29 202a 2a20 3229 290a 2020 2020 2020  ]) ** 2)).      
-000169e0: 2020 2020 2020 2020 2020 2020 2020 6c6f                lo
-000169f0: 7373 203d 206e 702e 6d65 616e 2828 2879  ss = np.mean(((y
-00016a00: 5f73 616d 706c 6520 2d20 7072 6564 6963  _sample - predic
-00016a10: 7469 6f6e 735b 695d 2920 2a2a 2032 2929  tions[i]) ** 2))
-00016a20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016a30: 2020 2020 2064 6976 5f6c 6973 742e 6170       div_list.ap
-00016a40: 7065 6e64 2828 6469 7665 7273 6974 792c  pend((diversity,
-00016a50: 206c 6f73 732c 2069 2929 0a20 2020 2020   loss, i)).     
-00016a60: 2020 2020 2020 2020 2020 2064 6976 5f6c             div_l
-00016a70: 6973 7420 3d20 6c69 7374 2873 6f72 7465  ist = list(sorte
-00016a80: 6428 6469 765f 6c69 7374 2c20 6b65 793d  d(div_list, key=
-00016a90: 6c61 6d62 6461 2078 3a20 2d78 5b30 5d29  lambda x: -x[0])
-00016aa0: 295b 3a69 6e74 2872 6f75 6e64 286c 656e  )[:int(round(len
-00016ab0: 2864 6976 5f6c 6973 7429 202a 2030 2e35  (div_list) * 0.5
-00016ac0: 2929 5d0a 2020 2020 2020 2020 2020 2020  ))].            
-00016ad0: 2020 2020 6469 765f 6c69 7374 203d 206c      div_list = l
-00016ae0: 6973 7428 736f 7274 6564 2864 6976 5f6c  ist(sorted(div_l
-00016af0: 6973 742c 206b 6579 3d6c 616d 6264 6120  ist, key=lambda 
-00016b00: 783a 2078 5b31 5d29 290a 2020 2020 2020  x: x[1])).      
-00016b10: 2020 2020 2020 2020 2020 696e 6465 7820            index 
-00016b20: 3d20 6469 765f 6c69 7374 5b30 5d5b 325d  = div_list[0][2]
-00016b30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016b40: 2065 6e73 656d 626c 655f 7369 7a65 203d   ensemble_size =
-00016b50: 206e 702e 7375 6d28 656e 7365 6d62 6c65   np.sum(ensemble
-00016b60: 5f6c 6973 7429 0a20 2020 2020 2020 2020  _list).         
-00016b70: 2020 2020 2020 2074 7269 616c 5f70 7265         trial_pre
-00016b80: 6469 6374 696f 6e20 3d20 656e 7365 6d62  diction = ensemb
-00016b90: 6c65 5f73 697a 6520 2f20 2865 6e73 656d  le_size / (ensem
-00016ba0: 626c 655f 7369 7a65 202b 2031 2920 2a20  ble_size + 1) * 
-00016bb0: 6375 7272 656e 745f 7072 6564 6963 7469  current_predicti
-00016bc0: 6f6e 202b 205c 0a20 2020 2020 2020 2020  on + \.         
-00016bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016be0: 2020 2020 2020 2020 2020 3120 2f20 2865            1 / (e
-00016bf0: 6e73 656d 626c 655f 7369 7a65 202b 2031  nsemble_size + 1
-00016c00: 2920 2a20 7072 6564 6963 7469 6f6e 735b  ) * predictions[
-00016c10: 696e 6465 785d 0a20 2020 2020 2020 2020  index].         
-00016c20: 2020 2020 2020 2069 6620 6e70 2e6d 6561         if np.mea
-00016c30: 6e28 2828 7472 6961 6c5f 7072 6564 6963  n(((trial_predic
-00016c40: 7469 6f6e 202d 2079 5f73 616d 706c 6529  tion - y_sample)
-00016c50: 202a 2a20 3229 2920 3e20 6e70 2e6d 6561   ** 2)) > np.mea
-00016c60: 6e28 2828 6375 7272 656e 745f 7072 6564  n(((current_pred
-00016c70: 6963 7469 6f6e 202d 2079 5f73 616d 706c  iction - y_sampl
-00016c80: 6529 202a 2a20 3229 293a 0a20 2020 2020  e) ** 2)):.     
-00016c90: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-00016ca0: 7265 616b 0a20 2020 2020 2020 2020 2020  reak.           
-00016cb0: 2020 2020 2063 7572 7265 6e74 5f70 7265       current_pre
-00016cc0: 6469 6374 696f 6e20 3d20 7472 6961 6c5f  diction = trial_
-00016cd0: 7072 6564 6963 7469 6f6e 0a20 2020 2020  prediction.     
-00016ce0: 2020 2020 2020 2020 2020 2065 6e73 656d             ensem
-00016cf0: 626c 655f 6c69 7374 5b69 6e64 6578 5d20  ble_list[index] 
-00016d00: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
-00016d10: 2020 2020 7265 6d61 696e 5f69 6e64 2e72      remain_ind.r
-00016d20: 656d 6f76 6528 696e 6465 7829 0a20 2020  emove(index).   
-00016d30: 2020 2020 2020 2020 2065 6e73 656d 626c           ensembl
-00016d40: 655f 6c69 7374 202f 3d20 6e70 2e73 756d  e_list /= np.sum
-00016d50: 2865 6e73 656d 626c 655f 6c69 7374 290a  (ensemble_list).
-00016d60: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00016d70: 2e74 7265 655f 7765 6967 6874 203d 2065  .tree_weight = e
-00016d80: 6e73 656d 626c 655f 6c69 7374 0a20 2020  nsemble_list.   
-00016d90: 2020 2020 2065 6c69 6620 7365 6c66 2e73       elif self.s
-00016da0: 6563 6f6e 645f 6c61 7965 7220 3d3d 2027  econd_layer == '
-00016db0: 5269 6467 6527 3a0a 2020 2020 2020 2020  Ridge':.        
-00016dc0: 2020 2020 7365 6c66 2e72 6964 6765 203d      self.ridge =
-00016dd0: 2052 6964 6765 2861 6c70 6861 3d31 652d   Ridge(alpha=1e-
-00016de0: 332c 206e 6f72 6d61 6c69 7a65 3d54 7275  3, normalize=Tru
-00016df0: 652c 2066 6974 5f69 6e74 6572 6365 7074  e, fit_intercept
-00016e00: 3d46 616c 7365 290a 2020 2020 2020 2020  =False).        
-00016e10: 2020 2020 7365 6c66 2e72 6964 6765 2e66      self.ridge.f
-00016e20: 6974 2870 7265 6469 6374 696f 6e73 2e54  it(predictions.T
-00016e30: 2c20 795f 6461 7461 290a 2020 2020 2020  , y_data).      
-00016e40: 2020 2020 2020 7820 3d20 7365 6c66 2e72        x = self.r
-00016e50: 6964 6765 2e63 6f65 665f 0a20 2020 2020  idge.coef_.     
-00016e60: 2020 2020 2020 2078 5b78 203c 2030 5d20         x[x < 0] 
-00016e70: 3d20 300a 2020 2020 2020 2020 2020 2020  = 0.            
-00016e80: 785b 7820 3e20 305d 203d 2031 0a20 2020  x[x > 0] = 1.   
-00016e90: 2020 2020 2020 2020 2078 202f 3d20 6e70           x /= np
-00016ea0: 2e73 756d 2878 290a 2020 2020 2020 2020  .sum(x).        
-00016eb0: 2020 2020 7820 3d20 782e 666c 6174 7465      x = x.flatte
-00016ec0: 6e28 290a 2020 2020 2020 2020 2020 2020  n().            
-00016ed0: 7365 6c66 2e74 7265 655f 7765 6967 6874  self.tree_weight
-00016ee0: 203d 2078 0a20 2020 2020 2020 2065 6c69   = x.        eli
-00016ef0: 6620 7365 6c66 2e73 6563 6f6e 645f 6c61  f self.second_la
-00016f00: 7965 7220 3d3d 2027 5269 6467 652d 5072  yer == 'Ridge-Pr
-00016f10: 6564 6963 7469 6f6e 273a 0a20 2020 2020  ediction':.     
-00016f20: 2020 2020 2020 2070 7265 6469 6374 696f         predictio
-00016f30: 6e73 203d 2073 656c 662e 696e 6469 7669  ns = self.indivi
-00016f40: 6475 616c 5f70 7265 6469 6374 696f 6e28  dual_prediction(
-00016f50: 5829 0a20 2020 2020 2020 2020 2020 2023  X).            #
-00016f60: 2066 6974 7469 6e67 2070 7265 6469 6374   fitting predict
-00016f70: 6564 2076 616c 7565 730a 2020 2020 2020  ed values.      
-00016f80: 2020 2020 2020 7365 6c66 2e72 6964 6765        self.ridge
-00016f90: 203d 2052 6964 6765 4356 286e 6f72 6d61   = RidgeCV(norma
-00016fa0: 6c69 7a65 3d54 7275 652c 2066 6974 5f69  lize=True, fit_i
-00016fb0: 6e74 6572 6365 7074 3d46 616c 7365 290a  ntercept=False).
-00016fc0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00016fd0: 2e72 6964 6765 2e66 6974 2870 7265 6469  .ridge.fit(predi
-00016fe0: 6374 696f 6e73 2e54 2c20 795f 6461 7461  ctions.T, y_data
-00016ff0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-00017000: 6c66 2e74 7265 655f 7765 6967 6874 203d  lf.tree_weight =
-00017010: 2073 656c 662e 7269 6467 652e 636f 6566   self.ridge.coef
-00017020: 5f2e 666c 6174 7465 6e28 290a 2020 2020  _.flatten().    
-00017030: 2020 2020 656c 6966 2073 656c 662e 7365      elif self.se
-00017040: 636f 6e64 5f6c 6179 6572 203d 3d20 2752  cond_layer == 'R
-00017050: 462d 526f 7574 696e 6727 3a0a 2020 2020  F-Routing':.    
-00017060: 2020 2020 2020 2020 7072 6564 6963 7469          predicti
-00017070: 6f6e 7320 3d20 7365 6c66 2e69 6e64 6976  ons = self.indiv
-00017080: 6964 7561 6c5f 7072 6564 6963 7469 6f6e  idual_prediction
-00017090: 2858 290a 2020 2020 2020 2020 2020 2020  (X).            
-000170a0: 2320 6669 7474 696e 6720 7072 6564 6963  # fitting predic
-000170b0: 7465 6420 7661 6c75 6573 0a20 2020 2020  ted values.     
-000170c0: 2020 2020 2020 2073 656c 662e 7269 6467         self.ridg
-000170d0: 6520 3d20 5261 6e64 6f6d 466f 7265 7374  e = RandomForest
-000170e0: 436c 6173 7369 6669 6572 286e 5f65 7374  Classifier(n_est
-000170f0: 696d 6174 6f72 733d 3130 290a 2020 2020  imators=10).    
-00017100: 2020 2020 2020 2020 6265 7374 5f61 7267          best_arg
-00017110: 203d 2028 2870 7265 6469 6374 696f 6e73   = ((predictions
-00017120: 202d 2079 5f64 6174 6129 202a 2a20 3229   - y_data) ** 2)
-00017130: 2e61 7267 6d69 6e28 6178 6973 3d30 290a  .argmin(axis=0).
-00017140: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00017150: 2e72 6964 6765 2e63 616e 6469 6461 7465  .ridge.candidate
-00017160: 7320 3d20 6e70 2e73 6f72 7428 6e70 2e75  s = np.sort(np.u
-00017170: 6e69 7175 6528 6265 7374 5f61 7267 2929  nique(best_arg))
-00017180: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00017190: 662e 7269 6467 652e 6669 7428 582c 2062  f.ridge.fit(X, b
-000171a0: 6573 745f 6172 6729 0a20 2020 2020 2020  est_arg).       
-000171b0: 2020 2020 2073 656c 662e 7472 6565 5f77       self.tree_w
-000171c0: 6569 6768 7420 3d20 4e6f 6e65 0a20 2020  eight = None.   
-000171d0: 2020 2020 2065 6c69 6620 7365 6c66 2e73       elif self.s
-000171e0: 6563 6f6e 645f 6c61 7965 7220 3d3d 2027  econd_layer == '
-000171f0: 5472 6565 4261 7365 6c69 6e65 273a 0a20  TreeBaseline':. 
-00017200: 2020 2020 2020 2020 2020 2062 6173 655f             base_
-00017210: 6c69 6e65 5f73 636f 7265 203d 206e 702e  line_score = np.
-00017220: 6d65 616e 2863 726f 7373 5f76 616c 5f73  mean(cross_val_s
-00017230: 636f 7265 2844 6563 6973 696f 6e54 7265  core(DecisionTre
-00017240: 6552 6567 7265 7373 6f72 2829 2c20 582c  eRegressor(), X,
-00017250: 2079 2929 0a20 2020 2020 2020 2020 2020   y)).           
-00017260: 2073 636f 7265 203d 206e 702e 6172 7261   score = np.arra
-00017270: 7928 6c69 7374 286d 6170 286c 616d 6264  y(list(map(lambd
-00017280: 6120 783a 2078 2e66 6974 6e65 7373 2e77  a x: x.fitness.w
-00017290: 7661 6c75 6573 5b30 5d2c 2073 656c 662e  values[0], self.
-000172a0: 686f 662e 6974 656d 7329 2929 0a20 2020  hof.items))).   
-000172b0: 2020 2020 2020 2020 2078 203d 206e 702e           x = np.
-000172c0: 7a65 726f 735f 6c69 6b65 2873 636f 7265  zeros_like(score
-000172d0: 290a 2020 2020 2020 2020 2020 2020 785b  ).            x[
-000172e0: 7363 6f72 6520 3e20 6261 7365 5f6c 696e  score > base_lin
-000172f0: 655f 7363 6f72 655d 203d 2031 0a20 2020  e_score] = 1.   
-00017300: 2020 2020 2020 2020 2069 6620 6e70 2e73           if np.s
-00017310: 756d 2878 2920 3d3d 2030 3a0a 2020 2020  um(x) == 0:.    
-00017320: 2020 2020 2020 2020 2020 2020 785b 305d              x[0]
-00017330: 203d 2031 0a20 2020 2020 2020 2020 2020   = 1.           
-00017340: 2078 202f 3d20 6e70 2e73 756d 2878 290a   x /= np.sum(x).
-00017350: 2020 2020 2020 2020 2020 2020 7820 3d20              x = 
-00017360: 782e 666c 6174 7465 6e28 290a 2020 2020  x.flatten().    
-00017370: 2020 2020 2020 2020 7365 6c66 2e74 7265          self.tre
-00017380: 655f 7765 6967 6874 203d 2078 0a20 2020  e_weight = x.   
-00017390: 2020 2020 2065 6c69 6620 7365 6c66 2e73       elif self.s
-000173a0: 6563 6f6e 645f 6c61 7965 7220 3d3d 2027  econd_layer == '
-000173b0: 4469 7665 7273 6974 7950 7275 6e65 273a  DiversityPrune':
-000173c0: 0a20 2020 2020 2020 2020 2020 2073 616d  .            sam
-000173d0: 706c 655f 6c65 6e20 3d20 3530 300a 2020  ple_len = 500.  
-000173e0: 2020 2020 2020 2020 2020 7072 6564 6963            predic
-000173f0: 7469 6f6e 7320 3d20 5b5d 0a20 2020 2020  tions = [].     
-00017400: 2020 2020 2020 2066 6f72 2069 6e64 6976         for indiv
-00017410: 6964 7561 6c20 696e 2073 656c 662e 686f  idual in self.ho
-00017420: 663a 0a20 2020 2020 2020 2020 2020 2020  f:.             
-00017430: 2020 2066 756e 6320 3d20 7365 6c66 2e74     func = self.t
-00017440: 6f6f 6c62 6f78 2e63 6f6d 7069 6c65 2869  oolbox.compile(i
-00017450: 6e64 6976 6964 7561 6c29 0a20 2020 2020  ndividual).     
-00017460: 2020 2020 2020 2020 2020 2078 203d 206e             x = n
-00017470: 702e 7261 6e64 6f6d 2e72 616e 646e 2873  p.random.randn(s
-00017480: 616d 706c 655f 6c65 6e2c 2058 2e73 6861  ample_len, X.sha
-00017490: 7065 5b31 5d29 0a20 2020 2020 2020 2020  pe[1]).         
-000174a0: 2020 2020 2020 2059 7020 3d20 7265 7375         Yp = resu
-000174b0: 6c74 5f63 616c 6375 6c61 7469 6f6e 2866  lt_calculation(f
-000174c0: 756e 632c 2078 2c20 7365 6c66 2e6f 7269  unc, x, self.ori
-000174d0: 6769 6e61 6c5f 6665 6174 7572 6573 290a  ginal_features).
-000174e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000174f0: 7072 6564 6963 7465 6420 3d20 696e 6469  predicted = indi
-00017500: 7669 6475 616c 2e70 6970 652e 7072 6564  vidual.pipe.pred
-00017510: 6963 7428 5970 290a 2020 2020 2020 2020  ict(Yp).        
-00017520: 2020 2020 2020 2020 7072 6564 6963 7469          predicti
-00017530: 6f6e 732e 6170 7065 6e64 2870 7265 6469  ons.append(predi
-00017540: 6374 6564 290a 2020 2020 2020 2020 2020  cted).          
-00017550: 2020 7072 6564 6963 7469 6f6e 7320 3d20    predictions = 
-00017560: 6e70 2e61 7272 6179 2870 7265 6469 6374  np.array(predict
-00017570: 696f 6e73 290a 0a20 2020 2020 2020 2020  ions)..         
-00017580: 2020 2023 2066 6f72 7761 7264 2073 656c     # forward sel
-00017590: 6563 7469 6f6e 0a20 2020 2020 2020 2020  ection.         
-000175a0: 2020 2063 7572 7265 6e74 5f70 7265 6469     current_predi
-000175b0: 6374 696f 6e20 3d20 6e70 2e7a 6572 6f73  ction = np.zeros
-000175c0: 2873 616d 706c 655f 6c65 6e29 0a20 2020  (sample_len).   
-000175d0: 2020 2020 2020 2020 2072 656d 6169 6e5f           remain_
-000175e0: 696e 6420 3d20 7365 7428 5b69 2066 6f72  ind = set([i for
-000175f0: 2069 2069 6e20 7261 6e67 6528 6c65 6e28   i in range(len(
-00017600: 7365 6c66 2e68 6f66 2929 5d29 0a0a 2020  self.hof))])..  
-00017610: 2020 2020 2020 2020 2020 2320 7365 6c65            # sele
-00017620: 6374 2066 6972 7374 2072 6567 7265 7373  ct first regress
-00017630: 6f72 0a20 2020 2020 2020 2020 2020 206d  or.            m
-00017640: 696e 5f69 6e64 6578 203d 2030 0a20 2020  in_index = 0.   
-00017650: 2020 2020 2020 2020 2072 656d 6169 6e5f           remain_
-00017660: 696e 642e 7265 6d6f 7665 286d 696e 5f69  ind.remove(min_i
-00017670: 6e64 6578 290a 0a20 2020 2020 2020 2020  ndex)..         
-00017680: 2020 2065 6e73 656d 626c 655f 6c69 7374     ensemble_list
-00017690: 203d 206e 702e 7a65 726f 7328 6c65 6e28   = np.zeros(len(
-000176a0: 7365 6c66 2e68 6f66 2929 0a20 2020 2020  self.hof)).     
-000176b0: 2020 2020 2020 2065 6e73 656d 626c 655f         ensemble_
-000176c0: 6c69 7374 5b6d 696e 5f69 6e64 6578 5d20  list[min_index] 
-000176d0: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
-000176e0: 7768 696c 6520 5472 7565 3a0a 2020 2020  while True:.    
-000176f0: 2020 2020 2020 2020 2020 2020 6469 765f              div_
-00017700: 6c69 7374 203d 205b 5d0a 2020 2020 2020  list = [].      
-00017710: 2020 2020 2020 2020 2020 666f 7220 6920            for i 
-00017720: 696e 2072 656d 6169 6e5f 696e 643a 0a20  in remain_ind:. 
-00017730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017740: 2020 2064 6976 6572 7369 7479 203d 206e     diversity = n
-00017750: 702e 6d65 616e 2828 2863 7572 7265 6e74  p.mean(((current
-00017760: 5f70 7265 6469 6374 696f 6e20 2d20 7072  _prediction - pr
-00017770: 6564 6963 7469 6f6e 735b 695d 2920 2a2a  edictions[i]) **
-00017780: 2032 2929 0a20 2020 2020 2020 2020 2020   2)).           
-00017790: 2020 2020 2020 2020 2064 6976 5f6c 6973           div_lis
-000177a0: 742e 6170 7065 6e64 2828 6469 7665 7273  t.append((divers
-000177b0: 6974 792c 2069 2929 0a20 2020 2020 2020  ity, i)).       
-000177c0: 2020 2020 2020 2020 2064 6976 5f6c 6973           div_lis
-000177d0: 7420 3d20 6c69 7374 2873 6f72 7465 6428  t = list(sorted(
-000177e0: 6469 765f 6c69 7374 2c20 6b65 793d 6c61  div_list, key=la
-000177f0: 6d62 6461 2078 3a20 2d78 5b30 5d29 290a  mbda x: -x[0])).
+00010c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010c50: 206d 6178 5f76 616c 7565 3d73 697a 6529   max_value=size)
+00010c60: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+00010c70: 2020 2020 2020 2020 2020 2020 746f 6f6c              tool
+00010c80: 626f 782e 6465 636f 7261 7465 2822 6d61  box.decorate("ma
+00010c90: 7465 222c 2073 656c 662e 7374 6174 6963  te", self.static
+00010ca0: 5f6c 696d 6974 5f66 756e 6374 696f 6e29  _limit_function)
+00010cb0: 0a20 2020 2020 2020 2020 2020 2074 6f6f  .            too
+00010cc0: 6c62 6f78 2e64 6563 6f72 6174 6528 226d  lbox.decorate("m
+00010cd0: 7574 6174 6522 2c20 7365 6c66 2e73 7461  utate", self.sta
+00010ce0: 7469 635f 6c69 6d69 745f 6675 6e63 7469  tic_limit_functi
+00010cf0: 6f6e 290a 2020 2020 2020 2020 6966 2073  on).        if s
+00010d00: 656c 662e 696e 7472 6f6e 5f74 6872 6573  elf.intron_thres
+00010d10: 686f 6c64 203e 2030 2061 6e64 2073 656c  hold > 0 and sel
+00010d20: 662e 6d69 6e5f 6865 6967 6874 203e 2030  f.min_height > 0
+00010d30: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00010d40: 6973 6520 4578 6365 7074 696f 6e28 274e  ise Exception('N
+00010d50: 6f74 2073 7570 706f 7274 6564 2069 6e20  ot supported in 
+00010d60: 7374 6174 6963 206c 696d 6974 2729 0a20  static limit'). 
+00010d70: 2020 2020 2020 2069 6620 7365 6c66 2e69         if self.i
+00010d80: 6e74 726f 6e5f 7468 7265 7368 6f6c 6420  ntron_threshold 
+00010d90: 3e20 303a 0a20 2020 2020 2020 2020 2020  > 0:.           
+00010da0: 2073 656c 662e 6e65 7574 7261 6c5f 6d75   self.neutral_mu
+00010db0: 7461 7469 6f6e 203d 2073 7461 7469 634c  tation = staticL
+00010dc0: 696d 6974 286b 6579 3d6f 7065 7261 746f  imit(key=operato
+00010dd0: 722e 6174 7472 6765 7474 6572 2822 6865  r.attrgetter("he
+00010de0: 6967 6874 2229 2c0a 2020 2020 2020 2020  ight"),.        
+00010df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010e10: 2020 2020 2020 2020 6d61 785f 7661 6c75          max_valu
+00010e20: 653d 7365 6c66 2e6d 6178 5f68 6569 6768  e=self.max_heigh
+00010e30: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+00010e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010e60: 2020 206d 696e 5f76 616c 7565 3d73 656c     min_value=sel
+00010e70: 662e 6d69 6e5f 6865 6967 6874 2928 7061  f.min_height)(pa
+00010e80: 7274 6961 6c28 6d75 7455 6e69 666f 726d  rtial(mutUniform
+00010e90: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00010ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010ee0: 2020 2020 2065 7870 723d 746f 6f6c 626f       expr=toolbo
+00010ef0: 782e 6578 7072 5f6d 7574 2c0a 2020 2020  x.expr_mut,.    
+00010f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010f40: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00010f50: 7365 743d 7365 6c66 2e70 7365 7429 290a  set=self.pset)).
+00010f60: 0a20 2020 2020 2020 2073 656c 662e 706f  .        self.po
+00010f70: 7020 3d20 746f 6f6c 626f 782e 706f 7075  p = toolbox.popu
+00010f80: 6c61 7469 6f6e 286e 3d73 656c 662e 6e5f  lation(n=self.n_
+00010f90: 706f 7029 0a0a 2020 2020 2020 2020 7365  pop)..        se
+00010fa0: 6c66 2e72 616e 646f 6d5f 696e 6465 7820  lf.random_index 
+00010fb0: 3d20 6e70 2e72 616e 646f 6d2e 7261 6e64  = np.random.rand
+00010fc0: 696e 7428 302c 206c 656e 2873 656c 662e  int(0, len(self.
+00010fd0: 5829 2c20 3529 0a0a 2020 2020 2020 2020  X), 5)..        
+00010fe0: 6465 6620 7368 7566 666c 655f 616c 6f6e  def shuffle_alon
+00010ff0: 675f 6178 6973 2861 2c20 6178 6973 293a  g_axis(a, axis):
+00011000: 0a20 2020 2020 2020 2020 2020 2069 6478  .            idx
+00011010: 203d 206e 702e 7261 6e64 6f6d 2e72 616e   = np.random.ran
+00011020: 6428 2a61 2e73 6861 7065 292e 6172 6773  d(*a.shape).args
+00011030: 6f72 7428 6178 6973 3d61 7869 7329 0a20  ort(axis=axis). 
+00011040: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00011050: 6e20 6e70 2e74 616b 655f 616c 6f6e 675f  n np.take_along_
+00011060: 6178 6973 2861 2c20 6964 782c 2061 7869  axis(a, idx, axi
+00011070: 733d 6178 6973 290a 0a20 2020 2020 2020  s=axis)..       
+00011080: 2073 656c 662e 7072 6564 6963 7469 6f6e   self.prediction
+00011090: 5f78 203d 2073 6875 6666 6c65 5f61 6c6f  _x = shuffle_alo
+000110a0: 6e67 5f61 7869 7328 6e70 2e63 6f70 7928  ng_axis(np.copy(
+000110b0: 7365 6c66 2e58 292c 2061 7869 733d 3029  self.X), axis=0)
+000110c0: 0a0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+000110d0: 662e 6261 7365 5f6c 6561 726e 6572 203d  f.base_learner =
+000110e0: 3d20 274e 4e27 3a0a 2020 2020 2020 2020  = 'NN':.        
+000110f0: 2020 2020 6376 203d 2067 6574 5f63 765f      cv = get_cv_
+00011100: 7370 6c69 7474 6572 2873 656c 662e 6e65  splitter(self.ne
+00011110: 7572 616c 5f6e 6574 776f 726b 2c20 7365  ural_network, se
+00011120: 6c66 2e63 7629 0a20 2020 2020 2020 2020  lf.cv).         
+00011130: 2020 2073 656c 662e 6e6e 5f70 7265 6469     self.nn_predi
+00011140: 6374 696f 6e20 3d20 6e70 2e7a 6572 6f73  ction = np.zeros
+00011150: 2828 6c65 6e28 7365 6c66 2e79 292c 2073  ((len(self.y), s
+00011160: 656c 662e 6869 6464 656e 5f6c 6179 6572  elf.hidden_layer
+00011170: 735b 2d31 5d29 290a 0a20 2020 2020 2020  s[-1]))..       
+00011180: 2020 2020 2058 2c20 7920 3d20 7365 6c66       X, y = self
+00011190: 2e58 2c20 7365 6c66 2e79 0a20 2020 2020  .X, self.y.     
+000111a0: 2020 2020 2020 2063 765f 6c6f 7373 203d         cv_loss =
+000111b0: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
+000111c0: 666f 7220 7472 6169 6e5f 696e 6465 782c  for train_index,
+000111d0: 2074 6573 745f 696e 6465 7820 696e 2063   test_index in c
+000111e0: 762e 7370 6c69 7428 5829 3a0a 2020 2020  v.split(X):.    
+000111f0: 2020 2020 2020 2020 2020 2020 585f 7472              X_tr
+00011200: 6169 6e2c 2058 5f74 6573 7420 3d20 585b  ain, X_test = X[
+00011210: 7472 6169 6e5f 696e 6465 785d 2c20 585b  train_index], X[
+00011220: 7465 7374 5f69 6e64 6578 5d0a 2020 2020  test_index].    
+00011230: 2020 2020 2020 2020 2020 2020 795f 7472              y_tr
+00011240: 6169 6e2c 2079 5f74 6573 7420 3d20 795b  ain, y_test = y[
+00011250: 7472 6169 6e5f 696e 6465 785d 2c20 795b  train_index], y[
+00011260: 7465 7374 5f69 6e64 6578 5d0a 2020 2020  test_index].    
+00011270: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00011280: 2e6e 6575 7261 6c5f 6e65 7477 6f72 6b2e  .neural_network.
+00011290: 6669 7428 585f 7472 6169 6e2c 2079 5f74  fit(X_train, y_t
+000112a0: 7261 696e 290a 2020 2020 2020 2020 2020  rain).          
+000112b0: 2020 2020 2020 6376 5f6c 6f73 732e 6170        cv_loss.ap
+000112c0: 7065 6e64 2872 325f 7363 6f72 6528 795f  pend(r2_score(y_
+000112d0: 7465 7374 2c20 7365 6c66 2e6e 6575 7261  test, self.neura
+000112e0: 6c5f 6e65 7477 6f72 6b2e 7072 6564 6963  l_network.predic
+000112f0: 7428 585f 7465 7374 2929 290a 2020 2020  t(X_test))).    
+00011300: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00011310: 2e6e 6e5f 7072 6564 6963 7469 6f6e 5b74  .nn_prediction[t
+00011320: 6573 745f 696e 6465 785d 203d 2067 6574  est_index] = get
+00011330: 5f61 6374 6976 6174 696f 6e73 2873 656c  _activations(sel
+00011340: 662e 6e65 7572 616c 5f6e 6574 776f 726b  f.neural_network
+00011350: 2c20 585f 7465 7374 295b 2d32 5d0a 2020  , X_test)[-2].  
+00011360: 2020 2020 2020 2020 2020 2320 7072 696e            # prin
+00011370: 7428 274d 6561 6e20 4356 206c 6f73 7327  t('Mean CV loss'
+00011380: 2c20 6e70 2e6d 6561 6e28 6376 5f6c 6f73  , np.mean(cv_los
+00011390: 7329 290a 0a20 2020 2020 2020 2020 2020  s))..           
+000113a0: 2073 656c 662e 6e65 7572 616c 5f6e 6574   self.neural_net
+000113b0: 776f 726b 2e66 6974 2873 656c 662e 582c  work.fit(self.X,
+000113c0: 2073 656c 662e 7929 0a20 2020 2020 2020   self.y).       
+000113d0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+000113e0: 2020 2073 656c 662e 6e6e 5f70 7265 6469     self.nn_predi
+000113f0: 6374 696f 6e20 3d20 4e6f 6e65 0a20 2020  ction = None.   
+00011400: 2020 2020 2073 656c 662e 7468 7265 6164       self.thread
+00011410: 5f70 6f6f 6c5f 696e 6974 6961 6c69 7a61  _pool_initializa
+00011420: 7469 6f6e 2829 0a20 2020 2020 2020 2073  tion().        s
+00011430: 656c 662e 746f 6f6c 626f 782e 726f 6f74  elf.toolbox.root
+00011440: 5f63 726f 7373 6f76 6572 203d 2073 656c  _crossover = sel
+00011450: 662e 6372 6f73 736f 7665 725f 636f 6e66  f.crossover_conf
+00011460: 6967 7572 6174 696f 6e2e 726f 6f74 5f63  iguration.root_c
+00011470: 726f 7373 6f76 6572 0a20 2020 2020 2020  rossover.       
+00011480: 2073 656c 662e 6576 616c 7561 7469 6f6e   self.evaluation
+00011490: 5f63 6f6e 6669 6775 7261 7469 6f6e 2e70  _configuration.p
+000114a0: 7365 7420 3d20 7073 6574 0a20 2020 2020  set = pset.     
+000114b0: 2020 2073 656c 662e 6576 616c 7561 7469     self.evaluati
+000114c0: 6f6e 5f63 6f6e 6669 6775 7261 7469 6f6e  on_configuration
+000114d0: 2e6e 6e5f 7072 6564 6963 7469 6f6e 203d  .nn_prediction =
+000114e0: 2073 656c 662e 6e6e 5f70 7265 6469 6374   self.nn_predict
+000114f0: 696f 6e0a 2020 2020 2020 2020 7365 6c66  ion.        self
+00011500: 2e74 6f6f 6c62 6f78 2e70 7365 7420 3d20  .toolbox.pset = 
+00011510: 7073 6574 0a0a 2020 2020 2020 2020 6966  pset..        if
+00011520: 2073 656c 662e 696d 6261 6c61 6e63 6564   self.imbalanced
+00011530: 5f63 6f6e 6669 6775 7261 7469 6f6e 2e62  _configuration.b
+00011540: 616c 616e 6365 645f 6576 616c 7561 7469  alanced_evaluati
+00011550: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
+00011560: 7365 6c66 2e65 7661 6c75 6174 696f 6e5f  self.evaluation_
+00011570: 636f 6e66 6967 7572 6174 696f 6e2e 7361  configuration.sa
+00011580: 6d70 6c65 5f77 6569 6768 7420 3d20 6765  mple_weight = ge
+00011590: 745f 7361 6d70 6c65 5f77 6569 6768 7428  t_sample_weight(
+000115a0: 7365 6c66 2e58 2c20 7365 6c66 2e74 6573  self.X, self.tes
+000115b0: 745f 582c 2073 656c 662e 792c 0a20 2020  t_X, self.y,.   
+000115c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000115d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000115e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000115f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011600: 2020 2020 2020 2020 2073 656c 662e 696d           self.im
+00011610: 6261 6c61 6e63 6564 5f63 6f6e 6669 6775  balanced_configu
+00011620: 7261 7469 6f6e 290a 0a20 2020 2064 6566  ration)..    def
+00011630: 2067 6574 5f63 726f 7373 6f76 6572 5f63   get_crossover_c
+00011640: 6f6e 6669 6775 7261 7469 6f6e 2873 656c  onfiguration(sel
+00011650: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+00011660: 726e 2073 656c 662e 6372 6f73 736f 7665  rn self.crossove
+00011670: 725f 636f 6e66 6967 7572 6174 696f 6e0a  r_configuration.
+00011680: 0a20 2020 2064 6566 2073 656c 6563 7469  .    def selecti
+00011690: 6f6e 5f6f 7065 7261 746f 725f 696e 6974  on_operator_init
+000116a0: 6961 6c69 7a61 7469 6f6e 2873 656c 662c  ialization(self,
+000116b0: 2074 6f6f 6c62 6f78 293a 0a20 2020 2020   toolbox):.     
+000116c0: 2020 2069 6620 7365 6c66 2e62 6c6f 6174     if self.bloat
+000116d0: 5f63 6f6e 7472 6f6c 2069 7320 6e6f 7420  _control is not 
+000116e0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+000116f0: 2020 6966 2073 656c 662e 626c 6f61 745f    if self.bloat_
+00011700: 636f 6e74 726f 6c2e 6765 7428 2764 6f75  control.get('dou
+00011710: 626c 655f 6c65 7869 6361 7365 272c 2046  ble_lexicase', F
+00011720: 616c 7365 293a 0a20 2020 2020 2020 2020  alse):.         
+00011730: 2020 2020 2020 2073 656c 662e 7365 6c65         self.sele
+00011740: 6374 203d 2027 446f 7562 6c65 4c65 7869  ct = 'DoubleLexi
+00011750: 6361 7365 270a 2020 2020 2020 2020 2020  case'.          
+00011760: 2020 6966 2073 656c 662e 626c 6f61 745f    if self.bloat_
+00011770: 636f 6e74 726f 6c2e 6765 7428 2764 6f75  control.get('dou
+00011780: 626c 655f 746f 7572 6e61 6d65 6e74 272c  ble_tournament',
+00011790: 2046 616c 7365 293a 0a20 2020 2020 2020   False):.       
+000117a0: 2020 2020 2020 2020 2073 656c 662e 7365           self.se
+000117b0: 6c65 6374 203d 2027 446f 7562 6c65 546f  lect = 'DoubleTo
+000117c0: 7572 6e61 6d65 6e74 270a 2020 2020 2020  urnament'.      
+000117d0: 2020 2020 2020 6966 2073 656c 662e 626c        if self.bl
+000117e0: 6f61 745f 636f 6e74 726f 6c2e 6765 7428  oat_control.get(
+000117f0: 2773 7461 7469 7374 6963 735f 746f 7572  'statistics_tour
+00011800: 6e61 6d65 6e74 272c 2046 616c 7365 293a  nament', False):
+00011810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011820: 2073 656c 662e 7365 6c65 6374 203d 2027   self.select = '
+00011830: 5374 6174 6973 7469 6373 546f 7572 6e61  StatisticsTourna
+00011840: 6d65 6e74 270a 2020 2020 2020 2020 2020  ment'.          
+00011850: 2020 6966 2073 656c 662e 626c 6f61 745f    if self.bloat_
+00011860: 636f 6e74 726f 6c2e 6765 7428 276c 6578  control.get('lex
+00011870: 6963 6f67 7261 7068 6963 5f70 7265 7373  icographic_press
+00011880: 7572 6527 2c20 4661 6c73 6529 3a0a 2020  ure', False):.  
+00011890: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000118a0: 6c66 2e73 656c 6563 7420 3d20 274c 5050  lf.select = 'LPP
+000118b0: 270a 2020 2020 2020 2020 2320 7365 6c65  '.        # sele
+000118c0: 6374 696f 6e20 6f70 6572 6174 6f72 730a  ction operators.
+000118d0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+000118e0: 7365 6c65 6374 203d 3d20 2754 6f75 726e  select == 'Tourn
+000118f0: 616d 656e 7427 3a0a 2020 2020 2020 2020  ament':.        
+00011900: 2020 2020 746f 6f6c 626f 782e 7265 6769      toolbox.regi
+00011910: 7374 6572 2822 7365 6c65 6374 222c 2074  ster("select", t
+00011920: 6f6f 6c73 2e73 656c 546f 7572 6e61 6d65  ools.selTourname
+00011930: 6e74 2c20 746f 7572 6e73 697a 653d 7365  nt, tournsize=se
+00011940: 6c66 2e70 6172 616d 5b27 746f 7572 6e61  lf.param['tourna
+00011950: 6d65 6e74 5f73 697a 6527 5d29 0a20 2020  ment_size']).   
+00011960: 2020 2020 2065 6c69 6620 7365 6c66 2e73       elif self.s
+00011970: 656c 6563 7420 3d3d 2027 546f 7572 6e61  elect == 'Tourna
+00011980: 6d65 6e74 2d4c 6578 6963 6173 6527 3a0a  ment-Lexicase':.
+00011990: 2020 2020 2020 2020 2020 2020 746f 6f6c              tool
+000119a0: 626f 782e 7365 6c65 6374 203d 2070 6172  box.select = par
+000119b0: 7469 616c 2874 6f75 726e 616d 656e 745f  tial(tournament_
+000119c0: 6c65 7869 6361 7365 5f73 656c 6563 7469  lexicase_selecti
+000119d0: 6f6e 2c20 636f 6e66 6967 7572 6174 696f  on, configuratio
+000119e0: 6e3d 7365 6c66 2e73 656c 6563 7469 6f6e  n=self.selection
+000119f0: 5f63 6f6e 6669 6775 7261 7469 6f6e 290a  _configuration).
+00011a00: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
+00011a10: 662e 7365 6c65 6374 2e73 7461 7274 7377  f.select.startsw
+00011a20: 6974 6828 2754 6f75 726e 616d 656e 742d  ith('Tournament-
+00011a30: 2729 3a0a 2020 2020 2020 2020 2020 2020  '):.            
+00011a40: 746f 6f6c 626f 782e 7265 6769 7374 6572  toolbox.register
+00011a50: 2822 7365 6c65 6374 222c 2074 6f6f 6c73  ("select", tools
+00011a60: 2e73 656c 546f 7572 6e61 6d65 6e74 2c20  .selTournament, 
+00011a70: 746f 7572 6e73 697a 653d 696e 7428 7365  tournsize=int(se
+00011a80: 6c66 2e73 656c 6563 742e 7370 6c69 7428  lf.select.split(
+00011a90: 272d 2729 5b31 5d29 290a 2020 2020 2020  '-')[1])).      
+00011aa0: 2020 656c 6966 2073 656c 662e 7365 6c65    elif self.sele
+00011ab0: 6374 2e73 7461 7274 7377 6974 6828 2754  ct.startswith('T
+00011ac0: 6f75 726e 616d 656e 744e 6f76 656c 7479  ournamentNovelty
+00011ad0: 2729 3a0a 2020 2020 2020 2020 2020 2020  '):.            
+00011ae0: 746f 6f6c 626f 782e 7265 6769 7374 6572  toolbox.register
+00011af0: 2822 7365 6c65 6374 222c 2073 656c 546f  ("select", selTo
+00011b00: 7572 6e61 6d65 6e74 4e6f 7665 6c74 792c  urnamentNovelty,
+00011b10: 2074 6f75 726e 7369 7a65 3d69 6e74 2873   tournsize=int(s
+00011b20: 656c 662e 7365 6c65 6374 2e73 706c 6974  elf.select.split
+00011b30: 2827 2d27 295b 315d 2929 0a20 2020 2020  ('-')[1])).     
+00011b40: 2020 2065 6c69 6620 7365 6c66 2e73 656c     elif self.sel
+00011b50: 6563 742e 7374 6172 7473 7769 7468 2827  ect.startswith('
+00011b60: 546f 7572 6e61 6d65 6e74 506c 7573 2d27  TournamentPlus-'
+00011b70: 293a 0a20 2020 2020 2020 2020 2020 2074  ):.            t
+00011b80: 6f6f 6c62 6f78 2e72 6567 6973 7465 7228  oolbox.register(
+00011b90: 2273 656c 6563 7422 2c20 7365 6c54 6f75  "select", selTou
+00011ba0: 726e 616d 656e 7450 6c75 732c 2074 6f75  rnamentPlus, tou
+00011bb0: 726e 7369 7a65 3d69 6e74 2873 656c 662e  rnsize=int(self.
+00011bc0: 7365 6c65 6374 2e73 706c 6974 2827 2d27  select.split('-'
+00011bd0: 295b 315d 2929 0a20 2020 2020 2020 2065  )[1])).        e
+00011be0: 6c69 6620 7365 6c66 2e73 656c 6563 7420  lif self.select 
+00011bf0: 3d3d 2027 5374 6174 6973 7469 6373 546f  == 'StatisticsTo
+00011c00: 7572 6e61 6d65 6e74 273a 0a20 2020 2020  urnament':.     
+00011c10: 2020 2020 2020 2074 6f6f 6c62 6f78 2e72         toolbox.r
+00011c20: 6567 6973 7465 7228 2273 656c 6563 7422  egister("select"
+00011c30: 2c20 7365 6c53 7461 7469 7374 6963 7354  , selStatisticsT
+00011c40: 6f75 726e 616d 656e 742c 0a20 2020 2020  ournament,.     
+00011c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011c60: 2020 2020 2020 2020 746f 7572 6e73 697a          tournsiz
+00011c70: 653d 7365 6c66 2e62 6c6f 6174 5f63 6f6e  e=self.bloat_con
+00011c80: 7472 6f6c 2e67 6574 2827 6669 746e 6573  trol.get('fitnes
+00011c90: 735f 7369 7a65 272c 2037 2929 0a20 2020  s_size', 7)).   
+00011ca0: 2020 2020 2065 6c69 6620 7365 6c66 2e73       elif self.s
+00011cb0: 656c 6563 7420 3d3d 2027 4261 7463 6854  elect == 'BatchT
+00011cc0: 6f75 726e 616d 656e 7427 3a0a 2020 2020  ournament':.    
+00011cd0: 2020 2020 2020 2020 746f 6f6c 626f 782e          toolbox.
+00011ce0: 7265 6769 7374 6572 2822 7365 6c65 6374  register("select
+00011cf0: 222c 2062 6174 6368 5f74 6f75 726e 616d  ", batch_tournam
+00011d00: 656e 745f 7365 6c65 6374 696f 6e29 0a20  ent_selection). 
+00011d10: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
+00011d20: 2e73 656c 6563 7420 3d3d 2027 4c50 5027  .select == 'LPP'
+00011d30: 3a0a 2020 2020 2020 2020 2020 2020 746f  :.            to
+00011d40: 6f6c 626f 782e 7265 6769 7374 6572 2822  olbox.register("
+00011d50: 7365 6c65 6374 222c 2073 656c 4c65 7869  select", selLexi
+00011d60: 636f 6772 6170 6869 6350 6172 7369 6d6f  cographicParsimo
+00011d70: 6e79 5072 6573 7375 7265 290a 2020 2020  nyPressure).    
+00011d80: 2020 2020 656c 6966 2073 656c 662e 7365      elif self.se
+00011d90: 6c65 6374 2069 6e20 5b27 4175 746f 6d61  lect in ['Automa
+00011da0: 7469 634c 6578 6963 6173 6527 5d20 2b20  ticLexicase'] + 
+00011db0: 6d61 705f 656c 6974 655f 7365 7269 6573  map_elite_series
+00011dc0: 3a0a 2020 2020 2020 2020 2020 2020 746f  :.            to
+00011dd0: 6f6c 626f 782e 7265 6769 7374 6572 2822  olbox.register("
+00011de0: 7365 6c65 6374 222c 2073 656c 4175 746f  select", selAuto
+00011df0: 6d61 7469 6345 7073 696c 6f6e 4c65 7869  maticEpsilonLexi
+00011e00: 6361 7365 4661 7374 290a 2020 2020 2020  caseFast).      
+00011e10: 2020 656c 6966 2073 656c 662e 7365 6c65    elif self.sele
+00011e20: 6374 203d 3d20 2741 7574 6f6d 6174 6963  ct == 'Automatic
+00011e30: 4c65 7869 6361 7365 4661 7374 273a 0a20  LexicaseFast':. 
+00011e40: 2020 2020 2020 2020 2020 2074 6f6f 6c62             toolb
+00011e50: 6f78 2e72 6567 6973 7465 7228 2273 656c  ox.register("sel
+00011e60: 6563 7422 2c20 7365 6c41 7574 6f6d 6174  ect", selAutomat
+00011e70: 6963 4570 7369 6c6f 6e4c 6578 6963 6173  icEpsilonLexicas
+00011e80: 6546 6173 7429 0a20 2020 2020 2020 2065  eFast).        e
+00011e90: 6c69 6620 7365 6c66 2e73 656c 6563 7420  lif self.select 
+00011ea0: 3d3d 2027 446f 7562 6c65 4c65 7869 6361  == 'DoubleLexica
+00011eb0: 7365 273a 0a20 2020 2020 2020 2020 2020  se':.           
+00011ec0: 206c 6578 6963 6173 655f 726f 756e 6420   lexicase_round 
+00011ed0: 3d20 7365 6c66 2e62 6c6f 6174 5f63 6f6e  = self.bloat_con
+00011ee0: 7472 6f6c 2e67 6574 2822 6c65 7869 6361  trol.get("lexica
+00011ef0: 7365 5f72 6f75 6e64 222c 2032 290a 2020  se_round", 2).  
+00011f00: 2020 2020 2020 2020 2020 7369 7a65 5f73            size_s
+00011f10: 656c 6563 7469 6f6e 203d 2073 656c 662e  election = self.
+00011f20: 626c 6f61 745f 636f 6e74 726f 6c2e 6765  bloat_control.ge
+00011f30: 7428 2273 697a 655f 7365 6c65 6374 696f  t("size_selectio
+00011f40: 6e22 2c20 2752 6f75 6c65 7474 6527 290a  n", 'Roulette').
+00011f50: 0a20 2020 2020 2020 2020 2020 2064 6566  .            def
+00011f60: 2064 6f75 626c 654c 6578 6963 6173 6528   doubleLexicase(
+00011f70: 706f 702c 206b 293a 0a20 2020 2020 2020  pop, k):.       
+00011f80: 2020 2020 2020 2020 2063 686f 7365 6e20           chosen 
+00011f90: 3d20 5b5d 0a20 2020 2020 2020 2020 2020  = [].           
+00011fa0: 2020 2020 2066 6f72 205f 2069 6e20 7261       for _ in ra
+00011fb0: 6e67 6528 6b29 3a0a 2020 2020 2020 2020  nge(k):.        
+00011fc0: 2020 2020 2020 2020 2020 2020 6361 6e64              cand
+00011fd0: 6964 6174 6573 203d 2073 656c 4175 746f  idates = selAuto
+00011fe0: 6d61 7469 6345 7073 696c 6f6e 4c65 7869  maticEpsilonLexi
+00011ff0: 6361 7365 4661 7374 2870 6f70 2c20 6c65  caseFast(pop, le
+00012000: 7869 6361 7365 5f72 6f75 6e64 290a 2020  xicase_round).  
+00012010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012020: 2020 7369 7a65 5f61 7272 203d 206e 702e    size_arr = np.
+00012030: 6172 7261 7928 5b6c 656e 2878 2920 666f  array([len(x) fo
+00012040: 7220 7820 696e 2063 616e 6469 6461 7465  r x in candidate
+00012050: 735d 290a 2020 2020 2020 2020 2020 2020  s]).            
+00012060: 2020 2020 2020 2020 6966 2073 697a 655f          if size_
+00012070: 7365 6c65 6374 696f 6e20 3d3d 2027 526f  selection == 'Ro
+00012080: 756c 6574 7465 273a 0a20 2020 2020 2020  ulette':.       
+00012090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000120a0: 2073 697a 655f 6172 7220 3d20 6e70 2e6d   size_arr = np.m
+000120b0: 6178 2873 697a 655f 6172 7229 202b 206e  ax(size_arr) + n
+000120c0: 702e 6d69 6e28 7369 7a65 5f61 7272 2920  p.min(size_arr) 
+000120d0: 2d20 7369 7a65 5f61 7272 0a20 2020 2020  - size_arr.     
+000120e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000120f0: 2020 2069 6e64 6578 203d 206e 702e 7261     index = np.ra
+00012100: 6e64 6f6d 2e63 686f 6963 6528 5b69 2066  ndom.choice([i f
+00012110: 6f72 2069 2069 6e20 7261 6e67 6528 302c  or i in range(0,
+00012120: 206c 656e 2873 697a 655f 6172 7229 295d   len(size_arr))]
+00012130: 2c20 703d 7369 7a65 5f61 7272 202f 2073  , p=size_arr / s
+00012140: 697a 655f 6172 722e 7375 6d28 2929 0a20  ize_arr.sum()). 
+00012150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012160: 2020 2065 6c69 6620 7369 7a65 5f73 656c     elif size_sel
+00012170: 6563 7469 6f6e 203d 3d20 274d 696e 273a  ection == 'Min':
+00012180: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012190: 2020 2020 2020 2020 2069 6e64 6578 203d           index =
+000121a0: 206e 702e 6172 676d 696e 2873 697a 655f   np.argmin(size_
+000121b0: 6172 7229 0a20 2020 2020 2020 2020 2020  arr).           
+000121c0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+000121d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000121e0: 2020 2020 2020 2072 6169 7365 2045 7863         raise Exc
+000121f0: 6570 7469 6f6e 2827 556e 6b6e 6f77 6e20  eption('Unknown 
+00012200: 5369 7a65 2053 656c 6563 7469 6f6e 204f  Size Selection O
+00012210: 7065 7261 746f 7221 2729 0a20 2020 2020  perator!').     
+00012220: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00012230: 686f 7365 6e2e 6170 7065 6e64 2863 616e  hosen.append(can
+00012240: 6469 6461 7465 735b 696e 6465 785d 290a  didates[index]).
+00012250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012260: 7265 7475 726e 2063 686f 7365 6e0a 0a20  return chosen.. 
+00012270: 2020 2020 2020 2020 2020 2074 6f6f 6c62             toolb
+00012280: 6f78 2e72 6567 6973 7465 7228 2273 656c  ox.register("sel
+00012290: 6563 7422 2c20 646f 7562 6c65 4c65 7869  ect", doubleLexi
+000122a0: 6361 7365 290a 2020 2020 2020 2020 656c  case).        el
+000122b0: 6966 2073 656c 662e 7365 6c65 6374 203d  if self.select =
+000122c0: 3d20 2744 6f75 626c 6554 6f75 726e 616d  = 'DoubleTournam
+000122d0: 656e 7427 3a0a 2020 2020 2020 2020 2020  ent':.          
+000122e0: 2020 2320 7365 6c65 6374 2077 6974 6820    # select with 
+000122f0: 646f 7562 6c65 2074 6f75 726e 616d 656e  double tournamen
+00012300: 740a 2020 2020 2020 2020 2020 2020 746f  t.            to
+00012310: 6f6c 626f 782e 7265 6769 7374 6572 2822  olbox.register("
+00012320: 7365 6c65 6374 222c 2073 656c 446f 7562  select", selDoub
+00012330: 6c65 546f 7572 6e61 6d65 6e74 2c0a 2020  leTournament,.  
+00012340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012350: 2020 2020 2020 2020 2020 2066 6974 6e65             fitne
+00012360: 7373 5f73 697a 653d 7365 6c66 2e62 6c6f  ss_size=self.blo
+00012370: 6174 5f63 6f6e 7472 6f6c 2e67 6574 2827  at_control.get('
+00012380: 6669 746e 6573 735f 7369 7a65 272c 2037  fitness_size', 7
+00012390: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+000123a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000123b0: 7061 7273 696d 6f6e 795f 7369 7a65 3d73  parsimony_size=s
+000123c0: 656c 662e 626c 6f61 745f 636f 6e74 726f  elf.bloat_contro
+000123d0: 6c2e 6765 7428 2770 6172 7369 6d6f 6e79  l.get('parsimony
+000123e0: 5f73 697a 6527 2c20 312e 3429 2c0a 2020  _size', 1.4),.  
+000123f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012400: 2020 2020 2020 2020 2020 2066 6974 6e65             fitne
+00012410: 7373 5f66 6972 7374 3d54 7275 6529 0a20  ss_first=True). 
+00012420: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
+00012430: 2e73 656c 6563 7420 3d3d 2027 446f 7562  .select == 'Doub
+00012440: 6c65 526f 756e 6427 3a0a 2020 2020 2020  leRound':.      
+00012450: 2020 2020 2020 746f 6f6c 626f 782e 7265        toolbox.re
+00012460: 6769 7374 6572 2822 7365 6c65 6374 222c  gister("select",
+00012470: 2073 656c 446f 7562 6c65 526f 756e 6429   selDoubleRound)
+00012480: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
+00012490: 6c66 2e73 656c 6563 7420 3d3d 2027 446f  lf.select == 'Do
+000124a0: 7562 6c65 526f 756e 642d 5261 6e64 6f6d  ubleRound-Random
+000124b0: 273a 0a20 2020 2020 2020 2020 2020 2074  ':.            t
+000124c0: 6f6f 6c62 6f78 2e72 6567 6973 7465 7228  oolbox.register(
+000124d0: 2273 656c 6563 7422 2c20 7365 6c44 6f75  "select", selDou
+000124e0: 626c 6552 6f75 6e64 2c20 636f 756e 743d  bleRound, count=
+000124f0: 7365 6c66 2e70 6172 616d 5b27 646f 7562  self.param['doub
+00012500: 6c65 5f72 6f75 6e64 5f63 6f75 6e74 275d  le_round_count']
+00012510: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00012520: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00012530: 6173 655f 6f70 6572 6174 6f72 3d27 5261  ase_operator='Ra
+00012540: 6e64 6f6d 2729 0a20 2020 2020 2020 2065  ndom').        e
+00012550: 6c69 6620 7365 6c66 2e73 656c 6563 7420  lif self.select 
+00012560: 3d3d 2027 446f 7562 6c65 526f 756e 642d  == 'DoubleRound-
+00012570: 546f 7572 6e61 6d65 6e74 273a 0a20 2020  Tournament':.   
+00012580: 2020 2020 2020 2020 2074 6f6f 6c62 6f78           toolbox
+00012590: 2e72 6567 6973 7465 7228 2273 656c 6563  .register("selec
+000125a0: 7422 2c20 7365 6c44 6f75 626c 6552 6f75  t", selDoubleRou
+000125b0: 6e64 2c20 636f 756e 743d 7365 6c66 2e70  nd, count=self.p
+000125c0: 6172 616d 5b27 646f 7562 6c65 5f72 6f75  aram['double_rou
+000125d0: 6e64 5f63 6f75 6e74 275d 2c0a 2020 2020  nd_count'],.    
+000125e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000125f0: 2020 2020 2020 2020 2062 6173 655f 6f70           base_op
+00012600: 6572 6174 6f72 3d27 546f 7572 6e61 6d65  erator='Tourname
+00012610: 6e74 272c 0a20 2020 2020 2020 2020 2020  nt',.           
+00012620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012630: 2020 746f 7572 6e73 697a 653d 7365 6c66    tournsize=self
+00012640: 2e70 6172 616d 5b27 646f 7562 6c65 5f72  .param['double_r
+00012650: 6f75 6e64 5f74 6f75 726e 616d 656e 745f  ound_tournament_
+00012660: 7369 7a65 275d 290a 2020 2020 2020 2020  size']).        
+00012670: 656c 6966 2073 656c 662e 7365 6c65 6374  elif self.select
+00012680: 203d 3d20 2750 6172 7369 6d6f 6e69 6f75   == 'Parsimoniou
+00012690: 732d 446f 7562 6c65 526f 756e 642d 546f  s-DoubleRound-To
+000126a0: 7572 6e61 6d65 6e74 273a 0a20 2020 2020  urnament':.     
+000126b0: 2020 2020 2020 2074 6f6f 6c62 6f78 2e72         toolbox.r
+000126c0: 6567 6973 7465 7228 2273 656c 6563 7422  egister("select"
+000126d0: 2c20 7365 6c44 6f75 626c 6552 6f75 6e64  , selDoubleRound
+000126e0: 2c20 636f 756e 743d 7365 6c66 2e70 6172  , count=self.par
+000126f0: 616d 5b27 646f 7562 6c65 5f72 6f75 6e64  am['double_round
+00012700: 5f63 6f75 6e74 275d 2c0a 2020 2020 2020  _count'],.      
+00012710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012720: 2020 2020 2020 2062 6173 655f 6f70 6572         base_oper
+00012730: 6174 6f72 3d27 546f 7572 6e61 6d65 6e74  ator='Tournament
+00012740: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+00012750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012760: 746f 7572 6e73 697a 653d 7365 6c66 2e70  tournsize=self.p
+00012770: 6172 616d 5b27 646f 7562 6c65 5f72 6f75  aram['double_rou
+00012780: 6e64 5f74 6f75 726e 616d 656e 745f 7369  nd_tournament_si
+00012790: 7a65 275d 2c0a 2020 2020 2020 2020 2020  ze'],.          
+000127a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000127b0: 2020 2070 6172 7369 6d6f 6e69 6f75 733d     parsimonious=
+000127c0: 5472 7565 290a 2020 2020 2020 2020 656c  True).        el
+000127d0: 6966 2073 656c 662e 7365 6c65 6374 203d  if self.select =
+000127e0: 3d20 2752 616e 646f 6d50 6c75 7327 3a0a  = 'RandomPlus':.
+000127f0: 2020 2020 2020 2020 2020 2020 746f 6f6c              tool
+00012800: 626f 782e 7265 6769 7374 6572 2822 7365  box.register("se
+00012810: 6c65 6374 222c 2073 656c 5261 6e64 6f6d  lect", selRandom
+00012820: 506c 7573 290a 2020 2020 2020 2020 656c  Plus).        el
+00012830: 6966 2073 656c 662e 7365 6c65 6374 203d  if self.select =
+00012840: 3d20 2742 6167 6769 6e67 273a 0a20 2020  = 'Bagging':.   
+00012850: 2020 2020 2020 2020 2074 6f6f 6c62 6f78           toolbox
+00012860: 2e72 6567 6973 7465 7228 2273 656c 6563  .register("selec
+00012870: 7422 2c20 7365 6c42 6167 6769 6e67 290a  t", selBagging).
+00012880: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
+00012890: 662e 7365 6c65 6374 203d 3d20 2741 7574  f.select == 'Aut
+000128a0: 6f6d 6174 6963 4c65 7869 6361 7365 4b27  omaticLexicaseK'
+000128b0: 3a0a 2020 2020 2020 2020 2020 2020 746f  :.            to
+000128c0: 6f6c 626f 782e 7265 6769 7374 6572 2822  olbox.register("
+000128d0: 7365 6c65 6374 222c 2073 656c 4175 746f  select", selAuto
+000128e0: 6d61 7469 6345 7073 696c 6f6e 4c65 7869  maticEpsilonLexi
+000128f0: 6361 7365 4b29 0a20 2020 2020 2020 2065  caseK).        e
+00012900: 6c69 6620 7365 6c66 2e73 656c 6563 7420  lif self.select 
+00012910: 3d3d 2027 4750 4544 273a 0a20 2020 2020  == 'GPED':.     
+00012920: 2020 2020 2020 2074 6f6f 6c62 6f78 2e72         toolbox.r
+00012930: 6567 6973 7465 7228 2273 656c 6563 7422  egister("select"
+00012940: 2c20 7365 6c47 5045 4429 0a20 2020 2020  , selGPED).     
+00012950: 2020 2065 6c69 6620 7365 6c66 2e73 656c     elif self.sel
+00012960: 6563 7420 3d3d 2027 4d61 7841 6e67 6c65  ect == 'MaxAngle
+00012970: 5365 6c65 6374 696f 6e27 3a0a 2020 2020  Selection':.    
+00012980: 2020 2020 2020 2020 746f 6f6c 626f 782e          toolbox.
+00012990: 7265 6769 7374 6572 2822 7365 6c65 6374  register("select
+000129a0: 222c 2073 656c 4d61 7841 6e67 6c65 5365  ", selMaxAngleSe
+000129b0: 6c65 6374 696f 6e2c 2074 6172 6765 743d  lection, target=
+000129c0: 7365 6c66 2e79 290a 2020 2020 2020 2020  self.y).        
+000129d0: 656c 6966 2073 656c 662e 7365 6c65 6374  elif self.select
+000129e0: 203d 3d20 2741 6e67 6c65 4472 6976 656e   == 'AngleDriven
+000129f0: 5365 6c65 6374 696f 6e27 3a0a 2020 2020  Selection':.    
+00012a00: 2020 2020 2020 2020 746f 6f6c 626f 782e          toolbox.
+00012a10: 7265 6769 7374 6572 2822 7365 6c65 6374  register("select
+00012a20: 222c 2073 656c 416e 676c 6544 7269 7665  ", selAngleDrive
+00012a30: 6e53 656c 6563 7469 6f6e 2c20 7461 7267  nSelection, targ
+00012a40: 6574 3d73 656c 662e 7929 0a20 2020 2020  et=self.y).     
+00012a50: 2020 2065 6c69 6620 7365 6c66 2e73 656c     elif self.sel
+00012a60: 6563 7420 3d3d 2027 4b6e 6f63 6b6f 7574  ect == 'Knockout
+00012a70: 273a 0a20 2020 2020 2020 2020 2020 2074  ':.            t
+00012a80: 6f6f 6c62 6f78 2e72 6567 6973 7465 7228  oolbox.register(
+00012a90: 2273 656c 6563 7422 2c20 7365 6c4b 6e6f  "select", selKno
+00012aa0: 636b 6f75 7429 0a20 2020 2020 2020 2065  ckout).        e
+00012ab0: 6c69 6620 7365 6c66 2e73 656c 6563 7420  lif self.select 
+00012ac0: 3d3d 2027 4b6e 6f63 6b6f 7574 2d41 273a  == 'Knockout-A':
+00012ad0: 0a20 2020 2020 2020 2020 2020 2074 6f6f  .            too
+00012ae0: 6c62 6f78 2e72 6567 6973 7465 7228 2273  lbox.register("s
+00012af0: 656c 6563 7422 2c20 7365 6c4b 6e6f 636b  elect", selKnock
+00012b00: 6f75 742c 2061 7574 6f5f 6361 7365 3d54  out, auto_case=T
+00012b10: 7275 6529 0a20 2020 2020 2020 2065 6c69  rue).        eli
+00012b20: 6620 7365 6c66 2e73 656c 6563 7420 3d3d  f self.select ==
+00012b30: 2027 4b6e 6f63 6b6f 7574 2d53 273a 0a20   'Knockout-S':. 
+00012b40: 2020 2020 2020 2020 2020 2074 6f6f 6c62             toolb
+00012b50: 6f78 2e72 6567 6973 7465 7228 2273 656c  ox.register("sel
+00012b60: 6563 7422 2c20 7365 6c4b 6e6f 636b 6f75  ect", selKnockou
+00012b70: 742c 2076 6572 7369 6f6e 3d27 5327 290a  t, version='S').
+00012b80: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
+00012b90: 662e 7365 6c65 6374 203d 3d20 274b 6e6f  f.select == 'Kno
+00012ba0: 636b 6f75 742d 5341 273a 0a20 2020 2020  ckout-SA':.     
+00012bb0: 2020 2020 2020 2074 6f6f 6c62 6f78 2e72         toolbox.r
+00012bc0: 6567 6973 7465 7228 2273 656c 6563 7422  egister("select"
+00012bd0: 2c20 7365 6c4b 6e6f 636b 6f75 742c 2076  , selKnockout, v
+00012be0: 6572 7369 6f6e 3d27 5327 2c20 6175 746f  ersion='S', auto
+00012bf0: 5f63 6173 653d 5472 7565 290a 2020 2020  _case=True).    
+00012c00: 2020 2020 656c 6966 2073 656c 662e 7365      elif self.se
+00012c10: 6c65 6374 2069 6e20 5b27 5261 6e64 6f6d  lect in ['Random
+00012c20: 275d 3a0a 2020 2020 2020 2020 2020 2020  ']:.            
+00012c30: 746f 6f6c 626f 782e 7265 6769 7374 6572  toolbox.register
+00012c40: 2822 7365 6c65 6374 222c 2073 656c 5261  ("select", selRa
+00012c50: 6e64 6f6d 290a 2020 2020 2020 2020 656c  ndom).        el
+00012c60: 6966 2073 656c 662e 7365 6c65 6374 203d  if self.select =
+00012c70: 3d20 2748 7962 7269 6427 3a0a 2020 2020  = 'Hybrid':.    
+00012c80: 2020 2020 2020 2020 746f 6f6c 626f 782e          toolbox.
+00012c90: 7265 6769 7374 6572 2822 7365 6c65 6374  register("select
+00012ca0: 222c 2073 656c 4879 6272 6964 290a 2020  ", selHybrid).  
+00012cb0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00012cc0: 2020 2020 2020 2020 7261 6973 6520 4578          raise Ex
+00012cd0: 6365 7074 696f 6e0a 0a20 2020 2064 6566  ception..    def
+00012ce0: 2070 7269 6d69 7469 7665 5f69 6e69 7469   primitive_initi
+00012cf0: 616c 697a 6174 696f 6e28 7365 6c66 2c20  alization(self, 
+00012d00: 7829 3a0a 2020 2020 2020 2020 2320 696e  x):.        # in
+00012d10: 6974 6961 6c69 7a65 2074 6865 2070 7269  itialize the pri
+00012d20: 6d69 7469 7665 2073 6574 0a20 2020 2020  mitive set.     
+00012d30: 2020 2069 6620 7365 6c66 2e62 6173 6963     if self.basic
+00012d40: 5f70 7269 6d69 7469 7665 7320 3d3d 2027  _primitives == '
+00012d50: 5374 726f 6e67 5479 7065 6427 3a0a 2020  StrongTyped':.  
+00012d60: 2020 2020 2020 2020 2020 6665 6174 7572            featur
+00012d70: 655f 7479 7065 7320 3d20 7365 6c66 2e66  e_types = self.f
+00012d80: 6561 7475 7265 5f74 7970 6573 0a20 2020  eature_types.   
+00012d90: 2020 2020 2020 2020 2070 7365 7420 3d20           pset = 
+00012da0: 6770 2e50 7269 6d69 7469 7665 5365 7454  gp.PrimitiveSetT
+00012db0: 7970 6564 2822 4d41 494e 222c 2066 6561  yped("MAIN", fea
+00012dc0: 7475 7265 5f74 7970 6573 2c20 4765 6e65  ture_types, Gene
+00012dd0: 7261 6c46 6561 7475 7265 290a 2020 2020  ralFeature).    
+00012de0: 2020 2020 2020 2020 6861 735f 6e75 6d65          has_nume
+00012df0: 7269 6361 6c5f 6665 6174 7572 6520 3d20  rical_feature = 
+00012e00: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
+00012e10: 2020 666f 7220 7820 696e 2066 6561 7475    for x in featu
+00012e20: 7265 5f74 7970 6573 3a0a 2020 2020 2020  re_types:.      
+00012e30: 2020 2020 2020 2020 2020 6966 2078 203d            if x =
+00012e40: 3d20 4e75 6d65 7269 6361 6c46 6561 7475  = NumericalFeatu
+00012e50: 7265 3a0a 2020 2020 2020 2020 2020 2020  re:.            
+00012e60: 2020 2020 2020 2020 6861 735f 6e75 6d65          has_nume
+00012e70: 7269 6361 6c5f 6665 6174 7572 6520 3d20  rical_feature = 
+00012e80: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
+00012e90: 2068 6173 5f63 6174 6567 6f72 6963 616c   has_categorical
+00012ea0: 5f66 6561 7475 7265 203d 2046 616c 7365  _feature = False
+00012eb0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00012ec0: 2078 2069 6e20 6665 6174 7572 655f 7479   x in feature_ty
+00012ed0: 7065 733a 0a20 2020 2020 2020 2020 2020  pes:.           
+00012ee0: 2020 2020 2069 6620 7820 3d3d 2043 6174       if x == Cat
+00012ef0: 6567 6f72 6963 616c 4665 6174 7572 653a  egoricalFeature:
+00012f00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012f10: 2020 2020 2068 6173 5f63 6174 6567 6f72       has_categor
+00012f20: 6963 616c 5f66 6561 7475 7265 203d 2054  ical_feature = T
+00012f30: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
+00012f40: 6861 735f 626f 6f6c 6561 6e5f 6665 6174  has_boolean_feat
+00012f50: 7572 6520 3d20 4661 6c73 650a 2020 2020  ure = False.    
+00012f60: 2020 2020 2020 2020 666f 7220 7820 696e          for x in
+00012f70: 2066 6561 7475 7265 5f74 7970 6573 3a0a   feature_types:.
+00012f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012f90: 6966 2078 203d 3d20 426f 6f6c 6561 6e46  if x == BooleanF
+00012fa0: 6561 7475 7265 3a0a 2020 2020 2020 2020  eature:.        
+00012fb0: 2020 2020 2020 2020 2020 2020 6861 735f              has_
+00012fc0: 626f 6f6c 6561 6e5f 6665 6174 7572 6520  boolean_feature 
+00012fd0: 3d20 5472 7565 0a20 2020 2020 2020 2020  = True.         
+00012fe0: 2020 2069 6620 6861 735f 6e75 6d65 7269     if has_numeri
+00012ff0: 6361 6c5f 6665 6174 7572 653a 0a20 2020  cal_feature:.   
+00013000: 2020 2020 2020 2020 2020 2020 2070 7365               pse
+00013010: 742e 6164 6450 7269 6d69 7469 7665 286e  t.addPrimitive(n
+00013020: 702e 6164 642c 205b 4e75 6d65 7269 6361  p.add, [Numerica
+00013030: 6c46 6561 7475 7265 2c20 4e75 6d65 7269  lFeature, Numeri
+00013040: 6361 6c46 6561 7475 7265 5d2c 204e 756d  calFeature], Num
+00013050: 6572 6963 616c 4665 6174 7572 6529 0a20  ericalFeature). 
+00013060: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00013070: 7365 742e 6164 6450 7269 6d69 7469 7665  set.addPrimitive
+00013080: 286e 702e 7375 6274 7261 6374 2c20 5b4e  (np.subtract, [N
+00013090: 756d 6572 6963 616c 4665 6174 7572 652c  umericalFeature,
+000130a0: 204e 756d 6572 6963 616c 4665 6174 7572   NumericalFeatur
+000130b0: 655d 2c20 4e75 6d65 7269 6361 6c46 6561  e], NumericalFea
+000130c0: 7475 7265 290a 2020 2020 2020 2020 2020  ture).          
+000130d0: 2020 2020 2020 7073 6574 2e61 6464 5072        pset.addPr
+000130e0: 696d 6974 6976 6528 6e70 2e6d 756c 7469  imitive(np.multi
+000130f0: 706c 792c 205b 4e75 6d65 7269 6361 6c46  ply, [NumericalF
+00013100: 6561 7475 7265 2c20 4e75 6d65 7269 6361  eature, Numerica
+00013110: 6c46 6561 7475 7265 5d2c 204e 756d 6572  lFeature], Numer
+00013120: 6963 616c 4665 6174 7572 6529 0a20 2020  icalFeature).   
+00013130: 2020 2020 2020 2020 2020 2020 2070 7365               pse
+00013140: 742e 6164 6450 7269 6d69 7469 7665 2861  t.addPrimitive(a
+00013150: 6e61 6c79 7469 6361 6c5f 7175 6f74 6965  nalytical_quotie
+00013160: 6e74 2c20 5b4e 756d 6572 6963 616c 4665  nt, [NumericalFe
+00013170: 6174 7572 652c 204e 756d 6572 6963 616c  ature, Numerical
+00013180: 4665 6174 7572 655d 2c20 4e75 6d65 7269  Feature], Numeri
+00013190: 6361 6c46 6561 7475 7265 290a 2020 2020  calFeature).    
+000131a0: 2020 2020 2020 2020 2020 2020 7073 6574              pset
+000131b0: 2e61 6464 5072 696d 6974 6976 6528 6e70  .addPrimitive(np
+000131c0: 2e6d 6178 696d 756d 2c20 5b4e 756d 6572  .maximum, [Numer
+000131d0: 6963 616c 4665 6174 7572 652c 204e 756d  icalFeature, Num
+000131e0: 6572 6963 616c 4665 6174 7572 655d 2c20  ericalFeature], 
+000131f0: 4e75 6d65 7269 6361 6c46 6561 7475 7265  NumericalFeature
+00013200: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00013210: 2020 7073 6574 2e61 6464 5072 696d 6974    pset.addPrimit
+00013220: 6976 6528 6e70 2e6d 696e 696d 756d 2c20  ive(np.minimum, 
+00013230: 5b4e 756d 6572 6963 616c 4665 6174 7572  [NumericalFeatur
+00013240: 652c 204e 756d 6572 6963 616c 4665 6174  e, NumericalFeat
+00013250: 7572 655d 2c20 4e75 6d65 7269 6361 6c46  ure], NumericalF
+00013260: 6561 7475 7265 290a 2020 2020 2020 2020  eature).        
+00013270: 2020 2020 2020 2020 7073 6574 2e61 6464          pset.add
+00013280: 5072 696d 6974 6976 6528 6e70 2e73 696e  Primitive(np.sin
+00013290: 2c20 5b4e 756d 6572 6963 616c 4665 6174  , [NumericalFeat
+000132a0: 7572 655d 2c20 4e75 6d65 7269 6361 6c46  ure], NumericalF
+000132b0: 6561 7475 7265 290a 2020 2020 2020 2020  eature).        
+000132c0: 2020 2020 2020 2020 7073 6574 2e61 6464          pset.add
+000132d0: 5072 696d 6974 6976 6528 6e70 2e63 6f73  Primitive(np.cos
+000132e0: 2c20 5b4e 756d 6572 6963 616c 4665 6174  , [NumericalFeat
+000132f0: 7572 655d 2c20 4e75 6d65 7269 6361 6c46  ure], NumericalF
+00013300: 6561 7475 7265 290a 2020 2020 2020 2020  eature).        
+00013310: 2020 2020 2020 2020 7073 6574 2e61 6464          pset.add
+00013320: 5072 696d 6974 6976 6528 5f70 726f 7465  Primitive(_prote
+00013330: 6374 6564 5f73 7172 742c 205b 4e75 6d65  cted_sqrt, [Nume
+00013340: 7269 6361 6c46 6561 7475 7265 5d2c 204e  ricalFeature], N
+00013350: 756d 6572 6963 616c 4665 6174 7572 6529  umericalFeature)
+00013360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013370: 2070 7365 742e 6164 6450 7269 6d69 7469   pset.addPrimiti
+00013380: 7665 2869 6465 6e74 6963 616c 5f6e 756d  ve(identical_num
+00013390: 6572 6963 616c 2c20 5b4e 756d 6572 6963  erical, [Numeric
+000133a0: 616c 4665 6174 7572 655d 2c20 4765 6e65  alFeature], Gene
+000133b0: 7261 6c46 6561 7475 7265 290a 2020 2020  ralFeature).    
+000133c0: 2020 2020 2020 2020 6966 2068 6173 5f63          if has_c
+000133d0: 6174 6567 6f72 6963 616c 5f66 6561 7475  ategorical_featu
+000133e0: 7265 3a0a 2020 2020 2020 2020 2020 2020  re:.            
+000133f0: 2020 2020 7073 6574 2e61 6464 5072 696d      pset.addPrim
+00013400: 6974 6976 6528 6e70 5f62 6974 5f77 7261  itive(np_bit_wra
+00013410: 7070 6572 286e 702e 6269 7477 6973 655f  pper(np.bitwise_
+00013420: 616e 6429 2c20 5b43 6174 6567 6f72 6963  and), [Categoric
+00013430: 616c 4665 6174 7572 652c 2043 6174 6567  alFeature, Categ
+00013440: 6f72 6963 616c 4665 6174 7572 655d 2c0a  oricalFeature],.
+00013450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013470: 2020 4361 7465 676f 7269 6361 6c46 6561    CategoricalFea
+00013480: 7475 7265 290a 2020 2020 2020 2020 2020  ture).          
+00013490: 2020 2020 2020 7073 6574 2e61 6464 5072        pset.addPr
+000134a0: 696d 6974 6976 6528 6e70 5f62 6974 5f77  imitive(np_bit_w
+000134b0: 7261 7070 6572 286e 702e 6269 7477 6973  rapper(np.bitwis
+000134c0: 655f 6f72 292c 205b 4361 7465 676f 7269  e_or), [Categori
+000134d0: 6361 6c46 6561 7475 7265 2c20 4361 7465  calFeature, Cate
+000134e0: 676f 7269 6361 6c46 6561 7475 7265 5d2c  goricalFeature],
+000134f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013510: 2020 2043 6174 6567 6f72 6963 616c 4665     CategoricalFe
+00013520: 6174 7572 6529 0a20 2020 2020 2020 2020  ature).         
+00013530: 2020 2020 2020 2070 7365 742e 6164 6450         pset.addP
+00013540: 7269 6d69 7469 7665 286e 705f 6269 745f  rimitive(np_bit_
+00013550: 7772 6170 7065 7228 6e70 2e62 6974 7769  wrapper(np.bitwi
+00013560: 7365 5f78 6f72 292c 205b 4361 7465 676f  se_xor), [Catego
+00013570: 7269 6361 6c46 6561 7475 7265 2c20 4361  ricalFeature, Ca
+00013580: 7465 676f 7269 6361 6c46 6561 7475 7265  tegoricalFeature
+00013590: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+000135a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000135b0: 2020 2020 2043 6174 6567 6f72 6963 616c       Categorical
+000135c0: 4665 6174 7572 6529 0a20 2020 2020 2020  Feature).       
+000135d0: 2020 2020 2020 2020 2070 7365 742e 6164           pset.ad
+000135e0: 6450 7269 6d69 7469 7665 2869 6465 6e74  dPrimitive(ident
+000135f0: 6963 616c 5f63 6174 6567 6f72 6963 616c  ical_categorical
+00013600: 2c20 5b43 6174 6567 6f72 6963 616c 4665  , [CategoricalFe
+00013610: 6174 7572 655d 2c20 4765 6e65 7261 6c46  ature], GeneralF
+00013620: 6561 7475 7265 290a 2020 2020 2020 2020  eature).        
+00013630: 2020 2020 6966 2068 6173 5f62 6f6f 6c65      if has_boole
+00013640: 616e 5f66 6561 7475 7265 3a0a 2020 2020  an_feature:.    
+00013650: 2020 2020 2020 2020 2020 2020 6966 2068              if h
+00013660: 6173 5f6e 756d 6572 6963 616c 5f66 6561  as_numerical_fea
+00013670: 7475 7265 3a0a 2020 2020 2020 2020 2020  ture:.          
+00013680: 2020 2020 2020 2020 2020 7073 6574 2e61            pset.a
+00013690: 6464 5072 696d 6974 6976 6528 6e70 2e67  ddPrimitive(np.g
+000136a0: 7265 6174 6572 2c20 5b4e 756d 6572 6963  reater, [Numeric
+000136b0: 616c 4665 6174 7572 652c 204e 756d 6572  alFeature, Numer
+000136c0: 6963 616c 4665 6174 7572 655d 2c20 426f  icalFeature], Bo
+000136d0: 6f6c 6561 6e46 6561 7475 7265 290a 2020  oleanFeature).  
+000136e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000136f0: 2020 7073 6574 2e61 6464 5072 696d 6974    pset.addPrimit
+00013700: 6976 6528 6e70 2e6c 6573 732c 205b 4e75  ive(np.less, [Nu
+00013710: 6d65 7269 6361 6c46 6561 7475 7265 2c20  mericalFeature, 
+00013720: 4e75 6d65 7269 6361 6c46 6561 7475 7265  NumericalFeature
+00013730: 5d2c 2042 6f6f 6c65 616e 4665 6174 7572  ], BooleanFeatur
+00013740: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
+00013750: 2020 2070 7365 742e 6164 6450 7269 6d69     pset.addPrimi
+00013760: 7469 7665 286e 702e 6c6f 6769 6361 6c5f  tive(np.logical_
+00013770: 616e 642c 205b 426f 6f6c 6561 6e46 6561  and, [BooleanFea
+00013780: 7475 7265 2c20 426f 6f6c 6561 6e46 6561  ture, BooleanFea
+00013790: 7475 7265 5d2c 2042 6f6f 6c65 616e 4665  ture], BooleanFe
+000137a0: 6174 7572 6529 0a20 2020 2020 2020 2020  ature).         
+000137b0: 2020 2020 2020 2070 7365 742e 6164 6450         pset.addP
+000137c0: 7269 6d69 7469 7665 286e 702e 6c6f 6769  rimitive(np.logi
+000137d0: 6361 6c5f 6f72 2c20 5b42 6f6f 6c65 616e  cal_or, [Boolean
+000137e0: 4665 6174 7572 652c 2042 6f6f 6c65 616e  Feature, Boolean
+000137f0: 4665 6174 7572 655d 2c20 426f 6f6c 6561  Feature], Boolea
+00013800: 6e46 6561 7475 7265 290a 2020 2020 2020  nFeature).      
+00013810: 2020 2020 2020 2020 2020 7073 6574 2e61            pset.a
+00013820: 6464 5072 696d 6974 6976 6528 6e70 2e6c  ddPrimitive(np.l
+00013830: 6f67 6963 616c 5f78 6f72 2c20 5b42 6f6f  ogical_xor, [Boo
+00013840: 6c65 616e 4665 6174 7572 652c 2042 6f6f  leanFeature, Boo
+00013850: 6c65 616e 4665 6174 7572 655d 2c20 426f  leanFeature], Bo
+00013860: 6f6c 6561 6e46 6561 7475 7265 290a 2020  oleanFeature).  
+00013870: 2020 2020 2020 2020 2020 2020 2020 7073                ps
+00013880: 6574 2e61 6464 5072 696d 6974 6976 6528  et.addPrimitive(
+00013890: 6964 656e 7469 6361 6c5f 626f 6f6c 6561  identical_boolea
+000138a0: 6e2c 205b 426f 6f6c 6561 6e46 6561 7475  n, [BooleanFeatu
+000138b0: 7265 5d2c 2047 656e 6572 616c 4665 6174  re], GeneralFeat
+000138c0: 7572 6529 0a20 2020 2020 2020 2065 6c69  ure).        eli
+000138d0: 6620 7365 6c66 2e62 6173 6963 5f70 7269  f self.basic_pri
+000138e0: 6d69 7469 7665 7320 3d3d 2027 6578 7465  mitives == 'exte
+000138f0: 6e64 273a 0a20 2020 2020 2020 2020 2020  nd':.           
+00013900: 2070 7365 7420 3d20 5072 696d 6974 6976   pset = Primitiv
+00013910: 6553 6574 2822 4d41 494e 222c 2078 2e73  eSet("MAIN", x.s
+00013920: 6861 7065 5b31 5d29 0a20 2020 2020 2020  hape[1]).       
+00013930: 2020 2020 2061 6464 5f62 6173 6963 5f6f       add_basic_o
+00013940: 7065 7261 746f 7273 2870 7365 7429 0a20  perators(pset). 
+00013950: 2020 2020 2020 2020 2020 2061 6464 5f65             add_e
+00013960: 7874 656e 645f 6f70 6572 6174 6f72 7328  xtend_operators(
+00013970: 7073 6574 290a 2020 2020 2020 2020 656c  pset).        el
+00013980: 6966 2073 656c 662e 6261 7369 635f 7072  if self.basic_pr
+00013990: 696d 6974 6976 6573 203d 3d20 2765 7874  imitives == 'ext
+000139a0: 656e 642d 7472 6970 6c65 273a 0a20 2020  end-triple':.   
+000139b0: 2020 2020 2020 2020 2070 7365 7420 3d20           pset = 
+000139c0: 5072 696d 6974 6976 6553 6574 2822 4d41  PrimitiveSet("MA
+000139d0: 494e 222c 2078 2e73 6861 7065 5b31 5d29  IN", x.shape[1])
+000139e0: 0a20 2020 2020 2020 2020 2020 2061 6464  .            add
+000139f0: 5f62 6173 6963 5f6f 7065 7261 746f 7273  _basic_operators
+00013a00: 2870 7365 7429 0a20 2020 2020 2020 2020  (pset).         
+00013a10: 2020 2061 6464 5f65 7874 656e 645f 6f70     add_extend_op
+00013a20: 6572 6174 6f72 7328 7073 6574 2c20 7472  erators(pset, tr
+00013a30: 6970 6c65 5f67 726f 7570 6279 5f6f 7065  iple_groupby_ope
+00013a40: 7261 746f 7273 3d54 7275 6529 0a20 2020  rators=True).   
+00013a50: 2020 2020 2065 6c69 6620 7365 6c66 2e62       elif self.b
+00013a60: 6173 6963 5f70 7269 6d69 7469 7665 7320  asic_primitives 
+00013a70: 3d3d 2027 6578 7465 6e64 2d73 696d 706c  == 'extend-simpl
+00013a80: 6527 3a0a 2020 2020 2020 2020 2020 2020  e':.            
+00013a90: 7073 6574 203d 2050 7269 6d69 7469 7665  pset = Primitive
+00013aa0: 5365 7428 224d 4149 4e22 2c20 782e 7368  Set("MAIN", x.sh
+00013ab0: 6170 655b 315d 290a 2020 2020 2020 2020  ape[1]).        
+00013ac0: 2020 2020 6164 645f 6261 7369 635f 6f70      add_basic_op
+00013ad0: 6572 6174 6f72 7328 7073 6574 290a 2020  erators(pset).  
+00013ae0: 2020 2020 2020 2020 2020 6164 645f 6578            add_ex
+00013af0: 7465 6e64 5f6f 7065 7261 746f 7273 2870  tend_operators(p
+00013b00: 7365 742c 2067 726f 7570 6279 5f6f 7065  set, groupby_ope
+00013b10: 7261 746f 7273 3d46 616c 7365 290a 2020  rators=False).  
+00013b20: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
+00013b30: 7461 6e63 6528 7365 6c66 2e62 6173 6963  tance(self.basic
+00013b40: 5f70 7269 6d69 7469 7665 732c 2073 7472  _primitives, str
+00013b50: 2920 616e 6420 276f 7074 696d 616c 2720  ) and 'optimal' 
+00013b60: 696e 2073 656c 662e 6261 7369 635f 7072  in self.basic_pr
+00013b70: 696d 6974 6976 6573 3a0a 2020 2020 2020  imitives:.      
+00013b80: 2020 2020 2020 7073 6574 203d 2050 7269        pset = Pri
+00013b90: 6d69 7469 7665 5365 7428 224d 4149 4e22  mitiveSet("MAIN"
+00013ba0: 2c20 782e 7368 6170 655b 315d 290a 2020  , x.shape[1]).  
+00013bb0: 2020 2020 2020 2020 2020 2320 7375 7070            # supp
+00013bc0: 6f72 7420 6d75 6c74 6976 6172 6961 7465  ort multivariate
+00013bd0: 2066 756e 6374 696f 6e73 0a20 2020 2020   functions.     
+00013be0: 2020 2020 2020 2063 6f75 6e74 203d 2030         count = 0
+00013bf0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00013c00: 272d 2720 696e 2073 656c 662e 6261 7369  '-' in self.basi
+00013c10: 635f 7072 696d 6974 6976 6573 3a0a 2020  c_primitives:.  
+00013c20: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00013c30: 756e 7420 3d20 696e 7428 7365 6c66 2e62  unt = int(self.b
+00013c40: 6173 6963 5f70 7269 6d69 7469 7665 732e  asic_primitives.
+00013c50: 7370 6c69 7428 272d 2729 5b31 5d29 0a0a  split('-')[1])..
+00013c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013c70: 6465 6620 6e70 5f61 6464 5f6d 756c 7469  def np_add_multi
+00013c80: 706c 6528 2a61 7267 293a 0a20 2020 2020  ple(*arg):.     
+00013c90: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00013ca0: 6574 7572 6e20 6e70 2e73 756d 2861 7267  eturn np.sum(arg
+00013cb0: 2c20 6178 6973 3d30 290a 0a20 2020 2020  , axis=0)..     
+00013cc0: 2020 2020 2020 2020 2020 2064 6566 206e             def n
+00013cd0: 705f 6d61 785f 6d75 6c74 6970 6c65 282a  p_max_multiple(*
+00013ce0: 6172 6729 3a0a 2020 2020 2020 2020 2020  arg):.          
+00013cf0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00013d00: 206e 702e 6d61 7828 6172 672c 2061 7869   np.max(arg, axi
+00013d10: 733d 3029 0a0a 2020 2020 2020 2020 2020  s=0)..          
+00013d20: 2020 2020 2020 6465 6620 6e70 5f6d 696e        def np_min
+00013d30: 5f6d 756c 7469 706c 6528 2a61 7267 293a  _multiple(*arg):
+00013d40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013d50: 2020 2020 2072 6574 7572 6e20 6e70 2e6d       return np.m
+00013d60: 696e 2861 7267 2c20 6178 6973 3d30 290a  in(arg, axis=0).
+00013d70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013d80: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+00013d90: 332c 2063 6f75 6e74 202b 2031 293a 0a20  3, count + 1):. 
+00013da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013db0: 2020 206e 705f 6164 645f 6d75 6c74 6970     np_add_multip
+00013dc0: 6c65 2e5f 5f6e 616d 655f 5f20 3d20 6627  le.__name__ = f'
+00013dd0: 6e70 5f61 6464 5f6d 756c 7469 706c 655f  np_add_multiple_
+00013de0: 7b69 7d27 0a20 2020 2020 2020 2020 2020  {i}'.           
+00013df0: 2020 2020 2020 2020 206e 705f 6d61 785f           np_max_
+00013e00: 6d75 6c74 6970 6c65 2e5f 5f6e 616d 655f  multiple.__name_
+00013e10: 5f20 3d20 6627 6e70 5f6d 6178 5f6d 756c  _ = f'np_max_mul
+00013e20: 7469 706c 655f 7b69 7d27 0a20 2020 2020  tiple_{i}'.     
+00013e30: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00013e40: 705f 6d69 6e5f 6d75 6c74 6970 6c65 2e5f  p_min_multiple._
+00013e50: 5f6e 616d 655f 5f20 3d20 6627 6e70 5f6d  _name__ = f'np_m
+00013e60: 696e 5f6d 756c 7469 706c 655f 7b69 7d27  in_multiple_{i}'
+00013e70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013e80: 2020 2020 2070 7365 742e 6164 6450 7269       pset.addPri
+00013e90: 6d69 7469 7665 286e 705f 6164 645f 6d75  mitive(np_add_mu
+00013ea0: 6c74 6970 6c65 2c20 6929 0a20 2020 2020  ltiple, i).     
+00013eb0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00013ec0: 7365 742e 6164 6450 7269 6d69 7469 7665  set.addPrimitive
+00013ed0: 286e 705f 6d61 785f 6d75 6c74 6970 6c65  (np_max_multiple
+00013ee0: 2c20 6929 0a20 2020 2020 2020 2020 2020  , i).           
+00013ef0: 2020 2020 2020 2020 2070 7365 742e 6164           pset.ad
+00013f00: 6450 7269 6d69 7469 7665 286e 705f 6d69  dPrimitive(np_mi
+00013f10: 6e5f 6d75 6c74 6970 6c65 2c20 6929 0a0a  n_multiple, i)..
+00013f20: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00013f30: 2e62 6173 6963 5f70 7269 6d69 7469 7665  .basic_primitive
+00013f40: 7320 3d20 272c 272e 6a6f 696e 285b 0a20  s = ','.join([. 
+00013f50: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00013f60: 6164 6427 2c20 2773 7562 7472 6163 7427  add', 'subtract'
+00013f70: 2c20 276d 756c 7469 706c 7927 2c20 2761  , 'multiply', 'a
+00013f80: 6e61 6c79 7469 6361 6c5f 7175 6f74 6965  nalytical_quotie
+00013f90: 6e74 272c 0a20 2020 2020 2020 2020 2020  nt',.           
+00013fa0: 2020 2020 2027 7072 6f74 6563 745f 7371       'protect_sq
+00013fb0: 7274 272c 2027 7369 6e27 2c20 2763 6f73  rt', 'sin', 'cos
+00013fc0: 272c 2027 6d61 7869 6d75 6d27 2c20 276d  ', 'maximum', 'm
+00013fd0: 696e 696d 756d 272c 2027 6e65 6761 7469  inimum', 'negati
+00013fe0: 7665 272c 0a20 2020 2020 2020 2020 2020  ve',.           
+00013ff0: 205d 290a 2020 2020 2020 2020 2020 2020   ]).            
+00014000: 7365 6c66 2e61 6464 5f70 7269 6d69 7469  self.add_primiti
+00014010: 7665 735f 746f 5f70 7365 7428 7073 6574  ves_to_pset(pset
+00014020: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+00014030: 2063 6f75 6e74 2021 3d20 303a 0a20 2020   count != 0:.   
+00014040: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00014050: 662e 6261 7369 635f 7072 696d 6974 6976  f.basic_primitiv
+00014060: 6573 203d 2066 276f 7074 696d 616c 2d7b  es = f'optimal-{
+00014070: 636f 756e 747d 270a 2020 2020 2020 2020  count}'.        
+00014080: 656c 6966 2073 656c 662e 6261 7369 635f  elif self.basic_
+00014090: 7072 696d 6974 6976 6573 203d 3d20 2744  primitives == 'D
+000140a0: 4947 454e 273a 0a20 2020 2020 2020 2020  IGEN':.         
+000140b0: 2020 2070 7365 7420 3d20 6770 2e50 7269     pset = gp.Pri
+000140c0: 6d69 7469 7665 5365 7428 224d 4149 4e22  mitiveSet("MAIN"
+000140d0: 2c20 782e 7368 6170 655b 315d 290a 2020  , x.shape[1]).  
+000140e0: 2020 2020 2020 2020 2020 7365 6c66 2e62            self.b
+000140f0: 6173 6963 5f70 7269 6d69 7469 7665 7320  asic_primitives 
+00014100: 3d20 272c 272e 6a6f 696e 285b 0a20 2020  = ','.join([.   
+00014110: 2020 2020 2020 2020 2020 2020 2027 6164               'ad
+00014120: 6427 2c20 2773 7562 7472 6163 7427 2c20  d', 'subtract', 
+00014130: 276d 756c 7469 706c 7927 2c20 2761 6e61  'multiply', 'ana
+00014140: 6c79 7469 6361 6c5f 7175 6f74 6965 6e74  lytical_quotient
+00014150: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+00014160: 2020 2027 7072 6f74 6563 745f 7371 7274     'protect_sqrt
+00014170: 272c 2027 7369 6e27 2c20 2763 6f73 272c  ', 'sin', 'cos',
+00014180: 2027 6d61 7869 6d75 6d27 2c20 276d 696e   'maximum', 'min
+00014190: 696d 756d 272c 2027 6e65 6761 7469 7665  imum', 'negative
+000141a0: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+000141b0: 2020 2027 6772 6561 7465 725f 6f72 5f65     'greater_or_e
+000141c0: 7175 616c 5f74 6861 6e27 2c20 276c 6573  qual_than', 'les
+000141d0: 735f 6f72 5f65 7175 616c 5f74 6861 6e27  s_or_equal_than'
+000141e0: 0a20 2020 2020 2020 2020 2020 205d 290a  .            ]).
+000141f0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00014200: 2e61 6464 5f70 7269 6d69 7469 7665 735f  .add_primitives_
+00014210: 746f 5f70 7365 7428 7073 6574 290a 2020  to_pset(pset).  
+00014220: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
+00014230: 7461 6e63 6528 7365 6c66 2e62 6173 6963  tance(self.basic
+00014240: 5f70 7269 6d69 7469 7665 732c 2073 7472  _primitives, str
+00014250: 2920 616e 6420 7365 6c66 2e62 6173 6963  ) and self.basic
+00014260: 5f70 7269 6d69 7469 7665 732e 7374 6172  _primitives.star
+00014270: 7473 7769 7468 2827 4d4c 2729 3a0a 2020  tswith('ML'):.  
+00014280: 2020 2020 2020 2020 2020 7073 6574 203d            pset =
+00014290: 2050 7269 6d69 7469 7665 5365 7428 224d   PrimitiveSet("M
+000142a0: 4149 4e22 2c20 782e 7368 6170 655b 315d  AIN", x.shape[1]
+000142b0: 290a 2020 2020 2020 2020 2020 2020 7072  ).            pr
+000142c0: 696d 6974 6976 6573 203d 2027 2c27 2e6a  imitives = ','.j
+000142d0: 6f69 6e28 5b0a 2020 2020 2020 2020 2020  oin([.          
+000142e0: 2020 2020 2020 2761 6464 272c 2027 7375        'add', 'su
+000142f0: 6274 7261 6374 272c 2027 6d75 6c74 6970  btract', 'multip
+00014300: 6c79 272c 2027 616e 616c 7974 6963 616c  ly', 'analytical
+00014310: 5f71 756f 7469 656e 7427 2c0a 2020 2020  _quotient',.    
+00014320: 2020 2020 2020 2020 2020 2020 2770 726f              'pro
+00014330: 7465 6374 5f73 7172 7427 2c20 2773 696e  tect_sqrt', 'sin
+00014340: 272c 2027 636f 7327 2c20 276d 6178 696d  ', 'cos', 'maxim
+00014350: 756d 272c 2027 6d69 6e69 6d75 6d27 2c20  um', 'minimum', 
+00014360: 276e 6567 6174 6976 6527 2c0a 2020 2020  'negative',.    
+00014370: 2020 2020 2020 2020 5d29 0a20 2020 2020          ]).     
+00014380: 2020 2020 2020 206d 6f64 656c 7320 3d20         models = 
+00014390: 7365 6c66 2e62 6173 6963 5f70 7269 6d69  self.basic_primi
+000143a0: 7469 7665 732e 7265 706c 6163 6528 274d  tives.replace('M
+000143b0: 4c2d 272c 2027 2729 2e73 706c 6974 2827  L-', '').split('
+000143c0: 2c27 290a 2020 2020 2020 2020 2020 2020  ,').            
+000143d0: 666f 7220 6d20 696e 206d 6f64 656c 733a  for m in models:
+000143e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000143f0: 2069 6620 6d20 3d3d 2027 5461 7267 6574   if m == 'Target
+00014400: 456e 636f 6465 7227 3a0a 2020 2020 2020  Encoder':.      
+00014410: 2020 2020 2020 2020 2020 2020 2020 7073                ps
+00014420: 6574 2e61 6464 5072 696d 6974 6976 6528  et.addPrimitive(
+00014430: 6d61 6b65 5f63 6c61 7373 2854 6172 6765  make_class(Targe
+00014440: 7445 6e63 6f64 6572 4e75 6d70 792c 2032  tEncoderNumpy, 2
+00014450: 2c20 7061 7261 6d65 7465 7273 3d64 6963  , parameters=dic
+00014460: 7428 636f 6c73 3d5b 305d 2c20 7265 7475  t(cols=[0], retu
+00014470: 726e 5f64 663d 4661 6c73 6529 292c 2032  rn_df=False)), 2
+00014480: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00014490: 2020 6966 206d 203d 3d20 274b 4e4e 2d32    if m == 'KNN-2
+000144a0: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
+000144b0: 2020 2020 2020 2070 7365 742e 6164 6450         pset.addP
+000144c0: 7269 6d69 7469 7665 286d 616b 655f 636c  rimitive(make_cl
+000144d0: 6173 7328 4b4e 6569 6768 626f 7273 5265  ass(KNeighborsRe
+000144e0: 6772 6573 736f 722c 2032 292c 2032 290a  gressor, 2), 2).
+000144f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014500: 6966 206d 203d 3d20 2744 542d 3227 3a0a  if m == 'DT-2':.
+00014510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014520: 2020 2020 7073 6574 2e61 6464 5072 696d      pset.addPrim
+00014530: 6974 6976 6528 6d61 6b65 5f63 6c61 7373  itive(make_class
+00014540: 2844 6563 6973 696f 6e54 7265 6552 6567  (DecisionTreeReg
+00014550: 7265 7373 6f72 2c20 3229 2c20 3229 0a20  ressor, 2), 2). 
+00014560: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00014570: 6620 6d20 3d3d 2027 5269 6467 652d 3227  f m == 'Ridge-2'
+00014580: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00014590: 2020 2020 2020 7073 6574 2e61 6464 5072        pset.addPr
+000145a0: 696d 6974 6976 6528 6d61 6b65 5f63 6c61  imitive(make_cla
+000145b0: 7373 2852 6964 6765 2c20 3229 2c20 3229  ss(Ridge, 2), 2)
+000145c0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000145d0: 662e 6164 645f 7072 696d 6974 6976 6573  f.add_primitives
+000145e0: 5f74 6f5f 7073 6574 2870 7365 742c 2070  _to_pset(pset, p
+000145f0: 7269 6d69 7469 7665 732c 2074 7261 6e73  rimitives, trans
+00014600: 666f 726d 6572 5f77 7261 7070 6572 3d54  former_wrapper=T
+00014610: 7275 6529 0a20 2020 2020 2020 2020 2020  rue).           
+00014620: 2073 656c 662e 6261 7369 635f 7072 696d   self.basic_prim
+00014630: 6974 6976 6573 203d 2027 4d4c 270a 2020  itives = 'ML'.  
+00014640: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
+00014650: 6261 7369 635f 7072 696d 6974 6976 6573  basic_primitives
+00014660: 203d 3d20 2743 4446 4327 3a0a 2020 2020   == 'CDFC':.    
+00014670: 2020 2020 2020 2020 2320 7072 696d 6974          # primit
+00014680: 6976 6573 2075 7365 6420 696e 2043 4446  ives used in CDF
+00014690: 430a 2020 2020 2020 2020 2020 2020 2320  C.            # 
+000146a0: 2247 656e 6574 6963 2070 726f 6772 616d  "Genetic program
+000146b0: 6d69 6e67 2066 6f72 206d 756c 7469 706c  ming for multipl
+000146c0: 652d 6665 6174 7572 6520 636f 6e73 7472  e-feature constr
+000146d0: 7563 7469 6f6e 206f 6e20 6869 6768 2d64  uction on high-d
+000146e0: 696d 656e 7369 6f6e 616c 2063 6c61 7373  imensional class
+000146f0: 6966 6963 6174 696f 6e22 0a20 2020 2020  ification".     
+00014700: 2020 2020 2020 2070 7365 7420 3d20 6770         pset = gp
+00014710: 2e50 7269 6d69 7469 7665 5365 7428 224d  .PrimitiveSet("M
+00014720: 4149 4e22 2c20 782e 7368 6170 655b 315d  AIN", x.shape[1]
+00014730: 290a 2020 2020 2020 2020 2020 2020 6164  ).            ad
+00014740: 645f 6261 7369 635f 6f70 6572 6174 6f72  d_basic_operator
+00014750: 7328 7073 6574 290a 2020 2020 2020 2020  s(pset).        
+00014760: 2020 2020 7073 6574 2e61 6464 5072 696d      pset.addPrim
+00014770: 6974 6976 6528 6e70 2e6d 6178 696d 756d  itive(np.maximum
+00014780: 2c20 3229 0a20 2020 2020 2020 2020 2020  , 2).           
+00014790: 2070 7365 742e 6164 6450 7269 6d69 7469   pset.addPrimiti
+000147a0: 7665 2869 665f 6675 6e63 7469 6f6e 2c20  ve(if_function, 
+000147b0: 3329 0a20 2020 2020 2020 2065 6c69 6620  3).        elif 
+000147c0: 7365 6c66 2e62 6173 6963 5f70 7269 6d69  self.basic_primi
+000147d0: 7469 7665 7320 3d3d 2027 6c6f 6769 6361  tives == 'logica
+000147e0: 6c27 3a0a 2020 2020 2020 2020 2020 2020  l':.            
+000147f0: 7073 6574 203d 2067 702e 5072 696d 6974  pset = gp.Primit
+00014800: 6976 6553 6574 2822 4d41 494e 222c 2078  iveSet("MAIN", x
+00014810: 2e73 6861 7065 5b31 5d29 0a20 2020 2020  .shape[1]).     
+00014820: 2020 2020 2020 2061 6464 5f6c 6f67 6963         add_logic
+00014830: 616c 5f6f 7065 7261 746f 7273 2870 7365  al_operators(pse
+00014840: 7429 0a20 2020 2020 2020 2065 6c69 6620  t).        elif 
+00014850: 7365 6c66 2e62 6173 6963 5f70 7269 6d69  self.basic_primi
+00014860: 7469 7665 7320 3d3d 2027 7265 6c61 7469  tives == 'relati
+00014870: 6f6e 273a 0a20 2020 2020 2020 2020 2020  on':.           
+00014880: 2070 7365 7420 3d20 6770 2e50 7269 6d69   pset = gp.Primi
+00014890: 7469 7665 5365 7428 224d 4149 4e22 2c20  tiveSet("MAIN", 
+000148a0: 782e 7368 6170 655b 315d 290a 2020 2020  x.shape[1]).    
+000148b0: 2020 2020 2020 2020 6164 645f 6261 7369          add_basi
+000148c0: 635f 6f70 6572 6174 6f72 7328 7073 6574  c_operators(pset
+000148d0: 290a 2020 2020 2020 2020 2020 2020 6164  ).            ad
+000148e0: 645f 7265 6c61 7469 6f6e 5f6f 7065 7261  d_relation_opera
+000148f0: 746f 7273 2870 7365 7429 0a20 2020 2020  tors(pset).     
+00014900: 2020 2065 6c69 6620 7365 6c66 2e62 6173     elif self.bas
+00014910: 6963 5f70 7269 6d69 7469 7665 7320 3d3d  ic_primitives ==
+00014920: 2027 6e6f 726d 616c 697a 6564 273a 0a20   'normalized':. 
+00014930: 2020 2020 2020 2020 2020 2070 7365 7420             pset 
+00014940: 3d20 6770 2e50 7269 6d69 7469 7665 5365  = gp.PrimitiveSe
+00014950: 7428 224d 4149 4e22 2c20 782e 7368 6170  t("MAIN", x.shap
+00014960: 655b 315d 290a 0a20 2020 2020 2020 2020  e[1])..         
+00014970: 2020 2064 6566 2074 616e 685f 7772 6170     def tanh_wrap
+00014980: 7065 7228 6675 6e63 293a 0a20 2020 2020  per(func):.     
+00014990: 2020 2020 2020 2020 2020 2064 6566 2073             def s
+000149a0: 696d 706c 655f 6675 6e63 2878 312c 2078  imple_func(x1, x
+000149b0: 3229 3a0a 2020 2020 2020 2020 2020 2020  2):.            
+000149c0: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+000149d0: 702e 7461 6e68 2866 756e 6328 7831 2c20  p.tanh(func(x1, 
+000149e0: 7832 2929 0a0a 2020 2020 2020 2020 2020  x2))..          
+000149f0: 2020 2020 2020 7369 6d70 6c65 5f66 756e        simple_fun
+00014a00: 632e 5f5f 6e61 6d65 5f5f 203d 2066 2774  c.__name__ = f't
+00014a10: 616e 685f 7b66 756e 632e 5f5f 6e61 6d65  anh_{func.__name
+00014a20: 5f5f 7d27 0a20 2020 2020 2020 2020 2020  __}'.           
+00014a30: 2020 2020 2072 6574 7572 6e20 7369 6d70       return simp
+00014a40: 6c65 5f66 756e 630a 0a20 2020 2020 2020  le_func..       
+00014a50: 2020 2020 2070 7365 742e 6164 6450 7269       pset.addPri
+00014a60: 6d69 7469 7665 2874 616e 685f 7772 6170  mitive(tanh_wrap
+00014a70: 7065 7228 6e70 2e61 6464 292c 2032 290a  per(np.add), 2).
+00014a80: 2020 2020 2020 2020 2020 2020 7073 6574              pset
+00014a90: 2e61 6464 5072 696d 6974 6976 6528 7461  .addPrimitive(ta
+00014aa0: 6e68 5f77 7261 7070 6572 286e 702e 7375  nh_wrapper(np.su
+00014ab0: 6274 7261 6374 292c 2032 290a 2020 2020  btract), 2).    
+00014ac0: 2020 2020 2020 2020 7073 6574 2e61 6464          pset.add
+00014ad0: 5072 696d 6974 6976 6528 7461 6e68 5f77  Primitive(tanh_w
+00014ae0: 7261 7070 6572 286e 702e 6d75 6c74 6970  rapper(np.multip
+00014af0: 6c79 292c 2032 290a 2020 2020 2020 2020  ly), 2).        
+00014b00: 2020 2020 7073 6574 2e61 6464 5072 696d      pset.addPrim
+00014b10: 6974 6976 6528 7461 6e68 5f77 7261 7070  itive(tanh_wrapp
+00014b20: 6572 2861 6e61 6c79 7469 6361 6c5f 7175  er(analytical_qu
+00014b30: 6f74 6965 6e74 292c 2032 290a 2020 2020  otient), 2).    
+00014b40: 2020 2020 656c 6966 2073 656c 662e 6261      elif self.ba
+00014b50: 7369 635f 7072 696d 6974 6976 6573 203d  sic_primitives =
+00014b60: 3d20 2769 6e74 6572 7072 6574 6162 6c65  = 'interpretable
+00014b70: 273a 0a20 2020 2020 2020 2020 2020 2070  ':.            p
+00014b80: 7365 7420 3d20 6770 2e50 7269 6d69 7469  set = gp.Primiti
+00014b90: 7665 5365 7428 224d 4149 4e22 2c20 782e  veSet("MAIN", x.
+00014ba0: 7368 6170 655b 315d 290a 2020 2020 2020  shape[1]).      
+00014bb0: 2020 2020 2020 7073 6574 2e61 6464 5072        pset.addPr
+00014bc0: 696d 6974 6976 6528 6e70 2e61 6464 2c20  imitive(np.add, 
+00014bd0: 3229 0a20 2020 2020 2020 2020 2020 2070  2).            p
+00014be0: 7365 742e 6164 6450 7269 6d69 7469 7665  set.addPrimitive
+00014bf0: 286e 702e 7375 6274 7261 6374 2c20 3229  (np.subtract, 2)
+00014c00: 0a20 2020 2020 2020 2020 2020 2070 7365  .            pse
+00014c10: 742e 6164 6450 7269 6d69 7469 7665 286e  t.addPrimitive(n
+00014c20: 702e 6d75 6c74 6970 6c79 2c20 3229 0a20  p.multiply, 2). 
+00014c30: 2020 2020 2020 2020 2020 2070 7365 742e             pset.
+00014c40: 6164 6450 7269 6d69 7469 7665 2870 726f  addPrimitive(pro
+00014c50: 7465 6374 6564 5f64 6976 6973 696f 6e2c  tected_division,
+00014c60: 2032 290a 2020 2020 2020 2020 656c 6966   2).        elif
+00014c70: 2069 7369 6e73 7461 6e63 6528 7365 6c66   isinstance(self
+00014c80: 2e62 6173 6963 5f70 7269 6d69 7469 7665  .basic_primitive
+00014c90: 732c 2073 7472 2920 616e 6420 272c 2720  s, str) and ',' 
+00014ca0: 696e 2073 656c 662e 6261 7369 635f 7072  in self.basic_pr
+00014cb0: 696d 6974 6976 6573 3a0a 2020 2020 2020  imitives:.      
+00014cc0: 2020 2020 2020 2320 616e 2061 7272 6179        # an array
+00014cd0: 206f 6620 6261 7369 6320 7072 696d 6974   of basic primit
+00014ce0: 6976 6573 0a20 2020 2020 2020 2020 2020  ives.           
+00014cf0: 2070 7365 7420 3d20 6770 2e50 7269 6d69   pset = gp.Primi
+00014d00: 7469 7665 5365 7428 224d 4149 4e22 2c20  tiveSet("MAIN", 
+00014d10: 782e 7368 6170 655b 315d 290a 2020 2020  x.shape[1]).    
+00014d20: 2020 2020 2020 2020 7365 6c66 2e61 6464          self.add
+00014d30: 5f70 7269 6d69 7469 7665 735f 746f 5f70  _primitives_to_p
+00014d40: 7365 7428 7073 6574 290a 2020 2020 2020  set(pset).      
+00014d50: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00014d60: 2020 2020 7073 6574 203d 2050 7269 6d69      pset = Primi
+00014d70: 7469 7665 5365 7428 224d 4149 4e22 2c20  tiveSet("MAIN", 
+00014d80: 782e 7368 6170 655b 315d 290a 2020 2020  x.shape[1]).    
+00014d90: 2020 2020 2020 2020 7365 6c66 2e62 6173          self.bas
+00014da0: 6963 5f70 7269 6d69 7469 7665 7320 3d20  ic_primitives = 
+00014db0: 272c 272e 6a6f 696e 285b 0a20 2020 2020  ','.join([.     
+00014dc0: 2020 2020 2020 2020 2020 2027 6164 6427             'add'
+00014dd0: 2c20 2773 7562 7472 6163 7427 2c20 276d  , 'subtract', 'm
+00014de0: 756c 7469 706c 7927 2c20 2761 6e61 6c79  ultiply', 'analy
+00014df0: 7469 6361 6c5f 7175 6f74 6965 6e74 270a  tical_quotient'.
+00014e00: 2020 2020 2020 2020 2020 2020 5d29 0a20              ]). 
+00014e10: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00014e20: 6164 645f 7072 696d 6974 6976 6573 5f74  add_primitives_t
+00014e30: 6f5f 7073 6574 2870 7365 7429 0a0a 2020  o_pset(pset)..  
+00014e40: 2020 2020 2020 2320 6164 6420 636f 6e73        # add cons
+00014e50: 7461 6e74 0a20 2020 2020 2020 2069 6620  tant.        if 
+00014e60: 6861 7361 7474 7228 6770 2c20 2772 616e  hasattr(gp, 'ran
+00014e70: 6431 3031 2729 3a0a 2020 2020 2020 2020  d101'):.        
+00014e80: 2020 2020 6465 6c61 7474 7228 6770 2c20      delattr(gp, 
+00014e90: 2772 616e 6431 3031 2729 0a20 2020 2020  'rand101').     
+00014ea0: 2020 2069 6620 7365 6c66 2e63 6f6e 7374     if self.const
+00014eb0: 616e 745f 7479 7065 203d 3d20 274e 6f72  ant_type == 'Nor
+00014ec0: 6d61 6c27 3a0a 2020 2020 2020 2020 2020  mal':.          
+00014ed0: 2020 7073 6574 2e61 6464 4570 6865 6d65    pset.addEpheme
+00014ee0: 7261 6c43 6f6e 7374 616e 7428 2272 616e  ralConstant("ran
+00014ef0: 6431 3031 222c 206c 616d 6264 613a 206e  d101", lambda: n
+00014f00: 702e 7261 6e64 6f6d 2e6e 6f72 6d61 6c28  p.random.normal(
+00014f10: 2929 0a20 2020 2020 2020 2065 6c69 6620  )).        elif 
+00014f20: 7365 6c66 2e63 6f6e 7374 616e 745f 7479  self.constant_ty
+00014f30: 7065 2069 7320 4e6f 6e65 3a0a 2020 2020  pe is None:.    
+00014f40: 2020 2020 2020 2020 7061 7373 0a20 2020          pass.   
+00014f50: 2020 2020 2065 6c69 6620 7365 6c66 2e62       elif self.b
+00014f60: 6173 6963 5f70 7269 6d69 7469 7665 7320  asic_primitives 
+00014f70: 3d3d 2046 616c 7365 3a0a 2020 2020 2020  == False:.      
+00014f80: 2020 2020 2020 7073 6574 2e61 6464 4570        pset.addEp
+00014f90: 6865 6d65 7261 6c43 6f6e 7374 616e 7428  hemeralConstant(
+00014fa0: 2272 616e 6431 3031 222c 206c 616d 6264  "rand101", lambd
+00014fb0: 613a 2072 616e 646f 6d2e 7261 6e64 696e  a: random.randin
+00014fc0: 7428 2d31 2c20 3129 2c20 4e75 6d65 7269  t(-1, 1), Numeri
+00014fd0: 6361 6c46 6561 7475 7265 290a 2020 2020  calFeature).    
+00014fe0: 2020 2020 656c 6966 2073 656c 662e 636f      elif self.co
+00014ff0: 6e73 7461 6e74 5f74 7970 6520 3d3d 2027  nstant_type == '
+00015000: 466c 6f61 7427 3a0a 2020 2020 2020 2020  Float':.        
+00015010: 2020 2020 7073 6574 2e61 6464 4570 6865      pset.addEphe
+00015020: 6d65 7261 6c43 6f6e 7374 616e 7428 2272  meralConstant("r
+00015030: 616e 6431 3031 222c 206c 616d 6264 613a  and101", lambda:
+00015040: 2072 616e 646f 6d2e 756e 6966 6f72 6d28   random.uniform(
+00015050: 2d31 2c20 3129 290a 2020 2020 2020 2020  -1, 1)).        
+00015060: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00015070: 2020 7073 6574 2e61 6464 4570 6865 6d65    pset.addEpheme
+00015080: 7261 6c43 6f6e 7374 616e 7428 2272 616e  ralConstant("ran
+00015090: 6431 3031 222c 206c 616d 6264 613a 2072  d101", lambda: r
+000150a0: 616e 646f 6d2e 7261 6e64 696e 7428 2d31  andom.randint(-1
+000150b0: 2c20 3129 290a 0a20 2020 2020 2020 2069  , 1))..        i
+000150c0: 6620 6973 696e 7374 616e 6365 2870 7365  f isinstance(pse
+000150d0: 742c 2050 7269 6d69 7469 7665 5365 7429  t, PrimitiveSet)
+000150e0: 2061 6e64 2073 656c 662e 6d67 705f 6d6f   and self.mgp_mo
+000150f0: 6465 2069 7320 5472 7565 3a0a 2020 2020  de is True:.    
+00015100: 2020 2020 2020 2020 6e65 775f 7073 6574          new_pset
+00015110: 203d 204d 756c 7469 706c 6550 7269 6d69   = MultiplePrimi
+00015120: 7469 7665 5365 7428 224d 4149 4e22 2c20  tiveSet("MAIN", 
+00015130: 7365 6c66 2e58 2e73 6861 7065 5b31 5d29  self.X.shape[1])
+00015140: 0a20 2020 2020 2020 2020 2020 206e 6577  .            new
+00015150: 5f70 7365 742e 6d67 705f 7363 6f70 6520  _pset.mgp_scope 
+00015160: 3d20 7365 6c66 2e6d 6770 5f73 636f 7065  = self.mgp_scope
+00015170: 0a20 2020 2020 2020 2020 2020 206e 6577  .            new
+00015180: 5f70 7365 742e 6c61 7965 725f 6d67 7020  _pset.layer_mgp 
+00015190: 3d20 7365 6c66 2e6c 6179 6572 5f6d 6770  = self.layer_mgp
+000151a0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+000151b0: 2078 2069 6e20 7261 6e67 6528 7365 6c66   x in range(self
+000151c0: 2e67 656e 655f 6e75 6d29 3a0a 2020 2020  .gene_num):.    
+000151d0: 2020 2020 2020 2020 2020 2020 6261 7365              base
+000151e0: 5f63 6f75 6e74 203d 2073 656c 662e 582e  _count = self.X.
+000151f0: 7368 6170 655b 315d 0a20 2020 2020 2020  shape[1].       
+00015200: 2020 2020 2020 2020 2062 6173 655f 7073           base_ps
+00015210: 6574 203d 2063 6f70 792e 6465 6570 636f  et = copy.deepco
+00015220: 7079 2870 7365 7429 0a20 2020 2020 2020  py(pset).       
+00015230: 2020 2020 2020 2020 2069 6620 7820 3e3d           if x >=
+00015240: 2073 656c 662e 6d67 705f 7363 6f70 6520   self.mgp_scope 
+00015250: 616e 6420 7365 6c66 2e73 7472 6963 745f  and self.strict_
+00015260: 6c61 7965 725f 6d67 703a 0a20 2020 2020  layer_mgp:.     
+00015270: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00015280: 2069 6620 7374 7269 6374 206c 6179 6572   if strict layer
+00015290: 2c20 7468 656e 206e 6f74 2075 7365 2069  , then not use i
+000152a0: 6e70 7574 2066 6561 7475 7265 730a 2020  nput features.  
+000152b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000152c0: 2020 6261 7365 5f70 7365 742e 7465 726d    base_pset.term
+000152d0: 696e 616c 735b 6f62 6a65 6374 5d20 3d20  inals[object] = 
+000152e0: 5b5d 0a20 2020 2020 2020 2020 2020 2020  [].             
+000152f0: 2020 2020 2020 2062 6173 655f 7073 6574         base_pset
+00015300: 2e61 7267 756d 656e 7473 203d 205b 5d0a  .arguments = [].
+00015310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015320: 6966 2073 656c 662e 6d67 705f 7363 6f70  if self.mgp_scop
+00015330: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
+00015340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015350: 2020 2069 6620 7365 6c66 2e6c 6179 6572     if self.layer
+00015360: 5f6d 6770 3a0a 2020 2020 2020 2020 2020  _mgp:.          
+00015370: 2020 2020 2020 2020 2020 2020 2020 6173                as
+00015380: 7365 7274 2073 656c 662e 6765 6e65 5f6e  sert self.gene_n
+00015390: 756d 2025 2073 656c 662e 6d67 705f 7363  um % self.mgp_sc
+000153a0: 6f70 6520 3d3d 2030 2c20 224e 756d 6265  ope == 0, "Numbe
+000153b0: 7220 6f66 2067 656e 6573 206d 7573 7420  r of genes must 
+000153c0: 6265 2061 206d 756c 7469 706c 6520 6f66  be a multiple of
+000153d0: 2073 636f 7065 2122 0a20 2020 2020 2020   scope!".       
+000153e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000153f0: 2023 2073 7472 6963 7420 626f 756e 6461   # strict bounda
+00015400: 7279 0a20 2020 2020 2020 2020 2020 2020  ry.             
+00015410: 2020 2020 2020 2020 2020 2073 7461 7274             start
+00015420: 5f62 6173 6520 3d20 6d61 7828 6261 7365  _base = max(base
+00015430: 5f63 6f75 6e74 202b 2028 2878 202f 2f20  _count + ((x // 
+00015440: 7365 6c66 2e6d 6770 5f73 636f 7065 2920  self.mgp_scope) 
+00015450: 2d20 3129 202a 2073 656c 662e 6d67 705f  - 1) * self.mgp_
+00015460: 7363 6f70 652c 2062 6173 655f 636f 756e  scope, base_coun
+00015470: 7429 0a20 2020 2020 2020 2020 2020 2020  t).             
+00015480: 2020 2020 2020 2020 2020 2065 6e64 5f62             end_b
+00015490: 6173 6520 3d20 6d61 7828 6261 7365 5f63  ase = max(base_c
+000154a0: 6f75 6e74 202b 2028 7820 2f2f 2073 656c  ount + (x // sel
+000154b0: 662e 6d67 705f 7363 6f70 6529 202a 2073  f.mgp_scope) * s
+000154c0: 656c 662e 6d67 705f 7363 6f70 652c 2062  elf.mgp_scope, b
+000154d0: 6173 655f 636f 756e 7429 0a20 2020 2020  ase_count).     
+000154e0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000154f0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00015500: 2020 2020 2020 2020 2020 2020 2023 206e               # n
+00015510: 6f20 636c 6561 7220 626f 756e 6461 7279  o clear boundary
+00015520: 2062 6574 7765 656e 2065 6163 6820 6c61   between each la
+00015530: 7965 720a 2020 2020 2020 2020 2020 2020  yer.            
+00015540: 2020 2020 2020 2020 2020 2020 7374 6172              star
+00015550: 745f 6261 7365 203d 206d 6178 2862 6173  t_base = max(bas
+00015560: 655f 636f 756e 7420 2b20 7820 2d20 7365  e_count + x - se
+00015570: 6c66 2e6d 6770 5f73 636f 7065 2c20 6261  lf.mgp_scope, ba
+00015580: 7365 5f63 6f75 6e74 290a 2020 2020 2020  se_count).      
+00015590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000155a0: 2020 656e 645f 6261 7365 203d 2062 6173    end_base = bas
+000155b0: 655f 636f 756e 7420 2b20 780a 2020 2020  e_count + x.    
+000155c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000155d0: 6173 7365 7274 2073 7461 7274 5f62 6173  assert start_bas
+000155e0: 6520 3e3d 2073 656c 662e 582e 7368 6170  e >= self.X.shap
+000155f0: 655b 315d 0a20 2020 2020 2020 2020 2020  e[1].           
+00015600: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00015610: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00015620: 7461 7274 5f62 6173 6520 3d20 6261 7365  tart_base = base
+00015630: 5f63 6f75 6e74 0a20 2020 2020 2020 2020  _count.         
+00015640: 2020 2020 2020 2020 2020 2065 6e64 5f62             end_b
+00015650: 6173 6520 3d20 6261 7365 5f63 6f75 6e74  ase = base_count
+00015660: 202b 2078 0a20 2020 2020 2020 2020 2020   + x.           
+00015670: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
+00015680: 6e67 6528 7374 6172 745f 6261 7365 2c20  nge(start_base, 
+00015690: 656e 645f 6261 7365 293a 0a20 2020 2020  end_base):.     
+000156a0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+000156b0: 6173 655f 7073 6574 2e61 6464 5465 726d  ase_pset.addTerm
+000156c0: 696e 616c 2866 2741 5247 7b69 7d27 2c20  inal(f'ARG{i}', 
+000156d0: 6627 4152 477b 697d 2729 0a20 2020 2020  f'ARG{i}').     
+000156e0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+000156f0: 6173 655f 7073 6574 2e61 7267 756d 656e  ase_pset.argumen
+00015700: 7473 2e61 7070 656e 6428 6627 4152 477b  ts.append(f'ARG{
+00015710: 697d 2729 0a20 2020 2020 2020 2020 2020  i}').           
+00015720: 2020 2020 2062 6173 655f 7073 6574 2e70       base_pset.p
+00015730: 7365 745f 6964 203d 2078 0a20 2020 2020  set_id = x.     
+00015740: 2020 2020 2020 2020 2020 206e 6577 5f70             new_p
+00015750: 7365 742e 7073 6574 5f6c 6973 742e 6170  set.pset_list.ap
+00015760: 7065 6e64 2862 6173 655f 7073 6574 290a  pend(base_pset).
+00015770: 2020 2020 2020 2020 2020 2020 7073 6574              pset
+00015780: 203d 206e 6577 5f70 7365 740a 2020 2020   = new_pset.    
+00015790: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
+000157a0: 6e63 6528 7073 6574 2c20 5072 696d 6974  nce(pset, Primit
+000157b0: 6976 6553 6574 2920 616e 6420 7365 6c66  iveSet) and self
+000157c0: 2e6d 6770 5f6d 6f64 6520 3d3d 2027 5265  .mgp_mode == 'Re
+000157d0: 6769 7374 6572 273a 0a20 2020 2020 2020  gister':.       
+000157e0: 2020 2020 2070 7365 742e 6e75 6d62 6572       pset.number
+000157f0: 5f6f 665f 7265 6769 7374 6572 203d 2073  _of_register = s
+00015800: 656c 662e 6e75 6d62 6572 5f6f 665f 7265  elf.number_of_re
+00015810: 6769 7374 6572 0a20 2020 2020 2020 2020  gister.         
+00015820: 2020 2023 2049 6e70 7574 2072 6567 6973     # Input regis
+00015830: 7465 7220 6973 2065 6173 7920 746f 2069  ter is easy to i
+00015840: 6d70 6c65 6d65 6e74 0a20 2020 2020 2020  mplement.       
+00015850: 2020 2020 2062 6173 655f 636f 756e 7420       base_count 
+00015860: 3d20 7365 6c66 2e58 2e73 6861 7065 5b31  = self.X.shape[1
+00015870: 5d0a 2020 2020 2020 2020 2020 2020 666f  ].            fo
+00015880: 7220 6920 696e 2072 616e 6765 2862 6173  r i in range(bas
+00015890: 655f 636f 756e 742c 2062 6173 655f 636f  e_count, base_co
+000158a0: 756e 7420 2b20 7365 6c66 2e6e 756d 6265  unt + self.numbe
+000158b0: 725f 6f66 5f72 6567 6973 7465 7229 3a0a  r_of_register):.
+000158c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000158d0: 7073 6574 2e61 6464 5465 726d 696e 616c  pset.addTerminal
+000158e0: 2866 2741 5247 7b69 7d27 2c20 6627 4152  (f'ARG{i}', f'AR
+000158f0: 477b 697d 2729 0a20 2020 2020 2020 2020  G{i}').         
+00015900: 2020 2020 2020 2070 7365 742e 6172 6775         pset.argu
+00015910: 6d65 6e74 732e 6170 7065 6e64 2866 2741  ments.append(f'A
+00015920: 5247 7b69 7d27 290a 2020 2020 2020 2020  RG{i}').        
+00015930: 7365 6c66 2e70 7365 7420 3d20 7073 6574  self.pset = pset
+00015940: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00015950: 7073 6574 0a0a 2020 2020 6465 6620 6164  pset..    def ad
+00015960: 645f 7072 696d 6974 6976 6573 5f74 6f5f  d_primitives_to_
+00015970: 7073 6574 2873 656c 662c 2070 7365 742c  pset(self, pset,
+00015980: 2070 7269 6d69 7469 7665 733d 4e6f 6e65   primitives=None
+00015990: 2c20 7472 616e 7366 6f72 6d65 725f 7772  , transformer_wr
+000159a0: 6170 7065 723d 4661 6c73 6529 3a0a 2020  apper=False):.  
+000159b0: 2020 2020 2020 6966 2070 7269 6d69 7469        if primiti
+000159c0: 7665 7320 6973 204e 6f6e 653a 0a20 2020  ves is None:.   
+000159d0: 2020 2020 2020 2020 2070 7269 6d69 7469           primiti
+000159e0: 7665 7320 3d20 7365 6c66 2e62 6173 6963  ves = self.basic
+000159f0: 5f70 7269 6d69 7469 7665 730a 2020 2020  _primitives.    
+00015a00: 2020 2020 666f 7220 7020 696e 2070 7269      for p in pri
+00015a10: 6d69 7469 7665 732e 7370 6c69 7428 272c  mitives.split(',
+00015a20: 2729 3a0a 2020 2020 2020 2020 2020 2020  '):.            
+00015a30: 7020 3d20 702e 7374 7269 7028 290a 2020  p = p.strip().  
+00015a40: 2020 2020 2020 2020 2020 7072 696d 6974            primit
+00015a50: 6976 6520 3d20 7b0a 2020 2020 2020 2020  ive = {.        
+00015a60: 2020 2020 2020 2020 2761 6464 273a 2028          'add': (
+00015a70: 6e70 2e61 6464 2c20 3229 2c0a 2020 2020  np.add, 2),.    
+00015a80: 2020 2020 2020 2020 2020 2020 2773 7562              'sub
+00015a90: 7472 6163 7427 3a20 286e 702e 7375 6274  tract': (np.subt
+00015aa0: 7261 6374 2c20 3229 2c0a 2020 2020 2020  ract, 2),.      
+00015ab0: 2020 2020 2020 2020 2020 276d 756c 7469            'multi
+00015ac0: 706c 7927 3a20 286e 702e 6d75 6c74 6970  ply': (np.multip
+00015ad0: 6c79 2c20 3229 2c0a 2020 2020 2020 2020  ly, 2),.        
+00015ae0: 2020 2020 2020 2020 2761 6e61 6c79 7469          'analyti
+00015af0: 6361 6c5f 7175 6f74 6965 6e74 273a 2028  cal_quotient': (
+00015b00: 616e 616c 7974 6963 616c 5f71 756f 7469  analytical_quoti
+00015b10: 656e 742c 2032 292c 0a20 2020 2020 2020  ent, 2),.       
+00015b20: 2020 2020 2020 2020 2027 6162 7327 3a20           'abs': 
+00015b30: 286e 702e 6162 736f 6c75 7465 2c20 3129  (np.absolute, 1)
+00015b40: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00015b50: 2020 2770 726f 7465 6374 5f73 7172 7427    'protect_sqrt'
+00015b60: 3a20 2870 726f 7465 6374 5f73 7172 742c  : (protect_sqrt,
+00015b70: 2031 292c 0a20 2020 2020 2020 2020 2020   1),.           
+00015b80: 2020 2020 2027 616e 616c 7974 6963 616c       'analytical
+00015b90: 5f6c 6f67 273a 2028 616e 616c 7974 6963  _log': (analytic
+00015ba0: 616c 5f6c 6f67 2c20 3129 2c0a 2020 2020  al_log, 1),.    
+00015bb0: 2020 2020 2020 2020 2020 2020 2761 6e61              'ana
+00015bc0: 6c79 7469 6361 6c5f 6c6f 6731 3027 3a20  lytical_log10': 
+00015bd0: 2861 6e61 6c79 7469 6361 6c5f 6c6f 6731  (analytical_log1
+00015be0: 302c 2031 292c 0a20 2020 2020 2020 2020  0, 1),.         
+00015bf0: 2020 2020 2020 2027 7369 6e27 3a20 286e         'sin': (n
+00015c00: 702e 7369 6e2c 2031 292c 0a20 2020 2020  p.sin, 1),.     
+00015c10: 2020 2020 2020 2020 2020 2027 636f 7327             'cos'
+00015c20: 3a20 286e 702e 636f 732c 2031 292c 0a20  : (np.cos, 1),. 
+00015c30: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00015c40: 6d61 7869 6d75 6d27 3a20 286e 702e 6d61  maximum': (np.ma
+00015c50: 7869 6d75 6d2c 2032 292c 0a20 2020 2020  ximum, 2),.     
+00015c60: 2020 2020 2020 2020 2020 2027 6d69 6e69             'mini
+00015c70: 6d75 6d27 3a20 286e 702e 6d69 6e69 6d75  mum': (np.minimu
+00015c80: 6d2c 2032 292c 0a20 2020 2020 2020 2020  m, 2),.         
+00015c90: 2020 2020 2020 2027 6d65 616e 273a 2028         'mean': (
+00015ca0: 6e70 5f6d 6561 6e2c 2032 292c 0a20 2020  np_mean, 2),.   
+00015cb0: 2020 2020 2020 2020 2020 2020 2027 6172               'ar
+00015cc0: 6374 616e 273a 2028 6e70 2e61 7263 7461  ctan': (np.arcta
+00015cd0: 6e2c 2031 292c 0a20 2020 2020 2020 2020  n, 1),.         
+00015ce0: 2020 2020 2020 2027 7461 6e68 273a 2028         'tanh': (
+00015cf0: 6e70 2e74 616e 682c 2031 292c 0a20 2020  np.tanh, 1),.   
+00015d00: 2020 2020 2020 2020 2020 2020 2027 6362               'cb
+00015d10: 7274 273a 2028 6e70 2e63 6272 742c 2031  rt': (np.cbrt, 1
+00015d20: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00015d30: 2020 2027 7371 7561 7265 273a 2028 6e70     'square': (np
+00015d40: 2e73 7175 6172 652c 2031 292c 0a20 2020  .square, 1),.   
+00015d50: 2020 2020 2020 2020 2020 2020 2027 6375               'cu
+00015d60: 6265 273a 2028 6375 6265 2c20 3129 2c0a  be': (cube, 1),.
+00015d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015d80: 276e 6567 6174 6976 6527 3a20 286e 702e  'negative': (np.
+00015d90: 6e65 6761 7469 7665 2c20 3129 2c0a 2020  negative, 1),.  
+00015da0: 2020 2020 2020 2020 2020 2020 2020 2773                's
+00015db0: 6967 6d6f 6964 273a 2028 7369 676d 6f69  igmoid': (sigmoi
+00015dc0: 642c 2031 292c 0a20 2020 2020 2020 2020  d, 1),.         
+00015dd0: 2020 2020 2020 2027 726f 756e 6427 3a20         'round': 
+00015de0: 286e 702e 726f 756e 642c 2031 292c 0a20  (np.round, 1),. 
+00015df0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00015e00: 7265 7369 6475 616c 273a 2028 7265 7369  residual': (resi
+00015e10: 6475 616c 2c20 3129 2c0a 2020 2020 2020  dual, 1),.      
+00015e20: 2020 2020 2020 2020 2020 276c 6561 6b79            'leaky
+00015e30: 5f72 656c 7527 3a20 286c 6561 6b79 5f72  _relu': (leaky_r
+00015e40: 656c 752c 2031 292c 0a20 2020 2020 2020  elu, 1),.       
+00015e50: 2020 2020 2020 2020 2027 6772 6561 7465           'greate
+00015e60: 725f 6f72 5f65 7175 616c 5f74 6861 6e27  r_or_equal_than'
+00015e70: 3a20 2867 7265 6174 6572 5f6f 725f 6571  : (greater_or_eq
+00015e80: 7561 6c5f 7468 616e 2c20 3229 2c0a 2020  ual_than, 2),.  
+00015e90: 2020 2020 2020 2020 2020 2020 2020 276c                'l
+00015ea0: 6573 735f 6f72 5f65 7175 616c 5f74 6861  ess_or_equal_tha
+00015eb0: 6e27 3a20 286c 6573 735f 6f72 5f65 7175  n': (less_or_equ
+00015ec0: 616c 5f74 6861 6e2c 2032 292c 0a20 2020  al_than, 2),.   
+00015ed0: 2020 2020 2020 2020 2020 2020 2027 6772               'gr
+00015ee0: 6561 7465 725f 6f72 5f65 7175 616c 5f74  eater_or_equal_t
+00015ef0: 6861 6e5f 7175 6164 7275 706c 655f 6127  han_quadruple_a'
+00015f00: 3a20 2867 7265 6174 6572 5f6f 725f 6571  : (greater_or_eq
+00015f10: 7561 6c5f 7468 616e 5f71 7561 6472 7570  ual_than_quadrup
+00015f20: 6c65 5f61 2c20 3429 2c0a 2020 2020 2020  le_a, 4),.      
+00015f30: 2020 2020 2020 2020 2020 2767 7265 6174            'great
+00015f40: 6572 5f6f 725f 6571 7561 6c5f 7468 616e  er_or_equal_than
+00015f50: 5f71 7561 6472 7570 6c65 5f62 273a 2028  _quadruple_b': (
+00015f60: 6772 6561 7465 725f 6f72 5f65 7175 616c  greater_or_equal
+00015f70: 5f74 6861 6e5f 7175 6164 7275 706c 655f  _than_quadruple_
+00015f80: 622c 2034 292c 0a20 2020 2020 2020 2020  b, 4),.         
+00015f90: 2020 2020 2020 2027 6772 6561 7465 725f         'greater_
+00015fa0: 6f72 5f65 7175 616c 5f74 6861 6e5f 7175  or_equal_than_qu
+00015fb0: 6164 7275 706c 655f 6327 3a20 2867 7265  adruple_c': (gre
+00015fc0: 6174 6572 5f6f 725f 6571 7561 6c5f 7468  ater_or_equal_th
+00015fd0: 616e 5f71 7561 6472 7570 6c65 5f63 2c20  an_quadruple_c, 
+00015fe0: 3429 2c0a 2020 2020 2020 2020 2020 2020  4),.            
+00015ff0: 2020 2020 276c 6573 735f 7468 616e 5f71      'less_than_q
+00016000: 7561 6472 7570 6c65 5f61 273a 2028 6c65  uadruple_a': (le
+00016010: 7373 5f74 6861 6e5f 7175 6164 7275 706c  ss_than_quadrupl
+00016020: 655f 612c 2034 292c 0a20 2020 2020 2020  e_a, 4),.       
+00016030: 2020 2020 2020 2020 2027 6c65 7373 5f74           'less_t
+00016040: 6861 6e5f 7175 6164 7275 706c 655f 6227  han_quadruple_b'
+00016050: 3a20 286c 6573 735f 7468 616e 5f71 7561  : (less_than_qua
+00016060: 6472 7570 6c65 5f62 2c20 3429 2c0a 2020  druple_b, 4),.  
+00016070: 2020 2020 2020 2020 2020 2020 2020 276c                'l
+00016080: 6573 735f 7468 616e 5f71 7561 6472 7570  ess_than_quadrup
+00016090: 6c65 5f63 273a 2028 6c65 7373 5f74 6861  le_c': (less_tha
+000160a0: 6e5f 7175 6164 7275 706c 655f 632c 2034  n_quadruple_c, 4
+000160b0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+000160c0: 2020 2027 6772 6561 7465 725f 6f72 5f65     'greater_or_e
+000160d0: 7175 616c 5f74 6861 6e5f 646f 7562 6c65  qual_than_double
+000160e0: 5f61 273a 2028 6772 6561 7465 725f 6f72  _a': (greater_or
+000160f0: 5f65 7175 616c 5f74 6861 6e5f 646f 7562  _equal_than_doub
+00016100: 6c65 5f61 2c20 3229 2c0a 2020 2020 2020  le_a, 2),.      
+00016110: 2020 2020 2020 2020 2020 2767 7265 6174            'great
+00016120: 6572 5f6f 725f 6571 7561 6c5f 7468 616e  er_or_equal_than
+00016130: 5f64 6f75 626c 655f 6227 3a20 2867 7265  _double_b': (gre
+00016140: 6174 6572 5f6f 725f 6571 7561 6c5f 7468  ater_or_equal_th
+00016150: 616e 5f64 6f75 626c 655f 622c 2032 292c  an_double_b, 2),
+00016160: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016170: 2027 6772 6561 7465 725f 6f72 5f65 7175   'greater_or_equ
+00016180: 616c 5f74 6861 6e5f 646f 7562 6c65 5f63  al_than_double_c
+00016190: 273a 2028 6772 6561 7465 725f 6f72 5f65  ': (greater_or_e
+000161a0: 7175 616c 5f74 6861 6e5f 646f 7562 6c65  qual_than_double
+000161b0: 5f63 2c20 3229 2c0a 2020 2020 2020 2020  _c, 2),.        
+000161c0: 2020 2020 2020 2020 276c 6573 735f 7468          'less_th
+000161d0: 616e 5f64 6f75 626c 655f 6127 3a20 286c  an_double_a': (l
+000161e0: 6573 735f 7468 616e 5f64 6f75 626c 655f  ess_than_double_
+000161f0: 612c 2032 292c 0a20 2020 2020 2020 2020  a, 2),.         
+00016200: 2020 2020 2020 2027 6c65 7373 5f74 6861         'less_tha
+00016210: 6e5f 646f 7562 6c65 5f62 273a 2028 6c65  n_double_b': (le
+00016220: 7373 5f74 6861 6e5f 646f 7562 6c65 5f62  ss_than_double_b
+00016230: 2c20 3229 2c0a 2020 2020 2020 2020 2020  , 2),.          
+00016240: 2020 2020 2020 276c 6573 735f 7468 616e        'less_than
+00016250: 5f64 6f75 626c 655f 6327 3a20 286c 6573  _double_c': (les
+00016260: 735f 7468 616e 5f64 6f75 626c 655f 632c  s_than_double_c,
+00016270: 2032 292c 0a20 2020 2020 2020 2020 2020   2),.           
+00016280: 2020 2020 2027 7072 6f74 6563 7465 645f       'protected_
+00016290: 6469 7669 7369 6f6e 273a 2028 7072 6f74  division': (prot
+000162a0: 6563 7465 645f 6469 7669 7369 6f6e 2c20  ected_division, 
+000162b0: 3229 2c0a 2020 2020 2020 2020 2020 2020  2),.            
+000162c0: 7d5b 705d 0a20 2020 2020 2020 2020 2020  }[p].           
+000162d0: 206e 616d 6520 3d20 7b0a 2020 2020 2020   name = {.      
+000162e0: 2020 2020 2020 2020 2020 2761 6e61 6c79            'analy
+000162f0: 7469 6361 6c5f 7175 6f74 6965 6e74 273a  tical_quotient':
+00016300: 2027 4151 272c 0a20 2020 2020 2020 2020   'AQ',.         
+00016310: 2020 2020 2020 2027 616e 616c 7974 6963         'analytic
+00016320: 616c 5f6c 6f67 6527 3a20 274c 6f67 272c  al_loge': 'Log',
+00016330: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016340: 2027 6d75 6c74 6970 6c79 273a 2027 4d75   'multiply': 'Mu
+00016350: 6c27 2c0a 2020 2020 2020 2020 2020 2020  l',.            
+00016360: 2020 2020 2761 6464 273a 2027 4164 6427      'add': 'Add'
+00016370: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00016380: 2020 2773 7562 7472 6163 7427 3a20 2753    'subtract': 'S
+00016390: 7562 272c 0a20 2020 2020 2020 2020 2020  ub',.           
+000163a0: 2020 2020 2027 7072 6f74 6563 745f 7371       'protect_sq
+000163b0: 7274 273a 2027 5371 7274 272c 0a20 2020  rt': 'Sqrt',.   
+000163c0: 2020 2020 2020 2020 2020 2020 2027 6d69               'mi
+000163d0: 6e69 6d75 6d27 3a20 224d 696e 222c 0a20  nimum': "Min",. 
+000163e0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+000163f0: 6d61 7869 6d75 6d27 3a20 224d 6178 222c  maximum': "Max",
+00016400: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016410: 2027 7369 6e27 3a20 2253 696e 222c 0a20   'sin': "Sin",. 
+00016420: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00016430: 636f 7327 3a20 2243 6f73 222c 0a20 2020  cos': "Cos",.   
+00016440: 2020 2020 2020 2020 2020 2020 2027 6162               'ab
+00016450: 7327 3a20 2741 6273 272c 0a20 2020 2020  s': 'Abs',.     
+00016460: 2020 2020 2020 2020 2020 2027 7371 7561             'squa
+00016470: 7265 273a 2027 5371 7561 7265 272c 0a20  re': 'Square',. 
+00016480: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00016490: 6375 6265 273a 2027 4375 6265 272c 0a20  cube': 'Cube',. 
+000164a0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+000164b0: 6c65 616b 795f 7265 6c75 273a 2027 4c65  leaky_relu': 'Le
+000164c0: 616b 7952 656c 7527 2c0a 2020 2020 2020  akyRelu',.      
+000164d0: 2020 2020 2020 2020 2020 2763 6272 7427            'cbrt'
+000164e0: 3a20 2743 6272 7427 2c0a 2020 2020 2020  : 'Cbrt',.      
+000164f0: 2020 2020 2020 2020 2020 2774 616e 6827            'tanh'
+00016500: 3a20 2754 616e 6827 2c0a 2020 2020 2020  : 'Tanh',.      
+00016510: 2020 2020 2020 2020 2020 2761 6e61 6c79            'analy
+00016520: 7469 6361 6c5f 6c6f 6731 3027 3a20 274c  tical_log10': 'L
+00016530: 6f67 3130 272c 0a20 2020 2020 2020 2020  og10',.         
+00016540: 2020 207d 2e67 6574 2870 290a 2020 2020     }.get(p).    
+00016550: 2020 2020 2020 2020 6966 2074 7261 6e73          if trans
+00016560: 666f 726d 6572 5f77 7261 7070 6572 3a0a  former_wrapper:.
+00016570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016580: 7073 6574 2e61 6464 5072 696d 6974 6976  pset.addPrimitiv
+00016590: 6528 6d61 6b65 5f63 6c61 7373 2870 7269  e(make_class(pri
+000165a0: 6d69 7469 7665 5b30 5d29 2c20 7072 696d  mitive[0]), prim
+000165b0: 6974 6976 655b 315d 2c20 6e61 6d65 3d6e  itive[1], name=n
+000165c0: 616d 6529 0a20 2020 2020 2020 2020 2020  ame).           
+000165d0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+000165e0: 2020 2020 2020 2070 7365 742e 6164 6450         pset.addP
+000165f0: 7269 6d69 7469 7665 2870 7269 6d69 7469  rimitive(primiti
+00016600: 7665 5b30 5d2c 2070 7269 6d69 7469 7665  ve[0], primitive
+00016610: 5b31 5d2c 206e 616d 653d 6e61 6d65 290a  [1], name=name).
+00016620: 0a20 2020 2064 6566 2061 7263 6869 7665  .    def archive
+00016630: 5f69 6e69 7469 616c 697a 6174 696f 6e28  _initialization(
+00016640: 7365 6c66 293a 0a20 2020 2020 2020 2023  self):.        #
+00016650: 2061 7263 6869 7665 2069 6e69 7469 616c   archive initial
+00016660: 697a 6174 696f 6e0a 2020 2020 2020 2020  ization.        
+00016670: 6966 2073 656c 662e 656e 7365 6d62 6c65  if self.ensemble
+00016680: 5f73 697a 6520 3d3d 2027 6175 746f 273a  _size == 'auto':
+00016690: 0a20 2020 2020 2020 2020 2020 2023 2041  .            # A
+000166a0: 7574 6f6d 6174 6963 616c 6c79 2064 6574  utomatically det
+000166b0: 6572 6d69 6e65 2074 6865 2065 6e73 656d  ermine the ensem
+000166c0: 626c 6520 7369 7a65 0a20 2020 2020 2020  ble size.       
+000166d0: 2020 2020 2073 656c 662e 686f 6620 3d20       self.hof = 
+000166e0: 4c65 7869 6361 7365 484f 4628 290a 2020  LexicaseHOF().  
+000166f0: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
+00016700: 656e 7365 6d62 6c65 5f73 656c 6563 7469  ensemble_selecti
+00016710: 6f6e 203d 3d20 2753 7472 6963 746c 7949  on == 'StrictlyI
+00016720: 6d70 726f 7665 6d65 6e74 273a 0a20 2020  mprovement':.   
+00016730: 2020 2020 2020 2020 2073 656c 662e 686f           self.ho
+00016740: 6620 3d20 5374 7269 6374 6c79 496d 7072  f = StrictlyImpr
+00016750: 6f76 656d 656e 7448 4f46 2873 656c 662e  ovementHOF(self.
+00016760: 656e 7365 6d62 6c65 5f73 697a 6529 0a20  ensemble_size). 
+00016770: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
+00016780: 2e65 6e73 656d 626c 655f 7365 6c65 6374  .ensemble_select
+00016790: 696f 6e20 3d3d 2027 4765 6e65 7261 6c69  ion == 'Generali
+000167a0: 7a61 7469 6f6e 484f 4627 3a0a 2020 2020  zationHOF':.    
+000167b0: 2020 2020 2020 2020 6173 7365 7274 2073          assert s
+000167c0: 656c 662e 656e 7365 6d62 6c65 5f73 697a  elf.ensemble_siz
+000167d0: 6520 3d3d 2031 0a20 2020 2020 2020 2020  e == 1.         
+000167e0: 2020 2073 656c 662e 686f 6620 3d20 4765     self.hof = Ge
+000167f0: 6e65 7261 6c69 7a61 7469 6f6e 484f 4628  neralizationHOF(
+00016800: 7365 6c66 2e58 2c20 7365 6c66 2e79 2c20  self.X, self.y, 
+00016810: 7365 6c66 2e70 7365 742c 2076 6572 626f  self.pset, verbo
+00016820: 7365 3d73 656c 662e 7665 7262 6f73 6529  se=self.verbose)
+00016830: 0a20 2020 2020 2020 2065 6c69 6620 6973  .        elif is
+00016840: 696e 7374 616e 6365 2873 656c 662e 656e  instance(self.en
+00016850: 7365 6d62 6c65 5f73 656c 6563 7469 6f6e  semble_selection
+00016860: 2c20 7374 7229 2061 6e64 2027 5369 6d69  , str) and 'Simi
+00016870: 6c61 7227 2069 6e20 7365 6c66 2e65 6e73  lar' in self.ens
+00016880: 656d 626c 655f 7365 6c65 6374 696f 6e3a  emble_selection:
+00016890: 0a20 2020 2020 2020 2020 2020 2072 6174  .            rat
+000168a0: 696f 203d 2030 2e39 350a 2020 2020 2020  io = 0.95.      
+000168b0: 2020 2020 2020 6966 2027 2d27 2069 6e20        if '-' in 
+000168c0: 7365 6c66 2e65 6e73 656d 626c 655f 7365  self.ensemble_se
+000168d0: 6c65 6374 696f 6e3a 0a20 2020 2020 2020  lection:.       
+000168e0: 2020 2020 2020 2020 2072 6174 696f 203d           ratio =
+000168f0: 2066 6c6f 6174 2873 656c 662e 656e 7365   float(self.ense
+00016900: 6d62 6c65 5f73 656c 6563 7469 6f6e 2e73  mble_selection.s
+00016910: 706c 6974 2827 2d27 295b 315d 290a 0a20  plit('-')[1]).. 
+00016920: 2020 2020 2020 2020 2020 2064 6566 2073             def s
+00016930: 696d 696c 6172 2861 2c20 6229 3a0a 2020  imilar(a, b):.  
+00016940: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00016950: 7475 726e 206e 702e 646f 7428 612e 7072  turn np.dot(a.pr
+00016960: 6564 6963 7465 645f 7661 6c75 6573 2c20  edicted_values, 
+00016970: 622e 7072 6564 6963 7465 645f 7661 6c75  b.predicted_valu
+00016980: 6573 2920 2f20 5c0a 2020 2020 2020 2020  es) / \.        
+00016990: 2020 2020 2020 2020 2020 2020 286e 6f72              (nor
+000169a0: 6d28 612e 7072 6564 6963 7465 645f 7661  m(a.predicted_va
+000169b0: 6c75 6573 2920 2a20 6e6f 726d 2862 2e70  lues) * norm(b.p
+000169c0: 7265 6469 6374 6564 5f76 616c 7565 7329  redicted_values)
+000169d0: 2920 3e20 7261 7469 6f0a 0a20 2020 2020  ) > ratio..     
+000169e0: 2020 2020 2020 2073 656c 662e 686f 6620         self.hof 
+000169f0: 3d20 4861 6c6c 4f66 4661 6d65 2873 656c  = HallOfFame(sel
+00016a00: 662e 656e 7365 6d62 6c65 5f73 697a 652c  f.ensemble_size,
+00016a10: 2073 696d 696c 6172 3d73 696d 696c 6172   similar=similar
+00016a20: 290a 2020 2020 2020 2020 656c 6966 2073  ).        elif s
+00016a30: 656c 662e 656e 7365 6d62 6c65 5f73 656c  elf.ensemble_sel
+00016a40: 6563 7469 6f6e 203d 3d20 2745 7175 616c  ection == 'Equal
+00016a50: 273a 0a20 2020 2020 2020 2020 2020 2064  ':.            d
+00016a60: 6566 2073 696d 696c 6172 2861 2c20 6229  ef similar(a, b)
+00016a70: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00016a80: 2020 7265 7475 726e 206e 702e 616c 6c28    return np.all(
+00016a90: 6e70 2e65 7175 616c 2861 2e70 7265 6469  np.equal(a.predi
+00016aa0: 6374 6564 5f76 616c 7565 732c 2062 2e70  cted_values, b.p
+00016ab0: 7265 6469 6374 6564 5f76 616c 7565 7329  redicted_values)
+00016ac0: 290a 0a20 2020 2020 2020 2020 2020 2073  )..            s
+00016ad0: 656c 662e 686f 6620 3d20 4861 6c6c 4f66  elf.hof = HallOf
+00016ae0: 4661 6d65 2873 656c 662e 656e 7365 6d62  Fame(self.ensemb
+00016af0: 6c65 5f73 697a 652c 2073 696d 696c 6172  le_size, similar
+00016b00: 3d73 696d 696c 6172 290a 2020 2020 2020  =similar).      
+00016b10: 2020 656c 6966 2073 656c 662e 656e 7365    elif self.ense
+00016b20: 6d62 6c65 5f73 656c 6563 7469 6f6e 203d  mble_selection =
+00016b30: 3d20 2742 6f6f 7473 7472 6170 273a 0a20  = 'Bootstrap':. 
+00016b40: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00016b50: 686f 6620 3d20 426f 6f74 7374 7261 7048  hof = BootstrapH
+00016b60: 616c 6c4f 6646 616d 6528 7365 6c66 2e58  allOfFame(self.X
+00016b70: 2c20 7365 6c66 2e65 6e73 656d 626c 655f  , self.ensemble_
+00016b80: 7369 7a65 290a 2020 2020 2020 2020 656c  size).        el
+00016b90: 6966 2073 656c 662e 656e 7365 6d62 6c65  if self.ensemble
+00016ba0: 5f73 656c 6563 7469 6f6e 203d 3d20 274f  _selection == 'O
+00016bb0: 4f42 273a 0a20 2020 2020 2020 2020 2020  OB':.           
+00016bc0: 2073 656c 662e 686f 6620 3d20 4f4f 4248   self.hof = OOBH
+00016bd0: 616c 6c4f 6646 616d 6528 7365 6c66 2e58  allOfFame(self.X
+00016be0: 2c20 7365 6c66 2e79 2c20 7365 6c66 2e74  , self.y, self.t
+00016bf0: 6f6f 6c62 6f78 2c20 7365 6c66 2e65 6e73  oolbox, self.ens
+00016c00: 656d 626c 655f 7369 7a65 290a 2020 2020  emble_size).    
+00016c10: 2020 2020 656c 6966 2073 656c 662e 656e      elif self.en
+00016c20: 7365 6d62 6c65 5f73 656c 6563 7469 6f6e  semble_selection
+00016c30: 203d 3d20 2747 7265 6564 7953 656c 6563   == 'GreedySelec
+00016c40: 7469 6f6e 273a 0a20 2020 2020 2020 2020  tion':.         
+00016c50: 2020 2073 656c 662e 686f 6620 3d20 4772     self.hof = Gr
+00016c60: 6565 6479 5365 6c65 6374 696f 6e48 616c  eedySelectionHal
+00016c70: 6c4f 6646 616d 6528 7365 6c66 2e65 6e73  lOfFame(self.ens
+00016c80: 656d 626c 655f 7369 7a65 2c20 7365 6c66  emble_size, self
+00016c90: 2e79 290a 2020 2020 2020 2020 2020 2020  .y).            
+00016ca0: 7365 6c66 2e68 6f66 2e6e 6f76 656c 7479  self.hof.novelty
+00016cb0: 5f77 6569 6768 7420 3d20 7365 6c66 2e6e  _weight = self.n
+00016cc0: 6f76 656c 7479 5f77 6569 6768 740a 2020  ovelty_weight.  
+00016cd0: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
+00016ce0: 656e 7365 6d62 6c65 5f73 656c 6563 7469  ensemble_selecti
+00016cf0: 6f6e 203d 3d20 2747 7265 6564 7953 656c  on == 'GreedySel
+00016d00: 6563 7469 6f6e 2d52 6573 616d 706c 696e  ection-Resamplin
+00016d10: 6727 3a0a 2020 2020 2020 2020 2020 2020  g':.            
+00016d20: 6966 2069 7369 6e73 7461 6e63 6528 7365  if isinstance(se
+00016d30: 6c66 2c20 436c 6173 7369 6669 6572 4d69  lf, ClassifierMi
+00016d40: 7869 6e29 3a0a 2020 2020 2020 2020 2020  xin):.          
+00016d50: 2020 2020 2020 7365 6c66 2e68 6f66 203d        self.hof =
+00016d60: 2047 7265 6564 7953 656c 6563 7469 6f6e   GreedySelection
+00016d70: 4861 6c6c 4f66 4661 6d65 2873 656c 662e  HallOfFame(self.
+00016d80: 656e 7365 6d62 6c65 5f73 697a 652c 2073  ensemble_size, s
+00016d90: 656c 662e 792c 0a20 2020 2020 2020 2020  elf.y,.         
+00016da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016dc0: 2020 2020 2020 2020 2020 2020 756e 6971              uniq
+00016dd0: 7565 3d46 616c 7365 2c20 6261 6767 696e  ue=False, baggin
+00016de0: 675f 6974 6572 6174 696f 6e3d 3230 2c20  g_iteration=20, 
+00016df0: 6c6f 7373 5f66 756e 6374 696f 6e3d 274d  loss_function='M
+00016e00: 5345 272c 0a20 2020 2020 2020 2020 2020  SE',.           
+00016e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016e30: 2020 2020 2020 2020 2020 696e 6e65 725f            inner_
+00016e40: 7361 6d70 6c69 6e67 3d30 2e35 2c20 6f75  sampling=0.5, ou
+00016e50: 7465 725f 7361 6d70 6c69 6e67 3d30 2e32  ter_sampling=0.2
+00016e60: 3529 0a20 2020 2020 2020 2020 2020 2065  5).            e
+00016e70: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00016e80: 2020 2020 2073 656c 662e 686f 6620 3d20       self.hof = 
+00016e90: 4772 6565 6479 5365 6c65 6374 696f 6e48  GreedySelectionH
+00016ea0: 616c 6c4f 6646 616d 6528 7365 6c66 2e65  allOfFame(self.e
+00016eb0: 6e73 656d 626c 655f 7369 7a65 2c20 7365  nsemble_size, se
+00016ec0: 6c66 2e79 2c0a 2020 2020 2020 2020 2020  lf.y,.          
+00016ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016ef0: 2020 2020 2020 2020 2020 2075 6e69 7175             uniqu
+00016f00: 653d 4661 6c73 652c 2062 6167 6769 6e67  e=False, bagging
+00016f10: 5f69 7465 7261 7469 6f6e 3d32 302c 206c  _iteration=20, l
+00016f20: 6f73 735f 6675 6e63 7469 6f6e 3d27 4d53  oss_function='MS
+00016f30: 4527 2c0a 2020 2020 2020 2020 2020 2020  E',.            
+00016f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016f60: 2020 2020 2020 2020 2069 6e6e 6572 5f73           inner_s
+00016f70: 616d 706c 696e 673d 302e 312c 206f 7574  ampling=0.1, out
+00016f80: 6572 5f73 616d 706c 696e 673d 302e 3235  er_sampling=0.25
+00016f90: 290a 2020 2020 2020 2020 656c 6966 2073  ).        elif s
+00016fa0: 656c 662e 656e 7365 6d62 6c65 5f73 656c  elf.ensemble_sel
+00016fb0: 6563 7469 6f6e 203d 3d20 2747 7265 6564  ection == 'Greed
+00016fc0: 7953 656c 6563 7469 6f6e 2d52 6573 616d  ySelection-Resam
+00016fd0: 706c 696e 672d 4d53 4527 3a0a 2020 2020  pling-MSE':.    
+00016fe0: 2020 2020 2020 2020 7365 6c66 2e68 6f66          self.hof
+00016ff0: 203d 2047 7265 6564 7953 656c 6563 7469   = GreedySelecti
+00017000: 6f6e 4861 6c6c 4f66 4661 6d65 2873 656c  onHallOfFame(sel
+00017010: 662e 656e 7365 6d62 6c65 5f73 697a 652c  f.ensemble_size,
+00017020: 2073 656c 662e 792c 0a20 2020 2020 2020   self.y,.       
+00017030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017050: 2020 2020 2020 2020 2020 756e 6971 7565            unique
+00017060: 3d46 616c 7365 2c20 6261 6767 696e 675f  =False, bagging_
+00017070: 6974 6572 6174 696f 6e3d 3230 2c20 6c6f  iteration=20, lo
+00017080: 7373 5f66 756e 6374 696f 6e3d 274d 5345  ss_function='MSE
+00017090: 2729 0a20 2020 2020 2020 2065 6c69 6620  ').        elif 
+000170a0: 7365 6c66 2e65 6e73 656d 626c 655f 7365  self.ensemble_se
+000170b0: 6c65 6374 696f 6e20 3d3d 2027 4772 6565  lection == 'Gree
+000170c0: 6479 5365 6c65 6374 696f 6e2d 5265 7361  dySelection-Resa
+000170d0: 6d70 6c69 6e67 2d44 6976 6572 7365 273a  mpling-Diverse':
+000170e0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000170f0: 662e 686f 6620 3d20 4772 6565 6479 5365  f.hof = GreedySe
+00017100: 6c65 6374 696f 6e48 616c 6c4f 6646 616d  lectionHallOfFam
+00017110: 6528 7365 6c66 2e65 6e73 656d 626c 655f  e(self.ensemble_
+00017120: 7369 7a65 2c20 7365 6c66 2e79 2c20 6469  size, self.y, di
+00017130: 7665 7273 6974 795f 7261 7469 6f3d 302e  versity_ratio=0.
+00017140: 352c 0a20 2020 2020 2020 2020 2020 2020  5,.             
+00017150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017170: 2020 2020 756e 6971 7565 3d46 616c 7365      unique=False
+00017180: 2c20 6261 6767 696e 675f 6974 6572 6174  , bagging_iterat
+00017190: 696f 6e3d 3230 2c20 6c6f 7373 5f66 756e  ion=20, loss_fun
+000171a0: 6374 696f 6e3d 274d 5345 272c 0a20 2020  ction='MSE',.   
+000171b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000171c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000171d0: 2020 2020 2020 2020 2020 2020 2020 696e                in
+000171e0: 6e65 725f 7361 6d70 6c69 6e67 3d30 2e35  ner_sampling=0.5
+000171f0: 2c20 6f75 7465 725f 7361 6d70 6c69 6e67  , outer_sampling
+00017200: 3d30 2e32 3529 0a20 2020 2020 2020 2065  =0.25).        e
+00017210: 6c69 6620 7365 6c66 2e65 6e73 656d 626c  lif self.ensembl
+00017220: 655f 7365 6c65 6374 696f 6e20 3d3d 2027  e_selection == '
+00017230: 4772 6565 6479 5365 6c65 6374 696f 6e2d  GreedySelection-
+00017240: 5265 7361 6d70 6c69 6e67 2d43 726f 7373  Resampling-Cross
+00017250: 456e 7472 6f70 7927 3a0a 2020 2020 2020  Entropy':.      
+00017260: 2020 2020 2020 7365 6c66 2e68 6f66 203d        self.hof =
+00017270: 2047 7265 6564 7953 656c 6563 7469 6f6e   GreedySelection
+00017280: 4861 6c6c 4f66 4661 6d65 2873 656c 662e  HallOfFame(self.
+00017290: 656e 7365 6d62 6c65 5f73 697a 652c 2073  ensemble_size, s
+000172a0: 656c 662e 792c 0a20 2020 2020 2020 2020  elf.y,.         
+000172b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000172c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000172d0: 2020 2020 2020 2020 756e 6971 7565 3d46          unique=F
+000172e0: 616c 7365 2c20 6261 6767 696e 675f 6974  alse, bagging_it
+000172f0: 6572 6174 696f 6e3d 3230 2c20 6c6f 7373  eration=20, loss
+00017300: 5f66 756e 6374 696f 6e3d 2743 726f 7373  _function='Cross
+00017310: 456e 7472 6f70 7927 290a 2020 2020 2020  Entropy').      
+00017320: 2020 656c 6966 2073 656c 662e 656e 7365    elif self.ense
+00017330: 6d62 6c65 5f73 656c 6563 7469 6f6e 203d  mble_selection =
+00017340: 3d20 2747 7265 6564 7953 656c 6563 7469  = 'GreedySelecti
+00017350: 6f6e 2d52 6573 616d 706c 696e 672d 4869  on-Resampling-Hi
+00017360: 6e67 6527 3a0a 2020 2020 2020 2020 2020  nge':.          
+00017370: 2020 7365 6c66 2e68 6f66 203d 2047 7265    self.hof = Gre
+00017380: 6564 7953 656c 6563 7469 6f6e 4861 6c6c  edySelectionHall
+00017390: 4f66 4661 6d65 2873 656c 662e 656e 7365  OfFame(self.ense
+000173a0: 6d62 6c65 5f73 697a 652c 2073 656c 662e  mble_size, self.
+000173b0: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
+000173c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000173d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000173e0: 2020 2020 756e 6971 7565 3d46 616c 7365      unique=False
+000173f0: 2c20 6261 6767 696e 675f 6974 6572 6174  , bagging_iterat
+00017400: 696f 6e3d 3230 2c20 6c6f 7373 5f66 756e  ion=20, loss_fun
+00017410: 6374 696f 6e3d 2748 696e 6765 2729 0a20  ction='Hinge'). 
+00017420: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
+00017430: 2e65 6e73 656d 626c 655f 7365 6c65 6374  .ensemble_select
+00017440: 696f 6e20 3d3d 2027 4772 6565 6479 5365  ion == 'GreedySe
+00017450: 6c65 6374 696f 6e2d 5265 7361 6d70 6c69  lection-Resampli
+00017460: 6e67 2d5a 6572 6f4f 6e65 273a 0a20 2020  ng-ZeroOne':.   
+00017470: 2020 2020 2020 2020 2073 656c 662e 686f           self.ho
+00017480: 6620 3d20 4772 6565 6479 5365 6c65 6374  f = GreedySelect
+00017490: 696f 6e48 616c 6c4f 6646 616d 6528 7365  ionHallOfFame(se
+000174a0: 6c66 2e65 6e73 656d 626c 655f 7369 7a65  lf.ensemble_size
+000174b0: 2c20 7365 6c66 2e79 2c0a 2020 2020 2020  , self.y,.      
+000174c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000174d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000174e0: 2020 2020 2020 2020 2020 2075 6e69 7175             uniqu
+000174f0: 653d 4661 6c73 652c 2062 6167 6769 6e67  e=False, bagging
+00017500: 5f69 7465 7261 7469 6f6e 3d32 302c 206c  _iteration=20, l
+00017510: 6f73 735f 6675 6e63 7469 6f6e 3d27 5a65  oss_function='Ze
+00017520: 726f 4f6e 6527 290a 2020 2020 2020 2020  roOne').        
+00017530: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
+00017540: 7365 6c66 2e65 6e73 656d 626c 655f 7365  self.ensemble_se
+00017550: 6c65 6374 696f 6e2c 2073 7472 2920 616e  lection, str) an
+00017560: 6420 5c0a 2020 2020 2020 2020 2020 2020  d \.            
+00017570: 7365 6c66 2e65 6e73 656d 626c 655f 7365  self.ensemble_se
+00017580: 6c65 6374 696f 6e2e 7374 6172 7473 7769  lection.startswi
+00017590: 7468 2827 4772 6565 6479 5365 6c65 6374  th('GreedySelect
+000175a0: 696f 6e2d 5265 7361 6d70 6c69 6e67 2d4d  ion-Resampling-M
+000175b0: 5345 2d43 7573 746f 6d2d 2729 3a0a 2020  SE-Custom-'):.  
+000175c0: 2020 2020 2020 2020 2020 7061 7261 6d65            parame
+000175d0: 7465 7220 3d20 7365 6c66 2e65 6e73 656d  ter = self.ensem
+000175e0: 626c 655f 7365 6c65 6374 696f 6e2e 7265  ble_selection.re
+000175f0: 706c 6163 6528 2747 7265 6564 7953 656c  place('GreedySel
+00017600: 6563 7469 6f6e 2d52 6573 616d 706c 696e  ection-Resamplin
+00017610: 672d 4d53 452d 4375 7374 6f6d 2d27 2c20  g-MSE-Custom-', 
+00017620: 2727 290a 2020 2020 2020 2020 2020 2020  '').            
+00017630: 696e 6e65 725f 7361 6d70 6c69 6e67 2c20  inner_sampling, 
+00017640: 6f75 7465 725f 7361 6d70 6c69 6e67 2c20  outer_sampling, 
+00017650: 6261 6767 696e 675f 6974 6572 6174 696f  bagging_iteratio
+00017660: 6e20 3d20 7061 7261 6d65 7465 722e 7370  n = parameter.sp
+00017670: 6c69 7428 272d 2729 0a20 2020 2020 2020  lit('-').       
+00017680: 2020 2020 2069 6e6e 6572 5f73 616d 706c       inner_sampl
+00017690: 696e 6720 3d20 666c 6f61 7428 696e 6e65  ing = float(inne
+000176a0: 725f 7361 6d70 6c69 6e67 290a 2020 2020  r_sampling).    
+000176b0: 2020 2020 2020 2020 6f75 7465 725f 7361          outer_sa
+000176c0: 6d70 6c69 6e67 203d 2066 6c6f 6174 286f  mpling = float(o
+000176d0: 7574 6572 5f73 616d 706c 696e 6729 0a20  uter_sampling). 
+000176e0: 2020 2020 2020 2020 2020 2062 6167 6769             baggi
+000176f0: 6e67 5f69 7465 7261 7469 6f6e 203d 2069  ng_iteration = i
+00017700: 6e74 2862 6167 6769 6e67 5f69 7465 7261  nt(bagging_itera
+00017710: 7469 6f6e 290a 2020 2020 2020 2020 2020  tion).          
+00017720: 2020 7365 6c66 2e68 6f66 203d 2047 7265    self.hof = Gre
+00017730: 6564 7953 656c 6563 7469 6f6e 4861 6c6c  edySelectionHall
+00017740: 4f66 4661 6d65 2873 656c 662e 656e 7365  OfFame(self.ense
+00017750: 6d62 6c65 5f73 697a 652c 2073 656c 662e  mble_size, self.
+00017760: 792c 2064 6976 6572 7369 7479 5f72 6174  y, diversity_rat
+00017770: 696f 3d30 2c0a 2020 2020 2020 2020 2020  io=0,.          
+00017780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000177a0: 2020 2020 2020 2075 6e69 7175 653d 4661         unique=Fa
+000177b0: 6c73 652c 2062 6167 6769 6e67 5f69 7465  lse, bagging_ite
+000177c0: 7261 7469 6f6e 3d62 6167 6769 6e67 5f69  ration=bagging_i
+000177d0: 7465 7261 7469 6f6e 2c20 6c6f 7373 5f66  teration, loss_f
+000177e0: 756e 6374 696f 6e3d 274d 5345 272c 0a20  unction='MSE',. 
+000177f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00017800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017810: 696e 6465 7820 3d20 6469 765f 6c69 7374  index = div_list
-00017820: 5b30 5d5b 315d 0a20 2020 2020 2020 2020  [0][1].         
-00017830: 2020 2020 2020 2065 6e73 656d 626c 655f         ensemble_
-00017840: 7369 7a65 203d 206e 702e 7375 6d28 656e  size = np.sum(en
-00017850: 7365 6d62 6c65 5f6c 6973 7429 0a20 2020  semble_list).   
-00017860: 2020 2020 2020 2020 2020 2020 2074 7269               tri
-00017870: 616c 5f70 7265 6469 6374 696f 6e20 3d20  al_prediction = 
-00017880: 656e 7365 6d62 6c65 5f73 697a 6520 2f20  ensemble_size / 
-00017890: 2865 6e73 656d 626c 655f 7369 7a65 202b  (ensemble_size +
-000178a0: 2031 2920 2a20 6375 7272 656e 745f 7072   1) * current_pr
-000178b0: 6564 6963 7469 6f6e 202b 205c 0a20 2020  ediction + \.   
-000178c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000178d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000178e0: 3120 2f20 2865 6e73 656d 626c 655f 7369  1 / (ensemble_si
-000178f0: 7a65 202b 2031 2920 2a20 7072 6564 6963  ze + 1) * predic
-00017900: 7469 6f6e 735b 696e 6465 785d 0a20 2020  tions[index].   
-00017910: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00017920: 6e70 2e6d 6561 6e28 2828 6375 7272 656e  np.mean(((curren
-00017930: 745f 7072 6564 6963 7469 6f6e 202d 2074  t_prediction - t
-00017940: 7269 616c 5f70 7265 6469 6374 696f 6e29  rial_prediction)
-00017950: 202a 2a20 3229 2920 3c20 302e 3035 3a0a   ** 2)) < 0.05:.
-00017960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017970: 2020 2020 6272 6561 6b0a 2020 2020 2020      break.      
-00017980: 2020 2020 2020 2020 2020 6375 7272 656e            curren
-00017990: 745f 7072 6564 6963 7469 6f6e 203d 2074  t_prediction = t
-000179a0: 7269 616c 5f70 7265 6469 6374 696f 6e0a  rial_prediction.
-000179b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000179c0: 656e 7365 6d62 6c65 5f6c 6973 745b 696e  ensemble_list[in
-000179d0: 6465 785d 203d 2031 0a20 2020 2020 2020  dex] = 1.       
-000179e0: 2020 2020 2020 2020 2072 656d 6169 6e5f           remain_
-000179f0: 696e 642e 7265 6d6f 7665 2869 6e64 6578  ind.remove(index
-00017a00: 290a 2020 2020 2020 2020 2020 2020 656e  ).            en
-00017a10: 7365 6d62 6c65 5f6c 6973 7420 2f3d 206e  semble_list /= n
-00017a20: 702e 7375 6d28 656e 7365 6d62 6c65 5f6c  p.sum(ensemble_l
-00017a30: 6973 7429 0a20 2020 2020 2020 2020 2020  ist).           
-00017a40: 2073 656c 662e 7472 6565 5f77 6569 6768   self.tree_weigh
-00017a50: 7420 3d20 656e 7365 6d62 6c65 5f6c 6973  t = ensemble_lis
-00017a60: 740a 2020 2020 2020 2020 656c 6966 2073  t.        elif s
-00017a70: 656c 662e 7365 636f 6e64 5f6c 6179 6572  elf.second_layer
-00017a80: 203d 3d20 2747 4127 3a0a 2020 2020 2020   == 'GA':.      
-00017a90: 2020 2020 2020 2320 6f6f 6220 6361 6c63        # oob calc
-00017aa0: 756c 6174 696f 6e0a 2020 2020 2020 2020  ulation.        
-00017ab0: 2020 2020 706f 7020 3d20 7365 6c66 2e68      pop = self.h
-00017ac0: 6f66 0a20 2020 2020 2020 2020 2020 2078  of.            x
-00017ad0: 5f74 7261 696e 203d 2073 656c 662e 580a  _train = self.X.
-00017ae0: 2020 2020 2020 2020 2020 2020 6f6f 6220              oob 
-00017af0: 3d20 6e70 2e7a 6572 6f73 2828 6c65 6e28  = np.zeros((len(
-00017b00: 706f 7029 2c20 6c65 6e28 785f 7472 6169  pop), len(x_trai
-00017b10: 6e29 2929 0a20 2020 2020 2020 2020 2020  n))).           
-00017b20: 2066 6f72 2069 2c20 696e 6420 696e 2065   for i, ind in e
-00017b30: 6e75 6d65 7261 7465 2870 6f70 293a 0a20  numerate(pop):. 
-00017b40: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00017b50: 616d 706c 6520 3d20 696e 642e 6f75 745f  ample = ind.out_
-00017b60: 6f66 5f62 6167 0a20 2020 2020 2020 2020  of_bag.         
-00017b70: 2020 2020 2020 2063 686f 7365 6e20 3d20         chosen = 
-00017b80: 6e70 2e7a 6572 6f73 286c 656e 2878 5f74  np.zeros(len(x_t
-00017b90: 7261 696e 2929 0a20 2020 2020 2020 2020  rain)).         
-00017ba0: 2020 2020 2020 2063 686f 7365 6e5b 7361         chosen[sa
-00017bb0: 6d70 6c65 5d20 3d20 310a 2020 2020 2020  mple] = 1.      
-00017bc0: 2020 2020 2020 2020 2020 6f75 745f 6f66            out_of
-00017bd0: 5f62 6167 203d 206e 702e 7768 6572 6528  _bag = np.where(
-00017be0: 6368 6f73 656e 203d 3d20 3029 5b30 5d0a  chosen == 0)[0].
-00017bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017c00: 6675 6e63 203d 2073 656c 662e 746f 6f6c  func = self.tool
-00017c10: 626f 782e 636f 6d70 696c 6528 696e 6469  box.compile(indi
-00017c20: 7669 6475 616c 290a 2020 2020 2020 2020  vidual).        
-00017c30: 2020 2020 2020 2020 5970 203d 2072 6573          Yp = res
-00017c40: 756c 745f 6361 6c63 756c 6174 696f 6e28  ult_calculation(
-00017c50: 6675 6e63 2c20 785f 7472 6169 6e5b 6f75  func, x_train[ou
-00017c60: 745f 6f66 5f62 6167 5d2c 2073 656c 662e  t_of_bag], self.
-00017c70: 6f72 6967 696e 616c 5f66 6561 7475 7265  original_feature
-00017c80: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
-00017c90: 2020 206f 6f62 5b69 5d5b 6f75 745f 6f66     oob[i][out_of
-00017ca0: 5f62 6167 5d20 3d20 696e 642e 7069 7065  _bag] = ind.pipe
-00017cb0: 2e70 7265 6469 6374 2859 7029 0a0a 2020  .predict(Yp)..  
-00017cc0: 2020 2020 2020 2020 2020 7765 6967 6874            weight
-00017cd0: 203d 206f 6f62 5f70 7275 6e69 6e67 286f   = oob_pruning(o
-00017ce0: 6f62 2c20 7365 6c66 2e79 290a 2020 2020  ob, self.y).    
-00017cf0: 2020 2020 2020 2020 7765 6967 6874 203d          weight =
-00017d00: 2077 6569 6768 7420 2f20 6e70 2e73 756d   weight / np.sum
-00017d10: 2877 6569 6768 7429 0a20 2020 2020 2020  (weight).       
-00017d20: 2020 2020 2073 656c 662e 7472 6565 5f77       self.tree_w
-00017d30: 6569 6768 7420 3d20 7765 6967 6874 0a20  eight = weight. 
-00017d40: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
-00017d50: 2e73 6563 6f6e 645f 6c61 7965 7220 3d3d  .second_layer ==
-00017d60: 2027 4341 5750 4527 3a0a 2020 2020 2020   'CAWPE':.      
-00017d70: 2020 2020 2020 706f 7020 3d20 7365 6c66        pop = self
-00017d80: 2e68 6f66 0a20 2020 2020 2020 2020 2020  .hof.           
-00017d90: 2077 6569 6768 7420 3d20 6e70 2e6f 6e65   weight = np.one
-00017da0: 7328 6c65 6e28 706f 7029 290a 2020 2020  s(len(pop)).    
-00017db0: 2020 2020 2020 2020 666f 7220 692c 2069          for i, i
-00017dc0: 6e64 2069 6e20 656e 756d 6572 6174 6528  nd in enumerate(
-00017dd0: 706f 7029 3a0a 2020 2020 2020 2020 2020  pop):.          
-00017de0: 2020 2020 2020 6669 746e 6573 7320 3d20        fitness = 
-00017df0: 696e 642e 6669 746e 6573 732e 7776 616c  ind.fitness.wval
-00017e00: 7565 735b 305d 0a20 2020 2020 2020 2020  ues[0].         
-00017e10: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-00017e20: 616e 6365 2873 656c 662c 2043 6c61 7373  ance(self, Class
-00017e30: 6966 6965 724d 6978 696e 293a 0a20 2020  ifierMixin):.   
-00017e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017e50: 2023 2075 7369 6e67 204d 5345 2061 7320   # using MSE as 
-00017e60: 7468 6520 6465 6661 756c 7420 6669 746e  the default fitn
-00017e70: 6573 7320 6372 6974 6572 696f 6e0a 2020  ess criterion.  
-00017e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017e90: 2020 7765 6967 6874 5b69 5d20 3d20 2831    weight[i] = (1
-00017ea0: 202f 2066 6974 6e65 7373 2920 2a2a 2034   / fitness) ** 4
-00017eb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017ec0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00017ed0: 2020 2020 2020 2020 2020 2023 2075 7369             # usi
-00017ee0: 6e67 2052 5e32 2061 7320 7468 6520 6465  ng R^2 as the de
-00017ef0: 6661 756c 7420 6669 746e 6573 7320 6372  fault fitness cr
-00017f00: 6974 6572 696f 6e0a 2020 2020 2020 2020  iterion.        
-00017f10: 2020 2020 2020 2020 2020 2020 6966 2066              if f
-00017f20: 6974 6e65 7373 203e 2030 3a0a 2020 2020  itness > 0:.    
-00017f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017f40: 2020 2020 7765 6967 6874 5b69 5d20 3d20      weight[i] = 
-00017f50: 2866 6974 6e65 7373 2920 2a2a 2034 0a20  (fitness) ** 4. 
-00017f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017f70: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00017f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017f90: 2077 6569 6768 745b 695d 203d 2030 0a20   weight[i] = 0. 
-00017fa0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00017fb0: 7472 6565 5f77 6569 6768 7420 3d20 7765  tree_weight = we
-00017fc0: 6967 6874 202f 206e 702e 7375 6d28 7765  ight / np.sum(we
-00017fd0: 6967 6874 290a 0a20 2020 2064 6566 2069  ight)..    def i
-00017fe0: 6e64 6976 6964 7561 6c5f 7072 6564 6963  ndividual_predic
-00017ff0: 7469 6f6e 2873 656c 662c 2058 293a 0a20  tion(self, X):. 
-00018000: 2020 2020 2020 2070 7265 6469 6374 696f         predictio
-00018010: 6e73 203d 205b 5d0a 2020 2020 2020 2020  ns = [].        
-00018020: 666f 7220 696e 6469 7669 6475 616c 2069  for individual i
-00018030: 6e20 7365 6c66 2e68 6f66 3a0a 2020 2020  n self.hof:.    
-00018040: 2020 2020 2020 2020 6966 206c 656e 2869          if len(i
-00018050: 6e64 6976 6964 7561 6c2e 6765 6e65 2920  ndividual.gene) 
-00018060: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
-00018070: 2020 2020 2020 636f 6e74 696e 7565 0a20        continue. 
-00018080: 2020 2020 2020 2020 2020 2059 7020 3d20             Yp = 
-00018090: 7175 6963 6b5f 7265 7375 6c74 5f63 616c  quick_result_cal
-000180a0: 6375 6c61 7469 6f6e 2869 6e64 6976 6964  culation(individ
-000180b0: 7561 6c2e 6765 6e65 2c20 7365 6c66 2e70  ual.gene, self.p
-000180c0: 7365 742c 2058 2c20 7365 6c66 2e6f 7269  set, X, self.ori
-000180d0: 6769 6e61 6c5f 6665 6174 7572 6573 2c0a  ginal_features,.
+00017810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017820: 696e 6e65 725f 7361 6d70 6c69 6e67 3d69  inner_sampling=i
+00017830: 6e6e 6572 5f73 616d 706c 696e 672c 206f  nner_sampling, o
+00017840: 7574 6572 5f73 616d 706c 696e 673d 6f75  uter_sampling=ou
+00017850: 7465 725f 7361 6d70 6c69 6e67 290a 2020  ter_sampling).  
+00017860: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
+00017870: 7461 6e63 6528 7365 6c66 2e65 6e73 656d  tance(self.ensem
+00017880: 626c 655f 7365 6c65 6374 696f 6e2c 2073  ble_selection, s
+00017890: 7472 2920 616e 6420 2747 7265 6564 7953  tr) and 'GreedyS
+000178a0: 656c 6563 7469 6f6e 2d52 6573 616d 706c  election-Resampl
+000178b0: 696e 677e 2720 696e 2073 656c 662e 656e  ing~' in self.en
+000178c0: 7365 6d62 6c65 5f73 656c 6563 7469 6f6e  semble_selection
+000178d0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+000178e0: 6c66 2e65 6e73 656d 626c 655f 7365 6c65  lf.ensemble_sele
+000178f0: 6374 696f 6e2c 2069 6e69 7469 616c 5f73  ction, initial_s
+00017900: 697a 6520 3d20 7365 6c66 2e65 6e73 656d  ize = self.ensem
+00017910: 626c 655f 7365 6c65 6374 696f 6e2e 7370  ble_selection.sp
+00017920: 6c69 7428 277e 2729 0a20 2020 2020 2020  lit('~').       
+00017930: 2020 2020 2069 6e69 7469 616c 5f73 697a       initial_siz
+00017940: 6520 3d20 696e 7428 696e 6974 6961 6c5f  e = int(initial_
+00017950: 7369 7a65 290a 2020 2020 2020 2020 2020  size).          
+00017960: 2020 7365 6c66 2e68 6f66 203d 2047 7265    self.hof = Gre
+00017970: 6564 7953 656c 6563 7469 6f6e 4861 6c6c  edySelectionHall
+00017980: 4f66 4661 6d65 2873 656c 662e 656e 7365  OfFame(self.ense
+00017990: 6d62 6c65 5f73 697a 652c 2073 656c 662e  mble_size, self.
+000179a0: 7929 0a20 2020 2020 2020 2020 2020 2073  y).            s
+000179b0: 656c 662e 686f 662e 756e 6971 7565 203d  elf.hof.unique =
+000179c0: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
+000179d0: 2020 2073 656c 662e 686f 662e 6261 6767     self.hof.bagg
+000179e0: 696e 675f 6974 6572 6174 696f 6e20 3d20  ing_iteration = 
+000179f0: 3230 0a20 2020 2020 2020 2020 2020 2073  20.            s
+00017a00: 656c 662e 686f 662e 696e 6974 6961 6c5f  elf.hof.initial_
+00017a10: 7369 7a65 203d 2069 6e69 7469 616c 5f73  size = initial_s
+00017a20: 697a 650a 2020 2020 2020 2020 656c 6966  ize.        elif
+00017a30: 2073 656c 662e 656e 7365 6d62 6c65 5f73   self.ensemble_s
+00017a40: 656c 6563 7469 6f6e 203d 3d20 274e 6f76  election == 'Nov
+00017a50: 656c 7479 5365 6c65 6374 696f 6e27 3a0a  eltySelection':.
+00017a60: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00017a70: 2e68 6f66 203d 204e 6f76 656c 7479 4861  .hof = NoveltyHa
+00017a80: 6c6c 4f66 4661 6d65 2873 656c 662e 656e  llOfFame(self.en
+00017a90: 7365 6d62 6c65 5f73 697a 652c 2073 656c  semble_size, sel
+00017aa0: 662e 7929 0a20 2020 2020 2020 2020 2020  f.y).           
+00017ab0: 2073 656c 662e 686f 662e 6e6f 7665 6c74   self.hof.novelt
+00017ac0: 795f 7765 6967 6874 203d 2073 656c 662e  y_weight = self.
+00017ad0: 6e6f 7665 6c74 795f 7765 6967 6874 0a20  novelty_weight. 
+00017ae0: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
+00017af0: 7374 616e 6365 2873 656c 662e 656e 7365  stance(self.ense
+00017b00: 6d62 6c65 5f73 656c 6563 7469 6f6e 2c20  mble_selection, 
+00017b10: 7374 7229 2061 6e64 2028 2773 696d 696c  str) and ('simil
+00017b20: 6172 2720 696e 2073 656c 662e 656e 7365  ar' in self.ense
+00017b30: 6d62 6c65 5f73 656c 6563 7469 6f6e 293a  mble_selection):
+00017b40: 0a20 2020 2020 2020 2020 2020 2023 2055  .            # U
+00017b50: 7369 6e67 2073 696d 696c 6172 6974 7920  sing similarity 
+00017b60: 6d65 7472 6963 2074 6f20 6669 6c74 6572  metric to filter
+00017b70: 206f 7574 2069 6e64 6976 6964 7561 6c73   out individuals
+00017b80: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00017b90: 272d 2720 696e 2073 656c 662e 656e 7365  '-' in self.ense
+00017ba0: 6d62 6c65 5f73 656c 6563 7469 6f6e 3a0a  mble_selection:.
+00017bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017bc0: 7261 7469 6f20 3d20 666c 6f61 7428 7365  ratio = float(se
+00017bd0: 6c66 2e65 6e73 656d 626c 655f 7365 6c65  lf.ensemble_sele
+00017be0: 6374 696f 6e2e 7370 6c69 7428 272d 2729  ction.split('-')
+00017bf0: 5b31 5d29 0a20 2020 2020 2020 2020 2020  [1]).           
+00017c00: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00017c10: 2020 2020 2020 2072 6174 696f 203d 2030         ratio = 0
+00017c20: 2e39 350a 0a20 2020 2020 2020 2020 2020  .95..           
+00017c30: 2064 6566 2073 696d 696c 6172 2861 2c20   def similar(a, 
+00017c40: 6229 3a0a 2020 2020 2020 2020 2020 2020  b):.            
+00017c50: 2020 2020 7265 7475 726e 2063 6f73 696e      return cosin
+00017c60: 6528 612e 6361 7365 5f76 616c 7565 732c  e(a.case_values,
+00017c70: 2062 2e63 6173 655f 7661 6c75 6573 2920   b.case_values) 
+00017c80: 3e3d 2072 6174 696f 0a0a 2020 2020 2020  >= ratio..      
+00017c90: 2020 2020 2020 7365 6c66 2e68 6f66 203d        self.hof =
+00017ca0: 2048 616c 6c4f 6646 616d 6528 7365 6c66   HallOfFame(self
+00017cb0: 2e65 6e73 656d 626c 655f 7369 7a65 2c20  .ensemble_size, 
+00017cc0: 7369 6d69 6c61 723d 7369 6d69 6c61 7229  similar=similar)
+00017cd0: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
+00017ce0: 6c66 2e73 636f 7265 5f66 756e 6320 3d3d  lf.score_func ==
+00017cf0: 2027 4e6f 7665 6c74 7953 6561 7263 6827   'NoveltySearch'
+00017d00: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00017d10: 2073 656c 662e 656e 7365 6d62 6c65 5f73   self.ensemble_s
+00017d20: 656c 6563 7469 6f6e 203d 3d20 2744 5245  election == 'DRE
+00017d30: 5027 3a0a 2020 2020 2020 2020 2020 2020  P':.            
+00017d40: 2020 2020 7365 6c66 2e68 6f66 203d 2044      self.hof = D
+00017d50: 5245 5048 616c 6c4f 6646 616d 6528 7365  REPHallOfFame(se
+00017d60: 6c66 2e65 6e73 656d 626c 655f 7369 7a65  lf.ensemble_size
+00017d70: 2c20 7365 6c66 2e79 290a 2020 2020 2020  , self.y).      
+00017d80: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
+00017d90: 656e 7365 6d62 6c65 5f73 656c 6563 7469  ensemble_selecti
+00017da0: 6f6e 203d 3d20 2747 7265 6564 7953 656c  on == 'GreedySel
+00017db0: 6563 7469 6f6e 273a 0a20 2020 2020 2020  ection':.       
+00017dc0: 2020 2020 2020 2020 2073 656c 662e 686f           self.ho
+00017dd0: 6620 3d20 4772 6565 6479 5365 6c65 6374  f = GreedySelect
+00017de0: 696f 6e48 616c 6c4f 6646 616d 6528 7365  ionHallOfFame(se
+00017df0: 6c66 2e65 6e73 656d 626c 655f 7369 7a65  lf.ensemble_size
+00017e00: 2c20 7365 6c66 2e79 290a 2020 2020 2020  , self.y).      
+00017e10: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
+00017e20: 656e 7365 6d62 6c65 5f73 656c 6563 7469  ensemble_selecti
+00017e30: 6f6e 203d 3d20 2754 7261 6469 7469 6f6e  on == 'Tradition
+00017e40: 616c 273a 0a20 2020 2020 2020 2020 2020  al':.           
+00017e50: 2020 2020 2073 656c 662e 686f 6620 3d20       self.hof = 
+00017e60: 4861 6c6c 4f66 4661 6d65 2873 656c 662e  HallOfFame(self.
+00017e70: 656e 7365 6d62 6c65 5f73 697a 6529 0a20  ensemble_size). 
+00017e80: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00017e90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017ea0: 2073 656c 662e 686f 6620 3d20 4e6f 7665   self.hof = Nove
+00017eb0: 6c74 7948 616c 6c4f 6646 616d 6528 7365  ltyHallOfFame(se
+00017ec0: 6c66 2e65 6e73 656d 626c 655f 7369 7a65  lf.ensemble_size
+00017ed0: 2c20 7365 6c66 2e79 290a 2020 2020 2020  , self.y).      
+00017ee0: 2020 2020 2020 7365 6c66 2e68 6f66 2e6e        self.hof.n
+00017ef0: 6f76 656c 7479 5f77 6569 6768 7420 3d20  ovelty_weight = 
+00017f00: 7365 6c66 2e6e 6f76 656c 7479 5f77 6569  self.novelty_wei
+00017f10: 6768 740a 2020 2020 2020 2020 656c 6966  ght.        elif
+00017f20: 2073 656c 662e 7661 6c69 6461 7469 6f6e   self.validation
+00017f30: 5f73 697a 6520 3e20 303a 0a20 2020 2020  _size > 0:.     
+00017f40: 2020 2020 2020 2073 656c 662e 686f 6620         self.hof 
+00017f50: 3d20 5661 6c69 6461 7469 6f6e 4861 6c6c  = ValidationHall
+00017f60: 4f66 4661 6d65 2873 656c 662e 656e 7365  OfFame(self.ense
+00017f70: 6d62 6c65 5f73 697a 652c 2073 656c 662e  mble_size, self.
+00017f80: 6765 745f 7661 6c69 6461 7469 6f6e 5f73  get_validation_s
+00017f90: 636f 7265 2c20 7365 6c66 2e61 7263 6869  core, self.archi
+00017fa0: 7665 5f63 6f6e 6669 6775 7261 7469 6f6e  ve_configuration
+00017fb0: 290a 2020 2020 2020 2020 656c 6966 2073  ).        elif s
+00017fc0: 656c 662e 656e 7365 6d62 6c65 5f73 656c  elf.ensemble_sel
+00017fd0: 6563 7469 6f6e 203d 3d20 4e6f 6e65 206f  ection == None o
+00017fe0: 7220 7365 6c66 2e65 6e73 656d 626c 655f  r self.ensemble_
+00017ff0: 7365 6c65 6374 696f 6e20 696e 205b 274e  selection in ['N
+00018000: 6f6e 6527 2c20 276e 6f6e 6527 2c0a 2020  one', 'none',.  
+00018010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018050: 2020 2020 2020 2020 2020 274d 4150 2d45            'MAP-E
+00018060: 6c69 7465 272c 2027 4861 6c66 2d4d 4150  lite', 'Half-MAP
+00018070: 2d45 6c69 7465 272c 0a20 2020 2020 2020  -Elite',.       
+00018080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000180a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000180b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000180c0: 2020 2020 2027 416e 676c 6544 7269 7665       'AngleDrive
+000180d0: 6e53 656c 6563 7469 6f6e 272c 0a20 2020  nSelection',.   
 000180e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000180f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018100: 2020 2020 2020 2020 2020 736b 6c65 6172            sklear
-00018110: 6e5f 666f 726d 6174 3d73 656c 662e 6261  n_format=self.ba
-00018120: 7369 635f 7072 696d 6974 6976 6573 203d  sic_primitives =
-00018130: 3d20 274d 4c27 2c0a 2020 2020 2020 2020  = 'ML',.        
-00018140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018160: 2020 7265 6769 7374 6572 5f61 7272 6179    register_array
-00018170: 3d69 6e64 6976 6964 7561 6c2e 7061 7261  =individual.para
-00018180: 6d65 7465 7273 5b27 5265 6769 7374 6572  meters['Register
-00018190: 275d 0a20 2020 2020 2020 2020 2020 2020  '].             
-000181a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000181b0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000181c0: 7365 6c66 2e6c 6770 5f6d 6f64 6520 3d3d  self.lgp_mode ==
-000181d0: 2027 5265 6769 7374 6572 2720 656c 7365   'Register' else
-000181e0: 204e 6f6e 6529 0a20 2020 2020 2020 2020   None).         
-000181f0: 2020 2070 7265 6469 6374 6564 203d 2069     predicted = i
-00018200: 6e64 6976 6964 7561 6c2e 7069 7065 2e70  ndividual.pipe.p
-00018210: 7265 6469 6374 2859 7029 0a20 2020 2020  redict(Yp).     
-00018220: 2020 2020 2020 2070 7265 6469 6374 696f         predictio
-00018230: 6e73 2e61 7070 656e 6428 7072 6564 6963  ns.append(predic
-00018240: 7465 6429 0a20 2020 2020 2020 2070 7265  ted).        pre
-00018250: 6469 6374 696f 6e73 203d 206e 702e 6172  dictions = np.ar
-00018260: 7261 7928 7072 6564 6963 7469 6f6e 7329  ray(predictions)
-00018270: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00018280: 7072 6564 6963 7469 6f6e 730a 0a20 2020  predictions..   
-00018290: 2064 6566 2062 6f6f 7473 7472 6170 5f66   def bootstrap_f
-000182a0: 6974 6e65 7373 2873 656c 662c 2059 702c  itness(self, Yp,
-000182b0: 2059 5f74 7275 6529 3a0a 2020 2020 2020   Y_true):.      
-000182c0: 2020 6e75 6d20 3d20 6c65 6e28 595f 7472    num = len(Y_tr
-000182d0: 7565 290a 2020 2020 2020 2020 7375 6d20  ue).        sum 
-000182e0: 3d20 5b5d 0a20 2020 2020 2020 2066 6f72  = [].        for
-000182f0: 2069 2069 6e20 7261 6e67 6528 3230 293a   i in range(20):
-00018300: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
-00018310: 6578 203d 206e 702e 7261 6e64 6f6d 2e72  ex = np.random.r
-00018320: 616e 6469 6e74 2830 2c20 6e75 6d2c 206e  andint(0, num, n
-00018330: 756d 290a 2020 2020 2020 2020 2020 2020  um).            
-00018340: 7375 6d2e 6170 7065 6e64 286e 702e 6d65  sum.append(np.me
-00018350: 616e 2828 5970 5b69 6e64 6578 5d20 2d20  an((Yp[index] - 
-00018360: 595f 7472 7565 5b69 6e64 6578 5d29 202a  Y_true[index]) *
-00018370: 2a20 3229 290a 2020 2020 2020 2020 7265  * 2)).        re
-00018380: 7475 726e 206e 702e 6d65 616e 2873 756d  turn np.mean(sum
-00018390: 290a 0a20 2020 2064 6566 2066 696e 616c  )..    def final
-000183a0: 5f6d 6f64 656c 5f6c 617a 795f 7472 6169  _model_lazy_trai
-000183b0: 6e69 6e67 2873 656c 662c 2070 6f70 2c20  ning(self, pop, 
-000183c0: 666f 7263 655f 7472 6169 6e69 6e67 3d46  force_training=F
-000183d0: 616c 7365 293a 0a20 2020 2020 2020 2066  alse):.        f
-000183e0: 6f72 2070 2069 6e20 706f 703a 0a20 2020  or p in pop:.   
-000183f0: 2020 2020 2020 2020 2058 203d 2073 656c           X = sel
-00018400: 662e 580a 2020 2020 2020 2020 2020 2020  f.X.            
-00018410: 6966 2073 656c 662e 7465 7374 5f64 6174  if self.test_dat
-00018420: 615f 7369 7a65 203e 2030 3a0a 2020 2020  a_size > 0:.    
-00018430: 2020 2020 2020 2020 2020 2020 5820 3d20              X = 
-00018440: 585b 3a2d 7365 6c66 2e74 6573 745f 6461  X[:-self.test_da
-00018450: 7461 5f73 697a 655d 0a20 2020 2020 2020  ta_size].       
-00018460: 2020 2020 2059 7020 3d20 7365 6c66 2e66       Yp = self.f
-00018470: 6561 7475 7265 5f67 656e 6572 6174 696f  eature_generatio
-00018480: 6e28 582c 2070 290a 2020 2020 2020 2020  n(X, p).        
-00018490: 2020 2020 7365 6c66 2e74 7261 696e 5f66      self.train_f
-000184a0: 696e 616c 5f6d 6f64 656c 2870 2c20 5970  inal_model(p, Yp
-000184b0: 2c20 7365 6c66 2e79 2c20 666f 7263 655f  , self.y, force_
-000184c0: 7472 6169 6e69 6e67 3d66 6f72 6365 5f74  training=force_t
-000184d0: 7261 696e 696e 6729 0a0a 2020 2020 6465  raining)..    de
-000184e0: 6620 6665 6174 7572 655f 6765 6e65 7261  f feature_genera
-000184f0: 7469 6f6e 2873 656c 662c 2058 2c20 696e  tion(self, X, in
-00018500: 6469 7669 6475 616c 293a 0a20 2020 2020  dividual):.     
-00018510: 2020 2069 6620 696e 6469 7669 6475 616c     if individual
-00018520: 2e61 6374 6976 655f 6765 6e65 5f6e 756d  .active_gene_num
-00018530: 203e 2030 3a0a 2020 2020 2020 2020 2020   > 0:.          
-00018540: 2020 6765 6e65 7320 3d20 696e 6469 7669    genes = indivi
-00018550: 6475 616c 2e67 656e 655b 3a69 6e64 6976  dual.gene[:indiv
-00018560: 6964 7561 6c2e 6163 7469 7665 5f67 656e  idual.active_gen
-00018570: 655f 6e75 6d5d 0a20 2020 2020 2020 2065  e_num].        e
-00018580: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00018590: 2067 656e 6573 203d 2069 6e64 6976 6964   genes = individ
-000185a0: 7561 6c2e 6765 6e65 0a20 2020 2020 2020  ual.gene.       
-000185b0: 2059 7020 3d20 7175 6963 6b5f 7265 7375   Yp = quick_resu
-000185c0: 6c74 5f63 616c 6375 6c61 7469 6f6e 2867  lt_calculation(g
-000185d0: 656e 6573 2c20 7365 6c66 2e70 7365 742c  enes, self.pset,
-000185e0: 2058 2c20 7365 6c66 2e6f 7269 6769 6e61   X, self.origina
-000185f0: 6c5f 6665 6174 7572 6573 2c0a 2020 2020  l_features,.    
-00018600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018620: 2020 736b 6c65 6172 6e5f 666f 726d 6174    sklearn_format
-00018630: 3d73 656c 662e 6261 7369 635f 7072 696d  =self.basic_prim
-00018640: 6974 6976 6573 203d 3d20 274d 4c27 2c0a  itives == 'ML',.
-00018650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018670: 2020 2020 2020 7265 6769 7374 6572 5f61        register_a
-00018680: 7272 6179 3d69 6e64 6976 6964 7561 6c2e  rray=individual.
-00018690: 7061 7261 6d65 7465 7273 5b27 5265 6769  parameters['Regi
-000186a0: 7374 6572 275d 0a20 2020 2020 2020 2020  ster'].         
-000186b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000186c0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000186d0: 7365 6c66 2e6c 6770 5f6d 6f64 6520 3d3d  self.lgp_mode ==
-000186e0: 2027 5265 6769 7374 6572 2720 656c 7365   'Register' else
-000186f0: 204e 6f6e 6529 0a20 2020 2020 2020 2072   None).        r
-00018700: 6574 7572 6e20 5970 0a0a 2020 2020 6465  eturn Yp..    de
-00018710: 6620 7072 6564 6963 7428 7365 6c66 2c20  f predict(self, 
-00018720: 582c 2072 6574 7572 6e5f 7374 643d 4661  X, return_std=Fa
-00018730: 6c73 6529 3a0a 2020 2020 2020 2020 6966  lse):.        if
-00018740: 2073 656c 662e 6e6f 726d 616c 697a 653a   self.normalize:
-00018750: 0a20 2020 2020 2020 2020 2020 2058 203d  .            X =
-00018760: 2073 656c 662e 785f 7363 616c 6572 2e74   self.x_scaler.t
-00018770: 7261 6e73 666f 726d 2858 290a 2020 2020  ransform(X).    
-00018780: 2020 2020 7072 6564 6963 7469 6f6e 5f64      prediction_d
-00018790: 6174 615f 7369 7a65 203d 2058 2e73 6861  ata_size = X.sha
-000187a0: 7065 5b30 5d0a 2020 2020 2020 2020 6966  pe[0].        if
-000187b0: 2073 656c 662e 7465 7374 5f64 6174 615f   self.test_data_
-000187c0: 7369 7a65 203e 2030 3a0a 2020 2020 2020  size > 0:.      
-000187d0: 2020 2020 2020 5820 3d20 6e70 2e63 6f6e        X = np.con
-000187e0: 6361 7465 6e61 7465 285b 7365 6c66 2e58  catenate([self.X
-000187f0: 2c20 585d 290a 2020 2020 2020 2020 7365  , X]).        se
-00018800: 6c66 2e66 696e 616c 5f6d 6f64 656c 5f6c  lf.final_model_l
-00018810: 617a 795f 7472 6169 6e69 6e67 2873 656c  azy_training(sel
-00018820: 662e 686f 6629 0a0a 2020 2020 2020 2020  f.hof)..        
-00018830: 7072 6564 6963 7469 6f6e 7320 3d20 5b5d  predictions = []
-00018840: 0a20 2020 2020 2020 2077 6569 6768 745f  .        weight_
-00018850: 6c69 7374 203d 205b 5d0a 2020 2020 2020  list = [].      
-00018860: 2020 666f 7220 696e 6469 7669 6475 616c    for individual
-00018870: 2069 6e20 7365 6c66 2e68 6f66 3a0a 2020   in self.hof:.  
-00018880: 2020 2020 2020 2020 2020 6966 206c 656e            if len
-00018890: 2869 6e64 6976 6964 7561 6c2e 6765 6e65  (individual.gene
-000188a0: 2920 3d3d 2030 3a0a 2020 2020 2020 2020  ) == 0:.        
-000188b0: 2020 2020 2020 2020 636f 6e74 696e 7565          continue
-000188c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000188d0: 7365 6c66 2e62 6173 6963 5f70 7269 6d69  self.basic_primi
-000188e0: 7469 7665 7320 3d3d 2027 4d4c 273a 0a20  tives == 'ML':. 
-000188f0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00018900: 7265 6469 6374 6564 203d 2069 6e64 6976  redicted = indiv
-00018910: 6964 7561 6c2e 7069 7065 2e70 7265 6469  idual.pipe.predi
-00018920: 6374 2858 290a 2020 2020 2020 2020 2020  ct(X).          
-00018930: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00018940: 2020 2020 2020 2020 5970 203d 2073 656c          Yp = sel
-00018950: 662e 6665 6174 7572 655f 6765 6e65 7261  f.feature_genera
-00018960: 7469 6f6e 2858 2c20 696e 6469 7669 6475  tion(X, individu
-00018970: 616c 290a 2020 2020 2020 2020 2020 2020  al).            
-00018980: 2020 2020 6966 2073 656c 662e 7465 7374      if self.test
-00018990: 5f64 6174 615f 7369 7a65 203e 2030 3a0a  _data_size > 0:.
-000189a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000189b0: 2020 2020 5970 203d 2059 705b 2d70 7265      Yp = Yp[-pre
-000189c0: 6469 6374 696f 6e5f 6461 7461 5f73 697a  diction_data_siz
-000189d0: 653a 5d0a 2020 2020 2020 2020 2020 2020  e:].            
-000189e0: 2020 2020 6966 2073 656c 662e 6261 7365      if self.base
-000189f0: 5f6c 6561 726e 6572 203d 3d20 274e 4e27  _learner == 'NN'
-00018a00: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00018a10: 2020 2020 2020 6e6e 5f70 7265 6469 6374        nn_predict
-00018a20: 696f 6e20 3d20 6765 745f 6163 7469 7661  ion = get_activa
-00018a30: 7469 6f6e 7328 7365 6c66 2e6e 6575 7261  tions(self.neura
-00018a40: 6c5f 6e65 7477 6f72 6b2c 2058 295b 2d32  l_network, X)[-2
-00018a50: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00018a60: 2020 2020 2020 5970 203d 206e 702e 636f        Yp = np.co
-00018a70: 6e63 6174 656e 6174 6528 5b59 702c 206e  ncatenate([Yp, n
-00018a80: 6e5f 7072 6564 6963 7469 6f6e 5d2c 2061  n_prediction], a
-00018a90: 7869 733d 3129 0a20 2020 2020 2020 2020  xis=1).         
-00018aa0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-00018ab0: 616e 6365 2869 6e64 6976 6964 7561 6c2e  ance(individual.
-00018ac0: 7069 7065 5b27 5269 6467 6527 5d2c 2053  pipe['Ridge'], S
-00018ad0: 6f66 7450 4c54 7265 6552 6567 7265 7373  oftPLTreeRegress
-00018ae0: 6f72 2920 616e 6420 5c0a 2020 2020 2020  or) and \.      
-00018af0: 2020 2020 2020 2020 2020 2020 2020 6e6f                no
-00018b00: 7420 6973 696e 7374 616e 6365 2869 6e64  t isinstance(ind
-00018b10: 6976 6964 7561 6c2e 7069 7065 5b27 5269  ividual.pipe['Ri
-00018b20: 6467 6527 5d2c 2053 6f66 7450 4c54 7265  dge'], SoftPLTre
-00018b30: 6552 6567 7265 7373 6f72 454d 293a 0a20  eRegressorEM):. 
-00018b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018b50: 2020 2059 7020 3d20 6e70 2e63 6f6e 6361     Yp = np.conca
-00018b60: 7465 6e61 7465 285b 5970 2c20 6e70 2e7a  tenate([Yp, np.z
-00018b70: 6572 6f73 2828 6c65 6e28 5970 292c 2031  eros((len(Yp), 1
-00018b80: 2929 5d2c 2061 7869 733d 3129 0a20 2020  ))], axis=1).   
-00018b90: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00018ba0: 7365 6c66 2e69 6e74 726f 6e5f 7072 6f62  self.intron_prob
-00018bb0: 6162 696c 6974 7920 3e20 303a 0a20 2020  ability > 0:.   
-00018bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018bd0: 2059 7020 3d20 5970 5b3a 2c20 696e 6469   Yp = Yp[:, indi
-00018be0: 7669 6475 616c 2e70 6172 616d 6574 6572  vidual.parameter
-00018bf0: 735b 2741 6374 6976 6547 656e 6527 5d5d  s['ActiveGene']]
-00018c00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018c10: 2070 7265 6469 6374 6564 203d 2069 6e64   predicted = ind
-00018c20: 6976 6964 7561 6c2e 7069 7065 2e70 7265  ividual.pipe.pre
-00018c30: 6469 6374 2859 7029 0a0a 2020 2020 2020  dict(Yp)..      
-00018c40: 2020 2020 2020 6966 2073 656c 662e 6e6f        if self.no
-00018c50: 726d 616c 697a 653a 0a20 2020 2020 2020  rmalize:.       
-00018c60: 2020 2020 2020 2020 2070 7265 6469 6374           predict
-00018c70: 6564 203d 2073 656c 662e 795f 7363 616c  ed = self.y_scal
-00018c80: 6572 2e69 6e76 6572 7365 5f74 7261 6e73  er.inverse_trans
-00018c90: 666f 726d 2870 7265 6469 6374 6564 2e72  form(predicted.r
-00018ca0: 6573 6861 7065 282d 312c 2031 2929 2e66  eshape(-1, 1)).f
-00018cb0: 6c61 7474 656e 2829 0a20 2020 2020 2020  latten().       
-00018cc0: 2020 2020 2070 7265 6469 6374 696f 6e73       predictions
-00018cd0: 2e61 7070 656e 6428 7072 6564 6963 7465  .append(predicte
-00018ce0: 6429 0a20 2020 2020 2020 2020 2020 2069  d).            i
-00018cf0: 6620 6861 7361 7474 7228 7365 6c66 2e68  f hasattr(self.h
-00018d00: 6f66 2c20 2765 6e73 656d 626c 655f 7765  of, 'ensemble_we
-00018d10: 6967 6874 2729 2061 6e64 206c 656e 2873  ight') and len(s
-00018d20: 656c 662e 686f 662e 656e 7365 6d62 6c65  elf.hof.ensemble
-00018d30: 5f77 6569 6768 7429 203e 2030 3a0a 2020  _weight) > 0:.  
-00018d40: 2020 2020 2020 2020 2020 2020 2020 7765                we
-00018d50: 6967 6874 5f6c 6973 742e 6170 7065 6e64  ight_list.append
-00018d60: 2873 656c 662e 686f 662e 656e 7365 6d62  (self.hof.ensemb
-00018d70: 6c65 5f77 6569 6768 745b 696e 6469 7669  le_weight[indivi
-00018d80: 6475 616c 5f74 6f5f 7475 706c 6528 696e  dual_to_tuple(in
-00018d90: 6469 7669 6475 616c 295d 290a 2020 2020  dividual)]).    
-00018da0: 2020 2020 6966 2073 656c 662e 7365 636f      if self.seco
-00018db0: 6e64 5f6c 6179 6572 203d 3d20 2752 462d  nd_layer == 'RF-
-00018dc0: 526f 7574 696e 6727 3a0a 2020 2020 2020  Routing':.      
-00018dd0: 2020 2020 2020 7365 6c66 2e72 6964 6765        self.ridge
-00018de0: 3a20 5261 6e64 6f6d 466f 7265 7374 436c  : RandomForestCl
-00018df0: 6173 7369 6669 6572 0a20 2020 2020 2020  assifier.       
-00018e00: 2020 2020 2070 726f 6261 203d 2073 656c       proba = sel
-00018e10: 662e 7269 6467 652e 7072 6564 6963 745f  f.ridge.predict_
-00018e20: 7072 6f62 6128 5829 0a20 2020 2020 2020  proba(X).       
-00018e30: 2020 2020 2066 696e 616c 5f70 7265 6469       final_predi
-00018e40: 6374 696f 6e20 3d20 286e 702e 6172 7261  ction = (np.arra
-00018e50: 7928 7072 6564 6963 7469 6f6e 7329 5b73  y(predictions)[s
-00018e60: 656c 662e 7269 6467 652e 6361 6e64 6964  elf.ridge.candid
-00018e70: 6174 6573 5d2e 5420 2a20 7072 6f62 6129  ates].T * proba)
-00018e80: 2e73 756d 2861 7869 733d 3129 0a20 2020  .sum(axis=1).   
-00018e90: 2020 2020 2065 6c69 6620 7365 6c66 2e73       elif self.s
-00018ea0: 6563 6f6e 645f 6c61 7965 7220 213d 2027  econd_layer != '
-00018eb0: 4e6f 6e65 2720 616e 6420 7365 6c66 2e73  None' and self.s
-00018ec0: 6563 6f6e 645f 6c61 7965 7220 213d 204e  econd_layer != N
-00018ed0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00018ee0: 2070 7265 6469 6374 696f 6e73 203d 206e   predictions = n
-00018ef0: 702e 6172 7261 7928 7072 6564 6963 7469  p.array(predicti
-00018f00: 6f6e 7329 2e54 0a20 2020 2020 2020 2020  ons).T.         
-00018f10: 2020 2066 696e 616c 5f70 7265 6469 6374     final_predict
-00018f20: 696f 6e20 3d20 7072 6564 6963 7469 6f6e  ion = prediction
-00018f30: 7320 4020 7365 6c66 2e74 7265 655f 7765  s @ self.tree_we
-00018f40: 6967 6874 0a20 2020 2020 2020 2065 6c69  ight.        eli
-00018f50: 6620 6c65 6e28 7765 6967 6874 5f6c 6973  f len(weight_lis
-00018f60: 7429 203e 2030 3a0a 2020 2020 2020 2020  t) > 0:.        
-00018f70: 2020 2020 7072 6564 6963 7469 6f6e 7320      predictions 
-00018f80: 3d20 6e70 2e61 7272 6179 2870 7265 6469  = np.array(predi
-00018f90: 6374 696f 6e73 292e 540a 2020 2020 2020  ctions).T.      
-00018fa0: 2020 2020 2020 7765 6967 6874 5f6c 6973        weight_lis
-00018fb0: 7420 3d20 6e70 2e61 7272 6179 2877 6569  t = np.array(wei
-00018fc0: 6768 745f 6c69 7374 290a 2020 2020 2020  ght_list).      
-00018fd0: 2020 2020 2020 6966 2072 6574 7572 6e5f        if return_
-00018fe0: 7374 643a 0a20 2020 2020 2020 2020 2020  std:.           
-00018ff0: 2020 2020 2066 696e 616c 5f70 7265 6469       final_predi
-00019000: 6374 696f 6e20 3d20 7765 6967 6874 6564  ction = weighted
-00019010: 5f61 7667 5f61 6e64 5f73 7464 2870 7265  _avg_and_std(pre
-00019020: 6469 6374 696f 6e73 2e54 2c20 7765 6967  dictions.T, weig
-00019030: 6874 5f6c 6973 7429 0a20 2020 2020 2020  ht_list).       
-00019040: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00019050: 2020 2020 2020 2020 2020 2066 696e 616c             final
-00019060: 5f70 7265 6469 6374 696f 6e20 3d20 7072  _prediction = pr
-00019070: 6564 6963 7469 6f6e 7320 4020 7765 6967  edictions @ weig
-00019080: 6874 5f6c 6973 7420 2f20 7765 6967 6874  ht_list / weight
-00019090: 5f6c 6973 742e 7375 6d28 290a 2020 2020  _list.sum().    
-000190a0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-000190b0: 2020 2020 2020 6966 2072 6574 7572 6e5f        if return_
-000190c0: 7374 643a 0a20 2020 2020 2020 2020 2020  std:.           
-000190d0: 2020 2020 2066 696e 616c 5f70 7265 6469       final_predi
-000190e0: 6374 696f 6e20 3d20 6e70 2e6d 6561 6e28  ction = np.mean(
-000190f0: 7072 6564 6963 7469 6f6e 732c 2061 7869  predictions, axi
-00019100: 733d 3029 2c20 6e70 2e73 7464 2870 7265  s=0), np.std(pre
-00019110: 6469 6374 696f 6e73 2c20 6178 6973 3d30  dictions, axis=0
-00019120: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
-00019130: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00019140: 2020 2020 2320 666f 7220 7820 696e 2073      # for x in s
-00019150: 656c 662e 686f 665b 305d 2e67 656e 653a  elf.hof[0].gene:
-00019160: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019170: 2023 2020 2020 2070 7269 6e74 2878 290a   #     print(x).
-00019180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019190: 6966 2073 656c 662e 656e 7365 6d62 6c65  if self.ensemble
-000191a0: 5f70 7265 6469 6374 696f 6e20 3d3d 2027  _prediction == '
-000191b0: 4d65 616e 273a 0a20 2020 2020 2020 2020  Mean':.         
-000191c0: 2020 2020 2020 2020 2020 2066 696e 616c             final
-000191d0: 5f70 7265 6469 6374 696f 6e20 3d20 6e70  _prediction = np
-000191e0: 2e6d 6561 6e28 7072 6564 6963 7469 6f6e  .mean(prediction
-000191f0: 732c 2061 7869 733d 3029 0a20 2020 2020  s, axis=0).     
-00019200: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00019210: 7365 6c66 2e65 6e73 656d 626c 655f 7072  self.ensemble_pr
-00019220: 6564 6963 7469 6f6e 203d 3d20 274d 6564  ediction == 'Med
-00019230: 6961 6e27 3a0a 2020 2020 2020 2020 2020  ian':.          
-00019240: 2020 2020 2020 2020 2020 6669 6e61 6c5f            final_
-00019250: 7072 6564 6963 7469 6f6e 203d 206e 702e  prediction = np.
-00019260: 6d65 6469 616e 2870 7265 6469 6374 696f  median(predictio
-00019270: 6e73 2c20 6178 6973 3d30 290a 2020 2020  ns, axis=0).    
-00019280: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00019290: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000192a0: 2020 2020 2020 7261 6973 6520 4578 6365        raise Exce
-000192b0: 7074 696f 6e0a 2020 2020 2020 2020 6966  ption.        if
-000192c0: 206c 656e 2873 656c 662e 795f 7368 6170   len(self.y_shap
-000192d0: 6529 203d 3d20 323a 0a20 2020 2020 2020  e) == 2:.       
-000192e0: 2020 2020 2066 696e 616c 5f70 7265 6469       final_predi
-000192f0: 6374 696f 6e20 3d20 6669 6e61 6c5f 7072  ction = final_pr
-00019300: 6564 6963 7469 6f6e 2e72 6573 6861 7065  ediction.reshape
-00019310: 282d 312c 2031 290a 2020 2020 2020 2020  (-1, 1).        
-00019320: 7265 7475 726e 2066 696e 616c 5f70 7265  return final_pre
-00019330: 6469 6374 696f 6e0a 0a20 2020 2064 6566  diction..    def
-00019340: 2067 6574 5f68 6f66 2873 656c 6629 3a0a   get_hof(self):.
-00019350: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00019360: 686f 6620 213d 204e 6f6e 653a 0a20 2020  hof != None:.   
-00019370: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00019380: 5b78 2066 6f72 2078 2069 6e20 7365 6c66  [x for x in self
-00019390: 2e68 6f66 5d0a 2020 2020 2020 2020 656c  .hof].        el
-000193a0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-000193b0: 7265 7475 726e 204e 6f6e 650a 0a20 2020  return None..   
-000193c0: 2064 6566 2061 7070 656e 645f 6576 616c   def append_eval
-000193d0: 7561 7465 645f 6665 6174 7572 6573 2873  uated_features(s
-000193e0: 656c 662c 2070 6f70 293a 0a20 2020 2020  elf, pop):.     
-000193f0: 2020 2069 6620 7365 6c66 2e6d 7574 6174     if self.mutat
-00019400: 696f 6e5f 7363 6865 6d65 2069 6e20 6564  ion_scheme in ed
-00019410: 615f 6f70 6572 6174 6f72 7320 6f72 2027  a_operators or '
-00019420: 756e 6966 6f72 6d27 2069 6e20 7365 6c66  uniform' in self
-00019430: 2e6d 7574 6174 696f 6e5f 7363 6865 6d65  .mutation_scheme
-00019440: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00019450: 7475 726e 0a20 2020 2020 2020 2023 2061  turn.        # a
-00019460: 7070 656e 6420 6576 616c 7561 7465 6420  ppend evaluated 
-00019470: 6665 6174 7572 6573 2074 6f20 616e 2061  features to an a
-00019480: 7263 6869 7665 0a20 2020 2020 2020 2023  rchive.        #
-00019490: 2074 6869 7320 6172 6368 6976 6520 6361   this archive ca
-000194a0: 6e20 6265 2075 7365 6420 746f 2065 6c69  n be used to eli
-000194b0: 6d69 6e61 7465 2072 6570 6574 6974 6976  minate repetitiv
-000194c0: 6520 6665 6174 7572 6573 0a20 2020 2020  e features.     
-000194d0: 2020 2069 6620 7365 6c66 2e75 7365 6c65     if self.usele
-000194e0: 7373 5f66 6561 7475 7265 5f72 6174 696f  ss_feature_ratio
-000194f0: 2021 3d20 4e6f 6e65 3a0a 2020 2020 2020   != None:.      
-00019500: 2020 2020 2020 6d65 616e 5f69 6d70 6f72        mean_impor
-00019510: 7461 6e63 6520 3d20 6e70 2e71 7561 6e74  tance = np.quant
-00019520: 696c 6528 5b69 6e64 2e63 6f65 6620 666f  ile([ind.coef fo
-00019530: 7220 696e 6420 696e 2070 6f70 5d2c 2073  r ind in pop], s
-00019540: 656c 662e 7573 656c 6573 735f 6665 6174  elf.useless_feat
-00019550: 7572 655f 7261 7469 6f29 0a20 2020 2020  ure_ratio).     
-00019560: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00019570: 2020 2020 206d 6561 6e5f 696d 706f 7274       mean_import
-00019580: 616e 6365 203d 206e 702e 6172 7261 7928  ance = np.array(
-00019590: 5b69 6e64 2e63 6f65 6620 666f 7220 696e  [ind.coef for in
-000195a0: 6420 696e 2070 6f70 5d29 2e6d 6561 6e28  d in pop]).mean(
-000195b0: 290a 2020 2020 2020 2020 2320 6d65 616e  ).        # mean
-000195c0: 5f69 6d70 6f72 7461 6e63 6520 3d20 6e70  _importance = np
-000195d0: 2e6d 6561 6e28 5b69 6e64 2e66 6974 6e65  .mean([ind.fitne
-000195e0: 7373 2e77 7661 6c75 6573 5b30 5d20 666f  ss.wvalues[0] fo
-000195f0: 7220 696e 6420 696e 2070 6f70 5d29 0a20  r ind in pop]). 
-00019600: 2020 2020 2020 2066 6f72 2069 6e64 2069         for ind i
-00019610: 6e20 706f 703a 0a20 2020 2020 2020 2020  n pop:.         
-00019620: 2020 2023 2069 6620 696e 642e 6669 746e     # if ind.fitn
-00019630: 6573 732e 7776 616c 7565 735b 305d 203c  ess.wvalues[0] <
-00019640: 3d20 6d65 616e 5f69 6d70 6f72 7461 6e63  = mean_importanc
-00019650: 653a 0a20 2020 2020 2020 2020 2020 2066  e:.            f
-00019660: 6f72 2067 656e 652c 2063 2069 6e20 7a69  or gene, c in zi
-00019670: 7028 696e 642e 6765 6e65 2c20 696e 642e  p(ind.gene, ind.
-00019680: 636f 6566 293a 0a20 2020 2020 2020 2020  coef):.         
-00019690: 2020 2020 2020 2069 6620 6320 3c3d 206d         if c <= m
-000196a0: 6561 6e5f 696d 706f 7274 616e 6365 3a0a  ean_importance:.
+00018100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018120: 2020 2020 2020 2020 2027 4d61 7841 6e67           'MaxAng
+00018130: 6c65 5365 6c65 6374 696f 6e27 5d3a 0a20  leSelection']:. 
+00018140: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00018150: 6c66 2e72 6564 756e 6461 6e74 5f68 6f66  lf.redundant_hof
+00018160: 5f73 697a 6520 3e20 303a 0a20 2020 2020  _size > 0:.     
+00018170: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00018180: 686f 6620 3d20 4861 6c6c 4f66 4661 6d65  hof = HallOfFame
+00018190: 2873 656c 662e 7265 6475 6e64 616e 745f  (self.redundant_
+000181a0: 686f 665f 7369 7a65 290a 2020 2020 2020  hof_size).      
+000181b0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+000181c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000181d0: 2e68 6f66 203d 2048 616c 6c4f 6646 616d  .hof = HallOfFam
+000181e0: 6528 7365 6c66 2e65 6e73 656d 626c 655f  e(self.ensemble_
+000181f0: 7369 7a65 290a 2020 2020 2020 2020 656c  size).        el
+00018200: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00018210: 7261 6973 6520 4578 6365 7074 696f 6e0a  raise Exception.
+00018220: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00018230: 7461 6e63 6528 7365 6c66 2e68 6f66 2c20  tance(self.hof, 
+00018240: 456e 7365 6d62 6c65 5365 6c65 6374 696f  EnsembleSelectio
+00018250: 6e48 616c 6c4f 6646 616d 6529 3a0a 2020  nHallOfFame):.  
+00018260: 2020 2020 2020 2020 2020 7365 6c66 2e68            self.h
+00018270: 6f66 2e76 6572 626f 7365 203d 2073 656c  of.verbose = sel
+00018280: 662e 7665 7262 6f73 650a 0a20 2020 2020  f.verbose..     
+00018290: 2020 2069 6620 7365 6c66 2e62 6c6f 6174     if self.bloat
+000182a0: 5f63 6f6e 7472 6f6c 2069 7320 6e6f 7420  _control is not 
+000182b0: 4e6f 6e65 2061 6e64 2073 656c 662e 626c  None and self.bl
+000182c0: 6f61 745f 636f 6e74 726f 6c2e 6765 7428  oat_control.get(
+000182d0: 226c 6173 736f 5f70 7275 6e65 222c 2046  "lasso_prune", F
+000182e0: 616c 7365 293a 0a20 2020 2020 2020 2020  alse):.         
+000182f0: 2020 2063 616e 6469 6461 7465 7320 3d20     candidates = 
+00018300: 7365 6c66 2e62 6c6f 6174 5f63 6f6e 7472  self.bloat_contr
+00018310: 6f6c 2e67 6574 2822 6c61 7373 6f5f 6361  ol.get("lasso_ca
+00018320: 6e64 6964 6174 6573 222c 2031 290a 2020  ndidates", 1).  
+00018330: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
+00018340: 6173 736f 5f68 6f66 203d 2048 616c 6c4f  asso_hof = HallO
+00018350: 6646 616d 6528 6361 6e64 6964 6174 6573  fFame(candidates
+00018360: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+00018370: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00018380: 2e6c 6173 736f 5f68 6f66 203d 204e 6f6e  .lasso_hof = Non
+00018390: 650a 0a20 2020 2064 6566 2067 6574 5f74  e..    def get_t
+000183a0: 6572 6d69 6e61 6c5f 7072 6f62 6162 696c  erminal_probabil
+000183b0: 6974 7928 7365 6c66 293a 0a20 2020 2020  ity(self):.     
+000183c0: 2020 2022 2222 0a20 2020 2020 2020 2055     """.        U
+000183d0: 7369 6e67 2066 6561 7475 7265 2069 6d70  sing feature imp
+000183e0: 6f72 7461 6e63 6520 6174 2069 6e69 7469  ortance at initi
+000183f0: 616c 697a 6174 696f 6e0a 2020 2020 2020  alization.      
+00018400: 2020 2222 220a 2020 2020 2020 2020 2320    """.        # 
+00018410: 6765 7420 6120 7072 6f62 6162 696c 6974  get a probabilit
+00018420: 7920 6469 7374 7269 6275 7469 6f6e 2062  y distribution b
+00018430: 6173 6564 206f 6e20 7468 6520 696d 706f  ased on the impo
+00018440: 7274 616e 6365 206f 6620 6f72 6967 696e  rtance of origin
+00018450: 616c 2066 6561 7475 7265 7320 696e 2061  al features in a
+00018460: 2072 616e 646f 6d20 666f 7265 7374 0a20   random forest. 
+00018470: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00018480: 616e 6365 2873 656c 662c 2045 766f 6c75  ance(self, Evolu
+00018490: 7469 6f6e 6172 7946 6f72 6573 7443 6c61  tionaryForestCla
+000184a0: 7373 6966 6965 7229 3a0a 2020 2020 2020  ssifier):.      
+000184b0: 2020 2020 2020 7220 3d20 5261 6e64 6f6d        r = Random
+000184c0: 466f 7265 7374 436c 6173 7369 6669 6572  ForestClassifier
+000184d0: 286e 5f65 7374 696d 6174 6f72 733d 3529  (n_estimators=5)
+000184e0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+000184f0: 2020 2020 2020 2020 2020 2072 203d 2052             r = R
+00018500: 616e 646f 6d46 6f72 6573 7452 6567 7265  andomForestRegre
+00018510: 7373 6f72 286e 5f65 7374 696d 6174 6f72  ssor(n_estimator
+00018520: 733d 3529 0a20 2020 2020 2020 2072 2e66  s=5).        r.f
+00018530: 6974 2873 656c 662e 582c 2073 656c 662e  it(self.X, self.
+00018540: 7929 0a20 2020 2020 2020 2074 6572 6d69  y).        termi
+00018550: 6e61 6c5f 7072 6f62 203d 206e 702e 6170  nal_prob = np.ap
+00018560: 7065 6e64 2872 2e66 6561 7475 7265 5f69  pend(r.feature_i
+00018570: 6d70 6f72 7461 6e63 6573 5f2c 2030 2e31  mportances_, 0.1
+00018580: 290a 2020 2020 2020 2020 7465 726d 696e  ).        termin
+00018590: 616c 5f70 726f 6220 3d20 7465 726d 696e  al_prob = termin
+000185a0: 616c 5f70 726f 6220 2f20 6e70 2e73 756d  al_prob / np.sum
+000185b0: 2874 6572 6d69 6e61 6c5f 7072 6f62 290a  (terminal_prob).
+000185c0: 2020 2020 2020 2020 7265 7475 726e 2074          return t
+000185d0: 6572 6d69 6e61 6c5f 7072 6f62 0a0a 2020  erminal_prob..  
+000185e0: 2020 6465 6620 636f 6e73 7472 7563 745f    def construct_
+000185f0: 676c 6f62 616c 5f66 6561 7475 7265 5f70  global_feature_p
+00018600: 6f6f 6c28 7365 6c66 2c20 706f 7029 3a0a  ool(self, pop):.
+00018610: 2020 2020 2020 2020 676f 6f64 5f66 6561          good_fea
+00018620: 7475 7265 732c 2074 6872 6573 686f 6c64  tures, threshold
+00018630: 203d 2063 6f6e 7374 7275 6374 5f66 6561   = construct_fea
+00018640: 7475 7265 5f70 6f6f 6c73 2870 6f70 2c20  ture_pools(pop, 
+00018650: 5472 7565 2c20 7468 7265 7368 6f6c 645f  True, threshold_
+00018660: 7261 7469 6f3d 7365 6c66 2e63 785f 7468  ratio=self.cx_th
+00018670: 7265 7368 6f6c 645f 7261 7469 6f2c 0a20  reshold_ratio,. 
+00018680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000186a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000186b0: 2020 2020 2020 2020 2020 676f 6f64 5f66            good_f
+000186c0: 6561 7475 7265 735f 7468 7265 7368 6f6c  eatures_threshol
+000186d0: 643d 7365 6c66 2e67 6f6f 645f 6665 6174  d=self.good_feat
+000186e0: 7572 6573 5f74 6872 6573 686f 6c64 290a  ures_threshold).
+000186f0: 2020 2020 2020 2020 7365 6c66 2e67 6f6f          self.goo
+00018700: 645f 6665 6174 7572 6573 203d 2067 6f6f  d_features = goo
+00018710: 645f 6665 6174 7572 6573 0a20 2020 2020  d_features.     
+00018720: 2020 2073 656c 662e 6378 5f74 6872 6573     self.cx_thres
+00018730: 686f 6c64 203d 2074 6872 6573 686f 6c64  hold = threshold
+00018740: 0a0a 2020 2020 6465 6620 6669 7428 7365  ..    def fit(se
+00018750: 6c66 2c20 582c 2079 2c20 7465 7374 5f58  lf, X, y, test_X
+00018760: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+00018770: 7365 6c66 2e79 5f73 6861 7065 203d 2079  self.y_shape = y
+00018780: 2e73 6861 7065 0a20 2020 2020 2020 2023  .shape.        #
+00018790: 2073 656c 662e 6665 6174 7572 655f 7479   self.feature_ty
+000187a0: 7065 7320 3d20 7479 7065 5f64 6574 6563  pes = type_detec
+000187b0: 7469 6f6e 2858 290a 2020 2020 2020 2020  tion(X).        
+000187c0: 6966 2073 656c 662e 6e6f 726d 616c 697a  if self.normaliz
+000187d0: 653a 0a20 2020 2020 2020 2020 2020 2058  e:.            X
+000187e0: 203d 2073 656c 662e 785f 7363 616c 6572   = self.x_scaler
+000187f0: 2e66 6974 5f74 7261 6e73 666f 726d 2858  .fit_transform(X
+00018800: 2c20 7929 0a20 2020 2020 2020 2020 2020  , y).           
+00018810: 2079 203d 2073 656c 662e 795f 7363 616c   y = self.y_scal
+00018820: 6572 2e66 6974 5f74 7261 6e73 666f 726d  er.fit_transform
+00018830: 286e 702e 6172 7261 7928 7929 2e72 6573  (np.array(y).res
+00018840: 6861 7065 282d 312c 2031 2929 0a20 2020  hape(-1, 1)).   
+00018850: 2020 2020 2020 2020 2069 6620 7465 7374           if test
+00018860: 5f58 2069 7320 6e6f 7420 4e6f 6e65 3a0a  _X is not None:.
+00018870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018880: 7465 7374 5f58 203d 2073 656c 662e 785f  test_X = self.x_
+00018890: 7363 616c 6572 2e74 7261 6e73 666f 726d  scaler.transform
+000188a0: 2874 6573 745f 5829 0a20 2020 2020 2020  (test_X).       
+000188b0: 2020 2020 2020 2020 2073 656c 662e 7465           self.te
+000188c0: 7374 5f58 203d 2074 6573 745f 580a 0a20  st_X = test_X.. 
+000188d0: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
+000188e0: 616c 6964 6174 696f 6e5f 7369 7a65 203e  alidation_size >
+000188f0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+00018900: 582c 2073 656c 662e 7661 6c69 645f 782c  X, self.valid_x,
+00018910: 2079 2c20 7365 6c66 2e76 616c 6964 5f79   y, self.valid_y
+00018920: 203d 2074 7261 696e 5f74 6573 745f 7370   = train_test_sp
+00018930: 6c69 7428 582c 2079 2c20 7465 7374 5f73  lit(X, y, test_s
+00018940: 697a 653d 7365 6c66 2e76 616c 6964 6174  ize=self.validat
+00018950: 696f 6e5f 7369 7a65 290a 2020 2020 2020  ion_size).      
+00018960: 2020 2020 2020 7365 6c66 2e76 616c 6964        self.valid
+00018970: 5f79 203d 2073 656c 662e 7661 6c69 645f  _y = self.valid_
+00018980: 792e 666c 6174 7465 6e28 290a 2020 2020  y.flatten().    
+00018990: 2020 2020 7365 6c66 2e58 3a20 6e70 2e6e      self.X: np.n
+000189a0: 6461 7272 6179 0a20 2020 2020 2020 2073  darray.        s
+000189b0: 656c 662e 793a 206e 702e 6e64 6172 7261  elf.y: np.ndarra
+000189c0: 790a 2020 2020 2020 2020 7365 6c66 2e58  y.        self.X
+000189d0: 2c20 7365 6c66 2e79 203d 2058 2c20 792e  , self.y = X, y.
+000189e0: 666c 6174 7465 6e28 290a 2020 2020 2020  flatten().      
+000189f0: 2020 6966 2073 656c 662e 656e 7669 726f    if self.enviro
+00018a00: 6e6d 656e 7461 6c5f 7365 6c65 6374 696f  nmental_selectio
+00018a10: 6e20 3d3d 2027 4e53 4741 322d 4d69 7875  n == 'NSGA2-Mixu
+00018a20: 7027 3a0a 2020 2020 2020 2020 2020 2020  p':.            
+00018a30: 7265 6775 6c61 7269 7a61 7469 6f6e 5f6d  regularization_m
+00018a40: 6f64 656c 203d 2073 656c 662e 7061 7261  odel = self.para
+00018a50: 6d5b 2772 6567 756c 6172 697a 6174 696f  m['regularizatio
+00018a60: 6e5f 6d6f 6465 6c27 5d0a 2020 2020 2020  n_model'].      
+00018a70: 2020 2020 2020 6966 2072 6567 756c 6172        if regular
+00018a80: 697a 6174 696f 6e5f 6d6f 6465 6c20 3d3d  ization_model ==
+00018a90: 2027 4c47 424d 273a 0a20 2020 2020 2020   'LGBM':.       
+00018aa0: 2020 2020 2020 2020 206c 6762 6d20 3d20           lgbm = 
+00018ab0: 4c47 424d 5265 6772 6573 736f 7228 290a  LGBMRegressor().
+00018ac0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00018ad0: 2072 6567 756c 6172 697a 6174 696f 6e5f   regularization_
+00018ae0: 6d6f 6465 6c20 3d3d 2027 5356 5227 3a0a  model == 'SVR':.
+00018af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018b00: 6c67 626d 203d 2053 5652 2829 0a20 2020  lgbm = SVR().   
+00018b10: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00018b20: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00018b30: 6169 7365 2045 7863 6570 7469 6f6e 0a20  aise Exception. 
+00018b40: 2020 2020 2020 2020 2020 206c 6762 6d2e             lgbm.
+00018b50: 6669 7428 7365 6c66 2e58 2c20 7365 6c66  fit(self.X, self
+00018b60: 2e79 290a 2020 2020 2020 2020 2020 2020  .y).            
+00018b70: 7365 6c66 2e70 7365 7564 6f5f 6c61 6265  self.pseudo_labe
+00018b80: 6c20 3d20 6c67 626d 2e70 7265 6469 6374  l = lgbm.predict
+00018b90: 2873 656c 662e 7465 7374 5f58 290a 2020  (self.test_X).  
+00018ba0: 2020 2020 2020 6966 2073 656c 662e 656e        if self.en
+00018bb0: 7669 726f 6e6d 656e 7461 6c5f 7365 6c65  vironmental_sele
+00018bc0: 6374 696f 6e20 3d3d 2027 4e53 4741 322d  ction == 'NSGA2-
+00018bd0: 3130 3027 3a0a 2020 2020 2020 2020 2020  100':.          
+00018be0: 2020 7365 6c66 2e72 616e 646f 6d5f 6f62    self.random_ob
+00018bf0: 6a65 6374 6976 6573 203d 206e 702e 7261  jectives = np.ra
+00018c00: 6e64 6f6d 2e75 6e69 666f 726d 2830 2c20  ndom.uniform(0, 
+00018c10: 312c 2073 697a 653d 286c 656e 2879 292c  1, size=(len(y),
+00018c20: 2031 3030 2929 0a20 2020 2020 2020 2069   100)).        i
+00018c30: 6620 7365 6c66 2e65 6e76 6972 6f6e 6d65  f self.environme
+00018c40: 6e74 616c 5f73 656c 6563 7469 6f6e 203d  ntal_selection =
+00018c50: 3d20 274e 5347 4132 2d31 3030 2d4e 6f72  = 'NSGA2-100-Nor
+00018c60: 6d61 6c27 3a0a 2020 2020 2020 2020 2020  mal':.          
+00018c70: 2020 7365 6c66 2e72 616e 646f 6d5f 6f62    self.random_ob
+00018c80: 6a65 6374 6976 6573 203d 2074 7275 6e63  jectives = trunc
+00018c90: 6174 6564 5f6e 6f72 6d61 6c28 7361 6d70  ated_normal(samp
+00018ca0: 6c65 3d28 6c65 6e28 7929 2c20 3130 3029  le=(len(y), 100)
+00018cb0: 290a 2020 2020 2020 2020 6966 2073 656c  ).        if sel
+00018cc0: 662e 656e 7669 726f 6e6d 656e 7461 6c5f  f.environmental_
+00018cd0: 7365 6c65 6374 696f 6e20 3d3d 2027 4e53  selection == 'NS
+00018ce0: 4741 322d 3130 302d 4c48 5327 3a0a 2020  GA2-100-LHS':.  
+00018cf0: 2020 2020 2020 2020 2020 6672 6f6d 2073            from s
+00018d00: 6d74 2e73 616d 706c 696e 675f 6d65 7468  mt.sampling_meth
+00018d10: 6f64 7320 696d 706f 7274 204c 4853 0a20  ods import LHS. 
+00018d20: 2020 2020 2020 2020 2020 2078 6c69 6d69             xlimi
+00018d30: 7473 203d 206e 702e 7265 7065 6174 286e  ts = np.repeat(n
+00018d40: 702e 6172 7261 7928 5b5b 302e 302c 2031  p.array([[0.0, 1
+00018d50: 2e30 5d5d 292c 206c 656e 2879 292c 2061  .0]]), len(y), a
+00018d60: 7869 733d 3029 0a20 2020 2020 2020 2020  xis=0).         
+00018d70: 2020 2073 616d 706c 696e 6720 3d20 4c48     sampling = LH
+00018d80: 5328 786c 696d 6974 733d 786c 696d 6974  S(xlimits=xlimit
+00018d90: 7329 0a20 2020 2020 2020 2020 2020 206e  s).            n
+00018da0: 756d 203d 2031 3030 0a20 2020 2020 2020  um = 100.       
+00018db0: 2020 2020 2073 656c 662e 7261 6e64 6f6d       self.random
+00018dc0: 5f6f 626a 6563 7469 7665 7320 3d20 7361  _objectives = sa
+00018dd0: 6d70 6c69 6e67 286e 756d 292e 540a 0a20  mpling(num).T.. 
+00018de0: 2020 2020 2020 2073 656c 662e 6c61 7a79         self.lazy
+00018df0: 5f69 6e69 7428 5829 0a0a 2020 2020 2020  _init(X)..      
+00018e00: 2020 7374 6174 735f 6669 7420 3d20 746f    stats_fit = to
+00018e10: 6f6c 732e 5374 6174 6973 7469 6373 286c  ols.Statistics(l
+00018e20: 616d 6264 6120 696e 643a 2069 6e64 2e66  ambda ind: ind.f
+00018e30: 6974 6e65 7373 2e77 7661 6c75 6573 290a  itness.wvalues).
+00018e40: 2020 2020 2020 2020 7374 6174 735f 7369          stats_si
+00018e50: 7a65 203d 2074 6f6f 6c73 2e53 7461 7469  ze = tools.Stati
+00018e60: 7374 6963 7328 6c61 6d62 6461 2078 3a20  stics(lambda x: 
+00018e70: 6c65 6e28 7829 202f 2f20 6c65 6e28 782e  len(x) // len(x.
+00018e80: 6765 6e65 2929 0a20 2020 2020 2020 206d  gene)).        m
+00018e90: 7374 6174 7320 3d20 746f 6f6c 732e 4d75  stats = tools.Mu
+00018ea0: 6c74 6953 7461 7469 7374 6963 7328 6669  ltiStatistics(fi
+00018eb0: 746e 6573 733d 7374 6174 735f 6669 742c  tness=stats_fit,
+00018ec0: 2073 697a 653d 7374 6174 735f 7369 7a65   size=stats_size
+00018ed0: 290a 2020 2020 2020 2020 6d73 7461 7473  ).        mstats
+00018ee0: 2e72 6567 6973 7465 7228 2261 7667 222c  .register("avg",
+00018ef0: 206e 702e 6d65 616e 2c20 6178 6973 3d30   np.mean, axis=0
+00018f00: 290a 2020 2020 2020 2020 6d73 7461 7473  ).        mstats
+00018f10: 2e72 6567 6973 7465 7228 2273 7464 222c  .register("std",
+00018f20: 206e 702e 7374 642c 2061 7869 733d 3029   np.std, axis=0)
+00018f30: 0a20 2020 2020 2020 206d 7374 6174 732e  .        mstats.
+00018f40: 7265 6769 7374 6572 2822 3235 2522 2c20  register("25%", 
+00018f50: 7061 7274 6961 6c28 6e70 2e71 7561 6e74  partial(np.quant
+00018f60: 696c 652c 2071 3d30 2e32 3529 2c20 6178  ile, q=0.25), ax
+00018f70: 6973 3d30 290a 2020 2020 2020 2020 6d73  is=0).        ms
+00018f80: 7461 7473 2e72 6567 6973 7465 7228 2237  tats.register("7
+00018f90: 3525 222c 2070 6172 7469 616c 286e 702e  5%", partial(np.
+00018fa0: 7175 616e 7469 6c65 2c20 713d 302e 3735  quantile, q=0.75
+00018fb0: 292c 2061 7869 733d 3029 0a20 2020 2020  ), axis=0).     
+00018fc0: 2020 206d 7374 6174 732e 7265 6769 7374     mstats.regist
+00018fd0: 6572 2822 6d65 6469 616e 222c 206e 702e  er("median", np.
+00018fe0: 6d65 6469 616e 2c20 6178 6973 3d30 290a  median, axis=0).
+00018ff0: 2020 2020 2020 2020 6d73 7461 7473 2e72          mstats.r
+00019000: 6567 6973 7465 7228 226d 696e 222c 206e  egister("min", n
+00019010: 702e 6d69 6e2c 2061 7869 733d 3029 0a20  p.min, axis=0). 
+00019020: 2020 2020 2020 206d 7374 6174 732e 7265         mstats.re
+00019030: 6769 7374 6572 2822 6d61 7822 2c20 6e70  gister("max", np
+00019040: 2e6d 6178 2c20 6178 6973 3d30 290a 0a20  .max, axis=0).. 
+00019050: 2020 2020 2020 2069 6620 7365 6c66 2e67         if self.g
+00019060: 7261 6469 656e 745f 626f 6f73 7469 6e67  radient_boosting
+00019070: 3a0a 2020 2020 2020 2020 2020 2020 6173  :.            as
+00019080: 7365 7274 2073 656c 662e 626f 6f73 745f  sert self.boost_
+00019090: 7369 7a65 203d 3d20 312c 2022 4f6e 6c79  size == 1, "Only
+000190a0: 2073 7570 706f 7274 7320 6120 7369 6e67   supports a sing
+000190b0: 6c65 206d 6f64 656c 220a 2020 2020 2020  le model".      
+000190c0: 2020 2020 2020 2320 e789 b9e5 be81 e5b7        # ........
+000190d0: a5e7 a88b 0a20 2020 2020 2020 2020 2020  .....           
+000190e0: 206f 7269 6769 6e61 6c5f 7920 3d20 636f   original_y = co
+000190f0: 7079 2e64 6565 7063 6f70 7928 7365 6c66  py.deepcopy(self
+00019100: 2e79 290a 2020 2020 2020 2020 2020 2020  .y).            
+00019110: 6f72 6967 696e 616c 5f67 656e 655f 6e75  original_gene_nu
+00019120: 6d20 3d20 7365 6c66 2e67 656e 655f 6e75  m = self.gene_nu
+00019130: 6d0a 2020 2020 2020 2020 2020 2020 6265  m.            be
+00019140: 7374 5f6d 6f64 656c 7320 3d20 5b5d 0a0a  st_models = []..
+00019150: 2020 2020 2020 2020 2020 2020 2320 7265              # re
+00019160: 2d69 6e69 7420 6e75 6d62 6572 206f 6620  -init number of 
+00019170: 6765 6e65 730a 2020 2020 2020 2020 2020  genes.          
+00019180: 2020 7365 6c66 2e67 656e 655f 6e75 6d20    self.gene_num 
+00019190: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
+000191a0: 6e5f 6765 6e20 3d20 7365 6c66 2e6e 5f67  n_gen = self.n_g
+000191b0: 656e 202f 2f20 6f72 6967 696e 616c 5f67  en // original_g
+000191c0: 656e 655f 6e75 6d20 2a20 7365 6c66 2e67  ene_num * self.g
+000191d0: 656e 655f 6e75 6d0a 2020 2020 2020 2020  ene_num.        
+000191e0: 2020 2020 7365 6c66 2e6c 617a 795f 696e      self.lazy_in
+000191f0: 6974 2858 290a 2020 2020 2020 2020 2020  it(X).          
+00019200: 2020 666f 7220 6720 696e 2072 616e 6765    for g in range
+00019210: 286f 7269 6769 6e61 6c5f 6765 6e65 5f6e  (original_gene_n
+00019220: 756d 202f 2f20 7365 6c66 2e67 656e 655f  um // self.gene_
+00019230: 6e75 6d29 3a0a 2020 2020 2020 2020 2020  num):.          
+00019240: 2020 2020 2020 6966 2067 203d 3d20 303a        if g == 0:
+00019250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019260: 2020 2020 2073 656c 662e 6e5f 6765 6e20       self.n_gen 
+00019270: 3d20 6e5f 6765 6e0a 2020 2020 2020 2020  = n_gen.        
+00019280: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00019290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000192a0: 2020 7365 6c66 2e6e 5f67 656e 203d 206e    self.n_gen = n
+000192b0: 5f67 656e 202d 2031 0a20 2020 2020 2020  _gen - 1.       
+000192c0: 2020 2020 2020 2020 2023 2063 6c65 6172           # clear
+000192d0: 2068 6973 746f 7279 0a20 2020 2020 2020   history.       
+000192e0: 2020 2020 2020 2020 2066 6f72 2070 2069           for p i
+000192f0: 6e20 7365 6c66 2e70 6f70 3a0a 2020 2020  n self.pop:.    
+00019300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019310: 6465 6c20 702e 6669 746e 6573 732e 7661  del p.fitness.va
+00019320: 6c75 6573 0a20 2020 2020 2020 2020 2020  lues.           
+00019330: 2020 2020 2073 656c 662e 686f 662e 636c       self.hof.cl
+00019340: 6561 7228 290a 2020 2020 2020 2020 2020  ear().          
+00019350: 2020 2020 2020 706f 702c 206c 6f67 203d        pop, log =
+00019360: 2073 656c 662e 6561 5369 6d70 6c65 2873   self.eaSimple(s
+00019370: 656c 662e 706f 702c 2073 656c 662e 746f  elf.pop, self.to
+00019380: 6f6c 626f 782c 2073 656c 662e 6372 6f73  olbox, self.cros
+00019390: 735f 7062 2c20 7365 6c66 2e6d 7574 6174  s_pb, self.mutat
+000193a0: 696f 6e5f 7062 2c20 7365 6c66 2e6e 5f67  ion_pb, self.n_g
+000193b0: 656e 2c0a 2020 2020 2020 2020 2020 2020  en,.            
+000193c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000193d0: 2020 2020 2020 2020 2020 2020 2073 7461               sta
+000193e0: 7473 3d6d 7374 6174 732c 2068 616c 6c6f  ts=mstats, hallo
+000193f0: 6666 616d 653d 7365 6c66 2e68 6f66 2c20  ffame=self.hof, 
+00019400: 7665 7262 6f73 653d 7365 6c66 2e76 6572  verbose=self.ver
+00019410: 626f 7365 290a 2020 2020 2020 2020 2020  bose).          
+00019420: 2020 2020 2020 7365 6c66 2e70 6f70 203d        self.pop =
+00019430: 2070 6f70 0a20 2020 2020 2020 2020 2020   pop.           
+00019440: 2020 2020 2073 656c 662e 686f 665b 305d       self.hof[0]
+00019450: 2e70 6970 6520 3d20 7365 6c66 2e67 6574  .pipe = self.get
+00019460: 5f62 6173 655f 6d6f 6465 6c28 290a 2020  _base_model().  
+00019470: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00019480: 6c66 2e66 696e 616c 5f6d 6f64 656c 5f6c  lf.final_model_l
+00019490: 617a 795f 7472 6169 6e69 6e67 2873 656c  azy_training(sel
+000194a0: 662e 686f 6629 0a20 2020 2020 2020 2020  f.hof).         
+000194b0: 2020 2020 2020 2073 656c 662e 7365 636f         self.seco
+000194c0: 6e64 5f6c 6179 6572 5f67 656e 6572 6174  nd_layer_generat
+000194d0: 696f 6e28 7365 6c66 2e58 2c20 7365 6c66  ion(self.X, self
+000194e0: 2e79 290a 2020 2020 2020 2020 2020 2020  .y).            
+000194f0: 2020 2020 2320 4966 2075 7369 6e67 2074      # If using t
+00019500: 6865 2070 7265 6469 6374 2066 756e 6374  he predict funct
+00019510: 696f 6e2c 2077 6520 6e65 6564 2074 6f20  ion, we need to 
+00019520: 636f 6e73 6964 6572 2061 206c 6f74 206f  consider a lot o
+00019530: 6620 6465 7461 696c 7320 6162 6f75 7420  f details about 
+00019540: 6e6f 726d 616c 697a 6174 696f 6e0a 2020  normalization.  
+00019550: 2020 2020 2020 2020 2020 2020 2020 5970                Yp
+00019560: 203d 2073 656c 662e 6665 6174 7572 655f   = self.feature_
+00019570: 6765 6e65 7261 7469 6f6e 2858 2c20 7365  generation(X, se
+00019580: 6c66 2e68 6f66 5b30 5d29 0a20 2020 2020  lf.hof[0]).     
+00019590: 2020 2020 2020 2020 2020 2079 5f70 7265             y_pre
+000195a0: 6420 3d20 7365 6c66 2e68 6f66 5b30 5d2e  d = self.hof[0].
+000195b0: 7069 7065 2e70 7265 6469 6374 2859 7029  pipe.predict(Yp)
+000195c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000195d0: 2023 2069 6620 6e70 2e61 6c6c 286e 702e   # if np.all(np.
+000195e0: 6172 7261 7928 7365 6c66 2e68 6f66 5b30  array(self.hof[0
+000195f0: 5d2e 6669 746e 6573 732e 7776 616c 7565  ].fitness.wvalue
+00019600: 7329 3e30 293a 0a20 2020 2020 2020 2020  s)>0):.         
+00019610: 2020 2020 2020 2069 6620 7232 5f73 636f         if r2_sco
+00019620: 7265 2873 656c 662e 792c 2079 5f70 7265  re(self.y, y_pre
+00019630: 6429 203e 2030 3a0a 2020 2020 2020 2020  d) > 0:.        
+00019640: 2020 2020 2020 2020 2020 2020 6265 7374              best
+00019650: 5f6d 6f64 656c 732e 6578 7465 6e64 2863  _models.extend(c
+00019660: 6f70 792e 6465 6570 636f 7079 2873 656c  opy.deepcopy(sel
+00019670: 662e 686f 665b 305d 2e67 656e 6529 290a  f.hof[0].gene)).
+00019680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019690: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000196a0: 2020 2020 2020 2020 2020 6272 6561 6b0a            break.
 000196b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000196c0: 2020 2020 7365 6c66 2e67 656e 6572 6174      self.generat
-000196d0: 6564 5f66 6561 7475 7265 732e 6164 6428  ed_features.add(
-000196e0: 7374 7228 6765 6e65 2929 0a20 2020 2020  str(gene)).     
-000196f0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00019700: 6620 2773 656d 616e 7469 6327 2069 6e20  f 'semantic' in 
-00019710: 7365 6c66 2e6d 7574 6174 696f 6e5f 7363  self.mutation_sc
-00019720: 6865 6d65 3a0a 2020 2020 2020 2020 2020  heme:.          
-00019730: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00019740: 6c66 2e67 656e 6572 6174 6564 5f66 6561  lf.generated_fea
-00019750: 7475 7265 732e 6164 6428 7365 6c66 2e66  tures.add(self.f
-00019760: 6561 7475 7265 5f71 7569 636b 5f65 7661  eature_quick_eva
-00019770: 6c75 6174 696f 6e28 6765 6e65 2929 0a0a  luation(gene))..
-00019780: 2020 2020 6465 6620 7661 6c69 6469 7479      def validity
-00019790: 5f63 6865 636b 2873 656c 662c 2069 6e64  _check(self, ind
-000197a0: 2c20 7365 6d61 6e74 6963 5f63 6865 636b  , semantic_check
-000197b0: 3d54 7275 6529 3a0a 2020 2020 2020 2020  =True):.        
-000197c0: 6966 2073 656d 616e 7469 635f 6368 6563  if semantic_chec
-000197d0: 6b3a 0a20 2020 2020 2020 2020 2020 2023  k:.            #
-000197e0: 2063 6865 636b 2074 6872 6f75 6768 2074   check through t
-000197f0: 6865 2073 656d 616e 7469 6320 696e 666f  he semantic info
-00019800: 726d 6174 696f 6e0a 2020 2020 2020 2020  rmation.        
-00019810: 2020 2020 6461 7461 203d 2073 656c 662e      data = self.
-00019820: 585b 7365 6c66 2e72 616e 646f 6d5f 696e  X[self.random_in
-00019830: 6465 785d 0a20 2020 2020 2020 2020 2020  dex].           
-00019840: 2061 6c6c 5f73 7472 696e 6720 3d20 5b5d   all_string = []
-00019850: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-00019860: 2067 2069 6e20 696e 642e 6765 6e65 3a0a   g in ind.gene:.
-00019870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019880: 6675 6e63 203d 2067 702e 636f 6d70 696c  func = gp.compil
-00019890: 6528 672c 2073 656c 662e 7073 6574 290a  e(g, self.pset).
-000198a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000198b0: 5920 3d20 6675 6e63 282a 6461 7461 2e54  Y = func(*data.T
-000198c0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000198d0: 2020 6966 206c 656e 286e 702e 756e 6971    if len(np.uniq
-000198e0: 7565 2859 2929 203d 3d20 313a 0a20 2020  ue(Y)) == 1:.   
-000198f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019900: 2072 6574 7572 6e20 4661 6c73 650a 2020   return False.  
-00019910: 2020 2020 2020 2020 2020 2020 2020 616c                al
-00019920: 6c5f 7374 7269 6e67 2e61 7070 656e 6428  l_string.append(
-00019930: 5929 0a20 2020 2020 2020 2020 2020 2061  Y).            a
-00019940: 6c6c 5f73 7472 696e 6720 3d20 7475 706c  ll_string = tupl
-00019950: 6528 6e70 2e73 6f72 7428 616c 6c5f 7374  e(np.sort(all_st
-00019960: 7269 6e67 2c20 6178 6973 3d31 292e 666c  ring, axis=1).fl
-00019970: 6174 7465 6e28 2929 0a20 2020 2020 2020  atten()).       
-00019980: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00019990: 2020 2023 2063 6865 636b 2074 6872 6f75     # check throu
-000199a0: 6768 2074 6865 2073 796d 7079 2070 6163  gh the sympy pac
-000199b0: 6b61 6765 0a20 2020 2020 2020 2020 2020  kage.           
-000199c0: 2061 6c6c 5f73 7472 696e 6720 3d20 5b5d   all_string = []
-000199d0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-000199e0: 2067 2069 6e20 696e 642e 6765 6e65 3a0a   g in ind.gene:.
-000199f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019a00: 6720 3d20 7061 7273 655f 6578 7072 2867  g = parse_expr(g
-00019a10: 656e 655f 746f 5f73 7472 696e 6728 6729  ene_to_string(g)
-00019a20: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00019a30: 2020 616c 6c5f 7374 7269 6e67 2e61 7070    all_string.app
-00019a40: 656e 6428 7374 7228 6729 290a 2020 2020  end(str(g)).    
-00019a50: 2020 2020 2020 2020 2020 2020 6966 2067              if g
-00019a60: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
-00019a70: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00019a80: 6e20 4661 6c73 650a 2020 2020 2020 2020  n False.        
-00019a90: 2020 2020 616c 6c5f 7374 7269 6e67 203d      all_string =
-00019aa0: 2027 2c27 2e6a 6f69 6e28 736f 7274 6564   ','.join(sorted
-00019ab0: 2861 6c6c 5f73 7472 696e 6729 290a 2020  (all_string)).  
-00019ac0: 2020 2020 2020 6966 2061 6c6c 5f73 7472        if all_str
-00019ad0: 696e 6720 6e6f 7420 696e 2073 656c 662e  ing not in self.
-00019ae0: 6576 616c 7561 7465 645f 706f 703a 0a20  evaluated_pop:. 
-00019af0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00019b00: 6576 616c 7561 7465 645f 706f 702e 6164  evaluated_pop.ad
-00019b10: 6428 616c 6c5f 7374 7269 6e67 290a 2020  d(all_string).  
-00019b20: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00019b30: 2054 7275 650a 2020 2020 2020 2020 656c   True.        el
-00019b40: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00019b50: 7265 7475 726e 2046 616c 7365 0a0a 2020  return False..  
-00019b60: 2020 6465 6620 6361 6c6c 6261 636b 2873    def callback(s
-00019b70: 656c 6629 3a0a 2020 2020 2020 2020 2320  elf):.        # 
-00019b80: 6361 6c6c 6261 636b 2066 756e 6374 696f  callback functio
-00019b90: 6e20 6166 7465 7220 6561 6368 2067 656e  n after each gen
-00019ba0: 6572 6174 696f 6e0a 2020 2020 2020 2020  eration.        
-00019bb0: 6966 2073 656c 662e 7665 7262 6f73 653a  if self.verbose:
-00019bc0: 0a20 2020 2020 2020 2020 2020 2070 6f70  .            pop
-00019bd0: 203d 2073 656c 662e 706f 700a 2020 2020   = self.pop.    
-00019be0: 2020 2020 2020 2020 6474 203d 2064 6566          dt = def
-00019bf0: 6175 6c74 6469 6374 2869 6e74 290a 2020  aultdict(int).  
-00019c00: 2020 2020 2020 2020 2020 2320 7061 7261            # para
-00019c10: 6d65 7465 7273 203d 206e 702e 7a65 726f  meters = np.zero
-00019c20: 7328 3229 0a20 2020 2020 2020 2020 2020  s(2).           
-00019c30: 2066 6f72 2070 2069 6e20 706f 703a 0a20   for p in pop:. 
-00019c40: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00019c50: 2064 745b 7374 7228 702e 6261 7365 5f6c   dt[str(p.base_l
-00019c60: 6561 726e 6572 295d 202b 3d20 310a 2020  earner)] += 1.  
-00019c70: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00019c80: 6474 5b73 7472 2870 2e64 796e 616d 6963  dt[str(p.dynamic
-00019c90: 5f6c 6561 665f 7369 7a65 295d 202b 3d20  _leaf_size)] += 
-00019ca0: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
-00019cb0: 2020 6474 5b73 7472 2870 2e64 796e 616d    dt[str(p.dynam
-00019cc0: 6963 5f72 6567 756c 6172 697a 6174 696f  ic_regularizatio
-00019cd0: 6e29 5d20 2b3d 2031 0a20 2020 2020 2020  n)] += 1.       
-00019ce0: 2020 2020 2020 2020 2023 2070 6172 616d           # param
-00019cf0: 6574 6572 7320 2b3d 2070 2e70 6172 616d  eters += p.param
-00019d00: 6574 6572 7320 2f20 6c65 6e28 706f 7029  eters / len(pop)
-00019d10: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-00019d20: 6e74 2864 7429 0a20 2020 2020 2020 2020  nt(dt).         
-00019d30: 2020 2023 2070 7269 6e74 2870 6172 616d     # print(param
-00019d40: 6574 6572 7329 0a0a 2020 2020 6465 6620  eters)..    def 
-00019d50: 6d75 6c74 695f 6765 6e65 5f6d 7574 6174  multi_gene_mutat
-00019d60: 696f 6e28 7365 6c66 293a 0a20 2020 2020  ion(self):.     
-00019d70: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
-00019d80: 7574 6174 696f 6e5f 7363 6865 6d65 2069  utation_scheme i
-00019d90: 6e20 5b27 756e 6966 6f72 6d2d 706c 7573  n ['uniform-plus
-00019da0: 272c 2027 756e 6966 6f72 6d2d 706c 7573  ', 'uniform-plus
-00019db0: 2d73 656d 616e 7469 6327 5d20 6f72 205c  -semantic'] or \
-00019dc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019dd0: 7365 6c66 2e6d 7574 6174 696f 6e5f 7363  self.mutation_sc
-00019de0: 6865 6d65 2069 6e20 6564 615f 6f70 6572  heme in eda_oper
-00019df0: 6174 6f72 730a 0a20 2020 2064 6566 2065  ators..    def e
-00019e00: 6153 696d 706c 6528 7365 6c66 2c20 706f  aSimple(self, po
-00019e10: 7075 6c61 7469 6f6e 2c20 746f 6f6c 626f  pulation, toolbo
-00019e20: 782c 2063 7870 622c 206d 7574 7062 2c20  x, cxpb, mutpb, 
-00019e30: 6e67 656e 2c20 7374 6174 733d 4e6f 6e65  ngen, stats=None
-00019e40: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00019e50: 2020 2068 616c 6c6f 6666 616d 653d 4e6f     halloffame=No
-00019e60: 6e65 2c20 7665 7262 6f73 653d 5f5f 6465  ne, verbose=__de
-00019e70: 6275 675f 5f29 3a0a 2020 2020 2020 2020  bug__):.        
-00019e80: 2222 220a 2020 2020 2020 2020 5468 6973  """.        This
-00019e90: 2069 7320 7468 6520 6d61 696e 2066 756e   is the main fun
-00019ea0: 6374 696f 6e20 6f66 2074 6865 2067 656e  ction of the gen
-00019eb0: 6574 6963 2070 726f 6772 616d 6d69 6e67  etic programming
-00019ec0: 2061 6c67 6f72 6974 686d 2e0a 2020 2020   algorithm..    
-00019ed0: 2020 2020 3a70 6172 616d 2070 6f70 756c      :param popul
-00019ee0: 6174 696f 6e3a 2020 5468 6520 6c69 7374  ation:  The list
-00019ef0: 206f 6620 4750 2069 6e64 6976 6964 7561   of GP individua
-00019f00: 6c73 2e0a 2020 2020 2020 2020 3a70 6172  ls..        :par
-00019f10: 616d 2074 6f6f 6c62 6f78 3a20 5468 6520  am toolbox: The 
-00019f20: 746f 6f6c 626f 7820 696e 636c 7564 6573  toolbox includes
-00019f30: 2061 6c6c 2067 656e 6574 6963 206f 7065   all genetic ope
-00019f40: 7261 746f 7273 2e0a 2020 2020 2020 2020  rators..        
-00019f50: 3a70 6172 616d 2063 7870 623a 2054 6865  :param cxpb: The
-00019f60: 2070 726f 6261 6269 6c69 7479 206f 6620   probability of 
-00019f70: 6372 6f73 736f 7665 722e 0a20 2020 2020  crossover..     
-00019f80: 2020 203a 7061 7261 6d20 6d75 7470 623a     :param mutpb:
-00019f90: 2054 6865 2070 726f 6261 6269 6c69 7479   The probability
-00019fa0: 206f 6620 6d75 7461 7469 6f6e 2e0a 2020   of mutation..  
-00019fb0: 2020 2020 2020 3a70 6172 616d 206e 6765        :param nge
-00019fc0: 6e3a 2054 6865 206e 756d 6265 7220 6f66  n: The number of
-00019fd0: 2067 656e 6572 6174 696f 6e73 2e0a 2020   generations..  
-00019fe0: 2020 2020 2020 3a70 6172 616d 2073 7461        :param sta
-00019ff0: 7473 3a0a 2020 2020 2020 2020 3a70 6172  ts:.        :par
-0001a000: 616d 2068 616c 6c6f 6666 616d 653a 2041  am halloffame: A
-0001a010: 6e20 6172 6368 6976 6520 6f66 2074 6865  n archive of the
-0001a020: 2062 6573 7420 696e 6469 7669 6475 616c   best individual
-0001a030: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
-0001a040: 6d20 7665 7262 6f73 653a 0a20 2020 2020  m verbose:.     
-0001a050: 2020 203a 7265 7475 726e 3a0a 2020 2020     :return:.    
-0001a060: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001a070: 6966 2073 656c 662e 7665 7262 6f73 653a  if self.verbose:
-0001a080: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-0001a090: 6e74 2827 6461 7461 2073 6861 7065 272c  nt('data shape',
-0001a0a0: 2073 656c 662e 582e 7368 6170 652c 2073   self.X.shape, s
-0001a0b0: 656c 662e 792e 7368 6170 6529 0a20 2020  elf.y.shape).   
-0001a0c0: 2020 2020 206c 6f67 626f 6f6b 203d 2074       logbook = t
-0001a0d0: 6f6f 6c73 2e4c 6f67 626f 6f6b 2829 0a20  ools.Logbook(). 
-0001a0e0: 2020 2020 2020 206c 6f67 626f 6f6b 2e68         logbook.h
-0001a0f0: 6561 6465 7220 3d20 5b27 6765 6e27 2c20  eader = ['gen', 
-0001a100: 276e 6576 616c 7327 5d20 2b20 2873 7461  'nevals'] + (sta
-0001a110: 7473 2e66 6965 6c64 7320 6966 2073 7461  ts.fields if sta
-0001a120: 7473 2065 6c73 6520 5b5d 290a 0a20 2020  ts else [])..   
-0001a130: 2020 2020 2069 6620 7365 6c66 2e72 6564       if self.red
-0001a140: 7563 7469 6f6e 5f72 6174 696f 203e 3d20  uction_ratio >= 
-0001a150: 313a 0a20 2020 2020 2020 2020 2020 2073  1:.            s
-0001a160: 656c 662e 706f 7075 6c61 7469 6f6e 5f72  elf.population_r
-0001a170: 6564 7563 7469 6f6e 2870 6f70 756c 6174  eduction(populat
-0001a180: 696f 6e29 0a0a 2020 2020 2020 2020 2320  ion)..        # 
-0001a190: 4576 616c 7561 7465 2074 6865 2069 6e64  Evaluate the ind
-0001a1a0: 6976 6964 7561 6c73 2077 6974 6820 616e  ividuals with an
-0001a1b0: 2069 6e76 616c 6964 2066 6974 6e65 7373   invalid fitness
-0001a1c0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-0001a1d0: 2e62 6173 655f 6c65 6172 6e65 7220 696e  .base_learner in
-0001a1e0: 205b 2752 4454 7e4c 6967 6874 4742 4d2d   ['RDT~LightGBM-
-0001a1f0: 5374 756d 7027 5d3a 0a20 2020 2020 2020  Stump']:.       
-0001a200: 2020 2020 2069 6e76 616c 6964 5f69 6e64       invalid_ind
-0001a210: 203d 2073 656c 662e 6d75 6c74 696f 626a   = self.multiobj
-0001a220: 6563 7469 7665 5f65 7661 6c75 6174 696f  ective_evaluatio
-0001a230: 6e28 746f 6f6c 626f 782c 2070 6f70 756c  n(toolbox, popul
-0001a240: 6174 696f 6e29 0a20 2020 2020 2020 2065  ation).        e
-0001a250: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0001a260: 2069 6e76 616c 6964 5f69 6e64 203d 2073   invalid_ind = s
-0001a270: 656c 662e 706f 7075 6c61 7469 6f6e 5f65  elf.population_e
-0001a280: 7661 6c75 6174 696f 6e28 746f 6f6c 626f  valuation(toolbo
-0001a290: 782c 2070 6f70 756c 6174 696f 6e29 0a20  x, population). 
-0001a2a0: 2020 2020 2020 2069 6620 7365 6c66 2e65         if self.e
-0001a2b0: 6e76 6972 6f6e 6d65 6e74 616c 5f73 656c  nvironmental_sel
-0001a2c0: 6563 7469 6f6e 203d 3d20 274e 5347 4132  ection == 'NSGA2
-0001a2d0: 2d4d 6978 7570 273a 0a20 2020 2020 2020  -Mixup':.       
-0001a2e0: 2020 2020 2073 656c 662e 6d69 7875 705f       self.mixup_
-0001a2f0: 6576 616c 7561 7469 6f6e 2873 656c 662e  evaluation(self.
-0001a300: 746f 6f6c 626f 782c 2070 6f70 756c 6174  toolbox, populat
-0001a310: 696f 6e29 0a0a 2020 2020 2020 2020 7365  ion)..        se
-0001a320: 6c66 2e61 7070 656e 645f 6576 616c 7561  lf.append_evalua
-0001a330: 7465 645f 6665 6174 7572 6573 2870 6f70  ted_features(pop
-0001a340: 756c 6174 696f 6e29 0a20 2020 2020 2020  ulation).       
-0001a350: 2066 6f72 206f 2069 6e20 706f 7075 6c61   for o in popula
-0001a360: 7469 6f6e 3a0a 2020 2020 2020 2020 2020  tion:.          
-0001a370: 2020 7365 6c66 2e65 7661 6c75 6174 6564    self.evaluated
-0001a380: 5f70 6f70 2e61 6464 2869 6e64 6976 6964  _pop.add(individ
-0001a390: 7561 6c5f 746f 5f74 7570 6c65 286f 2929  ual_to_tuple(o))
-0001a3a0: 0a0a 2020 2020 2020 2020 6966 2068 616c  ..        if hal
-0001a3b0: 6c6f 6666 616d 6520 6973 206e 6f74 204e  loffame is not N
-0001a3c0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0001a3d0: 2068 616c 6c6f 6666 616d 652e 7570 6461   halloffame.upda
-0001a3e0: 7465 2870 6f70 756c 6174 696f 6e29 0a0a  te(population)..
-0001a3f0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0001a400: 6469 7665 7273 6974 795f 7365 6172 6368  diversity_search
-0001a410: 2021 3d20 274e 6f6e 6527 3a0a 2020 2020   != 'None':.    
-0001a420: 2020 2020 2020 2020 7365 6c66 2e64 6976          self.div
-0001a430: 6572 7369 7479 5f61 7373 6967 6e6d 656e  ersity_assignmen
-0001a440: 7428 706f 7075 6c61 7469 6f6e 290a 0a20  t(population).. 
-0001a450: 2020 2020 2020 2069 6620 2767 6c6f 6261         if 'globa
-0001a460: 6c27 2069 6e20 7365 6c66 2e6d 7574 6174  l' in self.mutat
-0001a470: 696f 6e5f 7363 6865 6d65 206f 7220 2765  ion_scheme or 'e
-0001a480: 7874 7265 6d65 2720 696e 2073 656c 662e  xtreme' in self.
-0001a490: 6d75 7461 7469 6f6e 5f73 6368 656d 653a  mutation_scheme:
-0001a4a0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0001a4b0: 662e 636f 6e73 7472 7563 745f 676c 6f62  f.construct_glob
-0001a4c0: 616c 5f66 6561 7475 7265 5f70 6f6f 6c28  al_feature_pool(
-0001a4d0: 706f 7075 6c61 7469 6f6e 290a 0a20 2020  population)..   
-0001a4e0: 2020 2020 2072 6563 6f72 6420 3d20 7374       record = st
-0001a4f0: 6174 732e 636f 6d70 696c 6528 706f 7075  ats.compile(popu
-0001a500: 6c61 7469 6f6e 2920 6966 2073 7461 7473  lation) if stats
-0001a510: 2065 6c73 6520 7b7d 0a20 2020 2020 2020   else {}.       
-0001a520: 206c 6f67 626f 6f6b 2e72 6563 6f72 6428   logbook.record(
-0001a530: 6765 6e3d 302c 206e 6576 616c 733d 6c65  gen=0, nevals=le
-0001a540: 6e28 696e 7661 6c69 645f 696e 6429 2c20  n(invalid_ind), 
-0001a550: 2a2a 7265 636f 7264 290a 2020 2020 2020  **record).      
-0001a560: 2020 6966 2076 6572 626f 7365 3a0a 2020    if verbose:.  
-0001a570: 2020 2020 2020 2020 2020 2320 7365 6c66            # self
-0001a580: 2e70 6561 7273 6f6e 5f63 6f72 7265 6c61  .pearson_correla
-0001a590: 7469 6f6e 5f61 6e61 6c79 7369 7328 706f  tion_analysis(po
-0001a5a0: 7075 6c61 7469 6f6e 290a 2020 2020 2020  pulation).      
-0001a5b0: 2020 2020 2020 2320 7365 6c66 2e70 6561        # self.pea
-0001a5c0: 7273 6f6e 5f63 6f72 7265 6c61 7469 6f6e  rson_correlation
-0001a5d0: 5f61 6e61 6c79 7369 735f 7061 6972 7328  _analysis_pairs(
-0001a5e0: 706f 7075 6c61 7469 6f6e 290a 2020 2020  population).    
-0001a5f0: 2020 2020 2020 2020 7072 696e 7428 6c6f          print(lo
-0001a600: 6762 6f6f 6b2e 7374 7265 616d 290a 0a20  gbook.stream).. 
-0001a610: 2020 2020 2020 2073 656c 662e 7265 6475         self.redu
-0001a620: 6e64 616e 745f 6665 6174 7572 6573 5f63  ndant_features_c
-0001a630: 616c 6375 6c61 7469 6f6e 2870 6f70 756c  alculation(popul
-0001a640: 6174 696f 6e29 0a20 2020 2020 2020 2073  ation).        s
-0001a650: 656c 662e 7374 6174 6973 7469 6361 6c5f  elf.statistical_
-0001a660: 7265 7375 6c74 5f75 7064 6174 6528 706f  result_update(po
-0001a670: 7075 6c61 7469 6f6e 2c20 7665 7262 6f73  pulation, verbos
-0001a680: 6529 0a20 2020 2020 2020 2073 656c 662e  e).        self.
-0001a690: 6361 6c6c 6261 636b 2829 0a0a 2020 2020  callback()..    
-0001a6a0: 2020 2020 6966 2073 656c 662e 7072 655f      if self.pre_
-0001a6b0: 7365 6c65 6374 696f 6e20 213d 204e 6f6e  selection != Non
-0001a6c0: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-0001a6d0: 7572 726f 6761 7465 5f63 6f65 6666 6963  urrogate_coeffic
-0001a6e0: 6965 6e74 203d 2033 0a20 2020 2020 2020  ient = 3.       
-0001a6f0: 2020 2020 2070 6f70 5f73 697a 6520 3d20       pop_size = 
-0001a700: 696e 7428 6c65 6e28 706f 7075 6c61 7469  int(len(populati
-0001a710: 6f6e 2920 2a20 7375 7272 6f67 6174 655f  on) * surrogate_
-0001a720: 636f 6566 6669 6369 656e 7429 0a20 2020  coefficient).   
-0001a730: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0001a740: 2020 2020 2020 2070 6f70 5f73 697a 6520         pop_size 
-0001a750: 3d20 6c65 6e28 706f 7075 6c61 7469 6f6e  = len(population
-0001a760: 290a 0a20 2020 2020 2020 2065 6c69 7465  )..        elite
-0001a770: 5f6d 6170 203d 207b 7d0a 2020 2020 2020  _map = {}.      
-0001a780: 2020 706f 705f 706f 6f6c 203d 205b 5d0a    pop_pool = [].
-0001a790: 2020 2020 2020 2020 656c 6974 655f 6d61          elite_ma
-0001a7a0: 702c 2070 6f70 5f70 6f6f 6c20 3d20 7365  p, pop_pool = se
-0001a7b0: 6c66 2e6d 6170 5f65 6c69 7465 5f67 656e  lf.map_elite_gen
-0001a7c0: 6572 6174 696f 6e28 706f 7075 6c61 7469  eration(populati
-0001a7d0: 6f6e 2c20 656c 6974 655f 6d61 702c 2070  on, elite_map, p
-0001a7e0: 6f70 5f70 6f6f 6c29 0a20 2020 2020 2020  op_pool).       
-0001a7f0: 2069 6620 7365 6c66 2e73 656c 6563 7420   if self.select 
-0001a800: 3d3d 2027 4175 746f 273a 0a20 2020 2020  == 'Auto':.     
-0001a810: 2020 2020 2020 2073 656c 6563 7469 6f6e         selection
-0001a820: 5f6f 7065 7261 746f 7273 203d 2073 656c  _operators = sel
-0001a830: 662e 6d61 625f 7061 7261 6d65 7465 722e  f.mab_parameter.
-0001a840: 6765 7428 2773 656c 6563 7469 6f6e 5f6f  get('selection_o
-0001a850: 7065 7261 746f 7273 272c 0a20 2020 2020  perators',.     
-0001a860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a890: 2020 2020 274d 4150 2d45 6c69 7465 2d4c      'MAP-Elite-L
-0001a8a0: 6578 6963 6173 652c 546f 7572 6e61 6d65  exicase,Tourname
-0001a8b0: 6e74 2d37 2c54 6f75 726e 616d 656e 742d  nt-7,Tournament-
-0001a8c0: 3135 2729 2e73 706c 6974 2827 2c27 290a  15').split(',').
-0001a8d0: 2020 2020 2020 2020 2020 2020 7365 6c65              sele
-0001a8e0: 6374 696f 6e5f 6461 7461 203d 206e 702e  ction_data = np.
-0001a8f0: 6f6e 6573 2828 322c 206c 656e 2873 656c  ones((2, len(sel
-0001a900: 6563 7469 6f6e 5f6f 7065 7261 746f 7273  ection_operators
-0001a910: 2929 290a 2020 2020 2020 2020 656c 7365  ))).        else
-0001a920: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-0001a930: 6c65 6374 696f 6e5f 6f70 6572 6174 6f72  lection_operator
-0001a940: 7320 3d20 4e6f 6e65 0a20 2020 2020 2020  s = None.       
-0001a950: 2020 2020 2073 656c 6563 7469 6f6e 5f64       selection_d
-0001a960: 6174 6120 3d20 4e6f 6e65 0a0a 2020 2020  ata = None..    
-0001a970: 2020 2020 6669 746e 6573 735f 696d 7072      fitness_impr
-0001a980: 6f76 656d 656e 7420 3d20 300a 2020 2020  ovement = 0.    
-0001a990: 2020 2020 776f 7273 655f 6974 6572 6174      worse_iterat
-0001a9a0: 696f 6e73 203d 2030 0a20 2020 2020 2020  ions = 0.       
-0001a9b0: 2068 6973 746f 7269 6361 6c5f 6265 7374   historical_best
-0001a9c0: 5f66 6974 6e65 7373 203d 206e 702e 6d61  _fitness = np.ma
-0001a9d0: 7828 5b69 6e64 2e66 6974 6e65 7373 2e77  x([ind.fitness.w
-0001a9e0: 7661 6c75 6573 5b30 5d20 666f 7220 696e  values[0] for in
-0001a9f0: 6420 696e 2070 6f70 756c 6174 696f 6e5d  d in population]
-0001aa00: 290a 2020 2020 2020 2020 6e6f 5f69 6d70  ).        no_imp
-0001aa10: 726f 7665 6d65 6e74 5f69 7465 7261 7469  rovement_iterati
-0001aa20: 6f6e 203d 2030 0a20 2020 2020 2020 2063  on = 0.        c
-0001aa30: 6f6d 7061 7269 736f 6e5f 6372 6974 6572  omparison_criter
-0001aa40: 696f 6e20 3d20 7365 6c66 2e6d 6162 5f70  ion = self.mab_p
-0001aa50: 6172 616d 6574 6572 2e67 6574 2827 636f  arameter.get('co
-0001aa60: 6d70 6172 6973 6f6e 5f63 7269 7465 7269  mparison_criteri
-0001aa70: 6f6e 272c 2027 4361 7365 2729 0a20 2020  on', 'Case').   
-0001aa80: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0001aa90: 2046 6974 6e65 7373 3a20 5573 696e 6720   Fitness: Using 
-0001aaa0: 7468 6520 6669 746e 6573 7320 696d 7072  the fitness impr
-0001aab0: 6f76 656d 656e 7420 6173 2074 6865 2063  ovement as the c
-0001aac0: 7269 7465 7269 6f6e 206f 6620 6120 7375  riterion of a su
-0001aad0: 6363 6573 7320 7472 6961 6c0a 2020 2020  ccess trial.    
-0001aae0: 2020 2020 4669 746e 6573 732d 4361 7365      Fitness-Case
-0001aaf0: 3a20 5573 696e 6720 7468 6520 6669 746e  : Using the fitn
-0001ab00: 6573 7320 696d 7072 6f76 656d 656e 7420  ess improvement 
-0001ab10: 6173 2074 6865 2063 7269 7465 7269 6f6e  as the criterion
-0001ab20: 206f 6620 6120 7375 6363 6573 7320 7472   of a success tr
-0001ab30: 6961 6c0a 2020 2020 2020 2020 2020 2020  ial.            
-0001ab40: 2020 2020 2020 2020 2020 616e 6420 7468            and th
-0001ab50: 6520 6669 746e 6573 7320 696d 7072 6f76  e fitness improv
-0001ab60: 656d 656e 7420 6f6e 2061 2073 696e 676c  ement on a singl
-0001ab70: 6520 6361 7365 2061 7320 7468 6520 6372  e case as the cr
-0001ab80: 6974 6572 696f 6e20 6f66 2061 206e 6575  iterion of a neu
-0001ab90: 7472 616c 2074 7269 616c 0a20 2020 2020  tral trial.     
-0001aba0: 2020 2043 6173 653a 2055 7369 6e67 2074     Case: Using t
-0001abb0: 6865 2066 6974 6e65 7373 2069 6d70 726f  he fitness impro
-0001abc0: 7665 6d65 6e74 206f 6e20 6120 7369 6e67  vement on a sing
-0001abd0: 6c65 2063 6173 6520 6173 2074 6865 2063  le case as the c
-0001abe0: 7269 7465 7269 6f6e 206f 6620 6120 7375  riterion of a su
-0001abf0: 6363 6573 7320 7472 6961 6c0a 2020 2020  ccess trial.    
-0001ac00: 2020 2020 4361 7365 2d50 6c75 733a 2055      Case-Plus: U
-0001ac10: 7369 6e67 2072 6561 6c20 696d 7072 6f76  sing real improv
-0001ac20: 656d 656e 7420 6173 2074 6865 2073 636f  ement as the sco
-0001ac30: 7265 206f 6620 6120 7472 6169 6c0a 2020  re of a trail.  
-0001ac40: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001ac50: 2020 6966 2063 6f6d 7061 7269 736f 6e5f    if comparison_
-0001ac60: 6372 6974 6572 696f 6e20 696e 205b 2746  criterion in ['F
-0001ac70: 6974 6e65 7373 272c 2027 4669 746e 6573  itness', 'Fitnes
-0001ac80: 732d 4361 7365 275d 3a0a 2020 2020 2020  s-Case']:.      
-0001ac90: 2020 2020 2020 6265 7374 5f76 616c 7565        best_value
-0001aca0: 203d 206e 702e 6d61 7828 5b70 2e66 6974   = np.max([p.fit
-0001acb0: 6e65 7373 2e77 7661 6c75 6573 5b30 5d20  ness.wvalues[0] 
-0001acc0: 666f 7220 7020 696e 2070 6f70 756c 6174  for p in populat
-0001acd0: 696f 6e5d 290a 2020 2020 2020 2020 656c  ion]).        el
-0001ace0: 6966 2063 6f6d 7061 7269 736f 6e5f 6372  if comparison_cr
-0001acf0: 6974 6572 696f 6e20 696e 205b 2743 6173  iterion in ['Cas
-0001ad00: 6527 2c20 2743 6173 652d 506c 7573 272c  e', 'Case-Plus',
-0001ad10: 2027 4361 7365 2d53 696d 706c 6527 5d20   'Case-Simple'] 
-0001ad20: 6f72 2069 7369 6e73 7461 6e63 6528 636f  or isinstance(co
-0001ad30: 6d70 6172 6973 6f6e 5f63 7269 7465 7269  mparison_criteri
-0001ad40: 6f6e 2c20 696e 7429 3a0a 2020 2020 2020  on, int):.      
-0001ad50: 2020 2020 2020 6265 7374 5f76 616c 7565        best_value
-0001ad60: 203d 206e 702e 6d69 6e28 5b70 2e63 6173   = np.min([p.cas
-0001ad70: 655f 7661 6c75 6573 2066 6f72 2070 2069  e_values for p i
-0001ad80: 6e20 706f 7075 6c61 7469 6f6e 5d2c 2061  n population], a
-0001ad90: 7869 733d 3029 0a20 2020 2020 2020 2020  xis=0).         
-0001ada0: 2020 2077 6f72 7374 5f76 616c 7565 203d     worst_value =
-0001adb0: 206e 702e 6d61 7828 5b70 2e63 6173 655f   np.max([p.case_
-0001adc0: 7661 6c75 6573 2066 6f72 2070 2069 6e20  values for p in 
-0001add0: 706f 7075 6c61 7469 6f6e 5d2c 2061 7869  population], axi
-0001ade0: 733d 3029 0a20 2020 2020 2020 2065 6c73  s=0).        els
-0001adf0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0001ae00: 6169 7365 2045 7863 6570 7469 6f6e 0a0a  aise Exception..
-0001ae10: 2020 2020 2020 2020 2320 4d43 5453 0a20          # MCTS. 
-0001ae20: 2020 2020 2020 206d 6374 735f 6469 6374         mcts_dict
-0001ae30: 203d 207b 7d0a 2020 2020 2020 2020 6361   = {}.        ca
-0001ae40: 6e64 6964 6174 655f 7365 6c65 6374 696f  ndidate_selectio
-0001ae50: 6e5f 6f70 6572 6174 6f72 7320 3d20 274d  n_operators = 'M
-0001ae60: 4150 2d45 6c69 7465 2d4c 6578 6963 6173  AP-Elite-Lexicas
-0001ae70: 652c 546f 7572 6e61 6d65 6e74 2d37 2c54  e,Tournament-7,T
-0001ae80: 6f75 726e 616d 656e 742d 3135 2c4c 6578  ournament-15,Lex
-0001ae90: 6963 6173 6527 2e73 706c 6974 2827 2c27  icase'.split(','
-0001aea0: 290a 2020 2020 2020 2020 6361 6e64 6964  ).        candid
-0001aeb0: 6174 655f 7375 7276 6976 616c 5f6f 7065  ate_survival_ope
-0001aec0: 6172 6174 6f72 7320 3d20 2741 4650 2c42  arators = 'AFP,B
-0001aed0: 6573 742c 4e6f 6e65 272e 7370 6c69 7428  est,None'.split(
-0001aee0: 272c 2729 0a20 2020 2020 2020 206d 6374  ',').        mct
-0001aef0: 735f 6469 6374 5b27 5375 7276 6976 616c  s_dict['Survival
-0001af00: 204f 7065 7261 746f 7273 275d 203d 206e   Operators'] = n
-0001af10: 702e 6f6e 6573 2828 322c 206c 656e 2863  p.ones((2, len(c
-0001af20: 616e 6469 6461 7465 5f73 7572 7669 7661  andidate_surviva
-0001af30: 6c5f 6f70 6561 7261 746f 7273 2929 290a  l_opearators))).
-0001af40: 2020 2020 2020 2020 6d63 7473 5f64 6963          mcts_dic
-0001af50: 745b 2753 656c 6563 7469 6f6e 204f 7065  t['Selection Ope
-0001af60: 7261 746f 7273 275d 203d 206e 702e 6f6e  rators'] = np.on
-0001af70: 6573 2828 322c 206c 656e 2863 616e 6469  es((2, len(candi
-0001af80: 6461 7465 5f73 656c 6563 7469 6f6e 5f6f  date_selection_o
-0001af90: 7065 7261 746f 7273 2929 290a 0a20 2020  perators)))..   
-0001afa0: 2020 2020 2023 2061 7263 6869 7665 2069       # archive i
-0001afb0: 6e69 7469 616c 697a 6174 696f 6e0a 2020  nitialization.  
-0001afc0: 2020 2020 2020 6e73 6761 5f61 7263 6869        nsga_archi
-0001afd0: 7665 203d 2070 6f70 756c 6174 696f 6e0a  ve = population.
-0001afe0: 2020 2020 2020 2020 6166 705f 6172 6368          afp_arch
-0001aff0: 6976 6520 3d20 706f 7075 6c61 7469 6f6e  ive = population
-0001b000: 0a20 2020 2020 2020 2062 6573 745f 6172  .        best_ar
-0001b010: 6368 6976 6520 3d20 706f 7075 6c61 7469  chive = populati
-0001b020: 6f6e 0a20 2020 2020 2020 2073 656c 662e  on.        self.
-0001b030: 7570 6461 7465 5f73 656d 616e 7469 635f  update_semantic_
-0001b040: 7265 7061 6972 5f69 6e70 7574 5f6d 6174  repair_input_mat
-0001b050: 7269 7828 706f 7075 6c61 7469 6f6e 290a  rix(population).
-0001b060: 2020 2020 2020 2020 6578 7465 726e 616c          external
-0001b070: 5f61 7263 6869 7665 203d 2073 656c 662e  _archive = self.
-0001b080: 7570 6461 7465 5f65 7874 6572 6e61 6c5f  update_external_
-0001b090: 6172 6368 6976 6528 706f 7075 6c61 7469  archive(populati
-0001b0a0: 6f6e 2c20 4e6f 6e65 290a 0a20 2020 2020  on, None)..     
-0001b0b0: 2020 2023 2042 6567 696e 2074 6865 2067     # Begin the g
-0001b0c0: 656e 6572 6174 696f 6e61 6c20 7072 6f63  enerational proc
-0001b0d0: 6573 730a 2020 2020 2020 2020 6e75 6d62  ess.        numb
-0001b0e0: 6572 5f6f 665f 6576 616c 7561 7469 6f6e  er_of_evaluation
-0001b0f0: 7320 3d20 7365 6c66 2e6e 5f70 6f70 0a20  s = self.n_pop. 
-0001b100: 2020 2020 2020 2074 6f74 616c 5f65 7661         total_eva
-0001b110: 6c75 6174 696f 6e73 203d 2028 7365 6c66  luations = (self
-0001b120: 2e6e 5f67 656e 202b 2031 2920 2a20 7365  .n_gen + 1) * se
-0001b130: 6c66 2e6e 5f70 6f70 0a20 2020 2020 2020  lf.n_pop.       
-0001b140: 2067 656e 203d 2030 0a20 2020 2020 2020   gen = 0.       
-0001b150: 2070 6f70 5f73 697a 6520 3d20 7365 6c66   pop_size = self
-0001b160: 2e6e 5f70 6f70 0a20 2020 2020 2020 2077  .n_pop.        w
-0001b170: 6869 6c65 206e 756d 6265 725f 6f66 5f65  hile number_of_e
-0001b180: 7661 6c75 6174 696f 6e73 203c 2074 6f74  valuations < tot
-0001b190: 616c 5f65 7661 6c75 6174 696f 6e73 3a0a  al_evaluations:.
-0001b1a0: 2020 2020 2020 2020 2020 2020 6765 6e20              gen 
-0001b1b0: 2b3d 2031 0a20 2020 2020 2020 2020 2020  += 1.           
-0001b1c0: 2073 656c 662e 6375 7272 656e 745f 6765   self.current_ge
-0001b1d0: 6e20 3d20 6765 6e0a 2020 2020 2020 2020  n = gen.        
-0001b1e0: 2020 2020 6966 2073 656c 662e 6479 6e61      if self.dyna
-0001b1f0: 6d69 635f 7265 6475 6374 696f 6e20 3e20  mic_reduction > 
-0001b200: 3020 616e 6420 2867 656e 203e 2031 2920  0 and (gen > 1) 
-0001b210: 616e 6420 5c0a 2020 2020 2020 2020 2020  and \.          
-0001b220: 2020 2020 2020 2828 6e75 6d62 6572 5f6f        ((number_o
-0001b230: 665f 6576 616c 7561 7469 6f6e 7320 2d20  f_evaluations - 
-0001b240: 7365 6c66 2e6e 5f70 6f70 2920 250a 2020  self.n_pop) %.  
-0001b250: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-0001b260: 2874 6f74 616c 5f65 7661 6c75 6174 696f  (total_evaluatio
-0001b270: 6e73 202d 2073 656c 662e 6e5f 706f 7029  ns - self.n_pop)
-0001b280: 202f 2f20 7365 6c66 2e64 796e 616d 6963   // self.dynamic
-0001b290: 5f72 6564 7563 7469 6f6e 2920 3d3d 2030  _reduction) == 0
-0001b2a0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0001b2b0: 2020 2070 6f70 5f73 697a 6520 2f2f 3d20     pop_size //= 
-0001b2c0: 320a 2020 2020 2020 2020 2020 2020 2020  2.              
-0001b2d0: 2020 6173 7365 7274 2073 656c 662e 7072    assert self.pr
-0001b2e0: 655f 7365 6c65 6374 696f 6e20 3d3d 204e  e_selection == N
-0001b2f0: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
-0001b300: 6e75 6d62 6572 5f6f 665f 6576 616c 7561  number_of_evalua
-0001b310: 7469 6f6e 7320 2b3d 2070 6f70 5f73 697a  tions += pop_siz
-0001b320: 650a 0a20 2020 2020 2020 2020 2020 2073  e..            s
-0001b330: 656c 662e 7265 7065 7469 7469 7665 5f66  elf.repetitive_f
-0001b340: 6561 7475 7265 5f63 6f75 6e74 2e61 7070  eature_count.app
-0001b350: 656e 6428 3029 0a20 2020 2020 2020 2020  end(0).         
-0001b360: 2020 2073 656c 662e 656e 7472 6f70 795f     self.entropy_
-0001b370: 6361 6c63 756c 6174 696f 6e28 290a 2020  calculation().  
-0001b380: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-0001b390: 662e 6d75 7461 7469 6f6e 5f73 6368 656d  f.mutation_schem
-0001b3a0: 6520 696e 2065 6461 5f6f 7065 7261 746f  e in eda_operato
-0001b3b0: 7273 206f 7220 2745 4441 2720 696e 2073  rs or 'EDA' in s
-0001b3c0: 656c 662e 6d75 7461 7469 6f6e 5f73 6368  elf.mutation_sch
-0001b3d0: 656d 653a 0a20 2020 2020 2020 2020 2020  eme:.           
-0001b3e0: 2020 2020 2069 6620 7365 6c66 2e6d 7574       if self.mut
-0001b3f0: 6174 696f 6e5f 7363 6865 6d65 203d 3d20  ation_scheme == 
-0001b400: 2745 4441 2d54 6572 6d69 6e61 6c2d 504d  'EDA-Terminal-PM
-0001b410: 2d46 7265 7175 656e 6379 273a 0a20 2020  -Frequency':.   
-0001b420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b430: 2073 656c 662e 6672 6571 7565 6e63 795f   self.frequency_
-0001b440: 636f 756e 7469 6e67 2869 6d70 6f72 7461  counting(importa
-0001b450: 6e63 655f 7765 6967 6874 3d46 616c 7365  nce_weight=False
-0001b460: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001b470: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0001b480: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001b490: 2e66 7265 7175 656e 6379 5f63 6f75 6e74  .frequency_count
-0001b4a0: 696e 6728 290a 2020 2020 2020 2020 2020  ing().          
-0001b4b0: 2020 2020 2020 7365 6c66 2e70 726f 6261        self.proba
-0001b4c0: 6269 6c69 7479 5f73 616d 706c 696e 6728  bility_sampling(
-0001b4d0: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-0001b4e0: 2073 656c 662e 6578 7465 726e 616c 5f61   self.external_a
-0001b4f0: 7263 6869 7665 203d 3d20 2748 616c 6c4f  rchive == 'HallO
-0001b500: 6646 616d 6527 2061 6e64 2028 7365 6c66  fFame' and (self
-0001b510: 2e68 6f66 2069 7320 6e6f 7420 4e6f 6e65  .hof is not None
-0001b520: 2920 616e 6420 7365 6c66 2e73 636f 7265  ) and self.score
-0001b530: 5f66 756e 6320 3d3d 2027 4e6f 7665 6c74  _func == 'Novelt
-0001b540: 7953 6561 7263 6827 3a0a 2020 2020 2020  ySearch':.      
-0001b550: 2020 2020 2020 2020 2020 2320 7265 6361            # reca
-0001b560: 6c63 756c 6174 6520 7468 6520 6469 7665  lculate the dive
-0001b570: 7273 6974 7920 6d65 7472 6963 2066 6f72  rsity metric for
-0001b580: 2061 2066 6169 7220 636f 6d70 6172 6973   a fair comparis
-0001b590: 6f6e 0a20 2020 2020 2020 2020 2020 2020  on.             
-0001b5a0: 2020 2065 6e73 656d 626c 655f 7661 6c75     ensemble_valu
-0001b5b0: 6520 3d20 6e70 2e6d 6561 6e28 5b78 2e70  e = np.mean([x.p
-0001b5c0: 7265 6469 6374 6564 5f76 616c 7565 7320  redicted_values 
-0001b5d0: 666f 7220 7820 696e 2073 656c 662e 686f  for x in self.ho
-0001b5e0: 665d 2c20 6178 6973 3d30 290a 2020 2020  f], axis=0).    
-0001b5f0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0001b600: 7820 696e 2073 656c 662e 686f 663a 0a20  x in self.hof:. 
-0001b610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b620: 2020 2061 6d62 6967 7569 7479 203d 2028     ambiguity = (
-0001b630: 782e 7072 6564 6963 7465 645f 7661 6c75  x.predicted_valu
-0001b640: 6573 202d 2065 6e73 656d 626c 655f 7661  es - ensemble_va
-0001b650: 6c75 6529 202a 2a20 320a 2020 2020 2020  lue) ** 2.      
-0001b660: 2020 2020 2020 2020 2020 2020 2020 782e                x.
-0001b670: 6361 7365 5f76 616c 7565 735b 6c65 6e28  case_values[len(
-0001b680: 782e 7072 6564 6963 7465 645f 7661 6c75  x.predicted_valu
-0001b690: 6573 293a 5d20 3d20 2d31 202a 2061 6d62  es):] = -1 * amb
-0001b6a0: 6967 7569 7479 0a0a 2020 2020 2020 2020  iguity..        
-0001b6b0: 2020 2020 6966 2073 656c 662e 7472 616e      if self.tran
-0001b6c0: 7366 6f72 6d65 725f 7377 6974 6368 3a0a  sformer_switch:.
-0001b6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b6e0: 7365 6c66 2e74 7261 6e73 666f 726d 6572  self.transformer
-0001b6f0: 5f74 6f6f 6c2e 7472 6169 6e28 290a 0a20  _tool.train().. 
-0001b700: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-0001b710: 6c66 2e63 726f 7373 5f70 6220 3d3d 2027  lf.cross_pb == '
-0001b720: 6c69 6e65 6172 273a 0a20 2020 2020 2020  linear':.       
-0001b730: 2020 2020 2020 2020 2063 7870 6220 3d20           cxpb = 
-0001b740: 6e70 2e69 6e74 6572 7028 6e70 2e61 7261  np.interp(np.ara
-0001b750: 6e67 6528 302c 2073 656c 662e 6e5f 6765  nge(0, self.n_ge
-0001b760: 6e29 2c20 5b30 2c20 7365 6c66 2e6e 5f67  n), [0, self.n_g
-0001b770: 656e 202d 2031 5d2c 205b 302e 312c 2030  en - 1], [0.1, 0
-0001b780: 2e38 5d29 5b67 656e 202d 2031 5d0a 2020  .8])[gen - 1].  
-0001b790: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-0001b7a0: 662e 6d75 7461 7469 6f6e 5f70 6220 3d3d  f.mutation_pb ==
-0001b7b0: 2027 6c69 6e65 6172 273a 0a20 2020 2020   'linear':.     
-0001b7c0: 2020 2020 2020 2020 2020 206d 7574 7062             mutpb
-0001b7d0: 203d 206e 702e 696e 7465 7270 286e 702e   = np.interp(np.
-0001b7e0: 6172 616e 6765 2830 2c20 7365 6c66 2e6e  arange(0, self.n
-0001b7f0: 5f67 656e 292c 205b 302c 2073 656c 662e  _gen), [0, self.
-0001b800: 6e5f 6765 6e20 2d20 315d 2c20 5b30 2e38  n_gen - 1], [0.8
-0001b810: 2c20 302e 315d 295b 6765 6e20 2d20 315d  , 0.1])[gen - 1]
-0001b820: 0a0a 2020 2020 2020 2020 2020 2020 7374  ..            st
-0001b830: 6172 745f 7469 6d65 203d 2074 696d 652e  art_time = time.
-0001b840: 7469 6d65 2829 0a20 2020 2020 2020 2020  time().         
-0001b850: 2020 2063 6f75 6e74 203d 2030 0a20 2020     count = 0.   
-0001b860: 2020 2020 2020 2020 206e 6577 5f6f 6666           new_off
-0001b870: 7370 7269 6e67 203d 205b 5d0a 0a20 2020  spring = []..   
-0001b880: 2020 2020 2020 2020 2023 2043 6c65 6172           # Clear
-0001b890: 696e 6720 7374 7261 7465 6779 3a20 6f6e  ing strategy: on
-0001b8a0: 6c79 2074 6865 2062 6573 7420 6f6e 6520  ly the best one 
-0001b8b0: 696e 2065 6163 6820 636c 7573 7465 7220  in each cluster 
-0001b8c0: 7769 6c6c 2073 7572 7669 7665 0a20 2020  will survive.   
-0001b8d0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-0001b8e0: 2e63 6c65 6172 696e 675f 636c 7573 7465  .clearing_cluste
-0001b8f0: 725f 7369 7a65 203e 2031 3a0a 2020 2020  r_size > 1:.    
-0001b900: 2020 2020 2020 2020 2020 2020 616c 6c5f              all_
-0001b910: 6361 7365 5f76 616c 7565 7320 3d20 6e70  case_values = np
-0001b920: 2e61 7272 6179 285b 702e 6361 7365 5f76  .array([p.case_v
-0001b930: 616c 7565 7320 666f 7220 7020 696e 2070  alues for p in p
-0001b940: 6f70 756c 6174 696f 6e5d 290a 2020 2020  opulation]).    
-0001b950: 2020 2020 2020 2020 2020 2020 7375 6d5f              sum_
-0001b960: 6669 746e 6573 7320 3d20 6e70 2e61 7272  fitness = np.arr
-0001b970: 6179 285b 702e 6669 746e 6573 732e 7776  ay([p.fitness.wv
-0001b980: 616c 7565 735b 305d 2066 6f72 2070 2069  alues[0] for p i
-0001b990: 6e20 706f 7075 6c61 7469 6f6e 5d29 0a20  n population]). 
-0001b9a0: 2020 2020 2020 2020 2020 2020 2020 206b                 k
-0001b9b0: 6579 203d 206e 702e 6172 616e 6765 2830  ey = np.arange(0
-0001b9c0: 2c20 6c65 6e28 706f 7075 6c61 7469 6f6e  , len(population
-0001b9d0: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
-0001b9e0: 2020 206c 6162 656c 203d 204b 4d65 616e     label = KMean
-0001b9f0: 7328 6c65 6e28 706f 7075 6c61 7469 6f6e  s(len(population
-0001ba00: 2920 2f2f 2073 656c 662e 636c 6561 7269  ) // self.cleari
-0001ba10: 6e67 5f63 6c75 7374 6572 5f73 697a 6529  ng_cluster_size)
-0001ba20: 2e66 6974 5f70 7265 6469 6374 2861 6c6c  .fit_predict(all
-0001ba30: 5f63 6173 655f 7661 6c75 6573 290a 2020  _case_values).  
-0001ba40: 2020 2020 2020 2020 2020 2020 2020 6466                df
-0001ba50: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
-0001ba60: 6e70 2e61 7272 6179 285b 6b65 792c 206c  np.array([key, l
-0001ba70: 6162 656c 2c20 7375 6d5f 6669 746e 6573  abel, sum_fitnes
-0001ba80: 735d 292e 542c 2063 6f6c 756d 6e73 3d5b  s]).T, columns=[
-0001ba90: 276b 6579 272c 2027 6c61 6265 6c27 2c20  'key', 'label', 
-0001baa0: 2766 6974 6e65 7373 275d 290a 2020 2020  'fitness']).    
-0001bab0: 2020 2020 2020 2020 2020 2020 6466 203d              df =
-0001bac0: 2064 662e 736f 7274 5f76 616c 7565 7328   df.sort_values(
-0001bad0: 2766 6974 6e65 7373 272c 2061 7363 656e  'fitness', ascen
-0001bae0: 6469 6e67 3d46 616c 7365 292e 6472 6f70  ding=False).drop
-0001baf0: 5f64 7570 6c69 6361 7465 7328 5b27 6c61  _duplicates(['la
-0001bb00: 6265 6c27 5d29 0a20 2020 2020 2020 2020  bel']).         
-0001bb10: 2020 2020 2020 2070 6f70 756c 6174 696f         populatio
-0001bb20: 6e20 3d20 5b70 6f70 756c 6174 696f 6e5b  n = [population[
-0001bb30: 696e 7428 6b29 5d20 666f 7220 6b20 696e  int(k)] for k in
-0001bb40: 206c 6973 7428 6466 5b27 6b65 7927 5d29   list(df['key'])
-0001bb50: 5d0a 0a20 2020 2020 2020 2020 2020 2069  ]..            i
-0001bb60: 6620 7365 6c66 2e64 796e 616d 6963 5f74  f self.dynamic_t
-0001bb70: 6172 6765 743a 0a20 2020 2020 2020 2020  arget:.         
-0001bb80: 2020 2020 2020 2062 6573 745f 696e 6420         best_ind 
-0001bb90: 3d20 746f 6f6c 626f 782e 636c 6f6e 6528  = toolbox.clone(
-0001bba0: 706f 7075 6c61 7469 6f6e 5b6e 702e 6172  population[np.ar
-0001bbb0: 676d 6178 285b 782e 6669 746e 6573 732e  gmax([x.fitness.
-0001bbc0: 7776 616c 7565 735b 305d 2066 6f72 2078  wvalues[0] for x
-0001bbd0: 2069 6e20 706f 7075 6c61 7469 6f6e 5d29   in population])
-0001bbe0: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
-0001bbf0: 2020 2064 656c 2062 6573 745f 696e 642e     del best_ind.
-0001bc00: 6669 746e 6573 732e 7661 6c75 6573 0a20  fitness.values. 
-0001bc10: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0001bc20: 6577 5f6f 6666 7370 7269 6e67 2e61 7070  ew_offspring.app
-0001bc30: 656e 6428 6265 7374 5f69 6e64 290a 0a20  end(best_ind).. 
-0001bc40: 2020 2020 2020 2020 2020 2077 6869 6c65             while
-0001bc50: 2028 6c65 6e28 6e65 775f 6f66 6673 7072   (len(new_offspr
-0001bc60: 696e 6729 203c 2070 6f70 5f73 697a 6529  ing) < pop_size)
-0001bc70: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001bc80: 2020 6966 2063 6f75 6e74 203e 2070 6f70    if count > pop
-0001bc90: 5f73 697a 6520 2a20 3130 303a 0a20 2020  _size * 100:.   
-0001bca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bcb0: 2072 6169 7365 2045 7863 6570 7469 6f6e   raise Exception
-0001bcc0: 2822 4572 726f 7221 2229 0a20 2020 2020  ("Error!").     
-0001bcd0: 2020 2020 2020 2020 2020 2063 6f75 6e74             count
-0001bce0: 202b 3d20 310a 2020 2020 2020 2020 2020   += 1.          
-0001bcf0: 2020 2020 2020 2320 5573 696e 6720 7468        # Using th
-0001bd00: 6520 6578 7465 726e 616c 2061 7263 6869  e external archi
-0001bd10: 7665 0a20 2020 2020 2020 2020 2020 2020  ve.             
-0001bd20: 2020 2069 6620 7365 6c66 2e65 7874 6572     if self.exter
-0001bd30: 6e61 6c5f 6172 6368 6976 6520 3d3d 2027  nal_archive == '
-0001bd40: 4861 6c6c 4f66 4661 6d65 2720 616e 6420  HallOfFame' and 
-0001bd50: 7365 6c66 2e68 6f66 2069 7320 6e6f 7420  self.hof is not 
-0001bd60: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0001bd70: 2020 2020 2020 2020 2020 7061 7265 6e74            parent
-0001bd80: 203d 2070 6f70 756c 6174 696f 6e20 2b20   = population + 
-0001bd90: 6c69 7374 2873 656c 662e 686f 6629 0a20  list(self.hof). 
-0001bda0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0001bdb0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0001bdc0: 2020 2020 2020 2020 2070 6172 656e 7420           parent 
-0001bdd0: 3d20 706f 7075 6c61 7469 6f6e 0a0a 2020  = population..  
-0001bde0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0001bdf0: 5365 6c65 6374 2074 6865 2062 6573 7420  Select the best 
-0001be00: 7375 7276 6976 616c 206f 7065 7261 746f  survival operato
-0001be10: 7220 6261 7365 6420 6f6e 2074 6865 2054  r based on the T
-0001be20: 686f 6d70 736f 6e20 7361 6d70 6c69 6e67  hompson sampling
-0001be30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001be40: 2069 6620 7365 6c66 2e73 656c 6563 7420   if self.select 
-0001be50: 3d3d 2027 4175 746f 2d4d 4354 5327 3a0a  == 'Auto-MCTS':.
-0001be60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001be70: 2020 2020 6361 6e64 6964 6174 6573 203d      candidates =
-0001be80: 206d 6374 735f 6469 6374 5b66 2752 6f6f   mcts_dict[f'Roo
-0001be90: 7427 5d0a 2020 2020 2020 2020 2020 2020  t'].            
-0001bea0: 2020 2020 2020 2020 7375 7276 6976 616c          survival
-0001beb0: 5f6f 7065 7261 746f 725f 6964 203d 206e  _operator_id = n
-0001bec0: 702e 6172 676d 6178 286e 702e 7261 6e64  p.argmax(np.rand
-0001bed0: 6f6d 2e62 6574 6128 6361 6e64 6964 6174  om.beta(candidat
-0001bee0: 6573 5b30 5d2c 2063 616e 6469 6461 7465  es[0], candidate
-0001bef0: 735b 315d 2929 0a20 2020 2020 2020 2020  s[1])).         
-0001bf00: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001bf10: 7061 7261 6d5b 2770 6172 656e 745f 6172  param['parent_ar
-0001bf20: 6368 6976 6527 5d20 3d20 6361 6e64 6964  chive'] = candid
-0001bf30: 6174 655f 7375 7276 6976 616c 5f6f 7065  ate_survival_ope
-0001bf40: 6172 6174 6f72 735b 7375 7276 6976 616c  arators[survival
-0001bf50: 5f6f 7065 7261 746f 725f 6964 5d0a 2020  _operator_id].  
-0001bf60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bf70: 2020 666f 7220 6f20 696e 2070 6172 656e    for o in paren
-0001bf80: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
-0001bf90: 2020 2020 2020 2020 2020 206f 2e73 7572             o.sur
-0001bfa0: 7669 7661 6c5f 6f70 6572 6174 6f72 5f69  vival_operator_i
-0001bfb0: 6420 3d20 7375 7276 6976 616c 5f6f 7065  d = survival_ope
-0001bfc0: 7261 746f 725f 6964 0a20 2020 2020 2020  rator_id.       
-0001bfd0: 2020 2020 2020 2020 2070 6172 656e 745f           parent_
-0001bfe0: 6172 6368 6976 6520 3d20 7365 6c66 2e70  archive = self.p
-0001bff0: 6172 616d 2e67 6574 2827 7061 7265 6e74  aram.get('parent
-0001c000: 5f61 7263 6869 7665 272c 204e 6f6e 6529  _archive', None)
-0001c010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c020: 2069 6620 7061 7265 6e74 5f61 7263 6869   if parent_archi
-0001c030: 7665 203d 3d20 2746 6974 6e65 7373 2d53  ve == 'Fitness-S
-0001c040: 697a 6527 3a0a 2020 2020 2020 2020 2020  ize':.          
-0001c050: 2020 2020 2020 2020 2020 7061 7265 6e74            parent
-0001c060: 203d 206e 7367 615f 6172 6368 6976 650a   = nsga_archive.
-0001c070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c080: 6966 2070 6172 656e 745f 6172 6368 6976  if parent_archiv
-0001c090: 6520 3d3d 2027 4146 5027 3a0a 2020 2020  e == 'AFP':.    
-0001c0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c0b0: 7061 7265 6e74 203d 2061 6670 5f61 7263  parent = afp_arc
-0001c0c0: 6869 7665 0a20 2020 2020 2020 2020 2020  hive.           
-0001c0d0: 2020 2020 2069 6620 7061 7265 6e74 5f61       if parent_a
-0001c0e0: 7263 6869 7665 203d 3d20 2742 6573 7427  rchive == 'Best'
-0001c0f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001c100: 2020 2020 2020 7061 7265 6e74 203d 2062        parent = b
-0001c110: 6573 745f 6172 6368 6976 650a 0a20 2020  est_archive..   
-0001c120: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0001c130: 7365 6c66 2e73 656c 6563 7420 3d3d 2027  self.select == '
-0001c140: 4175 746f 2720 6f72 2073 656c 662e 7365  Auto' or self.se
-0001c150: 6c65 6374 203d 3d20 2741 7574 6f2d 4d43  lect == 'Auto-MC
-0001c160: 5453 273a 0a20 2020 2020 2020 2020 2020  TS':.           
-0001c170: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-0001c180: 2e73 656c 6563 7420 3d3d 2027 4175 746f  .select == 'Auto
-0001c190: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
-0001c1a0: 2020 2020 2020 2020 2020 2073 656c 6563             selec
-0001c1b0: 7469 6f6e 5f6f 7065 7261 746f 725f 6964  tion_operator_id
-0001c1c0: 203d 206e 702e 6172 676d 6178 286e 702e   = np.argmax(np.
-0001c1d0: 7261 6e64 6f6d 2e62 6574 6128 7365 6c65  random.beta(sele
-0001c1e0: 6374 696f 6e5f 6461 7461 5b30 5d2c 2073  ction_data[0], s
-0001c1f0: 656c 6563 7469 6f6e 5f64 6174 615b 315d  election_data[1]
-0001c200: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
-0001c210: 2020 2020 2020 2020 2020 2073 656c 6563             selec
-0001c220: 7469 6f6e 5f6f 7065 7261 746f 7220 3d20  tion_operator = 
-0001c230: 7365 6c65 6374 696f 6e5f 6f70 6572 6174  selection_operat
-0001c240: 6f72 735b 7365 6c65 6374 696f 6e5f 6f70  ors[selection_op
-0001c250: 6572 6174 6f72 5f69 645d 0a20 2020 2020  erator_id].     
-0001c260: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0001c270: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0001c280: 2020 2020 2020 2020 2020 2020 2063 616e               can
-0001c290: 6469 6461 7465 7320 3d20 6d63 7473 5f64  didates = mcts_d
-0001c2a0: 6963 745b 2753 656c 6563 7469 6f6e 204f  ict['Selection O
-0001c2b0: 7065 7261 746f 7273 275d 0a20 2020 2020  perators'].     
-0001c2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c2d0: 2020 2073 656c 6563 7469 6f6e 5f6f 7065     selection_ope
-0001c2e0: 7261 746f 725f 6964 203d 206e 702e 6172  rator_id = np.ar
-0001c2f0: 676d 6178 286e 702e 7261 6e64 6f6d 2e62  gmax(np.random.b
-0001c300: 6574 6128 6361 6e64 6964 6174 6573 5b30  eta(candidates[0
-0001c310: 5d2c 2063 616e 6469 6461 7465 735b 315d  ], candidates[1]
-0001c320: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
-0001c330: 2020 2020 2020 2020 2020 2073 656c 6563             selec
-0001c340: 7469 6f6e 5f6f 7065 7261 746f 7220 3d20  tion_operator = 
-0001c350: 6361 6e64 6964 6174 655f 7365 6c65 6374  candidate_select
-0001c360: 696f 6e5f 6f70 6572 6174 6f72 735b 7365  ion_operators[se
-0001c370: 6c65 6374 696f 6e5f 6f70 6572 6174 6f72  lection_operator
-0001c380: 5f69 645d 0a20 2020 2020 2020 2020 2020  _id].           
-0001c390: 2020 2020 2020 2020 206f 6666 7370 7269           offspri
-0001c3a0: 6e67 203d 2073 656c 662e 6f66 6673 7072  ng = self.offspr
-0001c3b0: 696e 675f 7365 6c65 6374 696f 6e28 7061  ing_selection(pa
-0001c3c0: 7265 6e74 2c20 7365 6c65 6374 696f 6e5f  rent, selection_
-0001c3d0: 6f70 6572 6174 6f72 2c20 656c 6974 655f  operator, elite_
-0001c3e0: 6d61 7029 0a0a 2020 2020 2020 2020 2020  map)..          
-0001c3f0: 2020 2020 2020 2020 2020 666f 7220 6f20            for o 
-0001c400: 696e 206f 6666 7370 7269 6e67 3a0a 2020  in offspring:.  
-0001c410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c420: 2020 2020 2020 6f2e 7365 6c65 6374 696f        o.selectio
-0001c430: 6e5f 6f70 6572 6174 6f72 203d 2073 656c  n_operator = sel
-0001c440: 6563 7469 6f6e 5f6f 7065 7261 746f 725f  ection_operator_
-0001c450: 6964 0a20 2020 2020 2020 2020 2020 2020  id.             
-0001c460: 2020 2065 6c69 6620 2873 656c 662e 7365     elif (self.se
-0001c470: 6c65 6374 2069 6e20 6d61 705f 656c 6974  lect in map_elit
-0001c480: 655f 7365 7269 6573 2920 616e 6420 5c0a  e_series) and \.
-0001c490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c4a0: 2020 2020 2828 7365 6c66 2e6d 6170 5f65      ((self.map_e
-0001c4b0: 6c69 7465 5f70 6172 616d 6574 6572 5b27  lite_parameter['
-0001c4c0: 7472 6967 6765 725f 7469 6d65 275d 203d  trigger_time'] =
-0001c4d0: 3d20 2741 6c6c 2729 206f 720a 2020 2020  = 'All') or.    
-0001c4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c4f0: 2028 7365 6c66 2e6d 6170 5f65 6c69 7465   (self.map_elite
-0001c500: 5f70 6172 616d 6574 6572 5b27 7472 6967  _parameter['trig
-0001c510: 6765 725f 7469 6d65 275d 203d 3d20 2749  ger_time'] == 'I
-0001c520: 6d70 726f 7665 6d65 6e74 2720 616e 6420  mprovement' and 
-0001c530: 6669 746e 6573 735f 696d 7072 6f76 656d  fitness_improvem
-0001c540: 656e 7420 3e3d 2030 2929 3a0a 2020 2020  ent >= 0)):.    
-0001c550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c560: 6966 2069 7369 6e73 7461 6e63 6528 656c  if isinstance(el
-0001c570: 6974 655f 6d61 702c 206c 6973 7429 3a0a  ite_map, list):.
-0001c580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c590: 2020 2020 2020 2020 7061 7265 6e74 203d          parent =
-0001c5a0: 2065 6c69 7465 5f6d 6170 0a20 2020 2020   elite_map.     
-0001c5b0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0001c5c0: 6c69 6620 6973 696e 7374 616e 6365 2865  lif isinstance(e
-0001c5d0: 6c69 7465 5f6d 6170 2c20 6469 6374 293a  lite_map, dict):
-0001c5e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c5f0: 2020 2020 2020 2020 2070 6172 656e 7420           parent 
-0001c600: 3d20 6c69 7374 2865 6c69 7465 5f6d 6170  = list(elite_map
-0001c610: 2e76 616c 7565 7328 2929 0a20 2020 2020  .values()).     
-0001c620: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0001c630: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0001c640: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0001c650: 7365 2054 7970 6545 7272 6f72 0a0a 2020  se TypeError..  
-0001c660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c670: 2020 6f66 6673 7072 696e 6720 3d20 7365    offspring = se
-0001c680: 6c66 2e6f 6666 7370 7269 6e67 5f73 656c  lf.offspring_sel
-0001c690: 6563 7469 6f6e 2870 6172 656e 742c 2073  ection(parent, s
-0001c6a0: 656c 662e 7365 6c65 6374 2c20 656c 6974  elf.select, elit
-0001c6b0: 655f 6d61 7029 0a20 2020 2020 2020 2020  e_map).         
-0001c6c0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0001c6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c6e0: 206f 6666 7370 7269 6e67 203d 2073 656c   offspring = sel
-0001c6f0: 662e 7472 6164 6974 696f 6e61 6c5f 7061  f.traditional_pa
-0001c700: 7265 6e74 5f73 656c 6563 7469 6f6e 2874  rent_selection(t
-0001c710: 6f6f 6c62 6f78 2c20 7061 7265 6e74 2c20  oolbox, parent, 
-0001c720: 6578 7465 726e 616c 5f61 7263 6869 7665  external_archive
-0001c730: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-0001c740: 2020 206f 6666 7370 7269 6e67 3a20 4c69     offspring: Li
-0001c750: 7374 5b4d 756c 7469 706c 6547 656e 6547  st[MultipleGeneG
-0001c760: 505d 203d 206f 6666 7370 7269 6e67 5b3a  P] = offspring[:
-0001c770: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0001c780: 2020 7061 7265 6e74 5f66 6974 6e65 7373    parent_fitness
-0001c790: 203d 205b 6f2e 6669 746e 6573 732e 7776   = [o.fitness.wv
-0001c7a0: 616c 7565 735b 305d 2066 6f72 206f 2069  alues[0] for o i
-0001c7b0: 6e20 6f66 6673 7072 696e 675d 0a0a 2020  n offspring]..  
-0001c7c0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0001c7d0: 5661 7279 2074 6865 2070 6f6f 6c20 6f66  Vary the pool of
-0001c7e0: 2069 6e64 6976 6964 7561 6c73 0a20 2020   individuals.   
-0001c7f0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0001c800: 7365 6c66 2e6d 756c 7469 5f67 656e 655f  self.multi_gene_
-0001c810: 6d75 7461 7469 6f6e 2829 3a0a 2020 2020  mutation():.    
-0001c820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c830: 6c69 6d69 7461 7469 6f6e 5f63 6865 636b  limitation_check
-0001c840: 203d 2073 7461 7469 634c 696d 6974 5f6d   = staticLimit_m
-0001c850: 756c 7469 706c 655f 6765 6e65 286b 6579  ultiple_gene(key
-0001c860: 3d6f 7065 7261 746f 722e 6174 7472 6765  =operator.attrge
-0001c870: 7474 6572 2822 6865 6967 6874 2229 2c0a  tter("height"),.
-0001c880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c8c0: 206d 6178 5f76 616c 7565 3d73 656c 662e   max_value=self.
-0001c8d0: 6d61 785f 6865 6967 6874 2c0a 2020 2020  max_height,.    
-0001c8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c910: 2020 2020 2020 2020 2020 2020 206d 696e               min
-0001c920: 5f76 616c 7565 3d73 656c 662e 6d69 6e5f  _value=self.min_
-0001c930: 6865 6967 6874 290a 2020 2020 2020 2020  height).        
-0001c940: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0001c950: 656c 662e 7365 6d61 6e74 6963 5f76 6172  elf.semantic_var
-0001c960: 6961 7469 6f6e 3a0a 2020 2020 2020 2020  iation:.        
-0001c970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c980: 7365 6d61 6e74 6963 5f63 6865 636b 5f74  semantic_check_t
-0001c990: 6f6f 6c20 3d20 7b0a 2020 2020 2020 2020  ool = {.        
-0001c9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c9b0: 2020 2020 2778 273a 2073 656c 662e 582c      'x': self.X,
-0001c9c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c9d0: 2020 2020 2020 2020 2020 2020 2027 7927               'y'
-0001c9e0: 3a20 7365 6c66 2e79 2c0a 2020 2020 2020  : self.y,.      
-0001c9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ca00: 2020 2020 2020 2770 7365 7427 3a20 7365        'pset': se
-0001ca10: 6c66 2e70 7365 742c 0a20 2020 2020 2020  lf.pset,.       
-0001ca20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ca30: 2020 2020 2027 636f 7272 656c 6174 696f       'correlatio
-0001ca40: 6e5f 7468 7265 7368 6f6c 6427 3a20 7365  n_threshold': se
-0001ca50: 6c66 2e63 6f72 7265 6c61 7469 6f6e 5f74  lf.correlation_t
-0001ca60: 6872 6573 686f 6c64 2c0a 2020 2020 2020  hreshold,.      
-0001ca70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ca80: 2020 2020 2020 2763 6f72 7265 6c61 7469        'correlati
-0001ca90: 6f6e 5f6d 6f64 6527 3a20 7365 6c66 2e63  on_mode': self.c
-0001caa0: 6f72 7265 6c61 7469 6f6e 5f6d 6f64 652c  orrelation_mode,
-0001cab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001cac0: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
-0001cad0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0001cae0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0001caf0: 2020 2020 2020 2020 2020 2020 2073 656d               sem
-0001cb00: 616e 7469 635f 6368 6563 6b5f 746f 6f6c  antic_check_tool
-0001cb10: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-0001cb20: 2020 2020 2020 2020 2020 2020 2320 616c              # al
-0001cb30: 6c5f 6765 6e65 735f 6265 666f 7265 5f76  l_genes_before_v
-0001cb40: 6172 6961 7469 6f6e 203d 205b 7374 7228  ariation = [str(
-0001cb50: 6729 2066 6f72 2067 2069 6e20 6f2e 6765  g) for g in o.ge
-0001cb60: 6e65 2066 6f72 206f 2069 6e20 6f66 6673  ne for o in offs
-0001cb70: 7072 696e 675d 0a20 2020 2020 2020 2020  pring].         
-0001cb80: 2020 2020 2020 2020 2020 206f 6666 7370             offsp
-0001cb90: 7269 6e67 203d 2076 6172 416e 6450 6c75  ring = varAndPlu
-0001cba0: 7328 6f66 6673 7072 696e 672c 2074 6f6f  s(offspring, too
-0001cbb0: 6c62 6f78 2c20 6378 7062 2c20 6d75 7470  lbox, cxpb, mutp
-0001cbc0: 622c 2073 656c 662e 6765 6e65 5f6e 756d  b, self.gene_num
-0001cbd0: 2c20 6c69 6d69 7461 7469 6f6e 5f63 6865  , limitation_che
-0001cbe0: 636b 2c0a 2020 2020 2020 2020 2020 2020  ck,.            
-0001cbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cc00: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001cc10: 656d 616e 7469 635f 6368 6563 6b5f 746f  emantic_check_to
-0001cc20: 6f6c 2c20 7365 6c66 2e76 6172 5f6f 7229  ol, self.var_or)
-0001cc30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001cc40: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0001cc50: 2020 2020 2020 2020 2020 206f 6666 7370             offsp
-0001cc60: 7269 6e67 203d 2076 6172 416e 6428 6f66  ring = varAnd(of
-0001cc70: 6673 7072 696e 672c 2074 6f6f 6c62 6f78  fspring, toolbox
-0001cc80: 2c20 6378 7062 2c20 6d75 7470 6229 0a0a  , cxpb, mutpb)..
-0001cc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cca0: 2320 7665 7279 2073 7472 6f6e 6720 6d75  # very strong mu
-0001ccb0: 7461 7469 6f6e 0a20 2020 2020 2020 2020  tation.         
-0001ccc0: 2020 2020 2020 2069 6620 7365 6c66 2e69         if self.i
-0001ccd0: 6e74 726f 6e5f 7468 7265 7368 6f6c 6420  ntron_threshold 
-0001cce0: 3e20 303a 0a20 2020 2020 2020 2020 2020  > 0:.           
-0001ccf0: 2020 2020 2020 2020 2066 6f72 206f 2069           for o i
-0001cd00: 6e20 6f66 6673 7072 696e 673a 0a20 2020  n offspring:.   
-0001cd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cd20: 2020 2020 2066 6f72 2069 642c 2067 656e       for id, gen
-0001cd30: 6520 696e 2065 6e75 6d65 7261 7465 286f  e in enumerate(o
-0001cd40: 2e67 656e 6529 3a0a 2020 2020 2020 2020  .gene):.        
-0001cd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cd60: 2020 2020 6966 206f 2e63 6f65 665b 6964      if o.coef[id
-0001cd70: 5d20 3c20 7365 6c66 2e69 6e74 726f 6e5f  ] < self.intron_
-0001cd80: 7468 7265 7368 6f6c 643a 0a20 2020 2020  threshold:.     
-0001cd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cda0: 2020 2020 2020 2020 2020 206f 2e67 656e             o.gen
-0001cdb0: 655b 6964 5d2c 203d 2073 656c 662e 6e65  e[id], = self.ne
-0001cdc0: 7574 7261 6c5f 6d75 7461 7469 6f6e 2867  utral_mutation(g
-0001cdd0: 656e 652c 2074 6f6f 6c62 6f78 2e65 7870  ene, toolbox.exp
-0001cde0: 725f 6d75 742c 2073 656c 662e 7073 6574  r_mut, self.pset
-0001cdf0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-0001ce00: 2020 2073 656c 662e 7365 6d61 6e74 6963     self.semantic
-0001ce10: 5f72 6570 6169 725f 6665 6174 7572 6573  _repair_features
-0001ce20: 286f 6666 7370 7269 6e67 2c20 6578 7465  (offspring, exte
-0001ce30: 726e 616c 5f61 7263 6869 7665 290a 0a20  rnal_archive).. 
-0001ce40: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0001ce50: 6620 7365 6c66 2e62 6173 655f 6c65 6172  f self.base_lear
-0001ce60: 6e65 7220 3d3d 2027 4879 6272 6964 273a  ner == 'Hybrid':
-0001ce70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ce80: 2020 2020 2023 204d 7574 6174 696f 6e20       # Mutation 
-0001ce90: 666f 7220 6261 7365 206c 6561 726e 6572  for base learner
-0001cea0: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
-0001ceb0: 2020 2020 2020 6261 7365 5f6d 6f64 656c        base_model
-0001cec0: 7320 3d20 5b6f 2e62 6173 655f 6d6f 6465  s = [o.base_mode
-0001ced0: 6c20 666f 7220 6f20 696e 206f 6666 7370  l for o in offsp
-0001cee0: 7269 6e67 5d0a 2020 2020 2020 2020 2020  ring].          
-0001cef0: 2020 2020 2020 2020 2020 6261 7365 5f6d            base_m
-0001cf00: 6f64 656c 7320 3d20 7661 7241 6e64 2862  odels = varAnd(b
-0001cf10: 6173 655f 6d6f 6465 6c73 2c20 7365 6c66  ase_models, self
-0001cf20: 2e74 706f 745f 6d6f 6465 6c2e 5f74 6f6f  .tpot_model._too
-0001cf30: 6c62 6f78 2c20 302e 352c 2030 2e31 290a  lbox, 0.5, 0.1).
-0001cf40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cf50: 2020 2020 666f 7220 6f2c 2062 2069 6e20      for o, b in 
-0001cf60: 7a69 7028 6f66 6673 7072 696e 672c 2062  zip(offspring, b
-0001cf70: 6173 655f 6d6f 6465 6c73 293a 0a20 2020  ase_models):.   
-0001cf80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cf90: 2020 2020 206f 2e62 6173 655f 6d6f 6465       o.base_mode
-0001cfa0: 6c20 3d20 620a 0a20 2020 2020 2020 2020  l = b..         
-0001cfb0: 2020 2020 2020 2069 6620 7365 6c66 2e62         if self.b
-0001cfc0: 6173 655f 6c65 6172 6e65 7220 3d3d 2027  ase_learner == '
-0001cfd0: 536f 6674 2d50 4c54 7265 6527 3a0a 2020  Soft-PLTree':.  
+000196c0: 6966 2073 656c 662e 7665 7262 6f73 653a  if self.verbose:
+000196d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000196e0: 2020 2020 2070 7269 6e74 2827 4974 6572       print('Iter
+000196f0: 6174 696f 6e20 2564 2720 2520 672c 2027  ation %d' % g, '
+00019700: 5363 6f72 653a 2025 6627 2025 2028 7232  Score: %f' % (r2
+00019710: 5f73 636f 7265 2873 656c 662e 792c 2079  _score(self.y, y
+00019720: 5f70 7265 6429 2929 0a20 2020 2020 2020  _pred))).       
+00019730: 2020 2020 2020 2020 2023 2047 4220 666f           # GB fo
+00019740: 7220 7265 6772 6573 7369 6f6e 0a20 2020  r regression.   
+00019750: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00019760: 662e 7920 3d20 7365 6c66 2e79 202d 2030  f.y = self.y - 0
+00019770: 2e35 202a 2079 5f70 7265 640a 2020 2020  .5 * y_pred.    
+00019780: 2020 2020 2020 2020 7365 6c66 2e79 203d          self.y =
+00019790: 206f 7269 6769 6e61 6c5f 790a 2020 2020   original_y.    
+000197a0: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
+000197b0: 656e 2873 656c 662e 686f 6629 203d 3d20  en(self.hof) == 
+000197c0: 310a 2020 2020 2020 2020 2020 2020 2320  1.            # 
+000197d0: 7265 7472 6169 6e69 6e67 2061 6674 6572  retraining after
+000197e0: 2067 7261 6469 656e 7420 626f 6f73 7469   gradient boosti
+000197f0: 6e67 0a20 2020 2020 2020 2020 2020 2062  ng.            b
+00019800: 6573 745f 696e 643a 204d 756c 7469 706c  est_ind: Multipl
+00019810: 6547 656e 6547 5020 3d20 7365 6c66 2e68  eGeneGP = self.h
+00019820: 6f66 5b30 5d0a 2020 2020 2020 2020 2020  of[0].          
+00019830: 2020 6265 7374 5f69 6e64 2e67 656e 655f    best_ind.gene_
+00019840: 6e75 6d20 3d20 6f72 6967 696e 616c 5f67  num = original_g
+00019850: 656e 655f 6e75 6d0a 2020 2020 2020 2020  ene_num.        
+00019860: 2020 2020 6265 7374 5f69 6e64 2e67 656e      best_ind.gen
+00019870: 6520 3d20 6265 7374 5f6d 6f64 656c 730a  e = best_models.
+00019880: 2020 2020 2020 2020 2020 2020 6265 7374              best
+00019890: 5f69 6e64 2e70 6970 6520 3d20 7365 6c66  _ind.pipe = self
+000198a0: 2e67 6574 5f62 6173 655f 6d6f 6465 6c28  .get_base_model(
+000198b0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+000198c0: 6c66 2e66 696e 616c 5f6d 6f64 656c 5f6c  lf.final_model_l
+000198d0: 617a 795f 7472 6169 6e69 6e67 2873 656c  azy_training(sel
+000198e0: 662e 686f 6629 0a20 2020 2020 2020 2020  f.hof).         
+000198f0: 2020 2073 656c 662e 7365 636f 6e64 5f6c     self.second_l
+00019900: 6179 6572 5f67 656e 6572 6174 696f 6e28  ayer_generation(
+00019910: 7365 6c66 2e58 2c20 7365 6c66 2e79 290a  self.X, self.y).
+00019920: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00019930: 2020 2020 2020 2020 2020 706f 702c 206c            pop, l
+00019940: 6f67 203d 2073 656c 662e 6561 5369 6d70  og = self.eaSimp
+00019950: 6c65 2873 656c 662e 706f 702c 2073 656c  le(self.pop, sel
+00019960: 662e 746f 6f6c 626f 782c 2073 656c 662e  f.toolbox, self.
+00019970: 6372 6f73 735f 7062 2c20 7365 6c66 2e6d  cross_pb, self.m
+00019980: 7574 6174 696f 6e5f 7062 2c20 7365 6c66  utation_pb, self
+00019990: 2e6e 5f67 656e 2c0a 2020 2020 2020 2020  .n_gen,.        
+000199a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000199b0: 2020 2020 2020 2020 2020 2020 2073 7461               sta
+000199c0: 7473 3d6d 7374 6174 732c 2068 616c 6c6f  ts=mstats, hallo
+000199d0: 6666 616d 653d 7365 6c66 2e68 6f66 2c20  ffame=self.hof, 
+000199e0: 7665 7262 6f73 653d 7365 6c66 2e76 6572  verbose=self.ver
+000199f0: 626f 7365 290a 2020 2020 2020 2020 2020  bose).          
+00019a00: 2020 7365 6c66 2e70 6f70 203d 2070 6f70    self.pop = pop
+00019a10: 0a0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00019a20: 6c66 2e66 696e 616c 5f6d 6f64 656c 5f6c  lf.final_model_l
+00019a30: 617a 795f 7472 6169 6e69 6e67 2873 656c  azy_training(sel
+00019a40: 662e 686f 6629 0a20 2020 2020 2020 2020  f.hof).         
+00019a50: 2020 2073 656c 662e 7365 636f 6e64 5f6c     self.second_l
+00019a60: 6179 6572 5f67 656e 6572 6174 696f 6e28  ayer_generation(
+00019a70: 582c 2079 290a 2020 2020 2020 2020 7365  X, y).        se
+00019a80: 6c66 2e74 7261 696e 696e 675f 7769 7468  lf.training_with
+00019a90: 5f76 616c 6964 6174 696f 6e5f 7365 7428  _validation_set(
+00019aa0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00019ab0: 2073 656c 660a 0a20 2020 2064 6566 2073   self..    def s
+00019ac0: 6563 6f6e 645f 6c61 7965 725f 6765 6e65  econd_layer_gene
+00019ad0: 7261 7469 6f6e 2873 656c 662c 2058 2c20  ration(self, X, 
+00019ae0: 7929 3a0a 2020 2020 2020 2020 2320 616e  y):.        # an
+00019af0: 2069 6e74 6572 6573 7469 6e67 2071 7565   interesting que
+00019b00: 7374 696f 6e20 6973 2068 6f77 2074 6f20  stion is how to 
+00019b10: 636f 6d62 696e 6520 7468 6573 6520 6261  combine these ba
+00019b20: 7365 206c 6561 726e 6572 7320 746f 2061  se learners to a
+00019b30: 6368 6965 7665 2061 2067 6f6f 6420 656e  chieve a good en
+00019b40: 6f75 6768 2070 6572 666f 726d 616e 6365  ough performance
+00019b50: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00019b60: 2e73 6563 6f6e 645f 6c61 7965 7220 3d3d  .second_layer ==
+00019b70: 2027 4e6f 6e65 2720 6f72 2073 656c 662e   'None' or self.
+00019b80: 7365 636f 6e64 5f6c 6179 6572 203d 3d20  second_layer == 
+00019b90: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00019ba0: 2020 7265 7475 726e 0a20 2020 2020 2020    return.       
+00019bb0: 2079 5f64 6174 6120 3d20 7365 6c66 2e79   y_data = self.y
+00019bc0: 0a20 2020 2020 2020 2070 7265 6469 6374  .        predict
+00019bd0: 696f 6e73 203d 205b 5d0a 2020 2020 2020  ions = [].      
+00019be0: 2020 666f 7220 696e 6469 7669 6475 616c    for individual
+00019bf0: 2069 6e20 7365 6c66 2e68 6f66 3a0a 2020   in self.hof:.  
+00019c00: 2020 2020 2020 2020 2020 7072 6564 6963            predic
+00019c10: 7469 6f6e 732e 6170 7065 6e64 2869 6e64  tions.append(ind
+00019c20: 6976 6964 7561 6c2e 7072 6564 6963 7465  ividual.predicte
+00019c30: 645f 7661 6c75 6573 290a 2020 2020 2020  d_values).      
+00019c40: 2020 7072 6564 6963 7469 6f6e 7320 3d20    predictions = 
+00019c50: 6e70 2e61 7272 6179 2870 7265 6469 6374  np.array(predict
+00019c60: 696f 6e73 290a 0a20 2020 2020 2020 2069  ions)..        i
+00019c70: 6620 7365 6c66 2e73 6563 6f6e 645f 6c61  f self.second_la
+00019c80: 7965 7220 3d3d 2027 4452 4550 273a 0a20  yer == 'DREP':. 
+00019c90: 2020 2020 2020 2020 2020 2023 2066 6f72             # for
+00019ca0: 7761 7264 2073 656c 6563 7469 6f6e 0a20  ward selection. 
+00019cb0: 2020 2020 2020 2020 2020 2079 5f73 616d             y_sam
+00019cc0: 706c 6520 3d20 795f 6461 7461 2e66 6c61  ple = y_data.fla
+00019cd0: 7474 656e 2829 0a20 2020 2020 2020 2020  tten().         
+00019ce0: 2020 2063 7572 7265 6e74 5f70 7265 6469     current_predi
+00019cf0: 6374 696f 6e20 3d20 6e70 2e7a 6572 6f73  ction = np.zeros
+00019d00: 5f6c 696b 6528 795f 7361 6d70 6c65 290a  _like(y_sample).
+00019d10: 2020 2020 2020 2020 2020 2020 7265 6d61              rema
+00019d20: 696e 5f69 6e64 203d 2073 6574 285b 6920  in_ind = set([i 
+00019d30: 666f 7220 6920 696e 2072 616e 6765 286c  for i in range(l
+00019d40: 656e 2873 656c 662e 686f 6629 295d 290a  en(self.hof))]).
+00019d50: 2020 2020 2020 2020 2020 2020 6d69 6e5f              min_
+00019d60: 696e 6465 7820 3d20 300a 2020 2020 2020  index = 0.      
+00019d70: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+00019d80: 656d 6169 6e5f 696e 643a 0a20 2020 2020  emain_ind:.     
+00019d90: 2020 2020 2020 2020 2020 2065 7272 6f72             error
+00019da0: 203d 206e 702e 6d65 616e 2828 7072 6564   = np.mean((pred
+00019db0: 6963 7469 6f6e 735b 695d 202d 2079 5f73  ictions[i] - y_s
+00019dc0: 616d 706c 6529 202a 2a20 3229 0a20 2020  ample) ** 2).   
+00019dd0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00019de0: 6572 726f 7220 3c20 6e70 2e6d 6561 6e28  error < np.mean(
+00019df0: 2863 7572 7265 6e74 5f70 7265 6469 6374  (current_predict
+00019e00: 696f 6e20 2d20 795f 7361 6d70 6c65 2920  ion - y_sample) 
+00019e10: 2a2a 2032 293a 0a20 2020 2020 2020 2020  ** 2):.         
+00019e20: 2020 2020 2020 2020 2020 2063 7572 7265             curre
+00019e30: 6e74 5f70 7265 6469 6374 696f 6e20 3d20  nt_prediction = 
+00019e40: 7072 6564 6963 7469 6f6e 735b 695d 0a20  predictions[i]. 
+00019e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019e60: 2020 206d 696e 5f69 6e64 6578 203d 2069     min_index = i
+00019e70: 0a20 2020 2020 2020 2020 2020 2072 656d  .            rem
+00019e80: 6169 6e5f 696e 642e 7265 6d6f 7665 286d  ain_ind.remove(m
+00019e90: 696e 5f69 6e64 6578 290a 0a20 2020 2020  in_index)..     
+00019ea0: 2020 2020 2020 2065 6e73 656d 626c 655f         ensemble_
+00019eb0: 6c69 7374 203d 206e 702e 7a65 726f 7328  list = np.zeros(
+00019ec0: 6c65 6e28 7365 6c66 2e68 6f66 2929 0a20  len(self.hof)). 
+00019ed0: 2020 2020 2020 2020 2020 2065 6e73 656d             ensem
+00019ee0: 626c 655f 6c69 7374 5b6d 696e 5f69 6e64  ble_list[min_ind
+00019ef0: 6578 5d20 3d20 310a 2020 2020 2020 2020  ex] = 1.        
+00019f00: 2020 2020 7768 696c 6520 5472 7565 3a0a      while True:.
+00019f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019f20: 6469 765f 6c69 7374 203d 205b 5d0a 2020  div_list = [].  
+00019f30: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00019f40: 7220 6920 696e 2072 656d 6169 6e5f 696e  r i in remain_in
+00019f50: 643a 0a20 2020 2020 2020 2020 2020 2020  d:.             
+00019f60: 2020 2020 2020 2064 6976 6572 7369 7479         diversity
+00019f70: 203d 206e 702e 6d65 616e 2828 2863 7572   = np.mean(((cur
+00019f80: 7265 6e74 5f70 7265 6469 6374 696f 6e20  rent_prediction 
+00019f90: 2d20 7072 6564 6963 7469 6f6e 735b 695d  - predictions[i]
+00019fa0: 2920 2a2a 2032 2929 0a20 2020 2020 2020  ) ** 2)).       
+00019fb0: 2020 2020 2020 2020 2020 2020 206c 6f73               los
+00019fc0: 7320 3d20 6e70 2e6d 6561 6e28 2828 795f  s = np.mean(((y_
+00019fd0: 7361 6d70 6c65 202d 2070 7265 6469 6374  sample - predict
+00019fe0: 696f 6e73 5b69 5d29 202a 2a20 3229 290a  ions[i]) ** 2)).
+00019ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a000: 2020 2020 6469 765f 6c69 7374 2e61 7070      div_list.app
+0001a010: 656e 6428 2864 6976 6572 7369 7479 2c20  end((diversity, 
+0001a020: 6c6f 7373 2c20 6929 290a 2020 2020 2020  loss, i)).      
+0001a030: 2020 2020 2020 2020 2020 6469 765f 6c69            div_li
+0001a040: 7374 203d 206c 6973 7428 736f 7274 6564  st = list(sorted
+0001a050: 2864 6976 5f6c 6973 742c 206b 6579 3d6c  (div_list, key=l
+0001a060: 616d 6264 6120 783a 202d 785b 305d 2929  ambda x: -x[0]))
+0001a070: 5b3a 696e 7428 726f 756e 6428 6c65 6e28  [:int(round(len(
+0001a080: 6469 765f 6c69 7374 2920 2a20 302e 3529  div_list) * 0.5)
+0001a090: 295d 0a20 2020 2020 2020 2020 2020 2020  )].             
+0001a0a0: 2020 2064 6976 5f6c 6973 7420 3d20 6c69     div_list = li
+0001a0b0: 7374 2873 6f72 7465 6428 6469 765f 6c69  st(sorted(div_li
+0001a0c0: 7374 2c20 6b65 793d 6c61 6d62 6461 2078  st, key=lambda x
+0001a0d0: 3a20 785b 315d 2929 0a20 2020 2020 2020  : x[1])).       
+0001a0e0: 2020 2020 2020 2020 2069 6e64 6578 203d           index =
+0001a0f0: 2064 6976 5f6c 6973 745b 305d 5b32 5d0a   div_list[0][2].
+0001a100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a110: 656e 7365 6d62 6c65 5f73 697a 6520 3d20  ensemble_size = 
+0001a120: 6e70 2e73 756d 2865 6e73 656d 626c 655f  np.sum(ensemble_
+0001a130: 6c69 7374 290a 2020 2020 2020 2020 2020  list).          
+0001a140: 2020 2020 2020 7472 6961 6c5f 7072 6564        trial_pred
+0001a150: 6963 7469 6f6e 203d 2065 6e73 656d 626c  iction = ensembl
+0001a160: 655f 7369 7a65 202f 2028 656e 7365 6d62  e_size / (ensemb
+0001a170: 6c65 5f73 697a 6520 2b20 3129 202a 2063  le_size + 1) * c
+0001a180: 7572 7265 6e74 5f70 7265 6469 6374 696f  urrent_predictio
+0001a190: 6e20 2b20 5c0a 2020 2020 2020 2020 2020  n + \.          
+0001a1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a1b0: 2020 2020 2020 2020 2031 202f 2028 656e           1 / (en
+0001a1c0: 7365 6d62 6c65 5f73 697a 6520 2b20 3129  semble_size + 1)
+0001a1d0: 202a 2070 7265 6469 6374 696f 6e73 5b69   * predictions[i
+0001a1e0: 6e64 6578 5d0a 2020 2020 2020 2020 2020  ndex].          
+0001a1f0: 2020 2020 2020 6966 206e 702e 6d65 616e        if np.mean
+0001a200: 2828 2874 7269 616c 5f70 7265 6469 6374  (((trial_predict
+0001a210: 696f 6e20 2d20 795f 7361 6d70 6c65 2920  ion - y_sample) 
+0001a220: 2a2a 2032 2929 203e 206e 702e 6d65 616e  ** 2)) > np.mean
+0001a230: 2828 2863 7572 7265 6e74 5f70 7265 6469  (((current_predi
+0001a240: 6374 696f 6e20 2d20 795f 7361 6d70 6c65  ction - y_sample
+0001a250: 2920 2a2a 2032 2929 3a0a 2020 2020 2020  ) ** 2)):.      
+0001a260: 2020 2020 2020 2020 2020 2020 2020 6272                br
+0001a270: 6561 6b0a 2020 2020 2020 2020 2020 2020  eak.            
+0001a280: 2020 2020 6375 7272 656e 745f 7072 6564      current_pred
+0001a290: 6963 7469 6f6e 203d 2074 7269 616c 5f70  iction = trial_p
+0001a2a0: 7265 6469 6374 696f 6e0a 2020 2020 2020  rediction.      
+0001a2b0: 2020 2020 2020 2020 2020 656e 7365 6d62            ensemb
+0001a2c0: 6c65 5f6c 6973 745b 696e 6465 785d 203d  le_list[index] =
+0001a2d0: 2031 0a20 2020 2020 2020 2020 2020 2020   1.             
+0001a2e0: 2020 2072 656d 6169 6e5f 696e 642e 7265     remain_ind.re
+0001a2f0: 6d6f 7665 2869 6e64 6578 290a 2020 2020  move(index).    
+0001a300: 2020 2020 2020 2020 656e 7365 6d62 6c65          ensemble
+0001a310: 5f6c 6973 7420 2f3d 206e 702e 7375 6d28  _list /= np.sum(
+0001a320: 656e 7365 6d62 6c65 5f6c 6973 7429 0a20  ensemble_list). 
+0001a330: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001a340: 7472 6565 5f77 6569 6768 7420 3d20 656e  tree_weight = en
+0001a350: 7365 6d62 6c65 5f6c 6973 740a 2020 2020  semble_list.    
+0001a360: 2020 2020 656c 6966 2073 656c 662e 7365      elif self.se
+0001a370: 636f 6e64 5f6c 6179 6572 203d 3d20 2752  cond_layer == 'R
+0001a380: 6964 6765 273a 0a20 2020 2020 2020 2020  idge':.         
+0001a390: 2020 2073 656c 662e 7269 6467 6520 3d20     self.ridge = 
+0001a3a0: 5269 6467 6528 616c 7068 613d 3165 2d33  Ridge(alpha=1e-3
+0001a3b0: 2c20 6e6f 726d 616c 697a 653d 5472 7565  , normalize=True
+0001a3c0: 2c20 6669 745f 696e 7465 7263 6570 743d  , fit_intercept=
+0001a3d0: 4661 6c73 6529 0a20 2020 2020 2020 2020  False).         
+0001a3e0: 2020 2073 656c 662e 7269 6467 652e 6669     self.ridge.fi
+0001a3f0: 7428 7072 6564 6963 7469 6f6e 732e 542c  t(predictions.T,
+0001a400: 2079 5f64 6174 6129 0a20 2020 2020 2020   y_data).       
+0001a410: 2020 2020 2078 203d 2073 656c 662e 7269       x = self.ri
+0001a420: 6467 652e 636f 6566 5f0a 2020 2020 2020  dge.coef_.      
+0001a430: 2020 2020 2020 785b 7820 3c20 305d 203d        x[x < 0] =
+0001a440: 2030 0a20 2020 2020 2020 2020 2020 2078   0.            x
+0001a450: 5b78 203e 2030 5d20 3d20 310a 2020 2020  [x > 0] = 1.    
+0001a460: 2020 2020 2020 2020 7820 2f3d 206e 702e          x /= np.
+0001a470: 7375 6d28 7829 0a20 2020 2020 2020 2020  sum(x).         
+0001a480: 2020 2078 203d 2078 2e66 6c61 7474 656e     x = x.flatten
+0001a490: 2829 0a20 2020 2020 2020 2020 2020 2073  ().            s
+0001a4a0: 656c 662e 7472 6565 5f77 6569 6768 7420  elf.tree_weight 
+0001a4b0: 3d20 780a 2020 2020 2020 2020 656c 6966  = x.        elif
+0001a4c0: 2073 656c 662e 7365 636f 6e64 5f6c 6179   self.second_lay
+0001a4d0: 6572 203d 3d20 2752 6964 6765 2d50 7265  er == 'Ridge-Pre
+0001a4e0: 6469 6374 696f 6e27 3a0a 2020 2020 2020  diction':.      
+0001a4f0: 2020 2020 2020 7072 6564 6963 7469 6f6e        prediction
+0001a500: 7320 3d20 7365 6c66 2e69 6e64 6976 6964  s = self.individ
+0001a510: 7561 6c5f 7072 6564 6963 7469 6f6e 2858  ual_prediction(X
+0001a520: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
+0001a530: 6669 7474 696e 6720 7072 6564 6963 7465  fitting predicte
+0001a540: 6420 7661 6c75 6573 0a20 2020 2020 2020  d values.       
+0001a550: 2020 2020 2073 656c 662e 7269 6467 6520       self.ridge 
+0001a560: 3d20 5269 6467 6543 5628 6e6f 726d 616c  = RidgeCV(normal
+0001a570: 697a 653d 5472 7565 2c20 6669 745f 696e  ize=True, fit_in
+0001a580: 7465 7263 6570 743d 4661 6c73 6529 0a20  tercept=False). 
+0001a590: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001a5a0: 7269 6467 652e 6669 7428 7072 6564 6963  ridge.fit(predic
+0001a5b0: 7469 6f6e 732e 542c 2079 5f64 6174 6129  tions.T, y_data)
+0001a5c0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0001a5d0: 662e 7472 6565 5f77 6569 6768 7420 3d20  f.tree_weight = 
+0001a5e0: 7365 6c66 2e72 6964 6765 2e63 6f65 665f  self.ridge.coef_
+0001a5f0: 2e66 6c61 7474 656e 2829 0a20 2020 2020  .flatten().     
+0001a600: 2020 2065 6c69 6620 7365 6c66 2e73 6563     elif self.sec
+0001a610: 6f6e 645f 6c61 7965 7220 3d3d 2027 5246  ond_layer == 'RF
+0001a620: 2d52 6f75 7469 6e67 273a 0a20 2020 2020  -Routing':.     
+0001a630: 2020 2020 2020 2070 7265 6469 6374 696f         predictio
+0001a640: 6e73 203d 2073 656c 662e 696e 6469 7669  ns = self.indivi
+0001a650: 6475 616c 5f70 7265 6469 6374 696f 6e28  dual_prediction(
+0001a660: 5829 0a20 2020 2020 2020 2020 2020 2023  X).            #
+0001a670: 2066 6974 7469 6e67 2070 7265 6469 6374   fitting predict
+0001a680: 6564 2076 616c 7565 730a 2020 2020 2020  ed values.      
+0001a690: 2020 2020 2020 7365 6c66 2e72 6964 6765        self.ridge
+0001a6a0: 203d 2052 616e 646f 6d46 6f72 6573 7443   = RandomForestC
+0001a6b0: 6c61 7373 6966 6965 7228 6e5f 6573 7469  lassifier(n_esti
+0001a6c0: 6d61 746f 7273 3d31 3029 0a20 2020 2020  mators=10).     
+0001a6d0: 2020 2020 2020 2062 6573 745f 6172 6720         best_arg 
+0001a6e0: 3d20 2828 7072 6564 6963 7469 6f6e 7320  = ((predictions 
+0001a6f0: 2d20 795f 6461 7461 2920 2a2a 2032 292e  - y_data) ** 2).
+0001a700: 6172 676d 696e 2861 7869 733d 3029 0a20  argmin(axis=0). 
+0001a710: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001a720: 7269 6467 652e 6361 6e64 6964 6174 6573  ridge.candidates
+0001a730: 203d 206e 702e 736f 7274 286e 702e 756e   = np.sort(np.un
+0001a740: 6971 7565 2862 6573 745f 6172 6729 290a  ique(best_arg)).
+0001a750: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001a760: 2e72 6964 6765 2e66 6974 2858 2c20 6265  .ridge.fit(X, be
+0001a770: 7374 5f61 7267 290a 2020 2020 2020 2020  st_arg).        
+0001a780: 2020 2020 7365 6c66 2e74 7265 655f 7765      self.tree_we
+0001a790: 6967 6874 203d 204e 6f6e 650a 2020 2020  ight = None.    
+0001a7a0: 2020 2020 656c 6966 2073 656c 662e 7365      elif self.se
+0001a7b0: 636f 6e64 5f6c 6179 6572 203d 3d20 2754  cond_layer == 'T
+0001a7c0: 7265 6542 6173 656c 696e 6527 3a0a 2020  reeBaseline':.  
+0001a7d0: 2020 2020 2020 2020 2020 6261 7365 5f6c            base_l
+0001a7e0: 696e 655f 7363 6f72 6520 3d20 6e70 2e6d  ine_score = np.m
+0001a7f0: 6561 6e28 6372 6f73 735f 7661 6c5f 7363  ean(cross_val_sc
+0001a800: 6f72 6528 4465 6369 7369 6f6e 5472 6565  ore(DecisionTree
+0001a810: 5265 6772 6573 736f 7228 292c 2058 2c20  Regressor(), X, 
+0001a820: 7929 290a 2020 2020 2020 2020 2020 2020  y)).            
+0001a830: 7363 6f72 6520 3d20 6e70 2e61 7272 6179  score = np.array
+0001a840: 286c 6973 7428 6d61 7028 6c61 6d62 6461  (list(map(lambda
+0001a850: 2078 3a20 782e 6669 746e 6573 732e 7776   x: x.fitness.wv
+0001a860: 616c 7565 735b 305d 2c20 7365 6c66 2e68  alues[0], self.h
+0001a870: 6f66 2e69 7465 6d73 2929 290a 2020 2020  of.items))).    
+0001a880: 2020 2020 2020 2020 7820 3d20 6e70 2e7a          x = np.z
+0001a890: 6572 6f73 5f6c 696b 6528 7363 6f72 6529  eros_like(score)
+0001a8a0: 0a20 2020 2020 2020 2020 2020 2078 5b73  .            x[s
+0001a8b0: 636f 7265 203e 2062 6173 655f 6c69 6e65  core > base_line
+0001a8c0: 5f73 636f 7265 5d20 3d20 310a 2020 2020  _score] = 1.    
+0001a8d0: 2020 2020 2020 2020 6966 206e 702e 7375          if np.su
+0001a8e0: 6d28 7829 203d 3d20 303a 0a20 2020 2020  m(x) == 0:.     
+0001a8f0: 2020 2020 2020 2020 2020 2078 5b30 5d20             x[0] 
+0001a900: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
+0001a910: 7820 2f3d 206e 702e 7375 6d28 7829 0a20  x /= np.sum(x). 
+0001a920: 2020 2020 2020 2020 2020 2078 203d 2078             x = x
+0001a930: 2e66 6c61 7474 656e 2829 0a20 2020 2020  .flatten().     
+0001a940: 2020 2020 2020 2073 656c 662e 7472 6565         self.tree
+0001a950: 5f77 6569 6768 7420 3d20 780a 2020 2020  _weight = x.    
+0001a960: 2020 2020 656c 6966 2073 656c 662e 7365      elif self.se
+0001a970: 636f 6e64 5f6c 6179 6572 203d 3d20 2744  cond_layer == 'D
+0001a980: 6976 6572 7369 7479 5072 756e 6527 3a0a  iversityPrune':.
+0001a990: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
+0001a9a0: 6c65 5f6c 656e 203d 2035 3030 0a20 2020  le_len = 500.   
+0001a9b0: 2020 2020 2020 2020 2070 7265 6469 6374           predict
+0001a9c0: 696f 6e73 203d 205b 5d0a 2020 2020 2020  ions = [].      
+0001a9d0: 2020 2020 2020 666f 7220 696e 6469 7669        for indivi
+0001a9e0: 6475 616c 2069 6e20 7365 6c66 2e68 6f66  dual in self.hof
+0001a9f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001aa00: 2020 6675 6e63 203d 2073 656c 662e 746f    func = self.to
+0001aa10: 6f6c 626f 782e 636f 6d70 696c 6528 696e  olbox.compile(in
+0001aa20: 6469 7669 6475 616c 290a 2020 2020 2020  dividual).      
+0001aa30: 2020 2020 2020 2020 2020 7820 3d20 6e70            x = np
+0001aa40: 2e72 616e 646f 6d2e 7261 6e64 6e28 7361  .random.randn(sa
+0001aa50: 6d70 6c65 5f6c 656e 2c20 582e 7368 6170  mple_len, X.shap
+0001aa60: 655b 315d 290a 2020 2020 2020 2020 2020  e[1]).          
+0001aa70: 2020 2020 2020 5970 203d 2072 6573 756c        Yp = resul
+0001aa80: 745f 6361 6c63 756c 6174 696f 6e28 6675  t_calculation(fu
+0001aa90: 6e63 2c20 782c 2073 656c 662e 6f72 6967  nc, x, self.orig
+0001aaa0: 696e 616c 5f66 6561 7475 7265 7329 0a20  inal_features). 
+0001aab0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0001aac0: 7265 6469 6374 6564 203d 2069 6e64 6976  redicted = indiv
+0001aad0: 6964 7561 6c2e 7069 7065 2e70 7265 6469  idual.pipe.predi
+0001aae0: 6374 2859 7029 0a20 2020 2020 2020 2020  ct(Yp).         
+0001aaf0: 2020 2020 2020 2070 7265 6469 6374 696f         predictio
+0001ab00: 6e73 2e61 7070 656e 6428 7072 6564 6963  ns.append(predic
+0001ab10: 7465 6429 0a20 2020 2020 2020 2020 2020  ted).           
+0001ab20: 2070 7265 6469 6374 696f 6e73 203d 206e   predictions = n
+0001ab30: 702e 6172 7261 7928 7072 6564 6963 7469  p.array(predicti
+0001ab40: 6f6e 7329 0a0a 2020 2020 2020 2020 2020  ons)..          
+0001ab50: 2020 2320 666f 7277 6172 6420 7365 6c65    # forward sele
+0001ab60: 6374 696f 6e0a 2020 2020 2020 2020 2020  ction.          
+0001ab70: 2020 6375 7272 656e 745f 7072 6564 6963    current_predic
+0001ab80: 7469 6f6e 203d 206e 702e 7a65 726f 7328  tion = np.zeros(
+0001ab90: 7361 6d70 6c65 5f6c 656e 290a 2020 2020  sample_len).    
+0001aba0: 2020 2020 2020 2020 7265 6d61 696e 5f69          remain_i
+0001abb0: 6e64 203d 2073 6574 285b 6920 666f 7220  nd = set([i for 
+0001abc0: 6920 696e 2072 616e 6765 286c 656e 2873  i in range(len(s
+0001abd0: 656c 662e 686f 6629 295d 290a 0a20 2020  elf.hof))])..   
+0001abe0: 2020 2020 2020 2020 2023 2073 656c 6563           # selec
+0001abf0: 7420 6669 7273 7420 7265 6772 6573 736f  t first regresso
+0001ac00: 720a 2020 2020 2020 2020 2020 2020 6d69  r.            mi
+0001ac10: 6e5f 696e 6465 7820 3d20 300a 2020 2020  n_index = 0.    
+0001ac20: 2020 2020 2020 2020 7265 6d61 696e 5f69          remain_i
+0001ac30: 6e64 2e72 656d 6f76 6528 6d69 6e5f 696e  nd.remove(min_in
+0001ac40: 6465 7829 0a0a 2020 2020 2020 2020 2020  dex)..          
+0001ac50: 2020 656e 7365 6d62 6c65 5f6c 6973 7420    ensemble_list 
+0001ac60: 3d20 6e70 2e7a 6572 6f73 286c 656e 2873  = np.zeros(len(s
+0001ac70: 656c 662e 686f 6629 290a 2020 2020 2020  elf.hof)).      
+0001ac80: 2020 2020 2020 656e 7365 6d62 6c65 5f6c        ensemble_l
+0001ac90: 6973 745b 6d69 6e5f 696e 6465 785d 203d  ist[min_index] =
+0001aca0: 2031 0a20 2020 2020 2020 2020 2020 2077   1.            w
+0001acb0: 6869 6c65 2054 7275 653a 0a20 2020 2020  hile True:.     
+0001acc0: 2020 2020 2020 2020 2020 2064 6976 5f6c             div_l
+0001acd0: 6973 7420 3d20 5b5d 0a20 2020 2020 2020  ist = [].       
+0001ace0: 2020 2020 2020 2020 2066 6f72 2069 2069           for i i
+0001acf0: 6e20 7265 6d61 696e 5f69 6e64 3a0a 2020  n remain_ind:.  
+0001ad00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ad10: 2020 6469 7665 7273 6974 7920 3d20 6e70    diversity = np
+0001ad20: 2e6d 6561 6e28 2828 6375 7272 656e 745f  .mean(((current_
+0001ad30: 7072 6564 6963 7469 6f6e 202d 2070 7265  prediction - pre
+0001ad40: 6469 6374 696f 6e73 5b69 5d29 202a 2a20  dictions[i]) ** 
+0001ad50: 3229 290a 2020 2020 2020 2020 2020 2020  2)).            
+0001ad60: 2020 2020 2020 2020 6469 765f 6c69 7374          div_list
+0001ad70: 2e61 7070 656e 6428 2864 6976 6572 7369  .append((diversi
+0001ad80: 7479 2c20 6929 290a 2020 2020 2020 2020  ty, i)).        
+0001ad90: 2020 2020 2020 2020 6469 765f 6c69 7374          div_list
+0001ada0: 203d 206c 6973 7428 736f 7274 6564 2864   = list(sorted(d
+0001adb0: 6976 5f6c 6973 742c 206b 6579 3d6c 616d  iv_list, key=lam
+0001adc0: 6264 6120 783a 202d 785b 305d 2929 0a20  bda x: -x[0])). 
+0001add0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0001ade0: 6e64 6578 203d 2064 6976 5f6c 6973 745b  ndex = div_list[
+0001adf0: 305d 5b31 5d0a 2020 2020 2020 2020 2020  0][1].          
+0001ae00: 2020 2020 2020 656e 7365 6d62 6c65 5f73        ensemble_s
+0001ae10: 697a 6520 3d20 6e70 2e73 756d 2865 6e73  ize = np.sum(ens
+0001ae20: 656d 626c 655f 6c69 7374 290a 2020 2020  emble_list).    
+0001ae30: 2020 2020 2020 2020 2020 2020 7472 6961              tria
+0001ae40: 6c5f 7072 6564 6963 7469 6f6e 203d 2065  l_prediction = e
+0001ae50: 6e73 656d 626c 655f 7369 7a65 202f 2028  nsemble_size / (
+0001ae60: 656e 7365 6d62 6c65 5f73 697a 6520 2b20  ensemble_size + 
+0001ae70: 3129 202a 2063 7572 7265 6e74 5f70 7265  1) * current_pre
+0001ae80: 6469 6374 696f 6e20 2b20 5c0a 2020 2020  diction + \.    
+0001ae90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001aea0: 2020 2020 2020 2020 2020 2020 2020 2031                 1
+0001aeb0: 202f 2028 656e 7365 6d62 6c65 5f73 697a   / (ensemble_siz
+0001aec0: 6520 2b20 3129 202a 2070 7265 6469 6374  e + 1) * predict
+0001aed0: 696f 6e73 5b69 6e64 6578 5d0a 2020 2020  ions[index].    
+0001aee0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+0001aef0: 702e 6d65 616e 2828 2863 7572 7265 6e74  p.mean(((current
+0001af00: 5f70 7265 6469 6374 696f 6e20 2d20 7472  _prediction - tr
+0001af10: 6961 6c5f 7072 6564 6963 7469 6f6e 2920  ial_prediction) 
+0001af20: 2a2a 2032 2929 203c 2030 2e30 353a 0a20  ** 2)) < 0.05:. 
+0001af30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001af40: 2020 2062 7265 616b 0a20 2020 2020 2020     break.       
+0001af50: 2020 2020 2020 2020 2063 7572 7265 6e74           current
+0001af60: 5f70 7265 6469 6374 696f 6e20 3d20 7472  _prediction = tr
+0001af70: 6961 6c5f 7072 6564 6963 7469 6f6e 0a20  ial_prediction. 
+0001af80: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0001af90: 6e73 656d 626c 655f 6c69 7374 5b69 6e64  nsemble_list[ind
+0001afa0: 6578 5d20 3d20 310a 2020 2020 2020 2020  ex] = 1.        
+0001afb0: 2020 2020 2020 2020 7265 6d61 696e 5f69          remain_i
+0001afc0: 6e64 2e72 656d 6f76 6528 696e 6465 7829  nd.remove(index)
+0001afd0: 0a20 2020 2020 2020 2020 2020 2065 6e73  .            ens
+0001afe0: 656d 626c 655f 6c69 7374 202f 3d20 6e70  emble_list /= np
+0001aff0: 2e73 756d 2865 6e73 656d 626c 655f 6c69  .sum(ensemble_li
+0001b000: 7374 290a 2020 2020 2020 2020 2020 2020  st).            
+0001b010: 7365 6c66 2e74 7265 655f 7765 6967 6874  self.tree_weight
+0001b020: 203d 2065 6e73 656d 626c 655f 6c69 7374   = ensemble_list
+0001b030: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
+0001b040: 6c66 2e73 6563 6f6e 645f 6c61 7965 7220  lf.second_layer 
+0001b050: 3d3d 2027 4741 273a 0a20 2020 2020 2020  == 'GA':.       
+0001b060: 2020 2020 2023 206f 6f62 2063 616c 6375       # oob calcu
+0001b070: 6c61 7469 6f6e 0a20 2020 2020 2020 2020  lation.         
+0001b080: 2020 2070 6f70 203d 2073 656c 662e 686f     pop = self.ho
+0001b090: 660a 2020 2020 2020 2020 2020 2020 785f  f.            x_
+0001b0a0: 7472 6169 6e20 3d20 7365 6c66 2e58 0a20  train = self.X. 
+0001b0b0: 2020 2020 2020 2020 2020 206f 6f62 203d             oob =
+0001b0c0: 206e 702e 7a65 726f 7328 286c 656e 2870   np.zeros((len(p
+0001b0d0: 6f70 292c 206c 656e 2878 5f74 7261 696e  op), len(x_train
+0001b0e0: 2929 290a 2020 2020 2020 2020 2020 2020  ))).            
+0001b0f0: 666f 7220 692c 2069 6e64 2069 6e20 656e  for i, ind in en
+0001b100: 756d 6572 6174 6528 706f 7029 3a0a 2020  umerate(pop):.  
+0001b110: 2020 2020 2020 2020 2020 2020 2020 7361                sa
+0001b120: 6d70 6c65 203d 2069 6e64 2e6f 7574 5f6f  mple = ind.out_o
+0001b130: 665f 6261 670a 2020 2020 2020 2020 2020  f_bag.          
+0001b140: 2020 2020 2020 6368 6f73 656e 203d 206e        chosen = n
+0001b150: 702e 7a65 726f 7328 6c65 6e28 785f 7472  p.zeros(len(x_tr
+0001b160: 6169 6e29 290a 2020 2020 2020 2020 2020  ain)).          
+0001b170: 2020 2020 2020 6368 6f73 656e 5b73 616d        chosen[sam
+0001b180: 706c 655d 203d 2031 0a20 2020 2020 2020  ple] = 1.       
+0001b190: 2020 2020 2020 2020 206f 7574 5f6f 665f           out_of_
+0001b1a0: 6261 6720 3d20 6e70 2e77 6865 7265 2863  bag = np.where(c
+0001b1b0: 686f 7365 6e20 3d3d 2030 295b 305d 0a20  hosen == 0)[0]. 
+0001b1c0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0001b1d0: 756e 6320 3d20 7365 6c66 2e74 6f6f 6c62  unc = self.toolb
+0001b1e0: 6f78 2e63 6f6d 7069 6c65 2869 6e64 6976  ox.compile(indiv
+0001b1f0: 6964 7561 6c29 0a20 2020 2020 2020 2020  idual).         
+0001b200: 2020 2020 2020 2059 7020 3d20 7265 7375         Yp = resu
+0001b210: 6c74 5f63 616c 6375 6c61 7469 6f6e 2866  lt_calculation(f
+0001b220: 756e 632c 2078 5f74 7261 696e 5b6f 7574  unc, x_train[out
+0001b230: 5f6f 665f 6261 675d 2c20 7365 6c66 2e6f  _of_bag], self.o
+0001b240: 7269 6769 6e61 6c5f 6665 6174 7572 6573  riginal_features
+0001b250: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0001b260: 2020 6f6f 625b 695d 5b6f 7574 5f6f 665f    oob[i][out_of_
+0001b270: 6261 675d 203d 2069 6e64 2e70 6970 652e  bag] = ind.pipe.
+0001b280: 7072 6564 6963 7428 5970 290a 0a20 2020  predict(Yp)..   
+0001b290: 2020 2020 2020 2020 2077 6569 6768 7420           weight 
+0001b2a0: 3d20 6f6f 625f 7072 756e 696e 6728 6f6f  = oob_pruning(oo
+0001b2b0: 622c 2073 656c 662e 7929 0a20 2020 2020  b, self.y).     
+0001b2c0: 2020 2020 2020 2077 6569 6768 7420 3d20         weight = 
+0001b2d0: 7765 6967 6874 202f 206e 702e 7375 6d28  weight / np.sum(
+0001b2e0: 7765 6967 6874 290a 2020 2020 2020 2020  weight).        
+0001b2f0: 2020 2020 7365 6c66 2e74 7265 655f 7765      self.tree_we
+0001b300: 6967 6874 203d 2077 6569 6768 740a 2020  ight = weight.  
+0001b310: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
+0001b320: 7365 636f 6e64 5f6c 6179 6572 203d 3d20  second_layer == 
+0001b330: 2743 4157 5045 273a 0a20 2020 2020 2020  'CAWPE':.       
+0001b340: 2020 2020 2070 6f70 203d 2073 656c 662e       pop = self.
+0001b350: 686f 660a 2020 2020 2020 2020 2020 2020  hof.            
+0001b360: 7765 6967 6874 203d 206e 702e 6f6e 6573  weight = np.ones
+0001b370: 286c 656e 2870 6f70 2929 0a20 2020 2020  (len(pop)).     
+0001b380: 2020 2020 2020 2066 6f72 2069 2c20 696e         for i, in
+0001b390: 6420 696e 2065 6e75 6d65 7261 7465 2870  d in enumerate(p
+0001b3a0: 6f70 293a 0a20 2020 2020 2020 2020 2020  op):.           
+0001b3b0: 2020 2020 2066 6974 6e65 7373 203d 2069       fitness = i
+0001b3c0: 6e64 2e66 6974 6e65 7373 2e77 7661 6c75  nd.fitness.wvalu
+0001b3d0: 6573 5b30 5d0a 2020 2020 2020 2020 2020  es[0].          
+0001b3e0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+0001b3f0: 6e63 6528 7365 6c66 2c20 436c 6173 7369  nce(self, Classi
+0001b400: 6669 6572 4d69 7869 6e29 3a0a 2020 2020  fierMixin):.    
+0001b410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b420: 2320 7573 696e 6720 4d53 4520 6173 2074  # using MSE as t
+0001b430: 6865 2064 6566 6175 6c74 2066 6974 6e65  he default fitne
+0001b440: 7373 2063 7269 7465 7269 6f6e 0a20 2020  ss criterion.   
+0001b450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b460: 2077 6569 6768 745b 695d 203d 2028 3120   weight[i] = (1 
+0001b470: 2f20 6669 746e 6573 7329 202a 2a20 340a  / fitness) ** 4.
+0001b480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b490: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0001b4a0: 2020 2020 2020 2020 2020 2320 7573 696e            # usin
+0001b4b0: 6720 525e 3220 6173 2074 6865 2064 6566  g R^2 as the def
+0001b4c0: 6175 6c74 2066 6974 6e65 7373 2063 7269  ault fitness cri
+0001b4d0: 7465 7269 6f6e 0a20 2020 2020 2020 2020  terion.         
+0001b4e0: 2020 2020 2020 2020 2020 2069 6620 6669             if fi
+0001b4f0: 746e 6573 7320 3e20 303a 0a20 2020 2020  tness > 0:.     
+0001b500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b510: 2020 2077 6569 6768 745b 695d 203d 2028     weight[i] = (
+0001b520: 6669 746e 6573 7329 202a 2a20 340a 2020  fitness) ** 4.  
+0001b530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b540: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0001b550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b560: 7765 6967 6874 5b69 5d20 3d20 300a 2020  weight[i] = 0.  
+0001b570: 2020 2020 2020 2020 2020 7365 6c66 2e74            self.t
+0001b580: 7265 655f 7765 6967 6874 203d 2077 6569  ree_weight = wei
+0001b590: 6768 7420 2f20 6e70 2e73 756d 2877 6569  ght / np.sum(wei
+0001b5a0: 6768 7429 0a0a 2020 2020 6465 6620 696e  ght)..    def in
+0001b5b0: 6469 7669 6475 616c 5f70 7265 6469 6374  dividual_predict
+0001b5c0: 696f 6e28 7365 6c66 2c20 5829 3a0a 2020  ion(self, X):.  
+0001b5d0: 2020 2020 2020 6966 2073 656c 662e 6e6f        if self.no
+0001b5e0: 726d 616c 697a 653a 0a20 2020 2020 2020  rmalize:.       
+0001b5f0: 2020 2020 2058 203d 2073 656c 662e 785f       X = self.x_
+0001b600: 7363 616c 6572 2e74 7261 6e73 666f 726d  scaler.transform
+0001b610: 2858 290a 0a20 2020 2020 2020 2023 2067  (X)..        # g
+0001b620: 6574 2064 6574 6169 6c65 6420 7072 6564  et detailed pred
+0001b630: 6963 7469 6f6e 2072 6573 756c 7473 2069  iction results i
+0001b640: 6e73 7465 6164 206f 6620 616e 2065 6e73  nstead of an ens
+0001b650: 656d 626c 650a 2020 2020 2020 2020 7072  emble.        pr
+0001b660: 6564 6963 7469 6f6e 7320 3d20 5b5d 0a20  edictions = []. 
+0001b670: 2020 2020 2020 2066 6f72 2069 6e64 6976         for indiv
+0001b680: 6964 7561 6c20 696e 2073 656c 662e 686f  idual in self.ho
+0001b690: 663a 0a20 2020 2020 2020 2020 2020 2069  f:.            i
+0001b6a0: 6620 6c65 6e28 696e 6469 7669 6475 616c  f len(individual
+0001b6b0: 2e67 656e 6529 203d 3d20 303a 0a20 2020  .gene) == 0:.   
+0001b6c0: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
+0001b6d0: 7469 6e75 650a 2020 2020 2020 2020 2020  tinue.          
+0001b6e0: 2020 5970 203d 2071 7569 636b 5f72 6573    Yp = quick_res
+0001b6f0: 756c 745f 6361 6c63 756c 6174 696f 6e28  ult_calculation(
+0001b700: 696e 6469 7669 6475 616c 2e67 656e 652c  individual.gene,
+0001b710: 2073 656c 662e 7073 6574 2c20 582c 2073   self.pset, X, s
+0001b720: 656c 662e 6f72 6967 696e 616c 5f66 6561  elf.original_fea
+0001b730: 7475 7265 732c 0a20 2020 2020 2020 2020  tures,.         
+0001b740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b760: 2073 6b6c 6561 726e 5f66 6f72 6d61 743d   sklearn_format=
+0001b770: 7365 6c66 2e62 6173 6963 5f70 7269 6d69  self.basic_primi
+0001b780: 7469 7665 7320 3d3d 2027 4d4c 272c 0a20  tives == 'ML',. 
+0001b790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b7b0: 2020 2020 2020 2020 2072 6567 6973 7465           registe
+0001b7c0: 725f 6172 7261 793d 696e 6469 7669 6475  r_array=individu
+0001b7d0: 616c 2e70 6172 616d 6574 6572 735b 2752  al.parameters['R
+0001b7e0: 6567 6973 7465 7227 5d0a 2020 2020 2020  egister'].      
+0001b7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b810: 2020 2020 6966 2073 656c 662e 6d67 705f      if self.mgp_
+0001b820: 6d6f 6465 203d 3d20 2752 6567 6973 7465  mode == 'Registe
+0001b830: 7227 2065 6c73 6520 4e6f 6e65 290a 2020  r' else None).  
+0001b840: 2020 2020 2020 2020 2020 7072 6564 6963            predic
+0001b850: 7465 6420 3d20 696e 6469 7669 6475 616c  ted = individual
+0001b860: 2e70 6970 652e 7072 6564 6963 7428 5970  .pipe.predict(Yp
+0001b870: 290a 2020 2020 2020 2020 2020 2020 7072  ).            pr
+0001b880: 6564 6963 7469 6f6e 732e 6170 7065 6e64  edictions.append
+0001b890: 2870 7265 6469 6374 6564 290a 2020 2020  (predicted).    
+0001b8a0: 2020 2020 7072 6564 6963 7469 6f6e 7320      predictions 
+0001b8b0: 3d20 6e70 2e61 7272 6179 2870 7265 6469  = np.array(predi
+0001b8c0: 6374 696f 6e73 290a 0a20 2020 2020 2020  ctions)..       
+0001b8d0: 2069 6620 7365 6c66 2e6e 6f72 6d61 6c69   if self.normali
+0001b8e0: 7a65 3a0a 2020 2020 2020 2020 2020 2020  ze:.            
+0001b8f0: 7072 6564 6963 7469 6f6e 7320 3d20 7365  predictions = se
+0001b900: 6c66 2e79 5f73 6361 6c65 722e 696e 7665  lf.y_scaler.inve
+0001b910: 7273 655f 7472 616e 7366 6f72 6d28 7072  rse_transform(pr
+0001b920: 6564 6963 7469 6f6e 732e 7265 7368 6170  edictions.reshap
+0001b930: 6528 2d31 2c20 3129 292e 7265 7368 6170  e(-1, 1)).reshap
+0001b940: 6528 6c65 6e28 7365 6c66 2e68 6f66 292c  e(len(self.hof),
+0001b950: 202d 3129 0a20 2020 2020 2020 2072 6574   -1).        ret
+0001b960: 7572 6e20 7072 6564 6963 7469 6f6e 730a  urn predictions.
+0001b970: 0a20 2020 2064 6566 2062 6f6f 7473 7472  .    def bootstr
+0001b980: 6170 5f66 6974 6e65 7373 2873 656c 662c  ap_fitness(self,
+0001b990: 2059 702c 2059 5f74 7275 6529 3a0a 2020   Yp, Y_true):.  
+0001b9a0: 2020 2020 2020 6e75 6d20 3d20 6c65 6e28        num = len(
+0001b9b0: 595f 7472 7565 290a 2020 2020 2020 2020  Y_true).        
+0001b9c0: 7375 6d20 3d20 5b5d 0a20 2020 2020 2020  sum = [].       
+0001b9d0: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+0001b9e0: 3230 293a 0a20 2020 2020 2020 2020 2020  20):.           
+0001b9f0: 2069 6e64 6578 203d 206e 702e 7261 6e64   index = np.rand
+0001ba00: 6f6d 2e72 616e 6469 6e74 2830 2c20 6e75  om.randint(0, nu
+0001ba10: 6d2c 206e 756d 290a 2020 2020 2020 2020  m, num).        
+0001ba20: 2020 2020 7375 6d2e 6170 7065 6e64 286e      sum.append(n
+0001ba30: 702e 6d65 616e 2828 5970 5b69 6e64 6578  p.mean((Yp[index
+0001ba40: 5d20 2d20 595f 7472 7565 5b69 6e64 6578  ] - Y_true[index
+0001ba50: 5d29 202a 2a20 3229 290a 2020 2020 2020  ]) ** 2)).      
+0001ba60: 2020 7265 7475 726e 206e 702e 6d65 616e    return np.mean
+0001ba70: 2873 756d 290a 0a20 2020 2064 6566 2066  (sum)..    def f
+0001ba80: 696e 616c 5f6d 6f64 656c 5f6c 617a 795f  inal_model_lazy_
+0001ba90: 7472 6169 6e69 6e67 2873 656c 662c 2070  training(self, p
+0001baa0: 6f70 2c20 583d 4e6f 6e65 2c20 793d 4e6f  op, X=None, y=No
+0001bab0: 6e65 2c20 666f 7263 655f 7472 6169 6e69  ne, force_traini
+0001bac0: 6e67 3d46 616c 7365 293a 0a20 2020 2020  ng=False):.     
+0001bad0: 2020 2069 6620 5820 6973 204e 6f6e 653a     if X is None:
+0001bae0: 0a20 2020 2020 2020 2020 2020 2058 203d  .            X =
+0001baf0: 2073 656c 662e 580a 2020 2020 2020 2020   self.X.        
+0001bb00: 6966 2079 2069 7320 4e6f 6e65 3a0a 2020  if y is None:.  
+0001bb10: 2020 2020 2020 2020 2020 7920 3d20 7365            y = se
+0001bb20: 6c66 2e79 0a20 2020 2020 2020 2066 6f72  lf.y.        for
+0001bb30: 2070 2069 6e20 706f 703a 0a20 2020 2020   p in pop:.     
+0001bb40: 2020 2020 2020 2069 6620 7365 6c66 2e74         if self.t
+0001bb50: 6573 745f 6461 7461 5f73 697a 6520 3e20  est_data_size > 
+0001bb60: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
+0001bb70: 2020 2058 203d 2058 5b3a 2d73 656c 662e     X = X[:-self.
+0001bb80: 7465 7374 5f64 6174 615f 7369 7a65 5d0a  test_data_size].
+0001bb90: 2020 2020 2020 2020 2020 2020 5970 203d              Yp =
+0001bba0: 2073 656c 662e 6665 6174 7572 655f 6765   self.feature_ge
+0001bbb0: 6e65 7261 7469 6f6e 2858 2c20 7029 0a20  neration(X, p). 
+0001bbc0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001bbd0: 7472 6169 6e5f 6669 6e61 6c5f 6d6f 6465  train_final_mode
+0001bbe0: 6c28 702c 2059 702c 2079 2c20 666f 7263  l(p, Yp, y, forc
+0001bbf0: 655f 7472 6169 6e69 6e67 3d66 6f72 6365  e_training=force
+0001bc00: 5f74 7261 696e 696e 6729 0a0a 2020 2020  _training)..    
+0001bc10: 6465 6620 6665 6174 7572 655f 6765 6e65  def feature_gene
+0001bc20: 7261 7469 6f6e 2873 656c 662c 2058 2c20  ration(self, X, 
+0001bc30: 696e 6469 7669 6475 616c 293a 0a20 2020  individual):.   
+0001bc40: 2020 2020 2069 6620 696e 6469 7669 6475       if individu
+0001bc50: 616c 2e61 6374 6976 655f 6765 6e65 5f6e  al.active_gene_n
+0001bc60: 756d 203e 2030 3a0a 2020 2020 2020 2020  um > 0:.        
+0001bc70: 2020 2020 6765 6e65 7320 3d20 696e 6469      genes = indi
+0001bc80: 7669 6475 616c 2e67 656e 655b 3a69 6e64  vidual.gene[:ind
+0001bc90: 6976 6964 7561 6c2e 6163 7469 7665 5f67  ividual.active_g
+0001bca0: 656e 655f 6e75 6d5d 0a20 2020 2020 2020  ene_num].       
+0001bcb0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0001bcc0: 2020 2067 656e 6573 203d 2069 6e64 6976     genes = indiv
+0001bcd0: 6964 7561 6c2e 6765 6e65 0a20 2020 2020  idual.gene.     
+0001bce0: 2020 2059 7020 3d20 7175 6963 6b5f 7265     Yp = quick_re
+0001bcf0: 7375 6c74 5f63 616c 6375 6c61 7469 6f6e  sult_calculation
+0001bd00: 2867 656e 6573 2c20 7365 6c66 2e70 7365  (genes, self.pse
+0001bd10: 742c 2058 2c20 7365 6c66 2e6f 7269 6769  t, X, self.origi
+0001bd20: 6e61 6c5f 6665 6174 7572 6573 2c0a 2020  nal_features,.  
+0001bd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bd50: 2020 2020 736b 6c65 6172 6e5f 666f 726d      sklearn_form
+0001bd60: 6174 3d73 656c 662e 6261 7369 635f 7072  at=self.basic_pr
+0001bd70: 696d 6974 6976 6573 203d 3d20 274d 4c27  imitives == 'ML'
+0001bd80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001bd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bda0: 2020 2020 2020 2020 7265 6769 7374 6572          register
+0001bdb0: 5f61 7272 6179 3d69 6e64 6976 6964 7561  _array=individua
+0001bdc0: 6c2e 7061 7261 6d65 7465 7273 5b27 5265  l.parameters['Re
+0001bdd0: 6769 7374 6572 275d 0a20 2020 2020 2020  gister'].       
+0001bde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bdf0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0001be00: 6620 7365 6c66 2e6d 6770 5f6d 6f64 6520  f self.mgp_mode 
+0001be10: 3d3d 2027 5265 6769 7374 6572 2720 656c  == 'Register' el
+0001be20: 7365 204e 6f6e 6529 0a20 2020 2020 2020  se None).       
+0001be30: 2072 6574 7572 6e20 5970 0a0a 2020 2020   return Yp..    
+0001be40: 6465 6620 7072 6564 6963 7428 7365 6c66  def predict(self
+0001be50: 2c20 582c 2072 6574 7572 6e5f 7374 643d  , X, return_std=
+0001be60: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
+0001be70: 6966 2073 656c 662e 6e6f 726d 616c 697a  if self.normaliz
+0001be80: 653a 0a20 2020 2020 2020 2020 2020 2058  e:.            X
+0001be90: 203d 2073 656c 662e 785f 7363 616c 6572   = self.x_scaler
+0001bea0: 2e74 7261 6e73 666f 726d 2858 290a 2020  .transform(X).  
+0001beb0: 2020 2020 2020 7072 6564 6963 7469 6f6e        prediction
+0001bec0: 5f64 6174 615f 7369 7a65 203d 2058 2e73  _data_size = X.s
+0001bed0: 6861 7065 5b30 5d0a 2020 2020 2020 2020  hape[0].        
+0001bee0: 6966 2073 656c 662e 7465 7374 5f64 6174  if self.test_dat
+0001bef0: 615f 7369 7a65 203e 2030 3a0a 2020 2020  a_size > 0:.    
+0001bf00: 2020 2020 2020 2020 5820 3d20 6e70 2e63          X = np.c
+0001bf10: 6f6e 6361 7465 6e61 7465 285b 7365 6c66  oncatenate([self
+0001bf20: 2e58 2c20 585d 290a 2020 2020 2020 2020  .X, X]).        
+0001bf30: 2320 7072 756e 6520 6265 666f 7265 206d  # prune before m
+0001bf40: 616b 696e 6720 7072 6564 6963 7469 6f6e  aking prediction
+0001bf50: 730a 2020 2020 2020 2020 6966 2073 656c  s.        if sel
+0001bf60: 662e 696e 7472 6f6e 5f67 703a 0a20 2020  f.intron_gp:.   
+0001bf70: 2020 2020 2020 2020 2066 6f72 2068 2069           for h i
+0001bf80: 6e20 7365 6c66 2e68 6f66 3a0a 2020 2020  n self.hof:.    
+0001bf90: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0001bfa0: 6765 6e65 2069 6e20 682e 6765 6e65 3a0a  gene in h.gene:.
+0001bfb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bfc0: 2020 2020 6265 7374 5f69 6420 3d20 6d61      best_id = ma
+0001bfd0: 7828 5b28 6b2c 2067 6574 6174 7472 2867  x([(k, getattr(g
+0001bfe0: 2c20 2763 6f72 7227 2c20 3029 2920 666f  , 'corr', 0)) fo
+0001bff0: 7220 6b2c 2067 2069 6e20 656e 756d 6572  r k, g in enumer
+0001c000: 6174 6528 6765 6e65 295d 2c0a 2020 2020  ate(gene)],.    
+0001c010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c020: 2020 2020 2020 2020 2020 2020 2020 6b65                ke
+0001c030: 793d 6c61 6d62 6461 2078 3a20 2878 5b31  y=lambda x: (x[1
+0001c040: 5d2c 2078 5b30 5d29 295b 305d 0a20 2020  ], x[0]))[0].   
+0001c050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c060: 2068 6f69 7374 4d75 7461 7469 6f6e 2867   hoistMutation(g
+0001c070: 656e 652c 2062 6573 745f 6964 290a 2020  ene, best_id).  
+0001c080: 2020 2020 2020 2020 2020 2020 2020 682e                h.
+0001c090: 7069 7065 203d 2073 656c 662e 6765 745f  pipe = self.get_
+0001c0a0: 6261 7365 5f6d 6f64 656c 2829 0a20 2020  base_model().   
+0001c0b0: 2020 2020 2073 656c 662e 6669 6e61 6c5f       self.final_
+0001c0c0: 6d6f 6465 6c5f 6c61 7a79 5f74 7261 696e  model_lazy_train
+0001c0d0: 696e 6728 7365 6c66 2e68 6f66 290a 0a20  ing(self.hof).. 
+0001c0e0: 2020 2020 2020 2070 7265 6469 6374 696f         predictio
+0001c0f0: 6e73 203d 205b 5d0a 2020 2020 2020 2020  ns = [].        
+0001c100: 7765 6967 6874 5f6c 6973 7420 3d20 5b5d  weight_list = []
+0001c110: 0a20 2020 2020 2020 2023 2077 6569 6768  .        # weigh
+0001c120: 7465 6420 6279 2069 6d70 6f72 7461 6e63  ted by importanc
+0001c130: 650a 2020 2020 2020 2020 666f 7220 696e  e.        for in
+0001c140: 6469 7669 6475 616c 2069 6e20 7365 6c66  dividual in self
+0001c150: 2e68 6f66 3a0a 2020 2020 2020 2020 2020  .hof:.          
+0001c160: 2020 696e 6469 7669 6475 616c 3a20 4d75    individual: Mu
+0001c170: 6c74 6970 6c65 4765 6e65 4750 0a20 2020  ltipleGeneGP.   
+0001c180: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
+0001c190: 696e 6469 7669 6475 616c 2e67 656e 6529  individual.gene)
+0001c1a0: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
+0001c1b0: 2020 2020 2020 2063 6f6e 7469 6e75 650a         continue.
+0001c1c0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0001c1d0: 656c 662e 6261 7369 635f 7072 696d 6974  elf.basic_primit
+0001c1e0: 6976 6573 203d 3d20 274d 4c27 3a0a 2020  ives == 'ML':.  
+0001c1f0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+0001c200: 6564 6963 7465 6420 3d20 696e 6469 7669  edicted = indivi
+0001c210: 6475 616c 2e70 6970 652e 7072 6564 6963  dual.pipe.predic
+0001c220: 7428 5829 0a20 2020 2020 2020 2020 2020  t(X).           
+0001c230: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0001c240: 2020 2020 2020 2059 7020 3d20 7365 6c66         Yp = self
+0001c250: 2e66 6561 7475 7265 5f67 656e 6572 6174  .feature_generat
+0001c260: 696f 6e28 582c 2069 6e64 6976 6964 7561  ion(X, individua
+0001c270: 6c29 0a20 2020 2020 2020 2020 2020 2020  l).             
+0001c280: 2020 2069 6620 7365 6c66 2e74 6573 745f     if self.test_
+0001c290: 6461 7461 5f73 697a 6520 3e20 303a 0a20  data_size > 0:. 
+0001c2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c2b0: 2020 2059 7020 3d20 5970 5b2d 7072 6564     Yp = Yp[-pred
+0001c2c0: 6963 7469 6f6e 5f64 6174 615f 7369 7a65  iction_data_size
+0001c2d0: 3a5d 0a20 2020 2020 2020 2020 2020 2020  :].             
+0001c2e0: 2020 2069 6620 7365 6c66 2e62 6173 655f     if self.base_
+0001c2f0: 6c65 6172 6e65 7220 3d3d 2027 4e4e 273a  learner == 'NN':
+0001c300: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001c310: 2020 2020 206e 6e5f 7072 6564 6963 7469       nn_predicti
+0001c320: 6f6e 203d 2067 6574 5f61 6374 6976 6174  on = get_activat
+0001c330: 696f 6e73 2873 656c 662e 6e65 7572 616c  ions(self.neural
+0001c340: 5f6e 6574 776f 726b 2c20 5829 5b2d 325d  _network, X)[-2]
+0001c350: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001c360: 2020 2020 2059 7020 3d20 6e70 2e63 6f6e       Yp = np.con
+0001c370: 6361 7465 6e61 7465 285b 5970 2c20 6e6e  catenate([Yp, nn
+0001c380: 5f70 7265 6469 6374 696f 6e5d 2c20 6178  _prediction], ax
+0001c390: 6973 3d31 290a 2020 2020 2020 2020 2020  is=1).          
+0001c3a0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+0001c3b0: 6e63 6528 696e 6469 7669 6475 616c 2e70  nce(individual.p
+0001c3c0: 6970 655b 2752 6964 6765 275d 2c20 536f  ipe['Ridge'], So
+0001c3d0: 6674 504c 5472 6565 5265 6772 6573 736f  ftPLTreeRegresso
+0001c3e0: 7229 2061 6e64 205c 0a20 2020 2020 2020  r) and \.       
+0001c3f0: 2020 2020 2020 2020 2020 2020 206e 6f74               not
+0001c400: 2069 7369 6e73 7461 6e63 6528 696e 6469   isinstance(indi
+0001c410: 7669 6475 616c 2e70 6970 655b 2752 6964  vidual.pipe['Rid
+0001c420: 6765 275d 2c20 536f 6674 504c 5472 6565  ge'], SoftPLTree
+0001c430: 5265 6772 6573 736f 7245 4d29 3a0a 2020  RegressorEM):.  
+0001c440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c450: 2020 5970 203d 206e 702e 636f 6e63 6174    Yp = np.concat
+0001c460: 656e 6174 6528 5b59 702c 206e 702e 7a65  enate([Yp, np.ze
+0001c470: 726f 7328 286c 656e 2859 7029 2c20 3129  ros((len(Yp), 1)
+0001c480: 295d 2c20 6178 6973 3d31 290a 2020 2020  )], axis=1).    
+0001c490: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0001c4a0: 656c 662e 696e 7472 6f6e 5f70 726f 6261  elf.intron_proba
+0001c4b0: 6269 6c69 7479 203e 2030 3a0a 2020 2020  bility > 0:.    
+0001c4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c4d0: 5970 203d 2059 705b 3a2c 2069 6e64 6976  Yp = Yp[:, indiv
+0001c4e0: 6964 7561 6c2e 6163 7469 7665 5f67 656e  idual.active_gen
+0001c4f0: 655d 0a20 2020 2020 2020 2020 2020 2020  e].             
+0001c500: 2020 2070 7265 6469 6374 6564 203d 2069     predicted = i
+0001c510: 6e64 6976 6964 7561 6c2e 7069 7065 2e70  ndividual.pipe.p
+0001c520: 7265 6469 6374 2859 7029 0a0a 2020 2020  redict(Yp)..    
+0001c530: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0001c540: 6e6f 726d 616c 697a 653a 0a20 2020 2020  normalize:.     
+0001c550: 2020 2020 2020 2020 2020 2070 7265 6469             predi
+0001c560: 6374 6564 203d 2073 656c 662e 795f 7363  cted = self.y_sc
+0001c570: 616c 6572 2e69 6e76 6572 7365 5f74 7261  aler.inverse_tra
+0001c580: 6e73 666f 726d 2870 7265 6469 6374 6564  nsform(predicted
+0001c590: 2e72 6573 6861 7065 282d 312c 2031 2929  .reshape(-1, 1))
+0001c5a0: 2e66 6c61 7474 656e 2829 0a20 2020 2020  .flatten().     
+0001c5b0: 2020 2020 2020 2070 7265 6469 6374 696f         predictio
+0001c5c0: 6e73 2e61 7070 656e 6428 7072 6564 6963  ns.append(predic
+0001c5d0: 7465 6429 0a20 2020 2020 2020 2020 2020  ted).           
+0001c5e0: 2069 6620 6861 7361 7474 7228 7365 6c66   if hasattr(self
+0001c5f0: 2e68 6f66 2c20 2765 6e73 656d 626c 655f  .hof, 'ensemble_
+0001c600: 7765 6967 6874 2729 2061 6e64 206c 656e  weight') and len
+0001c610: 2873 656c 662e 686f 662e 656e 7365 6d62  (self.hof.ensemb
+0001c620: 6c65 5f77 6569 6768 7429 203e 2030 3a0a  le_weight) > 0:.
+0001c630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c640: 7765 6967 6874 5f6c 6973 742e 6170 7065  weight_list.appe
+0001c650: 6e64 2873 656c 662e 686f 662e 656e 7365  nd(self.hof.ense
+0001c660: 6d62 6c65 5f77 6569 6768 745b 696e 6469  mble_weight[indi
+0001c670: 7669 6475 616c 5f74 6f5f 7475 706c 6528  vidual_to_tuple(
+0001c680: 696e 6469 7669 6475 616c 295d 290a 2020  individual)]).  
+0001c690: 2020 2020 2020 6966 2073 656c 662e 7365        if self.se
+0001c6a0: 636f 6e64 5f6c 6179 6572 203d 3d20 2752  cond_layer == 'R
+0001c6b0: 462d 526f 7574 696e 6727 3a0a 2020 2020  F-Routing':.    
+0001c6c0: 2020 2020 2020 2020 7365 6c66 2e72 6964          self.rid
+0001c6d0: 6765 3a20 5261 6e64 6f6d 466f 7265 7374  ge: RandomForest
+0001c6e0: 436c 6173 7369 6669 6572 0a20 2020 2020  Classifier.     
+0001c6f0: 2020 2020 2020 2070 726f 6261 203d 2073         proba = s
+0001c700: 656c 662e 7269 6467 652e 7072 6564 6963  elf.ridge.predic
+0001c710: 745f 7072 6f62 6128 5829 0a20 2020 2020  t_proba(X).     
+0001c720: 2020 2020 2020 2066 696e 616c 5f70 7265         final_pre
+0001c730: 6469 6374 696f 6e20 3d20 286e 702e 6172  diction = (np.ar
+0001c740: 7261 7928 7072 6564 6963 7469 6f6e 7329  ray(predictions)
+0001c750: 5b73 656c 662e 7269 6467 652e 6361 6e64  [self.ridge.cand
+0001c760: 6964 6174 6573 5d2e 5420 2a20 7072 6f62  idates].T * prob
+0001c770: 6129 2e73 756d 2861 7869 733d 3129 0a20  a).sum(axis=1). 
+0001c780: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
+0001c790: 2e73 6563 6f6e 645f 6c61 7965 7220 213d  .second_layer !=
+0001c7a0: 2027 4e6f 6e65 2720 616e 6420 7365 6c66   'None' and self
+0001c7b0: 2e73 6563 6f6e 645f 6c61 7965 7220 213d  .second_layer !=
+0001c7c0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0001c7d0: 2020 2070 7265 6469 6374 696f 6e73 203d     predictions =
+0001c7e0: 206e 702e 6172 7261 7928 7072 6564 6963   np.array(predic
+0001c7f0: 7469 6f6e 7329 2e54 0a20 2020 2020 2020  tions).T.       
+0001c800: 2020 2020 2066 696e 616c 5f70 7265 6469       final_predi
+0001c810: 6374 696f 6e20 3d20 7072 6564 6963 7469  ction = predicti
+0001c820: 6f6e 7320 4020 7365 6c66 2e74 7265 655f  ons @ self.tree_
+0001c830: 7765 6967 6874 0a20 2020 2020 2020 2065  weight.        e
+0001c840: 6c69 6620 6c65 6e28 7765 6967 6874 5f6c  lif len(weight_l
+0001c850: 6973 7429 203e 2030 3a0a 2020 2020 2020  ist) > 0:.      
+0001c860: 2020 2020 2020 7072 6564 6963 7469 6f6e        prediction
+0001c870: 7320 3d20 6e70 2e61 7272 6179 2870 7265  s = np.array(pre
+0001c880: 6469 6374 696f 6e73 292e 540a 2020 2020  dictions).T.    
+0001c890: 2020 2020 2020 2020 7765 6967 6874 5f6c          weight_l
+0001c8a0: 6973 7420 3d20 6e70 2e61 7272 6179 2877  ist = np.array(w
+0001c8b0: 6569 6768 745f 6c69 7374 290a 2020 2020  eight_list).    
+0001c8c0: 2020 2020 2020 2020 6966 2072 6574 7572          if retur
+0001c8d0: 6e5f 7374 643a 0a20 2020 2020 2020 2020  n_std:.         
+0001c8e0: 2020 2020 2020 2066 696e 616c 5f70 7265         final_pre
+0001c8f0: 6469 6374 696f 6e20 3d20 7765 6967 6874  diction = weight
+0001c900: 6564 5f61 7667 5f61 6e64 5f73 7464 2870  ed_avg_and_std(p
+0001c910: 7265 6469 6374 696f 6e73 2e54 2c20 7765  redictions.T, we
+0001c920: 6967 6874 5f6c 6973 7429 0a20 2020 2020  ight_list).     
+0001c930: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0001c940: 2020 2020 2020 2020 2020 2020 2066 696e               fin
+0001c950: 616c 5f70 7265 6469 6374 696f 6e20 3d20  al_prediction = 
+0001c960: 7072 6564 6963 7469 6f6e 7320 4020 7765  predictions @ we
+0001c970: 6967 6874 5f6c 6973 7420 2f20 7765 6967  ight_list / weig
+0001c980: 6874 5f6c 6973 742e 7375 6d28 290a 2020  ht_list.sum().  
+0001c990: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0001c9a0: 2020 2020 2020 2020 6966 2072 6574 7572          if retur
+0001c9b0: 6e5f 7374 643a 0a20 2020 2020 2020 2020  n_std:.         
+0001c9c0: 2020 2020 2020 2066 696e 616c 5f70 7265         final_pre
+0001c9d0: 6469 6374 696f 6e20 3d20 6e70 2e6d 6561  diction = np.mea
+0001c9e0: 6e28 7072 6564 6963 7469 6f6e 732c 2061  n(predictions, a
+0001c9f0: 7869 733d 3029 2c20 6e70 2e73 7464 2870  xis=0), np.std(p
+0001ca00: 7265 6469 6374 696f 6e73 2c20 6178 6973  redictions, axis
+0001ca10: 3d30 290a 2020 2020 2020 2020 2020 2020  =0).            
+0001ca20: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0001ca30: 2020 2020 2020 2320 666f 7220 7820 696e        # for x in
+0001ca40: 2073 656c 662e 686f 665b 305d 2e67 656e   self.hof[0].gen
+0001ca50: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0001ca60: 2020 2023 2020 2020 2070 7269 6e74 2878     #     print(x
+0001ca70: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0001ca80: 2020 6966 2073 656c 662e 656e 7365 6d62    if self.ensemb
+0001ca90: 6c65 5f70 7265 6469 6374 696f 6e20 3d3d  le_prediction ==
+0001caa0: 2027 4d65 616e 273a 0a20 2020 2020 2020   'Mean':.       
+0001cab0: 2020 2020 2020 2020 2020 2020 2066 696e               fin
+0001cac0: 616c 5f70 7265 6469 6374 696f 6e20 3d20  al_prediction = 
+0001cad0: 6e70 2e6d 6561 6e28 7072 6564 6963 7469  np.mean(predicti
+0001cae0: 6f6e 732c 2061 7869 733d 3029 0a20 2020  ons, axis=0).   
+0001caf0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+0001cb00: 6620 7365 6c66 2e65 6e73 656d 626c 655f  f self.ensemble_
+0001cb10: 7072 6564 6963 7469 6f6e 203d 3d20 274d  prediction == 'M
+0001cb20: 6564 6961 6e27 3a0a 2020 2020 2020 2020  edian':.        
+0001cb30: 2020 2020 2020 2020 2020 2020 6669 6e61              fina
+0001cb40: 6c5f 7072 6564 6963 7469 6f6e 203d 206e  l_prediction = n
+0001cb50: 702e 6d65 6469 616e 2870 7265 6469 6374  p.median(predict
+0001cb60: 696f 6e73 2c20 6178 6973 3d30 290a 2020  ions, axis=0).  
+0001cb70: 2020 2020 2020 2020 2020 2020 2020 656c                el
+0001cb80: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0001cb90: 2020 2020 2020 2020 7261 6973 6520 4578          raise Ex
+0001cba0: 6365 7074 696f 6e0a 2020 2020 2020 2020  ception.        
+0001cbb0: 6966 206c 656e 2873 656c 662e 795f 7368  if len(self.y_sh
+0001cbc0: 6170 6529 203d 3d20 323a 0a20 2020 2020  ape) == 2:.     
+0001cbd0: 2020 2020 2020 2066 696e 616c 5f70 7265         final_pre
+0001cbe0: 6469 6374 696f 6e20 3d20 6669 6e61 6c5f  diction = final_
+0001cbf0: 7072 6564 6963 7469 6f6e 2e72 6573 6861  prediction.resha
+0001cc00: 7065 282d 312c 2031 290a 2020 2020 2020  pe(-1, 1).      
+0001cc10: 2020 7265 7475 726e 2066 696e 616c 5f70    return final_p
+0001cc20: 7265 6469 6374 696f 6e0a 0a20 2020 2064  rediction..    d
+0001cc30: 6566 2067 6574 5f68 6f66 2873 656c 6629  ef get_hof(self)
+0001cc40: 3a0a 2020 2020 2020 2020 6966 2073 656c  :.        if sel
+0001cc50: 662e 686f 6620 213d 204e 6f6e 653a 0a20  f.hof != None:. 
+0001cc60: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0001cc70: 6e20 5b78 2066 6f72 2078 2069 6e20 7365  n [x for x in se
+0001cc80: 6c66 2e68 6f66 5d0a 2020 2020 2020 2020  lf.hof].        
+0001cc90: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0001cca0: 2020 7265 7475 726e 204e 6f6e 650a 0a20    return None.. 
+0001ccb0: 2020 2064 6566 2061 7070 656e 645f 6576     def append_ev
+0001ccc0: 616c 7561 7465 645f 6665 6174 7572 6573  aluated_features
+0001ccd0: 2873 656c 662c 2070 6f70 293a 0a20 2020  (self, pop):.   
+0001cce0: 2020 2020 2069 6620 7365 6c66 2e6d 7574       if self.mut
+0001ccf0: 6174 696f 6e5f 7363 6865 6d65 2069 6e20  ation_scheme in 
+0001cd00: 6564 615f 6f70 6572 6174 6f72 7320 6f72  eda_operators or
+0001cd10: 2027 756e 6966 6f72 6d27 2069 6e20 7365   'uniform' in se
+0001cd20: 6c66 2e6d 7574 6174 696f 6e5f 7363 6865  lf.mutation_sche
+0001cd30: 6d65 3a0a 2020 2020 2020 2020 2020 2020  me:.            
+0001cd40: 7265 7475 726e 0a20 2020 2020 2020 2023  return.        #
+0001cd50: 2061 7070 656e 6420 6576 616c 7561 7465   append evaluate
+0001cd60: 6420 6665 6174 7572 6573 2074 6f20 616e  d features to an
+0001cd70: 2061 7263 6869 7665 0a20 2020 2020 2020   archive.       
+0001cd80: 2023 2074 6869 7320 6172 6368 6976 6520   # this archive 
+0001cd90: 6361 6e20 6265 2075 7365 6420 746f 2065  can be used to e
+0001cda0: 6c69 6d69 6e61 7465 2072 6570 6574 6974  liminate repetit
+0001cdb0: 6976 6520 6665 6174 7572 6573 0a20 2020  ive features.   
+0001cdc0: 2020 2020 2069 6620 7365 6c66 2e75 7365       if self.use
+0001cdd0: 6c65 7373 5f66 6561 7475 7265 5f72 6174  less_feature_rat
+0001cde0: 696f 2021 3d20 4e6f 6e65 3a0a 2020 2020  io != None:.    
+0001cdf0: 2020 2020 2020 2020 6d65 616e 5f69 6d70          mean_imp
+0001ce00: 6f72 7461 6e63 6520 3d20 6e70 2e71 7561  ortance = np.qua
+0001ce10: 6e74 696c 6528 5b69 6e64 2e63 6f65 6620  ntile([ind.coef 
+0001ce20: 666f 7220 696e 6420 696e 2070 6f70 5d2c  for ind in pop],
+0001ce30: 2073 656c 662e 7573 656c 6573 735f 6665   self.useless_fe
+0001ce40: 6174 7572 655f 7261 7469 6f29 0a20 2020  ature_ratio).   
+0001ce50: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0001ce60: 2020 2020 2020 206d 6561 6e5f 696d 706f         mean_impo
+0001ce70: 7274 616e 6365 203d 206e 702e 6172 7261  rtance = np.arra
+0001ce80: 7928 5b69 6e64 2e63 6f65 6620 666f 7220  y([ind.coef for 
+0001ce90: 696e 6420 696e 2070 6f70 5d29 2e6d 6561  ind in pop]).mea
+0001cea0: 6e28 290a 2020 2020 2020 2020 2320 6d65  n().        # me
+0001ceb0: 616e 5f69 6d70 6f72 7461 6e63 6520 3d20  an_importance = 
+0001cec0: 6e70 2e6d 6561 6e28 5b69 6e64 2e66 6974  np.mean([ind.fit
+0001ced0: 6e65 7373 2e77 7661 6c75 6573 5b30 5d20  ness.wvalues[0] 
+0001cee0: 666f 7220 696e 6420 696e 2070 6f70 5d29  for ind in pop])
+0001cef0: 0a20 2020 2020 2020 2066 6f72 2069 6e64  .        for ind
+0001cf00: 2069 6e20 706f 703a 0a20 2020 2020 2020   in pop:.       
+0001cf10: 2020 2020 2023 2069 6620 696e 642e 6669       # if ind.fi
+0001cf20: 746e 6573 732e 7776 616c 7565 735b 305d  tness.wvalues[0]
+0001cf30: 203c 3d20 6d65 616e 5f69 6d70 6f72 7461   <= mean_importa
+0001cf40: 6e63 653a 0a20 2020 2020 2020 2020 2020  nce:.           
+0001cf50: 2066 6f72 2067 656e 652c 2063 2069 6e20   for gene, c in 
+0001cf60: 7a69 7028 696e 642e 6765 6e65 2c20 696e  zip(ind.gene, in
+0001cf70: 642e 636f 6566 293a 0a20 2020 2020 2020  d.coef):.       
+0001cf80: 2020 2020 2020 2020 2069 6620 6320 3c3d           if c <=
+0001cf90: 206d 6561 6e5f 696d 706f 7274 616e 6365   mean_importance
+0001cfa0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001cfb0: 2020 2020 2020 7365 6c66 2e67 656e 6572        self.gener
+0001cfc0: 6174 6564 5f66 6561 7475 7265 732e 6164  ated_features.ad
+0001cfd0: 6428 7374 7228 6765 6e65 2929 0a20 2020  d(str(gene)).   
 0001cfe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cff0: 2020 2320 5570 6461 7465 2070 6172 7469    # Update parti
-0001d000: 7469 6f6e 2073 6368 656d 650a 2020 2020  tion scheme.    
-0001d010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d020: 7061 7274 6974 696f 6e5f 7363 6865 6d65  partition_scheme
-0001d030: 7320 3d20 5b6f 2e70 6172 7469 7469 6f6e  s = [o.partition
-0001d040: 5f73 6368 656d 6520 666f 7220 6f20 696e  _scheme for o in
-0001d050: 206f 6666 7370 7269 6e67 5d0a 2020 2020   offspring].    
-0001d060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d070: 2320 5265 6164 2068 7970 6572 7061 7261  # Read hyperpara
-0001d080: 6d65 7465 7273 2066 726f 6d20 7061 7261  meters from para
-0001d090: 6d65 7465 7220 6469 6374 0a20 2020 2020  meter dict.     
-0001d0a0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0001d0b0: 735f 7472 6565 5f63 726f 7373 5f70 6220  s_tree_cross_pb 
-0001d0c0: 3d20 7365 6c66 2e70 6172 616d 2e67 6574  = self.param.get
-0001d0d0: 2827 7073 5f74 7265 655f 6372 6f73 735f  ('ps_tree_cross_
-0001d0e0: 7062 272c 2030 290a 2020 2020 2020 2020  pb', 0).        
-0001d0f0: 2020 2020 2020 2020 2020 2020 7073 5f74              ps_t
-0001d100: 7265 655f 6d75 7461 7465 5f70 6220 3d20  ree_mutate_pb = 
-0001d110: 7365 6c66 2e70 6172 616d 2e67 6574 2827  self.param.get('
-0001d120: 7073 5f74 7265 655f 6d75 7461 7465 5f70  ps_tree_mutate_p
-0001d130: 6227 2c20 3029 0a20 2020 2020 2020 2020  b', 0).         
-0001d140: 2020 2020 2020 2020 2020 2073 6368 656d             schem
-0001d150: 655f 746f 6f6c 626f 783a 2054 6f6f 6c62  e_toolbox: Toolb
-0001d160: 6f78 203d 2070 6172 7469 7469 6f6e 5f73  ox = partition_s
-0001d170: 6368 656d 655f 746f 6f6c 626f 7828 7365  cheme_toolbox(se
-0001d180: 6c66 2e70 6172 7469 7469 6f6e 5f6e 756d  lf.partition_num
-0001d190: 6265 722c 0a20 2020 2020 2020 2020 2020  ber,.           
-0001d1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d1d0: 2020 2020 2020 2020 2020 2020 7073 5f74              ps_t
-0001d1e0: 7265 655f 6372 6f73 735f 7062 2c20 7073  ree_cross_pb, ps
-0001d1f0: 5f74 7265 655f 6d75 7461 7465 5f70 6229  _tree_mutate_pb)
-0001d200: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d210: 2020 2020 2070 6172 7469 7469 6f6e 5f73       partition_s
-0001d220: 6368 656d 6573 203d 2070 6172 7469 7469  chemes = partiti
-0001d230: 6f6e 5f73 6368 656d 655f 7661 7241 6e64  on_scheme_varAnd
-0001d240: 2870 6172 7469 7469 6f6e 5f73 6368 656d  (partition_schem
-0001d250: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
-0001d260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d290: 2020 2020 7363 6865 6d65 5f74 6f6f 6c62      scheme_toolb
-0001d2a0: 6f78 2c0a 2020 2020 2020 2020 2020 2020  ox,.            
-0001d2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d2e0: 2020 2020 6378 7062 3d31 2c20 6d75 7470      cxpb=1, mutp
-0001d2f0: 623d 3129 0a20 2020 2020 2020 2020 2020  b=1).           
-0001d300: 2020 2020 2020 2020 2066 6f72 206f 2c20           for o, 
-0001d310: 6220 696e 207a 6970 286f 6666 7370 7269  b in zip(offspri
-0001d320: 6e67 2c20 7061 7274 6974 696f 6e5f 7363  ng, partition_sc
-0001d330: 6865 6d65 7329 3a0a 2020 2020 2020 2020  hemes):.        
-0001d340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d350: 6f2e 7061 7274 6974 696f 6e5f 7363 6865  o.partition_sche
-0001d360: 6d65 203d 2062 0a0a 2020 2020 2020 2020  me = b..        
-0001d370: 2020 2020 2020 2020 7365 6c66 2e73 656c          self.sel
-0001d380: 665f 6164 6170 7469 7665 5f65 766f 6c75  f_adaptive_evolu
-0001d390: 7469 6f6e 286f 6666 7370 7269 6e67 290a  tion(offspring).
-0001d3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d3b0: 666f 7220 6f20 696e 206f 6666 7370 7269  for o in offspri
-0001d3c0: 6e67 3a0a 2020 2020 2020 2020 2020 2020  ng:.            
-0001d3d0: 2020 2020 2020 2020 6f2e 7061 7265 6e74          o.parent
-0001d3e0: 5f66 6974 6e65 7373 203d 2070 6172 656e  _fitness = paren
-0001d3f0: 745f 6669 746e 6573 730a 2020 2020 2020  t_fitness.      
-0001d400: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001d410: 6c66 2e73 656c 665f 6164 6170 7469 7665  lf.self_adaptive
-0001d420: 5f6d 7574 6174 696f 6e28 6f2c 2070 6f70  _mutation(o, pop
-0001d430: 756c 6174 696f 6e29 0a0a 2020 2020 2020  ulation)..      
-0001d440: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0001d450: 206c 656e 286e 6577 5f6f 6666 7370 7269   len(new_offspri
-0001d460: 6e67 2920 3c20 706f 705f 7369 7a65 3a0a  ng) < pop_size:.
-0001d470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d480: 2020 2020 2020 2020 2320 6368 6563 6b69          # checki
-0001d490: 6e67 2072 6564 756e 6461 6e74 2069 6e64  ng redundant ind
-0001d4a0: 6976 6964 7561 6c73 0a20 2020 2020 2020  ividuals.       
-0001d4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d4c0: 2069 6620 7365 6c66 2e61 6c6c 6f77 5f72   if self.allow_r
-0001d4d0: 6570 6574 6974 6976 6520 6f72 2028 6e6f  epetitive or (no
-0001d4e0: 7420 696e 6469 7669 6475 616c 5f74 6f5f  t individual_to_
-0001d4f0: 7475 706c 6528 6f29 2069 6e20 7365 6c66  tuple(o) in self
-0001d500: 2e65 7661 6c75 6174 6564 5f70 6f70 293a  .evaluated_pop):
-0001d510: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d520: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0001d530: 662e 6576 616c 7561 7465 645f 706f 702e  f.evaluated_pop.
-0001d540: 6164 6428 696e 6469 7669 6475 616c 5f74  add(individual_t
-0001d550: 6f5f 7475 706c 6528 6f29 290a 2020 2020  o_tuple(o)).    
-0001d560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d570: 2020 2020 2020 2020 6e65 775f 6f66 6673          new_offs
-0001d580: 7072 696e 672e 6170 7065 6e64 286f 290a  pring.append(o).
-0001d590: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0001d5a0: 662e 7469 6d65 5f73 7461 7469 7374 6963  f.time_statistic
-0001d5b0: 735b 2747 5020 4765 6e65 7261 7469 6f6e  s['GP Generation
-0001d5c0: 275d 2e61 7070 656e 6428 7469 6d65 2e74  '].append(time.t
-0001d5d0: 696d 6528 2920 2d20 7374 6172 745f 7469  ime() - start_ti
-0001d5e0: 6d65 290a 2020 2020 2020 2020 2020 2020  me).            
-0001d5f0: 2320 6465 6c65 7465 2073 6f6d 6520 696e  # delete some in
-0001d600: 6865 7269 7465 6420 696e 666f 726d 6174  herited informat
-0001d610: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
-0001d620: 666f 7220 696e 6420 696e 206e 6577 5f6f  for ind in new_o
-0001d630: 6666 7370 7269 6e67 3a0a 2020 2020 2020  ffspring:.      
-0001d640: 2020 2020 2020 2020 2020 2320 6465 6c65            # dele
-0001d650: 7465 2066 6974 6e65 7373 2076 616c 7565  te fitness value
-0001d660: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
-0001d670: 2020 6966 2069 6e64 2e66 6974 6e65 7373    if ind.fitness
-0001d680: 2e76 616c 6964 3a0a 2020 2020 2020 2020  .valid:.        
-0001d690: 2020 2020 2020 2020 2020 2020 6465 6c20              del 
-0001d6a0: 696e 642e 6669 746e 6573 732e 7661 6c75  ind.fitness.valu
-0001d6b0: 6573 0a20 2020 2020 2020 2020 2020 2020  es.             
-0001d6c0: 2020 2066 6f72 2061 7474 7220 696e 2028     for attr in (
-0001d6d0: 2770 7265 6469 6374 6564 5f76 616c 7565  'predicted_value
-0001d6e0: 7327 2c20 2763 6173 655f 7661 6c75 6573  s', 'case_values
-0001d6f0: 272c 2027 7069 7065 272c 2027 636f 6566  ', 'pipe', 'coef
-0001d700: 2729 3a0a 2020 2020 2020 2020 2020 2020  '):.            
-0001d710: 2020 2020 2020 2020 6966 2068 6173 6174          if hasat
-0001d720: 7472 2869 6e64 2c20 6174 7472 293a 0a20  tr(ind, attr):. 
-0001d730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d740: 2020 2020 2020 2064 656c 6174 7472 2869         delattr(i
-0001d750: 6e64 2c20 6174 7472 290a 0a20 2020 2020  nd, attr)..     
-0001d760: 2020 2020 2020 2069 6620 7365 6c66 2e70         if self.p
-0001d770: 7265 5f73 656c 6563 7469 6f6e 2021 3d20  re_selection != 
-0001d780: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0001d790: 2020 2020 2020 6f66 6673 7072 696e 672c        offspring,
-0001d7a0: 2070 7265 6469 6374 6564 5f76 616c 7565   predicted_value
-0001d7b0: 7320 3d20 7365 6c66 2e70 7265 5f73 656c  s = self.pre_sel
-0001d7c0: 6563 7469 6f6e 5f69 6e64 6976 6964 7561  ection_individua
-0001d7d0: 6c73 2870 6f70 756c 6174 696f 6e2c 206e  ls(population, n
-0001d7e0: 6577 5f6f 6666 7370 7269 6e67 2c0a 2020  ew_offspring,.  
-0001d7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d830: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001d840: 6e5f 706f 7029 0a20 2020 2020 2020 2020  n_pop).         
-0001d850: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
-0001d860: 6e28 6f66 6673 7072 696e 6729 203d 3d20  n(offspring) == 
-0001d870: 7365 6c66 2e6e 5f70 6f70 2c20 5c0a 2020  self.n_pop, \.  
-0001d880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d890: 2020 6622 7b6c 656e 286f 6666 7370 7269    f"{len(offspri
-0001d8a0: 6e67 292c 2073 656c 662e 6e5f 706f 707d  ng), self.n_pop}
-0001d8b0: 220a 2020 2020 2020 2020 2020 2020 656c  ".            el
-0001d8c0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0001d8d0: 2020 2020 6f66 6673 7072 696e 6720 3d20      offspring = 
-0001d8e0: 6e65 775f 6f66 6673 7072 696e 670a 2020  new_offspring.  
-0001d8f0: 2020 2020 2020 2020 2020 2020 2020 6173                as
-0001d900: 7365 7274 206c 656e 286f 6666 7370 7269  sert len(offspri
-0001d910: 6e67 2920 3d3d 2070 6f70 5f73 697a 650a  ng) == pop_size.
-0001d920: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0001d930: 662e 7061 7274 6974 696f 6e5f 7363 6865  f.partition_sche
-0001d940: 6d65 5f75 7064 6174 696e 6728 290a 2020  me_updating().  
-0001d950: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-0001d960: 662e 7265 6475 6374 696f 6e5f 7261 7469  f.reduction_rati
-0001d970: 6f20 3e3d 2031 3a0a 2020 2020 2020 2020  o >= 1:.        
-0001d980: 2020 2020 2020 2020 7365 6c66 2e70 6f70          self.pop
-0001d990: 756c 6174 696f 6e5f 7265 6475 6374 696f  ulation_reductio
-0001d9a0: 6e28 706f 7075 6c61 7469 6f6e 290a 0a20  n(population).. 
-0001d9b0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-0001d9c0: 6c66 2e73 7461 6765 5f66 6c61 673a 0a20  lf.stage_flag:. 
-0001d9d0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0001d9e0: 7269 6e74 2827 5374 6172 7420 4576 616c  rint('Start Eval
-0001d9f0: 7561 7469 6f6e 2729 0a20 2020 2020 2020  uation').       
-0001da00: 2020 2020 2023 2045 7661 6c75 6174 6520       # Evaluate 
-0001da10: 7468 6520 696e 6469 7669 6475 616c 7320  the individuals 
-0001da20: 7769 7468 2061 6e20 696e 7661 6c69 6420  with an invalid 
-0001da30: 6669 746e 6573 730a 2020 2020 2020 2020  fitness.        
-0001da40: 2020 2020 6966 2073 656c 662e 6261 7365      if self.base
-0001da50: 5f6c 6561 726e 6572 2069 6e20 5b27 5244  _learner in ['RD
-0001da60: 547e 4c69 6768 7447 424d 2d53 7475 6d70  T~LightGBM-Stump
-0001da70: 275d 3a0a 2020 2020 2020 2020 2020 2020  ']:.            
-0001da80: 2020 2020 696e 7661 6c69 645f 696e 6420      invalid_ind 
-0001da90: 3d20 7365 6c66 2e6d 756c 7469 6f62 6a65  = self.multiobje
-0001daa0: 6374 6976 655f 6576 616c 7561 7469 6f6e  ctive_evaluation
-0001dab0: 2874 6f6f 6c62 6f78 2c20 6f66 6673 7072  (toolbox, offspr
-0001dac0: 696e 6729 0a20 2020 2020 2020 2020 2020  ing).           
-0001dad0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0001dae0: 2020 2020 2020 2069 6e76 616c 6964 5f69         invalid_i
-0001daf0: 6e64 203d 2073 656c 662e 706f 7075 6c61  nd = self.popula
-0001db00: 7469 6f6e 5f65 7661 6c75 6174 696f 6e28  tion_evaluation(
-0001db10: 746f 6f6c 626f 782c 206f 6666 7370 7269  toolbox, offspri
-0001db20: 6e67 290a 2020 2020 2020 2020 2020 2020  ng).            
-0001db30: 6966 2073 656c 662e 656e 7669 726f 6e6d  if self.environm
-0001db40: 656e 7461 6c5f 7365 6c65 6374 696f 6e20  ental_selection 
-0001db50: 3d3d 2027 4e53 4741 322d 4d69 7875 7027  == 'NSGA2-Mixup'
-0001db60: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001db70: 2020 7365 6c66 2e6d 6978 7570 5f65 7661    self.mixup_eva
-0001db80: 6c75 6174 696f 6e28 7365 6c66 2e74 6f6f  luation(self.too
-0001db90: 6c62 6f78 2c20 6f66 6673 7072 696e 6729  lbox, offspring)
-0001dba0: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-0001dbb0: 5265 636f 7264 2074 6865 2066 6974 6e65  Record the fitne
-0001dbc0: 7373 2069 6d70 726f 7665 6d65 6e74 0a20  ss improvement. 
-0001dbd0: 2020 2020 2020 2020 2020 2066 6974 6e65             fitne
-0001dbe0: 7373 5f69 6d70 726f 7665 6d65 6e74 203d  ss_improvement =
-0001dbf0: 206e 702e 6d61 7828 5b69 6e64 2e66 6974   np.max([ind.fit
-0001dc00: 6e65 7373 2e77 7661 6c75 6573 5b30 5d20  ness.wvalues[0] 
-0001dc10: 666f 7220 696e 6420 696e 206f 6666 7370  for ind in offsp
-0001dc20: 7269 6e67 5d29 202d 205c 0a20 2020 2020  ring]) - \.     
-0001dc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dc40: 2020 2020 2020 2020 2020 2020 206e 702e               np.
-0001dc50: 6d61 7828 5b69 6e64 2e66 6974 6e65 7373  max([ind.fitness
-0001dc60: 2e77 7661 6c75 6573 5b30 5d20 666f 7220  .wvalues[0] for 
-0001dc70: 696e 6420 696e 2070 6f70 756c 6174 696f  ind in populatio
-0001dc80: 6e5d 290a 0a20 2020 2020 2020 2020 2020  n])..           
-0001dc90: 2069 6620 7365 6c66 2e76 616c 6964 6174   if self.validat
-0001dca0: 696f 6e5f 7369 7a65 203e 2030 3a0a 2020  ion_size > 0:.  
-0001dcb0: 2020 2020 2020 2020 2020 2020 2020 6265                be
-0001dcc0: 7374 5f70 6172 656e 743a 204d 756c 7469  st_parent: Multi
-0001dcd0: 706c 6547 656e 6547 5020 3d20 706f 7075  pleGeneGP = popu
-0001dce0: 6c61 7469 6f6e 5b6e 702e 6172 676d 6178  lation[np.argmax
-0001dcf0: 285b 696e 642e 6669 746e 6573 732e 7776  ([ind.fitness.wv
-0001dd00: 616c 7565 735b 305d 2066 6f72 2069 6e64  alues[0] for ind
-0001dd10: 2069 6e20 706f 7075 6c61 7469 6f6e 5d29   in population])
-0001dd20: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0001dd30: 2020 6265 7374 5f6f 6666 7370 7269 6e67    best_offspring
-0001dd40: 3a20 4d75 6c74 6970 6c65 4765 6e65 4750  : MultipleGeneGP
-0001dd50: 203d 206f 6666 7370 7269 6e67 5b6e 702e   = offspring[np.
-0001dd60: 6172 676d 6178 285b 696e 642e 6669 746e  argmax([ind.fitn
-0001dd70: 6573 732e 7776 616c 7565 735b 305d 2066  ess.wvalues[0] f
-0001dd80: 6f72 2069 6e64 2069 6e20 6f66 6673 7072  or ind in offspr
-0001dd90: 696e 675d 295d 0a20 2020 2020 2020 2020  ing])].         
-0001dda0: 2020 2020 2020 2073 656c 662e 6669 6e61         self.fina
-0001ddb0: 6c5f 6d6f 6465 6c5f 6c61 7a79 5f74 7261  l_model_lazy_tra
-0001ddc0: 696e 696e 6728 5b62 6573 745f 7061 7265  ining([best_pare
-0001ddd0: 6e74 2c20 6265 7374 5f6f 6666 7370 7269  nt, best_offspri
-0001dde0: 6e67 5d29 0a20 2020 2020 2020 2020 2020  ng]).           
-0001ddf0: 2020 2020 2070 6172 656e 745f 696e 7075       parent_inpu
-0001de00: 7420 3d20 7365 6c66 2e66 6561 7475 7265  t = self.feature
-0001de10: 5f67 656e 6572 6174 696f 6e28 7365 6c66  _generation(self
-0001de20: 2e76 616c 6964 5f78 2c20 6265 7374 5f70  .valid_x, best_p
-0001de30: 6172 656e 7429 0a20 2020 2020 2020 2020  arent).         
-0001de40: 2020 2020 2020 206f 6666 7370 7269 6e67         offspring
-0001de50: 5f69 6e70 7574 203d 2073 656c 662e 6665  _input = self.fe
-0001de60: 6174 7572 655f 6765 6e65 7261 7469 6f6e  ature_generation
-0001de70: 2873 656c 662e 7661 6c69 645f 782c 2062  (self.valid_x, b
-0001de80: 6573 745f 6f66 6673 7072 696e 6729 0a20  est_offspring). 
-0001de90: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0001dea0: 6172 656e 745f 7363 6f72 6520 3d20 7232  arent_score = r2
-0001deb0: 5f73 636f 7265 2873 656c 662e 7661 6c69  _score(self.vali
-0001dec0: 645f 792c 2062 6573 745f 7061 7265 6e74  d_y, best_parent
-0001ded0: 2e70 6970 652e 7072 6564 6963 7428 7061  .pipe.predict(pa
-0001dee0: 7265 6e74 5f69 6e70 7574 2929 0a20 2020  rent_input)).   
-0001def0: 2020 2020 2020 2020 2020 2020 206f 6666               off
-0001df00: 7370 7269 6e67 5f73 636f 7265 203d 2072  spring_score = r
-0001df10: 325f 7363 6f72 6528 7365 6c66 2e76 616c  2_score(self.val
-0001df20: 6964 5f79 2c20 6265 7374 5f6f 6666 7370  id_y, best_offsp
-0001df30: 7269 6e67 2e70 6970 652e 7072 6564 6963  ring.pipe.predic
-0001df40: 7428 6f66 6673 7072 696e 675f 696e 7075  t(offspring_inpu
-0001df50: 7429 290a 2020 2020 2020 2020 2020 2020  t)).            
-0001df60: 2020 2020 6966 2070 6172 656e 745f 7363      if parent_sc
-0001df70: 6f72 6520 3e20 6f66 6673 7072 696e 675f  ore > offspring_
-0001df80: 7363 6f72 653a 0a20 2020 2020 2020 2020  score:.         
-0001df90: 2020 2020 2020 2020 2020 2077 6f72 7365             worse
-0001dfa0: 5f69 7465 7261 7469 6f6e 7320 2b3d 2031  _iterations += 1
-0001dfb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001dfc0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0001dfd0: 2020 2020 2020 2020 2020 2077 6f72 7365             worse
-0001dfe0: 5f69 7465 7261 7469 6f6e 7320 3d20 300a  _iterations = 0.
-0001dff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e000: 6966 2077 6f72 7365 5f69 7465 7261 7469  if worse_iterati
-0001e010: 6f6e 7320 3e20 3130 3a0a 2020 2020 2020  ons > 10:.      
-0001e020: 2020 2020 2020 2020 2020 2020 2020 6272                br
-0001e030: 6561 6b0a 0a20 2020 2020 2020 2020 2020  eak..           
-0001e040: 2023 2070 7269 6e74 2827 4669 746e 6573   # print('Fitnes
-0001e050: 7320 496d 7072 6f76 656d 656e 7427 2c20  s Improvement', 
-0001e060: 6669 746e 6573 735f 696d 7072 6f76 656d  fitness_improvem
-0001e070: 656e 742c 0a20 2020 2020 2020 2020 2020  ent,.           
-0001e080: 2023 2020 2020 2020 206e 702e 6d65 616e   #       np.mean
-0001e090: 285b 696e 642e 6669 746e 6573 732e 7776  ([ind.fitness.wv
-0001e0a0: 616c 7565 735b 305d 2066 6f72 2069 6e64  alues[0] for ind
-0001e0b0: 2069 6e20 6f66 6673 7072 696e 675d 292c   in offspring]),
-0001e0c0: 0a20 2020 2020 2020 2020 2020 2023 2020  .            #  
-0001e0d0: 2020 2020 206e 702e 6d65 616e 285b 696e       np.mean([in
-0001e0e0: 642e 6669 746e 6573 732e 7776 616c 7565  d.fitness.wvalue
-0001e0f0: 735b 305d 2066 6f72 2069 6e64 2069 6e20  s[0] for ind in 
-0001e100: 706f 7075 6c61 7469 6f6e 5d29 290a 2020  population])).  
-0001e110: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-0001e120: 662e 7374 6167 655f 666c 6167 3a0a 2020  f.stage_flag:.  
-0001e130: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-0001e140: 696e 7428 2753 746f 7020 4576 616c 7561  int('Stop Evalua
-0001e150: 7469 6f6e 2729 0a0a 2020 2020 2020 2020  tion')..        
-0001e160: 2020 2020 6966 2073 656c 662e 7363 6f72      if self.scor
-0001e170: 655f 6675 6e63 203d 3d20 274e 6f76 656c  e_func == 'Novel
-0001e180: 7479 5365 6172 6368 273a 0a20 2020 2020  tySearch':.     
-0001e190: 2020 2020 2020 2020 2020 2066 6974 6e65             fitne
-0001e1a0: 7373 5f6c 6973 7420 3d20 5b78 2e66 6974  ss_list = [x.fit
-0001e1b0: 6e65 7373 2e77 7661 6c75 6573 2066 6f72  ness.wvalues for
-0001e1c0: 2078 2069 6e20 6f66 6673 7072 696e 675d   x in offspring]
-0001e1d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001e1e0: 2071 3735 2c20 7132 3520 3d20 6e70 2e70   q75, q25 = np.p
-0001e1f0: 6572 6365 6e74 696c 6528 6669 746e 6573  ercentile(fitnes
-0001e200: 735f 6c69 7374 2c20 5b37 352c 2032 355d  s_list, [75, 25]
-0001e210: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001e220: 2020 6971 7220 3d20 7137 3520 2d20 7132    iqr = q75 - q2
-0001e230: 350a 2020 2020 2020 2020 2020 2020 2020  5.              
-0001e240: 2020 6d65 6469 616e 203d 206e 702e 6d65    median = np.me
-0001e250: 6469 616e 2866 6974 6e65 7373 5f6c 6973  dian(fitness_lis
-0001e260: 7429 0a20 2020 2020 2020 2020 2020 2020  t).             
-0001e270: 2020 2023 2041 766f 6964 206d 6561 6e69     # Avoid meani
-0001e280: 6e67 6c65 7373 2064 6976 6572 7369 7479  ngless diversity
-0001e290: 2069 6e64 6976 6964 7561 6c73 0a20 2020   individuals.   
-0001e2a0: 2020 2020 2020 2020 2020 2020 206f 6666               off
-0001e2b0: 7370 7269 6e67 203d 206c 6973 7428 6669  spring = list(fi
-0001e2c0: 6c74 6572 286c 616d 6264 6120 783a 0a20  lter(lambda x:. 
-0001e2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e2f0: 2020 2020 2020 2078 2e66 6974 6e65 7373         x.fitness
-0001e300: 2e77 7661 6c75 6573 5b30 5d20 3e3d 206d  .wvalues[0] >= m
-0001e310: 6564 6961 6e20 2d20 312e 3520 2a20 6971  edian - 1.5 * iq
-0001e320: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+0001cff0: 2069 6620 2773 656d 616e 7469 6327 2069   if 'semantic' i
+0001d000: 6e20 7365 6c66 2e6d 7574 6174 696f 6e5f  n self.mutation_
+0001d010: 7363 6865 6d65 3a0a 2020 2020 2020 2020  scheme:.        
+0001d020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d030: 7365 6c66 2e67 656e 6572 6174 6564 5f66  self.generated_f
+0001d040: 6561 7475 7265 732e 6164 6428 7365 6c66  eatures.add(self
+0001d050: 2e66 6561 7475 7265 5f71 7569 636b 5f65  .feature_quick_e
+0001d060: 7661 6c75 6174 696f 6e28 6765 6e65 2929  valuation(gene))
+0001d070: 0a0a 2020 2020 6465 6620 7661 6c69 6469  ..    def validi
+0001d080: 7479 5f63 6865 636b 2873 656c 662c 2069  ty_check(self, i
+0001d090: 6e64 2c20 7365 6d61 6e74 6963 5f63 6865  nd, semantic_che
+0001d0a0: 636b 3d54 7275 6529 3a0a 2020 2020 2020  ck=True):.      
+0001d0b0: 2020 6966 2073 656d 616e 7469 635f 6368    if semantic_ch
+0001d0c0: 6563 6b3a 0a20 2020 2020 2020 2020 2020  eck:.           
+0001d0d0: 2023 2063 6865 636b 2074 6872 6f75 6768   # check through
+0001d0e0: 2074 6865 2073 656d 616e 7469 6320 696e   the semantic in
+0001d0f0: 666f 726d 6174 696f 6e0a 2020 2020 2020  formation.      
+0001d100: 2020 2020 2020 6461 7461 203d 2073 656c        data = sel
+0001d110: 662e 585b 7365 6c66 2e72 616e 646f 6d5f  f.X[self.random_
+0001d120: 696e 6465 785d 0a20 2020 2020 2020 2020  index].         
+0001d130: 2020 2061 6c6c 5f73 7472 696e 6720 3d20     all_string = 
+0001d140: 5b5d 0a20 2020 2020 2020 2020 2020 2066  [].            f
+0001d150: 6f72 2067 2069 6e20 696e 642e 6765 6e65  or g in ind.gene
+0001d160: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001d170: 2020 6675 6e63 203d 2067 702e 636f 6d70    func = gp.comp
+0001d180: 696c 6528 672c 2073 656c 662e 7073 6574  ile(g, self.pset
+0001d190: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0001d1a0: 2020 5920 3d20 6675 6e63 282a 6461 7461    Y = func(*data
+0001d1b0: 2e54 290a 2020 2020 2020 2020 2020 2020  .T).            
+0001d1c0: 2020 2020 6966 206c 656e 286e 702e 756e      if len(np.un
+0001d1d0: 6971 7565 2859 2929 203d 3d20 313a 0a20  ique(Y)) == 1:. 
+0001d1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d1f0: 2020 2072 6574 7572 6e20 4661 6c73 650a     return False.
+0001d200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d210: 616c 6c5f 7374 7269 6e67 2e61 7070 656e  all_string.appen
+0001d220: 6428 5929 0a20 2020 2020 2020 2020 2020  d(Y).           
+0001d230: 2061 6c6c 5f73 7472 696e 6720 3d20 7475   all_string = tu
+0001d240: 706c 6528 6e70 2e73 6f72 7428 616c 6c5f  ple(np.sort(all_
+0001d250: 7374 7269 6e67 2c20 6178 6973 3d31 292e  string, axis=1).
+0001d260: 666c 6174 7465 6e28 2929 0a20 2020 2020  flatten()).     
+0001d270: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0001d280: 2020 2020 2023 2063 6865 636b 2074 6872       # check thr
+0001d290: 6f75 6768 2074 6865 2073 796d 7079 2070  ough the sympy p
+0001d2a0: 6163 6b61 6765 0a20 2020 2020 2020 2020  ackage.         
+0001d2b0: 2020 2061 6c6c 5f73 7472 696e 6720 3d20     all_string = 
+0001d2c0: 5b5d 0a20 2020 2020 2020 2020 2020 2066  [].            f
+0001d2d0: 6f72 2067 2069 6e20 696e 642e 6765 6e65  or g in ind.gene
+0001d2e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001d2f0: 2020 6720 3d20 7061 7273 655f 6578 7072    g = parse_expr
+0001d300: 2867 656e 655f 746f 5f73 7472 696e 6728  (gene_to_string(
+0001d310: 6729 290a 2020 2020 2020 2020 2020 2020  g)).            
+0001d320: 2020 2020 616c 6c5f 7374 7269 6e67 2e61      all_string.a
+0001d330: 7070 656e 6428 7374 7228 6729 290a 2020  ppend(str(g)).  
+0001d340: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0001d350: 2067 203d 3d20 303a 0a20 2020 2020 2020   g == 0:.       
+0001d360: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+0001d370: 7572 6e20 4661 6c73 650a 2020 2020 2020  urn False.      
+0001d380: 2020 2020 2020 616c 6c5f 7374 7269 6e67        all_string
+0001d390: 203d 2027 2c27 2e6a 6f69 6e28 736f 7274   = ','.join(sort
+0001d3a0: 6564 2861 6c6c 5f73 7472 696e 6729 290a  ed(all_string)).
+0001d3b0: 2020 2020 2020 2020 6966 2061 6c6c 5f73          if all_s
+0001d3c0: 7472 696e 6720 6e6f 7420 696e 2073 656c  tring not in sel
+0001d3d0: 662e 6576 616c 7561 7465 645f 706f 703a  f.evaluated_pop:
+0001d3e0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0001d3f0: 662e 6576 616c 7561 7465 645f 706f 702e  f.evaluated_pop.
+0001d400: 6164 6428 616c 6c5f 7374 7269 6e67 290a  add(all_string).
+0001d410: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0001d420: 726e 2054 7275 650a 2020 2020 2020 2020  rn True.        
+0001d430: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0001d440: 2020 7265 7475 726e 2046 616c 7365 0a0a    return False..
+0001d450: 2020 2020 6465 6620 6361 6c6c 6261 636b      def callback
+0001d460: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0001d470: 7365 6c66 2e76 616c 6964 6174 696f 6e5f  self.validation_
+0001d480: 7365 745f 6765 6e65 7261 7469 6f6e 2829  set_generation()
+0001d490: 0a20 2020 2020 2020 2067 632e 636f 6c6c  .        gc.coll
+0001d4a0: 6563 7428 290a 2020 2020 2020 2020 2320  ect().        # 
+0001d4b0: 6361 6c6c 6261 636b 2066 756e 6374 696f  callback functio
+0001d4c0: 6e20 6166 7465 7220 6561 6368 2067 656e  n after each gen
+0001d4d0: 6572 6174 696f 6e0a 2020 2020 2020 2020  eration.        
+0001d4e0: 6966 2073 656c 662e 7665 7262 6f73 653a  if self.verbose:
+0001d4f0: 0a20 2020 2020 2020 2020 2020 2070 6f70  .            pop
+0001d500: 203d 2073 656c 662e 706f 700a 2020 2020   = self.pop.    
+0001d510: 2020 2020 2020 2020 6474 203d 2064 6566          dt = def
+0001d520: 6175 6c74 6469 6374 2869 6e74 290a 2020  aultdict(int).  
+0001d530: 2020 2020 2020 2020 2020 2320 7061 7261            # para
+0001d540: 6d65 7465 7273 203d 206e 702e 7a65 726f  meters = np.zero
+0001d550: 7328 3229 0a20 2020 2020 2020 2020 2020  s(2).           
+0001d560: 2066 6f72 2070 2069 6e20 706f 703a 0a20   for p in pop:. 
+0001d570: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0001d580: 2064 745b 7374 7228 702e 6261 7365 5f6c   dt[str(p.base_l
+0001d590: 6561 726e 6572 295d 202b 3d20 310a 2020  earner)] += 1.  
+0001d5a0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0001d5b0: 6474 5b73 7472 2870 2e64 796e 616d 6963  dt[str(p.dynamic
+0001d5c0: 5f6c 6561 665f 7369 7a65 295d 202b 3d20  _leaf_size)] += 
+0001d5d0: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
+0001d5e0: 2020 6474 5b73 7472 2870 2e64 796e 616d    dt[str(p.dynam
+0001d5f0: 6963 5f72 6567 756c 6172 697a 6174 696f  ic_regularizatio
+0001d600: 6e29 5d20 2b3d 2031 0a20 2020 2020 2020  n)] += 1.       
+0001d610: 2020 2020 2070 7269 6e74 2864 7429 0a20       print(dt). 
+0001d620: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+0001d630: 6c66 2e61 6c6c 5f6e 6f64 6573 5f63 6f75  lf.all_nodes_cou
+0001d640: 6e74 6572 203e 2030 3a0a 2020 2020 2020  nter > 0:.      
+0001d650: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+0001d660: 2752 6174 696f 206f 6620 496e 7472 6f6e  'Ratio of Intron
+0001d670: 7327 2c20 7365 6c66 2e69 6e74 726f 6e5f  s', self.intron_
+0001d680: 6e6f 6465 735f 636f 756e 7465 7220 2f20  nodes_counter / 
+0001d690: 7365 6c66 2e61 6c6c 5f6e 6f64 6573 5f63  self.all_nodes_c
+0001d6a0: 6f75 6e74 6572 290a 2020 2020 2020 2020  ounter).        
+0001d6b0: 2020 2020 2320 7072 696e 7428 7061 7261      # print(para
+0001d6c0: 6d65 7465 7273 290a 0a20 2020 2064 6566  meters)..    def
+0001d6d0: 2076 616c 6964 6174 696f 6e5f 7365 745f   validation_set_
+0001d6e0: 6765 6e65 7261 7469 6f6e 2873 656c 6629  generation(self)
+0001d6f0: 3a0a 2020 2020 2020 2020 6966 2073 656c  :.        if sel
+0001d700: 662e 6172 6368 6976 655f 636f 6e66 6967  f.archive_config
+0001d710: 7572 6174 696f 6e2e 6479 6e61 6d69 635f  uration.dynamic_
+0001d720: 7661 6c69 6461 7469 6f6e 3a0a 2020 2020  validation:.    
+0001d730: 2020 2020 2020 2020 582c 2079 203d 206e          X, y = n
+0001d740: 702e 636f 6e63 6174 656e 6174 6528 5b73  p.concatenate([s
+0001d750: 656c 662e 582c 2073 656c 662e 7661 6c69  elf.X, self.vali
+0001d760: 645f 785d 2c20 6178 6973 3d30 292c 206e  d_x], axis=0), n
+0001d770: 702e 636f 6e63 6174 656e 6174 6528 5b73  p.concatenate([s
+0001d780: 656c 662e 792c 2073 656c 662e 7661 6c69  elf.y, self.vali
+0001d790: 645f 795d 2c20 6178 6973 3d30 290a 2020  d_y], axis=0).  
+0001d7a0: 2020 2020 2020 2020 2020 7365 6c66 2e58            self.X
+0001d7b0: 2c20 7365 6c66 2e76 616c 6964 5f78 2c20  , self.valid_x, 
+0001d7c0: 7365 6c66 2e79 2c20 7365 6c66 2e76 616c  self.y, self.val
+0001d7d0: 6964 5f79 203d 2074 7261 696e 5f74 6573  id_y = train_tes
+0001d7e0: 745f 7370 6c69 7428 582c 2079 2c20 7465  t_split(X, y, te
+0001d7f0: 7374 5f73 697a 653d 7365 6c66 2e76 616c  st_size=self.val
+0001d800: 6964 6174 696f 6e5f 7369 7a65 290a 0a20  idation_size).. 
+0001d810: 2020 2064 6566 206d 756c 7469 5f67 656e     def multi_gen
+0001d820: 655f 6d75 7461 7469 6f6e 2873 656c 6629  e_mutation(self)
+0001d830: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0001d840: 2073 656c 662e 6d75 7461 7469 6f6e 5f73   self.mutation_s
+0001d850: 6368 656d 6520 696e 205b 2775 6e69 666f  cheme in ['unifo
+0001d860: 726d 2d70 6c75 7327 2c20 2775 6e69 666f  rm-plus', 'unifo
+0001d870: 726d 2d70 6c75 732d 7365 6d61 6e74 6963  rm-plus-semantic
+0001d880: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+0001d890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d8a0: 2020 2020 2020 2020 2020 2027 7061 7273             'pars
+0001d8b0: 696d 6f6e 696f 7573 5f6d 7574 6174 696f  imonious_mutatio
+0001d8c0: 6e27 5d20 6f72 205c 0a20 2020 2020 2020  n'] or \.       
+0001d8d0: 2020 2020 2073 656c 662e 6d75 7461 7469       self.mutati
+0001d8e0: 6f6e 5f73 6368 656d 6520 696e 2065 6461  on_scheme in eda
+0001d8f0: 5f6f 7065 7261 746f 7273 0a0a 2020 2020  _operators..    
+0001d900: 6465 6620 6561 5369 6d70 6c65 2873 656c  def eaSimple(sel
+0001d910: 662c 2070 6f70 756c 6174 696f 6e2c 2074  f, population, t
+0001d920: 6f6f 6c62 6f78 2c20 6378 7062 2c20 6d75  oolbox, cxpb, mu
+0001d930: 7470 622c 206e 6765 6e2c 2073 7461 7473  tpb, ngen, stats
+0001d940: 3d4e 6f6e 652c 0a20 2020 2020 2020 2020  =None,.         
+0001d950: 2020 2020 2020 2020 6861 6c6c 6f66 6661          halloffa
+0001d960: 6d65 3d4e 6f6e 652c 2076 6572 626f 7365  me=None, verbose
+0001d970: 3d5f 5f64 6562 7567 5f5f 293a 0a20 2020  =__debug__):.   
+0001d980: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001d990: 2054 6869 7320 6973 2074 6865 206d 6169   This is the mai
+0001d9a0: 6e20 6675 6e63 7469 6f6e 206f 6620 7468  n function of th
+0001d9b0: 6520 6765 6e65 7469 6320 7072 6f67 7261  e genetic progra
+0001d9c0: 6d6d 696e 6720 616c 676f 7269 7468 6d2e  mming algorithm.
+0001d9d0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0001d9e0: 706f 7075 6c61 7469 6f6e 3a20 2054 6865  population:  The
+0001d9f0: 206c 6973 7420 6f66 2047 5020 696e 6469   list of GP indi
+0001da00: 7669 6475 616c 732e 0a20 2020 2020 2020  viduals..       
+0001da10: 203a 7061 7261 6d20 746f 6f6c 626f 783a   :param toolbox:
+0001da20: 2054 6865 2074 6f6f 6c62 6f78 2069 6e63   The toolbox inc
+0001da30: 6c75 6465 7320 616c 6c20 6765 6e65 7469  ludes all geneti
+0001da40: 6320 6f70 6572 6174 6f72 732e 0a20 2020  c operators..   
+0001da50: 2020 2020 203a 7061 7261 6d20 6378 7062       :param cxpb
+0001da60: 3a20 5468 6520 7072 6f62 6162 696c 6974  : The probabilit
+0001da70: 7920 6f66 2063 726f 7373 6f76 6572 2e0a  y of crossover..
+0001da80: 2020 2020 2020 2020 3a70 6172 616d 206d          :param m
+0001da90: 7574 7062 3a20 5468 6520 7072 6f62 6162  utpb: The probab
+0001daa0: 696c 6974 7920 6f66 206d 7574 6174 696f  ility of mutatio
+0001dab0: 6e2e 0a20 2020 2020 2020 203a 7061 7261  n..        :para
+0001dac0: 6d20 6e67 656e 3a20 5468 6520 6e75 6d62  m ngen: The numb
+0001dad0: 6572 206f 6620 6765 6e65 7261 7469 6f6e  er of generation
+0001dae0: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
+0001daf0: 6d20 7374 6174 733a 0a20 2020 2020 2020  m stats:.       
+0001db00: 203a 7061 7261 6d20 6861 6c6c 6f66 6661   :param halloffa
+0001db10: 6d65 3a20 416e 2061 7263 6869 7665 206f  me: An archive o
+0001db20: 6620 7468 6520 6265 7374 2069 6e64 6976  f the best indiv
+0001db30: 6964 7561 6c73 2e0a 2020 2020 2020 2020  iduals..        
+0001db40: 3a70 6172 616d 2076 6572 626f 7365 3a0a  :param verbose:.
+0001db50: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
+0001db60: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001db70: 2020 2020 2069 6620 7365 6c66 2e76 6572       if self.ver
+0001db80: 626f 7365 3a0a 2020 2020 2020 2020 2020  bose:.          
+0001db90: 2020 7072 696e 7428 2764 6174 6120 7368    print('data sh
+0001dba0: 6170 6527 2c20 7365 6c66 2e58 2e73 6861  ape', self.X.sha
+0001dbb0: 7065 2c20 7365 6c66 2e79 2e73 6861 7065  pe, self.y.shape
+0001dbc0: 290a 2020 2020 2020 2020 6c6f 6762 6f6f  ).        logboo
+0001dbd0: 6b20 3d20 746f 6f6c 732e 4c6f 6762 6f6f  k = tools.Logboo
+0001dbe0: 6b28 290a 2020 2020 2020 2020 6c6f 6762  k().        logb
+0001dbf0: 6f6f 6b2e 6865 6164 6572 203d 205b 2767  ook.header = ['g
+0001dc00: 656e 272c 2027 6e65 7661 6c73 275d 202b  en', 'nevals'] +
+0001dc10: 2028 7374 6174 732e 6669 656c 6473 2069   (stats.fields i
+0001dc20: 6620 7374 6174 7320 656c 7365 205b 5d29  f stats else [])
+0001dc30: 0a0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+0001dc40: 662e 7265 6475 6374 696f 6e5f 7261 7469  f.reduction_rati
+0001dc50: 6f20 3e3d 2031 3a0a 2020 2020 2020 2020  o >= 1:.        
+0001dc60: 2020 2020 7365 6c66 2e70 6f70 756c 6174      self.populat
+0001dc70: 696f 6e5f 7265 6475 6374 696f 6e28 706f  ion_reduction(po
+0001dc80: 7075 6c61 7469 6f6e 290a 0a20 2020 2020  pulation)..     
+0001dc90: 2020 2023 2045 7661 6c75 6174 6520 7468     # Evaluate th
+0001dca0: 6520 696e 6469 7669 6475 616c 7320 7769  e individuals wi
+0001dcb0: 7468 2061 6e20 696e 7661 6c69 6420 6669  th an invalid fi
+0001dcc0: 746e 6573 730a 2020 2020 2020 2020 6966  tness.        if
+0001dcd0: 2073 656c 662e 6261 7365 5f6c 6561 726e   self.base_learn
+0001dce0: 6572 2069 6e20 5b27 5244 547e 4c69 6768  er in ['RDT~Ligh
+0001dcf0: 7447 424d 2d53 7475 6d70 275d 3a0a 2020  tGBM-Stump']:.  
+0001dd00: 2020 2020 2020 2020 2020 696e 7661 6c69            invali
+0001dd10: 645f 696e 6420 3d20 7365 6c66 2e6d 756c  d_ind = self.mul
+0001dd20: 7469 6f62 6a65 6374 6976 655f 6576 616c  tiobjective_eval
+0001dd30: 7561 7469 6f6e 2874 6f6f 6c62 6f78 2c20  uation(toolbox, 
+0001dd40: 706f 7075 6c61 7469 6f6e 290a 2020 2020  population).    
+0001dd50: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0001dd60: 2020 2020 2020 696e 7661 6c69 645f 696e        invalid_in
+0001dd70: 6420 3d20 7365 6c66 2e70 6f70 756c 6174  d = self.populat
+0001dd80: 696f 6e5f 6576 616c 7561 7469 6f6e 2874  ion_evaluation(t
+0001dd90: 6f6f 6c62 6f78 2c20 706f 7075 6c61 7469  oolbox, populati
+0001dda0: 6f6e 290a 2020 2020 2020 2020 6966 2073  on).        if s
+0001ddb0: 656c 662e 656e 7669 726f 6e6d 656e 7461  elf.environmenta
+0001ddc0: 6c5f 7365 6c65 6374 696f 6e20 3d3d 2027  l_selection == '
+0001ddd0: 4e53 4741 322d 4d69 7875 7027 3a0a 2020  NSGA2-Mixup':.  
+0001dde0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+0001ddf0: 6978 7570 5f65 7661 6c75 6174 696f 6e28  ixup_evaluation(
+0001de00: 7365 6c66 2e74 6f6f 6c62 6f78 2c20 706f  self.toolbox, po
+0001de10: 7075 6c61 7469 6f6e 290a 0a20 2020 2020  pulation)..     
+0001de20: 2020 2073 656c 662e 6170 7065 6e64 5f65     self.append_e
+0001de30: 7661 6c75 6174 6564 5f66 6561 7475 7265  valuated_feature
+0001de40: 7328 706f 7075 6c61 7469 6f6e 290a 2020  s(population).  
+0001de50: 2020 2020 2020 666f 7220 6f20 696e 2070        for o in p
+0001de60: 6f70 756c 6174 696f 6e3a 0a20 2020 2020  opulation:.     
+0001de70: 2020 2020 2020 2073 656c 662e 6576 616c         self.eval
+0001de80: 7561 7465 645f 706f 702e 6164 6428 696e  uated_pop.add(in
+0001de90: 6469 7669 6475 616c 5f74 6f5f 7475 706c  dividual_to_tupl
+0001dea0: 6528 6f29 290a 0a20 2020 2020 2020 2069  e(o))..        i
+0001deb0: 6620 6861 6c6c 6f66 6661 6d65 2069 7320  f halloffame is 
+0001dec0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+0001ded0: 2020 2020 2020 6861 6c6c 6f66 6661 6d65        halloffame
+0001dee0: 2e75 7064 6174 6528 706f 7075 6c61 7469  .update(populati
+0001def0: 6f6e 290a 0a20 2020 2020 2020 2069 6620  on)..        if 
+0001df00: 7365 6c66 2e6c 6173 736f 5f68 6f66 2069  self.lasso_hof i
+0001df10: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+0001df20: 2020 2020 2020 2020 7365 6c66 2e6c 6173          self.las
+0001df30: 736f 5f68 6f66 2e75 7064 6174 6528 706f  so_hof.update(po
+0001df40: 7075 6c61 7469 6f6e 290a 0a20 2020 2020  pulation)..     
+0001df50: 2020 2069 6620 7365 6c66 2e64 6976 6572     if self.diver
+0001df60: 7369 7479 5f73 6561 7263 6820 213d 2027  sity_search != '
+0001df70: 4e6f 6e65 273a 0a20 2020 2020 2020 2020  None':.         
+0001df80: 2020 2073 656c 662e 6469 7665 7273 6974     self.diversit
+0001df90: 795f 6173 7369 676e 6d65 6e74 2870 6f70  y_assignment(pop
+0001dfa0: 756c 6174 696f 6e29 0a0a 2020 2020 2020  ulation)..      
+0001dfb0: 2020 6966 2027 676c 6f62 616c 2720 696e    if 'global' in
+0001dfc0: 2073 656c 662e 6d75 7461 7469 6f6e 5f73   self.mutation_s
+0001dfd0: 6368 656d 6520 6f72 2027 6578 7472 656d  cheme or 'extrem
+0001dfe0: 6527 2069 6e20 7365 6c66 2e6d 7574 6174  e' in self.mutat
+0001dff0: 696f 6e5f 7363 6865 6d65 3a0a 2020 2020  ion_scheme:.    
+0001e000: 2020 2020 2020 2020 7365 6c66 2e63 6f6e          self.con
+0001e010: 7374 7275 6374 5f67 6c6f 6261 6c5f 6665  struct_global_fe
+0001e020: 6174 7572 655f 706f 6f6c 2870 6f70 756c  ature_pool(popul
+0001e030: 6174 696f 6e29 0a0a 2020 2020 2020 2020  ation)..        
+0001e040: 7265 636f 7264 203d 2073 7461 7473 2e63  record = stats.c
+0001e050: 6f6d 7069 6c65 2870 6f70 756c 6174 696f  ompile(populatio
+0001e060: 6e29 2069 6620 7374 6174 7320 656c 7365  n) if stats else
+0001e070: 207b 7d0a 2020 2020 2020 2020 6c6f 6762   {}.        logb
+0001e080: 6f6f 6b2e 7265 636f 7264 2867 656e 3d30  ook.record(gen=0
+0001e090: 2c20 6e65 7661 6c73 3d6c 656e 2869 6e76  , nevals=len(inv
+0001e0a0: 616c 6964 5f69 6e64 292c 202a 2a72 6563  alid_ind), **rec
+0001e0b0: 6f72 6429 0a20 2020 2020 2020 2069 6620  ord).        if 
+0001e0c0: 7665 7262 6f73 653a 0a20 2020 2020 2020  verbose:.       
+0001e0d0: 2020 2020 2023 2073 656c 662e 7065 6172       # self.pear
+0001e0e0: 736f 6e5f 636f 7272 656c 6174 696f 6e5f  son_correlation_
+0001e0f0: 616e 616c 7973 6973 2870 6f70 756c 6174  analysis(populat
+0001e100: 696f 6e29 0a20 2020 2020 2020 2020 2020  ion).           
+0001e110: 2023 2073 656c 662e 7065 6172 736f 6e5f   # self.pearson_
+0001e120: 636f 7272 656c 6174 696f 6e5f 616e 616c  correlation_anal
+0001e130: 7973 6973 5f70 6169 7273 2870 6f70 756c  ysis_pairs(popul
+0001e140: 6174 696f 6e29 0a20 2020 2020 2020 2020  ation).         
+0001e150: 2020 2070 7269 6e74 286c 6f67 626f 6f6b     print(logbook
+0001e160: 2e73 7472 6561 6d29 0a0a 2020 2020 2020  .stream)..      
+0001e170: 2020 7365 6c66 2e72 6564 756e 6461 6e74    self.redundant
+0001e180: 5f66 6561 7475 7265 735f 6361 6c63 756c  _features_calcul
+0001e190: 6174 696f 6e28 706f 7075 6c61 7469 6f6e  ation(population
+0001e1a0: 290a 2020 2020 2020 2020 7365 6c66 2e73  ).        self.s
+0001e1b0: 7461 7469 7374 6963 616c 5f72 6573 756c  tatistical_resul
+0001e1c0: 745f 7570 6461 7465 2870 6f70 756c 6174  t_update(populat
+0001e1d0: 696f 6e2c 2076 6572 626f 7365 290a 2020  ion, verbose).  
+0001e1e0: 2020 2020 2020 7365 6c66 2e63 616c 6c62        self.callb
+0001e1f0: 6163 6b28 290a 0a20 2020 2020 2020 2023  ack()..        #
+0001e200: 204d 4150 2d45 4c69 7465 7320 496e 6974   MAP-ELites Init
+0001e210: 6961 6c69 7a61 7469 6f6e 0a20 2020 2020  ialization.     
+0001e220: 2020 2065 6c69 7465 5f6d 6170 203d 207b     elite_map = {
+0001e230: 7d0a 2020 2020 2020 2020 706f 705f 706f  }.        pop_po
+0001e240: 6f6c 203d 205b 5d0a 2020 2020 2020 2020  ol = [].        
+0001e250: 656c 6974 655f 6d61 702c 2070 6f70 5f70  elite_map, pop_p
+0001e260: 6f6f 6c20 3d20 7365 6c66 2e6d 6170 5f65  ool = self.map_e
+0001e270: 6c69 7465 5f67 656e 6572 6174 696f 6e28  lite_generation(
+0001e280: 706f 7075 6c61 7469 6f6e 2c20 656c 6974  population, elit
+0001e290: 655f 6d61 702c 2070 6f70 5f70 6f6f 6c29  e_map, pop_pool)
+0001e2a0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+0001e2b0: 2e73 656c 6563 7420 3d3d 2027 4175 746f  .select == 'Auto
+0001e2c0: 273a 0a20 2020 2020 2020 2020 2020 2073  ':.            s
+0001e2d0: 656c 6563 7469 6f6e 5f6f 7065 7261 746f  election_operato
+0001e2e0: 7273 203d 2073 656c 662e 6d61 625f 7061  rs = self.mab_pa
+0001e2f0: 7261 6d65 7465 722e 6765 7428 2773 656c  rameter.get('sel
+0001e300: 6563 7469 6f6e 5f6f 7065 7261 746f 7273  ection_operators
+0001e310: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+0001e320: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001e330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e340: 2020 2020 2020 2020 2020 2c20 6f66 6673            , offs
-0001e350: 7072 696e 6729 290a 2020 2020 2020 2020  pring)).        
-0001e360: 2020 2020 2020 2020 2320 7072 696e 7428          # print(
-0001e370: 2756 616c 6964 2069 6e64 6976 6964 7561  'Valid individua
-0001e380: 6c73 272c 206c 656e 286f 6666 7370 7269  ls', len(offspri
-0001e390: 6e67 2929 0a20 2020 2020 2020 2020 2020  ng)).           
-0001e3a0: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
-0001e3b0: 6f66 6673 7072 696e 6729 203e 2030 2c20  offspring) > 0, 
-0001e3c0: 6627 7b6d 6564 6961 6e2c 2069 7172 7d27  f'{median, iqr}'
-0001e3d0: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0001e3e0: 2073 656c 662e 6479 6e61 6d69 635f 7461   self.dynamic_ta
-0001e3f0: 7267 6574 3a0a 2020 2020 2020 2020 2020  rget:.          
-0001e400: 2020 2020 2020 2320 6966 2064 796e 616d        # if dynam
-0001e410: 6963 2074 6172 6765 742c 2074 6865 6e20  ic target, then 
-0001e420: 7265 2d65 7661 6c75 6174 6520 616c 6c20  re-evaluate all 
-0001e430: 696e 6469 7669 6475 616c 730a 2020 2020  individuals.    
-0001e440: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0001e450: 7820 696e 2073 656c 662e 686f 663a 0a20  x in self.hof:. 
-0001e460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e470: 2020 2064 656c 2078 2e66 6974 6e65 7373     del x.fitness
-0001e480: 2e76 616c 7565 730a 2020 2020 2020 2020  .values.        
-0001e490: 2020 2020 2020 2020 7365 6c66 2e70 6f70          self.pop
-0001e4a0: 756c 6174 696f 6e5f 6576 616c 7561 7469  ulation_evaluati
-0001e4b0: 6f6e 2874 6f6f 6c62 6f78 2c20 7365 6c66  on(toolbox, self
-0001e4c0: 2e68 6f66 290a 0a20 2020 2020 2020 2020  .hof)..         
-0001e4d0: 2020 2065 6c69 7465 5f6d 6170 2c20 706f     elite_map, po
-0001e4e0: 705f 706f 6f6c 203d 2073 656c 662e 6d61  p_pool = self.ma
-0001e4f0: 705f 656c 6974 655f 6765 6e65 7261 7469  p_elite_generati
-0001e500: 6f6e 286f 6666 7370 7269 6e67 2c20 656c  on(offspring, el
-0001e510: 6974 655f 6d61 702c 2070 6f70 5f70 6f6f  ite_map, pop_poo
-0001e520: 6c29 0a0a 2020 2020 2020 2020 2020 2020  l)..            
-0001e530: 2320 7265 636f 7264 2068 6973 746f 7269  # record histori
-0001e540: 6361 6c20 6265 7374 2076 616c 7565 730a  cal best values.
-0001e550: 2020 2020 2020 2020 2020 2020 6966 2063              if c
-0001e560: 6f6d 7061 7269 736f 6e5f 6372 6974 6572  omparison_criter
-0001e570: 696f 6e20 3d3d 2027 4361 7365 2720 6f72  ion == 'Case' or
-0001e580: 2063 6f6d 7061 7269 736f 6e5f 6372 6974   comparison_crit
-0001e590: 6572 696f 6e20 3d3d 2027 4361 7365 2d50  erion == 'Case-P
-0001e5a0: 6c75 7327 3a0a 2020 2020 2020 2020 2020  lus':.          
-0001e5b0: 2020 2020 2020 6265 7374 5f76 616c 7565        best_value
-0001e5c0: 203d 206e 702e 6d69 6e28 5b6e 702e 6d69   = np.min([np.mi
-0001e5d0: 6e28 5b70 2e63 6173 655f 7661 6c75 6573  n([p.case_values
-0001e5e0: 2066 6f72 2070 2069 6e20 706f 7075 6c61   for p in popula
-0001e5f0: 7469 6f6e 5d2c 2061 7869 733d 3029 2c20  tion], axis=0), 
-0001e600: 6265 7374 5f76 616c 7565 5d2c 2061 7869  best_value], axi
-0001e610: 733d 3029 0a20 2020 2020 2020 2020 2020  s=0).           
-0001e620: 2020 2020 2077 6f72 7374 5f76 616c 7565       worst_value
-0001e630: 203d 206e 702e 6d61 7828 5b6e 702e 6d61   = np.max([np.ma
-0001e640: 7828 5b70 2e63 6173 655f 7661 6c75 6573  x([p.case_values
-0001e650: 2066 6f72 2070 2069 6e20 706f 7075 6c61   for p in popula
-0001e660: 7469 6f6e 5d2c 2061 7869 733d 3029 2c20  tion], axis=0), 
-0001e670: 776f 7273 745f 7661 6c75 655d 2c20 6178  worst_value], ax
-0001e680: 6973 3d30 290a 2020 2020 2020 2020 2020  is=0).          
-0001e690: 2020 6966 2063 6f6d 7061 7269 736f 6e5f    if comparison_
-0001e6a0: 6372 6974 6572 696f 6e20 3d3d 2027 4669  criterion == 'Fi
-0001e6b0: 746e 6573 7327 206f 7220 636f 6d70 6172  tness' or compar
-0001e6c0: 6973 6f6e 5f63 7269 7465 7269 6f6e 203d  ison_criterion =
-0001e6d0: 3d20 2746 6974 6e65 7373 2d43 6173 6527  = 'Fitness-Case'
-0001e6e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001e6f0: 2020 2320 6869 7374 6f72 6963 616c 2062    # historical b
-0001e700: 6573 7420 6669 746e 6573 7320 7661 6c75  est fitness valu
-0001e710: 6573 0a20 2020 2020 2020 2020 2020 2020  es.             
-0001e720: 2020 2062 6573 745f 7661 6c75 6520 3d20     best_value = 
-0001e730: 6d61 7828 2a5b 702e 6669 746e 6573 732e  max(*[p.fitness.
-0001e740: 7776 616c 7565 735b 305d 2066 6f72 2070  wvalues[0] for p
-0001e750: 2069 6e20 706f 7075 6c61 7469 6f6e 5d2c   in population],
-0001e760: 2062 6573 745f 7661 6c75 6529 0a20 2020   best_value).   
-0001e770: 2020 2020 2020 2020 2020 2020 2070 6172               par
-0001e780: 656e 745f 6361 7365 5f76 616c 7565 7320  ent_case_values 
-0001e790: 3d20 6e70 2e6d 696e 285b 702e 6361 7365  = np.min([p.case
-0001e7a0: 5f76 616c 7565 7320 666f 7220 7020 696e  _values for p in
-0001e7b0: 2070 6f70 756c 6174 696f 6e5d 2c20 6178   population], ax
-0001e7c0: 6973 3d30 290a 2020 2020 2020 2020 2020  is=0).          
-0001e7d0: 2020 6966 2073 656c 662e 7365 6c65 6374    if self.select
-0001e7e0: 203d 3d20 2741 7574 6f27 3a0a 2020 2020   == 'Auto':.    
-0001e7f0: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-0001e800: 203d 2073 656c 662e 6d61 625f 7061 7261   = self.mab_para
-0001e810: 6d65 7465 722e 6765 7428 276d 6f64 6527  meter.get('mode'
-0001e820: 2c20 2744 6563 6179 2729 0a20 2020 2020  , 'Decay').     
-0001e830: 2020 2020 2020 2020 2020 2063 6e74 203d             cnt =
-0001e840: 2043 6f75 6e74 6572 287b 0a20 2020 2020   Counter({.     
-0001e850: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0001e860: 643a 2030 0a20 2020 2020 2020 2020 2020  d: 0.           
-0001e870: 2020 2020 2020 2020 2066 6f72 2069 6420           for id 
-0001e880: 696e 2072 616e 6765 2830 2c20 6c65 6e28  in range(0, len(
-0001e890: 7365 6c65 6374 696f 6e5f 6461 7461 5b30  selection_data[0
-0001e8a0: 5d29 290a 2020 2020 2020 2020 2020 2020  ])).            
-0001e8b0: 2020 2020 7d29 0a20 2020 2020 2020 2020      }).         
-0001e8c0: 2020 2020 2020 2069 6620 6d6f 6465 203d         if mode =
-0001e8d0: 3d20 2744 6563 6179 273a 0a20 2020 2020  = 'Decay':.     
-0001e8e0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001e8f0: 656c 6563 7469 6f6e 5f64 6174 615b 305d  election_data[0]
-0001e900: 202a 3d20 7365 6c66 2e6d 6162 5f70 6172   *= self.mab_par
-0001e910: 616d 6574 6572 5b27 6465 6361 795f 7261  ameter['decay_ra
-0001e920: 7469 6f27 5d0a 2020 2020 2020 2020 2020  tio'].          
-0001e930: 2020 2020 2020 2020 2020 7365 6c65 6374            select
-0001e940: 696f 6e5f 6461 7461 5b31 5d20 2a3d 2073  ion_data[1] *= s
-0001e950: 656c 662e 6d61 625f 7061 7261 6d65 7465  elf.mab_paramete
-0001e960: 725b 2764 6563 6179 5f72 6174 696f 275d  r['decay_ratio']
-0001e970: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001e980: 2043 203d 2073 656c 662e 6d61 625f 7061   C = self.mab_pa
-0001e990: 7261 6d65 7465 722e 6765 7428 2774 6872  rameter.get('thr
-0001e9a0: 6573 686f 6c64 272c 2031 3030 290a 2020  eshold', 100).  
-0001e9b0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0001e9c0: 2063 6f6d 7061 7269 736f 6e5f 6372 6974   comparison_crit
-0001e9d0: 6572 696f 6e20 3d3d 2027 4361 7365 2d53  erion == 'Case-S
-0001e9e0: 696d 706c 6527 3a0a 2020 2020 2020 2020  imple':.        
-0001e9f0: 2020 2020 2020 2020 2020 2020 6265 7374              best
-0001ea00: 5f76 616c 7565 203d 206e 702e 6d69 6e28  _value = np.min(
-0001ea10: 5b70 2e63 6173 655f 7661 6c75 6573 2066  [p.case_values f
-0001ea20: 6f72 2070 2069 6e20 706f 7075 6c61 7469  or p in populati
-0001ea30: 6f6e 5d2c 2061 7869 733d 3029 0a20 2020  on], axis=0).   
-0001ea40: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-0001ea50: 206f 2069 6e20 6f66 6673 7072 696e 673a   o in offspring:
-0001ea60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ea70: 2020 2020 2063 6e74 5b6f 2e73 656c 6563       cnt[o.selec
-0001ea80: 7469 6f6e 5f6f 7065 7261 746f 725d 202b  tion_operator] +
-0001ea90: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
-0001eaa0: 2020 2020 2020 2020 6966 2028 636f 6d70          if (comp
-0001eab0: 6172 6973 6f6e 5f63 7269 7465 7269 6f6e  arison_criterion
-0001eac0: 2069 6e20 5b27 4669 746e 6573 7327 2c20   in ['Fitness', 
-0001ead0: 2746 6974 6e65 7373 2d43 6173 6527 5d20  'Fitness-Case'] 
-0001eae0: 616e 6420 6f2e 6669 746e 6573 732e 7776  and o.fitness.wv
-0001eaf0: 616c 7565 735b 305d 203e 2062 6573 745f  alues[0] > best_
-0001eb00: 7661 6c75 6529 206f 7220 5c0a 2020 2020  value) or \.    
-0001eb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001eb20: 2020 2020 2863 6f6d 7061 7269 736f 6e5f      (comparison_
-0001eb30: 6372 6974 6572 696f 6e20 696e 205b 2743  criterion in ['C
-0001eb40: 6173 6527 2c20 2743 6173 652d 5369 6d70  ase', 'Case-Simp
-0001eb50: 6c65 275d 2061 6e64 206e 702e 616e 7928  le'] and np.any(
-0001eb60: 6f2e 6361 7365 5f76 616c 7565 7320 3c20  o.case_values < 
-0001eb70: 6265 7374 5f76 616c 7565 2929 206f 7220  best_value)) or 
-0001eb80: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
-0001eb90: 2020 2020 2020 2020 2020 2869 7369 6e73            (isins
-0001eba0: 7461 6e63 6528 636f 6d70 6172 6973 6f6e  tance(comparison
-0001ebb0: 5f63 7269 7465 7269 6f6e 2c20 696e 7429  _criterion, int)
-0001ebc0: 2061 6e64 0a20 2020 2020 2020 2020 2020   and.           
-0001ebd0: 2020 2020 2020 2020 2020 2020 2020 6e70                np
-0001ebe0: 2e73 756d 286f 2e63 6173 655f 7661 6c75  .sum(o.case_valu
-0001ebf0: 6573 203c 2062 6573 745f 7661 6c75 6529  es < best_value)
-0001ec00: 203e 2063 6f6d 7061 7269 736f 6e5f 6372   > comparison_cr
-0001ec10: 6974 6572 696f 6e29 3a0a 2020 2020 2020  iterion):.      
-0001ec20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ec30: 2020 7365 6c65 6374 696f 6e5f 6461 7461    selection_data
-0001ec40: 5b30 5d5b 6f2e 7365 6c65 6374 696f 6e5f  [0][o.selection_
-0001ec50: 6f70 6572 6174 6f72 5d20 2b3d 2031 0a20  operator] += 1. 
-0001ec60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ec70: 2020 2065 6c69 6620 636f 6d70 6172 6973     elif comparis
-0001ec80: 6f6e 5f63 7269 7465 7269 6f6e 203d 3d20  on_criterion == 
-0001ec90: 2746 6974 6e65 7373 2d43 6173 6527 2061  'Fitness-Case' a
-0001eca0: 6e64 206e 702e 616e 7928 6f2e 6361 7365  nd np.any(o.case
-0001ecb0: 5f76 616c 7565 7320 3c20 7061 7265 6e74  _values < parent
-0001ecc0: 5f63 6173 655f 7661 6c75 6573 293a 0a20  _case_values):. 
-0001ecd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ece0: 2020 2020 2020 2023 2064 6f6e 2774 2063         # don't c
-0001ecf0: 6f6e 7369 6465 7220 7468 6973 2074 7269  onsider this tri
-0001ed00: 616c 2061 7320 7375 6363 6573 7320 6f72  al as success or
-0001ed10: 2066 6169 6c75 7265 0a20 2020 2020 2020   failure.       
-0001ed20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ed30: 2070 6173 730a 2020 2020 2020 2020 2020   pass.          
-0001ed40: 2020 2020 2020 2020 2020 656c 6966 2063            elif c
-0001ed50: 6f6d 7061 7269 736f 6e5f 6372 6974 6572  omparison_criter
-0001ed60: 696f 6e20 3d3d 2027 4361 7365 2d50 6c75  ion == 'Case-Plu
-0001ed70: 7327 3a0a 2020 2020 2020 2020 2020 2020  s':.            
-0001ed80: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-0001ed90: 702e 616e 7928 6f2e 6361 7365 5f76 616c  p.any(o.case_val
-0001eda0: 7565 7320 3c20 6265 7374 5f76 616c 7565  ues < best_value
-0001edb0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0001edc0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001edd0: 656c 6563 7469 6f6e 5f64 6174 615b 305d  election_data[0]
-0001ede0: 5b6f 2e73 656c 6563 7469 6f6e 5f6f 7065  [o.selection_ope
-0001edf0: 7261 746f 725d 202b 3d20 6e70 2e73 756d  rator] += np.sum
-0001ee00: 286f 2e63 6173 655f 7661 6c75 6573 203c  (o.case_values <
-0001ee10: 2062 6573 745f 7661 6c75 6529 0a20 2020   best_value).   
-0001ee20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ee30: 2020 2020 2069 6620 6e70 2e61 6e79 286f       if np.any(o
-0001ee40: 2e63 6173 655f 7661 6c75 6573 203e 2077  .case_values > w
-0001ee50: 6f72 7374 5f76 616c 7565 293a 0a20 2020  orst_value):.   
-0001ee60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ee70: 2020 2020 2020 2020 2073 656c 6563 7469           selecti
-0001ee80: 6f6e 5f64 6174 615b 315d 5b6f 2e73 656c  on_data[1][o.sel
-0001ee90: 6563 7469 6f6e 5f6f 7065 7261 746f 725d  ection_operator]
-0001eea0: 202b 3d20 6e70 2e73 756d 286f 2e63 6173   += np.sum(o.cas
-0001eeb0: 655f 7661 6c75 6573 203e 2077 6f72 7374  e_values > worst
-0001eec0: 5f76 616c 7565 290a 2020 2020 2020 2020  _value).        
-0001eed0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0001eee0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001eef0: 2020 2020 2020 2020 2020 7365 6c65 6374            select
-0001ef00: 696f 6e5f 6461 7461 5b31 5d5b 6f2e 7365  ion_data[1][o.se
-0001ef10: 6c65 6374 696f 6e5f 6f70 6572 6174 6f72  lection_operator
-0001ef20: 5d20 2b3d 2031 0a20 2020 2020 2020 2020  ] += 1.         
-0001ef30: 2020 2020 2020 2073 656c 662e 6f70 6572         self.oper
-0001ef40: 6174 6f72 5f73 656c 6563 7469 6f6e 5f68  ator_selection_h
-0001ef50: 6973 746f 7279 2e61 7070 656e 6428 7475  istory.append(tu
-0001ef60: 706c 6528 636e 742e 7661 6c75 6573 2829  ple(cnt.values()
-0001ef70: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
-0001ef80: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
-0001ef90: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0001efa0: 2020 2020 2020 2020 7072 696e 7428 7365          print(se
-0001efb0: 6c65 6374 696f 6e5f 6461 7461 5b30 5d2c  lection_data[0],
-0001efc0: 2073 656c 6563 7469 6f6e 5f64 6174 615b   selection_data[
-0001efd0: 315d 290a 2020 2020 2020 2020 2020 2020  1]).            
-0001efe0: 2020 2020 2020 2020 7072 696e 7428 636e          print(cn
-0001eff0: 7429 0a20 2020 2020 2020 2020 2020 2020  t).             
-0001f000: 2020 2069 6620 6d6f 6465 203d 3d20 2754     if mode == 'T
-0001f010: 6872 6573 686f 6c64 273a 0a20 2020 2020  hreshold':.     
-0001f020: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0001f030: 2066 6978 6564 2074 6872 6573 686f 6c64   fixed threshold
-0001f040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f050: 2020 2020 2066 6f72 206f 7020 696e 2072       for op in r
-0001f060: 616e 6765 2873 656c 6563 7469 6f6e 5f64  ange(selection_d
-0001f070: 6174 612e 7368 6170 655b 315d 293a 0a20  ata.shape[1]):. 
-0001f080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f090: 2020 2020 2020 2069 6620 7365 6c65 6374         if select
-0001f0a0: 696f 6e5f 6461 7461 5b30 5d5b 6f70 5d20  ion_data[0][op] 
-0001f0b0: 2b20 7365 6c65 6374 696f 6e5f 6461 7461  + selection_data
-0001f0c0: 5b31 5d5b 6f70 5d20 3e20 433a 0a20 2020  [1][op] > C:.   
-0001f0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f0e0: 2020 2020 2020 2020 2073 756d 5f64 6174           sum_dat
-0001f0f0: 6120 3d20 7365 6c65 6374 696f 6e5f 6461  a = selection_da
-0001f100: 7461 5b30 5d5b 6f70 5d20 2b20 7365 6c65  ta[0][op] + sele
-0001f110: 6374 696f 6e5f 6461 7461 5b31 5d5b 6f70  ction_data[1][op
-0001f120: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0001f130: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001f140: 6c65 6374 696f 6e5f 6461 7461 5b30 5d5b  lection_data[0][
-0001f150: 6f70 5d20 3d20 7365 6c65 6374 696f 6e5f  op] = selection_
-0001f160: 6461 7461 5b30 5d5b 6f70 5d20 2f20 7375  data[0][op] / su
-0001f170: 6d5f 6461 7461 202a 2043 0a20 2020 2020  m_data * C.     
-0001f180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f190: 2020 2020 2020 2073 656c 6563 7469 6f6e         selection
-0001f1a0: 5f64 6174 615b 315d 5b6f 705d 203d 2073  _data[1][op] = s
-0001f1b0: 656c 6563 7469 6f6e 5f64 6174 615b 315d  election_data[1]
-0001f1c0: 5b6f 705d 202f 2073 756d 5f64 6174 6120  [op] / sum_data 
-0001f1d0: 2a20 430a 2020 2020 2020 2020 2020 2020  * C.            
-0001f1e0: 2020 2020 2320 6176 6f69 6420 7472 6976      # avoid triv
-0001f1f0: 6961 6c20 7072 6f62 6162 696c 6974 790a  ial probability.
-0001f200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f210: 7365 6c65 6374 696f 6e5f 6461 7461 203d  selection_data =
-0001f220: 206e 702e 636c 6970 2873 656c 6563 7469   np.clip(selecti
-0001f230: 6f6e 5f64 6174 612c 2031 652d 322c 204e  on_data, 1e-2, N
-0001f240: 6f6e 6529 0a0a 2020 2020 2020 2020 2020  one)..          
-0001f250: 2020 6966 2073 656c 662e 7365 6c65 6374    if self.select
-0001f260: 203d 3d20 2741 7574 6f2d 4d43 5453 273a   == 'Auto-MCTS':
-0001f270: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f280: 2073 656c 6563 7469 6f6e 5f63 6f75 6e74   selection_count
-0001f290: 6572 203d 2064 6566 6175 6c74 6469 6374  er = defaultdict
-0001f2a0: 2869 6e74 290a 2020 2020 2020 2020 2020  (int).          
-0001f2b0: 2020 2020 2020 6765 6e65 5f63 6f75 6e74        gene_count
-0001f2c0: 6572 203d 2064 6566 6175 6c74 6469 6374  er = defaultdict
-0001f2d0: 2869 6e74 290a 2020 2020 2020 2020 2020  (int).          
-0001f2e0: 2020 2020 2020 4320 3d20 7365 6c66 2e6d        C = self.m
-0001f2f0: 6162 5f70 6172 616d 6574 6572 2e67 6574  ab_parameter.get
-0001f300: 2827 7468 7265 7368 6f6c 6427 2c20 3130  ('threshold', 10
-0001f310: 3029 0a20 2020 2020 2020 2020 2020 2020  0).             
-0001f320: 2020 2066 6f72 206f 2069 6e20 6f66 6673     for o in offs
-0001f330: 7072 696e 673a 0a20 2020 2020 2020 2020  pring:.         
-0001f340: 2020 2020 2020 2020 2020 2069 6620 2863             if (c
-0001f350: 6f6d 7061 7269 736f 6e5f 6372 6974 6572  omparison_criter
-0001f360: 696f 6e20 696e 205b 2746 6974 6e65 7373  ion in ['Fitness
-0001f370: 272c 2027 4669 746e 6573 732d 4361 7365  ', 'Fitness-Case
-0001f380: 275d 2061 6e64 206f 2e66 6974 6e65 7373  '] and o.fitness
-0001f390: 2e77 7661 6c75 6573 5b30 5d20 3e20 6265  .wvalues[0] > be
-0001f3a0: 7374 5f76 616c 7565 2920 6f72 205c 0a20  st_value) or \. 
-0001f3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f3c0: 2020 2020 2020 2028 636f 6d70 6172 6973         (comparis
-0001f3d0: 6f6e 5f63 7269 7465 7269 6f6e 2069 6e20  on_criterion in 
-0001f3e0: 5b27 4361 7365 272c 2027 4361 7365 2d53  ['Case', 'Case-S
-0001f3f0: 696d 706c 6527 5d20 616e 6420 6e70 2e61  imple'] and np.a
-0001f400: 6e79 286f 2e63 6173 655f 7661 6c75 6573  ny(o.case_values
-0001f410: 203c 2062 6573 745f 7661 6c75 6529 2920   < best_value)) 
-0001f420: 6f72 205c 0a20 2020 2020 2020 2020 2020  or \.           
-0001f430: 2020 2020 2020 2020 2020 2020 2028 6973               (is
-0001f440: 696e 7374 616e 6365 2863 6f6d 7061 7269  instance(compari
-0001f450: 736f 6e5f 6372 6974 6572 696f 6e2c 2069  son_criterion, i
-0001f460: 6e74 2920 616e 640a 2020 2020 2020 2020  nt) and.        
-0001f470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f480: 206e 702e 7375 6d28 6f2e 6361 7365 5f76   np.sum(o.case_v
-0001f490: 616c 7565 7320 3c20 6265 7374 5f76 616c  alues < best_val
-0001f4a0: 7565 2920 3e20 636f 6d70 6172 6973 6f6e  ue) > comparison
-0001f4b0: 5f63 7269 7465 7269 6f6e 293a 0a20 2020  _criterion):.   
-0001f4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f4d0: 2020 2020 206d 6374 735f 6469 6374 5b27       mcts_dict['
-0001f4e0: 5375 7276 6976 616c 204f 7065 7261 746f  Survival Operato
-0001f4f0: 7273 275d 5b30 5d5b 6f2e 7375 7276 6976  rs'][0][o.surviv
-0001f500: 616c 5f6f 7065 7261 746f 725f 6964 5d20  al_operator_id] 
-0001f510: 2b3d 2031 0a20 2020 2020 2020 2020 2020  += 1.           
-0001f520: 2020 2020 2020 2020 2020 2020 206d 6374               mct
-0001f530: 735f 6469 6374 5b27 5365 6c65 6374 696f  s_dict['Selectio
-0001f540: 6e20 4f70 6572 6174 6f72 7327 5d5b 305d  n Operators'][0]
-0001f550: 5b6f 2e73 656c 6563 7469 6f6e 5f6f 7065  [o.selection_ope
-0001f560: 7261 746f 725d 202b 3d20 310a 2020 2020  rator] += 1.    
-0001f570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f580: 656c 6966 2063 6f6d 7061 7269 736f 6e5f  elif comparison_
-0001f590: 6372 6974 6572 696f 6e20 3d3d 2027 4669  criterion == 'Fi
-0001f5a0: 746e 6573 732d 4361 7365 2720 616e 6420  tness-Case' and 
-0001f5b0: 6e70 2e61 6e79 286f 2e63 6173 655f 7661  np.any(o.case_va
-0001f5c0: 6c75 6573 203c 2070 6172 656e 745f 6361  lues < parent_ca
-0001f5d0: 7365 5f76 616c 7565 7329 3a0a 2020 2020  se_values):.    
-0001f5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f5f0: 2020 2020 2320 646f 6e27 7420 636f 6e73      # don't cons
-0001f600: 6964 6572 2074 6869 7320 7472 6961 6c20  ider this trial 
-0001f610: 6173 2073 7563 6365 7373 206f 7220 6661  as success or fa
-0001f620: 696c 7572 650a 2020 2020 2020 2020 2020  ilure.          
-0001f630: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-0001f640: 7373 0a20 2020 2020 2020 2020 2020 2020  ss.             
-0001f650: 2020 2020 2020 2065 6c69 6620 636f 6d70         elif comp
-0001f660: 6172 6973 6f6e 5f63 7269 7465 7269 6f6e  arison_criterion
-0001f670: 203d 3d20 2743 6173 652d 506c 7573 273a   == 'Case-Plus':
-0001f680: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f690: 2020 2020 2020 2020 2069 6620 6e70 2e61           if np.a
-0001f6a0: 6e79 286f 2e63 6173 655f 7661 6c75 6573  ny(o.case_values
-0001f6b0: 203c 2062 6573 745f 7661 6c75 6529 3a0a   < best_value):.
-0001f6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f6d0: 2020 2020 2020 2020 2020 2020 6d63 7473              mcts
-0001f6e0: 5f64 6963 745b 2753 7572 7669 7661 6c20  _dict['Survival 
-0001f6f0: 4f70 6572 6174 6f72 7327 5d5b 305d 5b6f  Operators'][0][o
-0001f700: 2e73 7572 7669 7661 6c5f 6f70 6572 6174  .survival_operat
-0001f710: 6f72 5f69 645d 202b 3d20 6e70 2e73 756d  or_id] += np.sum
-0001f720: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0001f730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f740: 2020 6f2e 6361 7365 5f76 616c 7565 7320    o.case_values 
-0001f750: 3c20 6265 7374 5f76 616c 7565 290a 2020  < best_value).  
-0001f760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f770: 2020 2020 2020 2020 2020 6d63 7473 5f64            mcts_d
-0001f780: 6963 745b 2753 656c 6563 7469 6f6e 204f  ict['Selection O
-0001f790: 7065 7261 746f 7273 275d 5b30 5d5b 6f2e  perators'][0][o.
-0001f7a0: 7365 6c65 6374 696f 6e5f 6f70 6572 6174  selection_operat
-0001f7b0: 6f72 5d20 2b3d 206e 702e 7375 6d28 0a20  or] += np.sum(. 
-0001f7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f7d0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-0001f7e0: 2e63 6173 655f 7661 6c75 6573 203c 2062  .case_values < b
-0001f7f0: 6573 745f 7661 6c75 6529 0a20 2020 2020  est_value).     
-0001f800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f810: 2020 2069 6620 6e70 2e61 6e79 286f 2e63     if np.any(o.c
-0001f820: 6173 655f 7661 6c75 6573 203c 2077 6f72  ase_values < wor
-0001f830: 7374 5f76 616c 7565 293a 0a20 2020 2020  st_value):.     
-0001f840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f850: 2020 2020 2020 206d 6374 735f 6469 6374         mcts_dict
-0001f860: 5b27 5375 7276 6976 616c 204f 7065 7261  ['Survival Opera
-0001f870: 746f 7273 275d 5b31 5d5b 6f2e 7375 7276  tors'][1][o.surv
-0001f880: 6976 616c 5f6f 7065 7261 746f 725f 6964  ival_operator_id
-0001f890: 5d20 2b3d 206e 702e 7375 6d28 0a20 2020  ] += np.sum(.   
-0001f8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f8b0: 2020 2020 2020 2020 2020 2020 206f 2e63               o.c
-0001f8c0: 6173 655f 7661 6c75 6573 203c 2077 6f72  ase_values < wor
-0001f8d0: 7374 5f76 616c 7565 290a 2020 2020 2020  st_value).      
-0001f8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f8f0: 2020 2020 2020 6d63 7473 5f64 6963 745b        mcts_dict[
-0001f900: 2753 656c 6563 7469 6f6e 204f 7065 7261  'Selection Opera
-0001f910: 746f 7273 275d 5b31 5d5b 6f2e 7365 6c65  tors'][1][o.sele
-0001f920: 6374 696f 6e5f 6f70 6572 6174 6f72 5d20  ction_operator] 
-0001f930: 2b3d 206e 702e 7375 6d28 0a20 2020 2020  += np.sum(.     
+0001e340: 2020 2020 2020 2020 2020 2020 274d 4150              'MAP
+0001e350: 2d45 6c69 7465 2d4c 6578 6963 6173 652c  -Elite-Lexicase,
+0001e360: 546f 7572 6e61 6d65 6e74 2d37 2c54 6f75  Tournament-7,Tou
+0001e370: 726e 616d 656e 742d 3135 2729 2e73 706c  rnament-15').spl
+0001e380: 6974 2827 2c27 290a 2020 2020 2020 2020  it(',').        
+0001e390: 2020 2020 7365 6c65 6374 696f 6e5f 6461      selection_da
+0001e3a0: 7461 203d 206e 702e 6f6e 6573 2828 322c  ta = np.ones((2,
+0001e3b0: 206c 656e 2873 656c 6563 7469 6f6e 5f6f   len(selection_o
+0001e3c0: 7065 7261 746f 7273 2929 290a 2020 2020  perators))).    
+0001e3d0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0001e3e0: 2020 2020 2020 7365 6c65 6374 696f 6e5f        selection_
+0001e3f0: 6f70 6572 6174 6f72 7320 3d20 4e6f 6e65  operators = None
+0001e400: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0001e410: 6563 7469 6f6e 5f64 6174 6120 3d20 4e6f  ection_data = No
+0001e420: 6e65 0a0a 2020 2020 2020 2020 6669 746e  ne..        fitn
+0001e430: 6573 735f 696d 7072 6f76 656d 656e 7420  ess_improvement 
+0001e440: 3d20 300a 2020 2020 2020 2020 2320 6669  = 0.        # fi
+0001e450: 746e 6573 7320 6465 6372 6561 7365 206f  tness decrease o
+0001e460: 6e20 7661 6c69 6461 7469 6f6e 2073 6574  n validation set
+0001e470: 0a20 2020 2020 2020 2077 6f72 7365 5f69  .        worse_i
+0001e480: 7465 7261 7469 6f6e 7320 3d20 300a 2020  terations = 0.  
+0001e490: 2020 2020 2020 2320 6974 6572 6174 696f        # iteratio
+0001e4a0: 6e73 206f 6620 6e6f 2066 6974 6e65 7373  ns of no fitness
+0001e4b0: 2069 6d70 726f 7665 6d65 6e74 206f 6e20   improvement on 
+0001e4c0: 7472 6169 6e69 6e67 2073 6574 0a20 2020  training set.   
+0001e4d0: 2020 2020 206e 6f5f 696d 7072 6f76 656d       no_improvem
+0001e4e0: 656e 745f 6974 6572 6174 696f 6e20 3d20  ent_iteration = 
+0001e4f0: 300a 2020 2020 2020 2020 6164 6170 7469  0.        adapti
+0001e500: 7665 5f68 6f69 7374 5f70 726f 6261 6269  ve_hoist_probabi
+0001e510: 6c69 7479 203d 204e 6f6e 650a 2020 2020  lity = None.    
+0001e520: 2020 2020 6869 7374 6f72 6963 616c 5f62      historical_b
+0001e530: 6573 745f 6669 746e 6573 7320 3d20 6e70  est_fitness = np
+0001e540: 2e6d 6178 285b 696e 642e 6669 746e 6573  .max([ind.fitnes
+0001e550: 732e 7776 616c 7565 735b 305d 2066 6f72  s.wvalues[0] for
+0001e560: 2069 6e64 2069 6e20 706f 7075 6c61 7469   ind in populati
+0001e570: 6f6e 5d29 0a20 2020 2020 2020 2063 6f6d  on]).        com
+0001e580: 7061 7269 736f 6e5f 6372 6974 6572 696f  parison_criterio
+0001e590: 6e20 3d20 7365 6c66 2e6d 6162 5f70 6172  n = self.mab_par
+0001e5a0: 616d 6574 6572 2e67 6574 2827 636f 6d70  ameter.get('comp
+0001e5b0: 6172 6973 6f6e 5f63 7269 7465 7269 6f6e  arison_criterion
+0001e5c0: 272c 2027 4361 7365 2729 0a20 2020 2020  ', 'Case').     
+0001e5d0: 2020 2022 2222 0a20 2020 2020 2020 2046     """.        F
+0001e5e0: 6974 6e65 7373 3a20 5573 696e 6720 7468  itness: Using th
+0001e5f0: 6520 6669 746e 6573 7320 696d 7072 6f76  e fitness improv
+0001e600: 656d 656e 7420 6173 2074 6865 2063 7269  ement as the cri
+0001e610: 7465 7269 6f6e 206f 6620 6120 7375 6363  terion of a succ
+0001e620: 6573 7320 7472 6961 6c0a 2020 2020 2020  ess trial.      
+0001e630: 2020 4669 746e 6573 732d 4361 7365 3a20    Fitness-Case: 
+0001e640: 5573 696e 6720 7468 6520 6669 746e 6573  Using the fitnes
+0001e650: 7320 696d 7072 6f76 656d 656e 7420 6173  s improvement as
+0001e660: 2074 6865 2063 7269 7465 7269 6f6e 206f   the criterion o
+0001e670: 6620 6120 7375 6363 6573 7320 7472 6961  f a success tria
+0001e680: 6c0a 2020 2020 2020 2020 2020 2020 2020  l.              
+0001e690: 2020 2020 2020 2020 616e 6420 7468 6520          and the 
+0001e6a0: 6669 746e 6573 7320 696d 7072 6f76 656d  fitness improvem
+0001e6b0: 656e 7420 6f6e 2061 2073 696e 676c 6520  ent on a single 
+0001e6c0: 6361 7365 2061 7320 7468 6520 6372 6974  case as the crit
+0001e6d0: 6572 696f 6e20 6f66 2061 206e 6575 7472  erion of a neutr
+0001e6e0: 616c 2074 7269 616c 0a20 2020 2020 2020  al trial.       
+0001e6f0: 2043 6173 653a 2055 7369 6e67 2074 6865   Case: Using the
+0001e700: 2066 6974 6e65 7373 2069 6d70 726f 7665   fitness improve
+0001e710: 6d65 6e74 206f 6e20 6120 7369 6e67 6c65  ment on a single
+0001e720: 2063 6173 6520 6173 2074 6865 2063 7269   case as the cri
+0001e730: 7465 7269 6f6e 206f 6620 6120 7375 6363  terion of a succ
+0001e740: 6573 7320 7472 6961 6c0a 2020 2020 2020  ess trial.      
+0001e750: 2020 4361 7365 2d50 6c75 733a 2055 7369    Case-Plus: Usi
+0001e760: 6e67 2072 6561 6c20 696d 7072 6f76 656d  ng real improvem
+0001e770: 656e 7420 6173 2074 6865 2073 636f 7265  ent as the score
+0001e780: 206f 6620 6120 7472 6169 6c0a 2020 2020   of a trail.    
+0001e790: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001e7a0: 6966 2063 6f6d 7061 7269 736f 6e5f 6372  if comparison_cr
+0001e7b0: 6974 6572 696f 6e20 696e 205b 2746 6974  iterion in ['Fit
+0001e7c0: 6e65 7373 272c 2027 4669 746e 6573 732d  ness', 'Fitness-
+0001e7d0: 4361 7365 275d 3a0a 2020 2020 2020 2020  Case']:.        
+0001e7e0: 2020 2020 6265 7374 5f76 616c 7565 203d      best_value =
+0001e7f0: 206e 702e 6d61 7828 5b70 2e66 6974 6e65   np.max([p.fitne
+0001e800: 7373 2e77 7661 6c75 6573 5b30 5d20 666f  ss.wvalues[0] fo
+0001e810: 7220 7020 696e 2070 6f70 756c 6174 696f  r p in populatio
+0001e820: 6e5d 290a 2020 2020 2020 2020 656c 6966  n]).        elif
+0001e830: 2063 6f6d 7061 7269 736f 6e5f 6372 6974   comparison_crit
+0001e840: 6572 696f 6e20 696e 205b 2743 6173 6527  erion in ['Case'
+0001e850: 2c20 2743 6173 652d 506c 7573 272c 2027  , 'Case-Plus', '
+0001e860: 4361 7365 2d53 696d 706c 6527 5d20 6f72  Case-Simple'] or
+0001e870: 2069 7369 6e73 7461 6e63 6528 636f 6d70   isinstance(comp
+0001e880: 6172 6973 6f6e 5f63 7269 7465 7269 6f6e  arison_criterion
+0001e890: 2c20 696e 7429 3a0a 2020 2020 2020 2020  , int):.        
+0001e8a0: 2020 2020 6265 7374 5f76 616c 7565 203d      best_value =
+0001e8b0: 206e 702e 6d69 6e28 5b70 2e63 6173 655f   np.min([p.case_
+0001e8c0: 7661 6c75 6573 2066 6f72 2070 2069 6e20  values for p in 
+0001e8d0: 706f 7075 6c61 7469 6f6e 5d2c 2061 7869  population], axi
+0001e8e0: 733d 3029 0a20 2020 2020 2020 2020 2020  s=0).           
+0001e8f0: 2077 6f72 7374 5f76 616c 7565 203d 206e   worst_value = n
+0001e900: 702e 6d61 7828 5b70 2e63 6173 655f 7661  p.max([p.case_va
+0001e910: 6c75 6573 2066 6f72 2070 2069 6e20 706f  lues for p in po
+0001e920: 7075 6c61 7469 6f6e 5d2c 2061 7869 733d  pulation], axis=
+0001e930: 3029 0a20 2020 2020 2020 2065 6c73 653a  0).        else:
+0001e940: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0001e950: 7365 2045 7863 6570 7469 6f6e 0a0a 2020  se Exception..  
+0001e960: 2020 2020 2020 2320 4d43 5453 0a20 2020        # MCTS.   
+0001e970: 2020 2020 206d 6374 735f 6469 6374 203d       mcts_dict =
+0001e980: 207b 7d0a 2020 2020 2020 2020 6361 6e64   {}.        cand
+0001e990: 6964 6174 655f 7365 6c65 6374 696f 6e5f  idate_selection_
+0001e9a0: 6f70 6572 6174 6f72 7320 3d20 274d 4150  operators = 'MAP
+0001e9b0: 2d45 6c69 7465 2d4c 6578 6963 6173 652c  -Elite-Lexicase,
+0001e9c0: 546f 7572 6e61 6d65 6e74 2d37 2c54 6f75  Tournament-7,Tou
+0001e9d0: 726e 616d 656e 742d 3135 2c4c 6578 6963  rnament-15,Lexic
+0001e9e0: 6173 6527 2e73 706c 6974 2827 2c27 290a  ase'.split(',').
+0001e9f0: 2020 2020 2020 2020 6361 6e64 6964 6174          candidat
+0001ea00: 655f 7375 7276 6976 616c 5f6f 7065 6172  e_survival_opear
+0001ea10: 6174 6f72 7320 3d20 2741 4650 2c42 6573  ators = 'AFP,Bes
+0001ea20: 742c 4e6f 6e65 272e 7370 6c69 7428 272c  t,None'.split(',
+0001ea30: 2729 0a20 2020 2020 2020 206d 6374 735f  ').        mcts_
+0001ea40: 6469 6374 5b27 5375 7276 6976 616c 204f  dict['Survival O
+0001ea50: 7065 7261 746f 7273 275d 203d 206e 702e  perators'] = np.
+0001ea60: 6f6e 6573 2828 322c 206c 656e 2863 616e  ones((2, len(can
+0001ea70: 6469 6461 7465 5f73 7572 7669 7661 6c5f  didate_survival_
+0001ea80: 6f70 6561 7261 746f 7273 2929 290a 2020  opearators))).  
+0001ea90: 2020 2020 2020 6d63 7473 5f64 6963 745b        mcts_dict[
+0001eaa0: 2753 656c 6563 7469 6f6e 204f 7065 7261  'Selection Opera
+0001eab0: 746f 7273 275d 203d 206e 702e 6f6e 6573  tors'] = np.ones
+0001eac0: 2828 322c 206c 656e 2863 616e 6469 6461  ((2, len(candida
+0001ead0: 7465 5f73 656c 6563 7469 6f6e 5f6f 7065  te_selection_ope
+0001eae0: 7261 746f 7273 2929 290a 0a20 2020 2020  rators)))..     
+0001eaf0: 2020 2023 2061 7263 6869 7665 2069 6e69     # archive ini
+0001eb00: 7469 616c 697a 6174 696f 6e0a 2020 2020  tialization.    
+0001eb10: 2020 2020 6966 2073 656c 662e 7365 6c65      if self.sele
+0001eb20: 6374 203d 3d20 2741 7574 6f2d 4d43 5453  ct == 'Auto-MCTS
+0001eb30: 273a 0a20 2020 2020 2020 2020 2020 206e  ':.            n
+0001eb40: 7367 615f 6172 6368 6976 6520 3d20 706f  sga_archive = po
+0001eb50: 7075 6c61 7469 6f6e 0a20 2020 2020 2020  pulation.       
+0001eb60: 2020 2020 2061 6670 5f61 7263 6869 7665       afp_archive
+0001eb70: 203d 2070 6f70 756c 6174 696f 6e0a 2020   = population.  
+0001eb80: 2020 2020 2020 2020 2020 6265 7374 5f61            best_a
+0001eb90: 7263 6869 7665 203d 2070 6f70 756c 6174  rchive = populat
+0001eba0: 696f 6e0a 2020 2020 2020 2020 656c 7365  ion.        else
+0001ebb0: 3a0a 2020 2020 2020 2020 2020 2020 6e73  :.            ns
+0001ebc0: 6761 5f61 7263 6869 7665 203d 204e 6f6e  ga_archive = Non
+0001ebd0: 650a 2020 2020 2020 2020 2020 2020 6166  e.            af
+0001ebe0: 705f 6172 6368 6976 6520 3d20 4e6f 6e65  p_archive = None
+0001ebf0: 0a20 2020 2020 2020 2020 2020 2062 6573  .            bes
+0001ec00: 745f 6172 6368 6976 6520 3d20 4e6f 6e65  t_archive = None
+0001ec10: 0a20 2020 2020 2020 2073 656c 662e 7570  .        self.up
+0001ec20: 6461 7465 5f73 656d 616e 7469 635f 7265  date_semantic_re
+0001ec30: 7061 6972 5f69 6e70 7574 5f6d 6174 7269  pair_input_matri
+0001ec40: 7828 706f 7075 6c61 7469 6f6e 290a 2020  x(population).  
+0001ec50: 2020 2020 2020 6578 7465 726e 616c 5f61        external_a
+0001ec60: 7263 6869 7665 203d 2073 656c 662e 7570  rchive = self.up
+0001ec70: 6461 7465 5f65 7874 6572 6e61 6c5f 6172  date_external_ar
+0001ec80: 6368 6976 6528 706f 7075 6c61 7469 6f6e  chive(population
+0001ec90: 2c20 4e6f 6e65 290a 0a20 2020 2020 2020  , None)..       
+0001eca0: 2023 2042 6567 696e 2074 6865 2067 656e   # Begin the gen
+0001ecb0: 6572 6174 696f 6e61 6c20 7072 6f63 6573  erational proces
+0001ecc0: 730a 2020 2020 2020 2020 6e75 6d62 6572  s.        number
+0001ecd0: 5f6f 665f 6576 616c 7561 7469 6f6e 7320  _of_evaluations 
+0001ece0: 3d20 7365 6c66 2e6e 5f70 6f70 0a20 2020  = self.n_pop.   
+0001ecf0: 2020 2020 2074 6f74 616c 5f65 7661 6c75       total_evalu
+0001ed00: 6174 696f 6e73 203d 2028 7365 6c66 2e6e  ations = (self.n
+0001ed10: 5f67 656e 202b 2031 2920 2a20 7365 6c66  _gen + 1) * self
+0001ed20: 2e6e 5f70 6f70 0a20 2020 2020 2020 2067  .n_pop.        g
+0001ed30: 656e 203d 2030 0a20 2020 2020 2020 2070  en = 0.        p
+0001ed40: 6f70 5f73 697a 6520 3d20 7365 6c66 2e6e  op_size = self.n
+0001ed50: 5f70 6f70 0a20 2020 2020 2020 2077 6869  _pop.        whi
+0001ed60: 6c65 206e 756d 6265 725f 6f66 5f65 7661  le number_of_eva
+0001ed70: 6c75 6174 696f 6e73 203c 2074 6f74 616c  luations < total
+0001ed80: 5f65 7661 6c75 6174 696f 6e73 3a0a 2020  _evaluations:.  
+0001ed90: 2020 2020 2020 2020 2020 6765 6e20 2b3d            gen +=
+0001eda0: 2031 0a20 2020 2020 2020 2020 2020 2073   1.            s
+0001edb0: 656c 662e 6375 7272 656e 745f 6765 6e20  elf.current_gen 
+0001edc0: 3d20 6765 6e0a 2020 2020 2020 2020 2020  = gen.          
+0001edd0: 2020 7365 6c66 2e65 7661 6c75 6174 696f    self.evaluatio
+0001ede0: 6e5f 636f 6e66 6967 7572 6174 696f 6e2e  n_configuration.
+0001edf0: 6375 7272 656e 745f 6765 6e65 7261 7469  current_generati
+0001ee00: 6f6e 203d 2073 656c 662e 6375 7272 656e  on = self.curren
+0001ee10: 745f 6765 6e0a 2020 2020 2020 2020 2020  t_gen.          
+0001ee20: 2020 6966 2073 656c 662e 6479 6e61 6d69    if self.dynami
+0001ee30: 635f 7265 6475 6374 696f 6e20 3e20 3020  c_reduction > 0 
+0001ee40: 616e 6420 2867 656e 203e 2031 2920 616e  and (gen > 1) an
+0001ee50: 6420 5c0a 2020 2020 2020 2020 2020 2020  d \.            
+0001ee60: 2020 2020 2828 6e75 6d62 6572 5f6f 665f      ((number_of_
+0001ee70: 6576 616c 7561 7469 6f6e 7320 2d20 7365  evaluations - se
+0001ee80: 6c66 2e6e 5f70 6f70 2920 250a 2020 2020  lf.n_pop) %.    
+0001ee90: 2020 2020 2020 2020 2020 2020 2028 2874               ((t
+0001eea0: 6f74 616c 5f65 7661 6c75 6174 696f 6e73  otal_evaluations
+0001eeb0: 202d 2073 656c 662e 6e5f 706f 7029 202f   - self.n_pop) /
+0001eec0: 2f20 7365 6c66 2e64 796e 616d 6963 5f72  / self.dynamic_r
+0001eed0: 6564 7563 7469 6f6e 2920 3d3d 2030 293a  eduction) == 0):
+0001eee0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001eef0: 2070 6f70 5f73 697a 6520 2f2f 3d20 320a   pop_size //= 2.
+0001ef00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ef10: 6173 7365 7274 2073 656c 662e 7072 655f  assert self.pre_
+0001ef20: 7365 6c65 6374 696f 6e20 3d3d 204e 6f6e  selection == Non
+0001ef30: 650a 2020 2020 2020 2020 2020 2020 706f  e.            po
+0001ef40: 705f 7369 7a65 203d 206d 696e 2870 6f70  p_size = min(pop
+0001ef50: 5f73 697a 652c 2074 6f74 616c 5f65 7661  _size, total_eva
+0001ef60: 6c75 6174 696f 6e73 202d 206e 756d 6265  luations - numbe
+0001ef70: 725f 6f66 5f65 7661 6c75 6174 696f 6e73  r_of_evaluations
+0001ef80: 290a 2020 2020 2020 2020 2020 2020 6e75  ).            nu
+0001ef90: 6d62 6572 5f6f 665f 6576 616c 7561 7469  mber_of_evaluati
+0001efa0: 6f6e 7320 2b3d 2070 6f70 5f73 697a 650a  ons += pop_size.
+0001efb0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0001efc0: 662e 7265 7065 7469 7469 7665 5f66 6561  f.repetitive_fea
+0001efd0: 7475 7265 5f63 6f75 6e74 2e61 7070 656e  ture_count.appen
+0001efe0: 6428 3029 0a20 2020 2020 2020 2020 2020  d(0).           
+0001eff0: 2073 656c 662e 656e 7472 6f70 795f 6361   self.entropy_ca
+0001f000: 6c63 756c 6174 696f 6e28 290a 2020 2020  lculation().    
+0001f010: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0001f020: 6d75 7461 7469 6f6e 5f73 6368 656d 6520  mutation_scheme 
+0001f030: 696e 2065 6461 5f6f 7065 7261 746f 7273  in eda_operators
+0001f040: 206f 7220 2745 4441 2720 696e 2073 656c   or 'EDA' in sel
+0001f050: 662e 6d75 7461 7469 6f6e 5f73 6368 656d  f.mutation_schem
+0001f060: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0001f070: 2020 2069 6620 7365 6c66 2e6d 7574 6174     if self.mutat
+0001f080: 696f 6e5f 7363 6865 6d65 203d 3d20 2745  ion_scheme == 'E
+0001f090: 4441 2d54 6572 6d69 6e61 6c2d 504d 2d46  DA-Terminal-PM-F
+0001f0a0: 7265 7175 656e 6379 273a 0a20 2020 2020  requency':.     
+0001f0b0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001f0c0: 656c 662e 6672 6571 7565 6e63 795f 636f  elf.frequency_co
+0001f0d0: 756e 7469 6e67 2869 6d70 6f72 7461 6e63  unting(importanc
+0001f0e0: 655f 7765 6967 6874 3d46 616c 7365 290a  e_weight=False).
+0001f0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f100: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0001f110: 2020 2020 2020 2020 2020 7365 6c66 2e66            self.f
+0001f120: 7265 7175 656e 6379 5f63 6f75 6e74 696e  requency_countin
+0001f130: 6728 290a 2020 2020 2020 2020 2020 2020  g().            
+0001f140: 2020 2020 7365 6c66 2e70 726f 6261 6269      self.probabi
+0001f150: 6c69 7479 5f73 616d 706c 696e 6728 290a  lity_sampling().
+0001f160: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0001f170: 656c 662e 6578 7465 726e 616c 5f61 7263  elf.external_arc
+0001f180: 6869 7665 203d 3d20 2748 616c 6c4f 6646  hive == 'HallOfF
+0001f190: 616d 6527 2061 6e64 2028 7365 6c66 2e68  ame' and (self.h
+0001f1a0: 6f66 2069 7320 6e6f 7420 4e6f 6e65 2920  of is not None) 
+0001f1b0: 616e 6420 7365 6c66 2e73 636f 7265 5f66  and self.score_f
+0001f1c0: 756e 6320 3d3d 2027 4e6f 7665 6c74 7953  unc == 'NoveltyS
+0001f1d0: 6561 7263 6827 3a0a 2020 2020 2020 2020  earch':.        
+0001f1e0: 2020 2020 2020 2020 2320 7265 6361 6c63          # recalc
+0001f1f0: 756c 6174 6520 7468 6520 6469 7665 7273  ulate the divers
+0001f200: 6974 7920 6d65 7472 6963 2066 6f72 2061  ity metric for a
+0001f210: 2066 6169 7220 636f 6d70 6172 6973 6f6e   fair comparison
+0001f220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f230: 2065 6e73 656d 626c 655f 7661 6c75 6520   ensemble_value 
+0001f240: 3d20 6e70 2e6d 6561 6e28 5b78 2e70 7265  = np.mean([x.pre
+0001f250: 6469 6374 6564 5f76 616c 7565 7320 666f  dicted_values fo
+0001f260: 7220 7820 696e 2073 656c 662e 686f 665d  r x in self.hof]
+0001f270: 2c20 6178 6973 3d30 290a 2020 2020 2020  , axis=0).      
+0001f280: 2020 2020 2020 2020 2020 666f 7220 7820            for x 
+0001f290: 696e 2073 656c 662e 686f 663a 0a20 2020  in self.hof:.   
+0001f2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f2b0: 2061 6d62 6967 7569 7479 203d 2028 782e   ambiguity = (x.
+0001f2c0: 7072 6564 6963 7465 645f 7661 6c75 6573  predicted_values
+0001f2d0: 202d 2065 6e73 656d 626c 655f 7661 6c75   - ensemble_valu
+0001f2e0: 6529 202a 2a20 320a 2020 2020 2020 2020  e) ** 2.        
+0001f2f0: 2020 2020 2020 2020 2020 2020 782e 6361              x.ca
+0001f300: 7365 5f76 616c 7565 735b 6c65 6e28 782e  se_values[len(x.
+0001f310: 7072 6564 6963 7465 645f 7661 6c75 6573  predicted_values
+0001f320: 293a 5d20 3d20 2d31 202a 2061 6d62 6967  ):] = -1 * ambig
+0001f330: 7569 7479 0a0a 2020 2020 2020 2020 2020  uity..          
+0001f340: 2020 6966 2073 656c 662e 7472 616e 7366    if self.transf
+0001f350: 6f72 6d65 725f 7377 6974 6368 3a0a 2020  ormer_switch:.  
+0001f360: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0001f370: 6c66 2e74 7261 6e73 666f 726d 6572 5f74  lf.transformer_t
+0001f380: 6f6f 6c2e 7472 6169 6e28 290a 0a20 2020  ool.train()..   
+0001f390: 2020 2020 2020 2020 2063 7870 622c 206d           cxpb, m
+0001f3a0: 7574 7062 203d 2073 656c 662e 6c69 6e65  utpb = self.line
+0001f3b0: 6172 5f61 6461 7074 6976 655f 7261 7465  ar_adaptive_rate
+0001f3c0: 2867 656e 2c20 6378 7062 2c20 6d75 7470  (gen, cxpb, mutp
+0001f3d0: 6229 0a20 2020 2020 2020 2020 2020 2063  b).            c
+0001f3e0: 7870 622c 206d 7574 7062 203d 2073 656c  xpb, mutpb = sel
+0001f3f0: 662e 6765 745f 6164 6170 7469 7665 5f6d  f.get_adaptive_m
+0001f400: 7574 6174 696f 6e5f 7261 7465 2863 7870  utation_rate(cxp
+0001f410: 622c 206d 7574 7062 290a 0a20 2020 2020  b, mutpb)..     
+0001f420: 2020 2020 2020 2073 7461 7274 5f74 696d         start_tim
+0001f430: 6520 3d20 7469 6d65 2e74 696d 6528 290a  e = time.time().
+0001f440: 2020 2020 2020 2020 2020 2020 636f 756e              coun
+0001f450: 7420 3d20 300a 2020 2020 2020 2020 2020  t = 0.          
+0001f460: 2020 6e65 775f 6f66 6673 7072 696e 6720    new_offspring 
+0001f470: 3d20 5b5d 0a0a 2020 2020 2020 2020 2020  = []..          
+0001f480: 2020 2320 436c 6561 7269 6e67 2073 7472    # Clearing str
+0001f490: 6174 6567 793a 206f 6e6c 7920 7468 6520  ategy: only the 
+0001f4a0: 6265 7374 206f 6e65 2069 6e20 6561 6368  best one in each
+0001f4b0: 2063 6c75 7374 6572 2077 696c 6c20 7375   cluster will su
+0001f4c0: 7276 6976 650a 2020 2020 2020 2020 2020  rvive.          
+0001f4d0: 2020 6966 2073 656c 662e 636c 6561 7269    if self.cleari
+0001f4e0: 6e67 5f63 6c75 7374 6572 5f73 697a 6520  ng_cluster_size 
+0001f4f0: 3e20 313a 0a20 2020 2020 2020 2020 2020  > 1:.           
+0001f500: 2020 2020 2061 6c6c 5f63 6173 655f 7661       all_case_va
+0001f510: 6c75 6573 203d 206e 702e 6172 7261 7928  lues = np.array(
+0001f520: 5b70 2e63 6173 655f 7661 6c75 6573 2066  [p.case_values f
+0001f530: 6f72 2070 2069 6e20 706f 7075 6c61 7469  or p in populati
+0001f540: 6f6e 5d29 0a20 2020 2020 2020 2020 2020  on]).           
+0001f550: 2020 2020 2073 756d 5f66 6974 6e65 7373       sum_fitness
+0001f560: 203d 206e 702e 6172 7261 7928 5b70 2e66   = np.array([p.f
+0001f570: 6974 6e65 7373 2e77 7661 6c75 6573 5b30  itness.wvalues[0
+0001f580: 5d20 666f 7220 7020 696e 2070 6f70 756c  ] for p in popul
+0001f590: 6174 696f 6e5d 290a 2020 2020 2020 2020  ation]).        
+0001f5a0: 2020 2020 2020 2020 6b65 7920 3d20 6e70          key = np
+0001f5b0: 2e61 7261 6e67 6528 302c 206c 656e 2870  .arange(0, len(p
+0001f5c0: 6f70 756c 6174 696f 6e29 290a 2020 2020  opulation)).    
+0001f5d0: 2020 2020 2020 2020 2020 2020 6c61 6265              labe
+0001f5e0: 6c20 3d20 4b4d 6561 6e73 286c 656e 2870  l = KMeans(len(p
+0001f5f0: 6f70 756c 6174 696f 6e29 202f 2f20 7365  opulation) // se
+0001f600: 6c66 2e63 6c65 6172 696e 675f 636c 7573  lf.clearing_clus
+0001f610: 7465 725f 7369 7a65 292e 6669 745f 7072  ter_size).fit_pr
+0001f620: 6564 6963 7428 616c 6c5f 6361 7365 5f76  edict(all_case_v
+0001f630: 616c 7565 7329 0a20 2020 2020 2020 2020  alues).         
+0001f640: 2020 2020 2020 2064 6620 3d20 7064 2e44         df = pd.D
+0001f650: 6174 6146 7261 6d65 286e 702e 6172 7261  ataFrame(np.arra
+0001f660: 7928 5b6b 6579 2c20 6c61 6265 6c2c 2073  y([key, label, s
+0001f670: 756d 5f66 6974 6e65 7373 5d29 2e54 2c20  um_fitness]).T, 
+0001f680: 636f 6c75 6d6e 733d 5b27 6b65 7927 2c20  columns=['key', 
+0001f690: 276c 6162 656c 272c 2027 6669 746e 6573  'label', 'fitnes
+0001f6a0: 7327 5d29 0a20 2020 2020 2020 2020 2020  s']).           
+0001f6b0: 2020 2020 2064 6620 3d20 6466 2e73 6f72       df = df.sor
+0001f6c0: 745f 7661 6c75 6573 2827 6669 746e 6573  t_values('fitnes
+0001f6d0: 7327 2c20 6173 6365 6e64 696e 673d 4661  s', ascending=Fa
+0001f6e0: 6c73 6529 2e64 726f 705f 6475 706c 6963  lse).drop_duplic
+0001f6f0: 6174 6573 285b 276c 6162 656c 275d 290a  ates(['label']).
+0001f700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f710: 706f 7075 6c61 7469 6f6e 203d 205b 706f  population = [po
+0001f720: 7075 6c61 7469 6f6e 5b69 6e74 286b 295d  pulation[int(k)]
+0001f730: 2066 6f72 206b 2069 6e20 6c69 7374 2864   for k in list(d
+0001f740: 665b 276b 6579 275d 295d 0a0a 2020 2020  f['key'])]..    
+0001f750: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0001f760: 6479 6e61 6d69 635f 7461 7267 6574 3a0a  dynamic_target:.
+0001f770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f780: 6265 7374 5f69 6e64 203d 2074 6f6f 6c62  best_ind = toolb
+0001f790: 6f78 2e63 6c6f 6e65 2870 6f70 756c 6174  ox.clone(populat
+0001f7a0: 696f 6e5b 6e70 2e61 7267 6d61 7828 5b78  ion[np.argmax([x
+0001f7b0: 2e66 6974 6e65 7373 2e77 7661 6c75 6573  .fitness.wvalues
+0001f7c0: 5b30 5d20 666f 7220 7820 696e 2070 6f70  [0] for x in pop
+0001f7d0: 756c 6174 696f 6e5d 295d 290a 2020 2020  ulation])]).    
+0001f7e0: 2020 2020 2020 2020 2020 2020 6465 6c20              del 
+0001f7f0: 6265 7374 5f69 6e64 2e66 6974 6e65 7373  best_ind.fitness
+0001f800: 2e76 616c 7565 730a 2020 2020 2020 2020  .values.        
+0001f810: 2020 2020 2020 2020 6e65 775f 6f66 6673          new_offs
+0001f820: 7072 696e 672e 6170 7065 6e64 2862 6573  pring.append(bes
+0001f830: 745f 696e 6429 0a0a 2020 2020 2020 2020  t_ind)..        
+0001f840: 2020 2020 6966 2073 656c 662e 626c 6f61      if self.bloa
+0001f850: 745f 636f 6e74 726f 6c20 6973 206e 6f74  t_control is not
+0001f860: 204e 6f6e 6520 616e 6420 7365 6c66 2e62   None and self.b
+0001f870: 6c6f 6174 5f63 6f6e 7472 6f6c 2e67 6574  loat_control.get
+0001f880: 2827 686f 6973 745f 6f6e 655f 6c61 7965  ('hoist_one_laye
+0001f890: 7227 2c20 4661 6c73 6529 3a0a 2020 2020  r', False):.    
+0001f8a0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0001f8b0: 6f20 696e 2070 6f70 756c 6174 696f 6e3a  o in population:
+0001f8c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f8d0: 2020 2020 2066 6f72 2067 656e 6520 696e       for gene in
+0001f8e0: 206f 2e67 656e 653a 0a20 2020 2020 2020   o.gene:.       
+0001f8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f900: 206e 756d 6265 725f 6f66 5f6c 6179 6572   number_of_layer
+0001f910: 203d 2073 656c 662e 626c 6f61 745f 636f   = self.bloat_co
+0001f920: 6e74 726f 6c2e 6765 7428 276e 756d 6265  ntrol.get('numbe
+0001f930: 725f 6f66 5f6c 6179 6572 272c 2031 290a  r_of_layer', 1).
 0001f940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f950: 2020 2020 2020 2020 2020 206f 2e63 6173             o.cas
-0001f960: 655f 7661 6c75 6573 203c 2077 6f72 7374  e_values < worst
-0001f970: 5f76 616c 7565 290a 2020 2020 2020 2020  _value).        
-0001f980: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0001f990: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001f9a0: 2020 2020 2020 2020 2020 6d63 7473 5f64            mcts_d
-0001f9b0: 6963 745b 2753 7572 7669 7661 6c20 4f70  ict['Survival Op
-0001f9c0: 6572 6174 6f72 7327 5d5b 315d 5b6f 2e73  erators'][1][o.s
-0001f9d0: 7572 7669 7661 6c5f 6f70 6572 6174 6f72  urvival_operator
-0001f9e0: 5f69 645d 202b 3d20 310a 2020 2020 2020  _id] += 1.      
-0001f9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fa00: 2020 6d63 7473 5f64 6963 745b 2753 656c    mcts_dict['Sel
-0001fa10: 6563 7469 6f6e 204f 7065 7261 746f 7273  ection Operators
-0001fa20: 275d 5b31 5d5b 6f2e 7365 6c65 6374 696f  '][1][o.selectio
-0001fa30: 6e5f 6f70 6572 6174 6f72 5d20 2b3d 2031  n_operator] += 1
-0001fa40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001fa50: 2020 2020 2073 656c 6563 7469 6f6e 5f63       selection_c
-0001fa60: 6f75 6e74 6572 5b6f 2e73 656c 6563 7469  ounter[o.selecti
-0001fa70: 6f6e 5f6f 7065 7261 746f 725d 202b 3d20  on_operator] += 
-0001fa80: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
-0001fa90: 2020 2020 2020 6765 6e65 5f63 6f75 6e74        gene_count
-0001faa0: 6572 5b6f 2e73 7572 7669 7661 6c5f 6f70  er[o.survival_op
-0001fab0: 6572 6174 6f72 5f69 645d 202b 3d20 310a  erator_id] += 1.
-0001fac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001fad0: 2069 6620 7365 6c66 2e76 6572 626f 7365   if self.verbose
+0001f950: 2020 2020 2020 2020 6c65 766c 655f 6765          levle_ge
+0001f960: 6e65 203d 206c 6973 7428 6669 6c74 6572  ne = list(filter
+0001f970: 286c 616d 6264 6120 673a 2067 2e6c 6576  (lambda g: g.lev
+0001f980: 656c 203c 3d20 6e75 6d62 6572 5f6f 665f  el <= number_of_
+0001f990: 6c61 7965 722c 2067 656e 6529 290a 2020  layer, gene)).  
+0001f9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f9b0: 2020 2020 2020 6265 7374 5f69 6420 3d20        best_id = 
+0001f9c0: 6d61 7828 5b28 6b2c 2067 6574 6174 7472  max([(k, getattr
+0001f9d0: 2867 2c20 2763 6f72 7227 2c20 3029 2920  (g, 'corr', 0)) 
+0001f9e0: 666f 7220 6b2c 2067 2069 6e20 656e 756d  for k, g in enum
+0001f9f0: 6572 6174 6528 6c65 766c 655f 6765 6e65  erate(levle_gene
+0001fa00: 295d 2c0a 2020 2020 2020 2020 2020 2020  )],.            
+0001fa10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fa20: 2020 2020 2020 2020 2020 6b65 793d 6c61            key=la
+0001fa30: 6d62 6461 2078 3a20 2878 5b31 5d2c 2078  mbda x: (x[1], x
+0001fa40: 5b30 5d29 295b 305d 0a20 2020 2020 2020  [0]))[0].       
+0001fa50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fa60: 2068 6f69 7374 4d75 7461 7469 6f6e 2867   hoistMutation(g
+0001fa70: 656e 652c 2062 6573 745f 6964 290a 0a20  ene, best_id).. 
+0001fa80: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+0001fa90: 6c66 2e62 6c6f 6174 5f63 6f6e 7472 6f6c  lf.bloat_control
+0001faa0: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
+0001fab0: 2073 656c 662e 626c 6f61 745f 636f 6e74   self.bloat_cont
+0001fac0: 726f 6c2e 6765 7428 2768 6f69 7374 5f6d  rol.get('hoist_m
+0001fad0: 7574 6174 696f 6e27 2c20 4661 6c73 6529  utation', False)
 0001fae0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001faf0: 2020 2020 2020 7072 696e 7428 7365 6c65        print(sele
-0001fb00: 6374 696f 6e5f 636f 756e 7465 722c 2067  ction_counter, g
-0001fb10: 656e 655f 636f 756e 7465 7229 0a0a 2020  ene_counter)..  
-0001fb20: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-0001fb30: 6465 203d 2073 656c 662e 6d61 625f 7061  de = self.mab_pa
-0001fb40: 7261 6d65 7465 722e 6765 7428 276d 6f64  rameter.get('mod
-0001fb50: 6527 2c20 2744 6563 6179 2729 0a20 2020  e', 'Decay').   
-0001fb60: 2020 2020 2020 2020 2020 2020 2023 2066               # f
-0001fb70: 6978 6564 2074 6872 6573 686f 6c64 0a20  ixed threshold. 
-0001fb80: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0001fb90: 6f72 206b 2c20 6461 7461 2069 6e20 6d63  or k, data in mc
-0001fba0: 7473 5f64 6963 742e 6974 656d 7328 293a  ts_dict.items():
-0001fbb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001fbc0: 2020 2020 2069 6620 6d6f 6465 203d 3d20       if mode == 
-0001fbd0: 2754 6872 6573 686f 6c64 273a 0a20 2020  'Threshold':.   
-0001fbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fbf0: 2020 2020 2023 2066 6978 6564 2074 6872       # fixed thr
-0001fc00: 6573 686f 6c64 0a20 2020 2020 2020 2020  eshold.         
-0001fc10: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0001fc20: 6f72 206f 7020 696e 2072 616e 6765 286c  or op in range(l
-0001fc30: 656e 2864 6174 615b 305d 2929 3a0a 2020  en(data[0])):.  
-0001fc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fc50: 2020 2020 2020 2020 2020 6966 2064 6174            if dat
-0001fc60: 615b 305d 5b6f 705d 202b 2064 6174 615b  a[0][op] + data[
-0001fc70: 315d 5b6f 705d 203e 2043 3a0a 2020 2020  1][op] > C:.    
-0001fc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fc90: 2020 2020 2020 2020 2020 2020 7375 6d5f              sum_
-0001fca0: 6461 7461 203d 2064 6174 615b 305d 5b6f  data = data[0][o
-0001fcb0: 705d 202b 2064 6174 615b 315d 5b6f 705d  p] + data[1][op]
-0001fcc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001fcd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fce0: 2064 6174 615b 305d 5b6f 705d 203d 2064   data[0][op] = d
-0001fcf0: 6174 615b 305d 5b6f 705d 202f 2073 756d  ata[0][op] / sum
-0001fd00: 5f64 6174 6120 2a20 430a 2020 2020 2020  _data * C.      
-0001fd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fd20: 2020 2020 2020 2020 2020 6461 7461 5b31            data[1
-0001fd30: 5d5b 6f70 5d20 3d20 6461 7461 5b31 5d5b  ][op] = data[1][
-0001fd40: 6f70 5d20 2f20 7375 6d5f 6461 7461 202a  op] / sum_data *
-0001fd50: 2043 0a20 2020 2020 2020 2020 2020 2020   C.             
-0001fd60: 2020 2020 2020 2069 6620 6d6f 6465 203d         if mode =
-0001fd70: 3d20 2744 6563 6179 273a 0a20 2020 2020  = 'Decay':.     
-0001fd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fd90: 2020 2064 6174 6120 2a3d 2073 656c 662e     data *= self.
-0001fda0: 6d61 625f 7061 7261 6d65 7465 725b 2764  mab_parameter['d
-0001fdb0: 6563 6179 5f72 6174 696f 275d 0a20 2020  ecay_ratio'].   
-0001fdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fdd0: 2023 2061 766f 6964 2074 7269 7669 616c   # avoid trivial
-0001fde0: 2073 6f6c 7574 696f 6e73 0a20 2020 2020   solutions.     
-0001fdf0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0001fe00: 6174 6120 3d20 6e70 2e63 6c69 7028 6461  ata = np.clip(da
-0001fe10: 7461 2c20 3165 2d32 2c20 4e6f 6e65 290a  ta, 1e-2, None).
-0001fe20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fe30: 2020 2020 6d63 7473 5f64 6963 745b 6b5d      mcts_dict[k]
-0001fe40: 203d 2064 6174 610a 2020 2020 2020 2020   = data.        
-0001fe50: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0001fe60: 7665 7262 6f73 653a 0a20 2020 2020 2020  verbose:.       
-0001fe70: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-0001fe80: 6e74 2827 4d43 5453 2052 6573 756c 7427  nt('MCTS Result'
-0001fe90: 2c20 6d63 7473 5f64 6963 7429 0a0a 2020  , mcts_dict)..  
-0001fea0: 2020 2020 2020 2020 2020 2320 5570 6461            # Upda
-0001feb0: 7465 2074 6865 2068 616c 6c20 6f66 2066  te the hall of f
-0001fec0: 616d 6520 7769 7468 2074 6865 2067 656e  ame with the gen
-0001fed0: 6572 6174 6564 2069 6e64 6976 6964 7561  erated individua
-0001fee0: 6c73 0a20 2020 2020 2020 2020 2020 2069  ls.            i
-0001fef0: 6620 7365 6c66 2e73 7461 6765 5f66 6c61  f self.stage_fla
-0001ff00: 673a 0a20 2020 2020 2020 2020 2020 2020  g:.             
-0001ff10: 2020 2070 7269 6e74 2827 5374 6172 7420     print('Start 
-0001ff20: 484f 4620 7570 6461 7469 6e67 2729 0a20  HOF updating'). 
-0001ff30: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-0001ff40: 6c66 2e64 796e 616d 6963 5f74 6172 6765  lf.dynamic_targe
-0001ff50: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
-0001ff60: 2020 2068 616c 6c6f 6666 616d 652e 636c     halloffame.cl
-0001ff70: 6561 7228 290a 2020 2020 2020 2020 2020  ear().          
-0001ff80: 2020 6966 2068 616c 6c6f 6666 616d 6520    if halloffame 
-0001ff90: 6973 206e 6f74 204e 6f6e 6520 616e 6420  is not None and 
-0001ffa0: 776f 7273 655f 6974 6572 6174 696f 6e73  worse_iterations
-0001ffb0: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
-0001ffc0: 2020 2020 2020 2068 616c 6c6f 6666 616d         halloffam
-0001ffd0: 652e 7570 6461 7465 286f 6666 7370 7269  e.update(offspri
-0001ffe0: 6e67 290a 2020 2020 2020 2020 2020 2020  ng).            
-0001fff0: 2020 2020 6966 2073 656c 662e 7665 7262      if self.verb
-00020000: 6f73 653a 0a20 2020 2020 2020 2020 2020  ose:.           
-00020010: 2020 2020 2020 2020 2064 6566 2072 6570           def rep
-00020020: 6c61 6365 2873 7329 3a0a 2020 2020 2020  lace(ss):.      
-00020030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020040: 2020 666f 7220 7320 696e 2072 616e 6765    for s in range
-00020050: 2873 656c 662e 6765 6e65 5f6e 756d 202b  (self.gene_num +
-00020060: 2073 656c 662e 582e 7368 6170 655b 315d   self.X.shape[1]
-00020070: 2c20 7365 6c66 2e58 2e73 6861 7065 5b31  , self.X.shape[1
-00020080: 5d20 2d20 312c 202d 3129 3a0a 2020 2020  ] - 1, -1):.    
-00020090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000200a0: 2020 2020 2020 2020 7373 203d 2073 732e          ss = ss.
-000200b0: 7265 706c 6163 6528 6627 4152 477b 737d  replace(f'ARG{s}
-000200c0: 272c 2066 2749 4e53 7b73 202d 2073 656c  ', f'INS{s - sel
-000200d0: 662e 582e 7368 6170 655b 315d 7d27 290a  f.X.shape[1]}').
-000200e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000200f0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00020100: 730a 0a20 2020 2020 2020 2020 2020 2020  s..             
-00020110: 2020 2020 2020 2070 7269 6e74 2827 5c6e         print('\n
-00020120: 272e 6a6f 696e 285b 7265 706c 6163 6528  '.join([replace(
-00020130: 7374 7228 6729 2920 666f 7220 6720 696e  str(g)) for g in
-00020140: 2068 616c 6c6f 6666 616d 655b 305d 2e67   halloffame[0].g
-00020150: 656e 655d 2929 0a20 2020 2020 2020 2020  ene])).         
-00020160: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
-00020170: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00020180: 2020 2020 6966 2073 656c 662e 7365 6d61      if self.sema
-00020190: 6e74 6963 5f72 6570 6169 7220 3e20 303a  ntic_repair > 0:
-000201a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000201b0: 2020 2020 2070 7269 6e74 2827 5375 6363       print('Succ
-000201c0: 6573 7366 756c 2052 6570 6169 7227 2c20  essful Repair', 
-000201d0: 7365 6c66 2e73 7563 6365 7373 6675 6c5f  self.successful_
-000201e0: 7265 7061 6972 202f 2028 7365 6c66 2e73  repair / (self.s
-000201f0: 7563 6365 7373 6675 6c5f 7265 7061 6972  uccessful_repair
-00020200: 202b 2073 656c 662e 6661 696c 6564 5f72   + self.failed_r
-00020210: 6570 6169 7229 290a 2020 2020 2020 2020  epair)).        
-00020220: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00020230: 6261 7369 635f 7072 696d 6974 6976 6573  basic_primitives
-00020240: 2021 3d20 274d 4c27 3a0a 2020 2020 2020   != 'ML':.      
-00020250: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00020260: 2073 656c 662e 6163 7469 7665 5f67 656e   self.active_gen
-00020270: 655f 6e75 6d20 3d3d 2030 3a0a 2020 2020  e_num == 0:.    
-00020280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020290: 2020 2020 7072 696e 7428 2755 6e69 7175      print('Uniqu
-000202a0: 6520 4861 7368 272c 205b 6c65 6e28 6e70  e Hash', [len(np
-000202b0: 2e75 6e69 7175 6528 5b6f 2e68 6173 685f  .unique([o.hash_
-000202c0: 7265 7375 6c74 5b69 5d20 666f 7220 6f20  result[i] for o 
-000202d0: 696e 206f 6666 7370 7269 6e67 5d29 290a  in offspring])).
-000202e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000202f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020300: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00020310: 7220 6920 696e 2072 616e 6765 2873 656c  r i in range(sel
-00020320: 662e 6765 6e65 5f6e 756d 295d 290a 2020  f.gene_num)]).  
-00020330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020340: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00020350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020360: 7072 696e 7428 2755 6e69 7175 6520 4861  print('Unique Ha
-00020370: 7368 272c 205b 6c65 6e28 6e70 2e75 6e69  sh', [len(np.uni
-00020380: 7175 6528 5b6f 2e68 6173 685f 7265 7375  que([o.hash_resu
-00020390: 6c74 5b69 5d20 666f 7220 6f20 696e 206f  lt[i] for o in o
-000203a0: 6666 7370 7269 6e67 5d29 290a 2020 2020  ffspring])).    
-000203b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000203c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000203d0: 2020 2020 2020 2020 2020 666f 7220 6920            for i 
-000203e0: 696e 2072 616e 6765 2873 656c 662e 6163  in range(self.ac
-000203f0: 7469 7665 5f67 656e 655f 6e75 6d29 5d29  tive_gene_num)])
-00020400: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00020410: 2069 6620 7365 6c66 2e62 6173 655f 6c65   if self.base_le
-00020420: 6172 6e65 7220 3d3d 2027 4c61 7373 6f27  arner == 'Lasso'
-00020430: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00020440: 2020 2020 2020 6c61 7373 6f5f 7061 7261        lasso_para
-00020450: 6d65 7465 7220 3d20 5b6f 2e70 6172 616d  meter = [o.param
-00020460: 6574 6572 735b 274c 6173 736f 275d 2066  eters['Lasso'] f
-00020470: 6f72 206f 2069 6e20 6f66 6673 7072 696e  or o in offsprin
-00020480: 675d 0a20 2020 2020 2020 2020 2020 2020  g].             
-00020490: 2020 2020 2020 2070 7269 6e74 2827 4176         print('Av
-000204a0: 6572 6167 6520 4c61 7373 6f27 2c20 6e70  erage Lasso', np
-000204b0: 2e6d 6561 6e28 6c61 7373 6f5f 7061 7261  .mean(lasso_para
-000204c0: 6d65 7465 7229 2c0a 2020 2020 2020 2020  meter),.        
-000204d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000204e0: 2020 6e70 2e6d 6178 286c 6173 736f 5f70    np.max(lasso_p
-000204f0: 6172 616d 6574 6572 292c 206e 702e 6d69  arameter), np.mi
-00020500: 6e28 6c61 7373 6f5f 7061 7261 6d65 7465  n(lasso_paramete
-00020510: 7229 290a 2020 2020 2020 2020 2020 2020  r)).            
-00020520: 2020 2020 2020 2020 6e6f 6e5f 7a65 726f          non_zero
-00020530: 5f66 6561 7475 7265 7320 3d20 5b6e 702e  _features = [np.
-00020540: 7375 6d28 6f2e 636f 6566 2021 3d20 3029  sum(o.coef != 0)
-00020550: 2066 6f72 206f 2069 6e20 6f66 6673 7072   for o in offspr
-00020560: 696e 675d 0a20 2020 2020 2020 2020 2020  ing].           
-00020570: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-00020580: 4176 6572 6167 6520 5365 6c65 6374 6564  Average Selected
-00020590: 2046 6561 7475 7265 7327 2c20 6e70 2e6d   Features', np.m
-000205a0: 6561 6e28 6e6f 6e5f 7a65 726f 5f66 6561  ean(non_zero_fea
-000205b0: 7475 7265 7329 2c0a 2020 2020 2020 2020  tures),.        
-000205c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000205d0: 2020 6e70 2e6d 6178 286e 6f6e 5f7a 6572    np.max(non_zer
-000205e0: 6f5f 6665 6174 7572 6573 292c 206e 702e  o_features), np.
-000205f0: 6d69 6e28 6e6f 6e5f 7a65 726f 5f66 6561  min(non_zero_fea
-00020600: 7475 7265 7329 290a 0a20 2020 2020 2020  tures))..       
-00020610: 2020 2020 2069 6620 7365 6c66 2e73 7461       if self.sta
-00020620: 6765 5f66 6c61 673a 0a20 2020 2020 2020  ge_flag:.       
-00020630: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-00020640: 5374 6f70 2048 4f46 2075 7064 6174 696e  Stop HOF updatin
-00020650: 6727 290a 0a20 2020 2020 2020 2020 2020  g')..           
-00020660: 2069 6620 2767 6c6f 6261 6c27 2069 6e20   if 'global' in 
-00020670: 7365 6c66 2e6d 7574 6174 696f 6e5f 7363  self.mutation_sc
-00020680: 6865 6d65 206f 7220 2765 7874 7265 6d65  heme or 'extreme
-00020690: 2720 696e 2073 656c 662e 6d75 7461 7469  ' in self.mutati
-000206a0: 6f6e 5f73 6368 656d 653a 0a20 2020 2020  on_scheme:.     
-000206b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000206c0: 636f 6e73 7472 7563 745f 676c 6f62 616c  construct_global
-000206d0: 5f66 6561 7475 7265 5f70 6f6f 6c28 706f  _feature_pool(po
-000206e0: 7075 6c61 7469 6f6e 290a 2020 2020 2020  pulation).      
-000206f0: 2020 2020 2020 7365 6c66 2e61 7070 656e        self.appen
-00020700: 645f 6576 616c 7561 7465 645f 6665 6174  d_evaluated_feat
-00020710: 7572 6573 286f 6666 7370 7269 6e67 290a  ures(offspring).
-00020720: 0a20 2020 2020 2020 2020 2020 2062 6573  .            bes
-00020730: 745f 6669 746e 6573 7320 3d20 6e70 2e6d  t_fitness = np.m
-00020740: 6178 285b 696e 642e 6669 746e 6573 732e  ax([ind.fitness.
-00020750: 7776 616c 7565 735b 305d 2066 6f72 2069  wvalues[0] for i
-00020760: 6e64 2069 6e20 6f66 6673 7072 696e 675d  nd in offspring]
-00020770: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-00020780: 2073 656c 662e 7061 7261 6d2e 6765 7428   self.param.get(
-00020790: 2772 6563 6f72 645f 7472 6169 6e69 6e67  'record_training
-000207a0: 5f64 6174 6127 2c20 4661 6c73 6529 3a0a  _data', False):.
-000207b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000207c0: 7365 6c66 2e62 6573 745f 6669 746e 6573  self.best_fitnes
-000207d0: 735f 6869 7374 6f72 792e 6170 7065 6e64  s_history.append
-000207e0: 2862 6573 745f 6669 746e 6573 7329 0a20  (best_fitness). 
-000207f0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00020800: 6c66 2e64 6976 6572 7369 7479 5f73 6561  lf.diversity_sea
-00020810: 7263 6820 213d 2027 4e6f 6e65 273a 0a20  rch != 'None':. 
-00020820: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00020830: 656c 662e 6469 7665 7273 6974 795f 6173  elf.diversity_as
-00020840: 7369 676e 6d65 6e74 286f 6666 7370 7269  signment(offspri
-00020850: 6e67 290a 0a20 2020 2020 2020 2020 2020  ng)..           
-00020860: 2023 206d 756c 7469 6f62 6a65 6374 6976   # multiobjectiv
-00020870: 6520 4750 2062 6173 6564 206f 6e20 6669  e GP based on fi
-00020880: 746e 6573 732d 7369 7a65 0a20 2020 2020  tness-size.     
-00020890: 2020 2020 2020 2069 6620 7365 6c66 2e73         if self.s
-000208a0: 656c 6563 7420 3d3d 2027 4175 746f 2d4d  elect == 'Auto-M
-000208b0: 4354 5327 3a0a 2020 2020 2020 2020 2020  CTS':.          
-000208c0: 2020 2020 2020 666f 7220 696e 6420 696e        for ind in
-000208d0: 206f 6666 7370 7269 6e67 202b 206e 7367   offspring + nsg
-000208e0: 615f 6172 6368 6976 6520 2b20 6166 705f  a_archive + afp_
-000208f0: 6172 6368 6976 6520 2b20 6265 7374 5f61  archive + best_a
-00020900: 7263 6869 7665 3a0a 2020 2020 2020 2020  rchive:.        
-00020910: 2020 2020 2020 2020 2020 2020 7365 7461              seta
-00020920: 7474 7228 696e 642c 2027 6f72 6967 696e  ttr(ind, 'origin
-00020930: 616c 5f66 6974 6e65 7373 272c 2069 6e64  al_fitness', ind
-00020940: 2e66 6974 6e65 7373 2e76 616c 7565 7329  .fitness.values)
-00020950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00020960: 2020 2020 2069 6e64 2e66 6974 6e65 7373       ind.fitness
-00020970: 2e77 6569 6768 7473 203d 2028 2d31 2c20  .weights = (-1, 
-00020980: 2d31 290a 2020 2020 2020 2020 2020 2020  -1).            
-00020990: 2020 2020 2020 2020 696e 642e 6669 746e          ind.fitn
-000209a0: 6573 732e 7661 6c75 6573 203d 205b 696e  ess.values = [in
-000209b0: 642e 6669 746e 6573 732e 7661 6c75 6573  d.fitness.values
-000209c0: 5b30 5d2c 2073 756d 285b 6c65 6e28 7829  [0], sum([len(x)
-000209d0: 2066 6f72 2078 2069 6e20 696e 642e 6765   for x in ind.ge
-000209e0: 6e65 5d29 5d0a 2020 2020 2020 2020 2020  ne])].          
-000209f0: 2020 2020 2020 6e73 6761 5f61 7263 6869        nsga_archi
-00020a00: 7665 203d 2073 656c 4e53 4741 3228 6f66  ve = selNSGA2(of
-00020a10: 6673 7072 696e 6720 2b20 6e73 6761 5f61  fspring + nsga_a
-00020a20: 7263 6869 7665 2c20 6c65 6e28 706f 7075  rchive, len(popu
-00020a30: 6c61 7469 6f6e 2929 0a20 2020 2020 2020  lation)).       
-00020a40: 2020 2020 2020 2020 2062 6573 745f 6172           best_ar
-00020a50: 6368 6976 6520 3d20 7365 6c42 6573 7428  chive = selBest(
-00020a60: 6f66 6673 7072 696e 6720 2b20 6265 7374  offspring + best
-00020a70: 5f61 7263 6869 7665 2c20 6c65 6e28 706f  _archive, len(po
-00020a80: 7075 6c61 7469 6f6e 2929 0a20 2020 2020  pulation)).     
-00020a90: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-00020aa0: 6e64 2069 6e20 6f66 6673 7072 696e 673a  nd in offspring:
-00020ab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00020ac0: 2020 2020 2069 6e64 2e61 6765 203d 2030       ind.age = 0
-00020ad0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00020ae0: 2020 2020 2069 6e64 2e66 6974 6e65 7373       ind.fitness
-00020af0: 2e76 616c 7565 7320 3d20 5b69 6e64 2e66  .values = [ind.f
-00020b00: 6974 6e65 7373 2e76 616c 7565 735b 305d  itness.values[0]
-00020b10: 2c20 696e 642e 6167 655d 0a20 2020 2020  , ind.age].     
-00020b20: 2020 2020 2020 2020 2020 2023 206d 756c             # mul
-00020b30: 7469 6f62 6a65 6374 6976 6520 4750 2062  tiobjective GP b
-00020b40: 6173 6564 206f 6e20 6167 652d 6669 746e  ased on age-fitn
-00020b50: 6573 730a 2020 2020 2020 2020 2020 2020  ess.            
-00020b60: 2020 2020 666f 7220 696e 6420 696e 206e      for ind in n
-00020b70: 7367 615f 6172 6368 6976 6520 2b20 6166  sga_archive + af
-00020b80: 705f 6172 6368 6976 6520 2b20 6265 7374  p_archive + best
-00020b90: 5f61 7263 6869 7665 3a0a 2020 2020 2020  _archive:.      
-00020ba0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00020bb0: 2068 6173 6174 7472 2869 6e64 2c20 2761   hasattr(ind, 'a
-00020bc0: 6765 2729 3a0a 2020 2020 2020 2020 2020  ge'):.          
-00020bd0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-00020be0: 642e 6167 6520 2b3d 2031 0a20 2020 2020  d.age += 1.     
-00020bf0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00020c00: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00020c10: 2020 2020 2020 2020 2020 2020 2069 6e64               ind
-00020c20: 2e61 6765 203d 2030 0a20 2020 2020 2020  .age = 0.       
-00020c30: 2020 2020 2020 2020 2020 2020 2069 6e64               ind
-00020c40: 2e66 6974 6e65 7373 2e76 616c 7565 7320  .fitness.values 
-00020c50: 3d20 5b69 6e64 2e66 6974 6e65 7373 2e76  = [ind.fitness.v
-00020c60: 616c 7565 735b 305d 2c20 696e 642e 6167  alues[0], ind.ag
-00020c70: 655d 0a20 2020 2020 2020 2020 2020 2020  e].             
-00020c80: 2020 2061 6670 5f61 7263 6869 7665 203d     afp_archive =
-00020c90: 2073 656c 4e53 4741 3228 6f66 6673 7072   selNSGA2(offspr
-00020ca0: 696e 6720 2b20 6166 705f 6172 6368 6976  ing + afp_archiv
-00020cb0: 652c 206c 656e 2870 6f70 756c 6174 696f  e, len(populatio
-00020cc0: 6e29 290a 2020 2020 2020 2020 2020 2020  n)).            
-00020cd0: 2020 2020 666f 7220 696e 6420 696e 206f      for ind in o
-00020ce0: 6666 7370 7269 6e67 202b 206e 7367 615f  ffspring + nsga_
-00020cf0: 6172 6368 6976 6520 2b20 6166 705f 6172  archive + afp_ar
-00020d00: 6368 6976 6520 2b20 6265 7374 5f61 7263  chive + best_arc
-00020d10: 6869 7665 3a0a 2020 2020 2020 2020 2020  hive:.          
-00020d20: 2020 2020 2020 2020 2020 696e 642e 6669            ind.fi
-00020d30: 746e 6573 732e 7765 6967 6874 7320 3d20  tness.weights = 
-00020d40: 282d 312c 290a 2020 2020 2020 2020 2020  (-1,).          
-00020d50: 2020 2020 2020 2020 2020 696e 642e 6669            ind.fi
-00020d60: 746e 6573 732e 7661 6c75 6573 203d 2067  tness.values = g
-00020d70: 6574 6174 7472 2869 6e64 2c20 276f 7269  etattr(ind, 'ori
-00020d80: 6769 6e61 6c5f 6669 746e 6573 7327 290a  ginal_fitness').
-00020d90: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00020da0: 662e 7265 6475 6e64 616e 745f 6665 6174  f.redundant_feat
-00020db0: 7572 6573 5f63 616c 6375 6c61 7469 6f6e  ures_calculation
-00020dc0: 286f 6666 7370 7269 6e67 290a 2020 2020  (offspring).    
-00020dd0: 2020 2020 2020 2020 2320 5265 706c 6163          # Replac
-00020de0: 6520 7468 6520 6375 7272 656e 7420 706f  e the current po
-00020df0: 7075 6c61 7469 6f6e 2062 7920 7468 6520  pulation by the 
-00020e00: 6f66 6673 7072 696e 670a 2020 2020 2020  offspring.      
-00020e10: 2020 2020 2020 7365 6c66 2e73 7572 7669        self.survi
-00020e20: 7661 6c5f 7365 6c65 6374 696f 6e28 6765  val_selection(ge
-00020e30: 6e2c 2070 6f70 756c 6174 696f 6e2c 206f  n, population, o
-00020e40: 6666 7370 7269 6e67 290a 2020 2020 2020  ffspring).      
-00020e50: 2020 2020 2020 7365 6c66 2e75 7064 6174        self.updat
-00020e60: 655f 7365 6d61 6e74 6963 5f72 6570 6169  e_semantic_repai
-00020e70: 725f 696e 7075 745f 6d61 7472 6978 2870  r_input_matrix(p
-00020e80: 6f70 756c 6174 696f 6e29 0a20 2020 2020  opulation).     
-00020e90: 2020 2020 2020 2065 7874 6572 6e61 6c5f         external_
-00020ea0: 6172 6368 6976 6520 3d20 7365 6c66 2e75  archive = self.u
-00020eb0: 7064 6174 655f 6578 7465 726e 616c 5f61  pdate_external_a
-00020ec0: 7263 6869 7665 2870 6f70 756c 6174 696f  rchive(populatio
-00020ed0: 6e2c 2065 7874 6572 6e61 6c5f 6172 6368  n, external_arch
-00020ee0: 6976 6529 0a0a 2020 2020 2020 2020 2020  ive)..          
-00020ef0: 2020 2320 4170 7065 6e64 2074 6865 2063    # Append the c
-00020f00: 7572 7265 6e74 2067 656e 6572 6174 696f  urrent generatio
-00020f10: 6e20 7374 6174 6973 7469 6373 2074 6f20  n statistics to 
-00020f20: 7468 6520 6c6f 6762 6f6f 6b0a 2020 2020  the logbook.    
-00020f30: 2020 2020 2020 2020 7265 636f 7264 203d          record =
-00020f40: 2073 7461 7473 2e63 6f6d 7069 6c65 2870   stats.compile(p
-00020f50: 6f70 756c 6174 696f 6e29 2069 6620 7374  opulation) if st
-00020f60: 6174 7320 656c 7365 207b 7d0a 2020 2020  ats else {}.    
-00020f70: 2020 2020 2020 2020 6c6f 6762 6f6f 6b2e          logbook.
-00020f80: 7265 636f 7264 2867 656e 3d67 656e 2c20  record(gen=gen, 
-00020f90: 6e65 7661 6c73 3d6c 656e 2869 6e76 616c  nevals=len(inval
-00020fa0: 6964 5f69 6e64 292c 202a 2a72 6563 6f72  id_ind), **recor
-00020fb0: 6429 0a20 2020 2020 2020 2020 2020 2069  d).            i
-00020fc0: 6620 7665 7262 6f73 653a 0a20 2020 2020  f verbose:.     
-00020fd0: 2020 2020 2020 2020 2020 2023 2073 656c             # sel
-00020fe0: 662e 7065 6172 736f 6e5f 636f 7272 656c  f.pearson_correl
-00020ff0: 6174 696f 6e5f 616e 616c 7973 6973 2870  ation_analysis(p
-00021000: 6f70 756c 6174 696f 6e29 0a20 2020 2020  opulation).     
-00021010: 2020 2020 2020 2020 2020 2023 2073 656c             # sel
-00021020: 662e 7065 6172 736f 6e5f 636f 7272 656c  f.pearson_correl
-00021030: 6174 696f 6e5f 616e 616c 7973 6973 5f70  ation_analysis_p
-00021040: 6169 7273 2870 6f70 756c 6174 696f 6e29  airs(population)
-00021050: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021060: 2066 6561 7475 7265 7320 3d20 7365 7428   features = set(
-00021070: 6368 6169 6e2e 6672 6f6d 5f69 7465 7261  chain.from_itera
-00021080: 626c 6528 6c69 7374 286d 6170 286c 616d  ble(list(map(lam
-00021090: 6264 6120 783a 205b 7374 7228 7929 2066  bda x: [str(y) f
-000210a0: 6f72 2079 2069 6e20 782e 6765 6e65 5d2c  or y in x.gene],
-000210b0: 2070 6f70 756c 6174 696f 6e29 2929 290a   population)))).
-000210c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000210d0: 2320 6665 6174 7572 6573 203d 2073 6574  # features = set
-000210e0: 2863 6861 696e 2e66 726f 6d5f 6974 6572  (chain.from_iter
-000210f0: 6162 6c65 286c 6973 7428 6d61 7028 6c61  able(list(map(la
-00021100: 6d62 6461 2078 3a20 5b73 7472 2879 2920  mbda x: [str(y) 
-00021110: 666f 7220 7920 696e 2078 2e67 656e 655d  for y in x.gene]
-00021120: 2c20 7365 6c66 2e68 6f66 2929 2929 0a20  , self.hof)))). 
-00021130: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00021140: 7269 6e74 2827 6e75 6d62 6572 206f 6620  rint('number of 
-00021150: 6665 6174 7572 6573 272c 206c 656e 2866  features', len(f
-00021160: 6561 7475 7265 7329 290a 2020 2020 2020  eatures)).      
-00021170: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00021180: 2761 7263 6869 7665 2073 697a 6527 2c20  'archive size', 
-00021190: 6c65 6e28 7365 6c66 2e68 6f66 2929 0a20  len(self.hof)). 
-000211a0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-000211b0: 7269 6e74 2827 4176 6572 6167 6520 4e75  rint('Average Nu
-000211c0: 6d62 6572 206f 6620 4163 7469 7665 2047  mber of Active G
-000211d0: 656e 6573 272c 206e 702e 6d65 616e 285b  enes', np.mean([
-000211e0: 696e 642e 7061 7261 6d65 7465 7273 5b27  ind.parameters['
-000211f0: 4163 7469 7665 4765 6e65 275d 2066 6f72  ActiveGene'] for
-00021200: 2069 6e64 2069 6e20 706f 7075 6c61 7469   ind in populati
-00021210: 6f6e 5d29 290a 2020 2020 2020 2020 2020  on])).          
-00021220: 2020 2020 2020 2320 7072 696e 7428 275c        # print('\
-00021230: 6e27 2e6a 6f69 6e28 6d61 7028 6c61 6d62  n'.join(map(lamb
-00021240: 6461 2078 3a20 7374 7228 7829 2c20 706f  da x: str(x), po
-00021250: 7075 6c61 7469 6f6e 2929 290a 2020 2020  pulation))).    
-00021260: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00021270: 7428 6c6f 6762 6f6f 6b2e 7374 7265 616d  t(logbook.stream
-00021280: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00021290: 2020 6966 2073 656c 662e 6261 7365 5f6d    if self.base_m
-000212a0: 6f64 656c 5f6c 6973 7420 213d 204e 6f6e  odel_list != Non
-000212b0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000212c0: 2020 2020 2020 206d 6f64 656c 5f64 6963         model_dic
-000212d0: 7420 3d20 6465 6661 756c 7464 6963 7428  t = defaultdict(
-000212e0: 696e 7429 0a20 2020 2020 2020 2020 2020  int).           
-000212f0: 2020 2020 2020 2020 2066 6f72 2070 2069           for p i
-00021300: 6e20 706f 7075 6c61 7469 6f6e 3a0a 2020  n population:.  
-00021310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021320: 2020 2020 2020 6d6f 6465 6c5f 6469 6374        model_dict
-00021330: 5b70 2e62 6173 655f 6d6f 6465 6c5d 202b  [p.base_model] +
-00021340: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
-00021350: 2020 2020 2020 2020 7072 696e 7428 2750          print('P
-00021360: 6f70 756c 6174 696f 6e27 2c20 6d6f 6465  opulation', mode
-00021370: 6c5f 6469 6374 290a 2020 2020 2020 2020  l_dict).        
-00021380: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-00021390: 6c5f 6469 6374 203d 2064 6566 6175 6c74  l_dict = default
-000213a0: 6469 6374 2869 6e74 290a 2020 2020 2020  dict(int).      
-000213b0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-000213c0: 7220 7020 696e 2073 656c 662e 686f 663a  r p in self.hof:
-000213d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000213e0: 2020 2020 2020 2020 206d 6f64 656c 5f64           model_d
-000213f0: 6963 745b 702e 6261 7365 5f6d 6f64 656c  ict[p.base_model
-00021400: 5d20 2b3d 2031 0a20 2020 2020 2020 2020  ] += 1.         
-00021410: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00021420: 2827 4861 6c6c 206f 6620 6661 6d65 272c  ('Hall of fame',
-00021430: 206d 6f64 656c 5f64 6963 7429 0a0a 2020   model_dict)..  
-00021440: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00021450: 662e 6561 726c 795f 7374 6f70 203e 2030  f.early_stop > 0
-00021460: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00021470: 2020 6375 7272 656e 745f 6265 7374 5f66    current_best_f
-00021480: 6974 6e65 7373 203d 206e 702e 6d61 7828  itness = np.max(
-00021490: 5b69 6e64 2e66 6974 6e65 7373 2e77 7661  [ind.fitness.wva
-000214a0: 6c75 6573 5b30 5d20 666f 7220 696e 6420  lues[0] for ind 
-000214b0: 696e 2070 6f70 756c 6174 696f 6e5d 290a  in population]).
-000214c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000214d0: 6966 2068 6973 746f 7269 6361 6c5f 6265  if historical_be
-000214e0: 7374 5f66 6974 6e65 7373 203c 2063 7572  st_fitness < cur
-000214f0: 7265 6e74 5f62 6573 745f 6669 746e 6573  rent_best_fitnes
-00021500: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-00021510: 2020 2020 2020 2068 6973 746f 7269 6361         historica
-00021520: 6c5f 6265 7374 5f66 6974 6e65 7373 203d  l_best_fitness =
-00021530: 2063 7572 7265 6e74 5f62 6573 745f 6669   current_best_fi
-00021540: 746e 6573 730a 2020 2020 2020 2020 2020  tness.          
-00021550: 2020 2020 2020 2020 2020 6e6f 5f69 6d70            no_imp
-00021560: 726f 7665 6d65 6e74 5f69 7465 7261 7469  rovement_iterati
-00021570: 6f6e 203d 2030 0a20 2020 2020 2020 2020  on = 0.         
-00021580: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00021590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000215a0: 206e 6f5f 696d 7072 6f76 656d 656e 745f   no_improvement_
-000215b0: 6974 6572 6174 696f 6e20 2b3d 2031 0a20  iteration += 1. 
-000215c0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000215d0: 6620 6e6f 5f69 6d70 726f 7665 6d65 6e74  f no_improvement
-000215e0: 5f69 7465 7261 7469 6f6e 203e 2073 656c  _iteration > sel
-000215f0: 662e 6561 726c 795f 7374 6f70 3a0a 2020  f.early_stop:.  
-00021600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021610: 2020 6272 6561 6b0a 0a20 2020 2020 2020    break..       
-00021620: 2020 2020 2073 656c 662e 7374 6174 6973       self.statis
-00021630: 7469 6361 6c5f 7265 7375 6c74 5f75 7064  tical_result_upd
-00021640: 6174 6528 706f 7075 6c61 7469 6f6e 2c20  ate(population, 
-00021650: 7665 7262 6f73 6529 0a20 2020 2020 2020  verbose).       
-00021660: 2020 2020 2073 656c 662e 6361 6c6c 6261       self.callba
-00021670: 636b 2829 0a20 2020 2020 2020 2061 7373  ck().        ass
-00021680: 6572 7420 6e75 6d62 6572 5f6f 665f 6576  ert number_of_ev
-00021690: 616c 7561 7469 6f6e 7320 3d3d 2074 6f74  aluations == tot
-000216a0: 616c 5f65 7661 6c75 6174 696f 6e73 0a0a  al_evaluations..
-000216b0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-000216c0: 6561 726c 795f 7374 6f70 203e 2030 3a0a  early_stop > 0:.
-000216d0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-000216e0: 7428 2766 696e 616c 2067 656e 6572 6174  t('final generat
-000216f0: 696f 6e27 2c20 7365 6c66 2e63 7572 7265  ion', self.curre
-00021700: 6e74 5f67 656e 290a 2020 2020 2020 2020  nt_gen).        
-00021710: 6966 2076 6572 626f 7365 3a0a 2020 2020  if verbose:.    
-00021720: 2020 2020 2020 2020 7072 696e 7428 2746          print('F
-00021730: 696e 616c 2045 6e73 656d 626c 6520 5369  inal Ensemble Si
-00021740: 7a65 272c 206c 656e 2873 656c 662e 686f  ze', len(self.ho
-00021750: 6629 290a 2020 2020 2020 2020 6966 2073  f)).        if s
-00021760: 656c 662e 6e5f 7072 6f63 6573 7320 3e20  elf.n_process > 
-00021770: 313a 0a20 2020 2020 2020 2020 2020 2073  1:.            s
-00021780: 656c 662e 706f 6f6c 2e63 6c6f 7365 2829  elf.pool.close()
-00021790: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-000217a0: 6e6f 7420 7365 6c66 2e62 6173 655f 6c65  not self.base_le
-000217b0: 6172 6e65 722e 7374 6172 7473 7769 7468  arner.startswith
-000217c0: 2827 4661 7374 2d27 290a 2020 2020 2020  ('Fast-').      
-000217d0: 2020 7265 7475 726e 2070 6f70 756c 6174    return populat
-000217e0: 696f 6e2c 206c 6f67 626f 6f6b 0a0a 2020  ion, logbook..  
-000217f0: 2020 6465 6620 7468 7265 6164 5f70 6f6f    def thread_poo
-00021800: 6c5f 696e 6974 6961 6c69 7a61 7469 6f6e  l_initialization
-00021810: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00021820: 6f74 6865 725f 7061 7261 6d65 7465 7273  other_parameters
-00021830: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-00021840: 2027 6e6e 5f70 7265 6469 6374 696f 6e27   'nn_prediction'
-00021850: 3a20 7365 6c66 2e6e 6e5f 7072 6564 6963  : self.nn_predic
-00021860: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
-00021870: 2020 2764 796e 616d 6963 5f74 6172 6765    'dynamic_targe
-00021880: 7427 3a20 7365 6c66 2e64 796e 616d 6963  t': self.dynamic
-00021890: 5f74 6172 6765 742c 0a20 2020 2020 2020  _target,.       
-000218a0: 2020 2020 2027 6376 5f6c 6162 656c 273a       'cv_label':
-000218b0: 2073 656c 662e 7073 5f74 7265 655f 6376   self.ps_tree_cv
-000218c0: 5f6c 6162 656c 2c0a 2020 2020 2020 2020  _label,.        
-000218d0: 2020 2020 276f 7269 6769 6e61 6c5f 6665      'original_fe
-000218e0: 6174 7572 6573 273a 2073 656c 662e 6f72  atures': self.or
-000218f0: 6967 696e 616c 5f66 6561 7475 7265 732c  iginal_features,
-00021900: 0a20 2020 2020 2020 2020 2020 2027 7465  .            'te
-00021910: 7374 5f64 6174 615f 7369 7a65 273a 2073  st_data_size': s
-00021920: 656c 662e 7465 7374 5f64 6174 615f 7369  elf.test_data_si
-00021930: 7a65 2c0a 2020 2020 2020 2020 2020 2020  ze,.            
-00021940: 2770 7365 7427 3a20 7365 6c66 2e70 7365  'pset': self.pse
-00021950: 742c 0a20 2020 2020 2020 2020 2020 2027  t,.            '
-00021960: 736b 6c65 6172 6e5f 666f 726d 6174 273a  sklearn_format':
-00021970: 2073 656c 662e 6261 7369 635f 7072 696d   self.basic_prim
-00021980: 6974 6976 6573 203d 3d20 274d 4c27 2c0a  itives == 'ML',.
-00021990: 2020 2020 2020 2020 2020 2020 2763 726f              'cro
-000219a0: 7373 5f76 616c 6964 6174 696f 6e27 3a20  ss_validation': 
-000219b0: 7365 6c66 2e63 726f 7373 5f76 616c 6964  self.cross_valid
-000219c0: 6174 696f 6e2c 0a20 2020 2020 2020 2020  ation,.         
-000219d0: 2020 2027 6665 6174 7572 655f 696d 706f     'feature_impo
-000219e0: 7274 616e 6365 5f6d 6574 686f 6427 3a20  rtance_method': 
-000219f0: 7365 6c66 2e66 6561 7475 7265 5f69 6d70  self.feature_imp
-00021a00: 6f72 7461 6e63 655f 6d65 7468 6f64 2c0a  ortance_method,.
-00021a10: 2020 2020 2020 2020 2020 2020 2766 696c              'fil
-00021a20: 7465 725f 656c 696d 696e 6174 696f 6e27  ter_elimination'
-00021a30: 3a20 7365 6c66 2e66 696c 7465 725f 656c  : self.filter_el
-00021a40: 696d 696e 6174 696f 6e2c 0a20 2020 2020  imination,.     
-00021a50: 2020 2020 2020 2027 7665 7262 6f73 6527         'verbose'
-00021a60: 3a20 7365 6c66 2e76 6572 626f 7365 2c0a  : self.verbose,.
-00021a70: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-00021a80: 2020 6172 6720 3d20 2873 656c 662e 582c    arg = (self.X,
-00021a90: 2073 656c 662e 792c 2073 656c 662e 7363   self.y, self.sc
-00021aa0: 6f72 655f 6675 6e63 2c20 7365 6c66 2e63  ore_func, self.c
-00021ab0: 762c 206f 7468 6572 5f70 6172 616d 6574  v, other_paramet
-00021ac0: 6572 7329 0a20 2020 2020 2020 2023 2070  ers).        # p
-00021ad0: 6f6f 6c20 696e 6974 6961 6c69 7a61 7469  ool initializati
-00021ae0: 6f6e 0a20 2020 2020 2020 2069 6620 7365  on.        if se
-00021af0: 6c66 2e6e 5f70 726f 6365 7373 203e 2031  lf.n_process > 1
-00021b00: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00021b10: 6c66 2e70 6f6f 6c20 3d20 506f 6f6c 2873  lf.pool = Pool(s
-00021b20: 656c 662e 6e5f 7072 6f63 6573 732c 2069  elf.n_process, i
-00021b30: 6e69 7469 616c 697a 6572 3d69 6e69 745f  nitializer=init_
-00021b40: 776f 726b 6572 2c20 696e 6974 6172 6773  worker, initargs
-00021b50: 3d28 6361 6c63 756c 6174 655f 7363 6f72  =(calculate_scor
-00021b60: 652c 2061 7267 2929 0a20 2020 2020 2020  e, arg)).       
-00021b70: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00021b80: 2020 2069 6e69 745f 776f 726b 6572 2863     init_worker(c
-00021b90: 616c 6375 6c61 7465 5f73 636f 7265 2c20  alculate_score, 
-00021ba0: 6172 6729 0a0a 2020 2020 6465 6620 7365  arg)..    def se
-00021bb0: 6d61 6e74 6963 5f72 6570 6169 725f 6665  mantic_repair_fe
-00021bc0: 6174 7572 6573 2873 656c 662c 206f 6666  atures(self, off
-00021bd0: 7370 7269 6e67 2c20 6578 7465 726e 616c  spring, external
-00021be0: 5f61 7263 6869 7665 293a 0a20 2020 2020  _archive):.     
-00021bf0: 2020 2063 6f73 5f73 696d 203d 206c 616d     cos_sim = lam
-00021c00: 6264 6120 612c 2062 3a20 6e70 2e64 6f74  bda a, b: np.dot
-00021c10: 2861 2c20 6229 202f 2028 6e70 2e6c 696e  (a, b) / (np.lin
-00021c20: 616c 672e 6e6f 726d 2861 2920 2a20 6e70  alg.norm(a) * np
-00021c30: 2e6c 696e 616c 672e 6e6f 726d 2862 2929  .linalg.norm(b))
-00021c40: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-00021c50: 2e73 656d 616e 7469 635f 7265 7061 6972  .semantic_repair
-00021c60: 203e 2030 3a0a 2020 2020 2020 2020 2020   > 0:.          
-00021c70: 2020 666f 7220 6f20 696e 206f 6666 7370    for o in offsp
-00021c80: 7269 6e67 3a0a 2020 2020 2020 2020 2020  ring:.          
-00021c90: 2020 2020 2020 6461 7461 203d 2073 656c        data = sel
-00021ca0: 662e 7365 6d61 6e74 6963 5f72 6570 6169  f.semantic_repai
-00021cb0: 725f 696e 7075 740a 2020 2020 2020 2020  r_input.        
-00021cc0: 2020 2020 2020 2020 666f 7220 6964 2c20          for id, 
-00021cd0: 6765 6e65 2069 6e20 656e 756d 6572 6174  gene in enumerat
-00021ce0: 6528 6f2e 6765 6e65 293a 0a20 2020 2020  e(o.gene):.     
-00021cf0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00021d00: 2065 7661 6c75 6174 6520 7468 6520 6375   evaluate the cu
-00021d10: 7272 656e 7420 6765 6e65 0a20 2020 2020  rrent gene.     
-00021d20: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00021d30: 696e 616c 5f72 6573 756c 7420 3d20 7175  inal_result = qu
-00021d40: 6963 6b5f 6576 616c 7561 7465 2867 656e  ick_evaluate(gen
-00021d50: 652c 2073 656c 662e 7073 6574 2e70 7365  e, self.pset.pse
-00021d60: 745f 6c69 7374 5b69 645d 2c20 6461 7461  t_list[id], data
-00021d70: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00021d80: 2020 2020 2020 6669 6e61 6c5f 7265 7375        final_resu
-00021d90: 6c74 203d 2071 7569 636b 5f66 696c 6c28  lt = quick_fill(
-00021da0: 5b66 696e 616c 5f72 6573 756c 745d 2c20  [final_result], 
-00021db0: 6461 7461 295b 305d 0a20 2020 2020 2020  data)[0].       
-00021dc0: 2020 2020 2020 2020 2020 2020 2063 7572               cur
-00021dd0: 7265 6e74 5f73 696d 203d 206e 702e 6162  rent_sim = np.ab
-00021de0: 7328 636f 735f 7369 6d28 6669 6e61 6c5f  s(cos_sim(final_
-00021df0: 7265 7375 6c74 2c20 7365 6c66 2e73 656d  result, self.sem
-00021e00: 616e 7469 635f 7265 7061 6972 5f74 6172  antic_repair_tar
-00021e10: 6765 7429 290a 2020 2020 2020 2020 2020  get)).          
-00021e20: 2020 2020 2020 2020 2020 6966 2063 7572            if cur
-00021e30: 7265 6e74 5f73 696d 203c 2073 656c 662e  rent_sim < self.
-00021e40: 7365 6d61 6e74 6963 5f72 6570 6169 723a  semantic_repair:
-00021e50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021e60: 2020 2020 2020 2020 2023 2074 7279 2074           # try t
-00021e70: 6f20 7265 6d6f 7665 2074 6865 2063 7572  o remove the cur
-00021e80: 7265 6e74 2067 656e 650a 2020 2020 2020  rent gene.      
-00021e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021ea0: 2020 6e65 775f 6765 6e65 735f 6120 3d20    new_genes_a = 
-00021eb0: 736f 7274 6564 2873 656c 5261 6e64 6f6d  sorted(selRandom
-00021ec0: 2865 7874 6572 6e61 6c5f 6172 6368 6976  (external_archiv
-00021ed0: 655b 6964 5d2c 2037 292c 206b 6579 3d6c  e[id], 7), key=l
-00021ee0: 616d 6264 6120 783a 2078 5b30 5d29 5b2d  ambda x: x[0])[-
-00021ef0: 315d 0a20 2020 2020 2020 2020 2020 2020  1].             
-00021f00: 2020 2020 2020 2020 2020 206e 6577 5f67             new_g
-00021f10: 656e 6573 5f62 203d 2073 6f72 7465 6428  enes_b = sorted(
-00021f20: 7365 6c52 616e 646f 6d28 6578 7465 726e  selRandom(extern
-00021f30: 616c 5f61 7263 6869 7665 5b69 645d 2c20  al_archive[id], 
-00021f40: 3729 2c20 6b65 793d 6c61 6d62 6461 2078  7), key=lambda x
-00021f50: 3a20 785b 305d 295b 2d31 5d0a 2020 2020  : x[0])[-1].    
-00021f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021f70: 2020 2020 6465 636f 7261 746f 7220 3d20      decorator = 
-00021f80: 7374 6174 6963 4c69 6d69 7428 6b65 793d  staticLimit(key=
-00021f90: 6f70 6572 6174 6f72 2e61 7474 7267 6574  operator.attrget
-00021fa0: 7465 7228 2268 6569 6768 7422 292c 0a20  ter("height"),. 
-00021fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001faf0: 2020 6966 2073 656c 662e 626c 6f61 745f    if self.bloat_
+0001fb00: 636f 6e74 726f 6c2e 6765 7428 2268 6173  control.get("has
+0001fb10: 685f 7369 6d70 6c69 6669 6361 7469 6f6e  h_simplification
+0001fb20: 222c 2046 616c 7365 293a 0a20 2020 2020  ", False):.     
+0001fb30: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001fb40: 656c 662e 6861 7368 5f62 6173 6564 5f73  elf.hash_based_s
+0001fb50: 696d 706c 6966 6963 6174 696f 6e28 706f  implification(po
+0001fb60: 7075 6c61 7469 6f6e 2c20 706f 7075 6c61  pulation, popula
+0001fb70: 7469 6f6e 290a 0a20 2020 2020 2020 2020  tion)..         
+0001fb80: 2020 2020 2020 2069 6620 7365 6c66 2e62         if self.b
+0001fb90: 6c6f 6174 5f63 6f6e 7472 6f6c 2e67 6574  loat_control.get
+0001fba0: 2822 686f 665f 7369 6d70 6c69 6669 6361  ("hof_simplifica
+0001fbb0: 7469 6f6e 222c 2046 616c 7365 293a 0a20  tion", False):. 
+0001fbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fbd0: 2020 2023 204d 6179 2062 6520 7573 656c     # May be usel
+0001fbe0: 6573 7320 7768 656e 2075 7369 6e67 2068  ess when using h
+0001fbf0: 6f69 7374 206d 7574 6174 696f 6e2e 0a20  oist mutation.. 
+0001fc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fc10: 2020 2023 2048 6f69 7374 206d 7574 6174     # Hoist mutat
+0001fc20: 696f 6e20 6973 2061 6c6d 6f73 7420 6162  ion is almost ab
+0001fc30: 6c65 2074 6f20 686f 6973 7420 7468 6520  le to hoist the 
+0001fc40: 6d6f 7374 2069 6d70 6f72 7461 6e74 2070  most important p
+0001fc50: 6172 742e 0a20 2020 2020 2020 2020 2020  art..           
+0001fc60: 2020 2020 2020 2020 2073 656c 662e 6861           self.ha
+0001fc70: 7368 5f62 6173 6564 5f73 696d 706c 6966  sh_based_simplif
+0001fc80: 6963 6174 696f 6e28 706f 7075 6c61 7469  ication(populati
+0001fc90: 6f6e 2c20 7365 6c66 2e68 6f66 290a 0a20  on, self.hof).. 
+0001fca0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0001fcb0: 6620 7365 6c66 2e62 6c6f 6174 5f63 6f6e  f self.bloat_con
+0001fcc0: 7472 6f6c 2e67 6574 2822 686f 6973 745f  trol.get("hoist_
+0001fcd0: 7072 6f62 6162 696c 6974 7922 2920 3d3d  probability") ==
+0001fce0: 2027 6164 6170 7469 7665 273a 0a20 2020   'adaptive':.   
+0001fcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fd00: 2069 6620 6164 6170 7469 7665 5f68 6f69   if adaptive_hoi
+0001fd10: 7374 5f70 726f 6261 6269 6c69 7479 2069  st_probability i
+0001fd20: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+0001fd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fd40: 6164 6170 7469 7665 5f68 6f69 7374 5f70  adaptive_hoist_p
+0001fd50: 726f 6261 6269 6c69 7479 203d 2031 0a20  robability = 1. 
+0001fd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fd70: 2020 2069 6620 6e6f 5f69 6d70 726f 7665     if no_improve
+0001fd80: 6d65 6e74 5f69 7465 7261 7469 6f6e 203e  ment_iteration >
+0001fd90: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+0001fda0: 2020 2020 2020 2020 2020 2020 6164 6170              adap
+0001fdb0: 7469 7665 5f68 6f69 7374 5f70 726f 6261  tive_hoist_proba
+0001fdc0: 6269 6c69 7479 202d 3d20 302e 310a 2020  bility -= 0.1.  
+0001fdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fde0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0001fdf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fe00: 6164 6170 7469 7665 5f68 6f69 7374 5f70  adaptive_hoist_p
+0001fe10: 726f 6261 6269 6c69 7479 202b 3d20 302e  robability += 0.
+0001fe20: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
+0001fe30: 2020 2020 2020 6164 6170 7469 7665 5f68        adaptive_h
+0001fe40: 6f69 7374 5f70 726f 6261 6269 6c69 7479  oist_probability
+0001fe50: 203d 206e 702e 636c 6970 2861 6461 7074   = np.clip(adapt
+0001fe60: 6976 655f 686f 6973 745f 7072 6f62 6162  ive_hoist_probab
+0001fe70: 696c 6974 792c 2030 2c20 3129 0a20 2020  ility, 0, 1).   
+0001fe80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fe90: 2070 7269 6e74 2861 6461 7074 6976 655f   print(adaptive_
+0001fea0: 686f 6973 745f 7072 6f62 6162 696c 6974  hoist_probabilit
+0001feb0: 7929 0a0a 2020 2020 2020 2020 2020 2020  y)..            
+0001fec0: 2020 2020 6966 2073 656c 662e 626c 6f61      if self.bloa
+0001fed0: 745f 636f 6e74 726f 6c5f 636f 6e66 6967  t_control_config
+0001fee0: 7572 6174 696f 6e2e 686f 6973 745f 6265  uration.hoist_be
+0001fef0: 666f 7265 5f73 656c 6563 7469 6f6e 3a0a  fore_selection:.
+0001ff00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ff10: 2020 2020 7365 6c66 2e73 656d 616e 7469      self.semanti
+0001ff20: 635f 686f 6973 745f 6d75 7461 7469 6f6e  c_hoist_mutation
+0001ff30: 2870 6f70 756c 6174 696f 6e2c 2061 6461  (population, ada
+0001ff40: 7074 6976 655f 686f 6973 745f 7072 6f62  ptive_hoist_prob
+0001ff50: 6162 696c 6974 7929 0a0a 2020 2020 2020  ability)..      
+0001ff60: 2020 2020 2020 7768 696c 6520 286c 656e        while (len
+0001ff70: 286e 6577 5f6f 6666 7370 7269 6e67 2920  (new_offspring) 
+0001ff80: 3c20 706f 705f 7369 7a65 293a 0a20 2020  < pop_size):.   
+0001ff90: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0001ffa0: 636f 756e 7420 3e20 706f 705f 7369 7a65  count > pop_size
+0001ffb0: 202a 2031 3030 3a0a 2020 2020 2020 2020   * 100:.        
+0001ffc0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0001ffd0: 6520 4578 6365 7074 696f 6e28 2245 7272  e Exception("Err
+0001ffe0: 6f72 2122 290a 2020 2020 2020 2020 2020  or!").          
+0001fff0: 2020 2020 2020 636f 756e 7420 2b3d 2031        count += 1
+00020000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020010: 2023 2055 7369 6e67 2074 6865 2065 7874   # Using the ext
+00020020: 6572 6e61 6c20 6172 6368 6976 650a 2020  ernal archive.  
+00020030: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00020040: 2073 656c 662e 6578 7465 726e 616c 5f61   self.external_a
+00020050: 7263 6869 7665 203d 3d20 2748 616c 6c4f  rchive == 'HallO
+00020060: 6646 616d 6527 2061 6e64 2073 656c 662e  fFame' and self.
+00020070: 686f 6620 6973 206e 6f74 204e 6f6e 653a  hof is not None:
+00020080: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020090: 2020 2020 2070 6172 656e 7420 3d20 706f       parent = po
+000200a0: 7075 6c61 7469 6f6e 202b 206c 6973 7428  pulation + list(
+000200b0: 7365 6c66 2e68 6f66 290a 2020 2020 2020  self.hof).      
+000200c0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+000200d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000200e0: 2020 2020 7061 7265 6e74 203d 2070 6f70      parent = pop
+000200f0: 756c 6174 696f 6e0a 0a20 2020 2020 2020  ulation..       
+00020100: 2020 2020 2020 2020 2023 2053 656c 6563           # Selec
+00020110: 7420 7468 6520 6265 7374 2073 7572 7669  t the best survi
+00020120: 7661 6c20 6f70 6572 6174 6f72 2062 6173  val operator bas
+00020130: 6564 206f 6e20 7468 6520 5468 6f6d 7073  ed on the Thomps
+00020140: 6f6e 2073 616d 706c 696e 670a 2020 2020  on sampling.    
+00020150: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00020160: 656c 662e 7365 6c65 6374 203d 3d20 2741  elf.select == 'A
+00020170: 7574 6f2d 4d43 5453 273a 0a20 2020 2020  uto-MCTS':.     
+00020180: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00020190: 616e 6469 6461 7465 7320 3d20 6d63 7473  andidates = mcts
+000201a0: 5f64 6963 745b 6627 526f 6f74 275d 0a20  _dict[f'Root']. 
+000201b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000201c0: 2020 2073 7572 7669 7661 6c5f 6f70 6572     survival_oper
+000201d0: 6174 6f72 5f69 6420 3d20 6e70 2e61 7267  ator_id = np.arg
+000201e0: 6d61 7828 6e70 2e72 616e 646f 6d2e 6265  max(np.random.be
+000201f0: 7461 2863 616e 6469 6461 7465 735b 305d  ta(candidates[0]
+00020200: 2c20 6361 6e64 6964 6174 6573 5b31 5d29  , candidates[1])
+00020210: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00020220: 2020 2020 2020 7365 6c66 2e70 6172 616d        self.param
+00020230: 5b27 7061 7265 6e74 5f61 7263 6869 7665  ['parent_archive
+00020240: 275d 203d 2063 616e 6469 6461 7465 5f73  '] = candidate_s
+00020250: 7572 7669 7661 6c5f 6f70 6561 7261 746f  urvival_opearato
+00020260: 7273 5b73 7572 7669 7661 6c5f 6f70 6572  rs[survival_oper
+00020270: 6174 6f72 5f69 645d 0a20 2020 2020 2020  ator_id].       
+00020280: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00020290: 206f 2069 6e20 7061 7265 6e74 3a0a 2020   o in parent:.  
+000202a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000202b0: 2020 2020 2020 6f2e 7375 7276 6976 616c        o.survival
+000202c0: 5f6f 7065 7261 746f 725f 6964 203d 2073  _operator_id = s
+000202d0: 7572 7669 7661 6c5f 6f70 6572 6174 6f72  urvival_operator
+000202e0: 5f69 640a 2020 2020 2020 2020 2020 2020  _id.            
+000202f0: 2020 2020 7061 7265 6e74 5f61 7263 6869      parent_archi
+00020300: 7665 203d 2073 656c 662e 7061 7261 6d2e  ve = self.param.
+00020310: 6765 7428 2770 6172 656e 745f 6172 6368  get('parent_arch
+00020320: 6976 6527 2c20 4e6f 6e65 290a 2020 2020  ive', None).    
+00020330: 2020 2020 2020 2020 2020 2020 6966 2070              if p
+00020340: 6172 656e 745f 6172 6368 6976 6520 3d3d  arent_archive ==
+00020350: 2027 4669 746e 6573 732d 5369 7a65 273a   'Fitness-Size':
+00020360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020370: 2020 2020 2070 6172 656e 7420 3d20 6e73       parent = ns
+00020380: 6761 5f61 7263 6869 7665 0a20 2020 2020  ga_archive.     
+00020390: 2020 2020 2020 2020 2020 2069 6620 7061             if pa
+000203a0: 7265 6e74 5f61 7263 6869 7665 203d 3d20  rent_archive == 
+000203b0: 2741 4650 273a 0a20 2020 2020 2020 2020  'AFP':.         
+000203c0: 2020 2020 2020 2020 2020 2070 6172 656e             paren
+000203d0: 7420 3d20 6166 705f 6172 6368 6976 650a  t = afp_archive.
+000203e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000203f0: 6966 2070 6172 656e 745f 6172 6368 6976  if parent_archiv
+00020400: 6520 3d3d 2027 4265 7374 273a 0a20 2020  e == 'Best':.   
+00020410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020420: 2070 6172 656e 7420 3d20 6265 7374 5f61   parent = best_a
+00020430: 7263 6869 7665 0a0a 2020 2020 2020 2020  rchive..        
+00020440: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00020450: 7365 6c65 6374 203d 3d20 2741 7574 6f27  select == 'Auto'
+00020460: 206f 7220 7365 6c66 2e73 656c 6563 7420   or self.select 
+00020470: 3d3d 2027 4175 746f 2d4d 4354 5327 3a0a  == 'Auto-MCTS':.
+00020480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020490: 2020 2020 6966 2073 656c 662e 7365 6c65      if self.sele
+000204a0: 6374 203d 3d20 2741 7574 6f27 3a0a 2020  ct == 'Auto':.  
+000204b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000204c0: 2020 2020 2020 7365 6c65 6374 696f 6e5f        selection_
+000204d0: 6f70 6572 6174 6f72 5f69 6420 3d20 6e70  operator_id = np
+000204e0: 2e61 7267 6d61 7828 6e70 2e72 616e 646f  .argmax(np.rando
+000204f0: 6d2e 6265 7461 2873 656c 6563 7469 6f6e  m.beta(selection
+00020500: 5f64 6174 615b 305d 2c20 7365 6c65 6374  _data[0], select
+00020510: 696f 6e5f 6461 7461 5b31 5d29 290a 2020  ion_data[1])).  
+00020520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020530: 2020 2020 2020 7365 6c65 6374 696f 6e5f        selection_
+00020540: 6f70 6572 6174 6f72 203d 2073 656c 6563  operator = selec
+00020550: 7469 6f6e 5f6f 7065 7261 746f 7273 5b73  tion_operators[s
+00020560: 656c 6563 7469 6f6e 5f6f 7065 7261 746f  election_operato
+00020570: 725f 6964 5d0a 2020 2020 2020 2020 2020  r_id].          
+00020580: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00020590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000205a0: 2020 2020 2020 2020 6361 6e64 6964 6174          candidat
+000205b0: 6573 203d 206d 6374 735f 6469 6374 5b27  es = mcts_dict['
+000205c0: 5365 6c65 6374 696f 6e20 4f70 6572 6174  Selection Operat
+000205d0: 6f72 7327 5d0a 2020 2020 2020 2020 2020  ors'].          
+000205e0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000205f0: 6c65 6374 696f 6e5f 6f70 6572 6174 6f72  lection_operator
+00020600: 5f69 6420 3d20 6e70 2e61 7267 6d61 7828  _id = np.argmax(
+00020610: 6e70 2e72 616e 646f 6d2e 6265 7461 2863  np.random.beta(c
+00020620: 616e 6469 6461 7465 735b 305d 2c20 6361  andidates[0], ca
+00020630: 6e64 6964 6174 6573 5b31 5d29 290a 2020  ndidates[1])).  
+00020640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020650: 2020 2020 2020 7365 6c65 6374 696f 6e5f        selection_
+00020660: 6f70 6572 6174 6f72 203d 2063 616e 6469  operator = candi
+00020670: 6461 7465 5f73 656c 6563 7469 6f6e 5f6f  date_selection_o
+00020680: 7065 7261 746f 7273 5b73 656c 6563 7469  perators[selecti
+00020690: 6f6e 5f6f 7065 7261 746f 725f 6964 5d0a  on_operator_id].
+000206a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000206b0: 2020 2020 6f66 6673 7072 696e 6720 3d20      offspring = 
+000206c0: 7365 6c66 2e6f 6666 7370 7269 6e67 5f73  self.offspring_s
+000206d0: 656c 6563 7469 6f6e 5f6d 6170 5f65 6c69  election_map_eli
+000206e0: 7465 7328 7061 7265 6e74 2c20 7365 6c65  tes(parent, sele
+000206f0: 6374 696f 6e5f 6f70 6572 6174 6f72 2c20  ction_operator, 
+00020700: 656c 6974 655f 6d61 7029 0a0a 2020 2020  elite_map)..    
+00020710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020720: 666f 7220 6f20 696e 206f 6666 7370 7269  for o in offspri
+00020730: 6e67 3a0a 2020 2020 2020 2020 2020 2020  ng:.            
+00020740: 2020 2020 2020 2020 2020 2020 6f2e 7365              o.se
+00020750: 6c65 6374 696f 6e5f 6f70 6572 6174 6f72  lection_operator
+00020760: 203d 2073 656c 6563 7469 6f6e 5f6f 7065   = selection_ope
+00020770: 7261 746f 725f 6964 0a20 2020 2020 2020  rator_id.       
+00020780: 2020 2020 2020 2020 2065 6c69 6620 2873           elif (s
+00020790: 656c 662e 7365 6c65 6374 2069 6e20 6d61  elf.select in ma
+000207a0: 705f 656c 6974 655f 7365 7269 6573 2920  p_elite_series) 
+000207b0: 616e 6420 5c0a 2020 2020 2020 2020 2020  and \.          
+000207c0: 2020 2020 2020 2020 2020 2828 7365 6c66            ((self
+000207d0: 2e6d 6170 5f65 6c69 7465 5f70 6172 616d  .map_elite_param
+000207e0: 6574 6572 5b27 7472 6967 6765 725f 7469  eter['trigger_ti
+000207f0: 6d65 275d 203d 3d20 2741 6c6c 2729 206f  me'] == 'All') o
+00020800: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+00020810: 2020 2020 2020 2028 7365 6c66 2e6d 6170         (self.map
+00020820: 5f65 6c69 7465 5f70 6172 616d 6574 6572  _elite_parameter
+00020830: 5b27 7472 6967 6765 725f 7469 6d65 275d  ['trigger_time']
+00020840: 203d 3d20 2749 6d70 726f 7665 6d65 6e74   == 'Improvement
+00020850: 2720 616e 6420 6669 746e 6573 735f 696d  ' and fitness_im
+00020860: 7072 6f76 656d 656e 7420 3e3d 2030 2929  provement >= 0))
+00020870: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00020880: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+00020890: 6e63 6528 656c 6974 655f 6d61 702c 206c  nce(elite_map, l
+000208a0: 6973 7429 3a0a 2020 2020 2020 2020 2020  ist):.          
+000208b0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+000208c0: 7265 6e74 203d 2065 6c69 7465 5f6d 6170  rent = elite_map
+000208d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000208e0: 2020 2020 2065 6c69 6620 6973 696e 7374       elif isinst
+000208f0: 616e 6365 2865 6c69 7465 5f6d 6170 2c20  ance(elite_map, 
+00020900: 6469 6374 293a 0a20 2020 2020 2020 2020  dict):.         
+00020910: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00020920: 6172 656e 7420 3d20 6c69 7374 2865 6c69  arent = list(eli
+00020930: 7465 5f6d 6170 2e76 616c 7565 7328 2929  te_map.values())
+00020940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020950: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00020960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020970: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+00020980: 6f72 0a0a 2020 2020 2020 2020 2020 2020  or..            
+00020990: 2020 2020 2020 2020 6f66 6673 7072 696e          offsprin
+000209a0: 6720 3d20 7365 6c66 2e6f 6666 7370 7269  g = self.offspri
+000209b0: 6e67 5f73 656c 6563 7469 6f6e 5f6d 6170  ng_selection_map
+000209c0: 5f65 6c69 7465 7328 7061 7265 6e74 2c20  _elites(parent, 
+000209d0: 7365 6c66 2e73 656c 6563 742c 2065 6c69  self.select, eli
+000209e0: 7465 5f6d 6170 290a 2020 2020 2020 2020  te_map).        
+000209f0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00020a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020a10: 2020 6966 2073 656c 662e 6372 6f73 736f    if self.crosso
+00020a20: 7665 725f 636f 6e66 6967 7572 6174 696f  ver_configuratio
+00020a30: 6e2e 7365 6d61 6e74 6963 5f63 726f 7373  n.semantic_cross
+00020a40: 6f76 6572 5f6d 6f64 6520 3d3d 2043 726f  over_mode == Cro
+00020a50: 7373 6f76 6572 4d6f 6465 2e53 6571 7565  ssoverMode.Seque
+00020a60: 6e74 6961 6c20 616e 6420 5c0a 2020 2020  ntial and \.    
+00020a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020a80: 2020 2020 7261 6e64 6f6d 2e72 616e 646f      random.rando
+00020a90: 6d28 2920 3c20 7365 6c66 2e63 726f 7373  m() < self.cross
+00020aa0: 6f76 6572 5f63 6f6e 6669 6775 7261 7469  over_configurati
+00020ab0: 6f6e 2e73 656d 616e 7469 635f 6372 6f73  on.semantic_cros
+00020ac0: 736f 7665 725f 7072 6f62 6162 696c 6974  sover_probabilit
+00020ad0: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
+00020ae0: 2020 2020 2020 2020 2020 2023 2073 656c             # sel
+00020af0: 6563 7420 7477 6f20 7061 7265 6e74 7320  ect two parents 
+00020b00: 7573 696e 6720 6d61 6372 6f2d 6372 6f73  using macro-cros
+00020b10: 736f 7665 7220 6f70 6572 6174 6f72 0a20  sover operator. 
+00020b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020b30: 2020 2020 2020 2023 2074 6865 6e2c 2061         # then, a
+00020b40: 7070 6c79 2074 7261 6469 7469 6f6e 616c  pply traditional
+00020b50: 206f 7065 7261 746f 7273 206f 6e20 7468   operators on th
+00020b60: 6573 6520 7365 6c65 6374 6564 2070 6172  ese selected par
+00020b70: 656e 7473 0a20 2020 2020 2020 2020 2020  ents.           
+00020b80: 2020 2020 2020 2020 2020 2020 2070 6172               par
+00020b90: 656e 7473 5f61 2c20 7061 203d 2073 656c  ents_a, pa = sel
+00020ba0: 662e 7365 6d61 6e74 6963 5f63 726f 7373  f.semantic_cross
+00020bb0: 6f76 6572 5f66 6f72 5f70 6172 656e 7428  over_for_parent(
+00020bc0: 746f 6f6c 626f 782c 2070 6172 656e 742c  toolbox, parent,
+00020bd0: 2065 7874 6572 6e61 6c5f 6172 6368 6976   external_archiv
+00020be0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00020bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020c20: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00020c30: 6c66 2e63 726f 7373 6f76 6572 5f63 6f6e  lf.crossover_con
+00020c40: 6669 6775 7261 7469 6f6e 290a 2020 2020  figuration).    
+00020c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020c60: 2020 2020 7061 7265 6e74 735f 622c 2070      parents_b, p
+00020c70: 6220 3d20 7365 6c66 2e73 656d 616e 7469  b = self.semanti
+00020c80: 635f 6372 6f73 736f 7665 725f 666f 725f  c_crossover_for_
+00020c90: 7061 7265 6e74 2874 6f6f 6c62 6f78 2c20  parent(toolbox, 
+00020ca0: 7061 7265 6e74 2c20 6578 7465 726e 616c  parent, external
+00020cb0: 5f61 7263 6869 7665 2c0a 2020 2020 2020  _archive,.      
+00020cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020d00: 2020 2020 2073 656c 662e 6372 6f73 736f       self.crosso
+00020d10: 7665 725f 636f 6e66 6967 7572 6174 696f  ver_configuratio
+00020d20: 6e29 0a20 2020 2020 2020 2020 2020 2020  n).             
+00020d30: 2020 2020 2020 2020 2020 206f 6666 7370             offsp
+00020d40: 7269 6e67 203d 205b 7061 2c20 7062 5d0a  ring = [pa, pb].
+00020d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020d60: 2020 2020 2020 2020 7365 6c66 2e72 6563          self.rec
+00020d70: 6f72 645f 7061 7265 6e74 5f66 6974 6e65  ord_parent_fitne
+00020d80: 7373 2870 6172 656e 7473 5f61 202b 2070  ss(parents_a + p
+00020d90: 6172 656e 7473 5f62 2c20 6f66 6673 7072  arents_b, offspr
+00020da0: 696e 672c 2063 726f 7373 6f76 6572 5f74  ing, crossover_t
+00020db0: 7970 653d 274d 6163 726f 2729 0a20 2020  ype='Macro').   
+00020dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020dd0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00020de0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+00020df0: 6666 7370 7269 6e67 203d 2073 656c 662e  ffspring = self.
+00020e00: 7472 6164 6974 696f 6e61 6c5f 7061 7265  traditional_pare
+00020e10: 6e74 5f73 656c 6563 7469 6f6e 2874 6f6f  nt_selection(too
+00020e20: 6c62 6f78 2c20 7061 7265 6e74 2c20 6578  lbox, parent, ex
+00020e30: 7465 726e 616c 5f61 7263 6869 7665 290a  ternal_archive).
+00020e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020e50: 2020 2020 2020 2020 7365 6c66 2e72 6563          self.rec
+00020e60: 6f72 645f 7061 7265 6e74 5f66 6974 6e65  ord_parent_fitne
+00020e70: 7373 286f 6666 7370 7269 6e67 2c20 6f66  ss(offspring, of
+00020e80: 6673 7072 696e 672c 2063 726f 7373 6f76  fspring, crossov
+00020e90: 6572 5f74 7970 653d 274d 6963 726f 2729  er_type='Micro')
+00020ea0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00020eb0: 2020 6f66 6673 7072 696e 673a 204c 6973    offspring: Lis
+00020ec0: 745b 4d75 6c74 6970 6c65 4765 6e65 4750  t[MultipleGeneGP
+00020ed0: 5d20 3d20 6f66 6673 7072 696e 675b 3a5d  ] = offspring[:]
+00020ee0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020ef0: 2069 6620 6e6f 7420 7365 6c66 2e62 6c6f   if not self.blo
+00020f00: 6174 5f63 6f6e 7472 6f6c 5f63 6f6e 6669  at_control_confi
+00020f10: 6775 7261 7469 6f6e 2e68 6f69 7374 5f62  guration.hoist_b
+00020f20: 6566 6f72 655f 7365 6c65 6374 696f 6e3a  efore_selection:
+00020f30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020f40: 2020 2020 2023 2064 6565 7020 636f 7079       # deep copy
+00020f50: 2061 6e64 2074 6865 6e20 686f 6973 740a   and then hoist.
+00020f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020f70: 2020 2020 6f66 6673 7072 696e 6720 3d20      offspring = 
+00020f80: 7069 636b 6c65 5f64 6565 7063 6f70 7928  pickle_deepcopy(
+00020f90: 6f66 6673 7072 696e 6729 0a20 2020 2020  offspring).     
+00020fa0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00020fb0: 656c 662e 7365 6d61 6e74 6963 5f68 6f69  elf.semantic_hoi
+00020fc0: 7374 5f6d 7574 6174 696f 6e28 6f66 6673  st_mutation(offs
+00020fd0: 7072 696e 672c 2061 6461 7074 6976 655f  pring, adaptive_
+00020fe0: 686f 6973 745f 7072 6f62 6162 696c 6974  hoist_probabilit
+00020ff0: 7929 0a0a 2020 2020 2020 2020 2020 2020  y)..            
+00021000: 2020 2020 6966 2073 656c 662e 626c 6f61      if self.bloa
+00021010: 745f 636f 6e74 726f 6c20 6973 206e 6f74  t_control is not
+00021020: 204e 6f6e 6520 616e 6420 7365 6c66 2e62   None and self.b
+00021030: 6c6f 6174 5f63 6f6e 7472 6f6c 2e67 6574  loat_control.get
+00021040: 2827 7365 6d61 6e74 6963 5f70 7275 6e65  ('semantic_prune
+00021050: 5f61 6e64 5f70 6c61 6e74 272c 2046 616c  _and_plant', Fal
+00021060: 7365 293a 0a20 2020 2020 2020 2020 2020  se):.           
+00021070: 2020 2020 2020 2020 2023 2053 656d 616e           # Seman
+00021080: 7469 6320 5072 756e 652d 616e 642d 506c  tic Prune-and-Pl
+00021090: 616e 7420 2842 6566 6f72 6520 4d75 7461  ant (Before Muta
+000210a0: 7469 6f6e 290a 2020 2020 2020 2020 2020  tion).          
+000210b0: 2020 2020 2020 2020 2020 6966 2072 616e            if ran
+000210c0: 646f 6d2e 7261 6e64 6f6d 2829 203c 2073  dom.random() < s
+000210d0: 656c 662e 626c 6f61 745f 636f 6e74 726f  elf.bloat_contro
+000210e0: 6c2e 6765 7428 2770 7275 6e65 5f61 6e64  l.get('prune_and
+000210f0: 5f70 6c61 6e74 5f70 6227 2c20 3129 3a0a  _plant_pb', 1):.
+00021100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021110: 2020 2020 2020 2020 6f66 6673 7072 696e          offsprin
+00021120: 6720 3d20 7365 6c66 2e70 7275 6e65 5f61  g = self.prune_a
+00021130: 6e64 5f70 6c61 6e74 286f 6666 7370 7269  nd_plant(offspri
+00021140: 6e67 2c20 6265 7374 3d54 7275 6529 0a0a  ng, best=True)..
+00021150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021160: 2320 5661 7279 2074 6865 2070 6f6f 6c20  # Vary the pool 
+00021170: 6f66 2069 6e64 6976 6964 7561 6c73 0a20  of individuals. 
+00021180: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00021190: 6620 7365 6c66 2e6d 756c 7469 5f67 656e  f self.multi_gen
+000211a0: 655f 6d75 7461 7469 6f6e 2829 3a0a 2020  e_mutation():.  
+000211b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000211c0: 2020 6c69 6d69 7461 7469 6f6e 5f63 6865    limitation_che
+000211d0: 636b 203d 2073 656c 662e 7374 6174 6963  ck = self.static
+000211e0: 5f6c 696d 6974 5f66 756e 6374 696f 6e0a  _limit_function.
+000211f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021200: 2020 2020 6966 2073 656c 662e 7365 6d61      if self.sema
+00021210: 6e74 6963 5f76 6172 6961 7469 6f6e 3a0a  ntic_variation:.
+00021220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021230: 2020 2020 2020 2020 7365 6d61 6e74 6963          semantic
+00021240: 5f63 6865 636b 5f74 6f6f 6c20 3d20 7b0a  _check_tool = {.
+00021250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021260: 2020 2020 2020 2020 2020 2020 2778 273a              'x':
+00021270: 2073 656c 662e 582c 0a20 2020 2020 2020   self.X,.       
+00021280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021290: 2020 2020 2027 7927 3a20 7365 6c66 2e79       'y': self.y
+000212a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000212b0: 2020 2020 2020 2020 2020 2020 2020 2770                'p
+000212c0: 7365 7427 3a20 7365 6c66 2e70 7365 742c  set': self.pset,
+000212d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000212e0: 2020 2020 2020 2020 2020 2020 2027 636f               'co
+000212f0: 7272 656c 6174 696f 6e5f 7468 7265 7368  rrelation_thresh
+00021300: 6f6c 6427 3a20 7365 6c66 2e63 6f72 7265  old': self.corre
+00021310: 6c61 7469 6f6e 5f74 6872 6573 686f 6c64  lation_threshold
+00021320: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00021330: 2020 2020 2020 2020 2020 2020 2020 2763                'c
+00021340: 6f72 7265 6c61 7469 6f6e 5f6d 6f64 6527  orrelation_mode'
+00021350: 3a20 7365 6c66 2e63 6f72 7265 6c61 7469  : self.correlati
+00021360: 6f6e 5f6d 6f64 652c 0a20 2020 2020 2020  on_mode,.       
+00021370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021380: 207d 0a20 2020 2020 2020 2020 2020 2020   }.             
+00021390: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000213a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000213b0: 2020 2020 2073 656d 616e 7469 635f 6368       semantic_ch
+000213c0: 6563 6b5f 746f 6f6c 203d 204e 6f6e 650a  eck_tool = None.
+000213d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000213e0: 2020 2020 6966 2073 656c 662e 626c 6f61      if self.bloa
+000213f0: 745f 636f 6e74 726f 6c20 6973 206e 6f74  t_control is not
+00021400: 204e 6f6e 6520 5c0a 2020 2020 2020 2020   None \.        
+00021410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021420: 616e 6420 7261 6e64 6f6d 2e72 616e 646f  and random.rando
+00021430: 6d28 2920 3c20 7365 6c66 2e62 6c6f 6174  m() < self.bloat
+00021440: 5f63 6f6e 7472 6f6c 2e67 6574 2822 7472  _control.get("tr
+00021450: 6565 5f63 6f6d 6269 6e61 7469 6f6e 222c  ee_combination",
+00021460: 2030 293a 0a20 2020 2020 2020 2020 2020   0):.           
+00021470: 2020 2020 2020 2020 2020 2020 206f 6666               off
+00021480: 7370 7269 6e67 203d 2069 6e64 6976 6964  spring = individ
+00021490: 7561 6c5f 636f 6d62 696e 6174 696f 6e28  ual_combination(
+000214a0: 6f66 6673 7072 696e 672c 2074 6f6f 6c62  offspring, toolb
+000214b0: 6f78 2c20 7365 6c66 2e70 7365 742c 206c  ox, self.pset, l
+000214c0: 696d 6974 6174 696f 6e5f 6368 6563 6b29  imitation_check)
+000214d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000214e0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+000214f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021500: 2020 206f 6666 7370 7269 6e67 3a20 4c69     offspring: Li
+00021510: 7374 5b4d 756c 7469 706c 6547 656e 6547  st[MultipleGeneG
+00021520: 505d 0a20 2020 2020 2020 2020 2020 2020  P].             
+00021530: 2020 2020 2020 2020 2020 2069 6620 7261             if ra
+00021540: 6e64 6f6d 2e72 616e 646f 6d28 2920 3c20  ndom.random() < 
+00021550: 7365 6c66 2e63 726f 7373 6f76 6572 5f63  self.crossover_c
+00021560: 6f6e 6669 6775 7261 7469 6f6e 2e73 656d  onfiguration.sem
+00021570: 616e 7469 635f 6372 6f73 736f 7665 725f  antic_crossover_
+00021580: 7072 6f62 6162 696c 6974 7920 616e 6420  probability and 
+00021590: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
+000215a0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000215b0: 6c66 2e63 726f 7373 6f76 6572 5f63 6f6e  lf.crossover_con
+000215c0: 6669 6775 7261 7469 6f6e 2e73 656d 616e  figuration.seman
+000215d0: 7469 635f 6372 6f73 736f 7665 725f 6d6f  tic_crossover_mo
+000215e0: 6465 203d 3d20 4372 6f73 736f 7665 724d  de == CrossoverM
+000215f0: 6f64 652e 496e 6465 7065 6e64 656e 743a  ode.Independent:
+00021600: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00021610: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00021620: 7365 6c66 2e63 726f 7373 6f76 6572 5f63  self.crossover_c
+00021630: 6f6e 6669 6775 7261 7469 6f6e 2e73 656d  onfiguration.sem
+00021640: 616e 7469 635f 7365 6c65 6374 696f 6e5f  antic_selection_
+00021650: 6d6f 6465 203d 3d20 5365 6c65 6374 696f  mode == Selectio
+00021660: 6e4d 6f64 652e 416e 676c 6544 7269 7665  nMode.AngleDrive
+00021670: 6e3a 0a20 2020 2020 2020 2020 2020 2020  n:.             
+00021680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021690: 2020 2023 2065 6974 6865 7220 6d61 6372     # either macr
+000216a0: 6f2d 6372 6f73 736f 7665 7220 6f72 206d  o-crossover or m
+000216b0: 6163 726f 2d63 726f 7373 6f76 6572 0a20  acro-crossover. 
+000216c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000216d0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+000216e0: 6666 7370 7269 6e67 203d 2073 656d 616e  ffspring = seman
+000216f0: 7469 6346 6561 7475 7265 4372 6f73 736f  ticFeatureCrosso
+00021700: 7665 7228 6f66 6673 7072 696e 675b 305d  ver(offspring[0]
+00021710: 2c20 6f66 6673 7072 696e 675b 315d 2c20  , offspring[1], 
+00021720: 7461 7267 6574 3d73 656c 662e 7929 0a20  target=self.y). 
+00021730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021740: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00021750: 7365 6c66 2e63 726f 7373 6f76 6572 5f63  self.crossover_c
+00021760: 6f6e 6669 6775 7261 7469 6f6e 2e73 656d  onfiguration.sem
+00021770: 616e 7469 635f 7365 6c65 6374 696f 6e5f  antic_selection_
+00021780: 6d6f 6465 203d 3d20 5365 6c65 6374 696f  mode == Selectio
+00021790: 6e4d 6f64 652e 4d41 5045 6c69 7465 733a  nMode.MAPElites:
+000217a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000217b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000217c0: 206f 6666 7370 7269 6e67 203d 206d 6170   offspring = map
+000217d0: 456c 6974 6573 4372 6f73 736f 7665 7228  ElitesCrossover(
+000217e0: 6f66 6673 7072 696e 675b 305d 2c20 6f66  offspring[0], of
+000217f0: 6673 7072 696e 675b 315d 2c20 7461 7267  fspring[1], targ
+00021800: 6574 3d73 656c 662e 792c 0a20 2020 2020  et=self.y,.     
+00021810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021840: 2020 2020 2020 2020 2020 6d61 705f 656c            map_el
+00021850: 6974 6573 5f63 6f6e 6669 6775 7261 7469  ites_configurati
+00021860: 6f6e 3d0a 2020 2020 2020 2020 2020 2020  on=.            
+00021870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000218a0: 2020 2073 656c 662e 6372 6f73 736f 7665     self.crossove
+000218b0: 725f 636f 6e66 6967 7572 6174 696f 6e2e  r_configuration.
+000218c0: 6d61 705f 656c 6974 6573 5f63 6f6e 6669  map_elites_confi
+000218d0: 6775 7261 7469 6f6e 290a 2020 2020 2020  guration).      
+000218e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000218f0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00021900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021910: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00021920: 6520 4578 6365 7074 696f 6e28 2249 6e76  e Exception("Inv
+00021930: 616c 6964 2053 656c 6563 7469 6f6e 204d  alid Selection M
+00021940: 6f64 6521 2229 0a20 2020 2020 2020 2020  ode!").         
+00021950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021960: 2020 2023 2063 6861 6e67 6520 746f 2063     # change to c
+00021970: 726f 7373 6f76 6572 2074 7970 6520 746f  rossover type to
+00021980: 206d 6163 726f 0a20 2020 2020 2020 2020   macro.         
+00021990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000219a0: 2020 2066 6f72 206f 2069 6e20 6f66 6673     for o in offs
+000219b0: 7072 696e 673a 0a20 2020 2020 2020 2020  pring:.         
+000219c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000219d0: 2020 2020 2020 206f 2e63 726f 7373 6f76         o.crossov
+000219e0: 6572 5f74 7970 6520 3d20 274d 6163 726f  er_type = 'Macro
+000219f0: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
+00021a00: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00021a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021a20: 2020 2020 2020 2020 2020 2020 6f66 6673              offs
+00021a30: 7072 696e 6720 3d20 7661 7241 6e64 506c  pring = varAndPl
+00021a40: 7573 286f 6666 7370 7269 6e67 2c20 746f  us(offspring, to
+00021a50: 6f6c 626f 782c 2063 7870 622c 206d 7574  olbox, cxpb, mut
+00021a60: 7062 2c20 7365 6c66 2e67 656e 655f 6e75  pb, self.gene_nu
+00021a70: 6d2c 0a20 2020 2020 2020 2020 2020 2020  m,.             
+00021a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021aa0: 2020 2020 2020 6c69 6d69 7461 7469 6f6e        limitation
+00021ab0: 5f63 6865 636b 2c0a 2020 2020 2020 2020  _check,.        
+00021ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021ae0: 2020 2020 2020 2020 2020 2073 656d 616e             seman
+00021af0: 7469 635f 6368 6563 6b5f 746f 6f6c 2c0a  tic_check_tool,.
+00021b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021b30: 2020 2063 726f 7373 6f76 6572 5f63 6f6e     crossover_con
+00021b40: 6669 6775 7261 7469 6f6e 3d73 656c 662e  figuration=self.
+00021b50: 6372 6f73 736f 7665 725f 636f 6e66 6967  crossover_config
+00021b60: 7572 6174 696f 6e2c 0a20 2020 2020 2020  uration,.       
+00021b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021b90: 2020 2020 2020 2020 2020 2020 6d75 7461              muta
+00021ba0: 7469 6f6e 5f63 6f6e 6669 6775 7261 7469  tion_configurati
+00021bb0: 6f6e 3d73 656c 662e 6d75 7461 7469 6f6e  on=self.mutation
+00021bc0: 5f63 6f6e 6669 6775 7261 7469 6f6e 290a  _configuration).
+00021bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021be0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00021bf0: 2020 2020 2020 2020 2020 6f66 6673 7072            offspr
+00021c00: 696e 673a 204d 756c 7469 706c 6547 656e  ing: MultipleGen
+00021c10: 6547 5020 3d20 7661 7241 6e64 286f 6666  eGP = varAnd(off
+00021c20: 7370 7269 6e67 2c20 746f 6f6c 626f 782c  spring, toolbox,
+00021c30: 2063 7870 622c 206d 7574 7062 290a 0a20   cxpb, mutpb).. 
+00021c40: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00021c50: 2074 7279 2074 6f20 6669 7820 7a65 726f   try to fix zero
+00021c60: 2074 7265 650a 2020 2020 2020 2020 2020   tree.          
+00021c70: 2020 2020 2020 6669 785f 7a65 726f 5f74        fix_zero_t
+00021c80: 7265 6520 3d20 7365 6c66 2e62 6c6f 6174  ree = self.bloat
+00021c90: 5f63 6f6e 7472 6f6c 2069 7320 6e6f 7420  _control is not 
+00021ca0: 4e6f 6e65 2061 6e64 2073 656c 662e 626c  None and self.bl
+00021cb0: 6f61 745f 636f 6e74 726f 6c2e 6765 7428  oat_control.get(
+00021cc0: 2266 6978 5f7a 6572 6f5f 7472 6565 222c  "fix_zero_tree",
+00021cd0: 2046 616c 7365 290a 2020 2020 2020 2020   False).        
+00021ce0: 2020 2020 2020 2020 6966 2066 6978 5f7a          if fix_z
+00021cf0: 6572 6f5f 7472 6565 3a0a 2020 2020 2020  ero_tree:.      
+00021d00: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00021d10: 7220 6f20 696e 206f 6666 7370 7269 6e67  r o in offspring
+00021d20: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00021d30: 2020 2020 2020 2020 2020 666f 7220 6769            for gi
+00021d40: 642c 2067 2069 6e20 656e 756d 6572 6174  d, g in enumerat
+00021d50: 6528 6f2e 6765 6e65 293a 0a20 2020 2020  e(o.gene):.     
+00021d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021d70: 2020 2020 2020 2069 6620 6c65 6e28 6729         if len(g)
+00021d80: 203d 3d20 3120 616e 6420 6973 696e 7374   == 1 and isinst
+00021d90: 616e 6365 2867 5b30 5d2c 2054 6572 6d69  ance(g[0], Termi
+00021da0: 6e61 6c29 2061 6e64 2067 5b30 5d2e 7661  nal) and g[0].va
+00021db0: 6c75 6520 3d3d 2030 3a0a 2020 2020 2020  lue == 0:.      
+00021dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021dd0: 2020 2020 2020 2020 2020 2320 4974 2069            # It i
+00021de0: 7320 6120 7a65 726f 2074 7265 650a 2020  s a zero tree.  
+00021df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021e00: 2020 2020 2020 2020 2020 2020 2020 6f2e                o.
+00021e10: 6765 6e65 5b67 6964 5d20 3d20 7365 6c66  gene[gid] = self
+00021e20: 2e6e 6577 5f74 7265 655f 6765 6e65 7261  .new_tree_genera
+00021e30: 7469 6f6e 2829 0a0a 2020 2020 2020 2020  tion()..        
+00021e40: 2020 2020 2020 2020 6368 6563 6b5f 6d75          check_mu
+00021e50: 7461 7469 6f6e 203d 2073 656c 662e 626c  tation = self.bl
+00021e60: 6f61 745f 636f 6e74 726f 6c20 6973 206e  oat_control is n
+00021e70: 6f74 204e 6f6e 6520 616e 6420 7365 6c66  ot None and self
+00021e80: 2e62 6c6f 6174 5f63 6f6e 7472 6f6c 2e67  .bloat_control.g
+00021e90: 6574 2822 6368 6563 6b5f 6d75 7461 7469  et("check_mutati
+00021ea0: 6f6e 222c 2046 616c 7365 290a 2020 2020  on", False).    
+00021eb0: 2020 2020 2020 2020 2020 2020 6368 6563              chec
+00021ec0: 6b5f 696e 6974 6961 6c69 7a61 7469 6f6e  k_initialization
+00021ed0: 203d 2073 656c 662e 626c 6f61 745f 636f   = self.bloat_co
+00021ee0: 6e74 726f 6c20 6973 206e 6f74 204e 6f6e  ntrol is not Non
+00021ef0: 6520 616e 6420 5c0a 2020 2020 2020 2020  e and \.        
+00021f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021f10: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00021f20: 656c 662e 626c 6f61 745f 636f 6e74 726f  elf.bloat_contro
+00021f30: 6c2e 6765 7428 2263 6865 636b 5f69 6e69  l.get("check_ini
+00021f40: 7469 616c 697a 6174 696f 6e22 2c20 4661  tialization", Fa
+00021f50: 6c73 6529 0a20 2020 2020 2020 2020 2020  lse).           
+00021f60: 2020 2020 2069 6620 6368 6563 6b5f 6d75       if check_mu
+00021f70: 7461 7469 6f6e 206f 7220 6368 6563 6b5f  tation or check_
+00021f80: 696e 6974 6961 6c69 7a61 7469 6f6e 3a0a  initialization:.
+00021f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021fa0: 2020 2020 666f 7220 6f20 696e 206f 6666      for o in off
+00021fb0: 7370 7269 6e67 3a0a 2020 2020 2020 2020  spring:.        
 00021fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021fd0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00021fe0: 6178 5f76 616c 7565 3d73 656c 662e 6d61  ax_value=self.ma
-00021ff0: 785f 6865 6967 6874 2c0a 2020 2020 2020  x_height,.      
-00022000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022020: 2020 2020 2020 2020 2020 6d69 6e5f 7661            min_va
-00022030: 6c75 653d 7365 6c66 2e6d 696e 5f68 6569  lue=self.min_hei
-00022040: 6768 7429 2863 784f 6e65 506f 696e 7429  ght)(cxOnePoint)
-00022050: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022060: 2020 2020 2020 2020 2074 6573 745f 6765           test_ge
-00022070: 6e65 7320 3d20 6465 636f 7261 746f 7228  nes = decorator(
-00022080: 636f 7079 2e64 6565 7063 6f70 7928 6e65  copy.deepcopy(ne
-00022090: 775f 6765 6e65 735f 615b 315d 292c 2063  w_genes_a[1]), c
-000220a0: 6f70 792e 6465 6570 636f 7079 286e 6577  opy.deepcopy(new
-000220b0: 5f67 656e 6573 5f62 5b31 5d29 290a 0a20  _genes_b[1])).. 
+00021fd0: 7072 6576 696f 7573 5f73 6574 203d 2073  previous_set = s
+00021fe0: 6574 2829 0a20 2020 2020 2020 2020 2020  et().           
+00021ff0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00022000: 2069 642c 2067 656e 6520 696e 2065 6e75   id, gene in enu
+00022010: 6d65 7261 7465 286f 2e67 656e 6529 3a0a  merate(o.gene):.
+00022020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022030: 2020 2020 2020 2020 2020 2020 2320 6d75              # mu
+00022040: 7461 7465 2063 6f6e 7374 616e 7420 6765  tate constant ge
+00022050: 6e65 7320 616e 6420 7265 6475 6e64 616e  nes and redundan
+00022060: 7420 6765 6e65 730a 2020 2020 2020 2020  t genes.        
+00022070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022080: 2020 2020 6966 2073 7472 2867 656e 6529      if str(gene)
+00022090: 2069 6e20 7072 6576 696f 7573 5f73 6574   in previous_set
+000220a0: 206f 7220 6973 5f66 6c6f 6174 2873 7472   or is_float(str
+000220b0: 2867 656e 6529 293a 0a20 2020 2020 2020  (gene)):.       
 000220c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000220d0: 2020 2020 2020 2062 6573 745f 6765 6e65         best_gene
-000220e0: 5f73 636f 7265 203d 2030 0a20 2020 2020  _score = 0.     
+000220d0: 2020 2020 2020 2020 2069 6620 6368 6563           if chec
+000220e0: 6b5f 6d75 7461 7469 6f6e 3a0a 2020 2020  k_mutation:.    
 000220f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022100: 2020 2066 6f72 206e 6577 5f67 656e 6520     for new_gene 
-00022110: 696e 2074 6573 745f 6765 6e65 733a 0a20  in test_genes:. 
-00022120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022130: 2020 2020 2020 2020 2020 2074 7269 616c             trial
-00022140: 5f72 6573 756c 7420 3d20 7175 6963 6b5f  _result = quick_
-00022150: 6576 616c 7561 7465 286e 6577 5f67 656e  evaluate(new_gen
-00022160: 652c 2073 656c 662e 7073 6574 2e70 7365  e, self.pset.pse
-00022170: 745f 6c69 7374 5b69 645d 2c20 6461 7461  t_list[id], data
-00022180: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00022190: 2020 2020 2020 2020 2020 2020 2020 7472                tr
-000221a0: 6961 6c5f 7265 7375 6c74 203d 2071 7569  ial_result = qui
-000221b0: 636b 5f66 696c 6c28 5b74 7269 616c 5f72  ck_fill([trial_r
-000221c0: 6573 756c 745d 2c20 6461 7461 295b 305d  esult], data)[0]
-000221d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000221e0: 2020 2020 2020 2020 2020 2020 2074 7261               tra
-000221f0: 696c 5f73 696d 203d 206e 702e 6162 7328  il_sim = np.abs(
-00022200: 636f 735f 7369 6d28 7472 6961 6c5f 7265  cos_sim(trial_re
-00022210: 7375 6c74 2c20 7365 6c66 2e73 656d 616e  sult, self.seman
-00022220: 7469 635f 7265 7061 6972 5f74 6172 6765  tic_repair_targe
-00022230: 7429 290a 2020 2020 2020 2020 2020 2020  t)).            
-00022240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022250: 7265 706c 6163 655f 7468 7265 7368 6f6c  replace_threshol
-00022260: 6420 3d20 7472 6169 6c5f 7369 6d20 2f20  d = trail_sim / 
-00022270: 6375 7272 656e 745f 7369 6d0a 0a20 2020  current_sim..   
-00022280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022290: 2020 2020 2020 2020 2069 6620 7265 706c           if repl
-000222a0: 6163 655f 7468 7265 7368 6f6c 6420 3e20  ace_threshold > 
-000222b0: 3130 2061 6e64 2074 7261 696c 5f73 696d  10 and trail_sim
-000222c0: 203e 2062 6573 745f 6765 6e65 5f73 636f   > best_gene_sco
-000222d0: 7265 3a0a 2020 2020 2020 2020 2020 2020  re:.            
-000222e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000222f0: 2020 2020 6265 7374 5f67 656e 655f 7363      best_gene_sc
-00022300: 6f72 6520 3d20 7472 6169 6c5f 7369 6d0a  ore = trail_sim.
-00022310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022330: 6669 6e61 6c5f 7265 7375 6c74 203d 2074  final_result = t
-00022340: 7269 616c 5f72 6573 756c 740a 2020 2020  rial_result.    
-00022350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022360: 2020 2020 2020 2020 2020 2020 6f2e 6765              o.ge
-00022370: 6e65 5b69 645d 203d 206e 6577 5f67 656e  ne[id] = new_gen
-00022380: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00022390: 2020 2020 2020 2020 2020 6966 2062 6573            if bes
-000223a0: 745f 6765 6e65 5f73 636f 7265 203e 2030  t_gene_score > 0
-000223b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000223c0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000223d0: 6c66 2e73 7563 6365 7373 6675 6c5f 7265  lf.successful_re
-000223e0: 7061 6972 202b 3d20 310a 2020 2020 2020  pair += 1.      
-000223f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022400: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00022410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022420: 2020 2020 7365 6c66 2e66 6169 6c65 645f      self.failed_
-00022430: 7265 7061 6972 202b 3d20 310a 2020 2020  repair += 1.    
-00022440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022450: 6461 7461 203d 206e 702e 636f 6e63 6174  data = np.concat
-00022460: 656e 6174 6528 5b64 6174 612c 206e 702e  enate([data, np.
-00022470: 7265 7368 6170 6528 6669 6e61 6c5f 7265  reshape(final_re
-00022480: 7375 6c74 2c20 282d 312c 2031 2929 5d2c  sult, (-1, 1))],
-00022490: 2061 7869 733d 3129 0a0a 2020 2020 6465   axis=1)..    de
-000224a0: 6620 7570 6461 7465 5f73 656d 616e 7469  f update_semanti
-000224b0: 635f 7265 7061 6972 5f69 6e70 7574 5f6d  c_repair_input_m
-000224c0: 6174 7269 7828 7365 6c66 2c20 706f 7075  atrix(self, popu
-000224d0: 6c61 7469 6f6e 293a 0a20 2020 2020 2020  lation):.       
-000224e0: 2062 6573 745f 696e 6420 3d20 736f 7274   best_ind = sort
-000224f0: 6564 2870 6f70 756c 6174 696f 6e2c 206b  ed(population, k
-00022500: 6579 3d6c 616d 6264 6120 783a 2078 2e66  ey=lambda x: x.f
-00022510: 6974 6e65 7373 2e77 7661 6c75 6573 295b  itness.wvalues)[
-00022520: 2d31 5d0a 2020 2020 2020 2020 6964 203d  -1].        id =
-00022530: 206e 702e 6172 6773 6f72 7428 6265 7374   np.argsort(best
-00022540: 5f69 6e64 2e63 6173 655f 7661 6c75 6573  _ind.case_values
-00022550: 295b 2d32 303a 5d0a 2020 2020 2020 2020  )[-20:].        
-00022560: 7365 6c66 2e73 656d 616e 7469 635f 7265  self.semantic_re
-00022570: 7061 6972 5f69 6e70 7574 203d 2073 656c  pair_input = sel
-00022580: 662e 585b 6964 5d0a 2020 2020 2020 2020  f.X[id].        
-00022590: 7365 6c66 2e73 656d 616e 7469 635f 7265  self.semantic_re
-000225a0: 7061 6972 5f74 6172 6765 7420 3d20 7365  pair_target = se
-000225b0: 6c66 2e79 5b69 645d 0a0a 2020 2020 6465  lf.y[id]..    de
-000225c0: 6620 7374 6174 6973 7469 6361 6c5f 7265  f statistical_re
-000225d0: 7375 6c74 5f75 7064 6174 6528 7365 6c66  sult_update(self
-000225e0: 2c20 706f 7075 6c61 7469 6f6e 2c20 7665  , population, ve
-000225f0: 7262 6f73 6529 3a0a 2020 2020 2020 2020  rbose):.        
-00022600: 6966 2073 656c 662e 7465 7374 5f66 756e  if self.test_fun
-00022610: 2021 3d20 4e6f 6e65 3a0a 2020 2020 2020   != None:.      
-00022620: 2020 2020 2020 7365 6c66 2e73 6563 6f6e        self.secon
-00022630: 645f 6c61 7965 725f 6765 6e65 7261 7469  d_layer_generati
-00022640: 6f6e 2873 656c 662e 582c 2073 656c 662e  on(self.X, self.
-00022650: 7929 0a20 2020 2020 2020 2020 2020 2074  y).            t
-00022660: 7261 696e 696e 675f 6c6f 7373 203d 2073  raining_loss = s
-00022670: 656c 662e 7465 7374 5f66 756e 5b30 5d2e  elf.test_fun[0].
-00022680: 7072 6564 6963 745f 6c6f 7373 2829 0a20  predict_loss(). 
-00022690: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000226a0: 7472 6169 6e5f 6461 7461 5f68 6973 746f  train_data_histo
-000226b0: 7279 2e61 7070 656e 6428 7472 6169 6e69  ry.append(traini
-000226c0: 6e67 5f6c 6f73 7329 0a20 2020 2020 2020  ng_loss).       
-000226d0: 2020 2020 2074 6573 7469 6e67 5f6c 6f73       testing_los
-000226e0: 7320 3d20 7365 6c66 2e74 6573 745f 6675  s = self.test_fu
-000226f0: 6e5b 315d 2e70 7265 6469 6374 5f6c 6f73  n[1].predict_los
-00022700: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
-00022710: 7365 6c66 2e74 6573 745f 6461 7461 5f68  self.test_data_h
-00022720: 6973 746f 7279 2e61 7070 656e 6428 7465  istory.append(te
-00022730: 7374 696e 675f 6c6f 7373 290a 2020 2020  sting_loss).    
-00022740: 2020 2020 2020 2020 6966 2076 6572 626f          if verbo
-00022750: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00022760: 2020 2020 7072 696e 7428 2754 7261 696e      print('Train
-00022770: 696e 6720 4c6f 7373 272c 2074 7261 696e  ing Loss', train
-00022780: 696e 675f 6c6f 7373 290a 2020 2020 2020  ing_loss).      
-00022790: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-000227a0: 2754 6573 7469 6e67 204c 6f73 7327 2c20  'Testing Loss', 
-000227b0: 7465 7374 696e 675f 6c6f 7373 290a 2020  testing_loss).  
-000227c0: 2020 2020 2020 2020 2020 7365 6c66 2e66            self.f
-000227d0: 6974 6e65 7373 5f68 6973 746f 7279 2e61  itness_history.a
-000227e0: 7070 656e 6428 6e70 2e6d 6561 6e28 5b69  ppend(np.mean([i
-000227f0: 6e64 2e66 6974 6e65 7373 2e77 7661 6c75  nd.fitness.wvalu
-00022800: 6573 5b30 5d20 666f 7220 696e 6420 696e  es[0] for ind in
-00022810: 2070 6f70 756c 6174 696f 6e5d 2929 0a20   population])). 
-00022820: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00022830: 6469 7665 7273 6974 795f 6869 7374 6f72  diversity_histor
-00022840: 792e 6170 7065 6e64 2873 656c 662e 6469  y.append(self.di
-00022850: 7665 7273 6974 795f 6361 6c63 756c 6174  versity_calculat
-00022860: 696f 6e28 706f 7075 6c61 7469 6f6e 2929  ion(population))
-00022870: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00022880: 662e 6172 6368 6976 655f 636f 735f 7369  f.archive_cos_si
-00022890: 6d69 6c61 7269 7479 5f68 6973 746f 7279  milarity_history
-000228a0: 2e61 7070 656e 6428 7365 6c66 2e63 6f73  .append(self.cos
-000228b0: 5f73 696d 696c 6172 6974 795f 6361 6c63  _similarity_calc
-000228c0: 756c 6174 696f 6e28 7365 6c66 2e68 6f66  ulation(self.hof
-000228d0: 2929 0a20 2020 2020 2020 2020 2020 2073  )).            s
-000228e0: 656c 662e 6172 6368 6976 655f 6669 746e  elf.archive_fitn
-000228f0: 6573 735f 6869 7374 6f72 792e 6170 7065  ess_history.appe
-00022900: 6e64 286e 702e 6d65 616e 285b 696e 642e  nd(np.mean([ind.
-00022910: 6669 746e 6573 732e 7776 616c 7565 735b  fitness.wvalues[
-00022920: 305d 2066 6f72 2069 6e64 2069 6e20 7365  0] for ind in se
-00022930: 6c66 2e68 6f66 5d29 290a 2020 2020 2020  lf.hof])).      
-00022940: 2020 2020 2020 7365 6c66 2e61 7263 6869        self.archi
-00022950: 7665 5f64 6976 6572 7369 7479 5f68 6973  ve_diversity_his
-00022960: 746f 7279 2e61 7070 656e 6428 7365 6c66  tory.append(self
-00022970: 2e64 6976 6572 7369 7479 5f63 616c 6375  .diversity_calcu
-00022980: 6c61 7469 6f6e 2829 290a 0a20 2020 2064  lation())..    d
-00022990: 6566 2073 656c 665f 6164 6170 7469 7665  ef self_adaptive
-000229a0: 5f65 766f 6c75 7469 6f6e 2873 656c 662c  _evolution(self,
-000229b0: 206f 6666 7370 7269 6e67 293a 0a20 2020   offspring):.   
-000229c0: 2020 2020 2069 6620 7365 6c66 2e69 6e74       if self.int
-000229d0: 726f 6e5f 7072 6f62 6162 696c 6974 7920  ron_probability 
-000229e0: 3e20 303a 0a20 2020 2020 2020 2020 2020  > 0:.           
-000229f0: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-00022a00: 302c 206c 656e 286f 6666 7370 7269 6e67  0, len(offspring
-00022a10: 292c 2032 293a 0a20 2020 2020 2020 2020  ), 2):.         
-00022a20: 2020 2020 2020 2069 6620 7261 6e64 6f6d         if random
-00022a30: 2e72 616e 646f 6d28 2920 3c20 7365 6c66  .random() < self
-00022a40: 2e63 726f 7373 5f70 623a 0a20 2020 2020  .cross_pb:.     
-00022a50: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00022a60: 2c20 6220 3d20 6f66 6673 7072 696e 675b  , b = offspring[
-00022a70: 695d 2e70 6172 616d 6574 6572 735b 2741  i].parameters['A
-00022a80: 6374 6976 6547 656e 6527 5d2c 206f 6666  ctiveGene'], off
-00022a90: 7370 7269 6e67 5b69 202b 2031 5d2e 7061  spring[i + 1].pa
-00022aa0: 7261 6d65 7465 7273 5b27 4163 7469 7665  rameters['Active
-00022ab0: 4765 6e65 275d 0a20 2020 2020 2020 2020  Gene'].         
-00022ac0: 2020 2020 2020 2020 2020 2061 2c20 6220             a, b 
-00022ad0: 3d20 6378 5477 6f50 6f69 6e74 2861 2c20  = cxTwoPoint(a, 
-00022ae0: 6229 0a20 2020 2020 2020 2020 2020 2020  b).             
-00022af0: 2020 2020 2020 206f 6666 7370 7269 6e67         offspring
-00022b00: 5b69 5d2e 7061 7261 6d65 7465 7273 5b27  [i].parameters['
-00022b10: 4163 7469 7665 4765 6e65 275d 2c20 6f66  ActiveGene'], of
-00022b20: 6673 7072 696e 675b 6920 2b20 315d 2e70  fspring[i + 1].p
-00022b30: 6172 616d 6574 6572 735b 2741 6374 6976  arameters['Activ
-00022b40: 6547 656e 6527 5d20 3d20 612c 2062 0a0a  eGene'] = a, b..
-00022b50: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00022b60: 6920 696e 2072 616e 6765 2830 2c20 6c65  i in range(0, le
-00022b70: 6e28 6f66 6673 7072 696e 6729 293a 0a20  n(offspring)):. 
-00022b80: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00022b90: 6620 7261 6e64 6f6d 2e72 616e 646f 6d28  f random.random(
-00022ba0: 2920 3c20 7365 6c66 2e6d 7574 6174 696f  ) < self.mutatio
-00022bb0: 6e5f 7062 3a0a 2020 2020 2020 2020 2020  n_pb:.          
-00022bc0: 2020 2020 2020 2020 2020 6120 3d20 6f66            a = of
-00022bd0: 6673 7072 696e 675b 695d 2e70 6172 616d  fspring[i].param
-00022be0: 6574 6572 735b 2741 6374 6976 6547 656e  eters['ActiveGen
-00022bf0: 6527 5d0a 2020 2020 2020 2020 2020 2020  e'].            
-00022c00: 2020 2020 2020 2020 612c 203d 206d 7574          a, = mut
-00022c10: 466c 6970 4269 7428 612c 2030 2e31 290a  FlipBit(a, 0.1).
-00022c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022c30: 2020 2020 6f66 6673 7072 696e 675b 695d      offspring[i]
-00022c40: 2e70 6172 616d 6574 6572 735b 2741 6374  .parameters['Act
-00022c50: 6976 6547 656e 6527 5d20 3d20 610a 0a20  iveGene'] = a.. 
-00022c60: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-00022c70: 2069 6e20 7261 6e67 6528 302c 206c 656e   in range(0, len
-00022c80: 286f 6666 7370 7269 6e67 2929 3a0a 2020  (offspring)):.  
-00022c90: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00022ca0: 206e 702e 7375 6d28 6f66 6673 7072 696e   np.sum(offsprin
-00022cb0: 675b 695d 2e70 6172 616d 6574 6572 735b  g[i].parameters[
-00022cc0: 2741 6374 6976 6547 656e 6527 5d29 203d  'ActiveGene']) =
-00022cd0: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
-00022ce0: 2020 2020 2020 2020 2069 6e64 6578 203d           index =
-00022cf0: 206e 702e 7261 6e64 6f6d 2e72 616e 6469   np.random.randi
-00022d00: 6e74 2830 2c20 6c65 6e28 6f66 6673 7072  nt(0, len(offspr
-00022d10: 696e 675b 695d 2e70 6172 616d 6574 6572  ing[i].parameter
-00022d20: 735b 2741 6374 6976 6547 656e 6527 5d29  s['ActiveGene'])
-00022d30: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00022d40: 2020 2020 2020 6f66 6673 7072 696e 675b        offspring[
-00022d50: 695d 2e70 6172 616d 6574 6572 735b 2741  i].parameters['A
-00022d60: 6374 6976 6547 656e 6527 5d5b 696e 6465  ctiveGene'][inde
-00022d70: 785d 203d 2031 0a0a 2020 2020 6465 6620  x] = 1..    def 
-00022d80: 7365 6c66 5f61 6461 7074 6976 655f 6d75  self_adaptive_mu
-00022d90: 7461 7469 6f6e 2873 656c 662c 206f 2c20  tation(self, o, 
-00022da0: 706f 7075 6c61 7469 6f6e 293a 0a20 2020  population):.   
-00022db0: 2020 2020 2069 6620 7365 6c66 2e62 6173       if self.bas
-00022dc0: 655f 6c65 6172 6e65 7220 3d3d 2027 4c61  e_learner == 'La
-00022dd0: 7373 6f27 3a0a 2020 2020 2020 2020 2020  sso':.          
-00022de0: 2020 6661 6374 6f72 203d 206e 702e 7261    factor = np.ra
-00022df0: 6e64 6f6d 2e75 6e69 666f 726d 2830 2e35  ndom.uniform(0.5
-00022e00: 2c20 312c 2031 295b 305d 0a20 2020 2020  , 1, 1)[0].     
-00022e10: 2020 2020 2020 2061 2c20 6220 3d20 7365         a, b = se
-00022e20: 6c52 616e 646f 6d28 706f 7075 6c61 7469  lRandom(populati
-00022e30: 6f6e 2c20 3229 0a20 2020 2020 2020 2020  on, 2).         
-00022e40: 2020 206f 2e70 6172 616d 6574 6572 735b     o.parameters[
-00022e50: 274c 6173 736f 275d 203d 206f 2e70 6172  'Lasso'] = o.par
-00022e60: 616d 6574 6572 735b 274c 6173 736f 275d  ameters['Lasso']
-00022e70: 202b 205c 0a20 2020 2020 2020 2020 2020   + \.           
+00022100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022110: 6f2e 6765 6e65 5b69 645d 203d 206d 7574  o.gene[id] = mut
+00022120: 556e 6966 6f72 6d28 6765 6e65 2c20 7365  Uniform(gene, se
+00022130: 6c66 2e74 6f6f 6c62 6f78 2e65 7870 725f  lf.toolbox.expr_
+00022140: 6d75 742c 2073 656c 662e 7073 6574 295b  mut, self.pset)[
+00022150: 305d 0a20 2020 2020 2020 2020 2020 2020  0].             
+00022160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022170: 2020 2069 6620 6368 6563 6b5f 696e 6974     if check_init
+00022180: 6961 6c69 7a61 7469 6f6e 3a0a 2020 2020  ialization:.    
+00022190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000221a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000221b0: 6f2e 6765 6e65 5b69 645d 203d 2073 656c  o.gene[id] = sel
+000221c0: 662e 6e65 775f 7472 6565 5f67 656e 6572  f.new_tree_gener
+000221d0: 6174 696f 6e28 290a 2020 2020 2020 2020  ation().        
+000221e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000221f0: 2020 2020 7072 6576 696f 7573 5f73 6574      previous_set
+00022200: 2e61 6464 2873 7472 2867 656e 6529 290a  .add(str(gene)).
+00022210: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022220: 2069 6620 7365 6c66 2e62 6c6f 6174 5f63   if self.bloat_c
+00022230: 6f6e 7472 6f6c 2069 7320 6e6f 7420 4e6f  ontrol is not No
+00022240: 6e65 2061 6e64 2073 656c 662e 626c 6f61  ne and self.bloa
+00022250: 745f 636f 6e74 726f 6c2e 6765 7428 2770  t_control.get('p
+00022260: 7275 6e65 5f61 6e64 5f70 6c61 6e74 272c  rune_and_plant',
+00022270: 2046 616c 7365 293a 0a20 2020 2020 2020   False):.       
+00022280: 2020 2020 2020 2020 2020 2020 2023 2054               # T
+00022290: 7261 6469 7469 6f6e 616c 2050 7275 6e65  raditional Prune
+000222a0: 2d61 6e64 2d50 6c61 6e74 2028 4166 7465  -and-Plant (Afte
+000222b0: 7220 4d75 7461 7469 6f6e 290a 2020 2020  r Mutation).    
+000222c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000222d0: 6966 2072 616e 646f 6d2e 7261 6e64 6f6d  if random.random
+000222e0: 2829 203c 2073 656c 662e 626c 6f61 745f  () < self.bloat_
+000222f0: 636f 6e74 726f 6c2e 6765 7428 2770 7275  control.get('pru
+00022300: 6e65 5f61 6e64 5f70 6c61 6e74 5f70 6227  ne_and_plant_pb'
+00022310: 2c20 3129 3a0a 2020 2020 2020 2020 2020  , 1):.          
+00022320: 2020 2020 2020 2020 2020 2020 2020 6f66                of
+00022330: 6673 7072 696e 6720 3d20 7365 6c66 2e70  fspring = self.p
+00022340: 7275 6e65 5f61 6e64 5f70 6c61 6e74 286f  rune_and_plant(o
+00022350: 6666 7370 7269 6e67 2c20 6265 7374 3d46  ffspring, best=F
+00022360: 616c 7365 290a 0a20 2020 2020 2020 2020  alse)..         
+00022370: 2020 2020 2020 2023 2076 6572 7920 7374         # very st
+00022380: 726f 6e67 206d 7574 6174 696f 6e0a 2020  rong mutation.  
+00022390: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000223a0: 2073 656c 662e 696e 7472 6f6e 5f74 6872   self.intron_thr
+000223b0: 6573 686f 6c64 203e 2030 3a0a 2020 2020  eshold > 0:.    
+000223c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000223d0: 666f 7220 6f20 696e 206f 6666 7370 7269  for o in offspri
+000223e0: 6e67 3a0a 2020 2020 2020 2020 2020 2020  ng:.            
+000223f0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00022400: 6964 2c20 6765 6e65 2069 6e20 656e 756d  id, gene in enum
+00022410: 6572 6174 6528 6f2e 6765 6e65 293a 0a20  erate(o.gene):. 
+00022420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022430: 2020 2020 2020 2020 2020 2069 6620 6f2e             if o.
+00022440: 636f 6566 5b69 645d 203c 2073 656c 662e  coef[id] < self.
+00022450: 696e 7472 6f6e 5f74 6872 6573 686f 6c64  intron_threshold
+00022460: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00022470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022480: 2020 6f2e 6765 6e65 5b69 645d 2c20 3d20    o.gene[id], = 
+00022490: 7365 6c66 2e6e 6575 7472 616c 5f6d 7574  self.neutral_mut
+000224a0: 6174 696f 6e28 6765 6e65 290a 0a20 2020  ation(gene)..   
+000224b0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000224c0: 662e 7365 6d61 6e74 6963 5f72 6570 6169  f.semantic_repai
+000224d0: 725f 6665 6174 7572 6573 286f 6666 7370  r_features(offsp
+000224e0: 7269 6e67 2c20 6578 7465 726e 616c 5f61  ring, external_a
+000224f0: 7263 6869 7665 290a 0a20 2020 2020 2020  rchive)..       
+00022500: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00022510: 2e62 6173 655f 6c65 6172 6e65 7220 3d3d  .base_learner ==
+00022520: 2027 4879 6272 6964 273a 0a20 2020 2020   'Hybrid':.     
+00022530: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00022540: 204d 7574 6174 696f 6e20 666f 7220 6261   Mutation for ba
+00022550: 7365 206c 6561 726e 6572 730a 2020 2020  se learners.    
+00022560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022570: 6261 7365 5f6d 6f64 656c 7320 3d20 5b6f  base_models = [o
+00022580: 2e62 6173 655f 6d6f 6465 6c20 666f 7220  .base_model for 
+00022590: 6f20 696e 206f 6666 7370 7269 6e67 5d0a  o in offspring].
+000225a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000225b0: 2020 2020 6261 7365 5f6d 6f64 656c 7320      base_models 
+000225c0: 3d20 7661 7241 6e64 2862 6173 655f 6d6f  = varAnd(base_mo
+000225d0: 6465 6c73 2c20 7365 6c66 2e74 706f 745f  dels, self.tpot_
+000225e0: 6d6f 6465 6c2e 5f74 6f6f 6c62 6f78 2c20  model._toolbox, 
+000225f0: 302e 352c 2030 2e31 290a 2020 2020 2020  0.5, 0.1).      
+00022600: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00022610: 7220 6f2c 2062 2069 6e20 7a69 7028 6f66  r o, b in zip(of
+00022620: 6673 7072 696e 672c 2062 6173 655f 6d6f  fspring, base_mo
+00022630: 6465 6c73 293a 0a20 2020 2020 2020 2020  dels):.         
+00022640: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+00022650: 2e62 6173 655f 6d6f 6465 6c20 3d20 620a  .base_model = b.
+00022660: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022670: 2069 6620 7365 6c66 2e62 6173 655f 6c65   if self.base_le
+00022680: 6172 6e65 7220 3d3d 2027 536f 6674 2d50  arner == 'Soft-P
+00022690: 4c54 7265 6527 3a0a 2020 2020 2020 2020  LTree':.        
+000226a0: 2020 2020 2020 2020 2020 2020 2320 5570              # Up
+000226b0: 6461 7465 2070 6172 7469 7469 6f6e 2073  date partition s
+000226c0: 6368 656d 650a 2020 2020 2020 2020 2020  cheme.          
+000226d0: 2020 2020 2020 2020 2020 7061 7274 6974            partit
+000226e0: 696f 6e5f 7363 6865 6d65 7320 3d20 5b6f  ion_schemes = [o
+000226f0: 2e70 6172 7469 7469 6f6e 5f73 6368 656d  .partition_schem
+00022700: 6520 666f 7220 6f20 696e 206f 6666 7370  e for o in offsp
+00022710: 7269 6e67 5d0a 2020 2020 2020 2020 2020  ring].          
+00022720: 2020 2020 2020 2020 2020 2320 5265 6164            # Read
+00022730: 2068 7970 6572 7061 7261 6d65 7465 7273   hyperparameters
+00022740: 2066 726f 6d20 7061 7261 6d65 7465 7220   from parameter 
+00022750: 6469 6374 0a20 2020 2020 2020 2020 2020  dict.           
+00022760: 2020 2020 2020 2020 2070 735f 7472 6565           ps_tree
+00022770: 5f63 726f 7373 5f70 6220 3d20 7365 6c66  _cross_pb = self
+00022780: 2e70 6172 616d 2e67 6574 2827 7073 5f74  .param.get('ps_t
+00022790: 7265 655f 6372 6f73 735f 7062 272c 2030  ree_cross_pb', 0
+000227a0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000227b0: 2020 2020 2020 7073 5f74 7265 655f 6d75        ps_tree_mu
+000227c0: 7461 7465 5f70 6220 3d20 7365 6c66 2e70  tate_pb = self.p
+000227d0: 6172 616d 2e67 6574 2827 7073 5f74 7265  aram.get('ps_tre
+000227e0: 655f 6d75 7461 7465 5f70 6227 2c20 3029  e_mutate_pb', 0)
+000227f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022800: 2020 2020 2073 6368 656d 655f 746f 6f6c       scheme_tool
+00022810: 626f 783a 2054 6f6f 6c62 6f78 203d 2070  box: Toolbox = p
+00022820: 6172 7469 7469 6f6e 5f73 6368 656d 655f  artition_scheme_
+00022830: 746f 6f6c 626f 7828 7365 6c66 2e70 6172  toolbox(self.par
+00022840: 7469 7469 6f6e 5f6e 756d 6265 722c 0a20  tition_number,. 
+00022850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022890: 2020 2020 2020 7073 5f74 7265 655f 6372        ps_tree_cr
+000228a0: 6f73 735f 7062 2c20 7073 5f74 7265 655f  oss_pb, ps_tree_
+000228b0: 6d75 7461 7465 5f70 6229 0a20 2020 2020  mutate_pb).     
+000228c0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+000228d0: 6172 7469 7469 6f6e 5f73 6368 656d 6573  artition_schemes
+000228e0: 203d 2070 6172 7469 7469 6f6e 5f73 6368   = partition_sch
+000228f0: 656d 655f 7661 7241 6e64 2870 6172 7469  eme_varAnd(parti
+00022900: 7469 6f6e 5f73 6368 656d 6573 2c0a 2020  tion_schemes,.  
+00022910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022940: 2020 2020 2020 2020 2020 2020 2020 7363                sc
+00022950: 6865 6d65 5f74 6f6f 6c62 6f78 2c0a 2020  heme_toolbox,.  
+00022960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022990: 2020 2020 2020 2020 2020 2020 2020 6378                cx
+000229a0: 7062 3d31 2c20 6d75 7470 623d 3129 0a20  pb=1, mutpb=1). 
+000229b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000229c0: 2020 2066 6f72 206f 2c20 6220 696e 207a     for o, b in z
+000229d0: 6970 286f 6666 7370 7269 6e67 2c20 7061  ip(offspring, pa
+000229e0: 7274 6974 696f 6e5f 7363 6865 6d65 7329  rtition_schemes)
+000229f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00022a00: 2020 2020 2020 2020 2020 6f2e 7061 7274            o.part
+00022a10: 6974 696f 6e5f 7363 6865 6d65 203d 2062  ition_scheme = b
+00022a20: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00022a30: 2020 7365 6c66 2e73 656c 665f 6164 6170    self.self_adap
+00022a40: 7469 7665 5f65 766f 6c75 7469 6f6e 286f  tive_evolution(o
+00022a50: 6666 7370 7269 6e67 290a 2020 2020 2020  ffspring).      
+00022a60: 2020 2020 2020 2020 2020 666f 7220 6f20            for o 
+00022a70: 696e 206f 6666 7370 7269 6e67 3a0a 2020  in offspring:.  
+00022a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022a90: 2020 7365 6c66 2e73 656c 665f 6164 6170    self.self_adap
+00022aa0: 7469 7665 5f6d 7574 6174 696f 6e28 6f2c  tive_mutation(o,
+00022ab0: 2070 6f70 756c 6174 696f 6e29 0a0a 2020   population)..  
+00022ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022ad0: 2020 6966 206c 656e 286e 6577 5f6f 6666    if len(new_off
+00022ae0: 7370 7269 6e67 2920 3c20 706f 705f 7369  spring) < pop_si
+00022af0: 7a65 3a0a 2020 2020 2020 2020 2020 2020  ze:.            
+00022b00: 2020 2020 2020 2020 2020 2020 2320 6368              # ch
+00022b10: 6563 6b69 6e67 2072 6564 756e 6461 6e74  ecking redundant
+00022b20: 2069 6e64 6976 6964 7561 6c73 0a20 2020   individuals.   
+00022b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022b40: 2020 2020 2069 6620 7365 6c66 2e61 6c6c       if self.all
+00022b50: 6f77 5f72 6570 6574 6974 6976 6520 6f72  ow_repetitive or
+00022b60: 2028 6e6f 7420 696e 6469 7669 6475 616c   (not individual
+00022b70: 5f74 6f5f 7475 706c 6528 6f29 2069 6e20  _to_tuple(o) in 
+00022b80: 7365 6c66 2e65 7661 6c75 6174 6564 5f70  self.evaluated_p
+00022b90: 6f70 2920 6f72 205c 0a20 2020 2020 2020  op) or \.       
+00022ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022bb0: 2020 2020 2028 7365 6c66 2e67 656e 655f       (self.gene_
+00022bc0: 6e75 6d20 3d3d 2031 2061 6e64 2063 6f75  num == 1 and cou
+00022bd0: 6e74 203e 2070 6f70 5f73 697a 6520 2a20  nt > pop_size * 
+00022be0: 3130 293a 0a20 2020 2020 2020 2020 2020  10):.           
+00022bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022c00: 2023 2073 6f6d 6574 696d 652c 2077 6865   # sometime, whe
+00022c10: 6e20 6765 6e65 206e 756d 2069 7320 7665  n gene num is ve
+00022c20: 7279 2073 6d61 6c6c 2c20 6974 2069 7320  ry small, it is 
+00022c30: 6861 7264 2074 6f20 6765 6e65 7261 7465  hard to generate
+00022c40: 2061 2075 6e69 7175 6520 696e 6469 7669   a unique indivi
+00022c50: 6475 616c 0a20 2020 2020 2020 2020 2020  dual.           
+00022c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022c70: 2073 656c 662e 6576 616c 7561 7465 645f   self.evaluated_
+00022c80: 706f 702e 6164 6428 696e 6469 7669 6475  pop.add(individu
+00022c90: 616c 5f74 6f5f 7475 706c 6528 6f29 290a  al_to_tuple(o)).
+00022ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022cb0: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
+00022cc0: 6f66 6673 7072 696e 672e 6170 7065 6e64  offspring.append
+00022cd0: 286f 290a 0a20 2020 2020 2020 2020 2020  (o)..           
+00022ce0: 2061 7373 6572 7420 6c65 6e28 6e65 775f   assert len(new_
+00022cf0: 6f66 6673 7072 696e 6729 203d 3d20 706f  offspring) == po
+00022d00: 705f 7369 7a65 0a20 2020 2020 2020 2020  p_size.         
+00022d10: 2020 2069 6620 7365 6c66 2e62 6c6f 6174     if self.bloat
+00022d20: 5f63 6f6e 7472 6f6c 2069 7320 6e6f 7420  _control is not 
+00022d30: 4e6f 6e65 2061 6e64 2073 656c 662e 626c  None and self.bl
+00022d40: 6f61 745f 636f 6e74 726f 6c2e 6765 7428  oat_control.get(
+00022d50: 2773 7562 7472 6565 5f61 7070 726f 7869  'subtree_approxi
+00022d60: 6d61 7469 6f6e 272c 2046 616c 7365 293a  mation', False):
+00022d70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022d80: 2073 7461 7469 635f 6c69 6d69 745f 6675   static_limit_fu
+00022d90: 6e63 7469 6f6e 203d 2073 7461 7469 634c  nction = staticL
+00022da0: 696d 6974 5f6d 756c 7469 706c 655f 6765  imit_multiple_ge
+00022db0: 6e65 280a 2020 2020 2020 2020 2020 2020  ne(.            
+00022dc0: 2020 2020 2020 2020 6b65 793d 6f70 6572          key=oper
+00022dd0: 6174 6f72 2e61 7474 7267 6574 7465 7228  ator.attrgetter(
+00022de0: 2268 6569 6768 7422 292c 0a20 2020 2020  "height"),.     
+00022df0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00022e00: 6178 5f76 616c 7565 3d73 656c 662e 6d61  ax_value=self.ma
+00022e10: 785f 6865 6967 6874 2c0a 2020 2020 2020  x_height,.      
+00022e20: 2020 2020 2020 2020 2020 2020 2020 6d69                mi
+00022e30: 6e5f 7661 6c75 653d 7365 6c66 2e6d 696e  n_value=self.min
+00022e40: 5f68 6569 6768 742c 0a20 2020 2020 2020  _height,.       
+00022e50: 2020 2020 2020 2020 2020 2020 2072 616e               ran
+00022e60: 646f 6d5f 6669 783d 4661 6c73 650a 2020  dom_fix=False.  
+00022e70: 2020 2020 2020 2020 2020 2020 2020 290a                ).
 00022e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022e90: 2020 2020 2020 2020 2066 6163 746f 7220           factor 
-00022ea0: 2a20 2861 2e70 6172 616d 6574 6572 735b  * (a.parameters[
-00022eb0: 274c 6173 736f 275d 202d 2062 2e70 6172  'Lasso'] - b.par
-00022ec0: 616d 6574 6572 735b 274c 6173 736f 275d  ameters['Lasso']
-00022ed0: 290a 2020 2020 2020 2020 2020 2020 6f2e  ).            o.
-00022ee0: 7061 7261 6d65 7465 7273 5b27 4c61 7373  parameters['Lass
-00022ef0: 6f27 5d20 3d20 6e70 2e63 6c69 7028 6f2e  o'] = np.clip(o.
-00022f00: 7061 7261 6d65 7465 7273 5b27 4c61 7373  parameters['Lass
-00022f10: 6f27 5d2c 202d 352c 2030 290a 2020 2020  o'], -5, 0).    
-00022f20: 2020 2020 6966 2073 656c 662e 6c67 705f      if self.lgp_
-00022f30: 6d6f 6465 203d 3d20 2752 6567 6973 7465  mode == 'Registe
-00022f40: 7227 3a0a 2020 2020 2020 2020 2020 2020  r':.            
-00022f50: 6e65 775f 7265 6769 7374 6572 203d 206e  new_register = n
-00022f60: 702e 7261 6e64 6f6d 2e72 616e 6469 6e74  p.random.randint
-00022f70: 2830 2c20 7365 6c66 2e6e 756d 6265 725f  (0, self.number_
-00022f80: 6f66 5f72 6567 6973 7465 722c 2073 656c  of_register, sel
-00022f90: 662e 6765 6e65 5f6e 756d 290a 2020 2020  f.gene_num).    
-00022fa0: 2020 2020 2020 2020 666c 6970 5f62 6974          flip_bit
-00022fb0: 203d 206e 702e 7261 6e64 6f6d 2e72 616e   = np.random.ran
-00022fc0: 6428 7365 6c66 2e67 656e 655f 6e75 6d29  d(self.gene_num)
-00022fd0: 203c 2073 656c 662e 7265 6769 7374 6572   < self.register
-00022fe0: 5f6d 7574 6174 696f 6e5f 7072 6f62 6162  _mutation_probab
-00022ff0: 696c 6974 790a 2020 2020 2020 2020 2020  ility.          
-00023000: 2020 6f2e 7061 7261 6d65 7465 7273 5b27    o.parameters['
-00023010: 5265 6769 7374 6572 275d 5b66 6c69 705f  Register'][flip_
-00023020: 6269 745d 203d 206e 6577 5f72 6567 6973  bit] = new_regis
-00023030: 7465 725b 666c 6970 5f62 6974 5d0a 2020  ter[flip_bit].  
-00023040: 2020 2020 2020 6966 2073 656c 662e 6261        if self.ba
-00023050: 7365 5f6c 6561 726e 6572 203d 3d20 2744  se_learner == 'D
-00023060: 796e 616d 6963 2d44 5427 3a0a 2020 2020  ynamic-DT':.    
-00023070: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00023080: 2020 2020 2020 2020 4479 6e61 6d69 6361          Dynamica
-00023090: 6c6c 7920 7475 6e65 2074 6865 206c 6561  lly tune the lea
-000230a0: 6620 7369 7a65 206f 6620 6465 6369 7369  f size of decisi
-000230b0: 6f6e 2074 7265 650a 2020 2020 2020 2020  on tree.        
-000230c0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000230d0: 2020 2020 2320 6261 7365 206c 6561 726e      # base learn
-000230e0: 6572 206d 7574 6174 696f 6e0a 2020 2020  er mutation.    
-000230f0: 2020 2020 2020 2020 6261 7365 5f6c 6561          base_lea
-00023100: 726e 6572 5f6d 7574 6174 696f 6e5f 7261  rner_mutation_ra
-00023110: 7465 203d 2030 2e31 0a20 2020 2020 2020  te = 0.1.       
-00023120: 2020 2020 2069 6620 7261 6e64 6f6d 2e72       if random.r
-00023130: 616e 646f 6d28 2920 3c20 6261 7365 5f6c  andom() < base_l
-00023140: 6561 726e 6572 5f6d 7574 6174 696f 6e5f  earner_mutation_
-00023150: 7261 7465 3a0a 2020 2020 2020 2020 2020  rate:.          
-00023160: 2020 2020 2020 6f2e 6479 6e61 6d69 635f        o.dynamic_
-00023170: 6c65 6166 5f73 697a 6520 3d20 6e70 2e63  leaf_size = np.c
-00023180: 6c69 7028 6f2e 6479 6e61 6d69 635f 6c65  lip(o.dynamic_le
-00023190: 6166 5f73 697a 6520 2b20 7261 6e64 6f6d  af_size + random
-000231a0: 2e63 686f 6963 6528 5b2d 312c 2031 5d29  .choice([-1, 1])
-000231b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000231c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000231d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000231e0: 312c 2031 3029 0a20 2020 2020 2020 2069  1, 10).        i
-000231f0: 6620 7365 6c66 2e62 6173 655f 6c65 6172  f self.base_lear
-00023200: 6e65 7220 3d3d 2027 4479 6e61 6d69 632d  ner == 'Dynamic-
-00023210: 4c6f 6769 7374 6963 5265 6772 6573 7369  LogisticRegressi
-00023220: 6f6e 273a 0a20 2020 2020 2020 2020 2020  on':.           
-00023230: 2022 2222 0a20 2020 2020 2020 2020 2020   """.           
-00023240: 2044 796e 616d 6963 616c 6c79 2074 756e   Dynamically tun
-00023250: 6520 7468 6520 7265 6775 6c61 7269 7a61  e the regulariza
-00023260: 7469 6f6e 2074 6572 6d20 6f66 206c 6f67  tion term of log
-00023270: 6973 7469 6320 7265 6772 6573 7369 6f6e  istic regression
-00023280: 0a20 2020 2020 2020 2020 2020 2022 2222  .            """
-00023290: 0a20 2020 2020 2020 2020 2020 2062 6173  .            bas
-000232a0: 655f 6c65 6172 6e65 725f 6d75 7461 7469  e_learner_mutati
-000232b0: 6f6e 5f72 6174 6520 3d20 302e 310a 2020  on_rate = 0.1.  
-000232c0: 2020 2020 2020 2020 2020 6966 2072 616e            if ran
-000232d0: 646f 6d2e 7261 6e64 6f6d 2829 203c 2062  dom.random() < b
-000232e0: 6173 655f 6c65 6172 6e65 725f 6d75 7461  ase_learner_muta
-000232f0: 7469 6f6e 5f72 6174 653a 0a20 2020 2020  tion_rate:.     
-00023300: 2020 2020 2020 2020 2020 206f 2e64 796e             o.dyn
-00023310: 616d 6963 5f72 6567 756c 6172 697a 6174  amic_regularizat
-00023320: 696f 6e20 3d20 6e70 2e63 6c69 7028 6f2e  ion = np.clip(o.
-00023330: 6479 6e61 6d69 635f 7265 6775 6c61 7269  dynamic_regulari
-00023340: 7a61 7469 6f6e 202a 2072 616e 646f 6d2e  zation * random.
-00023350: 6368 6f69 6365 285b 302e 312c 2031 305d  choice([0.1, 10]
-00023360: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00023370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023390: 2020 2020 2020 3165 2d34 2c20 3165 3429        1e-4, 1e4)
-000233a0: 0a0a 2020 2020 6465 6620 7472 6164 6974  ..    def tradit
-000233b0: 696f 6e61 6c5f 7061 7265 6e74 5f73 656c  ional_parent_sel
-000233c0: 6563 7469 6f6e 2873 656c 662c 2074 6f6f  ection(self, too
-000233d0: 6c62 6f78 2c20 7061 7265 6e74 2c20 6578  lbox, parent, ex
-000233e0: 7465 726e 616c 5f61 7263 6869 7665 293a  ternal_archive):
-000233f0: 0a20 2020 2020 2020 2023 2054 6865 2074  .        # The t
-00023400: 7261 6469 7469 6f6e 616c 2070 6172 656e  raditional paren
-00023410: 7420 7365 6c65 6374 696f 6e20 7072 6f63  t selection proc
-00023420: 6573 730a 2020 2020 2020 2020 6966 2073  ess.        if s
-00023430: 656c 662e 6261 7365 5f6c 6561 726e 6572  elf.base_learner
-00023440: 2069 6e20 5b27 4454 2d4c 5227 2c20 2742   in ['DT-LR', 'B
-00023450: 616c 616e 6365 642d 4454 2d4c 5227 2c20  alanced-DT-LR', 
-00023460: 2742 616c 616e 6365 642d 5244 542d 4c52  'Balanced-RDT-LR
-00023470: 275d 3a0a 2020 2020 2020 2020 2020 2020  ']:.            
-00023480: 2320 6d75 6c74 692d 6261 7365 206c 6561  # multi-base lea
-00023490: 726e 6572 2073 656c 6563 7469 6f6e 0a20  rner selection. 
-000234a0: 2020 2020 2020 2020 2020 2069 6620 7261             if ra
-000234b0: 6e64 6f6d 2e72 616e 646f 6d28 2920 3c20  ndom.random() < 
-000234c0: 7365 6c66 2e72 6d70 5f72 6174 696f 3a0a  self.rmp_ratio:.
-000234d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000234e0: 2320 6372 6f73 7320 6265 7477 6565 6e20  # cross between 
-000234f0: 6469 6666 6572 656e 7420 6d6f 6465 6c73  different models
-00023500: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023510: 2023 2030 2e32 352d 3e20 4141 2042 420a   # 0.25-> AA BB.
-00023520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023530: 2320 302e 3235 2d3e 2041 4220 4241 0a20  # 0.25-> AB BA. 
-00023540: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00023550: 6172 656e 745f 6120 3d20 7365 6c66 2e73  arent_a = self.s
-00023560: 616d 706c 655f 6d6f 6465 6c5f 6e61 6d65  ample_model_name
-00023570: 2870 6172 656e 7429 0a20 2020 2020 2020  (parent).       
-00023580: 2020 2020 2020 2020 206f 6666 7370 7269           offspri
-00023590: 6e67 5f61 203d 2074 6f6f 6c62 6f78 2e73  ng_a = toolbox.s
-000235a0: 656c 6563 7428 7061 7265 6e74 5f61 2c20  elect(parent_a, 
-000235b0: 3129 0a20 2020 2020 2020 2020 2020 2020  1).             
-000235c0: 2020 2070 6172 656e 745f 6220 3d20 7365     parent_b = se
-000235d0: 6c66 2e73 616d 706c 655f 6d6f 6465 6c5f  lf.sample_model_
-000235e0: 6e61 6d65 2870 6172 656e 7429 0a20 2020  name(parent).   
-000235f0: 2020 2020 2020 2020 2020 2020 206f 6666               off
-00023600: 7370 7269 6e67 5f62 203d 2074 6f6f 6c62  spring_b = toolb
-00023610: 6f78 2e73 656c 6563 7428 7061 7265 6e74  ox.select(parent
-00023620: 5f62 2c20 3129 0a20 2020 2020 2020 2020  _b, 1).         
-00023630: 2020 2020 2020 206f 6666 7370 7269 6e67         offspring
-00023640: 203d 205b 6f66 6673 7072 696e 675f 615b   = [offspring_a[
-00023650: 305d 2c20 6f66 6673 7072 696e 675f 625b  0], offspring_b[
-00023660: 305d 5d0a 2020 2020 2020 2020 2020 2020  0]].            
-00023670: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00023680: 2020 2020 2020 7061 7265 6e74 5f61 203d        parent_a =
-00023690: 2073 656c 662e 7361 6d70 6c65 5f6d 6f64   self.sample_mod
-000236a0: 656c 5f6e 616d 6528 7061 7265 6e74 290a  el_name(parent).
-000236b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000236c0: 6f66 6673 7072 696e 6720 3d20 746f 6f6c  offspring = tool
-000236d0: 626f 782e 7365 6c65 6374 2870 6172 656e  box.select(paren
-000236e0: 745f 612c 2032 290a 2020 2020 2020 2020  t_a, 2).        
-000236f0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00023700: 2020 2320 6e70 2e61 7267 6d69 6e28 5b70    # np.argmin([p
-00023710: 2e66 6974 6e65 7373 2066 6f72 2070 2069  .fitness for p i
-00023720: 6e20 706f 7075 6c61 7469 6f6e 5d29 0a20  n population]). 
-00023730: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00023740: 6c66 2e6e 756d 6265 725f 6f66 5f70 6172  lf.number_of_par
-00023750: 656e 7473 203e 2030 2061 6e64 2073 656c  ents > 0 and sel
-00023760: 662e 6c67 705f 6d6f 6465 3a0a 2020 2020  f.lgp_mode:.    
-00023770: 2020 2020 2020 2020 2020 2020 6f66 6673              offs
-00023780: 7072 696e 6720 3d20 5b5d 0a20 2020 2020  pring = [].     
-00023790: 2020 2020 2020 2020 2020 206f 6666 7370             offsp
-000237a0: 7269 6e67 2e61 7070 656e 6428 7365 6c66  ring.append(self
-000237b0: 2e6f 6666 7370 7269 6e67 5f67 656e 6572  .offspring_gener
-000237c0: 6174 696f 6e28 746f 6f6c 626f 782c 2070  ation(toolbox, p
-000237d0: 6172 656e 742c 0a20 2020 2020 2020 2020  arent,.         
-000237e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022e90: 7375 6274 7265 655f 6170 7072 6f78 696d  subtree_approxim
+00022ea0: 6174 696f 6e20 3d20 7374 6174 6963 5f6c  ation = static_l
+00022eb0: 696d 6974 5f66 756e 6374 696f 6e28 7365  imit_function(se
+00022ec0: 6c66 2e73 7562 7472 6565 5f61 7070 726f  lf.subtree_appro
+00022ed0: 7869 6d61 7469 6f6e 290a 2020 2020 2020  ximation).      
+00022ee0: 2020 2020 2020 2020 2020 6e65 775f 6f66            new_of
+00022ef0: 6673 7072 696e 6720 3d20 7375 6274 7265  fspring = subtre
+00022f00: 655f 6170 7072 6f78 696d 6174 696f 6e28  e_approximation(
+00022f10: 2a6e 6577 5f6f 6666 7370 7269 6e67 290a  *new_offspring).
+00022f20: 0a20 2020 2020 2020 2020 2020 2023 2054  .            # T
+00022f30: 6172 7065 6961 6e0a 2020 2020 2020 2020  arpeian.        
+00022f40: 2020 2020 6966 2073 656c 662e 626c 6f61      if self.bloa
+00022f50: 745f 636f 6e74 726f 6c20 616e 6420 7365  t_control and se
+00022f60: 6c66 2e62 6c6f 6174 5f63 6f6e 7472 6f6c  lf.bloat_control
+00022f70: 2e67 6574 2827 7461 7270 6569 616e 272c  .get('tarpeian',
+00022f80: 2046 616c 7365 293a 0a20 2020 2020 2020   False):.       
+00022f90: 2020 2020 2020 2020 2061 7667 5f73 697a           avg_siz
+00022fa0: 6520 3d20 6e70 2e6d 6561 6e28 5b6c 656e  e = np.mean([len
+00022fb0: 286f 2920 666f 7220 6f20 696e 206e 6577  (o) for o in new
+00022fc0: 5f6f 6666 7370 7269 6e67 5d29 0a20 2020  _offspring]).   
+00022fd0: 2020 2020 2020 2020 2020 2020 2063 616e               can
+00022fe0: 6469 6461 7465 7320 3d20 5b5d 0a20 2020  didates = [].   
+00022ff0: 2020 2020 2020 2020 2020 2020 2063 616e               can
+00023000: 6469 6461 7465 732e 6578 7465 6e64 286c  didates.extend(l
+00023010: 6973 7428 6669 6c74 6572 286c 616d 6264  ist(filter(lambd
+00023020: 6120 6f3a 206c 656e 286f 2920 3c3d 2061  a o: len(o) <= a
+00023030: 7667 5f73 697a 652c 206e 6577 5f6f 6666  vg_size, new_off
+00023040: 7370 7269 6e67 2929 290a 2020 2020 2020  spring))).      
+00023050: 2020 2020 2020 2020 2020 666f 7220 6f20            for o 
+00023060: 696e 2066 696c 7465 7228 6c61 6d62 6461  in filter(lambda
+00023070: 206f 3a20 6c65 6e28 6f29 203e 2061 7667   o: len(o) > avg
+00023080: 5f73 697a 652c 206e 6577 5f6f 6666 7370  _size, new_offsp
+00023090: 7269 6e67 293a 0a20 2020 2020 2020 2020  ring):.         
+000230a0: 2020 2020 2020 2020 2020 2023 2072 616e             # ran
+000230b0: 646f 6d20 6472 6f70 2073 6f6d 6520 6269  dom drop some bi
+000230c0: 6720 696e 6469 7669 6475 616c 730a 2020  g individuals.  
+000230d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000230e0: 2020 6966 2072 616e 646f 6d2e 7261 6e64    if random.rand
+000230f0: 6f6d 2829 203e 2073 656c 662e 626c 6f61  om() > self.bloa
+00023100: 745f 636f 6e74 726f 6c2e 6765 7428 2772  t_control.get('r
+00023110: 6564 7563 655f 6672 6163 7469 6f6e 272c  educe_fraction',
+00023120: 2030 2e33 293a 0a20 2020 2020 2020 2020   0.3):.         
+00023130: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00023140: 616e 6469 6461 7465 732e 6170 7065 6e64  andidates.append
+00023150: 286f 290a 2020 2020 2020 2020 2020 2020  (o).            
+00023160: 2020 2020 6e65 775f 6f66 6673 7072 696e      new_offsprin
+00023170: 6720 3d20 6361 6e64 6964 6174 6573 0a0a  g = candidates..
+00023180: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00023190: 2e74 696d 655f 7374 6174 6973 7469 6373  .time_statistics
+000231a0: 5b27 4750 2047 656e 6572 6174 696f 6e27  ['GP Generation'
+000231b0: 5d2e 6170 7065 6e64 2874 696d 652e 7469  ].append(time.ti
+000231c0: 6d65 2829 202d 2073 7461 7274 5f74 696d  me() - start_tim
+000231d0: 6529 0a20 2020 2020 2020 2020 2020 2023  e).            #
+000231e0: 2064 656c 6574 6520 736f 6d65 2069 6e68   delete some inh
+000231f0: 6572 6974 6564 2069 6e66 6f72 6d61 7469  erited informati
+00023200: 6f6e 0a20 2020 2020 2020 2020 2020 2066  on.            f
+00023210: 6f72 2069 6e64 2069 6e20 6e65 775f 6f66  or ind in new_of
+00023220: 6673 7072 696e 673a 0a20 2020 2020 2020  fspring:.       
+00023230: 2020 2020 2020 2020 2023 2064 656c 6574           # delet
+00023240: 6520 6669 746e 6573 7320 7661 6c75 6573  e fitness values
+00023250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023260: 2069 6620 696e 642e 6669 746e 6573 732e   if ind.fitness.
+00023270: 7661 6c69 643a 0a20 2020 2020 2020 2020  valid:.         
+00023280: 2020 2020 2020 2020 2020 2064 656c 2069             del i
+00023290: 6e64 2e66 6974 6e65 7373 2e76 616c 7565  nd.fitness.value
+000232a0: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
+000232b0: 2020 666f 7220 6174 7472 2069 6e20 2827    for attr in ('
+000232c0: 7072 6564 6963 7465 645f 7661 6c75 6573  predicted_values
+000232d0: 272c 2027 6361 7365 5f76 616c 7565 7327  ', 'case_values'
+000232e0: 2c20 2770 6970 6527 2c20 2763 6f65 6627  , 'pipe', 'coef'
+000232f0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00023300: 2020 2020 2020 2069 6620 6861 7361 7474         if hasatt
+00023310: 7228 696e 642c 2061 7474 7229 3a0a 2020  r(ind, attr):.  
+00023320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023330: 2020 2020 2020 6465 6c61 7474 7228 696e        delattr(in
+00023340: 642c 2061 7474 7229 0a0a 2020 2020 2020  d, attr)..      
+00023350: 2020 2020 2020 6966 2073 656c 662e 7072        if self.pr
+00023360: 655f 7365 6c65 6374 696f 6e20 213d 204e  e_selection != N
+00023370: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00023380: 2020 2020 206f 6666 7370 7269 6e67 2c20       offspring, 
+00023390: 7072 6564 6963 7465 645f 7661 6c75 6573  predicted_values
+000233a0: 203d 2073 656c 662e 7072 655f 7365 6c65   = self.pre_sele
+000233b0: 6374 696f 6e5f 696e 6469 7669 6475 616c  ction_individual
+000233c0: 7328 706f 7075 6c61 7469 6f6e 2c20 6e65  s(population, ne
+000233d0: 775f 6f66 6673 7072 696e 672c 0a20 2020  w_offspring,.   
+000233e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000233f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023420: 2020 2020 2020 2020 2020 7365 6c66 2e6e            self.n
+00023430: 5f70 6f70 290a 2020 2020 2020 2020 2020  _pop).          
+00023440: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
+00023450: 286f 6666 7370 7269 6e67 2920 3d3d 2073  (offspring) == s
+00023460: 656c 662e 6e5f 706f 702c 205c 0a20 2020  elf.n_pop, \.   
+00023470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023480: 2066 227b 6c65 6e28 6f66 6673 7072 696e   f"{len(offsprin
+00023490: 6729 2c20 7365 6c66 2e6e 5f70 6f70 7d22  g), self.n_pop}"
+000234a0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+000234b0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+000234c0: 2020 206f 6666 7370 7269 6e67 203d 206e     offspring = n
+000234d0: 6577 5f6f 6666 7370 7269 6e67 0a0a 2020  ew_offspring..  
+000234e0: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+000234f0: 6172 7469 7469 6f6e 5f73 6368 656d 655f  artition_scheme_
+00023500: 7570 6461 7469 6e67 2829 0a20 2020 2020  updating().     
+00023510: 2020 2020 2020 2069 6620 7365 6c66 2e72         if self.r
+00023520: 6564 7563 7469 6f6e 5f72 6174 696f 203e  eduction_ratio >
+00023530: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
+00023540: 2020 2020 2073 656c 662e 706f 7075 6c61       self.popula
+00023550: 7469 6f6e 5f72 6564 7563 7469 6f6e 2870  tion_reduction(p
+00023560: 6f70 756c 6174 696f 6e29 0a0a 2020 2020  opulation)..    
+00023570: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00023580: 7374 6167 655f 666c 6167 3a0a 2020 2020  stage_flag:.    
+00023590: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+000235a0: 7428 2753 7461 7274 2045 7661 6c75 6174  t('Start Evaluat
+000235b0: 696f 6e27 290a 2020 2020 2020 2020 2020  ion').          
+000235c0: 2020 2320 4576 616c 7561 7465 2074 6865    # Evaluate the
+000235d0: 2069 6e64 6976 6964 7561 6c73 2077 6974   individuals wit
+000235e0: 6820 616e 2069 6e76 616c 6964 2066 6974  h an invalid fit
+000235f0: 6e65 7373 0a20 2020 2020 2020 2020 2020  ness.           
+00023600: 2069 6620 7365 6c66 2e62 6173 655f 6c65   if self.base_le
+00023610: 6172 6e65 7220 696e 205b 2752 4454 7e4c  arner in ['RDT~L
+00023620: 6967 6874 4742 4d2d 5374 756d 7027 5d3a  ightGBM-Stump']:
+00023630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023640: 2069 6e76 616c 6964 5f69 6e64 203d 2073   invalid_ind = s
+00023650: 656c 662e 6d75 6c74 696f 626a 6563 7469  elf.multiobjecti
+00023660: 7665 5f65 7661 6c75 6174 696f 6e28 746f  ve_evaluation(to
+00023670: 6f6c 626f 782c 206f 6666 7370 7269 6e67  olbox, offspring
+00023680: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
+00023690: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+000236a0: 2020 2020 696e 7661 6c69 645f 696e 6420      invalid_ind 
+000236b0: 3d20 7365 6c66 2e70 6f70 756c 6174 696f  = self.populatio
+000236c0: 6e5f 6576 616c 7561 7469 6f6e 2874 6f6f  n_evaluation(too
+000236d0: 6c62 6f78 2c20 6f66 6673 7072 696e 6729  lbox, offspring)
+000236e0: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+000236f0: 2073 656c 662e 7665 7262 6f73 653a 0a20   self.verbose:. 
+00023700: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00023710: 5f76 616c 7565 203d 2073 656c 662e 6765  _value = self.ge
+00023720: 745f 705f 7661 6c75 6528 6f66 6673 7072  t_p_value(offspr
+00023730: 696e 672c 2070 6f70 756c 6174 696f 6e29  ing, population)
+00023740: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023750: 2070 7269 6e74 2827 5020 7661 6c75 6520   print('P value 
+00023760: 6f66 2064 6966 6665 7265 6e74 2070 6f70  of different pop
+00023770: 756c 6174 696f 6e27 2c20 705f 7661 6c75  ulation', p_valu
+00023780: 6529 0a0a 2020 2020 2020 2020 2020 2020  e)..            
+00023790: 2320 7072 756e 6520 6166 7465 7220 6576  # prune after ev
+000237a0: 616c 7561 7469 6f6e 0a20 2020 2020 2020  aluation.       
+000237b0: 2020 2020 2066 6f72 206f 2069 6e20 6f66       for o in of
+000237c0: 6673 7072 696e 673a 0a20 2020 2020 2020  fspring:.       
+000237d0: 2020 2020 2020 2020 2066 6f72 2067 656e           for gen
+000237e0: 6520 696e 206f 2e67 656e 653a 0a20 2020  e in o.gene:.   
 000237f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023810: 2020 7365 6c66 2e6e 756d 6265 725f 6f66    self.number_of
-00023820: 5f70 6172 656e 7473 2c20 6578 7465 726e  _parents, extern
-00023830: 616c 5f61 7263 6869 7665 295b 305d 290a  al_archive)[0]).
-00023840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023850: 6f66 6673 7072 696e 672e 6170 7065 6e64  offspring.append
-00023860: 2873 656c 662e 6f66 6673 7072 696e 675f  (self.offspring_
-00023870: 6765 6e65 7261 7469 6f6e 2874 6f6f 6c62  generation(toolb
-00023880: 6f78 2c20 7061 7265 6e74 2c0a 2020 2020  ox, parent,.    
-00023890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000238a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000238b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000238c0: 2020 2020 2020 2073 656c 662e 6e75 6d62         self.numb
-000238d0: 6572 5f6f 665f 7061 7265 6e74 732c 2065  er_of_parents, e
-000238e0: 7874 6572 6e61 6c5f 6172 6368 6976 6529  xternal_archive)
-000238f0: 5b30 5d29 0a20 2020 2020 2020 2020 2020  [0]).           
-00023900: 2065 6c69 6620 7365 6c66 2e6e 756d 6265   elif self.numbe
-00023910: 725f 6f66 5f70 6172 656e 7473 203e 2030  r_of_parents > 0
-00023920: 2061 6e64 206e 6f74 2073 656c 662e 6c67   and not self.lg
-00023930: 705f 6d6f 6465 3a0a 2020 2020 2020 2020  p_mode:.        
-00023940: 2020 2020 2020 2020 7061 7265 6e74 735f          parents_
-00023950: 636f 756e 7420 3d20 7365 6c66 2e6e 756d  count = self.num
-00023960: 6265 725f 6f66 5f70 6172 656e 7473 0a20  ber_of_parents. 
-00023970: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00023980: 6666 7370 7269 6e67 203d 2074 6f6f 6c62  ffspring = toolb
-00023990: 6f78 2e73 656c 6563 7428 7061 7265 6e74  ox.select(parent
-000239a0: 2c20 7061 7265 6e74 735f 636f 756e 7429  , parents_count)
-000239b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000239c0: 2066 6561 7475 7265 732c 2063 6f65 6673   features, coefs
-000239d0: 203d 2067 6574 5f69 6d70 6f72 7461 6e74   = get_important
-000239e0: 5f66 6561 7475 7265 7328 6f66 6673 7072  _features(offspr
-000239f0: 696e 675b 3a70 6172 656e 7473 5f63 6f75  ing[:parents_cou
-00023a00: 6e74 202f 2f20 325d 290a 2020 2020 2020  nt // 2]).      
-00023a10: 2020 2020 2020 2020 2020 6f66 6673 7072            offspr
-00023a20: 696e 675b 305d 2e67 656e 6520 3d20 6665  ing[0].gene = fe
-00023a30: 6174 7572 6573 5b3a 7365 6c66 2e67 656e  atures[:self.gen
-00023a40: 655f 6e75 6d5d 0a20 2020 2020 2020 2020  e_num].         
-00023a50: 2020 2020 2020 206f 6666 7370 7269 6e67         offspring
-00023a60: 5b30 5d2e 636f 6566 203d 206e 702e 6172  [0].coef = np.ar
-00023a70: 7261 7928 636f 6566 7329 5b3a 7365 6c66  ray(coefs)[:self
-00023a80: 2e67 656e 655f 6e75 6d5d 0a20 2020 2020  .gene_num].     
-00023a90: 2020 2020 2020 2020 2020 2066 6561 7475             featu
-00023aa0: 7265 732c 2063 6f65 6673 203d 2067 6574  res, coefs = get
-00023ab0: 5f69 6d70 6f72 7461 6e74 5f66 6561 7475  _important_featu
-00023ac0: 7265 7328 6f66 6673 7072 696e 675b 7061  res(offspring[pa
-00023ad0: 7265 6e74 735f 636f 756e 7420 2f2f 2032  rents_count // 2
-00023ae0: 3a5d 290a 2020 2020 2020 2020 2020 2020  :]).            
-00023af0: 2020 2020 6f66 6673 7072 696e 675b 315d      offspring[1]
-00023b00: 2e67 656e 6520 3d20 6665 6174 7572 6573  .gene = features
-00023b10: 5b3a 7365 6c66 2e67 656e 655f 6e75 6d5d  [:self.gene_num]
-00023b20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023b30: 206f 6666 7370 7269 6e67 5b31 5d2e 636f   offspring[1].co
-00023b40: 6566 203d 206e 702e 6172 7261 7928 636f  ef = np.array(co
-00023b50: 6566 7329 5b3a 7365 6c66 2e67 656e 655f  efs)[:self.gene_
-00023b60: 6e75 6d5d 0a20 2020 2020 2020 2020 2020  num].           
-00023b70: 2020 2020 2069 6620 6c65 6e28 6f66 6673       if len(offs
-00023b80: 7072 696e 675b 305d 2e67 656e 6529 203c  pring[0].gene) <
-00023b90: 2073 656c 662e 6765 6e65 5f6e 756d 206f   self.gene_num o
-00023ba0: 7220 6c65 6e28 6f66 6673 7072 696e 675b  r len(offspring[
-00023bb0: 315d 2e67 656e 6529 203c 2073 656c 662e  1].gene) < self.
-00023bc0: 6765 6e65 5f6e 756d 3a0a 2020 2020 2020  gene_num:.      
-00023bd0: 2020 2020 2020 2020 2020 2020 2020 6f66                of
-00023be0: 6673 7072 696e 6720 3d20 5b5d 0a20 2020  fspring = [].   
-00023bf0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00023c00: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00023c10: 2020 2020 2020 206f 6666 7370 7269 6e67         offspring
-00023c20: 203d 206f 6666 7370 7269 6e67 5b3a 325d   = offspring[:2]
-00023c30: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00023c40: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00023c50: 2020 206f 6666 7370 7269 6e67 203d 2074     offspring = t
-00023c60: 6f6f 6c62 6f78 2e73 656c 6563 7428 7061  oolbox.select(pa
-00023c70: 7265 6e74 2c20 3229 0a20 2020 2020 2020  rent, 2).       
-00023c80: 2072 6574 7572 6e20 6f66 6673 7072 696e   return offsprin
-00023c90: 670a 0a20 2020 2064 6566 2072 6564 756e  g..    def redun
-00023ca0: 6461 6e74 5f66 6561 7475 7265 735f 6361  dant_features_ca
-00023cb0: 6c63 756c 6174 696f 6e28 7365 6c66 2c20  lculation(self, 
-00023cc0: 6f66 6673 7072 696e 6729 3a0a 2020 2020  offspring):.    
-00023cd0: 2020 2020 6375 7272 656e 745f 7265 6475      current_redu
-00023ce0: 6e64 616e 745f 6665 6174 7572 6573 203d  ndant_features =
-00023cf0: 2030 0a20 2020 2020 2020 2063 7572 7265   0.        curre
-00023d00: 6e74 5f69 7272 656c 6576 616e 745f 6665  nt_irrelevant_fe
-00023d10: 6174 7572 6573 203d 2030 0a20 2020 2020  atures = 0.     
-00023d20: 2020 2066 6f72 206f 2069 6e20 6f66 6673     for o in offs
-00023d30: 7072 696e 673a 0a20 2020 2020 2020 2020  pring:.         
-00023d40: 2020 2068 6173 685f 7365 7420 3d20 7365     hash_set = se
-00023d50: 7428 290a 2020 2020 2020 2020 2020 2020  t().            
-00023d60: 666f 7220 6720 696e 206f 2e68 6173 685f  for g in o.hash_
-00023d70: 7265 7375 6c74 3a0a 2020 2020 2020 2020  result:.        
-00023d80: 2020 2020 2020 2020 6966 2067 2069 6e20          if g in 
-00023d90: 6861 7368 5f73 6574 3a0a 2020 2020 2020  hash_set:.      
-00023da0: 2020 2020 2020 2020 2020 2020 2020 6375                cu
-00023db0: 7272 656e 745f 7265 6475 6e64 616e 745f  rrent_redundant_
-00023dc0: 6665 6174 7572 6573 202b 3d20 310a 2020  features += 1.  
-00023dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023de0: 2020 7365 6c66 2e72 6564 756e 6461 6e74    self.redundant
-00023df0: 5f66 6561 7475 7265 7320 2b3d 2031 0a20  _features += 1. 
-00023e00: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00023e10: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00023e20: 2020 2020 2020 2020 2068 6173 685f 7365           hash_se
-00023e30: 742e 6164 6428 6729 0a20 2020 2020 2020  t.add(g).       
-00023e40: 2020 2020 2066 6f72 2067 2069 6e20 6f2e       for g in o.
-00023e50: 636f 6566 3a0a 2020 2020 2020 2020 2020  coef:.          
-00023e60: 2020 2020 2020 6966 2067 203c 2030 2e30        if g < 0.0
-00023e70: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
-00023e80: 2020 2020 2020 2063 7572 7265 6e74 5f69         current_i
-00023e90: 7272 656c 6576 616e 745f 6665 6174 7572  rrelevant_featur
-00023ea0: 6573 202b 3d20 310a 2020 2020 2020 2020  es += 1.        
-00023eb0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00023ec0: 2e69 7272 656c 6576 616e 745f 6665 6174  .irrelevant_feat
-00023ed0: 7572 6573 202b 3d20 310a 2020 2020 2020  ures += 1.      
-00023ee0: 2020 7365 6c66 2e72 6564 756e 6461 6e74    self.redundant
-00023ef0: 5f66 6561 7475 7265 735f 6869 7374 6f72  _features_histor
-00023f00: 792e 6170 7065 6e64 2863 7572 7265 6e74  y.append(current
-00023f10: 5f72 6564 756e 6461 6e74 5f66 6561 7475  _redundant_featu
-00023f20: 7265 7329 0a20 2020 2020 2020 2073 656c  res).        sel
-00023f30: 662e 6972 7265 6c65 7661 6e74 5f66 6561  f.irrelevant_fea
-00023f40: 7475 7265 735f 6869 7374 6f72 792e 6170  tures_history.ap
-00023f50: 7065 6e64 2863 7572 7265 6e74 5f69 7272  pend(current_irr
-00023f60: 656c 6576 616e 745f 6665 6174 7572 6573  elevant_features
-00023f70: 290a 0a20 2020 2064 6566 2075 7064 6174  )..    def updat
-00023f80: 655f 6578 7465 726e 616c 5f61 7263 6869  e_external_archi
-00023f90: 7665 2873 656c 662c 2070 6f70 756c 6174  ve(self, populat
-00023fa0: 696f 6e2c 2065 7874 6572 6e61 6c5f 6172  ion, external_ar
-00023fb0: 6368 6976 6529 3a0a 2020 2020 2020 2020  chive):.        
-00023fc0: 6966 2073 656c 662e 6578 7465 726e 616c  if self.external
-00023fd0: 5f61 7263 6869 7665 2069 7320 6e6f 7420  _archive is not 
-00023fe0: 4e6f 6e65 2061 6e64 2073 656c 662e 6578  None and self.ex
-00023ff0: 7465 726e 616c 5f61 7263 6869 7665 2021  ternal_archive !
-00024000: 3d20 4661 6c73 6520 5c0a 2020 2020 2020  = False \.      
-00024010: 2020 2020 2020 616e 6420 7365 6c66 2e65        and self.e
-00024020: 7874 6572 6e61 6c5f 6172 6368 6976 652e  xternal_archive.
-00024030: 7374 6172 7473 7769 7468 2827 5369 7a65  startswith('Size
-00024040: 2d27 293a 0a20 2020 2020 2020 2020 2020  -'):.           
-00024050: 2073 697a 6520 3d20 696e 7428 7365 6c66   size = int(self
-00024060: 2e65 7874 6572 6e61 6c5f 6172 6368 6976  .external_archiv
-00024070: 652e 7265 706c 6163 6528 2753 697a 652d  e.replace('Size-
-00024080: 272c 2027 2729 290a 2020 2020 2020 2020  ', '')).        
-00024090: 2020 2020 6966 2065 7874 6572 6e61 6c5f      if external_
-000240a0: 6172 6368 6976 6520 6973 206e 6f74 204e  archive is not N
-000240b0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-000240c0: 2020 2020 2065 7874 6572 6e61 6c5f 6172       external_ar
-000240d0: 6368 6976 6520 3d20 7365 6c42 6573 7428  chive = selBest(
-000240e0: 6c69 7374 2865 7874 6572 6e61 6c5f 6172  list(external_ar
-000240f0: 6368 6976 6529 202b 206c 6973 7428 706f  chive) + list(po
-00024100: 7075 6c61 7469 6f6e 292c 2073 697a 6520  pulation), size 
-00024110: 2a20 7365 6c66 2e6e 5f70 6f70 290a 2020  * self.n_pop).  
-00024120: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00023800: 2073 656c 662e 6765 6e65 5f70 7275 6e65   self.gene_prune
+00023810: 2867 656e 6529 0a0a 2020 2020 2020 2020  (gene)..        
+00023820: 2020 2020 6966 2073 656c 662e 656e 7669      if self.envi
+00023830: 726f 6e6d 656e 7461 6c5f 7365 6c65 6374  ronmental_select
+00023840: 696f 6e20 3d3d 2027 4e53 4741 322d 4d69  ion == 'NSGA2-Mi
+00023850: 7875 7027 3a0a 2020 2020 2020 2020 2020  xup':.          
+00023860: 2020 2020 2020 7365 6c66 2e6d 6978 7570        self.mixup
+00023870: 5f65 7661 6c75 6174 696f 6e28 7365 6c66  _evaluation(self
+00023880: 2e74 6f6f 6c62 6f78 2c20 6f66 6673 7072  .toolbox, offspr
+00023890: 696e 6729 0a0a 2020 2020 2020 2020 2020  ing)..          
+000238a0: 2020 2320 5265 636f 7264 2074 6865 2066    # Record the f
+000238b0: 6974 6e65 7373 2069 6d70 726f 7665 6d65  itness improveme
+000238c0: 6e74 0a20 2020 2020 2020 2020 2020 2066  nt.            f
+000238d0: 6974 6e65 7373 5f69 6d70 726f 7665 6d65  itness_improveme
+000238e0: 6e74 203d 206e 702e 6d61 7828 5b69 6e64  nt = np.max([ind
+000238f0: 2e66 6974 6e65 7373 2e77 7661 6c75 6573  .fitness.wvalues
+00023900: 5b30 5d20 666f 7220 696e 6420 696e 206f  [0] for ind in o
+00023910: 6666 7370 7269 6e67 5d29 202d 205c 0a20  ffspring]) - \. 
+00023920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023940: 206e 702e 6d61 7828 5b69 6e64 2e66 6974   np.max([ind.fit
+00023950: 6e65 7373 2e77 7661 6c75 6573 5b30 5d20  ness.wvalues[0] 
+00023960: 666f 7220 696e 6420 696e 2070 6f70 756c  for ind in popul
+00023970: 6174 696f 6e5d 290a 0a20 2020 2020 2020  ation])..       
+00023980: 2020 2020 2023 2070 7269 6e74 2827 4669       # print('Fi
+00023990: 746e 6573 7320 496d 7072 6f76 656d 656e  tness Improvemen
+000239a0: 7427 2c20 6669 746e 6573 735f 696d 7072  t', fitness_impr
+000239b0: 6f76 656d 656e 742c 0a20 2020 2020 2020  ovement,.       
+000239c0: 2020 2020 2023 2020 2020 2020 206e 702e       #       np.
+000239d0: 6d65 616e 285b 696e 642e 6669 746e 6573  mean([ind.fitnes
+000239e0: 732e 7776 616c 7565 735b 305d 2066 6f72  s.wvalues[0] for
+000239f0: 2069 6e64 2069 6e20 6f66 6673 7072 696e   ind in offsprin
+00023a00: 675d 292c 0a20 2020 2020 2020 2020 2020  g]),.           
+00023a10: 2023 2020 2020 2020 206e 702e 6d65 616e   #       np.mean
+00023a20: 285b 696e 642e 6669 746e 6573 732e 7776  ([ind.fitness.wv
+00023a30: 616c 7565 735b 305d 2066 6f72 2069 6e64  alues[0] for ind
+00023a40: 2069 6e20 706f 7075 6c61 7469 6f6e 5d29   in population])
+00023a50: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+00023a60: 2073 656c 662e 7374 6167 655f 666c 6167   self.stage_flag
+00023a70: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00023a80: 2020 7072 696e 7428 2753 746f 7020 4576    print('Stop Ev
+00023a90: 616c 7561 7469 6f6e 2729 0a0a 2020 2020  aluation')..    
+00023aa0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00023ab0: 7363 6f72 655f 6675 6e63 203d 3d20 274e  score_func == 'N
+00023ac0: 6f76 656c 7479 5365 6172 6368 273a 0a20  oveltySearch':. 
+00023ad0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00023ae0: 6974 6e65 7373 5f6c 6973 7420 3d20 5b78  itness_list = [x
+00023af0: 2e66 6974 6e65 7373 2e77 7661 6c75 6573  .fitness.wvalues
+00023b00: 2066 6f72 2078 2069 6e20 6f66 6673 7072   for x in offspr
+00023b10: 696e 675d 0a20 2020 2020 2020 2020 2020  ing].           
+00023b20: 2020 2020 2071 3735 2c20 7132 3520 3d20       q75, q25 = 
+00023b30: 6e70 2e70 6572 6365 6e74 696c 6528 6669  np.percentile(fi
+00023b40: 746e 6573 735f 6c69 7374 2c20 5b37 352c  tness_list, [75,
+00023b50: 2032 355d 290a 2020 2020 2020 2020 2020   25]).          
+00023b60: 2020 2020 2020 6971 7220 3d20 7137 3520        iqr = q75 
+00023b70: 2d20 7132 350a 2020 2020 2020 2020 2020  - q25.          
+00023b80: 2020 2020 2020 6d65 6469 616e 203d 206e        median = n
+00023b90: 702e 6d65 6469 616e 2866 6974 6e65 7373  p.median(fitness
+00023ba0: 5f6c 6973 7429 0a20 2020 2020 2020 2020  _list).         
+00023bb0: 2020 2020 2020 2023 2041 766f 6964 206d         # Avoid m
+00023bc0: 6561 6e69 6e67 6c65 7373 2064 6976 6572  eaningless diver
+00023bd0: 7369 7479 2069 6e64 6976 6964 7561 6c73  sity individuals
+00023be0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023bf0: 206f 6666 7370 7269 6e67 203d 206c 6973   offspring = lis
+00023c00: 7428 6669 6c74 6572 286c 616d 6264 6120  t(filter(lambda 
+00023c10: 783a 0a20 2020 2020 2020 2020 2020 2020  x:.             
+00023c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023c30: 2020 2020 2020 2020 2020 2078 2e66 6974             x.fit
+00023c40: 6e65 7373 2e77 7661 6c75 6573 5b30 5d20  ness.wvalues[0] 
+00023c50: 3e3d 206d 6564 6961 6e20 2d20 312e 3520  >= median - 1.5 
+00023c60: 2a20 6971 720a 2020 2020 2020 2020 2020  * iqr.          
+00023c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023c80: 2020 2020 2020 2020 2020 2020 2020 2c20                , 
+00023c90: 6f66 6673 7072 696e 6729 290a 2020 2020  offspring)).    
+00023ca0: 2020 2020 2020 2020 2020 2020 2320 7072              # pr
+00023cb0: 696e 7428 2756 616c 6964 2069 6e64 6976  int('Valid indiv
+00023cc0: 6964 7561 6c73 272c 206c 656e 286f 6666  iduals', len(off
+00023cd0: 7370 7269 6e67 2929 0a20 2020 2020 2020  spring)).       
+00023ce0: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+00023cf0: 6c65 6e28 6f66 6673 7072 696e 6729 203e  len(offspring) >
+00023d00: 2030 2c20 6627 7b6d 6564 6961 6e2c 2069   0, f'{median, i
+00023d10: 7172 7d27 0a0a 2020 2020 2020 2020 2020  qr}'..          
+00023d20: 2020 6966 2073 656c 662e 6479 6e61 6d69    if self.dynami
+00023d30: 635f 7461 7267 6574 3a0a 2020 2020 2020  c_target:.      
+00023d40: 2020 2020 2020 2020 2020 2320 6966 2064            # if d
+00023d50: 796e 616d 6963 2074 6172 6765 742c 2074  ynamic target, t
+00023d60: 6865 6e20 7265 2d65 7661 6c75 6174 6520  hen re-evaluate 
+00023d70: 616c 6c20 696e 6469 7669 6475 616c 730a  all individuals.
+00023d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023d90: 666f 7220 7820 696e 2073 656c 662e 686f  for x in self.ho
+00023da0: 663a 0a20 2020 2020 2020 2020 2020 2020  f:.             
+00023db0: 2020 2020 2020 2064 656c 2078 2e66 6974         del x.fit
+00023dc0: 6e65 7373 2e76 616c 7565 730a 2020 2020  ness.values.    
+00023dd0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00023de0: 2e70 6f70 756c 6174 696f 6e5f 6576 616c  .population_eval
+00023df0: 7561 7469 6f6e 2874 6f6f 6c62 6f78 2c20  uation(toolbox, 
+00023e00: 7365 6c66 2e68 6f66 290a 0a20 2020 2020  self.hof)..     
+00023e10: 2020 2020 2020 2065 6c69 7465 5f6d 6170         elite_map
+00023e20: 2c20 706f 705f 706f 6f6c 203d 2073 656c  , pop_pool = sel
+00023e30: 662e 6d61 705f 656c 6974 655f 6765 6e65  f.map_elite_gene
+00023e40: 7261 7469 6f6e 286f 6666 7370 7269 6e67  ration(offspring
+00023e50: 2c20 656c 6974 655f 6d61 702c 2070 6f70  , elite_map, pop
+00023e60: 5f70 6f6f 6c29 0a0a 2020 2020 2020 2020  _pool)..        
+00023e70: 2020 2020 2320 7265 636f 7264 2068 6973      # record his
+00023e80: 746f 7269 6361 6c20 6265 7374 2076 616c  torical best val
+00023e90: 7565 730a 2020 2020 2020 2020 2020 2020  ues.            
+00023ea0: 6966 2063 6f6d 7061 7269 736f 6e5f 6372  if comparison_cr
+00023eb0: 6974 6572 696f 6e20 3d3d 2027 4361 7365  iterion == 'Case
+00023ec0: 2720 6f72 2063 6f6d 7061 7269 736f 6e5f  ' or comparison_
+00023ed0: 6372 6974 6572 696f 6e20 3d3d 2027 4361  criterion == 'Ca
+00023ee0: 7365 2d50 6c75 7327 3a0a 2020 2020 2020  se-Plus':.      
+00023ef0: 2020 2020 2020 2020 2020 6265 7374 5f76            best_v
+00023f00: 616c 7565 203d 206e 702e 6d69 6e28 5b6e  alue = np.min([n
+00023f10: 702e 6d69 6e28 5b70 2e63 6173 655f 7661  p.min([p.case_va
+00023f20: 6c75 6573 2066 6f72 2070 2069 6e20 706f  lues for p in po
+00023f30: 7075 6c61 7469 6f6e 5d2c 2061 7869 733d  pulation], axis=
+00023f40: 3029 2c20 6265 7374 5f76 616c 7565 5d2c  0), best_value],
+00023f50: 2061 7869 733d 3029 0a20 2020 2020 2020   axis=0).       
+00023f60: 2020 2020 2020 2020 2077 6f72 7374 5f76           worst_v
+00023f70: 616c 7565 203d 206e 702e 6d61 7828 5b6e  alue = np.max([n
+00023f80: 702e 6d61 7828 5b70 2e63 6173 655f 7661  p.max([p.case_va
+00023f90: 6c75 6573 2066 6f72 2070 2069 6e20 706f  lues for p in po
+00023fa0: 7075 6c61 7469 6f6e 5d2c 2061 7869 733d  pulation], axis=
+00023fb0: 3029 2c20 776f 7273 745f 7661 6c75 655d  0), worst_value]
+00023fc0: 2c20 6178 6973 3d30 290a 2020 2020 2020  , axis=0).      
+00023fd0: 2020 2020 2020 6966 2063 6f6d 7061 7269        if compari
+00023fe0: 736f 6e5f 6372 6974 6572 696f 6e20 3d3d  son_criterion ==
+00023ff0: 2027 4669 746e 6573 7327 206f 7220 636f   'Fitness' or co
+00024000: 6d70 6172 6973 6f6e 5f63 7269 7465 7269  mparison_criteri
+00024010: 6f6e 203d 3d20 2746 6974 6e65 7373 2d43  on == 'Fitness-C
+00024020: 6173 6527 3a0a 2020 2020 2020 2020 2020  ase':.          
+00024030: 2020 2020 2020 2320 6869 7374 6f72 6963        # historic
+00024040: 616c 2062 6573 7420 6669 746e 6573 7320  al best fitness 
+00024050: 7661 6c75 6573 0a20 2020 2020 2020 2020  values.         
+00024060: 2020 2020 2020 2062 6573 745f 7661 6c75         best_valu
+00024070: 6520 3d20 6d61 7828 2a5b 702e 6669 746e  e = max(*[p.fitn
+00024080: 6573 732e 7776 616c 7565 735b 305d 2066  ess.wvalues[0] f
+00024090: 6f72 2070 2069 6e20 706f 7075 6c61 7469  or p in populati
+000240a0: 6f6e 5d2c 2062 6573 745f 7661 6c75 6529  on], best_value)
+000240b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000240c0: 2070 6172 656e 745f 6361 7365 5f76 616c   parent_case_val
+000240d0: 7565 7320 3d20 6e70 2e6d 696e 285b 702e  ues = np.min([p.
+000240e0: 6361 7365 5f76 616c 7565 7320 666f 7220  case_values for 
+000240f0: 7020 696e 2070 6f70 756c 6174 696f 6e5d  p in population]
+00024100: 2c20 6178 6973 3d30 290a 2020 2020 2020  , axis=0).      
+00024110: 2020 2020 2020 6966 2073 656c 662e 7365        if self.se
+00024120: 6c65 6374 203d 3d20 2741 7574 6f27 3a0a  lect == 'Auto':.
 00024130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024140: 6578 7465 726e 616c 5f61 7263 6869 7665  external_archive
-00024150: 203d 2073 656c 4265 7374 286c 6973 7428   = selBest(list(
-00024160: 706f 7075 6c61 7469 6f6e 292c 2073 697a  population), siz
-00024170: 6520 2a20 7365 6c66 2e6e 5f70 6f70 290a  e * self.n_pop).
-00024180: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
-00024190: 662e 6578 7465 726e 616c 5f61 7263 6869  f.external_archi
-000241a0: 7665 203d 3d20 2749 6d70 6f72 7461 6e74  ve == 'Important
-000241b0: 4665 6174 7572 6573 2720 6f72 2073 656c  Features' or sel
-000241c0: 662e 7365 6d61 6e74 6963 5f72 6570 6169  f.semantic_repai
-000241d0: 7220 3e20 303a 0a20 2020 2020 2020 2020  r > 0:.         
-000241e0: 2020 2069 6620 6578 7465 726e 616c 5f61     if external_a
-000241f0: 7263 6869 7665 2069 7320 4e6f 6e65 3a0a  rchive is None:.
-00024200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024210: 6578 7465 726e 616c 5f61 7263 6869 7665  external_archive
-00024220: 203d 205b 5d0a 2020 2020 2020 2020 2020   = [].          
-00024230: 2020 666f 7220 6720 696e 2072 616e 6765    for g in range
-00024240: 2873 656c 662e 6765 6e65 5f6e 756d 293a  (self.gene_num):
-00024250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00024260: 2069 6620 6c65 6e28 6578 7465 726e 616c   if len(external
-00024270: 5f61 7263 6869 7665 2920 3d3d 2073 656c  _archive) == sel
-00024280: 662e 6765 6e65 5f6e 756d 3a0a 2020 2020  f.gene_num:.    
-00024290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000242a0: 7365 6c65 6374 6564 5f66 6561 7475 7265  selected_feature
-000242b0: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
-000242c0: 2020 2020 2020 2020 2020 2020 2020 7374                st
-000242d0: 7228 6f5b 315d 293a 206f 2066 6f72 206f  r(o[1]): o for o
-000242e0: 2069 6e20 6578 7465 726e 616c 5f61 7263   in external_arc
-000242f0: 6869 7665 5b67 5d0a 2020 2020 2020 2020  hive[g].        
-00024300: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
-00024310: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00024320: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00024330: 2020 2020 2020 2020 7365 6c65 6374 6564          selected
-00024340: 5f66 6561 7475 7265 7320 3d20 7b7d 0a20  _features = {}. 
-00024350: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00024360: 6f72 2070 2069 6e20 706f 7075 6c61 7469  or p in populati
-00024370: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
-00024380: 2020 2020 2020 2020 7363 6f72 6520 3d20          score = 
-00024390: 702e 6669 746e 6573 732e 7776 616c 7565  p.fitness.wvalue
-000243a0: 735b 305d 202a 2070 2e63 6f65 665b 675d  s[0] * p.coef[g]
-000243b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000243c0: 2020 2020 2067 656e 655f 7374 7220 3d20       gene_str = 
-000243d0: 7374 7228 702e 6765 6e65 5b67 5d29 0a20  str(p.gene[g]). 
-000243e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000243f0: 2020 2069 6620 6765 6e65 5f73 7472 2069     if gene_str i
-00024400: 6e20 7365 6c65 6374 6564 5f66 6561 7475  n selected_featu
-00024410: 7265 733a 0a20 2020 2020 2020 2020 2020  res:.           
-00024420: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00024430: 7363 6f72 6520 3e20 7365 6c65 6374 6564  score > selected
-00024440: 5f66 6561 7475 7265 735b 6765 6e65 5f73  _features[gene_s
-00024450: 7472 5d5b 305d 3a0a 2020 2020 2020 2020  tr][0]:.        
-00024460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024470: 2020 2020 7365 6c65 6374 6564 5f66 6561      selected_fea
-00024480: 7475 7265 735b 6765 6e65 5f73 7472 5d20  tures[gene_str] 
-00024490: 3d20 2873 636f 7265 2c20 702e 6765 6e65  = (score, p.gene
-000244a0: 5b67 5d29 0a20 2020 2020 2020 2020 2020  [g]).           
-000244b0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-000244c0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000244d0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-000244e0: 6173 730a 2020 2020 2020 2020 2020 2020  ass.            
-000244f0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00024500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024510: 2020 2020 2020 7365 6c65 6374 6564 5f66        selected_f
-00024520: 6561 7475 7265 735b 6765 6e65 5f73 7472  eatures[gene_str
-00024530: 5d20 3d20 2873 636f 7265 2c20 702e 6765  ] = (score, p.ge
-00024540: 6e65 5b67 5d29 0a20 2020 2020 2020 2020  ne[g]).         
-00024550: 2020 2020 2020 2066 696e 616c 5f61 7263         final_arc
-00024560: 6869 7665 203d 206c 6973 7428 736f 7274  hive = list(sort
-00024570: 6564 2873 656c 6563 7465 645f 6665 6174  ed(selected_feat
-00024580: 7572 6573 2e76 616c 7565 7328 292c 206b  ures.values(), k
-00024590: 6579 3d6c 616d 6264 6120 783a 2078 5b30  ey=lambda x: x[0
-000245a0: 5d2c 2072 6576 6572 7365 3d54 7275 6529  ], reverse=True)
-000245b0: 5b3a 7365 6c66 2e6e 5f70 6f70 5d29 0a20  [:self.n_pop]). 
-000245c0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000245d0: 6620 6c65 6e28 6578 7465 726e 616c 5f61  f len(external_a
-000245e0: 7263 6869 7665 2920 3d3d 2073 656c 662e  rchive) == self.
-000245f0: 6765 6e65 5f6e 756d 3a0a 2020 2020 2020  gene_num:.      
-00024600: 2020 2020 2020 2020 2020 2020 2020 6578                ex
-00024610: 7465 726e 616c 5f61 7263 6869 7665 5b67  ternal_archive[g
-00024620: 5d20 3d20 6669 6e61 6c5f 6172 6368 6976  ] = final_archiv
-00024630: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00024640: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00024650: 2020 2020 2020 2020 2020 2020 6578 7465              exte
-00024660: 726e 616c 5f61 7263 6869 7665 2e61 7070  rnal_archive.app
-00024670: 656e 6428 6669 6e61 6c5f 6172 6368 6976  end(final_archiv
-00024680: 6529 0a20 2020 2020 2020 2020 2020 2023  e).            #
-00024690: 2073 656c 662e 6b64 5f74 7265 6573 203d   self.kd_trees =
-000246a0: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
-000246b0: 2320 6966 2073 656c 662e 7365 6d61 6e74  # if self.semant
-000246c0: 6963 5f72 6570 6169 7220 3e20 303a 0a20  ic_repair > 0:. 
-000246d0: 2020 2020 2020 2020 2020 2023 2020 2020             #    
-000246e0: 2066 6f72 2069 642c 2065 6120 696e 2065   for id, ea in e
-000246f0: 6e75 6d65 7261 7465 2865 7874 6572 6e61  numerate(externa
-00024700: 6c5f 6172 6368 6976 6529 3a0a 2020 2020  l_archive):.    
-00024710: 2020 2020 2020 2020 2320 2020 2020 2020          #       
-00024720: 2020 7265 7375 6c74 735f 6e70 203d 205b    results_np = [
-00024730: 5d0a 2020 2020 2020 2020 2020 2020 2320  ].            # 
-00024740: 2020 2020 2020 2020 666f 7220 6520 696e          for e in
-00024750: 2065 613a 0a20 2020 2020 2020 2020 2020   ea:.           
-00024760: 2023 2020 2020 2020 2020 2020 2020 2072   #             r
-00024770: 6573 756c 7420 3d20 7175 6963 6b5f 7265  esult = quick_re
-00024780: 7375 6c74 5f63 616c 6375 6c61 7469 6f6e  sult_calculation
-00024790: 285b 655b 315d 5d2c 2073 656c 662e 7073  ([e[1]], self.ps
-000247a0: 6574 2e70 7365 745f 6c69 7374 5b69 645d  et.pset_list[id]
-000247b0: 2c0a 2020 2020 2020 2020 2020 2020 2320  ,.            # 
-000247c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000247d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000247e0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000247f0: 6c66 2e73 656d 616e 7469 635f 7265 7061  lf.semantic_repa
-00024800: 6972 5f69 6e70 7574 2c0a 2020 2020 2020  ir_input,.      
-00024810: 2020 2020 2020 2320 2020 2020 2020 2020        #         
-00024820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024840: 2020 2020 2020 7365 6c66 2e6f 7269 6769        self.origi
-00024850: 6e61 6c5f 6665 6174 7572 6573 295b 3a2c  nal_features)[:,
-00024860: 2030 5d0a 2020 2020 2020 2020 2020 2020   0].            
-00024870: 2320 2020 2020 2020 2020 2020 2020 6966  #             if
-00024880: 206e 702e 6c69 6e61 6c67 2e6e 6f72 6d28   np.linalg.norm(
-00024890: 7265 7375 6c74 2920 3d3d 2030 3a0a 2020  result) == 0:.  
-000248a0: 2020 2020 2020 2020 2020 2320 2020 2020            #     
-000248b0: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-000248c0: 6c74 735f 6e70 2e61 7070 656e 6428 6e70  lts_np.append(np
-000248d0: 2e7a 6572 6f73 286c 656e 2873 656c 662e  .zeros(len(self.
-000248e0: 7365 6d61 6e74 6963 5f72 6570 6169 725f  semantic_repair_
-000248f0: 7461 7267 6574 2929 290a 2020 2020 2020  target))).      
-00024900: 2020 2020 2020 2320 2020 2020 2020 2020        #         
-00024910: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00024920: 2020 2020 2020 2320 2020 2020 2020 2020        #         
-00024930: 2020 2020 2020 2020 7265 7375 6c74 735f          results_
-00024940: 6e70 2e61 7070 656e 6428 7265 7375 6c74  np.append(result
-00024950: 202f 206e 702e 6c69 6e61 6c67 2e6e 6f72   / np.linalg.nor
-00024960: 6d28 7265 7375 6c74 2929 0a20 2020 2020  m(result)).     
-00024970: 2020 2020 2020 2023 2020 2020 2020 2020         #        
-00024980: 2073 656c 662e 6b64 5f74 7265 6573 2e61   self.kd_trees.a
-00024990: 7070 656e 6428 4b44 5472 6565 286e 702e  ppend(KDTree(np.
-000249a0: 6172 7261 7928 7265 7375 6c74 735f 6e70  array(results_np
-000249b0: 2929 290a 2020 2020 2020 2020 656c 7365  ))).        else
-000249c0: 3a0a 2020 2020 2020 2020 2020 2020 6578  :.            ex
-000249d0: 7465 726e 616c 5f61 7263 6869 7665 203d  ternal_archive =
-000249e0: 204e 6f6e 650a 2020 2020 2020 2020 7265   None.        re
-000249f0: 7475 726e 2065 7874 6572 6e61 6c5f 6172  turn external_ar
-00024a00: 6368 6976 650a 0a20 2020 2064 6566 206f  chive..    def o
-00024a10: 6666 7370 7269 6e67 5f67 656e 6572 6174  ffspring_generat
-00024a20: 696f 6e28 7365 6c66 2c20 746f 6f6c 626f  ion(self, toolbo
-00024a30: 782c 2070 6172 656e 742c 2063 6f75 6e74  x, parent, count
-00024a40: 2c20 6578 7465 726e 616c 5f61 7263 6869  , external_archi
-00024a50: 7665 3d4e 6f6e 6529 3a0a 2020 2020 2020  ve=None):.      
-00024a60: 2020 2320 4765 6e65 7261 7465 206f 6666    # Generate off
-00024a70: 7370 7269 6e67 2062 6173 6564 206d 756c  spring based mul
-00024a80: 7469 706c 6520 7061 7265 6e74 730a 2020  tiple parents.  
-00024a90: 2020 2020 2020 6966 2073 656c 662e 6578        if self.ex
-00024aa0: 7465 726e 616c 5f61 7263 6869 7665 2069  ternal_archive i
-00024ab0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00024ac0: 2020 2020 6f66 6673 7072 696e 6720 3d20      offspring = 
-00024ad0: 746f 6f6c 626f 782e 7365 6c65 6374 2870  toolbox.select(p
-00024ae0: 6172 656e 742c 2063 6f75 6e74 290a 2020  arent, count).  
-00024af0: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
-00024b00: 6578 7465 726e 616c 5f61 7263 6869 7665  external_archive
-00024b10: 203d 3d20 2749 6d70 6f72 7461 6e74 4665   == 'ImportantFe
-00024b20: 6174 7572 6573 273a 0a20 2020 2020 2020  atures':.       
-00024b30: 2020 2020 206f 6666 7370 7269 6e67 203d       offspring =
-00024b40: 2074 6f6f 6c62 6f78 2e73 656c 6563 7428   toolbox.select(
-00024b50: 7061 7265 6e74 2c20 3129 0a20 2020 2020  parent, 1).     
-00024b60: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00024b70: 2020 2020 206f 6666 7370 7269 6e67 203d       offspring =
-00024b80: 2074 6f6f 6c62 6f78 2e73 656c 6563 7428   toolbox.select(
-00024b90: 7061 7265 6e74 2c20 3129 202b 2074 6f6f  parent, 1) + too
-00024ba0: 6c62 6f78 2e73 656c 6563 7428 6578 7465  lbox.select(exte
-00024bb0: 726e 616c 5f61 7263 6869 7665 2c20 636f  rnal_archive, co
-00024bc0: 756e 7420 2d20 3129 0a20 2020 2020 2020  unt - 1).       
-00024bd0: 2061 6c6c 5f68 6173 6820 3d20 7365 7428   all_hash = set(
-00024be0: 290a 2020 2020 2020 2020 666f 7220 6720  ).        for g 
-00024bf0: 696e 2072 616e 6765 2873 656c 662e 6765  in range(self.ge
-00024c00: 6e65 5f6e 756d 293a 0a20 2020 2020 2020  ne_num):.       
-00024c10: 2020 2020 206e 6565 645f 746f 5f63 6861       need_to_cha
-00024c20: 6e67 6520 3d20 4661 6c73 650a 2020 2020  nge = False.    
-00024c30: 2020 2020 2020 2020 6966 206f 6666 7370          if offsp
-00024c40: 7269 6e67 5b30 5d2e 6861 7368 5f72 6573  ring[0].hash_res
-00024c50: 756c 745b 675d 2069 6e20 616c 6c5f 6861  ult[g] in all_ha
-00024c60: 7368 3a0a 2020 2020 2020 2020 2020 2020  sh:.            
-00024c70: 2020 2020 6e65 6564 5f74 6f5f 6368 616e      need_to_chan
-00024c80: 6765 203d 2054 7275 650a 2020 2020 2020  ge = True.      
-00024c90: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00024ca0: 2020 2020 2020 2020 2020 2020 616c 6c5f              all_
-00024cb0: 6861 7368 2e61 6464 286f 6666 7370 7269  hash.add(offspri
-00024cc0: 6e67 5b30 5d2e 6861 7368 5f72 6573 756c  ng[0].hash_resul
-00024cd0: 745b 675d 290a 2020 2020 2020 2020 2020  t[g]).          
-00024ce0: 2020 2320 7265 706c 6163 6520 6e65 676c    # replace negl
-00024cf0: 6967 6962 6c65 2066 6561 7475 7265 730a  igible features.
-00024d00: 2020 2020 2020 2020 2020 2020 6964 203d              id =
-00024d10: 206e 702e 6172 676d 6178 285b 6f2e 636f   np.argmax([o.co
-00024d20: 6566 5b67 5d20 666f 7220 6f20 696e 206f  ef[g] for o in o
-00024d30: 6666 7370 7269 6e67 5d29 0a20 2020 2020  ffspring]).     
-00024d40: 2020 2020 2020 2072 6174 696f 203d 2073         ratio = s
-00024d50: 656c 662e 6972 7265 6c65 7661 6e74 5f66  elf.irrelevant_f
-00024d60: 6561 7475 7265 5f72 6174 696f 0a20 2020  eature_ratio.   
-00024d70: 2020 2020 2020 2020 2069 6620 7261 7469           if rati
-00024d80: 6f20 3d3d 2027 4479 6e61 6d69 6327 3a0a  o == 'Dynamic':.
-00024d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024da0: 7261 7469 6f20 3d20 302e 3120 2a20 6f66  ratio = 0.1 * of
-00024db0: 6673 7072 696e 675b 6964 5d2e 636f 6566  fspring[id].coef
-00024dc0: 5b67 5d0a 2020 2020 2020 2020 2020 2020  [g].            
-00024dd0: 6966 2028 7365 6c66 2e64 656c 6574 655f  if (self.delete_
-00024de0: 6972 7265 6c65 7661 6e74 2061 6e64 206f  irrelevant and o
-00024df0: 6666 7370 7269 6e67 5b30 5d2e 636f 6566  ffspring[0].coef
-00024e00: 5b67 5d20 3c20 7261 7469 6f29 206f 7220  [g] < ratio) or 
-00024e10: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
-00024e20: 2020 2873 656c 662e 6465 6c65 7465 5f72    (self.delete_r
-00024e30: 6564 756e 6461 6e74 2061 6e64 206e 6565  edundant and nee
-00024e40: 645f 746f 5f63 6861 6e67 6529 3a0a 2020  d_to_change):.  
-00024e50: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00024e60: 2073 656c 662e 6578 7465 726e 616c 5f61   self.external_a
-00024e70: 7263 6869 7665 203d 3d20 2749 6d70 6f72  rchive == 'Impor
-00024e80: 7461 6e74 4665 6174 7572 6573 273a 0a20  tantFeatures':. 
-00024e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024ea0: 2020 2063 616e 6469 6461 7465 7320 3d20     candidates = 
-00024eb0: 7365 6c52 616e 646f 6d28 6578 7465 726e  selRandom(extern
-00024ec0: 616c 5f61 7263 6869 7665 5b67 5d2c 2063  al_archive[g], c
-00024ed0: 6f75 6e74 290a 2020 2020 2020 2020 2020  ount).          
-00024ee0: 2020 2020 2020 2020 2020 6f66 6673 7072            offspr
-00024ef0: 696e 675b 305d 2e67 656e 655b 675d 203d  ing[0].gene[g] =
-00024f00: 2063 616e 6469 6461 7465 735b 6e70 2e61   candidates[np.a
-00024f10: 7267 6d61 7828 5b6f 5b30 5d20 666f 7220  rgmax([o[0] for 
-00024f20: 6f20 696e 2063 616e 6469 6461 7465 735d  o in candidates]
-00024f30: 295d 5b31 5d0a 2020 2020 2020 2020 2020  )][1].          
-00024f40: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00024f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024f60: 6f66 6673 7072 696e 675b 305d 2e63 6f65  offspring[0].coe
-00024f70: 665b 675d 203d 206f 6666 7370 7269 6e67  f[g] = offspring
-00024f80: 5b69 645d 2e63 6f65 665b 675d 0a20 2020  [id].coef[g].   
-00024f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024fa0: 206f 6666 7370 7269 6e67 5b30 5d2e 6765   offspring[0].ge
-00024fb0: 6e65 5b67 5d20 3d20 6f66 6673 7072 696e  ne[g] = offsprin
-00024fc0: 675b 6964 5d2e 6765 6e65 5b67 5d0a 2020  g[id].gene[g].  
-00024fd0: 2020 2020 2020 7265 7475 726e 206f 6666        return off
-00024fe0: 7370 7269 6e67 0a0a 2020 2020 6465 6620  spring..    def 
-00024ff0: 6f66 6673 7072 696e 675f 7365 6c65 6374  offspring_select
-00025000: 696f 6e28 7365 6c66 2c20 7061 7265 6e74  ion(self, parent
-00025010: 2c20 7365 6c65 6374 696f 6e5f 6f70 6572  , selection_oper
-00025020: 6174 6f72 2c20 656c 6974 655f 6d61 703d  ator, elite_map=
-00025030: 4e6f 6e65 293a 0a20 2020 2020 2020 2069  None):.        i
-00025040: 6620 7365 6c65 6374 696f 6e5f 6f70 6572  f selection_oper
-00025050: 6174 6f72 2e73 7461 7274 7377 6974 6828  ator.startswith(
-00025060: 274d 4150 2d45 6c69 7465 2729 2061 6e64  'MAP-Elite') and
-00025070: 206c 656e 2865 6c69 7465 5f6d 6170 2920   len(elite_map) 
-00025080: 3e20 303a 0a20 2020 2020 2020 2020 2020  > 0:.           
-00025090: 2070 6172 656e 7420 3d20 6c69 7374 2865   parent = list(e
-000250a0: 6c69 7465 5f6d 6170 2e76 616c 7565 7328  lite_map.values(
-000250b0: 2929 0a0a 2020 2020 2020 2020 6966 2073  ))..        if s
-000250c0: 656c 6563 7469 6f6e 5f6f 7065 7261 746f  election_operato
-000250d0: 7220 3d3d 2027 4d41 502d 456c 6974 652d  r == 'MAP-Elite-
-000250e0: 4c65 7869 6361 7365 273a 0a20 2020 2020  Lexicase':.     
-000250f0: 2020 2020 2020 206f 6666 7370 7269 6e67         offspring
-00025100: 203d 2073 656c 4175 746f 6d61 7469 6345   = selAutomaticE
-00025110: 7073 696c 6f6e 4c65 7869 6361 7365 4661  psilonLexicaseFa
-00025120: 7374 2870 6172 656e 742c 2032 290a 2020  st(parent, 2).  
-00025130: 2020 2020 2020 656c 6966 2073 656c 6563        elif selec
-00025140: 7469 6f6e 5f6f 7065 7261 746f 7220 3d3d  tion_operator ==
-00025150: 2027 546f 7572 6e61 6d65 6e74 2d33 273a   'Tournament-3':
-00025160: 0a20 2020 2020 2020 2020 2020 206f 6666  .            off
-00025170: 7370 7269 6e67 203d 2073 656c 546f 7572  spring = selTour
-00025180: 6e61 6d65 6e74 2870 6172 656e 742c 2032  nament(parent, 2
-00025190: 2c20 746f 7572 6e73 697a 653d 3329 0a20  , tournsize=3). 
-000251a0: 2020 2020 2020 2065 6c69 6620 7365 6c65         elif sele
-000251b0: 6374 696f 6e5f 6f70 6572 6174 6f72 203d  ction_operator =
-000251c0: 3d20 2754 6f75 726e 616d 656e 742d 3727  = 'Tournament-7'
-000251d0: 3a0a 2020 2020 2020 2020 2020 2020 6f66  :.            of
-000251e0: 6673 7072 696e 6720 3d20 7365 6c54 6f75  fspring = selTou
-000251f0: 726e 616d 656e 7428 7061 7265 6e74 2c20  rnament(parent, 
-00025200: 322c 2074 6f75 726e 7369 7a65 3d37 290a  2, tournsize=7).
-00025210: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
-00025220: 6563 7469 6f6e 5f6f 7065 7261 746f 7220  ection_operator 
-00025230: 3d3d 2027 546f 7572 6e61 6d65 6e74 2d31  == 'Tournament-1
-00025240: 3527 3a0a 2020 2020 2020 2020 2020 2020  5':.            
-00025250: 6f66 6673 7072 696e 6720 3d20 7365 6c54  offspring = selT
-00025260: 6f75 726e 616d 656e 7428 7061 7265 6e74  ournament(parent
-00025270: 2c20 322c 2074 6f75 726e 7369 7a65 3d31  , 2, tournsize=1
-00025280: 3529 0a20 2020 2020 2020 2065 6c69 6620  5).        elif 
-00025290: 7365 6c65 6374 696f 6e5f 6f70 6572 6174  selection_operat
-000252a0: 6f72 203d 3d20 2754 6f75 726e 616d 656e  or == 'Tournamen
-000252b0: 742d 3330 273a 0a20 2020 2020 2020 2020  t-30':.         
-000252c0: 2020 206f 6666 7370 7269 6e67 203d 2073     offspring = s
-000252d0: 656c 546f 7572 6e61 6d65 6e74 2870 6172  elTournament(par
-000252e0: 656e 742c 2032 2c20 746f 7572 6e73 697a  ent, 2, tournsiz
-000252f0: 653d 3330 290a 2020 2020 2020 2020 656c  e=30).        el
-00025300: 6966 2073 656c 6563 7469 6f6e 5f6f 7065  if selection_ope
-00025310: 7261 746f 7220 3d3d 2027 4175 746f 6d61  rator == 'Automa
-00025320: 7469 634c 6578 6963 6173 6527 3a0a 2020  ticLexicase':.  
-00025330: 2020 2020 2020 2020 2020 6f66 6673 7072            offspr
-00025340: 696e 6720 3d20 7365 6c41 7574 6f6d 6174  ing = selAutomat
-00025350: 6963 4570 7369 6c6f 6e4c 6578 6963 6173  icEpsilonLexicas
-00025360: 6546 6173 7428 7061 7265 6e74 2c20 3229  eFast(parent, 2)
-00025370: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
-00025380: 6c65 6374 696f 6e5f 6f70 6572 6174 6f72  lection_operator
-00025390: 203d 3d20 274d 6178 416e 676c 6553 656c   == 'MaxAngleSel
-000253a0: 6563 7469 6f6e 273a 0a20 2020 2020 2020  ection':.       
-000253b0: 2020 2020 206f 6666 7370 7269 6e67 203d       offspring =
-000253c0: 2073 656c 4d61 7841 6e67 6c65 5365 6c65   selMaxAngleSele
-000253d0: 6374 696f 6e28 7061 7265 6e74 2c20 322c  ction(parent, 2,
-000253e0: 2073 656c 662e 7929 0a20 2020 2020 2020   self.y).       
-000253f0: 2065 6c69 6620 7365 6c65 6374 696f 6e5f   elif selection_
-00025400: 6f70 6572 6174 6f72 203d 3d20 2741 6e67  operator == 'Ang
-00025410: 6c65 4472 6976 656e 5365 6c65 6374 696f  leDrivenSelectio
-00025420: 6e27 3a0a 2020 2020 2020 2020 2020 2020  n':.            
-00025430: 6f66 6673 7072 696e 6720 3d20 7365 6c41  offspring = selA
-00025440: 6e67 6c65 4472 6976 656e 5365 6c65 6374  ngleDrivenSelect
-00025450: 696f 6e28 7061 7265 6e74 2c20 322c 2073  ion(parent, 2, s
-00025460: 656c 662e 7929 0a20 2020 2020 2020 2065  elf.y).        e
-00025470: 6c69 6620 7365 6c66 2e73 656c 6563 7420  lif self.select 
-00025480: 3d3d 2027 4d41 502d 456c 6974 652d 4b6e  == 'MAP-Elite-Kn
-00025490: 6f63 6b6f 7574 2d41 273a 0a20 2020 2020  ockout-A':.     
-000254a0: 2020 2020 2020 206f 6666 7370 7269 6e67         offspring
-000254b0: 203d 2073 656c 4b6e 6f63 6b6f 7574 2870   = selKnockout(p
-000254c0: 6172 656e 742c 2032 2c20 6175 746f 5f63  arent, 2, auto_c
-000254d0: 6173 653d 5472 7565 290a 2020 2020 2020  ase=True).      
-000254e0: 2020 656c 6966 2073 656c 662e 7365 6c65    elif self.sele
-000254f0: 6374 203d 3d20 274d 4150 2d45 6c69 7465  ct == 'MAP-Elite
-00025500: 2d4b 6e6f 636b 6f75 742d 5327 3a0a 2020  -Knockout-S':.  
-00025510: 2020 2020 2020 2020 2020 6f66 6673 7072            offspr
-00025520: 696e 6720 3d20 7365 6c4b 6e6f 636b 6f75  ing = selKnockou
-00025530: 7428 7061 7265 6e74 2c20 322c 2076 6572  t(parent, 2, ver
-00025540: 7369 6f6e 3d27 5327 290a 2020 2020 2020  sion='S').      
-00025550: 2020 656c 6966 2073 656c 662e 7365 6c65    elif self.sele
-00025560: 6374 203d 3d20 274d 4150 2d45 6c69 7465  ct == 'MAP-Elite
-00025570: 2d4b 6e6f 636b 6f75 742d 5341 273a 0a20  -Knockout-SA':. 
-00025580: 2020 2020 2020 2020 2020 206f 6666 7370             offsp
-00025590: 7269 6e67 203d 2073 656c 4b6e 6f63 6b6f  ring = selKnocko
-000255a0: 7574 2870 6172 656e 742c 2032 2c20 7665  ut(parent, 2, ve
-000255b0: 7273 696f 6e3d 2753 272c 2061 7574 6f5f  rsion='S', auto_
-000255c0: 6361 7365 3d54 7275 6529 0a20 2020 2020  case=True).     
-000255d0: 2020 2065 6c69 6620 7365 6c65 6374 696f     elif selectio
-000255e0: 6e5f 6f70 6572 6174 6f72 203d 3d20 274d  n_operator == 'M
-000255f0: 4150 2d45 6c69 7465 2d54 6f75 726e 616d  AP-Elite-Tournam
-00025600: 656e 742d 3327 3a0a 2020 2020 2020 2020  ent-3':.        
-00025610: 2020 2020 6f66 6673 7072 696e 6720 3d20      offspring = 
-00025620: 7365 6c54 6f75 726e 616d 656e 7428 7061  selTournament(pa
-00025630: 7265 6e74 2c20 322c 2074 6f75 726e 7369  rent, 2, tournsi
-00025640: 7a65 3d33 290a 2020 2020 2020 2020 656c  ze=3).        el
-00025650: 6966 2073 656c 6563 7469 6f6e 5f6f 7065  if selection_ope
-00025660: 7261 746f 7220 3d3d 2027 4d41 502d 456c  rator == 'MAP-El
-00025670: 6974 652d 546f 7572 6e61 6d65 6e74 2d37  ite-Tournament-7
-00025680: 273a 0a20 2020 2020 2020 2020 2020 206f  ':.            o
-00025690: 6666 7370 7269 6e67 203d 2073 656c 546f  ffspring = selTo
-000256a0: 7572 6e61 6d65 6e74 2870 6172 656e 742c  urnament(parent,
-000256b0: 2032 2c20 746f 7572 6e73 697a 653d 3729   2, tournsize=7)
-000256c0: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
-000256d0: 6c65 6374 696f 6e5f 6f70 6572 6174 6f72  lection_operator
-000256e0: 203d 3d20 274d 4150 2d45 6c69 7465 2d52   == 'MAP-Elite-R
-000256f0: 616e 646f 6d27 3a0a 2020 2020 2020 2020  andom':.        
-00025700: 2020 2020 6f66 6673 7072 696e 6720 3d20      offspring = 
-00025710: 7365 6c52 616e 646f 6d28 7061 7265 6e74  selRandom(parent
-00025720: 2c20 3229 0a20 2020 2020 2020 2065 6c69  , 2).        eli
-00025730: 6620 7365 6c65 6374 696f 6e5f 6f70 6572  f selection_oper
-00025740: 6174 6f72 203d 3d20 274d 4150 2d45 6c69  ator == 'MAP-Eli
-00025750: 7465 2d52 6f75 6c65 7474 6527 3a0a 2020  te-Roulette':.  
-00025760: 2020 2020 2020 2020 2020 7061 7265 6e74            parent
-00025770: 203d 206c 6973 7428 6669 6c74 6572 286c   = list(filter(l
-00025780: 616d 6264 6120 783a 2078 2e66 6974 6e65  ambda x: x.fitne
-00025790: 7373 2e77 7661 6c75 6573 5b30 5d20 3e20  ss.wvalues[0] > 
-000257a0: 302c 2070 6172 656e 7429 290a 2020 2020  0, parent)).    
-000257b0: 2020 2020 2020 2020 6f66 6673 7072 696e          offsprin
-000257c0: 6720 3d20 7365 6c52 6f75 6c65 7474 6528  g = selRoulette(
-000257d0: 7061 7265 6e74 2c20 3229 0a20 2020 2020  parent, 2).     
-000257e0: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
-000257f0: 6e28 6f66 6673 7072 696e 6729 203d 3d20  n(offspring) == 
-00025800: 320a 2020 2020 2020 2020 656c 7365 3a0a  2.        else:.
-00025810: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00025820: 6520 4578 6365 7074 696f 6e0a 2020 2020  e Exception.    
-00025830: 2020 2020 7265 7475 726e 206f 6666 7370      return offsp
-00025840: 7269 6e67 0a0a 2020 2020 6465 6620 6d61  ring..    def ma
-00025850: 705f 656c 6974 655f 6765 6e65 7261 7469  p_elite_generati
-00025860: 6f6e 2873 656c 662c 2070 6f70 756c 6174  on(self, populat
-00025870: 696f 6e2c 2065 6c69 7465 5f6d 6170 2c20  ion, elite_map, 
-00025880: 706f 705f 706f 6f6c 293a 0a20 2020 2020  pop_pool):.     
-00025890: 2020 2022 2222 0a20 2020 2020 2020 203a     """.        :
-000258a0: 7061 7261 6d20 706f 7075 6c61 7469 6f6e  param population
-000258b0: 3a20 5374 6f72 6520 696e 6469 7669 6475  : Store individu
-000258c0: 616c 7320 696e 2074 6865 2063 7572 7265  als in the curre
-000258d0: 6e74 2067 656e 6572 6174 696f 6e0a 2020  nt generation.  
-000258e0: 2020 2020 2020 3a70 6172 616d 2065 6c69        :param eli
-000258f0: 7465 5f6d 6170 3a20 5374 6f72 6520 7365  te_map: Store se
-00025900: 6c65 6374 6564 2069 6e64 6976 6964 7561  lected individua
-00025910: 6c73 0a20 2020 2020 2020 203a 7061 7261  ls.        :para
-00025920: 6d20 706f 705f 706f 6f6c 3a20 5374 6f72  m pop_pool: Stor
-00025930: 6520 6b2a 706f 705f 7369 7a65 2069 6e64  e k*pop_size ind
-00025940: 6976 6964 7561 6c73 0a20 2020 2020 2020  ividuals.       
-00025950: 203a 7265 7475 726e 3a0a 2020 2020 2020   :return:.      
-00025960: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
-00025970: 2073 656c 662e 7365 6c65 6374 2069 6e20   self.select in 
-00025980: 6d61 705f 656c 6974 655f 7365 7269 6573  map_elite_series
-00025990: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-000259a0: 2073 656c 662e 6d61 705f 656c 6974 655f   self.map_elite_
-000259b0: 7061 7261 6d65 7465 725b 2774 7970 6527  parameter['type'
-000259c0: 5d20 3d3d 2027 4772 6964 273a 0a20 2020  ] == 'Grid':.   
-000259d0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-000259e0: 7465 5f6d 6170 203d 2073 656c 4d41 5045  te_map = selMAPE
-000259f0: 6c69 7465 7328 706f 7075 6c61 7469 6f6e  lites(population
-00025a00: 2c20 656c 6974 655f 6d61 702c 2073 656c  , elite_map, sel
-00025a10: 662e 6d61 705f 656c 6974 655f 7061 7261  f.map_elite_para
-00025a20: 6d65 7465 722c 2073 656c 662e 7929 0a20  meter, self.y). 
-00025a30: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00025a40: 7365 6c66 2e6d 6170 5f65 6c69 7465 5f70  self.map_elite_p
-00025a50: 6172 616d 6574 6572 5b27 7479 7065 275d  arameter['type']
-00025a60: 2e73 7461 7274 7377 6974 6828 2747 7269  .startswith('Gri
-00025a70: 642d 5379 6e74 6865 7469 6327 293a 0a20  d-Synthetic'):. 
-00025a80: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00025a90: 6174 696f 203d 2066 6c6f 6174 2873 656c  atio = float(sel
-00025aa0: 662e 6d61 705f 656c 6974 655f 7061 7261  f.map_elite_para
-00025ab0: 6d65 7465 725b 2774 7970 6527 5d2e 7265  meter['type'].re
-00025ac0: 706c 6163 6528 2747 7269 642d 5379 6e74  place('Grid-Synt
-00025ad0: 6865 7469 632d 272c 2027 2729 290a 2020  hetic-', '')).  
-00025ae0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00025af0: 6974 655f 6d61 7020 3d20 7365 6c4d 4150  ite_map = selMAP
-00025b00: 456c 6974 6573 2870 6f70 756c 6174 696f  Elites(populatio
-00025b10: 6e2c 2065 6c69 7465 5f6d 6170 2c20 7365  n, elite_map, se
-00025b20: 6c66 2e6d 6170 5f65 6c69 7465 5f70 6172  lf.map_elite_par
-00025b30: 616d 6574 6572 2c20 7365 6c66 2e79 2c0a  ameter, self.y,.
-00025b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025b60: 2020 2020 2020 2020 2064 6174 615f 6175           data_au
-00025b70: 676d 656e 7461 7469 6f6e 3d72 6174 696f  gmentation=ratio
-00025b80: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
-00025b90: 6966 2073 656c 662e 6d61 705f 656c 6974  if self.map_elit
-00025ba0: 655f 7061 7261 6d65 7465 725b 2774 7970  e_parameter['typ
-00025bb0: 6527 5d20 3d3d 2027 4772 6964 2d41 7574  e'] == 'Grid-Aut
-00025bc0: 6f27 3a0a 2020 2020 2020 2020 2020 2020  o':.            
-00025bd0: 2020 2020 656c 6974 655f 6d61 7073 203d      elite_maps =
-00025be0: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
-00025bf0: 2020 2020 666f 7220 6964 2c20 7061 7261      for id, para
-00025c00: 6d65 7465 7273 2069 6e20 656e 756d 6572  meters in enumer
-00025c10: 6174 6528 5b7b 2766 6974 6e65 7373 5f72  ate([{'fitness_r
-00025c20: 6174 696f 273a 2078 2c0a 2020 2020 2020  atio': x,.      
-00025c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025c50: 2020 2020 2020 2020 2020 2020 276d 6170              'map
-00025c60: 5f73 697a 6527 3a20 797d 0a20 2020 2020  _size': y}.     
-00025c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025c90: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00025ca0: 7820 696e 205b 302e 322c 2030 2e35 2c20  x in [0.2, 0.5, 
-00025cb0: 302e 385d 2066 6f72 2079 2069 6e20 5b35  0.8] for y in [5
-00025cc0: 2c20 3130 2c20 3135 5d5d 293a 0a20 2020  , 10, 15]]):.   
+00024140: 6d6f 6465 203d 2073 656c 662e 6d61 625f  mode = self.mab_
+00024150: 7061 7261 6d65 7465 722e 6765 7428 276d  parameter.get('m
+00024160: 6f64 6527 2c20 2744 6563 6179 2729 0a20  ode', 'Decay'). 
+00024170: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00024180: 6e74 203d 2043 6f75 6e74 6572 287b 0a20  nt = Counter({. 
+00024190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000241a0: 2020 2069 643a 2030 0a20 2020 2020 2020     id: 0.       
+000241b0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+000241c0: 2069 6420 696e 2072 616e 6765 2830 2c20   id in range(0, 
+000241d0: 6c65 6e28 7365 6c65 6374 696f 6e5f 6461  len(selection_da
+000241e0: 7461 5b30 5d29 290a 2020 2020 2020 2020  ta[0])).        
+000241f0: 2020 2020 2020 2020 7d29 0a20 2020 2020          }).     
+00024200: 2020 2020 2020 2020 2020 2069 6620 6d6f             if mo
+00024210: 6465 203d 3d20 2744 6563 6179 273a 0a20  de == 'Decay':. 
+00024220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024230: 2020 2073 656c 6563 7469 6f6e 5f64 6174     selection_dat
+00024240: 615b 305d 202a 3d20 7365 6c66 2e6d 6162  a[0] *= self.mab
+00024250: 5f70 6172 616d 6574 6572 5b27 6465 6361  _parameter['deca
+00024260: 795f 7261 7469 6f27 5d0a 2020 2020 2020  y_ratio'].      
+00024270: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00024280: 6c65 6374 696f 6e5f 6461 7461 5b31 5d20  lection_data[1] 
+00024290: 2a3d 2073 656c 662e 6d61 625f 7061 7261  *= self.mab_para
+000242a0: 6d65 7465 725b 2764 6563 6179 5f72 6174  meter['decay_rat
+000242b0: 696f 275d 0a20 2020 2020 2020 2020 2020  io'].           
+000242c0: 2020 2020 2043 203d 2073 656c 662e 6d61       C = self.ma
+000242d0: 625f 7061 7261 6d65 7465 722e 6765 7428  b_parameter.get(
+000242e0: 2774 6872 6573 686f 6c64 272c 2031 3030  'threshold', 100
+000242f0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00024300: 2020 6966 2063 6f6d 7061 7269 736f 6e5f    if comparison_
+00024310: 6372 6974 6572 696f 6e20 3d3d 2027 4361  criterion == 'Ca
+00024320: 7365 2d53 696d 706c 6527 3a0a 2020 2020  se-Simple':.    
+00024330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024340: 6265 7374 5f76 616c 7565 203d 206e 702e  best_value = np.
+00024350: 6d69 6e28 5b70 2e63 6173 655f 7661 6c75  min([p.case_valu
+00024360: 6573 2066 6f72 2070 2069 6e20 706f 7075  es for p in popu
+00024370: 6c61 7469 6f6e 5d2c 2061 7869 733d 3029  lation], axis=0)
+00024380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024390: 2066 6f72 206f 2069 6e20 6f66 6673 7072   for o in offspr
+000243a0: 696e 673a 0a20 2020 2020 2020 2020 2020  ing:.           
+000243b0: 2020 2020 2020 2020 2063 6e74 5b6f 2e73           cnt[o.s
+000243c0: 656c 6563 7469 6f6e 5f6f 7065 7261 746f  election_operato
+000243d0: 725d 202b 3d20 310a 2020 2020 2020 2020  r] += 1.        
+000243e0: 2020 2020 2020 2020 2020 2020 6966 2028              if (
+000243f0: 636f 6d70 6172 6973 6f6e 5f63 7269 7465  comparison_crite
+00024400: 7269 6f6e 2069 6e20 5b27 4669 746e 6573  rion in ['Fitnes
+00024410: 7327 2c20 2746 6974 6e65 7373 2d43 6173  s', 'Fitness-Cas
+00024420: 6527 5d20 616e 6420 6f2e 6669 746e 6573  e'] and o.fitnes
+00024430: 732e 7776 616c 7565 735b 305d 203e 2062  s.wvalues[0] > b
+00024440: 6573 745f 7661 6c75 6529 206f 7220 5c0a  est_value) or \.
+00024450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024460: 2020 2020 2020 2020 2863 6f6d 7061 7269          (compari
+00024470: 736f 6e5f 6372 6974 6572 696f 6e20 696e  son_criterion in
+00024480: 205b 2743 6173 6527 2c20 2743 6173 652d   ['Case', 'Case-
+00024490: 5369 6d70 6c65 275d 2061 6e64 206e 702e  Simple'] and np.
+000244a0: 616e 7928 6f2e 6361 7365 5f76 616c 7565  any(o.case_value
+000244b0: 7320 3c20 6265 7374 5f76 616c 7565 2929  s < best_value))
+000244c0: 206f 7220 5c0a 2020 2020 2020 2020 2020   or \.          
+000244d0: 2020 2020 2020 2020 2020 2020 2020 2869                (i
+000244e0: 7369 6e73 7461 6e63 6528 636f 6d70 6172  sinstance(compar
+000244f0: 6973 6f6e 5f63 7269 7465 7269 6f6e 2c20  ison_criterion, 
+00024500: 696e 7429 2061 6e64 0a20 2020 2020 2020  int) and.       
+00024510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024520: 2020 6e70 2e73 756d 286f 2e63 6173 655f    np.sum(o.case_
+00024530: 7661 6c75 6573 203c 2062 6573 745f 7661  values < best_va
+00024540: 6c75 6529 203e 2063 6f6d 7061 7269 736f  lue) > compariso
+00024550: 6e5f 6372 6974 6572 696f 6e29 3a0a 2020  n_criterion):.  
+00024560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024570: 2020 2020 2020 7365 6c65 6374 696f 6e5f        selection_
+00024580: 6461 7461 5b30 5d5b 6f2e 7365 6c65 6374  data[0][o.select
+00024590: 696f 6e5f 6f70 6572 6174 6f72 5d20 2b3d  ion_operator] +=
+000245a0: 2031 0a20 2020 2020 2020 2020 2020 2020   1.             
+000245b0: 2020 2020 2020 2065 6c69 6620 636f 6d70         elif comp
+000245c0: 6172 6973 6f6e 5f63 7269 7465 7269 6f6e  arison_criterion
+000245d0: 203d 3d20 2746 6974 6e65 7373 2d43 6173   == 'Fitness-Cas
+000245e0: 6527 2061 6e64 206e 702e 616e 7928 6f2e  e' and np.any(o.
+000245f0: 6361 7365 5f76 616c 7565 7320 3c20 7061  case_values < pa
+00024600: 7265 6e74 5f63 6173 655f 7661 6c75 6573  rent_case_values
+00024610: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00024620: 2020 2020 2020 2020 2020 2023 2064 6f6e             # don
+00024630: 2774 2063 6f6e 7369 6465 7220 7468 6973  't consider this
+00024640: 2074 7269 616c 2061 7320 7375 6363 6573   trial as succes
+00024650: 7320 6f72 2066 6169 6c75 7265 0a20 2020  s or failure.   
+00024660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024670: 2020 2020 2070 6173 730a 2020 2020 2020       pass.      
+00024680: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00024690: 6966 2063 6f6d 7061 7269 736f 6e5f 6372  if comparison_cr
+000246a0: 6974 6572 696f 6e20 3d3d 2027 4361 7365  iterion == 'Case
+000246b0: 2d50 6c75 7327 3a0a 2020 2020 2020 2020  -Plus':.        
+000246c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000246d0: 6966 206e 702e 616e 7928 6f2e 6361 7365  if np.any(o.case
+000246e0: 5f76 616c 7565 7320 3c20 6265 7374 5f76  _values < best_v
+000246f0: 616c 7565 293a 0a20 2020 2020 2020 2020  alue):.         
+00024700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024710: 2020 2073 656c 6563 7469 6f6e 5f64 6174     selection_dat
+00024720: 615b 305d 5b6f 2e73 656c 6563 7469 6f6e  a[0][o.selection
+00024730: 5f6f 7065 7261 746f 725d 202b 3d20 6e70  _operator] += np
+00024740: 2e73 756d 286f 2e63 6173 655f 7661 6c75  .sum(o.case_valu
+00024750: 6573 203c 2062 6573 745f 7661 6c75 6529  es < best_value)
+00024760: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024770: 2020 2020 2020 2020 2069 6620 6e70 2e61           if np.a
+00024780: 6e79 286f 2e63 6173 655f 7661 6c75 6573  ny(o.case_values
+00024790: 203e 2077 6f72 7374 5f76 616c 7565 293a   > worst_value):
+000247a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000247b0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000247c0: 6563 7469 6f6e 5f64 6174 615b 315d 5b6f  ection_data[1][o
+000247d0: 2e73 656c 6563 7469 6f6e 5f6f 7065 7261  .selection_opera
+000247e0: 746f 725d 202b 3d20 6e70 2e73 756d 286f  tor] += np.sum(o
+000247f0: 2e63 6173 655f 7661 6c75 6573 203e 2077  .case_values > w
+00024800: 6f72 7374 5f76 616c 7565 290a 2020 2020  orst_value).    
+00024810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024820: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00024830: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00024840: 6c65 6374 696f 6e5f 6461 7461 5b31 5d5b  lection_data[1][
+00024850: 6f2e 7365 6c65 6374 696f 6e5f 6f70 6572  o.selection_oper
+00024860: 6174 6f72 5d20 2b3d 2031 0a20 2020 2020  ator] += 1.     
+00024870: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00024880: 6f70 6572 6174 6f72 5f73 656c 6563 7469  operator_selecti
+00024890: 6f6e 5f68 6973 746f 7279 2e61 7070 656e  on_history.appen
+000248a0: 6428 7475 706c 6528 636e 742e 7661 6c75  d(tuple(cnt.valu
+000248b0: 6573 2829 2929 0a20 2020 2020 2020 2020  es())).         
+000248c0: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
+000248d0: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
+000248e0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+000248f0: 7428 7365 6c65 6374 696f 6e5f 6461 7461  t(selection_data
+00024900: 5b30 5d2c 2073 656c 6563 7469 6f6e 5f64  [0], selection_d
+00024910: 6174 615b 315d 290a 2020 2020 2020 2020  ata[1]).        
+00024920: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00024930: 7428 636e 7429 0a20 2020 2020 2020 2020  t(cnt).         
+00024940: 2020 2020 2020 2069 6620 6d6f 6465 203d         if mode =
+00024950: 3d20 2754 6872 6573 686f 6c64 273a 0a20  = 'Threshold':. 
+00024960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024970: 2020 2023 2066 6978 6564 2074 6872 6573     # fixed thres
+00024980: 686f 6c64 0a20 2020 2020 2020 2020 2020  hold.           
+00024990: 2020 2020 2020 2020 2066 6f72 206f 7020           for op 
+000249a0: 696e 2072 616e 6765 2873 656c 6563 7469  in range(selecti
+000249b0: 6f6e 5f64 6174 612e 7368 6170 655b 315d  on_data.shape[1]
+000249c0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+000249d0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+000249e0: 6c65 6374 696f 6e5f 6461 7461 5b30 5d5b  lection_data[0][
+000249f0: 6f70 5d20 2b20 7365 6c65 6374 696f 6e5f  op] + selection_
+00024a00: 6461 7461 5b31 5d5b 6f70 5d20 3e20 433a  data[1][op] > C:
+00024a10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024a20: 2020 2020 2020 2020 2020 2020 2073 756d               sum
+00024a30: 5f64 6174 6120 3d20 7365 6c65 6374 696f  _data = selectio
+00024a40: 6e5f 6461 7461 5b30 5d5b 6f70 5d20 2b20  n_data[0][op] + 
+00024a50: 7365 6c65 6374 696f 6e5f 6461 7461 5b31  selection_data[1
+00024a60: 5d5b 6f70 5d0a 2020 2020 2020 2020 2020  ][op].          
+00024a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024a80: 2020 7365 6c65 6374 696f 6e5f 6461 7461    selection_data
+00024a90: 5b30 5d5b 6f70 5d20 3d20 7365 6c65 6374  [0][op] = select
+00024aa0: 696f 6e5f 6461 7461 5b30 5d5b 6f70 5d20  ion_data[0][op] 
+00024ab0: 2f20 7375 6d5f 6461 7461 202a 2043 0a20  / sum_data * C. 
+00024ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024ad0: 2020 2020 2020 2020 2020 2073 656c 6563             selec
+00024ae0: 7469 6f6e 5f64 6174 615b 315d 5b6f 705d  tion_data[1][op]
+00024af0: 203d 2073 656c 6563 7469 6f6e 5f64 6174   = selection_dat
+00024b00: 615b 315d 5b6f 705d 202f 2073 756d 5f64  a[1][op] / sum_d
+00024b10: 6174 6120 2a20 430a 2020 2020 2020 2020  ata * C.        
+00024b20: 2020 2020 2020 2020 2320 6176 6f69 6420          # avoid 
+00024b30: 7472 6976 6961 6c20 7072 6f62 6162 696c  trivial probabil
+00024b40: 6974 790a 2020 2020 2020 2020 2020 2020  ity.            
+00024b50: 2020 2020 7365 6c65 6374 696f 6e5f 6461      selection_da
+00024b60: 7461 203d 206e 702e 636c 6970 2873 656c  ta = np.clip(sel
+00024b70: 6563 7469 6f6e 5f64 6174 612c 2031 652d  ection_data, 1e-
+00024b80: 322c 204e 6f6e 6529 0a0a 2020 2020 2020  2, None)..      
+00024b90: 2020 2020 2020 6966 2073 656c 662e 7365        if self.se
+00024ba0: 6c65 6374 203d 3d20 2741 7574 6f2d 4d43  lect == 'Auto-MC
+00024bb0: 5453 273a 0a20 2020 2020 2020 2020 2020  TS':.           
+00024bc0: 2020 2020 2073 656c 6563 7469 6f6e 5f63       selection_c
+00024bd0: 6f75 6e74 6572 203d 2064 6566 6175 6c74  ounter = default
+00024be0: 6469 6374 2869 6e74 290a 2020 2020 2020  dict(int).      
+00024bf0: 2020 2020 2020 2020 2020 6765 6e65 5f63            gene_c
+00024c00: 6f75 6e74 6572 203d 2064 6566 6175 6c74  ounter = default
+00024c10: 6469 6374 2869 6e74 290a 2020 2020 2020  dict(int).      
+00024c20: 2020 2020 2020 2020 2020 4320 3d20 7365            C = se
+00024c30: 6c66 2e6d 6162 5f70 6172 616d 6574 6572  lf.mab_parameter
+00024c40: 2e67 6574 2827 7468 7265 7368 6f6c 6427  .get('threshold'
+00024c50: 2c20 3130 3029 0a20 2020 2020 2020 2020  , 100).         
+00024c60: 2020 2020 2020 2066 6f72 206f 2069 6e20         for o in 
+00024c70: 6f66 6673 7072 696e 673a 0a20 2020 2020  offspring:.     
+00024c80: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00024c90: 6620 2863 6f6d 7061 7269 736f 6e5f 6372  f (comparison_cr
+00024ca0: 6974 6572 696f 6e20 696e 205b 2746 6974  iterion in ['Fit
+00024cb0: 6e65 7373 272c 2027 4669 746e 6573 732d  ness', 'Fitness-
+00024cc0: 4361 7365 275d 2061 6e64 206f 2e66 6974  Case'] and o.fit
+00024cd0: 6e65 7373 2e77 7661 6c75 6573 5b30 5d20  ness.wvalues[0] 
+00024ce0: 3e20 6265 7374 5f76 616c 7565 2920 6f72  > best_value) or
+00024cf0: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
+00024d00: 2020 2020 2020 2020 2020 2028 636f 6d70             (comp
+00024d10: 6172 6973 6f6e 5f63 7269 7465 7269 6f6e  arison_criterion
+00024d20: 2069 6e20 5b27 4361 7365 272c 2027 4361   in ['Case', 'Ca
+00024d30: 7365 2d53 696d 706c 6527 5d20 616e 6420  se-Simple'] and 
+00024d40: 6e70 2e61 6e79 286f 2e63 6173 655f 7661  np.any(o.case_va
+00024d50: 6c75 6573 203c 2062 6573 745f 7661 6c75  lues < best_valu
+00024d60: 6529 2920 6f72 205c 0a20 2020 2020 2020  e)) or \.       
+00024d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024d80: 2028 6973 696e 7374 616e 6365 2863 6f6d   (isinstance(com
+00024d90: 7061 7269 736f 6e5f 6372 6974 6572 696f  parison_criterio
+00024da0: 6e2c 2069 6e74 2920 616e 640a 2020 2020  n, int) and.    
+00024db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024dc0: 2020 2020 206e 702e 7375 6d28 6f2e 6361       np.sum(o.ca
+00024dd0: 7365 5f76 616c 7565 7320 3c20 6265 7374  se_values < best
+00024de0: 5f76 616c 7565 2920 3e20 636f 6d70 6172  _value) > compar
+00024df0: 6973 6f6e 5f63 7269 7465 7269 6f6e 293a  ison_criterion):
+00024e00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024e10: 2020 2020 2020 2020 206d 6374 735f 6469           mcts_di
+00024e20: 6374 5b27 5375 7276 6976 616c 204f 7065  ct['Survival Ope
+00024e30: 7261 746f 7273 275d 5b30 5d5b 6f2e 7375  rators'][0][o.su
+00024e40: 7276 6976 616c 5f6f 7065 7261 746f 725f  rvival_operator_
+00024e50: 6964 5d20 2b3d 2031 0a20 2020 2020 2020  id] += 1.       
+00024e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024e70: 206d 6374 735f 6469 6374 5b27 5365 6c65   mcts_dict['Sele
+00024e80: 6374 696f 6e20 4f70 6572 6174 6f72 7327  ction Operators'
+00024e90: 5d5b 305d 5b6f 2e73 656c 6563 7469 6f6e  ][0][o.selection
+00024ea0: 5f6f 7065 7261 746f 725d 202b 3d20 310a  _operator] += 1.
+00024eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024ec0: 2020 2020 656c 6966 2063 6f6d 7061 7269      elif compari
+00024ed0: 736f 6e5f 6372 6974 6572 696f 6e20 3d3d  son_criterion ==
+00024ee0: 2027 4669 746e 6573 732d 4361 7365 2720   'Fitness-Case' 
+00024ef0: 616e 6420 6e70 2e61 6e79 286f 2e63 6173  and np.any(o.cas
+00024f00: 655f 7661 6c75 6573 203c 2070 6172 656e  e_values < paren
+00024f10: 745f 6361 7365 5f76 616c 7565 7329 3a0a  t_case_values):.
+00024f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024f30: 2020 2020 2020 2020 2320 646f 6e27 7420          # don't 
+00024f40: 636f 6e73 6964 6572 2074 6869 7320 7472  consider this tr
+00024f50: 6961 6c20 6173 2073 7563 6365 7373 206f  ial as success o
+00024f60: 7220 6661 696c 7572 650a 2020 2020 2020  r failure.      
+00024f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024f80: 2020 7061 7373 0a20 2020 2020 2020 2020    pass.         
+00024f90: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00024fa0: 636f 6d70 6172 6973 6f6e 5f63 7269 7465  comparison_crite
+00024fb0: 7269 6f6e 203d 3d20 2743 6173 652d 506c  rion == 'Case-Pl
+00024fc0: 7573 273a 0a20 2020 2020 2020 2020 2020  us':.           
+00024fd0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00024fe0: 6e70 2e61 6e79 286f 2e63 6173 655f 7661  np.any(o.case_va
+00024ff0: 6c75 6573 203c 2062 6573 745f 7661 6c75  lues < best_valu
+00025000: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+00025010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025020: 6d63 7473 5f64 6963 745b 2753 7572 7669  mcts_dict['Survi
+00025030: 7661 6c20 4f70 6572 6174 6f72 7327 5d5b  val Operators'][
+00025040: 305d 5b6f 2e73 7572 7669 7661 6c5f 6f70  0][o.survival_op
+00025050: 6572 6174 6f72 5f69 645d 202b 3d20 6e70  erator_id] += np
+00025060: 2e73 756d 280a 2020 2020 2020 2020 2020  .sum(.          
+00025070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025080: 2020 2020 2020 6f2e 6361 7365 5f76 616c        o.case_val
+00025090: 7565 7320 3c20 6265 7374 5f76 616c 7565  ues < best_value
+000250a0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000250b0: 2020 2020 2020 2020 2020 2020 2020 6d63                mc
+000250c0: 7473 5f64 6963 745b 2753 656c 6563 7469  ts_dict['Selecti
+000250d0: 6f6e 204f 7065 7261 746f 7273 275d 5b30  on Operators'][0
+000250e0: 5d5b 6f2e 7365 6c65 6374 696f 6e5f 6f70  ][o.selection_op
+000250f0: 6572 6174 6f72 5d20 2b3d 206e 702e 7375  erator] += np.su
+00025100: 6d28 0a20 2020 2020 2020 2020 2020 2020  m(.             
+00025110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025120: 2020 206f 2e63 6173 655f 7661 6c75 6573     o.case_values
+00025130: 203c 2062 6573 745f 7661 6c75 6529 0a20   < best_value). 
+00025140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025150: 2020 2020 2020 2069 6620 6e70 2e61 6e79         if np.any
+00025160: 286f 2e63 6173 655f 7661 6c75 6573 203c  (o.case_values <
+00025170: 2077 6f72 7374 5f76 616c 7565 293a 0a20   worst_value):. 
+00025180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025190: 2020 2020 2020 2020 2020 206d 6374 735f             mcts_
+000251a0: 6469 6374 5b27 5375 7276 6976 616c 204f  dict['Survival O
+000251b0: 7065 7261 746f 7273 275d 5b31 5d5b 6f2e  perators'][1][o.
+000251c0: 7375 7276 6976 616c 5f6f 7065 7261 746f  survival_operato
+000251d0: 725f 6964 5d20 2b3d 206e 702e 7375 6d28  r_id] += np.sum(
+000251e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000251f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025200: 206f 2e63 6173 655f 7661 6c75 6573 203c   o.case_values <
+00025210: 2077 6f72 7374 5f76 616c 7565 290a 2020   worst_value).  
+00025220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025230: 2020 2020 2020 2020 2020 6d63 7473 5f64            mcts_d
+00025240: 6963 745b 2753 656c 6563 7469 6f6e 204f  ict['Selection O
+00025250: 7065 7261 746f 7273 275d 5b31 5d5b 6f2e  perators'][1][o.
+00025260: 7365 6c65 6374 696f 6e5f 6f70 6572 6174  selection_operat
+00025270: 6f72 5d20 2b3d 206e 702e 7375 6d28 0a20  or] += np.sum(. 
+00025280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025290: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+000252a0: 2e63 6173 655f 7661 6c75 6573 203c 2077  .case_values < w
+000252b0: 6f72 7374 5f76 616c 7565 290a 2020 2020  orst_value).    
+000252c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000252d0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000252e0: 2020 2020 2020 2020 2020 2020 2020 6d63                mc
+000252f0: 7473 5f64 6963 745b 2753 7572 7669 7661  ts_dict['Surviva
+00025300: 6c20 4f70 6572 6174 6f72 7327 5d5b 315d  l Operators'][1]
+00025310: 5b6f 2e73 7572 7669 7661 6c5f 6f70 6572  [o.survival_oper
+00025320: 6174 6f72 5f69 645d 202b 3d20 310a 2020  ator_id] += 1.  
+00025330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025340: 2020 2020 2020 6d63 7473 5f64 6963 745b        mcts_dict[
+00025350: 2753 656c 6563 7469 6f6e 204f 7065 7261  'Selection Opera
+00025360: 746f 7273 275d 5b31 5d5b 6f2e 7365 6c65  tors'][1][o.sele
+00025370: 6374 696f 6e5f 6f70 6572 6174 6f72 5d20  ction_operator] 
+00025380: 2b3d 2031 0a20 2020 2020 2020 2020 2020  += 1.           
+00025390: 2020 2020 2020 2020 2073 656c 6563 7469           selecti
+000253a0: 6f6e 5f63 6f75 6e74 6572 5b6f 2e73 656c  on_counter[o.sel
+000253b0: 6563 7469 6f6e 5f6f 7065 7261 746f 725d  ection_operator]
+000253c0: 202b 3d20 310a 2020 2020 2020 2020 2020   += 1.          
+000253d0: 2020 2020 2020 2020 2020 6765 6e65 5f63            gene_c
+000253e0: 6f75 6e74 6572 5b6f 2e73 7572 7669 7661  ounter[o.surviva
+000253f0: 6c5f 6f70 6572 6174 6f72 5f69 645d 202b  l_operator_id] +
+00025400: 3d20 310a 0a20 2020 2020 2020 2020 2020  = 1..           
+00025410: 2020 2020 2069 6620 7365 6c66 2e76 6572       if self.ver
+00025420: 626f 7365 3a0a 2020 2020 2020 2020 2020  bose:.          
+00025430: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00025440: 7365 6c65 6374 696f 6e5f 636f 756e 7465  selection_counte
+00025450: 722c 2067 656e 655f 636f 756e 7465 7229  r, gene_counter)
+00025460: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00025470: 2020 6d6f 6465 203d 2073 656c 662e 6d61    mode = self.ma
+00025480: 625f 7061 7261 6d65 7465 722e 6765 7428  b_parameter.get(
+00025490: 276d 6f64 6527 2c20 2744 6563 6179 2729  'mode', 'Decay')
+000254a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000254b0: 2023 2066 6978 6564 2074 6872 6573 686f   # fixed thresho
+000254c0: 6c64 0a20 2020 2020 2020 2020 2020 2020  ld.             
+000254d0: 2020 2066 6f72 206b 2c20 6461 7461 2069     for k, data i
+000254e0: 6e20 6d63 7473 5f64 6963 742e 6974 656d  n mcts_dict.item
+000254f0: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
+00025500: 2020 2020 2020 2020 2069 6620 6d6f 6465           if mode
+00025510: 203d 3d20 2754 6872 6573 686f 6c64 273a   == 'Threshold':
+00025520: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025530: 2020 2020 2020 2020 2023 2066 6978 6564           # fixed
+00025540: 2074 6872 6573 686f 6c64 0a20 2020 2020   threshold.     
+00025550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025560: 2020 2066 6f72 206f 7020 696e 2072 616e     for op in ran
+00025570: 6765 286c 656e 2864 6174 615b 305d 2929  ge(len(data[0]))
+00025580: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00025590: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000255a0: 2064 6174 615b 305d 5b6f 705d 202b 2064   data[0][op] + d
+000255b0: 6174 615b 315d 5b6f 705d 203e 2043 3a0a  ata[1][op] > C:.
+000255c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000255d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000255e0: 7375 6d5f 6461 7461 203d 2064 6174 615b  sum_data = data[
+000255f0: 305d 5b6f 705d 202b 2064 6174 615b 315d  0][op] + data[1]
+00025600: 5b6f 705d 0a20 2020 2020 2020 2020 2020  [op].           
+00025610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025620: 2020 2020 2064 6174 615b 305d 5b6f 705d       data[0][op]
+00025630: 203d 2064 6174 615b 305d 5b6f 705d 202f   = data[0][op] /
+00025640: 2073 756d 5f64 6174 6120 2a20 430a 2020   sum_data * C.  
+00025650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025660: 2020 2020 2020 2020 2020 2020 2020 6461                da
+00025670: 7461 5b31 5d5b 6f70 5d20 3d20 6461 7461  ta[1][op] = data
+00025680: 5b31 5d5b 6f70 5d20 2f20 7375 6d5f 6461  [1][op] / sum_da
+00025690: 7461 202a 2043 0a20 2020 2020 2020 2020  ta * C.         
+000256a0: 2020 2020 2020 2020 2020 2069 6620 6d6f             if mo
+000256b0: 6465 203d 3d20 2744 6563 6179 273a 0a20  de == 'Decay':. 
+000256c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000256d0: 2020 2020 2020 2064 6174 6120 2a3d 2073         data *= s
+000256e0: 656c 662e 6d61 625f 7061 7261 6d65 7465  elf.mab_paramete
+000256f0: 725b 2764 6563 6179 5f72 6174 696f 275d  r['decay_ratio']
+00025700: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025710: 2020 2020 2023 2061 766f 6964 2074 7269       # avoid tri
+00025720: 7669 616c 2073 6f6c 7574 696f 6e73 0a20  vial solutions. 
+00025730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025740: 2020 2064 6174 6120 3d20 6e70 2e63 6c69     data = np.cli
+00025750: 7028 6461 7461 2c20 3165 2d32 2c20 4e6f  p(data, 1e-2, No
+00025760: 6e65 290a 2020 2020 2020 2020 2020 2020  ne).            
+00025770: 2020 2020 2020 2020 6d63 7473 5f64 6963          mcts_dic
+00025780: 745b 6b5d 203d 2064 6174 610a 2020 2020  t[k] = data.    
+00025790: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+000257a0: 656c 662e 7665 7262 6f73 653a 0a20 2020  elf.verbose:.   
+000257b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000257c0: 2070 7269 6e74 2827 4d43 5453 2052 6573   print('MCTS Res
+000257d0: 756c 7427 2c20 6d63 7473 5f64 6963 7429  ult', mcts_dict)
+000257e0: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+000257f0: 5570 6461 7465 2074 6865 2068 616c 6c20  Update the hall 
+00025800: 6f66 2066 616d 6520 7769 7468 2074 6865  of fame with the
+00025810: 2067 656e 6572 6174 6564 2069 6e64 6976   generated indiv
+00025820: 6964 7561 6c73 0a20 2020 2020 2020 2020  iduals.         
+00025830: 2020 2069 6620 7365 6c66 2e73 7461 6765     if self.stage
+00025840: 5f66 6c61 673a 0a20 2020 2020 2020 2020  _flag:.         
+00025850: 2020 2020 2020 2070 7269 6e74 2827 5374         print('St
+00025860: 6172 7420 484f 4620 7570 6461 7469 6e67  art HOF updating
+00025870: 2729 0a20 2020 2020 2020 2020 2020 2069  ').            i
+00025880: 6620 7365 6c66 2e64 796e 616d 6963 5f74  f self.dynamic_t
+00025890: 6172 6765 743a 0a20 2020 2020 2020 2020  arget:.         
+000258a0: 2020 2020 2020 2068 616c 6c6f 6666 616d         halloffam
+000258b0: 652e 636c 6561 7228 290a 2020 2020 2020  e.clear().      
+000258c0: 2020 2020 2020 6966 2073 656c 662e 6c61        if self.la
+000258d0: 7373 6f5f 686f 6620 6973 206e 6f74 204e  sso_hof is not N
+000258e0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+000258f0: 2020 2020 2073 656c 662e 6c61 7373 6f5f       self.lasso_
+00025900: 686f 662e 7570 6461 7465 2870 6f70 756c  hof.update(popul
+00025910: 6174 696f 6e29 0a20 2020 2020 2020 2020  ation).         
+00025920: 2020 2069 6620 6861 6c6c 6f66 6661 6d65     if halloffame
+00025930: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
+00025940: 2077 6f72 7365 5f69 7465 7261 7469 6f6e   worse_iteration
+00025950: 7320 3d3d 2030 3a0a 2020 2020 2020 2020  s == 0:.        
+00025960: 2020 2020 2020 2020 6861 6c6c 6f66 6661          halloffa
+00025970: 6d65 2e75 7064 6174 6528 6f66 6673 7072  me.update(offspr
+00025980: 696e 6729 0a20 2020 2020 2020 2020 2020  ing).           
+00025990: 2020 2020 2069 6620 7365 6c66 2e76 6572       if self.ver
+000259a0: 626f 7365 3a0a 2020 2020 2020 2020 2020  bose:.          
+000259b0: 2020 2020 2020 2020 2020 6465 6620 7265            def re
+000259c0: 706c 6163 6528 7373 293a 0a20 2020 2020  place(ss):.     
+000259d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000259e0: 2020 2066 6f72 2073 2069 6e20 7261 6e67     for s in rang
+000259f0: 6528 7365 6c66 2e67 656e 655f 6e75 6d20  e(self.gene_num 
+00025a00: 2b20 7365 6c66 2e58 2e73 6861 7065 5b31  + self.X.shape[1
+00025a10: 5d2c 2073 656c 662e 582e 7368 6170 655b  ], self.X.shape[
+00025a20: 315d 202d 2031 2c20 2d31 293a 0a20 2020  1] - 1, -1):.   
+00025a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025a40: 2020 2020 2020 2020 2073 7320 3d20 7373           ss = ss
+00025a50: 2e72 6570 6c61 6365 2866 2741 5247 7b73  .replace(f'ARG{s
+00025a60: 7d27 2c20 6627 494e 537b 7320 2d20 7365  }', f'INS{s - se
+00025a70: 6c66 2e58 2e73 6861 7065 5b31 5d7d 2729  lf.X.shape[1]}')
+00025a80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025a90: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00025aa0: 7373 0a0a 2020 2020 2020 2020 2020 2020  ss..            
+00025ab0: 2020 2020 2020 2020 7072 696e 7428 275c          print('\
+00025ac0: 6e27 2e6a 6f69 6e28 5b72 6570 6c61 6365  n'.join([replace
+00025ad0: 2873 7472 2867 2929 2066 6f72 2067 2069  (str(g)) for g i
+00025ae0: 6e20 6861 6c6c 6f66 6661 6d65 5b30 5d2e  n halloffame[0].
+00025af0: 6765 6e65 5d29 290a 2020 2020 2020 2020  gene])).        
+00025b00: 2020 2020 6966 2073 656c 662e 7665 7262      if self.verb
+00025b10: 6f73 653a 0a20 2020 2020 2020 2020 2020  ose:.           
+00025b20: 2020 2020 2069 6620 7365 6c66 2e73 656d       if self.sem
+00025b30: 616e 7469 635f 7265 7061 6972 203e 2030  antic_repair > 0
+00025b40: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00025b50: 2020 2020 2020 7072 696e 7428 2753 7563        print('Suc
+00025b60: 6365 7373 6675 6c20 5265 7061 6972 272c  cessful Repair',
+00025b70: 2073 656c 662e 7375 6363 6573 7366 756c   self.successful
+00025b80: 5f72 6570 6169 7220 2f20 2873 656c 662e  _repair / (self.
+00025b90: 7375 6363 6573 7366 756c 5f72 6570 6169  successful_repai
+00025ba0: 7220 2b20 7365 6c66 2e66 6169 6c65 645f  r + self.failed_
+00025bb0: 7265 7061 6972 2929 0a20 2020 2020 2020  repair)).       
+00025bc0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00025bd0: 2e62 6173 6963 5f70 7269 6d69 7469 7665  .basic_primitive
+00025be0: 7320 213d 2027 4d4c 273a 0a20 2020 2020  s != 'ML':.     
+00025bf0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00025c00: 6620 7365 6c66 2e61 6374 6976 655f 6765  f self.active_ge
+00025c10: 6e65 5f6e 756d 203d 3d20 303a 0a20 2020  ne_num == 0:.   
+00025c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025c30: 2020 2020 2070 7269 6e74 2827 556e 6971       print('Uniq
+00025c40: 7565 2048 6173 6827 2c20 5b6c 656e 286e  ue Hash', [len(n
+00025c50: 702e 756e 6971 7565 285b 6f2e 6861 7368  p.unique([o.hash
+00025c60: 5f72 6573 756c 745b 695d 2066 6f72 206f  _result[i] for o
+00025c70: 2069 6e20 6f66 6673 7072 696e 675d 2929   in offspring]))
+00025c80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025ca0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00025cb0: 6f72 2069 2069 6e20 7261 6e67 6528 7365  or i in range(se
+00025cc0: 6c66 2e67 656e 655f 6e75 6d29 5d29 0a20  lf.gene_num)]). 
 00025cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025ce0: 2073 656c 662e 6d61 705f 656c 6974 655f   self.map_elite_
-00025cf0: 7061 7261 6d65 7465 722e 7570 6461 7465  parameter.update
-00025d00: 2870 6172 616d 6574 6572 7329 0a20 2020  (parameters).   
-00025d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025d20: 2069 6620 6c65 6e28 656c 6974 655f 6d61   if len(elite_ma
-00025d30: 7029 203e 2030 3a0a 2020 2020 2020 2020  p) > 0:.        
-00025d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025d50: 656c 6974 655f 6d61 7073 2e61 7070 656e  elite_maps.appen
-00025d60: 6428 7365 6c4d 4150 456c 6974 6573 2870  d(selMAPElites(p
-00025d70: 6f70 756c 6174 696f 6e2c 2065 6c69 7465  opulation, elite
-00025d80: 5f6d 6170 5b69 645d 2c20 7365 6c66 2e6d  _map[id], self.m
-00025d90: 6170 5f65 6c69 7465 5f70 6172 616d 6574  ap_elite_paramet
-00025da0: 6572 2929 0a20 2020 2020 2020 2020 2020  er)).           
-00025db0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00025dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025dd0: 2020 2020 2020 2065 6c69 7465 5f6d 6170         elite_map
-00025de0: 732e 6170 7065 6e64 2873 656c 4d41 5045  s.append(selMAPE
-00025df0: 6c69 7465 7328 706f 7075 6c61 7469 6f6e  lites(population
-00025e00: 2c20 7b7d 2c20 7365 6c66 2e6d 6170 5f65  , {}, self.map_e
-00025e10: 6c69 7465 5f70 6172 616d 6574 6572 2929  lite_parameter))
-00025e20: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-00025e30: 6620 7365 6c66 2e6d 6170 5f65 6c69 7465  f self.map_elite
-00025e40: 5f70 6172 616d 6574 6572 5b27 7479 7065  _parameter['type
-00025e50: 275d 203d 3d20 2743 6c75 7374 6572 273a  '] == 'Cluster':
-00025e60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00025e70: 2065 6c69 7465 5f6d 6170 2c20 706f 705f   elite_map, pop_
-00025e80: 706f 6f6c 203d 2073 656c 4d41 5045 6c69  pool = selMAPEli
-00025e90: 7465 436c 7573 7465 7269 6e67 2870 6f70  teClustering(pop
-00025ea0: 756c 6174 696f 6e2c 2070 6f70 5f70 6f6f  ulation, pop_poo
-00025eb0: 6c2c 2073 656c 662e 6d61 705f 656c 6974  l, self.map_elit
-00025ec0: 655f 7061 7261 6d65 7465 7229 0a20 2020  e_parameter).   
-00025ed0: 2020 2020 2020 2020 2065 6c69 6620 7365           elif se
-00025ee0: 6c66 2e6d 6170 5f65 6c69 7465 5f70 6172  lf.map_elite_par
-00025ef0: 616d 6574 6572 5b27 7479 7065 275d 203d  ameter['type'] =
-00025f00: 3d20 2743 6c75 7374 6572 2d45 7870 6c6f  = 'Cluster-Explo
-00025f10: 6974 6174 696f 6e27 3a0a 2020 2020 2020  itation':.      
-00025f20: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-00025f30: 6170 5f65 6c69 7465 5f70 6172 616d 6574  ap_elite_paramet
-00025f40: 6572 5b27 6669 746e 6573 735f 7261 7469  er['fitness_rati
-00025f50: 6f27 5d20 3d20 6e70 2e63 6c69 7028 302c  o'] = np.clip(0,
-00025f60: 2030 2e30 352c 2030 2e39 3529 0a20 2020   0.05, 0.95).   
-00025f70: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-00025f80: 7465 5f6d 6170 2c20 706f 705f 706f 6f6c  te_map, pop_pool
-00025f90: 203d 2073 656c 4d41 5045 6c69 7465 436c   = selMAPEliteCl
-00025fa0: 7573 7465 7269 6e67 2870 6f70 756c 6174  ustering(populat
-00025fb0: 696f 6e2c 2070 6f70 5f70 6f6f 6c2c 2073  ion, pop_pool, s
-00025fc0: 656c 662e 6d61 705f 656c 6974 655f 7061  elf.map_elite_pa
-00025fd0: 7261 6d65 7465 7229 0a20 2020 2020 2020  rameter).       
-00025fe0: 2020 2020 2065 6c69 6620 7365 6c66 2e6d       elif self.m
-00025ff0: 6170 5f65 6c69 7465 5f70 6172 616d 6574  ap_elite_paramet
-00026000: 6572 5b27 7479 7065 275d 203d 3d20 2743  er['type'] == 'C
-00026010: 6c75 7374 6572 2d45 7870 6c6f 7261 7469  luster-Explorati
-00026020: 6f6e 273a 0a20 2020 2020 2020 2020 2020  on':.           
-00026030: 2020 2020 2073 656c 662e 6d61 705f 656c       self.map_el
-00026040: 6974 655f 7061 7261 6d65 7465 725b 2766  ite_parameter['f
-00026050: 6974 6e65 7373 5f72 6174 696f 275d 203d  itness_ratio'] =
-00026060: 206e 702e 636c 6970 2831 2c20 302e 3035   np.clip(1, 0.05
-00026070: 2c20 302e 3935 290a 2020 2020 2020 2020  , 0.95).        
-00026080: 2020 2020 2020 2020 656c 6974 655f 6d61          elite_ma
-00026090: 702c 2070 6f70 5f70 6f6f 6c20 3d20 7365  p, pop_pool = se
-000260a0: 6c4d 4150 456c 6974 6543 6c75 7374 6572  lMAPEliteCluster
-000260b0: 696e 6728 706f 7075 6c61 7469 6f6e 2c20  ing(population, 
-000260c0: 706f 705f 706f 6f6c 2c20 7365 6c66 2e6d  pop_pool, self.m
-000260d0: 6170 5f65 6c69 7465 5f70 6172 616d 6574  ap_elite_paramet
-000260e0: 6572 290a 2020 2020 2020 2020 2020 2020  er).            
-000260f0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00026100: 2020 2020 2020 7261 6973 6520 4578 6365        raise Exce
-00026110: 7074 696f 6e0a 2020 2020 2020 2020 2020  ption.          
-00026120: 2020 6966 2073 656c 662e 656e 7365 6d62    if self.ensemb
-00026130: 6c65 5f73 656c 6563 7469 6f6e 203d 3d20  le_selection == 
-00026140: 274d 4150 2d45 6c69 7465 273a 0a20 2020  'MAP-Elite':.   
-00026150: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00026160: 662e 686f 6620 3d20 6c69 7374 2865 6c69  f.hof = list(eli
-00026170: 7465 5f6d 6170 2e76 616c 7565 7328 2929  te_map.values())
-00026180: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00026190: 7365 6c66 2e65 6e73 656d 626c 655f 7365  self.ensemble_se
-000261a0: 6c65 6374 696f 6e20 3d3d 2027 4861 6c66  lection == 'Half
-000261b0: 2d4d 4150 2d45 6c69 7465 273a 0a20 2020  -MAP-Elite':.   
-000261c0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-000261d0: 662e 686f 6620 3d20 6c69 7374 2873 6f72  f.hof = list(sor
-000261e0: 7465 6428 656c 6974 655f 6d61 702e 7661  ted(elite_map.va
-000261f0: 6c75 6573 2829 2c20 6b65 793d 6c61 6d62  lues(), key=lamb
-00026200: 6461 2078 3a20 782e 6669 746e 6573 732e  da x: x.fitness.
-00026210: 7776 616c 7565 735b 305d 2c20 7265 7665  wvalues[0], reve
-00026220: 7273 653d 5472 7565 2929 205c 0a20 2020  rse=True)) \.   
-00026230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026240: 205b 3a6c 656e 2865 6c69 7465 5f6d 6170   [:len(elite_map
-00026250: 2920 2f2f 2032 5d0a 2020 2020 2020 2020  ) // 2].        
-00026260: 2020 2020 6966 2073 656c 662e 7061 7261      if self.para
-00026270: 6d2e 6765 7428 2772 6563 6f72 645f 7472  m.get('record_tr
-00026280: 6169 6e69 6e67 5f64 6174 6127 2c20 4661  aining_data', Fa
-00026290: 6c73 6529 3a0a 2020 2020 2020 2020 2020  lse):.          
-000262a0: 2020 2020 2020 7365 6c66 2e65 6c69 7465        self.elite
-000262b0: 5f67 7269 645f 6176 675f 6469 7665 7273  _grid_avg_divers
-000262c0: 6974 795f 6869 7374 6f72 792e 6170 7065  ity_history.appe
-000262d0: 6e64 2873 656c 662e 6469 7665 7273 6974  nd(self.diversit
-000262e0: 795f 6361 6c63 756c 6174 696f 6e28 656c  y_calculation(el
-000262f0: 6974 655f 6d61 702e 7661 6c75 6573 2829  ite_map.values()
-00026300: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
-00026310: 2020 2073 656c 662e 656c 6974 655f 6772     self.elite_gr
-00026320: 6964 5f61 7667 5f66 6974 6e65 7373 5f68  id_avg_fitness_h
-00026330: 6973 746f 7279 2e61 7070 656e 6428 0a20  istory.append(. 
-00026340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026350: 2020 206e 702e 6d65 616e 285b 696e 642e     np.mean([ind.
-00026360: 6669 746e 6573 732e 7776 616c 7565 735b  fitness.wvalues[
-00026370: 305d 2066 6f72 2069 6e64 2069 6e20 656c  0] for ind in el
-00026380: 6974 655f 6d61 702e 7661 6c75 6573 2829  ite_map.values()
-00026390: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
-000263a0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-000263b0: 2020 2020 2069 6620 7365 6c66 2e63 7572       if self.cur
-000263c0: 7265 6e74 5f67 656e 203d 3d20 7365 6c66  rent_gen == self
-000263d0: 2e6e 5f67 656e 3a0a 2020 2020 2020 2020  .n_gen:.        
-000263e0: 2020 2020 2020 2020 2020 2020 6461 7461              data
-000263f0: 203d 206e 702e 7a65 726f 7328 2873 656c   = np.zeros((sel
-00026400: 662e 6d61 705f 656c 6974 655f 7061 7261  f.map_elite_para
-00026410: 6d65 7465 725b 276d 6170 5f73 697a 6527  meter['map_size'
-00026420: 5d2c 2073 656c 662e 6d61 705f 656c 6974  ], self.map_elit
-00026430: 655f 7061 7261 6d65 7465 725b 276d 6170  e_parameter['map
-00026440: 5f73 697a 6527 5d29 290a 2020 2020 2020  _size'])).      
-00026450: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00026460: 7220 6b2c 2076 2069 6e20 656c 6974 655f  r k, v in elite_
-00026470: 6d61 702e 6974 656d 7328 293a 0a20 2020  map.items():.   
-00026480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026490: 2020 2020 2064 6174 615b 286b 5b30 5d20       data[(k[0] 
-000264a0: 2d20 312c 206b 5b31 5d20 2d20 3129 5d20  - 1, k[1] - 1)] 
-000264b0: 3d20 762e 6669 746e 6573 732e 7776 616c  = v.fitness.wval
-000264c0: 7565 735b 305d 0a20 2020 2020 2020 2020  ues[0].         
-000264d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000264e0: 6669 6e61 6c5f 656c 6974 655f 6772 6964  final_elite_grid
-000264f0: 203d 2064 6174 612e 746f 6c69 7374 2829   = data.tolist()
-00026500: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-00026510: 2e65 6e73 656d 626c 655f 7365 6c65 6374  .ensemble_select
-00026520: 696f 6e20 3d3d 2027 4d61 7841 6e67 6c65  ion == 'MaxAngle
-00026530: 5365 6c65 6374 696f 6e27 3a0a 2020 2020  Selection':.    
-00026540: 2020 2020 2020 2020 7365 6c66 2e68 6f66          self.hof
-00026550: 203d 2073 656c 4d61 7841 6e67 6c65 5365   = selMaxAngleSe
-00026560: 6c65 6374 696f 6e28 706f 7075 6c61 7469  lection(populati
-00026570: 6f6e 202b 206c 6973 7428 7365 6c66 2e68  on + list(self.h
-00026580: 6f66 292c 2073 656c 662e 656e 7365 6d62  of), self.ensemb
-00026590: 6c65 5f73 697a 652c 2073 656c 662e 792c  le_size, self.y,
-000265a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025ce0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00025cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025d00: 2070 7269 6e74 2827 556e 6971 7565 2048   print('Unique H
+00025d10: 6173 6827 2c20 5b6c 656e 286e 702e 756e  ash', [len(np.un
+00025d20: 6971 7565 285b 6f2e 6861 7368 5f72 6573  ique([o.hash_res
+00025d30: 756c 745b 695d 2066 6f72 206f 2069 6e20  ult[i] for o in 
+00025d40: 6f66 6673 7072 696e 675d 2929 0a20 2020  offspring])).   
+00025d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025d70: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+00025d80: 2069 6e20 7261 6e67 6528 7365 6c66 2e61   in range(self.a
+00025d90: 6374 6976 655f 6765 6e65 5f6e 756d 295d  ctive_gene_num)]
+00025da0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00025db0: 2020 6966 2073 656c 662e 6261 7365 5f6c    if self.base_l
+00025dc0: 6561 726e 6572 203d 3d20 2741 6461 7074  earner == 'Adapt
+00025dd0: 6976 654c 6173 736f 273a 0a20 2020 2020  iveLasso':.     
+00025de0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00025df0: 6173 736f 5f70 6172 616d 6574 6572 203d  asso_parameter =
+00025e00: 205b 6f2e 7061 7261 6d65 7465 7273 5b27   [o.parameters['
+00025e10: 4c61 7373 6f27 5d20 666f 7220 6f20 696e  Lasso'] for o in
+00025e20: 206f 6666 7370 7269 6e67 5d0a 2020 2020   offspring].    
+00025e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025e40: 7072 696e 7428 2741 7665 7261 6765 204c  print('Average L
+00025e50: 6173 736f 272c 206e 702e 6d65 616e 286c  asso', np.mean(l
+00025e60: 6173 736f 5f70 6172 616d 6574 6572 292c  asso_parameter),
+00025e70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025e80: 2020 2020 2020 2020 2020 206e 702e 6d61             np.ma
+00025e90: 7828 6c61 7373 6f5f 7061 7261 6d65 7465  x(lasso_paramete
+00025ea0: 7229 2c20 6e70 2e6d 696e 286c 6173 736f  r), np.min(lasso
+00025eb0: 5f70 6172 616d 6574 6572 2929 0a20 2020  _parameter)).   
+00025ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025ed0: 206e 6f6e 5f7a 6572 6f5f 6665 6174 7572   non_zero_featur
+00025ee0: 6573 203d 205b 6e70 2e73 756d 286f 2e63  es = [np.sum(o.c
+00025ef0: 6f65 6620 213d 2030 2920 666f 7220 6f20  oef != 0) for o 
+00025f00: 696e 206f 6666 7370 7269 6e67 5d0a 2020  in offspring].  
+00025f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025f20: 2020 7072 696e 7428 2741 7665 7261 6765    print('Average
+00025f30: 2053 656c 6563 7465 6420 4665 6174 7572   Selected Featur
+00025f40: 6573 272c 206e 702e 6d65 616e 286e 6f6e  es', np.mean(non
+00025f50: 5f7a 6572 6f5f 6665 6174 7572 6573 292c  _zero_features),
+00025f60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025f70: 2020 2020 2020 2020 2020 206e 702e 6d61             np.ma
+00025f80: 7828 6e6f 6e5f 7a65 726f 5f66 6561 7475  x(non_zero_featu
+00025f90: 7265 7329 2c20 6e70 2e6d 696e 286e 6f6e  res), np.min(non
+00025fa0: 5f7a 6572 6f5f 6665 6174 7572 6573 2929  _zero_features))
+00025fb0: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00025fc0: 2073 656c 662e 7374 6167 655f 666c 6167   self.stage_flag
+00025fd0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00025fe0: 2020 7072 696e 7428 2753 746f 7020 484f    print('Stop HO
+00025ff0: 4620 7570 6461 7469 6e67 2729 0a0a 2020  F updating')..  
+00026000: 2020 2020 2020 2020 2020 6966 2027 676c            if 'gl
+00026010: 6f62 616c 2720 696e 2073 656c 662e 6d75  obal' in self.mu
+00026020: 7461 7469 6f6e 5f73 6368 656d 6520 6f72  tation_scheme or
+00026030: 2027 6578 7472 656d 6527 2069 6e20 7365   'extreme' in se
+00026040: 6c66 2e6d 7574 6174 696f 6e5f 7363 6865  lf.mutation_sche
+00026050: 6d65 3a0a 2020 2020 2020 2020 2020 2020  me:.            
+00026060: 2020 2020 7365 6c66 2e63 6f6e 7374 7275      self.constru
+00026070: 6374 5f67 6c6f 6261 6c5f 6665 6174 7572  ct_global_featur
+00026080: 655f 706f 6f6c 2870 6f70 756c 6174 696f  e_pool(populatio
+00026090: 6e29 0a20 2020 2020 2020 2020 2020 2073  n).            s
+000260a0: 656c 662e 6170 7065 6e64 5f65 7661 6c75  elf.append_evalu
+000260b0: 6174 6564 5f66 6561 7475 7265 7328 6f66  ated_features(of
+000260c0: 6673 7072 696e 6729 0a0a 2020 2020 2020  fspring)..      
+000260d0: 2020 2020 2020 6265 7374 5f66 6974 6e65        best_fitne
+000260e0: 7373 203d 206e 702e 6d61 7828 5b69 6e64  ss = np.max([ind
+000260f0: 2e66 6974 6e65 7373 2e77 7661 6c75 6573  .fitness.wvalues
+00026100: 5b30 5d20 666f 7220 696e 6420 696e 206f  [0] for ind in o
+00026110: 6666 7370 7269 6e67 5d29 0a20 2020 2020  ffspring]).     
+00026120: 2020 2020 2020 2069 6620 7365 6c66 2e70         if self.p
+00026130: 6172 616d 2e67 6574 2827 7265 636f 7264  aram.get('record
+00026140: 5f74 7261 696e 696e 675f 6461 7461 272c  _training_data',
+00026150: 2046 616c 7365 293a 0a20 2020 2020 2020   False):.       
+00026160: 2020 2020 2020 2020 2073 656c 662e 6265           self.be
+00026170: 7374 5f66 6974 6e65 7373 5f68 6973 746f  st_fitness_histo
+00026180: 7279 2e61 7070 656e 6428 6265 7374 5f66  ry.append(best_f
+00026190: 6974 6e65 7373 290a 2020 2020 2020 2020  itness).        
+000261a0: 2020 2020 6966 2073 656c 662e 6469 7665      if self.dive
+000261b0: 7273 6974 795f 7365 6172 6368 2021 3d20  rsity_search != 
+000261c0: 274e 6f6e 6527 3a0a 2020 2020 2020 2020  'None':.        
+000261d0: 2020 2020 2020 2020 7365 6c66 2e64 6976          self.div
+000261e0: 6572 7369 7479 5f61 7373 6967 6e6d 656e  ersity_assignmen
+000261f0: 7428 6f66 6673 7072 696e 6729 0a0a 2020  t(offspring)..  
+00026200: 2020 2020 2020 2020 2020 2320 6d75 6c74            # mult
+00026210: 696f 626a 6563 7469 7665 2047 5020 6261  iobjective GP ba
+00026220: 7365 6420 6f6e 2066 6974 6e65 7373 2d73  sed on fitness-s
+00026230: 697a 650a 2020 2020 2020 2020 2020 2020  ize.            
+00026240: 6966 2073 656c 662e 7365 6c65 6374 203d  if self.select =
+00026250: 3d20 2741 7574 6f2d 4d43 5453 273a 0a20  = 'Auto-MCTS':. 
+00026260: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00026270: 6f72 2069 6e64 2069 6e20 6f66 6673 7072  or ind in offspr
+00026280: 696e 6720 2b20 6e73 6761 5f61 7263 6869  ing + nsga_archi
+00026290: 7665 202b 2061 6670 5f61 7263 6869 7665  ve + afp_archive
+000262a0: 202b 2062 6573 745f 6172 6368 6976 653a   + best_archive:
+000262b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000262c0: 2020 2020 2073 6574 6174 7472 2869 6e64       setattr(ind
+000262d0: 2c20 276f 7269 6769 6e61 6c5f 6669 746e  , 'original_fitn
+000262e0: 6573 7327 2c20 696e 642e 6669 746e 6573  ess', ind.fitnes
+000262f0: 732e 7661 6c75 6573 290a 2020 2020 2020  s.values).      
+00026300: 2020 2020 2020 2020 2020 2020 2020 696e                in
+00026310: 642e 6669 746e 6573 732e 7765 6967 6874  d.fitness.weight
+00026320: 7320 3d20 282d 312c 202d 3129 0a20 2020  s = (-1, -1).   
+00026330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026340: 2069 6e64 2e66 6974 6e65 7373 2e76 616c   ind.fitness.val
+00026350: 7565 7320 3d20 5b69 6e64 2e66 6974 6e65  ues = [ind.fitne
+00026360: 7373 2e76 616c 7565 735b 305d 2c20 7375  ss.values[0], su
+00026370: 6d28 5b6c 656e 2878 2920 666f 7220 7820  m([len(x) for x 
+00026380: 696e 2069 6e64 2e67 656e 655d 295d 0a20  in ind.gene])]. 
+00026390: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+000263a0: 7367 615f 6172 6368 6976 6520 3d20 7365  sga_archive = se
+000263b0: 6c4e 5347 4132 286f 6666 7370 7269 6e67  lNSGA2(offspring
+000263c0: 202b 206e 7367 615f 6172 6368 6976 652c   + nsga_archive,
+000263d0: 206c 656e 2870 6f70 756c 6174 696f 6e29   len(population)
+000263e0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000263f0: 2020 6265 7374 5f61 7263 6869 7665 203d    best_archive =
+00026400: 2073 656c 4265 7374 286f 6666 7370 7269   selBest(offspri
+00026410: 6e67 202b 2062 6573 745f 6172 6368 6976  ng + best_archiv
+00026420: 652c 206c 656e 2870 6f70 756c 6174 696f  e, len(populatio
+00026430: 6e29 290a 2020 2020 2020 2020 2020 2020  n)).            
+00026440: 2020 2020 666f 7220 696e 6420 696e 206f      for ind in o
+00026450: 6666 7370 7269 6e67 3a0a 2020 2020 2020  ffspring:.      
+00026460: 2020 2020 2020 2020 2020 2020 2020 696e                in
+00026470: 642e 6167 6520 3d20 300a 2020 2020 2020  d.age = 0.      
+00026480: 2020 2020 2020 2020 2020 2020 2020 696e                in
+00026490: 642e 6669 746e 6573 732e 7661 6c75 6573  d.fitness.values
+000264a0: 203d 205b 696e 642e 6669 746e 6573 732e   = [ind.fitness.
+000264b0: 7661 6c75 6573 5b30 5d2c 2069 6e64 2e61  values[0], ind.a
+000264c0: 6765 5d0a 2020 2020 2020 2020 2020 2020  ge].            
+000264d0: 2020 2020 2320 6d75 6c74 696f 626a 6563      # multiobjec
+000264e0: 7469 7665 2047 5020 6261 7365 6420 6f6e  tive GP based on
+000264f0: 2061 6765 2d66 6974 6e65 7373 0a20 2020   age-fitness.   
+00026500: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00026510: 2069 6e64 2069 6e20 6e73 6761 5f61 7263   ind in nsga_arc
+00026520: 6869 7665 202b 2061 6670 5f61 7263 6869  hive + afp_archi
+00026530: 7665 202b 2062 6573 745f 6172 6368 6976  ve + best_archiv
+00026540: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00026550: 2020 2020 2020 2069 6620 6861 7361 7474         if hasatt
+00026560: 7228 696e 642c 2027 6167 6527 293a 0a20  r(ind, 'age'):. 
+00026570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026580: 2020 2020 2020 2069 6e64 2e61 6765 202b         ind.age +
+00026590: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
+000265a0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
 000265b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000265c0: 2020 2020 2020 2020 2020 2020 2075 6e69               uni
-000265d0: 7175 653d 5472 7565 290a 2020 2020 2020  que=True).      
-000265e0: 2020 6966 2073 656c 662e 656e 7365 6d62    if self.ensemb
-000265f0: 6c65 5f73 656c 6563 7469 6f6e 203d 3d20  le_selection == 
-00026600: 2741 6e67 6c65 4472 6976 656e 5365 6c65  'AngleDrivenSele
-00026610: 6374 696f 6e27 3a0a 2020 2020 2020 2020  ction':.        
-00026620: 2020 2020 7365 6c66 2e68 6f66 203d 2073      self.hof = s
-00026630: 656c 416e 676c 6544 7269 7665 6e53 656c  elAngleDrivenSel
-00026640: 6563 7469 6f6e 2870 6f70 756c 6174 696f  ection(populatio
-00026650: 6e20 2b20 6c69 7374 2873 656c 662e 686f  n + list(self.ho
-00026660: 6629 2c20 7365 6c66 2e65 6e73 656d 626c  f), self.ensembl
-00026670: 655f 7369 7a65 2c20 7365 6c66 2e79 2c0a  e_size, self.y,.
-00026680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000266a0: 2020 2020 2020 2020 2020 2020 2020 2075                 u
-000266b0: 6e69 7175 653d 5472 7565 290a 2020 2020  nique=True).    
-000266c0: 2020 2020 7265 7475 726e 2065 6c69 7465      return elite
-000266d0: 5f6d 6170 2c20 706f 705f 706f 6f6c 0a0a  _map, pop_pool..
-000266e0: 2020 2020 6465 6620 7361 6d70 6c65 5f6d      def sample_m
-000266f0: 6f64 656c 5f6e 616d 6528 7365 6c66 2c20  odel_name(self, 
-00026700: 7061 7265 6e74 293a 0a20 2020 2020 2020  parent):.       
-00026710: 206d 6f64 656c 7320 3d20 7365 6c66 2e62   models = self.b
-00026720: 6173 655f 6d6f 6465 6c5f 6c69 7374 2e73  ase_model_list.s
-00026730: 706c 6974 2827 2c27 290a 2020 2020 2020  plit(',').      
-00026740: 2020 6d6f 6465 6c20 3d20 7261 6e64 6f6d    model = random
-00026750: 2e63 686f 6963 6528 6d6f 6465 6c73 290a  .choice(models).
-00026760: 2020 2020 2020 2020 7061 7265 6e74 203d          parent =
-00026770: 206c 6973 7428 6669 6c74 6572 286c 616d   list(filter(lam
-00026780: 6264 6120 783a 2078 2e62 6173 655f 6d6f  bda x: x.base_mo
-00026790: 6465 6c20 3d3d 206d 6f64 656c 2c20 7061  del == model, pa
-000267a0: 7265 6e74 2929 0a20 2020 2020 2020 2072  rent)).        r
-000267b0: 6574 7572 6e20 7061 7265 6e74 0a0a 2020  eturn parent..  
-000267c0: 2020 6465 6620 7375 7276 6976 616c 5f73    def survival_s
-000267d0: 656c 6563 7469 6f6e 2873 656c 662c 2067  election(self, g
-000267e0: 656e 2c20 706f 7075 6c61 7469 6f6e 2c20  en, population, 
-000267f0: 6f66 6673 7072 696e 6729 3a0a 2020 2020  offspring):.    
-00026800: 2020 2020 2320 5573 696e 6720 4e53 4741      # Using NSGA
-00026810: 2d49 4920 6f72 206f 7468 6572 206f 7065  -II or other ope
-00026820: 7261 746f 7273 2074 6f20 7365 6c65 6374  rators to select
-00026830: 2070 6172 656e 7420 696e 6469 7669 6475   parent individu
-00026840: 616c 730a 2020 2020 2020 2020 6966 2073  als.        if s
-00026850: 656c 662e 656e 7669 726f 6e6d 656e 7461  elf.environmenta
-00026860: 6c5f 7365 6c65 6374 696f 6e20 696e 205b  l_selection in [
-00026870: 274e 5347 4132 275d 2061 6e64 2073 656c  'NSGA2'] and sel
-00026880: 662e 6261 7365 5f6c 6561 726e 6572 203d  f.base_learner =
-00026890: 3d20 2752 4454 7e4c 6967 6874 4742 4d2d  = 'RDT~LightGBM-
-000268a0: 5374 756d 7027 3a0a 2020 2020 2020 2020  Stump':.        
-000268b0: 2020 2020 706f 7075 6c61 7469 6f6e 5b3a      population[:
-000268c0: 5d20 3d20 7365 6c4e 5347 4132 286f 6666  ] = selNSGA2(off
-000268d0: 7370 7269 6e67 202b 2070 6f70 756c 6174  spring + populat
-000268e0: 696f 6e2c 206c 656e 2870 6f70 756c 6174  ion, len(populat
-000268f0: 696f 6e29 290a 2020 2020 2020 2020 2020  ion)).          
-00026900: 2020 7365 6c66 2e68 6f66 203d 2070 6f70    self.hof = pop
-00026910: 756c 6174 696f 6e0a 2020 2020 2020 2020  ulation.        
-00026920: 656c 6966 2073 656c 662e 656e 7669 726f  elif self.enviro
-00026930: 6e6d 656e 7461 6c5f 7365 6c65 6374 696f  nmental_selectio
-00026940: 6e20 3d3d 2027 4e53 4741 322d 4d69 7875  n == 'NSGA2-Mixu
-00026950: 7027 3a0a 2020 2020 2020 2020 2020 2020  p':.            
-00026960: 706f 7075 6c61 7469 6f6e 5b3a 5d20 3d20  population[:] = 
-00026970: 7365 6c4e 5347 4132 286f 6666 7370 7269  selNSGA2(offspri
-00026980: 6e67 202b 2070 6f70 756c 6174 696f 6e2c  ng + population,
-00026990: 206c 656e 2870 6f70 756c 6174 696f 6e29   len(population)
-000269a0: 290a 2020 2020 2020 2020 656c 6966 2073  ).        elif s
-000269b0: 656c 662e 656e 7669 726f 6e6d 656e 7461  elf.environmenta
-000269c0: 6c5f 7365 6c65 6374 696f 6e20 213d 204e  l_selection != N
-000269d0: 6f6e 6520 616e 6420 274e 5347 4132 2d31  one and 'NSGA2-1
-000269e0: 3030 2720 696e 2073 656c 662e 656e 7669  00' in self.envi
-000269f0: 726f 6e6d 656e 7461 6c5f 7365 6c65 6374  ronmental_select
-00026a00: 696f 6e3a 0a20 2020 2020 2020 2020 2020  ion:.           
-00026a10: 2066 6f72 2069 6e64 2069 6e20 6f66 6673   for ind in offs
-00026a20: 7072 696e 6720 2b20 706f 7075 6c61 7469  pring + populati
-00026a30: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
-00026a40: 2020 2020 7365 7461 7474 7228 696e 642c      setattr(ind,
-00026a50: 2027 6f72 6967 696e 616c 5f66 6974 6e65   'original_fitne
-00026a60: 7373 272c 2069 6e64 2e66 6974 6e65 7373  ss', ind.fitness
-00026a70: 2e76 616c 7565 7329 0a20 2020 2020 2020  .values).       
-00026a80: 2020 2020 2020 2020 2066 6974 6e65 7373           fitness
-00026a90: 203d 2069 6e64 2e63 6173 655f 7661 6c75   = ind.case_valu
-00026aa0: 6573 2040 2073 656c 662e 7261 6e64 6f6d  es @ self.random
-00026ab0: 5f6f 626a 6563 7469 7665 730a 2020 2020  _objectives.    
-00026ac0: 2020 2020 2020 2020 2020 2020 696e 642e              ind.
-00026ad0: 6669 746e 6573 732e 7765 6967 6874 7320  fitness.weights 
-00026ae0: 3d20 282d 312c 2920 2a20 6c65 6e28 7365  = (-1,) * len(se
-00026af0: 6c66 2e72 616e 646f 6d5f 6f62 6a65 6374  lf.random_object
-00026b00: 6976 6573 290a 2020 2020 2020 2020 2020  ives).          
-00026b10: 2020 2020 2020 696e 642e 6669 746e 6573        ind.fitnes
-00026b20: 732e 7661 6c75 6573 203d 206c 6973 7428  s.values = list(
-00026b30: 6669 746e 6573 7329 0a20 2020 2020 2020  fitness).       
-00026b40: 2020 2020 2070 6f70 756c 6174 696f 6e5b       population[
-00026b50: 3a5d 203d 2073 656c 4e53 4741 3228 6f66  :] = selNSGA2(of
-00026b60: 6673 7072 696e 6720 2b20 706f 7075 6c61  fspring + popula
-00026b70: 7469 6f6e 2c20 6c65 6e28 706f 7075 6c61  tion, len(popula
-00026b80: 7469 6f6e 2929 0a20 2020 2020 2020 2020  tion)).         
-00026b90: 2020 2066 6f72 2069 6e64 2069 6e20 706f     for ind in po
-00026ba0: 7075 6c61 7469 6f6e 3a0a 2020 2020 2020  pulation:.      
-00026bb0: 2020 2020 2020 2020 2020 696e 642e 6669            ind.fi
-00026bc0: 746e 6573 732e 7765 6967 6874 7320 3d20  tness.weights = 
-00026bd0: 282d 312c 290a 2020 2020 2020 2020 2020  (-1,).          
-00026be0: 2020 2020 2020 696e 642e 6669 746e 6573        ind.fitnes
-00026bf0: 732e 7661 6c75 6573 203d 2067 6574 6174  s.values = getat
-00026c00: 7472 2869 6e64 2c20 276f 7269 6769 6e61  tr(ind, 'origina
-00026c10: 6c5f 6669 746e 6573 7327 290a 2020 2020  l_fitness').    
-00026c20: 2020 2020 2020 2020 7365 6c66 2e68 6f66          self.hof
-00026c30: 203d 2070 6f70 756c 6174 696f 6e0a 2020   = population.  
-00026c40: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
-00026c50: 656e 7669 726f 6e6d 656e 7461 6c5f 7365  environmental_se
-00026c60: 6c65 6374 696f 6e20 696e 205b 274e 5347  lection in ['NSG
-00026c70: 4132 2d43 5627 2c20 274e 5347 4132 2d43  A2-CV', 'NSGA2-C
-00026c80: 5632 275d 3a0a 2020 2020 2020 2020 2020  V2']:.          
-00026c90: 2020 666f 7220 696e 6420 696e 206f 6666    for ind in off
-00026ca0: 7370 7269 6e67 202b 2070 6f70 756c 6174  spring + populat
-00026cb0: 696f 6e3a 0a20 2020 2020 2020 2020 2020  ion:.           
-00026cc0: 2020 2020 2073 6574 6174 7472 2869 6e64       setattr(ind
-00026cd0: 2c20 276f 7269 6769 6e61 6c5f 6669 746e  , 'original_fitn
-00026ce0: 6573 7327 2c20 696e 642e 6669 746e 6573  ess', ind.fitnes
-00026cf0: 732e 7661 6c75 6573 290a 2020 2020 2020  s.values).      
-00026d00: 2020 2020 2020 2020 2020 6669 746e 6573            fitnes
-00026d10: 7320 3d20 696e 642e 6361 7365 5f76 616c  s = ind.case_val
-00026d20: 7565 730a 2020 2020 2020 2020 2020 2020  ues.            
-00026d30: 2020 2020 6966 2073 656c 662e 656e 7669      if self.envi
-00026d40: 726f 6e6d 656e 7461 6c5f 7365 6c65 6374  ronmental_select
-00026d50: 696f 6e20 3d3d 2027 4e53 4741 322d 4356  ion == 'NSGA2-CV
-00026d60: 3227 3a0a 2020 2020 2020 2020 2020 2020  2':.            
-00026d70: 2020 2020 2020 2020 6669 746e 6573 7320          fitness 
-00026d80: 3d20 6669 746e 6573 7320 4020 6e70 2e72  = fitness @ np.r
-00026d90: 616e 646f 6d2e 756e 6966 6f72 6d28 302c  andom.uniform(0,
-00026da0: 2031 2c20 7369 7a65 3d28 352c 2032 2929   1, size=(5, 2))
-00026db0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00026dc0: 2069 6e64 2e66 6974 6e65 7373 2e77 6569   ind.fitness.wei
-00026dd0: 6768 7473 203d 2028 2d31 2c29 202a 206c  ghts = (-1,) * l
-00026de0: 656e 2866 6974 6e65 7373 290a 2020 2020  en(fitness).    
-00026df0: 2020 2020 2020 2020 2020 2020 696e 642e              ind.
-00026e00: 6669 746e 6573 732e 7661 6c75 6573 203d  fitness.values =
-00026e10: 206c 6973 7428 6669 746e 6573 7329 0a20   list(fitness). 
-00026e20: 2020 2020 2020 2020 2020 2070 6f70 756c             popul
-00026e30: 6174 696f 6e5b 3a5d 203d 2073 656c 4e53  ation[:] = selNS
-00026e40: 4741 3228 6f66 6673 7072 696e 6720 2b20  GA2(offspring + 
-00026e50: 706f 7075 6c61 7469 6f6e 2c20 6c65 6e28  population, len(
-00026e60: 706f 7075 6c61 7469 6f6e 2929 0a20 2020  population)).   
-00026e70: 2020 2020 2020 2020 2066 6f72 2069 6e64           for ind
-00026e80: 2069 6e20 706f 7075 6c61 7469 6f6e 3a0a   in population:.
-00026e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026ea0: 696e 642e 6669 746e 6573 732e 7765 6967  ind.fitness.weig
-00026eb0: 6874 7320 3d20 282d 312c 290a 2020 2020  hts = (-1,).    
-00026ec0: 2020 2020 2020 2020 2020 2020 696e 642e              ind.
-00026ed0: 6669 746e 6573 732e 7661 6c75 6573 203d  fitness.values =
-00026ee0: 2067 6574 6174 7472 2869 6e64 2c20 276f   getattr(ind, 'o
-00026ef0: 7269 6769 6e61 6c5f 6669 746e 6573 7327  riginal_fitness'
-00026f00: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-00026f10: 6c66 2e68 6f66 203d 2070 6f70 756c 6174  lf.hof = populat
-00026f20: 696f 6e0a 2020 2020 2020 2020 656c 6966  ion.        elif
-00026f30: 2073 656c 662e 656e 7669 726f 6e6d 656e   self.environmen
-00026f40: 7461 6c5f 7365 6c65 6374 696f 6e20 696e  tal_selection in
-00026f50: 205b 274e 5347 4132 272c 2027 4e53 4741   ['NSGA2', 'NSGA
-00026f60: 322d 4e6f 726d 616c 697a 6564 272c 2027  2-Normalized', '
-00026f70: 4e53 4741 322d 4265 7374 272c 2027 4e53  NSGA2-Best', 'NS
-00026f80: 4741 322d 4265 7374 2d48 616c 6627 5d3a  GA2-Best-Half']:
-00026f90: 0a20 2020 2020 2020 2020 2020 2023 2074  .            # t
-00026fa0: 776f 206f 626a 6563 7469 7665 733a 0a20  wo objectives:. 
-00026fb0: 2020 2020 2020 2020 2020 2023 2031 2e20             # 1. 
-00026fc0: 6163 6375 7261 6379 0a20 2020 2020 2020  accuracy.       
-00026fd0: 2020 2020 2023 2032 2e20 6e6f 6465 2063       # 2. node c
-00026fe0: 6f75 6e74 0a20 2020 2020 2020 2020 2020  ount.           
-00026ff0: 2069 6620 7365 6c66 2e65 6e76 6972 6f6e   if self.environ
-00027000: 6d65 6e74 616c 5f73 656c 6563 7469 6f6e  mental_selection
-00027010: 203d 3d20 274e 5347 4132 2d42 6573 742d   == 'NSGA2-Best-
-00027020: 4861 6c66 2720 616e 6420 6765 6e20 3c20  Half' and gen < 
-00027030: 2873 656c 662e 6e5f 6765 6e20 2f2f 2032  (self.n_gen // 2
-00027040: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00027050: 2020 2070 6f70 756c 6174 696f 6e5b 3a5d     population[:]
-00027060: 203d 206f 6666 7370 7269 6e67 0a20 2020   = offspring.   
-00027070: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00027080: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00027090: 6566 206b 6e65 655f 706f 696e 745f 6465  ef knee_point_de
-000270a0: 7465 6374 696f 6e28 6672 6f6e 7429 3a0a  tection(front):.
-000270b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000270c0: 2020 2020 7031 203d 206e 702e 6d61 7828      p1 = np.max(
-000270d0: 6672 6f6e 742c 2061 7869 733d 3029 0a20  front, axis=0). 
-000270e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000270f0: 2020 2070 3220 3d20 6e70 2e6d 6178 2866     p2 = np.max(f
-00027100: 726f 6e74 2c20 6178 6973 3d30 290a 2020  ront, axis=0).  
-00027110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027120: 2020 2320 e887 aae5 8aa8 e980 89e6 8ba9    # ............
-00027130: e68b 90e7 82b9 0a20 2020 2020 2020 2020  .......         
-00027140: 2020 2020 2020 2020 2020 2061 6e73 203d             ans =
-00027150: 206d 6178 285b 6920 666f 7220 6920 696e   max([i for i in
-00027160: 2072 616e 6765 286c 656e 2866 726f 6e74   range(len(front
-00027170: 2929 5d2c 0a20 2020 2020 2020 2020 2020  ))],.           
-00027180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027190: 2020 206b 6579 3d6c 616d 6264 6120 693a     key=lambda i:
-000271a0: 206e 6f72 6d28 6e70 2e63 726f 7373 2870   norm(np.cross(p
-000271b0: 3220 2d20 7031 2c20 7031 202d 2066 726f  2 - p1, p1 - fro
-000271c0: 6e74 5b69 5d29 2920 2f20 6e6f 726d 2870  nt[i])) / norm(p
-000271d0: 3220 2d20 7031 2929 0a20 2020 2020 2020  2 - p1)).       
-000271e0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-000271f0: 7572 6e20 616e 730a 0a20 2020 2020 2020  urn ans..       
-00027200: 2020 2020 2020 2020 2061 7667 5f73 697a           avg_siz
-00027210: 6520 3d20 6e70 2e6d 6561 6e28 5b6e 702e  e = np.mean([np.
-00027220: 6172 7261 7928 5b6c 656e 2879 2920 666f  array([len(y) fo
-00027230: 7220 7920 696e 2078 2e67 656e 655d 2920  r y in x.gene]) 
-00027240: 2a20 2878 2e63 6f65 6620 213d 2030 2920  * (x.coef != 0) 
-00027250: 666f 7220 7820 696e 206f 6666 7370 7269  for x in offspri
-00027260: 6e67 202b 2070 6f70 756c 6174 696f 6e5d  ng + population]
-00027270: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00027280: 2020 666f 7220 696e 6420 696e 206f 6666    for ind in off
-00027290: 7370 7269 6e67 202b 2070 6f70 756c 6174  spring + populat
-000272a0: 696f 6e3a 0a20 2020 2020 2020 2020 2020  ion:.           
-000272b0: 2020 2020 2020 2020 2073 6574 6174 7472           setattr
-000272c0: 2869 6e64 2c20 276f 7269 6769 6e61 6c5f  (ind, 'original_
-000272d0: 6669 746e 6573 7327 2c20 696e 642e 6669  fitness', ind.fi
-000272e0: 746e 6573 732e 7661 6c75 6573 290a 2020  tness.values).  
-000272f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027300: 2020 696e 642e 6669 746e 6573 732e 7765    ind.fitness.we
-00027310: 6967 6874 7320 3d20 282d 312c 202d 3129  ights = (-1, -1)
-00027320: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027330: 2020 2020 2069 6e64 5f73 697a 6520 3d20       ind_size = 
-00027340: 6e70 2e6d 6561 6e28 6e70 2e61 7272 6179  np.mean(np.array
-00027350: 285b 6c65 6e28 7929 2066 6f72 2079 2069  ([len(y) for y i
-00027360: 6e20 696e 642e 6765 6e65 5d29 202a 2028  n ind.gene]) * (
-00027370: 696e 642e 636f 6566 2021 3d20 3029 2920  ind.coef != 0)) 
-00027380: 2f20 6176 675f 7369 7a65 0a20 2020 2020  / avg_size.     
-00027390: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000273a0: 6620 7365 6c66 2e65 6e76 6972 6f6e 6d65  f self.environme
-000273b0: 6e74 616c 5f73 656c 6563 7469 6f6e 203d  ntal_selection =
-000273c0: 3d20 274e 5347 4132 2d4e 6f72 6d61 6c69  = 'NSGA2-Normali
-000273d0: 7a65 6427 3a0a 2020 2020 2020 2020 2020  zed':.          
-000273e0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-000273f0: 642e 6669 746e 6573 732e 7661 6c75 6573  d.fitness.values
-00027400: 203d 2028 696e 642e 6669 746e 6573 732e   = (ind.fitness.
-00027410: 7661 6c75 6573 5b30 5d2c 206d 6178 2831  values[0], max(1
-00027420: 2c20 696e 645f 7369 7a65 2929 0a20 2020  , ind_size)).   
-00027430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027440: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00027450: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00027460: 6e64 2e66 6974 6e65 7373 2e76 616c 7565  nd.fitness.value
-00027470: 7320 3d20 2869 6e64 2e66 6974 6e65 7373  s = (ind.fitness
-00027480: 2e76 616c 7565 735b 305d 2c20 696e 645f  .values[0], ind_
-00027490: 7369 7a65 290a 2020 2020 2020 2020 2020  size).          
-000274a0: 2020 2020 2020 706f 7075 6c61 7469 6f6e        population
-000274b0: 5b3a 5d20 3d20 7365 6c4e 5347 4132 286f  [:] = selNSGA2(o
-000274c0: 6666 7370 7269 6e67 202b 2070 6f70 756c  ffspring + popul
-000274d0: 6174 696f 6e2c 206c 656e 2870 6f70 756c  ation, len(popul
-000274e0: 6174 696f 6e29 290a 2020 2020 2020 2020  ation)).        
-000274f0: 2020 2020 2020 2020 6b6e 6565 203d 206b          knee = k
-00027500: 6e65 655f 706f 696e 745f 6465 7465 6374  nee_point_detect
-00027510: 696f 6e28 5b70 2e66 6974 6e65 7373 2e77  ion([p.fitness.w
-00027520: 7661 6c75 6573 2066 6f72 2070 2069 6e20  values for p in 
-00027530: 706f 7075 6c61 7469 6f6e 5d29 0a20 2020  population]).   
-00027540: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00027550: 7365 6c66 2e76 6572 626f 7365 3a0a 2020  self.verbose:.  
-00027560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027570: 2020 6b6e 6565 5f69 6e64 6976 6964 7561    knee_individua
-00027580: 6c20 3d20 706f 7075 6c61 7469 6f6e 5b6b  l = population[k
-00027590: 6e65 655d 0a20 2020 2020 2020 2020 2020  nee].           
-000275a0: 2020 2020 2020 2020 206b 6e65 655f 7369           knee_si
-000275b0: 7a65 203d 206e 702e 7375 6d28 6b6e 6565  ze = np.sum(knee
-000275c0: 5f69 6e64 6976 6964 7561 6c2e 636f 6566  _individual.coef
-000275d0: 2021 3d20 3029 0a20 2020 2020 2020 2020   != 0).         
-000275e0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-000275f0: 2827 4b6e 6565 2053 697a 6527 2c20 6b6e  ('Knee Size', kn
-00027600: 6565 5f73 697a 6529 0a20 2020 2020 2020  ee_size).       
-00027610: 2020 2020 2020 2020 2066 6f72 2069 6e64           for ind
-00027620: 2069 6e20 706f 7075 6c61 7469 6f6e 3a0a   in population:.
-00027630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027640: 2020 2020 696e 642e 6669 746e 6573 732e      ind.fitness.
-00027650: 7765 6967 6874 7320 3d20 282d 312c 290a  weights = (-1,).
-00027660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027670: 2020 2020 696e 642e 6669 746e 6573 732e      ind.fitness.
-00027680: 7661 6c75 6573 203d 2067 6574 6174 7472  values = getattr
-00027690: 2869 6e64 2c20 276f 7269 6769 6e61 6c5f  (ind, 'original_
-000276a0: 6669 746e 6573 7327 290a 2020 2020 2020  fitness').      
-000276b0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-000276c0: 662e 656e 7669 726f 6e6d 656e 7461 6c5f  f.environmental_
-000276d0: 7365 6c65 6374 696f 6e20 213d 2027 4e53  selection != 'NS
-000276e0: 4741 322d 4265 7374 273a 0a20 2020 2020  GA2-Best':.     
-000276f0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00027700: 2053 656c 6563 7420 7468 6520 6b6e 6565   Select the knee
-00027710: 2070 6f69 6e74 2061 7320 7468 6520 6669   point as the fi
-00027720: 6e61 6c20 6d6f 6465 6c0a 2020 2020 2020  nal model.      
-00027730: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00027740: 6c66 2e68 6f66 203d 205b 706f 7075 6c61  lf.hof = [popula
-00027750: 7469 6f6e 5b6b 6e65 655d 5d0a 2020 2020  tion[knee]].    
-00027760: 2020 2020 656c 6966 2073 656c 662e 656e      elif self.en
-00027770: 7669 726f 6e6d 656e 7461 6c5f 7365 6c65  vironmental_sele
-00027780: 6374 696f 6e20 3d3d 2027 4d4f 4541 2f44  ction == 'MOEA/D
-00027790: 273a 0a20 2020 2020 2020 2020 2020 2023  ':.            #
-000277a0: 204d 4f45 412f 4420 7769 7468 2072 616e   MOEA/D with ran
-000277b0: 646f 6d20 6465 636f 6d70 6f73 6974 696f  dom decompositio
-000277c0: 6e0a 2020 2020 2020 2020 2020 2020 6465  n.            de
-000277d0: 6620 7365 6c4d 4f45 4144 2869 6e64 6976  f selMOEAD(indiv
-000277e0: 6964 7561 6c73 2c20 6b29 3a0a 2020 2020  iduals, k):.    
-000277f0: 2020 2020 2020 2020 2020 2020 696e 6473              inds
-00027800: 203d 205b 5d0a 2020 2020 2020 2020 2020   = [].          
-00027810: 2020 2020 2020 7768 696c 6520 5472 7565        while True
-00027820: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00027830: 2020 2020 2020 6966 206c 656e 2869 6e64        if len(ind
-00027840: 7329 203e 3d20 6b3a 0a20 2020 2020 2020  s) >= k:.       
-00027850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027860: 2062 7265 616b 0a20 2020 2020 2020 2020   break.         
-00027870: 2020 2020 2020 2020 2020 2077 6569 6768             weigh
-00027880: 7420 3d20 6e70 2e72 616e 646f 6d2e 756e  t = np.random.un
-00027890: 6966 6f72 6d28 302c 2031 2c20 7369 7a65  iform(0, 1, size
-000278a0: 3d28 6c65 6e28 696e 6469 7669 6475 616c  =(len(individual
-000278b0: 735b 305d 2e63 6173 655f 7661 6c75 6573  s[0].case_values
-000278c0: 2929 290a 2020 2020 2020 2020 2020 2020  ))).            
-000278d0: 2020 2020 2020 2020 6675 6e20 3d20 6c61          fun = la
-000278e0: 6d62 6461 2078 3a20 6e70 2e73 756d 2877  mbda x: np.sum(w
-000278f0: 6569 6768 7420 2a20 6e70 2e61 7272 6179  eight * np.array
-00027900: 2878 2e63 6173 655f 7661 6c75 6573 2929  (x.case_values))
-00027910: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027920: 2020 2020 2069 6e64 203d 2073 6f72 7465       ind = sorte
-00027930: 6428 696e 6469 7669 6475 616c 732c 206b  d(individuals, k
-00027940: 6579 3d6c 616d 6264 6120 783a 2066 6c6f  ey=lambda x: flo
-00027950: 6174 2866 756e 2878 2929 295b 305d 0a20  at(fun(x)))[0]. 
-00027960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027970: 2020 2069 6e64 6976 6964 7561 6c73 2e72     individuals.r
-00027980: 656d 6f76 6528 696e 6429 0a20 2020 2020  emove(ind).     
-00027990: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000279a0: 6e64 732e 6170 7065 6e64 2869 6e64 290a  nds.append(ind).
-000279b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000279c0: 7265 7475 726e 2069 6e64 730a 0a20 2020  return inds..   
-000279d0: 2020 2020 2020 2020 2070 6f70 756c 6174           populat
-000279e0: 696f 6e5b 3a5d 203d 2073 656c 4d4f 4541  ion[:] = selMOEA
-000279f0: 4428 6f66 6673 7072 696e 6720 2b20 706f  D(offspring + po
-00027a00: 7075 6c61 7469 6f6e 2c20 6c65 6e28 706f  pulation, len(po
-00027a10: 7075 6c61 7469 6f6e 2929 0a20 2020 2020  pulation)).     
-00027a20: 2020 2020 2020 2073 656c 662e 686f 6620         self.hof 
-00027a30: 3d20 706f 7075 6c61 7469 6f6e 0a20 2020  = population.   
-00027a40: 2020 2020 2065 6c69 6620 7365 6c66 2e65       elif self.e
-00027a50: 6e76 6972 6f6e 6d65 6e74 616c 5f73 656c  nvironmental_sel
-00027a60: 6563 7469 6f6e 203d 3d20 2742 6573 7427  ection == 'Best'
-00027a70: 3a0a 2020 2020 2020 2020 2020 2020 706f  :.            po
-00027a80: 7075 6c61 7469 6f6e 5b3a 5d20 3d20 7365  pulation[:] = se
-00027a90: 6c42 6573 7428 6f66 6673 7072 696e 6720  lBest(offspring 
-00027aa0: 2b20 706f 7075 6c61 7469 6f6e 2c20 6c65  + population, le
-00027ab0: 6e28 706f 7075 6c61 7469 6f6e 2929 0a20  n(population)). 
-00027ac0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00027ad0: 2020 2020 2020 2020 2070 6f70 756c 6174           populat
-00027ae0: 696f 6e5b 3a5d 203d 206f 6666 7370 7269  ion[:] = offspri
-00027af0: 6e67 0a0a 2020 2020 2320 4074 696d 6569  ng..    # @timei
-00027b00: 740a 2020 2020 6465 6620 706f 7075 6c61  t.    def popula
-00027b10: 7469 6f6e 5f72 6564 7563 7469 6f6e 2873  tion_reduction(s
-00027b20: 656c 662c 2070 6f70 756c 6174 696f 6e29  elf, population)
-00027b30: 3a0a 2020 2020 2020 2020 2320 7265 6475  :.        # redu
-00027b40: 6365 2074 6865 2070 6f70 756c 6174 696f  ce the populatio
-00027b50: 6e20 7369 7a65 2074 6872 6f75 6768 2066  n size through f
-00027b60: 6561 7475 7265 2073 656c 6563 7469 6f6e  eature selection
-00027b70: 0a20 2020 2020 2020 2072 6174 696f 203d  .        ratio =
-00027b80: 2073 656c 662e 7265 6475 6374 696f 6e5f   self.reduction_
-00027b90: 7261 7469 6f0a 2020 2020 2020 2020 6e65  ratio.        ne
-00027ba0: 775f 706f 7075 6c61 7469 6f6e 203d 205b  w_population = [
-00027bb0: 5d0a 2020 2020 2020 2020 2320 7768 696c  ].        # whil
-00027bc0: 6520 6c65 6e28 6e65 775f 706f 7075 6c61  e len(new_popula
-00027bd0: 7469 6f6e 2920 3c20 286c 656e 2870 6f70  tion) < (len(pop
-00027be0: 756c 6174 696f 6e29 202f 2f20 7261 7469  ulation) // rati
-00027bf0: 6f29 3a0a 2020 2020 2020 2020 666f 7220  o):.        for 
-00027c00: 7020 696e 2070 6f70 756c 6174 696f 6e3a  p in population:
-00027c10: 0a20 2020 2020 2020 2020 2020 2023 2069  .            # i
-00027c20: 6e64 7320 3d20 7261 6e64 6f6d 2e73 616d  nds = random.sam
-00027c30: 706c 6528 706f 7075 6c61 7469 6f6e 2c20  ple(population, 
-00027c40: 7261 7469 6f29 0a20 2020 2020 2020 2020  ratio).         
-00027c50: 2020 2069 6e64 7320 3d20 5b70 5d0a 2020     inds = [p].  
-00027c60: 2020 2020 2020 2020 2020 6765 6e65 7320            genes 
-00027c70: 3d20 6c69 7374 2863 6861 696e 2e66 726f  = list(chain.fro
-00027c80: 6d5f 6974 6572 6162 6c65 285b 696e 642e  m_iterable([ind.
-00027c90: 6765 6e65 2066 6f72 2069 6e64 2069 6e20  gene for ind in 
-00027ca0: 696e 6473 5d29 290a 0a20 2020 2020 2020  inds]))..       
-00027cb0: 2020 2020 2023 2073 796e 7461 6374 6963       # syntactic
-00027cc0: 2066 6561 7475 7265 2073 656c 6563 7469   feature selecti
-00027cd0: 6f6e 0a20 2020 2020 2020 2020 2020 2067  on.            g
-00027ce0: 656e 655f 7374 7220 3d20 7365 7428 290a  ene_str = set().
-00027cf0: 2020 2020 2020 2020 2020 2020 6669 6e61              fina
-00027d00: 6c5f 6765 6e65 7320 3d20 5b5d 0a20 2020  l_genes = [].   
-00027d10: 2020 2020 2020 2020 2066 6f72 2067 2069           for g i
-00027d20: 6e20 6765 6e65 733a 0a20 2020 2020 2020  n genes:.       
-00027d30: 2020 2020 2020 2020 2023 2072 656d 6f76           # remov
-00027d40: 6520 7379 6e74 6163 7469 6320 6571 7569  e syntactic equi
-00027d50: 7661 6c65 6e74 2020 6665 6174 7572 6573  valent  features
-00027d60: 2061 6e64 2063 6f6e 7374 616e 7420 6665   and constant fe
-00027d70: 6174 7572 6573 0a20 2020 2020 2020 2020  atures.         
-00027d80: 2020 2020 2020 2069 6620 7374 7228 6729         if str(g)
-00027d90: 206e 6f74 2069 6e20 6765 6e65 5f73 7472   not in gene_str
-00027da0: 2061 6e64 206e 6f74 2069 7369 6e73 7461   and not isinsta
-00027db0: 6e63 6528 675b 305d 2c20 6770 2e72 616e  nce(g[0], gp.ran
-00027dc0: 6431 3031 293a 0a20 2020 2020 2020 2020  d101):.         
-00027dd0: 2020 2020 2020 2020 2020 2067 656e 655f             gene_
-00027de0: 7374 722e 6164 6428 7374 7228 6729 290a  str.add(str(g)).
+000265c0: 2020 2020 2020 696e 642e 6167 6520 3d20        ind.age = 
+000265d0: 300a 2020 2020 2020 2020 2020 2020 2020  0.              
+000265e0: 2020 2020 2020 696e 642e 6669 746e 6573        ind.fitnes
+000265f0: 732e 7661 6c75 6573 203d 205b 696e 642e  s.values = [ind.
+00026600: 6669 746e 6573 732e 7661 6c75 6573 5b30  fitness.values[0
+00026610: 5d2c 2069 6e64 2e61 6765 5d0a 2020 2020  ], ind.age].    
+00026620: 2020 2020 2020 2020 2020 2020 6166 705f              afp_
+00026630: 6172 6368 6976 6520 3d20 7365 6c4e 5347  archive = selNSG
+00026640: 4132 286f 6666 7370 7269 6e67 202b 2061  A2(offspring + a
+00026650: 6670 5f61 7263 6869 7665 2c20 6c65 6e28  fp_archive, len(
+00026660: 706f 7075 6c61 7469 6f6e 2929 0a20 2020  population)).   
+00026670: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00026680: 2069 6e64 2069 6e20 6f66 6673 7072 696e   ind in offsprin
+00026690: 6720 2b20 6e73 6761 5f61 7263 6869 7665  g + nsga_archive
+000266a0: 202b 2061 6670 5f61 7263 6869 7665 202b   + afp_archive +
+000266b0: 2062 6573 745f 6172 6368 6976 653a 0a20   best_archive:. 
+000266c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000266d0: 2020 2069 6e64 2e66 6974 6e65 7373 2e77     ind.fitness.w
+000266e0: 6569 6768 7473 203d 2028 2d31 2c29 0a20  eights = (-1,). 
+000266f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026700: 2020 2069 6e64 2e66 6974 6e65 7373 2e76     ind.fitness.v
+00026710: 616c 7565 7320 3d20 6765 7461 7474 7228  alues = getattr(
+00026720: 696e 642c 2027 6f72 6967 696e 616c 5f66  ind, 'original_f
+00026730: 6974 6e65 7373 2729 0a0a 2020 2020 2020  itness')..      
+00026740: 2020 2020 2020 7365 6c66 2e72 6564 756e        self.redun
+00026750: 6461 6e74 5f66 6561 7475 7265 735f 6361  dant_features_ca
+00026760: 6c63 756c 6174 696f 6e28 6f66 6673 7072  lculation(offspr
+00026770: 696e 6729 0a20 2020 2020 2020 2020 2020  ing).           
+00026780: 2023 2052 6570 6c61 6365 2074 6865 2063   # Replace the c
+00026790: 7572 7265 6e74 2070 6f70 756c 6174 696f  urrent populatio
+000267a0: 6e20 6279 2074 6865 206f 6666 7370 7269  n by the offspri
+000267b0: 6e67 0a20 2020 2020 2020 2020 2020 2073  ng.            s
+000267c0: 656c 662e 7375 7276 6976 616c 5f73 656c  elf.survival_sel
+000267d0: 6563 7469 6f6e 2867 656e 2c20 706f 7075  ection(gen, popu
+000267e0: 6c61 7469 6f6e 2c20 6f66 6673 7072 696e  lation, offsprin
+000267f0: 6729 0a20 2020 2020 2020 2020 2020 2073  g).            s
+00026800: 656c 662e 7570 6461 7465 5f73 656d 616e  elf.update_seman
+00026810: 7469 635f 7265 7061 6972 5f69 6e70 7574  tic_repair_input
+00026820: 5f6d 6174 7269 7828 706f 7075 6c61 7469  _matrix(populati
+00026830: 6f6e 290a 2020 2020 2020 2020 2020 2020  on).            
+00026840: 6578 7465 726e 616c 5f61 7263 6869 7665  external_archive
+00026850: 203d 2073 656c 662e 7570 6461 7465 5f65   = self.update_e
+00026860: 7874 6572 6e61 6c5f 6172 6368 6976 6528  xternal_archive(
+00026870: 706f 7075 6c61 7469 6f6e 2c20 6578 7465  population, exte
+00026880: 726e 616c 5f61 7263 6869 7665 290a 0a20  rnal_archive).. 
+00026890: 2020 2020 2020 2020 2020 2023 2041 7070             # App
+000268a0: 656e 6420 7468 6520 6375 7272 656e 7420  end the current 
+000268b0: 6765 6e65 7261 7469 6f6e 2073 7461 7469  generation stati
+000268c0: 7374 6963 7320 746f 2074 6865 206c 6f67  stics to the log
+000268d0: 626f 6f6b 0a20 2020 2020 2020 2020 2020  book.           
+000268e0: 2072 6563 6f72 6420 3d20 7374 6174 732e   record = stats.
+000268f0: 636f 6d70 696c 6528 706f 7075 6c61 7469  compile(populati
+00026900: 6f6e 2920 6966 2073 7461 7473 2065 6c73  on) if stats els
+00026910: 6520 7b7d 0a20 2020 2020 2020 2020 2020  e {}.           
+00026920: 206c 6f67 626f 6f6b 2e72 6563 6f72 6428   logbook.record(
+00026930: 6765 6e3d 6765 6e2c 206e 6576 616c 733d  gen=gen, nevals=
+00026940: 6c65 6e28 696e 7661 6c69 645f 696e 6429  len(invalid_ind)
+00026950: 2c20 2a2a 7265 636f 7264 290a 2020 2020  , **record).    
+00026960: 2020 2020 2020 2020 6966 2076 6572 626f          if verbo
+00026970: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00026980: 2020 2020 2320 7365 6c66 2e70 6561 7273      # self.pears
+00026990: 6f6e 5f63 6f72 7265 6c61 7469 6f6e 5f61  on_correlation_a
+000269a0: 6e61 6c79 7369 7328 706f 7075 6c61 7469  nalysis(populati
+000269b0: 6f6e 290a 2020 2020 2020 2020 2020 2020  on).            
+000269c0: 2020 2020 2320 7365 6c66 2e70 6561 7273      # self.pears
+000269d0: 6f6e 5f63 6f72 7265 6c61 7469 6f6e 5f61  on_correlation_a
+000269e0: 6e61 6c79 7369 735f 7061 6972 7328 706f  nalysis_pairs(po
+000269f0: 7075 6c61 7469 6f6e 290a 2020 2020 2020  pulation).      
+00026a00: 2020 2020 2020 2020 2020 6665 6174 7572            featur
+00026a10: 6573 203d 2073 6574 2863 6861 696e 2e66  es = set(chain.f
+00026a20: 726f 6d5f 6974 6572 6162 6c65 286c 6973  rom_iterable(lis
+00026a30: 7428 6d61 7028 6c61 6d62 6461 2078 3a20  t(map(lambda x: 
+00026a40: 5b73 7472 2879 2920 666f 7220 7920 696e  [str(y) for y in
+00026a50: 2078 2e67 656e 655d 2c20 706f 7075 6c61   x.gene], popula
+00026a60: 7469 6f6e 2929 2929 0a20 2020 2020 2020  tion)))).       
+00026a70: 2020 2020 2020 2020 2023 2066 6561 7475           # featu
+00026a80: 7265 7320 3d20 7365 7428 6368 6169 6e2e  res = set(chain.
+00026a90: 6672 6f6d 5f69 7465 7261 626c 6528 6c69  from_iterable(li
+00026aa0: 7374 286d 6170 286c 616d 6264 6120 783a  st(map(lambda x:
+00026ab0: 205b 7374 7228 7929 2066 6f72 2079 2069   [str(y) for y i
+00026ac0: 6e20 782e 6765 6e65 5d2c 2073 656c 662e  n x.gene], self.
+00026ad0: 686f 6629 2929 290a 2020 2020 2020 2020  hof)))).        
+00026ae0: 2020 2020 2020 2020 7072 696e 7428 276e          print('n
+00026af0: 756d 6265 7220 6f66 2066 6561 7475 7265  umber of feature
+00026b00: 7327 2c20 6c65 6e28 6665 6174 7572 6573  s', len(features
+00026b10: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+00026b20: 2020 2070 7269 6e74 2827 6172 6368 6976     print('archiv
+00026b30: 6520 7369 7a65 272c 206c 656e 2873 656c  e size', len(sel
+00026b40: 662e 686f 6629 290a 2020 2020 2020 2020  f.hof)).        
+00026b50: 2020 2020 2020 2020 7072 696e 7428 2741          print('A
+00026b60: 7665 7261 6765 204e 756d 6265 7220 6f66  verage Number of
+00026b70: 2041 6374 6976 6520 4765 6e65 7327 2c20   Active Genes', 
+00026b80: 6e70 2e6d 6561 6e28 5b69 6e64 2e61 6374  np.mean([ind.act
+00026b90: 6976 655f 6765 6e65 2066 6f72 2069 6e64  ive_gene for ind
+00026ba0: 2069 6e20 706f 7075 6c61 7469 6f6e 5d29   in population])
+00026bb0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00026bc0: 2020 2320 7072 696e 7428 275c 6e27 2e6a    # print('\n'.j
+00026bd0: 6f69 6e28 6d61 7028 6c61 6d62 6461 2078  oin(map(lambda x
+00026be0: 3a20 7374 7228 7829 2c20 706f 7075 6c61  : str(x), popula
+00026bf0: 7469 6f6e 2929 290a 2020 2020 2020 2020  tion))).        
+00026c00: 2020 2020 2020 2020 7072 696e 7428 6c6f          print(lo
+00026c10: 6762 6f6f 6b2e 7374 7265 616d 290a 2020  gbook.stream).  
+00026c20: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00026c30: 2073 656c 662e 6261 7365 5f6d 6f64 656c   self.base_model
+00026c40: 5f6c 6973 7420 213d 204e 6f6e 653a 0a20  _list != None:. 
+00026c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026c60: 2020 206d 6f64 656c 5f64 6963 7420 3d20     model_dict = 
+00026c70: 6465 6661 756c 7464 6963 7428 696e 7429  defaultdict(int)
+00026c80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00026c90: 2020 2020 2066 6f72 2070 2069 6e20 706f       for p in po
+00026ca0: 7075 6c61 7469 6f6e 3a0a 2020 2020 2020  pulation:.      
+00026cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026cc0: 2020 6d6f 6465 6c5f 6469 6374 5b70 2e62    model_dict[p.b
+00026cd0: 6173 655f 6d6f 6465 6c5d 202b 3d20 310a  ase_model] += 1.
+00026ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026cf0: 2020 2020 7072 696e 7428 2750 6f70 756c      print('Popul
+00026d00: 6174 696f 6e27 2c20 6d6f 6465 6c5f 6469  ation', model_di
+00026d10: 6374 290a 2020 2020 2020 2020 2020 2020  ct).            
+00026d20: 2020 2020 2020 2020 6d6f 6465 6c5f 6469          model_di
+00026d30: 6374 203d 2064 6566 6175 6c74 6469 6374  ct = defaultdict
+00026d40: 2869 6e74 290a 2020 2020 2020 2020 2020  (int).          
+00026d50: 2020 2020 2020 2020 2020 666f 7220 7020            for p 
+00026d60: 696e 2073 656c 662e 686f 663a 0a20 2020  in self.hof:.   
+00026d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026d80: 2020 2020 206d 6f64 656c 5f64 6963 745b       model_dict[
+00026d90: 702e 6261 7365 5f6d 6f64 656c 5d20 2b3d  p.base_model] +=
+00026da0: 2031 0a20 2020 2020 2020 2020 2020 2020   1.             
+00026db0: 2020 2020 2020 2070 7269 6e74 2827 4861         print('Ha
+00026dc0: 6c6c 206f 6620 6661 6d65 272c 206d 6f64  ll of fame', mod
+00026dd0: 656c 5f64 6963 7429 0a0a 2020 2020 2020  el_dict)..      
+00026de0: 2020 2020 2020 2320 7374 6174 6973 7469        # statisti
+00026df0: 6361 6c20 696e 666f 726d 6174 696f 6e20  cal information 
+00026e00: 666f 7220 6164 6170 7469 7665 2047 500a  for adaptive GP.
+00026e10: 2020 2020 2020 2020 2020 2020 6375 7272              curr
+00026e20: 656e 745f 6265 7374 5f66 6974 6e65 7373  ent_best_fitness
+00026e30: 203d 206e 702e 6d61 7828 5b69 6e64 2e66   = np.max([ind.f
+00026e40: 6974 6e65 7373 2e77 7661 6c75 6573 5b30  itness.wvalues[0
+00026e50: 5d20 666f 7220 696e 6420 696e 2070 6f70  ] for ind in pop
+00026e60: 756c 6174 696f 6e5d 290a 2020 2020 2020  ulation]).      
+00026e70: 2020 2020 2020 6966 2068 6973 746f 7269        if histori
+00026e80: 6361 6c5f 6265 7374 5f66 6974 6e65 7373  cal_best_fitness
+00026e90: 203c 2063 7572 7265 6e74 5f62 6573 745f   < current_best_
+00026ea0: 6669 746e 6573 733a 0a20 2020 2020 2020  fitness:.       
+00026eb0: 2020 2020 2020 2020 2068 6973 746f 7269           histori
+00026ec0: 6361 6c5f 6265 7374 5f66 6974 6e65 7373  cal_best_fitness
+00026ed0: 203d 2063 7572 7265 6e74 5f62 6573 745f   = current_best_
+00026ee0: 6669 746e 6573 730a 2020 2020 2020 2020  fitness.        
+00026ef0: 2020 2020 2020 2020 6e6f 5f69 6d70 726f          no_impro
+00026f00: 7665 6d65 6e74 5f69 7465 7261 7469 6f6e  vement_iteration
+00026f10: 203d 2030 0a20 2020 2020 2020 2020 2020   = 0.           
+00026f20: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00026f30: 2020 2020 2020 206e 6f5f 696d 7072 6f76         no_improv
+00026f40: 656d 656e 745f 6974 6572 6174 696f 6e20  ement_iteration 
+00026f50: 2b3d 2031 0a20 2020 2020 2020 2020 2020  += 1.           
+00026f60: 2069 6620 7365 6c66 2e65 6172 6c79 5f73   if self.early_s
+00026f70: 746f 7020 3e20 303a 0a20 2020 2020 2020  top > 0:.       
+00026f80: 2020 2020 2020 2020 2069 6620 6e6f 5f69           if no_i
+00026f90: 6d70 726f 7665 6d65 6e74 5f69 7465 7261  mprovement_itera
+00026fa0: 7469 6f6e 203e 2073 656c 662e 6561 726c  tion > self.earl
+00026fb0: 795f 7374 6f70 3a0a 2020 2020 2020 2020  y_stop:.        
+00026fc0: 2020 2020 2020 2020 2020 2020 6272 6561              brea
+00026fd0: 6b0a 0a20 2020 2020 2020 2020 2020 2073  k..            s
+00026fe0: 656c 662e 7374 6174 6973 7469 6361 6c5f  elf.statistical_
+00026ff0: 7265 7375 6c74 5f75 7064 6174 6528 706f  result_update(po
+00027000: 7075 6c61 7469 6f6e 2c20 7665 7262 6f73  pulation, verbos
+00027010: 6529 0a20 2020 2020 2020 2020 2020 2073  e).            s
+00027020: 656c 662e 6361 6c6c 6261 636b 2829 0a20  elf.callback(). 
+00027030: 2020 2020 2020 2069 6620 7365 6c66 2e65         if self.e
+00027040: 6172 6c79 5f73 746f 703a 0a20 2020 2020  arly_stop:.     
+00027050: 2020 2020 2020 2061 7373 6572 7420 6e75         assert nu
+00027060: 6d62 6572 5f6f 665f 6576 616c 7561 7469  mber_of_evaluati
+00027070: 6f6e 7320 3d3d 2028 7365 6c66 2e63 7572  ons == (self.cur
+00027080: 7265 6e74 5f67 656e 202b 2031 2920 2a20  rent_gen + 1) * 
+00027090: 7365 6c66 2e6e 5f70 6f70 0a20 2020 2020  self.n_pop.     
+000270a0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+000270b0: 2020 2020 2061 7373 6572 7420 6e75 6d62       assert numb
+000270c0: 6572 5f6f 665f 6576 616c 7561 7469 6f6e  er_of_evaluation
+000270d0: 7320 3d3d 2074 6f74 616c 5f65 7661 6c75  s == total_evalu
+000270e0: 6174 696f 6e73 0a0a 2020 2020 2020 2020  ations..        
+000270f0: 6966 2073 656c 662e 6561 726c 795f 7374  if self.early_st
+00027100: 6f70 203e 2030 3a0a 2020 2020 2020 2020  op > 0:.        
+00027110: 2020 2020 7072 696e 7428 2766 696e 616c      print('final
+00027120: 2067 656e 6572 6174 696f 6e27 2c20 7365   generation', se
+00027130: 6c66 2e63 7572 7265 6e74 5f67 656e 290a  lf.current_gen).
+00027140: 2020 2020 2020 2020 6966 2076 6572 626f          if verbo
+00027150: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00027160: 7072 696e 7428 2746 696e 616c 2045 6e73  print('Final Ens
+00027170: 656d 626c 6520 5369 7a65 272c 206c 656e  emble Size', len
+00027180: 2873 656c 662e 686f 6629 290a 2020 2020  (self.hof)).    
+00027190: 2020 2020 6966 2073 656c 662e 6e5f 7072      if self.n_pr
+000271a0: 6f63 6573 7320 3e20 313a 0a20 2020 2020  ocess > 1:.     
+000271b0: 2020 2020 2020 2073 656c 662e 706f 6f6c         self.pool
+000271c0: 2e63 6c6f 7365 2829 0a20 2020 2020 2020  .close().       
+000271d0: 2069 6620 7365 6c66 2e66 6f72 6365 5f73   if self.force_s
+000271e0: 725f 7472 6565 3a0a 2020 2020 2020 2020  r_tree:.        
+000271f0: 2020 2020 7365 6c66 2e62 6173 655f 6c65      self.base_le
+00027200: 6172 6e65 7220 3d20 7365 6c66 2e62 6173  arner = self.bas
+00027210: 655f 6c65 6172 6e65 722e 7265 706c 6163  e_learner.replac
+00027220: 6528 2746 6173 742d 272c 2027 2729 0a20  e('Fast-', ''). 
+00027230: 2020 2020 2020 2020 2020 2066 6f72 2067             for g
+00027240: 2069 6e20 7365 6c66 2e68 6f66 3a0a 2020   in self.hof:.  
+00027250: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00027260: 7265 7365 7420 6261 7365 206c 6561 726e  reset base learn
+00027270: 6572 730a 2020 2020 2020 2020 2020 2020  ers.            
+00027280: 2020 2020 672e 7069 7065 203d 2073 656c      g.pipe = sel
+00027290: 662e 6765 745f 6261 7365 5f6d 6f64 656c  f.get_base_model
+000272a0: 2829 0a20 2020 2020 2020 2065 6c73 653a  ().        else:
+000272b0: 0a20 2020 2020 2020 2020 2020 2023 2063  .            # c
+000272c0: 6861 6e67 6520 6261 7365 206c 6561 726e  hange base learn
+000272d0: 6572 2c20 6275 7420 6e6f 7420 6368 616e  er, but not chan
+000272e0: 6765 2061 6c6c 2065 7869 7374 696e 6720  ge all existing 
+000272f0: 6d6f 6465 6c73 0a20 2020 2020 2020 2020  models.         
+00027300: 2020 2073 656c 662e 6261 7365 5f6c 6561     self.base_lea
+00027310: 726e 6572 203d 2073 656c 662e 6261 7365  rner = self.base
+00027320: 5f6c 6561 726e 6572 2e72 6570 6c61 6365  _learner.replace
+00027330: 2827 4661 7374 2d27 2c20 2727 290a 2020  ('Fast-', '').  
+00027340: 2020 2020 2020 6173 7365 7274 206e 6f74        assert not
+00027350: 2073 656c 662e 6261 7365 5f6c 6561 726e   self.base_learn
+00027360: 6572 2e73 7461 7274 7377 6974 6828 2746  er.startswith('F
+00027370: 6173 742d 2729 0a20 2020 2020 2020 2073  ast-').        s
+00027380: 656c 662e 706f 7374 5f70 7275 6e65 2873  elf.post_prune(s
+00027390: 656c 662e 686f 6629 0a20 2020 2020 2020  elf.hof).       
+000273a0: 2072 6574 7572 6e20 706f 7075 6c61 7469   return populati
+000273b0: 6f6e 2c20 6c6f 6762 6f6f 6b0a 0a20 2020  on, logbook..   
+000273c0: 2064 6566 2073 656d 616e 7469 635f 6372   def semantic_cr
+000273d0: 6f73 736f 7665 725f 666f 725f 7061 7265  ossover_for_pare
+000273e0: 6e74 2873 656c 662c 2074 6f6f 6c62 6f78  nt(self, toolbox
+000273f0: 2c20 7061 7265 6e74 2c20 6578 7465 726e  , parent, extern
+00027400: 616c 5f61 7263 6869 7665 2c0a 2020 2020  al_archive,.    
+00027410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027430: 2020 6372 6f73 736f 7665 725f 636f 6e66    crossover_conf
+00027440: 6967 7572 6174 696f 6e3a 2043 726f 7373  iguration: Cross
+00027450: 6f76 6572 436f 6e66 6967 7572 6174 696f  overConfiguratio
+00027460: 6e29 3a0a 2020 2020 2020 2020 6176 6169  n):.        avai
+00027470: 6c61 626c 655f 7061 7265 6e74 203d 205b  lable_parent = [
+00027480: 5d0a 2020 2020 2020 2020 7061 7265 6e74  ].        parent
+00027490: 7320 3d20 5b5d 0a20 2020 2020 2020 2077  s = [].        w
+000274a0: 6869 6c65 206c 656e 2861 7661 696c 6162  hile len(availab
+000274b0: 6c65 5f70 6172 656e 7429 203d 3d20 303a  le_parent) == 0:
+000274c0: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
+000274d0: 656e 7473 203d 2073 656c 662e 7472 6164  ents = self.trad
+000274e0: 6974 696f 6e61 6c5f 7061 7265 6e74 5f73  itional_parent_s
+000274f0: 656c 6563 7469 6f6e 2874 6f6f 6c62 6f78  election(toolbox
+00027500: 2c20 7061 7265 6e74 2c20 6578 7465 726e  , parent, extern
+00027510: 616c 5f61 7263 6869 7665 290a 2020 2020  al_archive).    
+00027520: 2020 2020 2020 2020 6966 2063 726f 7373          if cross
+00027530: 6f76 6572 5f63 6f6e 6669 6775 7261 7469  over_configurati
+00027540: 6f6e 2e73 656d 616e 7469 635f 7365 6c65  on.semantic_sele
+00027550: 6374 696f 6e5f 6d6f 6465 203d 3d20 5365  ction_mode == Se
+00027560: 6c65 6374 696f 6e4d 6f64 652e 4d41 5045  lectionMode.MAPE
+00027570: 6c69 7465 733a 0a20 2020 2020 2020 2020  lites:.         
+00027580: 2020 2020 2020 2061 7661 696c 6162 6c65         available
+00027590: 5f70 6172 656e 7420 3d20 6d61 7045 6c69  _parent = mapEli
+000275a0: 7465 7343 726f 7373 6f76 6572 2870 6172  tesCrossover(par
+000275b0: 656e 7473 5b30 5d2c 2070 6172 656e 7473  ents[0], parents
+000275c0: 5b31 5d2c 2073 656c 662e 792c 0a20 2020  [1], self.y,.   
+000275d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000275e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000275f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027600: 2020 2063 726f 7373 6f76 6572 5f63 6f6e     crossover_con
+00027610: 6669 6775 7261 7469 6f6e 2e6d 6170 5f65  figuration.map_e
+00027620: 6c69 7465 735f 636f 6e66 6967 7572 6174  lites_configurat
+00027630: 696f 6e29 0a20 2020 2020 2020 2020 2020  ion).           
+00027640: 2065 6c69 6620 6372 6f73 736f 7665 725f   elif crossover_
+00027650: 636f 6e66 6967 7572 6174 696f 6e2e 7365  configuration.se
+00027660: 6d61 6e74 6963 5f73 656c 6563 7469 6f6e  mantic_selection
+00027670: 5f6d 6f64 6520 3d3d 2053 656c 6563 7469  _mode == Selecti
+00027680: 6f6e 4d6f 6465 2e41 6e67 6c65 4472 6976  onMode.AngleDriv
+00027690: 656e 3a0a 2020 2020 2020 2020 2020 2020  en:.            
+000276a0: 2020 2020 6176 6169 6c61 626c 655f 7061      available_pa
+000276b0: 7265 6e74 203d 2073 656d 616e 7469 6346  rent = semanticF
+000276c0: 6561 7475 7265 4372 6f73 736f 7665 7228  eatureCrossover(
+000276d0: 7061 7265 6e74 735b 305d 2c20 7061 7265  parents[0], pare
+000276e0: 6e74 735b 315d 2c20 7365 6c66 2e79 290a  nts[1], self.y).
+000276f0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00027700: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00027710: 2020 7261 6973 6520 4578 6365 7074 696f    raise Exceptio
+00027720: 6e28 2755 6e73 7570 706f 7274 6564 2073  n('Unsupported s
+00027730: 656d 616e 7469 6320 7365 6c65 6374 696f  emantic selectio
+00027740: 6e20 6d6f 6465 3a27 2c0a 2020 2020 2020  n mode:',.      
+00027750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027760: 2020 2020 2020 2020 2020 6372 6f73 736f            crosso
+00027770: 7665 725f 636f 6e66 6967 7572 6174 696f  ver_configuratio
+00027780: 6e2e 7365 6d61 6e74 6963 5f73 656c 6563  n.semantic_selec
+00027790: 7469 6f6e 5f6d 6f64 6529 0a0a 2020 2020  tion_mode)..    
+000277a0: 2020 2020 7265 7475 726e 2070 6172 656e      return paren
+000277b0: 7473 2c20 6176 6169 6c61 626c 655f 7061  ts, available_pa
+000277c0: 7265 6e74 5b30 5d0a 0a20 2020 2064 6566  rent[0]..    def
+000277d0: 2072 6563 6f72 645f 7061 7265 6e74 5f66   record_parent_f
+000277e0: 6974 6e65 7373 2873 656c 662c 2070 6172  itness(self, par
+000277f0: 656e 7473 2c20 6f66 6673 7072 696e 672c  ents, offspring,
+00027800: 2063 726f 7373 6f76 6572 5f74 7970 6529   crossover_type)
+00027810: 3a0a 2020 2020 2020 2020 6966 2073 656c  :.        if sel
+00027820: 662e 6372 6f73 736f 7665 725f 636f 6e66  f.crossover_conf
+00027830: 6967 7572 6174 696f 6e2e 7365 6d61 6e74  iguration.semant
+00027840: 6963 5f63 726f 7373 6f76 6572 5f6d 6f64  ic_crossover_mod
+00027850: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
+00027860: 2020 2020 2020 2020 2020 2023 2072 6563             # rec
+00027870: 6f72 6420 7061 7265 6e74 2066 6974 6e65  ord parent fitne
+00027880: 7373 0a20 2020 2020 2020 2020 2020 2070  ss.            p
+00027890: 6172 656e 745f 6669 746e 6573 7320 3d20  arent_fitness = 
+000278a0: 5b70 6172 656e 742e 6669 746e 6573 732e  [parent.fitness.
+000278b0: 7776 616c 7565 735b 305d 2066 6f72 2070  wvalues[0] for p
+000278c0: 6172 656e 7420 696e 2070 6172 656e 7473  arent in parents
+000278d0: 5d0a 2020 2020 2020 2020 2020 2020 666f  ].            fo
+000278e0: 7220 6f20 696e 206f 6666 7370 7269 6e67  r o in offspring
+000278f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00027900: 2020 6f2e 7061 7265 6e74 5f66 6974 6e65    o.parent_fitne
+00027910: 7373 203d 2070 6172 656e 745f 6669 746e  ss = parent_fitn
+00027920: 6573 730a 2020 2020 2020 2020 2020 2020  ess.            
+00027930: 2020 2020 6f2e 6372 6f73 736f 7665 725f      o.crossover_
+00027940: 7479 7065 203d 2063 726f 7373 6f76 6572  type = crossover
+00027950: 5f74 7970 650a 0a20 2020 2064 6566 2073  _type..    def s
+00027960: 656d 616e 7469 635f 686f 6973 745f 6d75  emantic_hoist_mu
+00027970: 7461 7469 6f6e 2873 656c 662c 2070 6f70  tation(self, pop
+00027980: 756c 6174 696f 6e2c 2061 6461 7074 6976  ulation, adaptiv
+00027990: 655f 686f 6973 745f 7072 6f62 6162 696c  e_hoist_probabil
+000279a0: 6974 7929 3a0a 2020 2020 2020 2020 6966  ity):.        if
+000279b0: 2073 656c 662e 6765 6e65 5f6e 756d 203d   self.gene_num =
+000279c0: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
+000279d0: 2023 2043 6865 636b 2061 6372 6f73 7320   # Check across 
+000279e0: 6469 6666 6572 656e 7420 696e 6469 7669  different indivi
+000279f0: 6475 616c 2074 6f20 656e 7375 7265 2064  dual to ensure d
+00027a00: 6976 6572 7369 7479 0a20 2020 2020 2020  iversity.       
+00027a10: 2020 2020 2070 7265 7669 6f75 735f 6765       previous_ge
+00027a20: 6e65 203d 2073 6574 2829 0a20 2020 2020  ne = set().     
+00027a30: 2020 2020 2020 2066 6f72 206f 2069 6e20         for o in 
+00027a40: 736f 7274 6564 2870 6f70 756c 6174 696f  sorted(populatio
+00027a50: 6e2c 206b 6579 3d6c 616d 6264 6120 783a  n, key=lambda x:
+00027a60: 2078 2e66 6974 6e65 7373 2e77 7661 6c75   x.fitness.wvalu
+00027a70: 6573 2c20 7265 7665 7273 653d 5472 7565  es, reverse=True
+00027a80: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00027a90: 2020 2069 6620 7365 6c66 2e62 6c6f 6174     if self.bloat
+00027aa0: 5f63 6f6e 7472 6f6c 2e67 6574 2822 6469  _control.get("di
+00027ab0: 7665 7273 6974 795f 656e 6861 6e63 656d  versity_enhancem
+00027ac0: 656e 7422 2c20 4661 6c73 6529 3a0a 2020  ent", False):.  
+00027ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027ae0: 2020 7365 6c66 2e68 6f69 7374 5f6d 7574    self.hoist_mut
+00027af0: 6174 696f 6e28 6f2c 2061 6461 7074 6976  ation(o, adaptiv
+00027b00: 655f 686f 6973 745f 7072 6f62 6162 696c  e_hoist_probabil
+00027b10: 6974 792c 2070 7265 7669 6f75 735f 6765  ity, previous_ge
+00027b20: 6e65 290a 2020 2020 2020 2020 2020 2020  ne).            
+00027b30: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00027b40: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00027b50: 6c66 2e68 6f69 7374 5f6d 7574 6174 696f  lf.hoist_mutatio
+00027b60: 6e28 6f2c 2061 6461 7074 6976 655f 686f  n(o, adaptive_ho
+00027b70: 6973 745f 7072 6f62 6162 696c 6974 7929  ist_probability)
+00027b80: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00027b90: 2020 2020 2020 2020 2020 2066 6f72 206f             for o
+00027ba0: 2069 6e20 706f 7075 6c61 7469 6f6e 3a0a   in population:.
+00027bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027bc0: 6f3a 204d 756c 7469 706c 6547 656e 6547  o: MultipleGeneG
+00027bd0: 500a 2020 2020 2020 2020 2020 2020 2020  P.              
+00027be0: 2020 7365 6c66 2e68 6f69 7374 5f6d 7574    self.hoist_mut
+00027bf0: 6174 696f 6e28 6f2c 2061 6461 7074 6976  ation(o, adaptiv
+00027c00: 655f 686f 6973 745f 7072 6f62 6162 696c  e_hoist_probabil
+00027c10: 6974 7929 0a0a 2020 2020 6465 6620 6765  ity)..    def ge
+00027c20: 745f 705f 7661 6c75 6528 7365 6c66 2c20  t_p_value(self, 
+00027c30: 6f66 6673 7072 696e 672c 2070 6f70 756c  offspring, popul
+00027c40: 6174 696f 6e29 3a0a 2020 2020 2020 2020  ation):.        
+00027c50: 6e75 6d5f 746f 705f 696e 6469 7669 6475  num_top_individu
+00027c60: 616c 7320 3d20 3330 0a20 2020 2020 2020  als = 30.       
+00027c70: 2023 206e 756d 5f74 6f70 5f69 6e64 6976   # num_top_indiv
+00027c80: 6964 7561 6c73 203d 2073 656c 662e 6e5f  iduals = self.n_
+00027c90: 706f 700a 2020 2020 2020 2020 705f 7661  pop.        p_va
+00027ca0: 6c75 6520 3d20 7261 6e6b 7375 6d73 285b  lue = ranksums([
+00027cb0: 6f2e 6669 746e 6573 732e 7776 616c 7565  o.fitness.wvalue
+00027cc0: 735b 305d 2066 6f72 206f 2069 6e20 736f  s[0] for o in so
+00027cd0: 7274 6564 286f 6666 7370 7269 6e67 2c20  rted(offspring, 
+00027ce0: 6b65 793d 6c61 6d62 6461 2078 3a20 782e  key=lambda x: x.
+00027cf0: 6669 746e 6573 732e 7776 616c 7565 735b  fitness.wvalues[
+00027d00: 305d 2c0a 2020 2020 2020 2020 2020 2020  0],.            
+00027d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027d40: 2020 2020 2072 6576 6572 7365 3d54 7275       reverse=Tru
+00027d50: 6529 5b3a 6e75 6d5f 746f 705f 696e 6469  e)[:num_top_indi
+00027d60: 7669 6475 616c 735d 5d2c 0a20 2020 2020  viduals]],.     
+00027d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027d80: 2020 2020 2020 5b6f 2e66 6974 6e65 7373        [o.fitness
+00027d90: 2e77 7661 6c75 6573 5b30 5d20 666f 7220  .wvalues[0] for 
+00027da0: 6f20 696e 2073 6f72 7465 6428 706f 7075  o in sorted(popu
+00027db0: 6c61 7469 6f6e 2c20 6b65 793d 6c61 6d62  lation, key=lamb
+00027dc0: 6461 2078 3a20 782e 6669 746e 6573 732e  da x: x.fitness.
+00027dd0: 7776 616c 7565 735b 305d 2c0a 2020 2020  wvalues[0],.    
+00027de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00027df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027e00: 2020 2020 6669 6e61 6c5f 6765 6e65 732e      final_genes.
-00027e10: 6170 7065 6e64 2867 290a 0a20 2020 2020  append(g)..     
-00027e20: 2020 2020 2020 2023 2073 656d 616e 7469         # semanti
-00027e30: 6320 6665 6174 7572 6520 7365 6c65 6374  c feature select
-00027e40: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
-00027e50: 6765 6e65 5f63 6f6d 7069 6c65 6420 3d20  gene_compiled = 
-00027e60: 5b5d 0a20 2020 2020 2020 2020 2020 2066  [].            f
-00027e70: 6f72 2067 656e 6520 696e 2066 696e 616c  or gene in final
-00027e80: 5f67 656e 6573 3a0a 2020 2020 2020 2020  _genes:.        
-00027e90: 2020 2020 2020 2020 6765 6e65 5f63 6f6d          gene_com
-00027ea0: 7069 6c65 642e 6170 7065 6e64 2863 6f6d  piled.append(com
-00027eb0: 7069 6c65 2867 656e 652c 2073 656c 662e  pile(gene, self.
-00027ec0: 7073 6574 2929 0a20 2020 2020 2020 2020  pset)).         
-00027ed0: 2020 2023 2072 616e 646f 6d20 7361 6d70     # random samp
-00027ee0: 6c65 2061 2073 7562 7365 7420 746f 2070  le a subset to p
-00027ef0: 6572 666f 726d 2066 6561 7475 7265 2073  erform feature s
-00027f00: 656c 6563 7469 6f6e 0a20 2020 2020 2020  election.       
-00027f10: 2020 2020 2078 203d 2073 656c 662e 585b       x = self.X[
-00027f20: 6e70 2e72 616e 646f 6d2e 7261 6e64 696e  np.random.randin
-00027f30: 7428 6c6f 773d 302c 2073 697a 653d 3230  t(low=0, size=20
-00027f40: 2c20 6869 6768 3d73 656c 662e 792e 7368  , high=self.y.sh
-00027f50: 6170 655b 305d 295d 0a20 2020 2020 2020  ape[0])].       
-00027f60: 2020 2020 2066 6561 7475 7265 7320 3d20       features = 
-00027f70: 7265 7375 6c74 5f63 616c 6375 6c61 7469  result_calculati
-00027f80: 6f6e 2867 656e 655f 636f 6d70 696c 6564  on(gene_compiled
-00027f90: 2c20 782c 2046 616c 7365 290a 2020 2020  , x, False).    
-00027fa0: 2020 2020 2020 2020 6665 6174 7572 6573          features
-00027fb0: 2c20 7365 6c65 6374 6564 5f69 6e64 6578  , selected_index
-00027fc0: 203d 206e 702e 756e 6971 7565 2866 6561   = np.unique(fea
-00027fd0: 7475 7265 732c 2072 6574 7572 6e5f 696e  tures, return_in
-00027fe0: 6465 783d 5472 7565 2c20 6178 6973 3d31  dex=True, axis=1
-00027ff0: 290a 2020 2020 2020 2020 2020 2020 6765  ).            ge
-00028000: 6e65 7320 3d20 5b66 696e 616c 5f67 656e  nes = [final_gen
-00028010: 6573 5b72 5d20 666f 7220 7220 696e 2073  es[r] for r in s
-00028020: 656c 6563 7465 645f 696e 6465 785d 0a20  elected_index]. 
-00028030: 2020 2020 2020 2020 2020 2061 7373 6572             asser
-00028040: 7420 6c65 6e28 6765 6e65 7329 203d 3d20  t len(genes) == 
-00028050: 6665 6174 7572 6573 2e73 6861 7065 5b31  features.shape[1
-00028060: 5d0a 0a20 2020 2020 2020 2020 2020 2023  ]..            #
-00028070: 206d 726d 7220 6665 6174 7572 6520 7365   mrmr feature se
-00028080: 6c65 6374 696f 6e0a 2020 2020 2020 2020  lection.        
-00028090: 2020 2020 2320 6966 206c 656e 2867 656e      # if len(gen
-000280a0: 6573 2920 3c20 7365 6c66 2e67 656e 655f  es) < self.gene_
-000280b0: 6e75 6d3a 0a20 2020 2020 2020 2020 2020  num:.           
-000280c0: 2023 2020 2020 2063 6f6e 7469 6e75 650a   #     continue.
-000280d0: 2020 2020 2020 2020 2020 2020 2320 7265              # re
-000280e0: 7375 6c74 203d 206d 726d 725f 7265 6772  sult = mrmr_regr
-000280f0: 6573 7369 6f6e 2866 6561 7475 7265 732c  ession(features,
-00028100: 2073 656c 662e 792c 2073 656c 662e 6765   self.y, self.ge
-00028110: 6e65 5f6e 756d 2c0a 2020 2020 2020 2020  ne_num,.        
-00028120: 2020 2020 2320 2020 2020 2020 2020 2020      #           
-00028130: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00028140: 656c 6576 616e 6365 3d5f 665f 7265 6772  elevance=_f_regr
-00028150: 6573 7369 6f6e 2c20 7265 6475 6e64 616e  ession, redundan
-00028160: 6379 3d5f 636f 7272 5f70 6561 7273 6f6e  cy=_corr_pearson
-00028170: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
-00028180: 7265 7375 6c74 2c20 5f2c 205f 203d 204d  result, _, _ = M
-00028190: 524d 522e 6d72 6d72 2866 6561 7475 7265  RMR.mrmr(feature
-000281a0: 732c 2073 656c 662e 792c 206e 5f73 656c  s, self.y, n_sel
-000281b0: 6563 7465 645f 6665 6174 7572 6573 3d73  ected_features=s
-000281c0: 656c 662e 6765 6e65 5f6e 756d 290a 2020  elf.gene_num).  
-000281d0: 2020 2020 2020 2020 2020 2320 7365 6c65            # sele
-000281e0: 6374 6564 5f66 6561 7475 7265 7320 3d20  cted_features = 
-000281f0: 5b67 656e 6573 5b72 5d20 666f 7220 7220  [genes[r] for r 
-00028200: 696e 2072 6573 756c 745d 0a0a 2020 2020  in result]..    
-00028210: 2020 2020 2020 2020 2320 616e 6f74 6865          # anothe
-00028220: 7220 7374 7261 7465 6779 3a20 6f6e 6c79  r strategy: only
-00028230: 2065 6c69 6d69 6e61 7465 2072 6564 756e   eliminate redun
-00028240: 6461 6e74 2066 6561 7475 7265 730a 2020  dant features.  
-00028250: 2020 2020 2020 2020 2020 2320 7365 6c65            # sele
-00028260: 6374 6564 5f66 6561 7475 7265 7320 3d20  cted_features = 
-00028270: 5b67 656e 6573 5b72 5d20 666f 7220 7220  [genes[r] for r 
-00028280: 696e 2072 616e 6765 2873 656c 662e 6765  in range(self.ge
-00028290: 6e65 5f6e 756d 295d 0a0a 2020 2020 2020  ne_num)]..      
-000282a0: 2020 2020 2020 2320 7265 6c69 6566 2073        # relief s
-000282b0: 656c 6563 7469 6f6e 0a20 2020 2020 2020  election.       
-000282c0: 2020 2020 2023 2073 636f 7265 203d 2072       # score = r
-000282d0: 656c 6965 6646 2e72 656c 6965 6646 2866  eliefF.reliefF(f
-000282e0: 6561 7475 7265 732c 7365 6c66 2e79 290a  eatures,self.y).
-000282f0: 2020 2020 2020 2020 2020 2020 2320 7365              # se
-00028300: 6c65 6374 6564 5f66 6561 7475 7265 7320  lected_features 
-00028310: 3d20 5b67 656e 6573 5b72 5d20 666f 7220  = [genes[r] for 
-00028320: 7220 696e 206e 702e 6172 6773 6f72 7428  r in np.argsort(
-00028330: 7363 6f72 6529 5b2d 7365 6c66 2e67 656e  score)[-self.gen
-00028340: 655f 6e75 6d3a 5d5d 0a20 2020 2020 2020  e_num:]].       
-00028350: 2020 2020 2023 2069 6e64 203d 2063 6f70       # ind = cop
-00028360: 792e 6465 6570 636f 7079 2869 6e64 735b  y.deepcopy(inds[
-00028370: 305d 290a 2020 2020 2020 2020 2020 2020  0]).            
-00028380: 2320 696e 642e 6765 6e65 203d 2073 656c  # ind.gene = sel
-00028390: 6563 7465 645f 6665 6174 7572 6573 0a0a  ected_features..
-000283a0: 2020 2020 2020 2020 2020 2020 702e 6765              p.ge
-000283b0: 6e65 203d 2067 656e 6573 0a20 2020 2020  ne = genes.     
-000283c0: 2020 2020 2020 2023 206e 6577 5f70 6f70         # new_pop
-000283d0: 756c 6174 696f 6e2e 6170 7065 6e64 2869  ulation.append(i
-000283e0: 6e64 290a 0a20 2020 2064 6566 2070 6561  nd)..    def pea
-000283f0: 7273 6f6e 5f63 6f72 7265 6c61 7469 6f6e  rson_correlation
-00028400: 5f61 6e61 6c79 7369 735f 7061 6972 7328  _analysis_pairs(
-00028410: 7365 6c66 2c20 706f 7075 6c61 7469 6f6e  self, population
-00028420: 293a 0a20 2020 2020 2020 2023 2050 6f70  ):.        # Pop
-00028430: 756c 6174 696f 6e20 416e 616c 7973 6973  ulation Analysis
-00028440: 0a20 2020 2020 2020 2064 6566 2070 6561  .        def pea
-00028450: 7273 6f6e 5f63 616c 6375 6c61 7469 6f6e  rson_calculation
-00028460: 2869 6e64 3a20 4d75 6c74 6970 6c65 4765  (ind: MultipleGe
-00028470: 6e65 4750 293a 0a20 2020 2020 2020 2020  neGP):.         
-00028480: 2020 2066 6561 7475 7265 7320 3d20 7365     features = se
-00028490: 6c66 2e66 6561 7475 7265 5f67 656e 6572  lf.feature_gener
-000284a0: 6174 696f 6e28 7365 6c66 2e58 2c20 696e  ation(self.X, in
-000284b0: 6429 0a20 2020 2020 2020 2020 2020 2063  d).            c
-000284c0: 6f72 7220 3d20 6e70 2e6e 616e 5f74 6f5f  orr = np.nan_to_
-000284d0: 6e75 6d28 6e70 2e61 6273 286e 702e 6172  num(np.abs(np.ar
-000284e0: 7261 7928 7064 2e44 6174 6146 7261 6d65  ray(pd.DataFrame
-000284f0: 2866 6561 7475 7265 7329 2e63 6f72 7228  (features).corr(
-00028500: 2929 292c 206e 616e 3d31 290a 2020 2020  ))), nan=1).    
-00028510: 2020 2020 2020 2020 7265 7475 726e 206e          return n
-00028520: 702e 6d65 616e 2863 6f72 7229 0a0a 2020  p.mean(corr)..  
-00028530: 2020 2020 2020 676f 6f64 5f70 6561 7273        good_pears
-00028540: 6f6e 5f6c 6973 7420 3d20 6e70 2e61 6273  on_list = np.abs
-00028550: 285b 7065 6172 736f 6e5f 6361 6c63 756c  ([pearson_calcul
-00028560: 6174 696f 6e28 7029 2066 6f72 2070 2069  ation(p) for p i
-00028570: 6e20 706f 7075 6c61 7469 6f6e 5d29 0a20  n population]). 
-00028580: 2020 2020 2020 2070 7269 6e74 2827 5065         print('Pe
-00028590: 6172 736f 6e20 436f 7272 656c 6174 696f  arson Correlatio
-000285a0: 6e27 2c20 6e70 2e6d 6561 6e28 676f 6f64  n', np.mean(good
-000285b0: 5f70 6561 7273 6f6e 5f6c 6973 7429 290a  _pearson_list)).
-000285c0: 0a20 2020 2064 6566 2070 6561 7273 6f6e  .    def pearson
-000285d0: 5f63 6f72 7265 6c61 7469 6f6e 5f61 6e61  _correlation_ana
-000285e0: 6c79 7369 7328 7365 6c66 2c20 706f 7075  lysis(self, popu
-000285f0: 6c61 7469 6f6e 293a 0a20 2020 2020 2020  lation):.       
-00028600: 2023 2050 6f70 756c 6174 696f 6e20 416e   # Population An
-00028610: 616c 7973 6973 0a20 2020 2020 2020 2070  alysis.        p
-00028620: 6f6f 725f 696e 6469 7669 6475 616c 7320  oor_individuals 
-00028630: 3d20 6c69 7374 2873 6f72 7465 6428 706f  = list(sorted(po
-00028640: 7075 6c61 7469 6f6e 2c20 6b65 793d 6c61  pulation, key=la
-00028650: 6d62 6461 2078 3a20 782e 6669 746e 6573  mbda x: x.fitnes
-00028660: 732e 7776 616c 7565 7329 295b 3a6c 656e  s.wvalues))[:len
-00028670: 2870 6f70 756c 6174 696f 6e29 202f 2f20  (population) // 
-00028680: 355d 0a20 2020 2020 2020 2067 6f6f 645f  5].        good_
-00028690: 696e 6469 7669 6475 616c 7320 3d20 6c69  individuals = li
-000286a0: 7374 2873 6f72 7465 6428 706f 7075 6c61  st(sorted(popula
-000286b0: 7469 6f6e 2c20 6b65 793d 6c61 6d62 6461  tion, key=lambda
-000286c0: 2078 3a20 782e 6669 746e 6573 732e 7776   x: x.fitness.wv
-000286d0: 616c 7565 7329 295b 2d6c 656e 2870 6f70  alues))[-len(pop
-000286e0: 756c 6174 696f 6e29 202f 2f20 353a 5d0a  ulation) // 5:].
-000286f0: 0a20 2020 2020 2020 2064 6566 2070 6561  .        def pea
-00028700: 7273 6f6e 5f63 616c 6375 6c61 7469 6f6e  rson_calculation
-00028710: 2869 6e64 3a20 4d75 6c74 6970 6c65 4765  (ind: MultipleGe
-00028720: 6e65 4750 293a 0a20 2020 2020 2020 2020  neGP):.         
-00028730: 2020 2066 6561 7475 7265 7320 3d20 7365     features = se
-00028740: 6c66 2e66 6561 7475 7265 5f67 656e 6572  lf.feature_gener
-00028750: 6174 696f 6e28 7365 6c66 2e58 2c20 696e  ation(self.X, in
-00028760: 6429 0a20 2020 2020 2020 2020 2020 2023  d).            #
-00028770: 2072 6574 7572 6e20 7065 6172 736f 6e72   return pearsonr
-00028780: 2866 6561 7475 7265 735b 3a2c 206e 702e  (features[:, np.
-00028790: 6172 676d 6178 2869 6e64 2e63 6f65 6629  argmax(ind.coef)
-000287a0: 5d2c 2073 656c 662e 7929 5b30 5d0a 2020  ], self.y)[0].  
-000287b0: 2020 2020 2020 2020 2020 616c 6c5f 7661            all_va
-000287c0: 6c75 6573 203d 206e 702e 6162 7328 6e70  lues = np.abs(np
-000287d0: 2e6e 616e 5f74 6f5f 6e75 6d28 5b70 6561  .nan_to_num([pea
-000287e0: 7273 6f6e 7228 6665 6174 7572 6573 5b3a  rsonr(features[:
-000287f0: 2c20 705d 2c20 7365 6c66 2e79 295b 305d  , p], self.y)[0]
-00028800: 2066 6f72 2070 2069 6e20 7261 6e67 6528   for p in range(
-00028810: 6665 6174 7572 6573 2e73 6861 7065 5b31  features.shape[1
-00028820: 5d29 5d29 290a 2020 2020 2020 2020 2020  ])])).          
-00028830: 2020 7265 7475 726e 206e 702e 6d65 616e    return np.mean
-00028840: 2861 6c6c 5f76 616c 7565 7329 2c20 6e70  (all_values), np
-00028850: 2e6d 696e 2861 6c6c 5f76 616c 7565 7329  .min(all_values)
-00028860: 2c20 6e70 2e6d 6178 2861 6c6c 5f76 616c  , np.max(all_val
-00028870: 7565 7329 0a0a 2020 2020 2020 2020 676f  ues)..        go
-00028880: 6f64 5f70 6561 7273 6f6e 5f6c 6973 7420  od_pearson_list 
-00028890: 3d20 6e70 2e61 6273 285b 7065 6172 736f  = np.abs([pearso
-000288a0: 6e5f 6361 6c63 756c 6174 696f 6e28 7029  n_calculation(p)
-000288b0: 2066 6f72 2070 2069 6e20 676f 6f64 5f69   for p in good_i
-000288c0: 6e64 6976 6964 7561 6c73 5d29 0a20 2020  ndividuals]).   
-000288d0: 2020 2020 2062 6164 5f70 6561 7273 6f6e       bad_pearson
-000288e0: 5f6c 6973 7420 3d20 6e70 2e61 6273 285b  _list = np.abs([
-000288f0: 7065 6172 736f 6e5f 6361 6c63 756c 6174  pearson_calculat
-00028900: 696f 6e28 7029 2066 6f72 2070 2069 6e20  ion(p) for p in 
-00028910: 706f 6f72 5f69 6e64 6976 6964 7561 6c73  poor_individuals
-00028920: 5d29 0a20 2020 2020 2020 2066 6f72 2069  ]).        for i
-00028930: 2069 6e20 7261 6e67 6528 3329 3a0a 2020   in range(3):.  
-00028940: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00028950: 6e70 2e6d 6561 6e28 676f 6f64 5f70 6561  np.mean(good_pea
-00028960: 7273 6f6e 5f6c 6973 745b 3a2c 2069 5d29  rson_list[:, i])
-00028970: 2c20 6e70 2e6d 6561 6e28 6261 645f 7065  , np.mean(bad_pe
-00028980: 6172 736f 6e5f 6c69 7374 5b3a 2c20 695d  arson_list[:, i]
-00028990: 2929 0a0a 2020 2020 6465 6620 6d75 6c74  ))..    def mult
-000289a0: 696f 626a 6563 7469 7665 5f65 7661 6c75  iobjective_evalu
-000289b0: 6174 696f 6e28 7365 6c66 2c20 746f 6f6c  ation(self, tool
-000289c0: 626f 782c 2070 6f70 756c 6174 696f 6e29  box, population)
-000289d0: 3a0a 2020 2020 2020 2020 6966 2073 656c  :.        if sel
-000289e0: 662e 6261 7365 5f6c 6561 726e 6572 203d  f.base_learner =
-000289f0: 3d20 2752 4454 7e4c 6967 6874 4742 4d2d  = 'RDT~LightGBM-
-00028a00: 5374 756d 7027 3a0a 2020 2020 2020 2020  Stump':.        
-00028a10: 2020 2020 7365 636f 6e64 5f70 6f70 203d      second_pop =
-00028a20: 2063 6f70 792e 6465 6570 636f 7079 2870   copy.deepcopy(p
-00028a30: 6f70 756c 6174 696f 6e29 0a20 2020 2020  opulation).     
-00028a40: 2020 2020 2020 2066 6f72 206f 2069 6e20         for o in 
-00028a50: 706f 7075 6c61 7469 6f6e 3a0a 2020 2020  population:.    
-00028a60: 2020 2020 2020 2020 2020 2020 6f2e 6261              o.ba
-00028a70: 7365 5f6d 6f64 656c 203d 2027 5261 6e64  se_model = 'Rand
-00028a80: 6f6d 2d44 5427 0a20 2020 2020 2020 2020  om-DT'.         
-00028a90: 2020 2066 6f72 206f 2069 6e20 7365 636f     for o in seco
-00028aa0: 6e64 5f70 6f70 3a0a 2020 2020 2020 2020  nd_pop:.        
-00028ab0: 2020 2020 2020 2020 6f2e 6261 7365 5f6d          o.base_m
-00028ac0: 6f64 656c 203d 2027 4c69 6768 7447 424d  odel = 'LightGBM
-00028ad0: 2d53 7475 6d70 270a 0a20 2020 2020 2020  -Stump'..       
-00028ae0: 2073 656c 662e 706f 7075 6c61 7469 6f6e   self.population
-00028af0: 5f65 7661 6c75 6174 696f 6e28 746f 6f6c  _evaluation(tool
-00028b00: 626f 782c 2070 6f70 756c 6174 696f 6e29  box, population)
-00028b10: 0a20 2020 2020 2020 2073 656c 662e 706f  .        self.po
-00028b20: 7075 6c61 7469 6f6e 5f65 7661 6c75 6174  pulation_evaluat
-00028b30: 696f 6e28 746f 6f6c 626f 782c 2073 6563  ion(toolbox, sec
-00028b40: 6f6e 645f 706f 7029 0a20 2020 2020 2020  ond_pop).       
-00028b50: 2070 6f70 756c 6174 696f 6e2e 6578 7465   population.exte
-00028b60: 6e64 2873 6563 6f6e 645f 706f 7029 0a0a  nd(second_pop)..
-00028b70: 2020 2020 2020 2020 666f 7220 6f61 2c20          for oa, 
-00028b80: 6f62 2069 6e20 7a69 7028 706f 7075 6c61  ob in zip(popula
-00028b90: 7469 6f6e 2c20 7365 636f 6e64 5f70 6f70  tion, second_pop
-00028ba0: 293a 0a20 2020 2020 2020 2020 2020 206f  ):.            o
-00028bb0: 612e 6669 746e 6573 732e 7765 6967 6874  a.fitness.weight
-00028bc0: 7320 3d20 282d 312c 202d 3129 0a20 2020  s = (-1, -1).   
-00028bd0: 2020 2020 2020 2020 206f 612e 6669 746e           oa.fitn
-00028be0: 6573 732e 7661 6c75 6573 203d 2028 6f61  ess.values = (oa
-00028bf0: 2e66 6974 6e65 7373 2e76 616c 7565 735b  .fitness.values[
-00028c00: 305d 2c20 6f62 2e66 6974 6e65 7373 2e76  0], ob.fitness.v
-00028c10: 616c 7565 735b 305d 290a 2020 2020 2020  alues[0]).      
-00028c20: 2020 2020 2020 6f62 2e66 6974 6e65 7373        ob.fitness
-00028c30: 2e77 6569 6768 7473 203d 2028 2d31 2c20  .weights = (-1, 
-00028c40: 2d31 290a 2020 2020 2020 2020 2020 2020  -1).            
-00028c50: 6f62 2e66 6974 6e65 7373 2e76 616c 7565  ob.fitness.value
-00028c60: 7320 3d20 286f 612e 6669 746e 6573 732e  s = (oa.fitness.
-00028c70: 7661 6c75 6573 5b30 5d2c 206f 622e 6669  values[0], ob.fi
-00028c80: 746e 6573 732e 7661 6c75 6573 5b30 5d29  tness.values[0])
-00028c90: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00028ca0: 706f 7075 6c61 7469 6f6e 0a0a 2020 2020  population..    
-00028cb0: 6465 6620 6d69 7875 705f 6576 616c 7561  def mixup_evalua
-00028cc0: 7469 6f6e 2873 656c 662c 2074 6f6f 6c62  tion(self, toolb
-00028cd0: 6f78 2c20 706f 7075 6c61 7469 6f6e 293a  ox, population):
-00028ce0: 0a20 2020 2020 2020 2073 656c 662e 6669  .        self.fi
-00028cf0: 6e61 6c5f 6d6f 6465 6c5f 6c61 7a79 5f74  nal_model_lazy_t
-00028d00: 7261 696e 696e 6728 706f 7075 6c61 7469  raining(populati
-00028d10: 6f6e 290a 2020 2020 2020 2020 5820 3d20  on).        X = 
-00028d20: 7365 6c66 2e74 6573 745f 580a 2020 2020  self.test_X.    
-00028d30: 2020 2020 6966 2073 656c 662e 6e6f 726d      if self.norm
-00028d40: 616c 697a 653a 0a20 2020 2020 2020 2020  alize:.         
-00028d50: 2020 2058 203d 2073 656c 662e 785f 7363     X = self.x_sc
-00028d60: 616c 6572 2e74 7261 6e73 666f 726d 2858  aler.transform(X
-00028d70: 290a 2020 2020 2020 2020 666f 7220 696e  ).        for in
-00028d80: 6469 7669 6475 616c 2069 6e20 706f 7075  dividual in popu
-00028d90: 6c61 7469 6f6e 3a0a 2020 2020 2020 2020  lation:.        
-00028da0: 2020 2020 5970 203d 2073 656c 662e 6665      Yp = self.fe
-00028db0: 6174 7572 655f 6765 6e65 7261 7469 6f6e  ature_generation
-00028dc0: 2858 2c20 696e 6469 7669 6475 616c 290a  (X, individual).
-00028dd0: 2020 2020 2020 2020 2020 2020 7072 6564              pred
-00028de0: 6963 7465 6420 3d20 696e 6469 7669 6475  icted = individu
-00028df0: 616c 2e70 6970 652e 7072 6564 6963 7428  al.pipe.predict(
-00028e00: 5970 290a 0a20 2020 2020 2020 2020 2020  Yp)..           
-00028e10: 2069 6e64 6976 6964 7561 6c2e 6669 746e   individual.fitn
-00028e20: 6573 732e 7765 6967 6874 7320 3d20 282d  ess.weights = (-
-00028e30: 312c 202d 3129 0a20 2020 2020 2020 2020  1, -1).         
-00028e40: 2020 2069 6e64 6976 6964 7561 6c2e 6669     individual.fi
-00028e50: 746e 6573 732e 7661 6c75 6573 203d 2028  tness.values = (
-00028e60: 696e 6469 7669 6475 616c 2e66 6974 6e65  individual.fitne
-00028e70: 7373 2e76 616c 7565 735b 305d 2c20 7232  ss.values[0], r2
-00028e80: 5f73 636f 7265 2873 656c 662e 7073 6575  _score(self.pseu
-00028e90: 646f 5f6c 6162 656c 2c20 7072 6564 6963  do_label, predic
-00028ea0: 7465 6429 290a 0a20 2020 2023 2040 7469  ted))..    # @ti
-00028eb0: 6d65 6974 0a20 2020 2064 6566 2070 6f70  meit.    def pop
-00028ec0: 756c 6174 696f 6e5f 6576 616c 7561 7469  ulation_evaluati
-00028ed0: 6f6e 2873 656c 662c 2074 6f6f 6c62 6f78  on(self, toolbox
-00028ee0: 2c20 706f 7075 6c61 7469 6f6e 293a 0a20  , population):. 
-00028ef0: 2020 2020 2020 2023 2069 6e64 6976 6964         # individ
-00028f00: 7561 6c20 6576 616c 7561 7469 6f6e 2074  ual evaluation t
-00028f10: 6173 6b73 2064 6973 7472 6962 7574 696f  asks distributio
-00028f20: 6e0a 2020 2020 2020 2020 696e 7661 6c69  n.        invali
-00028f30: 645f 696e 6420 3d20 5b69 6e64 2066 6f72  d_ind = [ind for
-00028f40: 2069 6e64 2069 6e20 706f 7075 6c61 7469   ind in populati
-00028f50: 6f6e 2069 6620 6e6f 7420 696e 642e 6669  on if not ind.fi
-00028f60: 746e 6573 732e 7661 6c69 645d 0a20 2020  tness.valid].   
-00028f70: 2020 2020 2066 6974 6e65 7373 6573 203d       fitnesses =
-00028f80: 206c 6973 7428 746f 6f6c 626f 782e 6d61   list(toolbox.ma
-00028f90: 7028 746f 6f6c 626f 782e 6576 616c 7561  p(toolbox.evalua
-00028fa0: 7465 2c20 696e 7661 6c69 645f 696e 6429  te, invalid_ind)
-00028fb0: 290a 0a20 2020 2020 2020 2023 2064 6973  )..        # dis
-00028fc0: 7472 6962 7574 6520 7461 736b 730a 2020  tribute tasks.  
-00028fd0: 2020 2020 2020 6966 2073 656c 662e 6e5f        if self.n_
-00028fe0: 7072 6f63 6573 7320 3e20 313a 0a20 2020  process > 1:.   
-00028ff0: 2020 2020 2020 2020 2064 6174 6120 3d20           data = 
-00029000: 5b6e 6578 7428 6629 2066 6f72 2066 2069  [next(f) for f i
-00029010: 6e20 6669 746e 6573 7365 735d 0a20 2020  n fitnesses].   
-00029020: 2020 2020 2020 2020 2072 6573 756c 7473           results
-00029030: 203d 206c 6973 7428 7365 6c66 2e70 6f6f   = list(self.poo
-00029040: 6c2e 6d61 7028 6361 6c63 756c 6174 655f  l.map(calculate_
-00029050: 7363 6f72 652c 2064 6174 6129 290a 2020  score, data)).  
-00029060: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00029070: 2020 2020 2020 2020 7265 7375 6c74 7320          results 
-00029080: 3d20 6c69 7374 286d 6170 286c 616d 6264  = list(map(lambd
-00029090: 6120 663a 2063 616c 6375 6c61 7465 5f73  a f: calculate_s
-000290a0: 636f 7265 286e 6578 7428 6629 292c 2066  core(next(f)), f
-000290b0: 6974 6e65 7373 6573 2929 0a0a 2020 2020  itnesses))..    
-000290c0: 2020 2020 2320 6167 6772 6567 6174 6520      # aggregate 
-000290d0: 7265 7375 6c74 730a 2020 2020 2020 2020  results.        
-000290e0: 666f 7220 696e 642c 2066 6974 2c20 7220  for ind, fit, r 
-000290f0: 696e 207a 6970 2869 6e76 616c 6964 5f69  in zip(invalid_i
-00029100: 6e64 2c20 6669 746e 6573 7365 732c 2072  nd, fitnesses, r
-00029110: 6573 756c 7473 293a 0a20 2020 2020 2020  esults):.       
-00029120: 2020 2020 2076 616c 7565 203d 2066 6974       value = fit
-00029130: 2e73 656e 6428 7229 0a20 2020 2020 2020  .send(r).       
-00029140: 2020 2020 2069 6e64 2e66 6974 6e65 7373       ind.fitness
-00029150: 2e76 616c 7565 7320 3d20 7661 6c75 650a  .values = value.
-00029160: 0a20 2020 2020 2020 2023 2075 7064 6174  .        # updat
-00029170: 696e 6720 616c 6c20 7061 7274 6974 696f  ing all partitio
-00029180: 6e20 7363 6865 6d65 0a20 2020 2020 2020  n scheme.       
-00029190: 2069 6620 7365 6c66 2e62 6173 655f 6c65   if self.base_le
-000291a0: 6172 6e65 7220 3d3d 2027 536f 6674 2d50  arner == 'Soft-P
-000291b0: 4c54 7265 6527 2061 6e64 2073 656c 662e  LTree' and self.
-000291c0: 7368 6172 6564 5f70 6172 7469 7469 6f6e  shared_partition
-000291d0: 5f73 6368 656d 653a 0a20 2020 2020 2020  _scheme:.       
-000291e0: 2020 2020 2070 6172 7469 7469 6f6e 5f73       partition_s
-000291f0: 6368 656d 6520 3d20 6e70 2e7a 6572 6f73  cheme = np.zeros
-00029200: 2828 7365 6c66 2e58 2e73 6861 7065 5b30  ((self.X.shape[0
-00029210: 5d2c 2073 656c 662e 7061 7274 6974 696f  ], self.partitio
-00029220: 6e5f 6e75 6d62 6572 2929 0a20 2020 2020  n_number)).     
-00029230: 2020 2020 2020 2066 6f72 2070 2069 6e20         for p in 
-00029240: 706f 7075 6c61 7469 6f6e 3a0a 2020 2020  population:.    
-00029250: 2020 2020 2020 2020 2020 2020 6173 7365              asse
-00029260: 7274 2070 2e70 6172 7469 7469 6f6e 5f73  rt p.partition_s
-00029270: 6368 656d 652e 7368 6170 655b 305d 203d  cheme.shape[0] =
-00029280: 3d20 7365 6c66 2e58 2e73 6861 7065 5b30  = self.X.shape[0
-00029290: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-000292a0: 2020 6173 7365 7274 206c 656e 2870 2e70    assert len(p.p
-000292b0: 6172 7469 7469 6f6e 5f73 6368 656d 652e  artition_scheme.
-000292c0: 7368 6170 6529 203d 3d20 310a 2020 2020  shape) == 1.    
-000292d0: 2020 2020 2020 2020 2020 2020 702e 7061              p.pa
-000292e0: 7274 6974 696f 6e5f 7363 6865 6d65 203d  rtition_scheme =
-000292f0: 2070 2e70 6172 7469 7469 6f6e 5f73 6368   p.partition_sch
-00029300: 656d 652e 6173 7479 7065 2869 6e74 290a  eme.astype(int).
-00029310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029320: 7061 7274 6974 696f 6e5f 7363 6865 6d65  partition_scheme
-00029330: 5b6e 702e 6172 616e 6765 2873 656c 662e  [np.arange(self.
-00029340: 582e 7368 6170 655b 305d 292c 2070 2e70  X.shape[0]), p.p
-00029350: 6172 7469 7469 6f6e 5f73 6368 656d 655d  artition_scheme]
-00029360: 202b 3d20 310a 2020 2020 2020 2020 2020   += 1.          
-00029370: 2020 7061 7274 6974 696f 6e5f 7363 6865    partition_sche
-00029380: 6d65 203d 2070 6172 7469 7469 6f6e 5f73  me = partition_s
-00029390: 6368 656d 652e 6172 676d 6178 2861 7869  cheme.argmax(axi
-000293a0: 733d 3129 0a20 2020 2020 2020 2020 2020  s=1).           
-000293b0: 2066 6f72 2070 2069 6e20 706f 7075 6c61   for p in popula
-000293c0: 7469 6f6e 3a0a 2020 2020 2020 2020 2020  tion:.          
-000293d0: 2020 2020 2020 702e 7061 7274 6974 696f        p.partitio
-000293e0: 6e5f 7363 6865 6d65 203d 2070 6172 7469  n_scheme = parti
-000293f0: 7469 6f6e 5f73 6368 656d 650a 2020 2020  tion_scheme.    
-00029400: 2020 2020 7265 7475 726e 2069 6e76 616c      return inval
-00029410: 6964 5f69 6e64 0a0a 2020 2020 6465 6620  id_ind..    def 
-00029420: 636f 735f 7369 6d69 6c61 7269 7479 5f63  cos_similarity_c
-00029430: 616c 6375 6c61 7469 6f6e 2873 656c 662c  alculation(self,
-00029440: 2070 6f70 756c 6174 696f 6e3d 4e6f 6e65   population=None
-00029450: 293a 0a20 2020 2020 2020 2069 6e64 7320  ):.        inds 
-00029460: 3d20 7365 6c66 2e67 6574 5f64 6976 6572  = self.get_diver
-00029470: 7369 7479 5f6d 6174 7269 7828 706f 7075  sity_matrix(popu
-00029480: 6c61 7469 6f6e 290a 2020 2020 2020 2020  lation).        
-00029490: 696e 6473 202d 3d20 7365 6c66 2e79 0a20  inds -= self.y. 
-000294a0: 2020 2020 2020 2064 6973 203d 2070 6169         dis = pai
-000294b0: 7277 6973 655f 6469 7374 616e 6365 7328  rwise_distances(
-000294c0: 696e 6473 2c20 6d65 7472 6963 3d27 636f  inds, metric='co
-000294d0: 7369 6e65 2729 0a20 2020 2020 2020 2072  sine').        r
-000294e0: 6574 7572 6e20 6e70 2e6d 6561 6e28 6469  eturn np.mean(di
-000294f0: 7329 0a0a 2020 2020 6465 6620 6469 7665  s)..    def dive
-00029500: 7273 6974 795f 6361 6c63 756c 6174 696f  rsity_calculatio
-00029510: 6e28 7365 6c66 2c20 696e 6469 7669 6475  n(self, individu
-00029520: 616c 733d 4e6f 6e65 293a 0a20 2020 2020  als=None):.     
-00029530: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
-00029540: 616c 6375 6c61 7465 2074 6865 2064 6976  alculate the div
-00029550: 6572 7369 7479 2062 6574 7765 656e 2069  ersity between i
-00029560: 6e64 6976 6964 7561 6c73 0a20 2020 2020  ndividuals.     
-00029570: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
-00029580: 6620 2743 5627 2069 6e20 7365 6c66 2e73  f 'CV' in self.s
-00029590: 636f 7265 5f66 756e 633a 0a20 2020 2020  core_func:.     
-000295a0: 2020 2020 2020 2072 6574 7572 6e20 300a         return 0.
-000295b0: 2020 2020 2020 2020 2320 6469 7374 616e          # distan
-000295c0: 6365 2063 616c 6375 6c61 7469 6f6e 0a20  ce calculation. 
-000295d0: 2020 2020 2020 2069 6620 696e 6469 7669         if indivi
-000295e0: 6475 616c 7320 6973 204e 6f6e 653a 0a20  duals is None:. 
-000295f0: 2020 2020 2020 2020 2020 2069 6e64 6976             indiv
-00029600: 6964 7561 6c73 203d 2073 656c 662e 686f  iduals = self.ho
-00029610: 660a 2020 2020 2020 2020 6966 2073 656c  f.        if sel
-00029620: 662e 7365 636f 6e64 5f6c 6179 6572 2069  f.second_layer i
-00029630: 6e20 5b27 4e6f 6e65 272c 204e 6f6e 652c  n ['None', None,
-00029640: 2027 4341 5750 4527 2c20 2752 6964 6765   'CAWPE', 'Ridge
-00029650: 2d50 7265 6469 6374 696f 6e27 2c20 2752  -Prediction', 'R
-00029660: 462d 526f 7574 696e 6727 5d3a 0a20 2020  F-Routing']:.   
-00029670: 2020 2020 2020 2020 2061 6c6c 5f69 6e64           all_ind
-00029680: 203d 2069 6e64 6976 6964 7561 6c73 0a20   = individuals. 
-00029690: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
-000296a0: 2e73 6563 6f6e 645f 6c61 7965 7220 696e  .second_layer in
-000296b0: 205b 2744 6976 6572 7369 7479 5072 756e   ['DiversityPrun
-000296c0: 6527 2c20 2754 7265 6542 6173 656c 696e  e', 'TreeBaselin
-000296d0: 6527 2c20 2747 4127 5d3a 0a20 2020 2020  e', 'GA']:.     
-000296e0: 2020 2020 2020 2023 2077 6974 6820 736f         # with so
-000296f0: 6d65 2070 7275 6e65 0a20 2020 2020 2020  me prune.       
-00029700: 2020 2020 2069 6620 6e6f 7420 6861 7361       if not hasa
-00029710: 7474 7228 7365 6c66 2c20 2774 7265 655f  ttr(self, 'tree_
-00029720: 7765 6967 6874 2729 3a0a 2020 2020 2020  weight'):.      
-00029730: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00029740: 2030 0a20 2020 2020 2020 2020 2020 2061   0.            a
-00029750: 6c6c 5f69 6e64 203d 206c 6973 7428 6d61  ll_ind = list(ma
-00029760: 7028 6c61 6d62 6461 2078 3a20 785b 315d  p(lambda x: x[1]
-00029770: 2c20 6669 6c74 6572 286c 616d 6264 6120  , filter(lambda 
-00029780: 783a 2073 656c 662e 7472 6565 5f77 6569  x: self.tree_wei
-00029790: 6768 745b 785b 305d 5d20 3e20 302c 2065  ght[x[0]] > 0, e
-000297a0: 6e75 6d65 7261 7465 2869 6e64 6976 6964  numerate(individ
-000297b0: 7561 6c73 2929 2929 0a20 2020 2020 2020  uals)))).       
-000297c0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-000297d0: 2020 2072 6169 7365 2045 7863 6570 7469     raise Excepti
-000297e0: 6f6e 0a20 2020 2020 2020 2069 6e64 7320  on.        inds 
-000297f0: 3d20 7365 6c66 2e67 6574 5f64 6976 6572  = self.get_diver
-00029800: 7369 7479 5f6d 6174 7269 7828 616c 6c5f  sity_matrix(all_
-00029810: 696e 6429 0a20 2020 2020 2020 2064 6973  ind).        dis
-00029820: 203d 2070 6169 7277 6973 655f 6469 7374   = pairwise_dist
-00029830: 616e 6365 7328 696e 6473 290a 2020 2020  ances(inds).    
-00029840: 2020 2020 7265 7475 726e 206e 702e 6d65      return np.me
-00029850: 616e 2864 6973 290a 0a20 2020 2064 6566  an(dis)..    def
-00029860: 2067 6574 5f64 6976 6572 7369 7479 5f6d   get_diversity_m
-00029870: 6174 7269 7828 7365 6c66 2c20 616c 6c5f  atrix(self, all_
-00029880: 696e 6429 3a0a 2020 2020 2020 2020 696e  ind):.        in
-00029890: 6473 203d 205b 5d0a 2020 2020 2020 2020  ds = [].        
-000298a0: 666f 7220 7020 696e 2061 6c6c 5f69 6e64  for p in all_ind
-000298b0: 3a0a 2020 2020 2020 2020 2020 2020 696e  :.            in
-000298c0: 6473 2e61 7070 656e 6428 702e 7072 6564  ds.append(p.pred
-000298d0: 6963 7465 645f 7661 6c75 6573 2e66 6c61  icted_values.fla
-000298e0: 7474 656e 2829 290a 2020 2020 2020 2020  tten()).        
-000298f0: 696e 6473 203d 206e 702e 6172 7261 7928  inds = np.array(
-00029900: 696e 6473 290a 2020 2020 2020 2020 7265  inds).        re
-00029910: 7475 726e 2069 6e64 730a 0a20 2020 2064  turn inds..    d
-00029920: 6566 2064 6976 6572 7369 7479 5f61 7373  ef diversity_ass
-00029930: 6967 6e6d 656e 7428 7365 6c66 2c20 706f  ignment(self, po
-00029940: 7075 6c61 7469 6f6e 293a 0a20 2020 2020  pulation):.     
-00029950: 2020 2023 2064 6973 7461 6e63 6520 6361     # distance ca
-00029960: 6c63 756c 6174 696f 6e0a 2020 2020 2020  lculation.      
-00029970: 2020 696e 6473 203d 2073 656c 662e 6765    inds = self.ge
-00029980: 745f 6469 7665 7273 6974 795f 6d61 7472  t_diversity_matr
-00029990: 6978 2870 6f70 756c 6174 696f 6e29 0a0a  ix(population)..
-000299a0: 2020 2020 2020 2020 686f 665f 696e 6473          hof_inds
-000299b0: 203d 205b 5d0a 2020 2020 2020 2020 706f   = [].        po
-000299c0: 7020 3d20 7b0a 2020 2020 2020 2020 2020  p = {.          
-000299d0: 2020 2750 6f70 273a 2073 656c 662e 706f    'Pop': self.po
-000299e0: 702c 0a20 2020 2020 2020 2020 2020 2027  p,.            '
-000299f0: 4172 6368 6976 6527 3a20 7365 6c66 2e68  Archive': self.h
-00029a00: 6f66 2c0a 2020 2020 2020 2020 2020 2020  of,.            
-00029a10: 2750 6f70 2b41 7263 6869 7665 273a 206c  'Pop+Archive': l
-00029a20: 6973 7428 7365 6c66 2e70 6f70 2920 2b20  ist(self.pop) + 
-00029a30: 6c69 7374 2873 656c 662e 686f 6629 2c0a  list(self.hof),.
-00029a40: 2020 2020 2020 2020 7d5b 7365 6c66 2e64          }[self.d
-00029a50: 6976 6572 7369 7479 5f73 6561 7263 685d  iversity_search]
-00029a60: 0a20 2020 2020 2020 2066 6f72 2070 2069  .        for p i
-00029a70: 6e20 706f 703a 0a20 2020 2020 2020 2020  n pop:.         
-00029a80: 2020 2068 6f66 5f69 6e64 732e 6170 7065     hof_inds.appe
-00029a90: 6e64 2870 2e70 7265 6469 6374 6564 5f76  nd(p.predicted_v
-00029aa0: 616c 7565 732e 666c 6174 7465 6e28 2929  alues.flatten())
-00029ab0: 0a20 2020 2020 2020 2068 6f66 5f69 6e64  .        hof_ind
-00029ac0: 7320 3d20 6e70 2e61 7272 6179 2868 6f66  s = np.array(hof
-00029ad0: 5f69 6e64 7329 0a20 2020 2020 2020 2066  _inds).        f
-00029ae0: 6f72 2069 6e64 6578 2c20 696e 6420 696e  or index, ind in
-00029af0: 2065 6e75 6d65 7261 7465 2870 6f70 756c   enumerate(popul
-00029b00: 6174 696f 6e29 3a0a 2020 2020 2020 2020  ation):.        
-00029b10: 2020 2020 6469 7374 616e 6365 203d 202d      distance = -
-00029b20: 6e70 2e73 7172 7428 6e70 2e73 756d 2828  np.sqrt(np.sum((
-00029b30: 696e 6473 5b69 6e64 6578 5d20 2d20 686f  inds[index] - ho
-00029b40: 665f 696e 6473 2920 2a2a 2032 2c20 6178  f_inds) ** 2, ax
-00029b50: 6973 3d30 2929 0a20 2020 2020 2020 2020  is=0)).         
-00029b60: 2020 2069 6620 6c65 6e28 696e 642e 6361     if len(ind.ca
-00029b70: 7365 5f76 616c 7565 7329 203d 3d20 6c65  se_values) == le
-00029b80: 6e28 7365 6c66 2e79 293a 0a20 2020 2020  n(self.y):.     
-00029b90: 2020 2020 2020 2020 2020 2069 6e64 2e63             ind.c
-00029ba0: 6173 655f 7661 6c75 6573 203d 206e 702e  ase_values = np.
-00029bb0: 636f 6e63 6174 656e 6174 6528 5b69 6e64  concatenate([ind
-00029bc0: 2e63 6173 655f 7661 6c75 6573 2c20 6469  .case_values, di
-00029bd0: 7374 616e 6365 5d2c 2061 7869 733d 3029  stance], axis=0)
-00029be0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00029bf0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00029c00: 2020 2069 6e64 2e63 6173 655f 7661 6c75     ind.case_valu
-00029c10: 6573 5b6c 656e 2873 656c 662e 7929 3a5d  es[len(self.y):]
-00029c20: 203d 2064 6973 7461 6e63 650a 0a20 2020   = distance..   
-00029c30: 2064 6566 2063 6f6d 706c 6578 6974 7928   def complexity(
-00029c40: 7365 6c66 293a 0a20 2020 2020 2020 2063  self):.        c
-00029c50: 6f75 6e74 203d 2030 0a20 2020 2020 2020  ount = 0.       
-00029c60: 2023 2063 6f75 6e74 2047 5020 636f 6d70   # count GP comp
-00029c70: 6c65 7869 7479 0a20 2020 2020 2020 2066  lexity.        f
-00029c80: 6f72 2068 2069 6e20 7365 6c66 2e68 6f66  or h in self.hof
-00029c90: 3a0a 2020 2020 2020 2020 2020 2020 683a  :.            h:
-00029ca0: 204d 756c 7469 706c 6547 656e 6547 500a   MultipleGeneGP.
-00029cb0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00029cc0: 7820 696e 2068 2e67 656e 653a 0a20 2020  x in h.gene:.   
-00029cd0: 2020 2020 2020 2020 2020 2020 2063 6f75               cou
-00029ce0: 6e74 202b 3d20 6c65 6e28 7829 0a0a 2020  nt += len(x)..  
-00029cf0: 2020 2020 2020 2020 2020 2320 636f 756e            # coun
-00029d00: 7420 4261 7365 204d 6f64 656c 2043 6f6d  t Base Model Com
-00029d10: 706c 6578 6974 790a 2020 2020 2020 2020  plexity.        
-00029d20: 2020 2020 6c65 6172 6e65 7220 3d20 682e      learner = h.
-00029d30: 7069 7065 5b27 5269 6467 6527 5d0a 2020  pipe['Ridge'].  
-00029d40: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
-00029d50: 6e73 7461 6e63 6528 6c65 6172 6e65 722c  nstance(learner,
-00029d60: 2044 6563 6973 696f 6e54 7265 6552 6567   DecisionTreeReg
-00029d70: 7265 7373 6f72 293a 0a20 2020 2020 2020  ressor):.       
-00029d80: 2020 2020 2020 2020 2063 6f75 6e74 202b           count +
-00029d90: 3d20 6c65 6172 6e65 722e 7472 6565 5f2e  = learner.tree_.
-00029da0: 6e6f 6465 5f63 6f75 6e74 0a20 2020 2020  node_count.     
-00029db0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-00029dc0: 616e 6365 286c 6561 726e 6572 2c20 536f  ance(learner, So
-00029dd0: 6674 504c 5472 6565 5265 6772 6573 736f  ftPLTreeRegresso
-00029de0: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
-00029df0: 2020 2020 636f 756e 7420 2b3d 206c 6561      count += lea
-00029e00: 726e 6572 2e63 6f6d 706c 6578 6974 7928  rner.complexity(
-00029e10: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00029e20: 2063 6f75 6e74 0a0a 0a63 6c61 7373 2045   count...class E
-00029e30: 766f 6c75 7469 6f6e 6172 7946 6f72 6573  volutionaryFores
-00029e40: 7443 6c61 7373 6966 6965 7228 436c 6173  tClassifier(Clas
-00029e50: 7369 6669 6572 4d69 7869 6e2c 2045 766f  sifierMixin, Evo
-00029e60: 6c75 7469 6f6e 6172 7946 6f72 6573 7452  lutionaryForestR
-00029e70: 6567 7265 7373 6f72 293a 0a20 2020 2064  egressor):.    d
-00029e80: 6566 205f 5f69 6e69 745f 5f28 7365 6c66  ef __init__(self
-00029e90: 2c20 7363 6f72 655f 6675 6e63 3d27 5a65  , score_func='Ze
-00029ea0: 726f 4f6e 6527 2c20 2a2a 7061 7261 6d29  roOne', **param)
-00029eb0: 3a0a 2020 2020 2020 2020 7375 7065 7228  :.        super(
-00029ec0: 292e 5f5f 696e 6974 5f5f 2873 636f 7265  ).__init__(score
-00029ed0: 5f66 756e 633d 7363 6f72 655f 6675 6e63  _func=score_func
-00029ee0: 2c20 2a2a 7061 7261 6d29 0a20 2020 2020  , **param).     
-00029ef0: 2020 2073 656c 662e 795f 7363 616c 6572     self.y_scaler
-00029f00: 203d 2044 756d 6d79 5472 616e 7366 6f72   = DummyTransfor
-00029f10: 6d65 7228 290a 2020 2020 2020 2020 6966  mer().        if
-00029f20: 2073 656c 662e 6261 7365 5f6c 6561 726e   self.base_learn
-00029f30: 6572 203d 3d20 2748 7962 7269 6427 3a0a  er == 'Hybrid':.
-00029f40: 2020 2020 2020 2020 2020 2020 636f 6e66              conf
-00029f50: 6967 5f64 6963 7420 3d20 7b0a 2020 2020  ig_dict = {.    
-00029f60: 2020 2020 2020 2020 2020 2020 2773 6b6c              'skl
-00029f70: 6561 726e 2e6c 696e 6561 725f 6d6f 6465  earn.linear_mode
-00029f80: 6c2e 4c6f 6769 7374 6963 5265 6772 6573  l.LogisticRegres
-00029f90: 7369 6f6e 273a 207b 0a20 2020 2020 2020  sion': {.       
-00029fa0: 2020 2020 2020 2020 2020 2020 2027 7065               'pe
-00029fb0: 6e61 6c74 7927 3a20 5b22 6c32 225d 2c0a  nalty': ["l2"],.
-00029fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029fd0: 2020 2020 2743 273a 205b 3165 2d34 2c20      'C': [1e-4, 
-00029fe0: 3165 2d33 2c20 3165 2d32 2c20 3165 2d31  1e-3, 1e-2, 1e-1
-00029ff0: 2c20 302e 352c 2031 2e2c 2035 2e2c 2031  , 0.5, 1., 5., 1
-0002a000: 302e 2c20 3135 2e2c 2032 302e 2c20 3235  0., 15., 20., 25
-0002a010: 2e5d 2c0a 2020 2020 2020 2020 2020 2020  .],.            
-0002a020: 2020 2020 2020 2020 2773 6f6c 7665 7227          'solver'
-0002a030: 3a20 5b27 6c69 626c 696e 6561 7227 5d2c  : ['liblinear'],
-0002a040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002a050: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
-0002a060: 2020 2020 2773 6b6c 6561 726e 2e74 7265      'sklearn.tre
-0002a070: 652e 4465 6369 7369 6f6e 5472 6565 436c  e.DecisionTreeCl
-0002a080: 6173 7369 6669 6572 273a 207b 0a20 2020  assifier': {.   
-0002a090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a0a0: 2027 6372 6974 6572 696f 6e27 3a20 5b22   'criterion': ["
-0002a0b0: 6769 6e69 222c 2022 656e 7472 6f70 7922  gini", "entropy"
+00027e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027e10: 2020 2020 2020 2020 2020 2020 2072 6576               rev
+00027e20: 6572 7365 3d54 7275 6529 5b3a 6e75 6d5f  erse=True)[:num_
+00027e30: 746f 705f 696e 6469 7669 6475 616c 735d  top_individuals]
+00027e40: 5d29 0a20 2020 2020 2020 2072 6574 7572  ]).        retur
+00027e50: 6e20 705f 7661 6c75 655b 315d 0a0a 2020  n p_value[1]..  
+00027e60: 2020 6465 6620 6765 745f 7661 6c69 6461    def get_valida
+00027e70: 7469 6f6e 5f73 636f 7265 2873 656c 662c  tion_score(self,
+00027e80: 2062 6573 745f 696e 6469 7669 6475 616c   best_individual
+00027e90: 2c20 666f 7263 655f 7472 6169 6e69 6e67  , force_training
+00027ea0: 3d46 616c 7365 293a 0a20 2020 2020 2020  =False):.       
+00027eb0: 2073 656c 662e 6669 6e61 6c5f 6d6f 6465   self.final_mode
+00027ec0: 6c5f 6c61 7a79 5f74 7261 696e 696e 6728  l_lazy_training(
+00027ed0: 5b62 6573 745f 696e 6469 7669 6475 616c  [best_individual
+00027ee0: 5d2c 2066 6f72 6365 5f74 7261 696e 696e  ], force_trainin
+00027ef0: 673d 666f 7263 655f 7472 6169 6e69 6e67  g=force_training
+00027f00: 290a 2020 2020 2020 2020 7061 7265 6e74  ).        parent
+00027f10: 5f69 6e70 7574 203d 2073 656c 662e 6665  _input = self.fe
+00027f20: 6174 7572 655f 6765 6e65 7261 7469 6f6e  ature_generation
+00027f30: 2873 656c 662e 7661 6c69 645f 782c 2062  (self.valid_x, b
+00027f40: 6573 745f 696e 6469 7669 6475 616c 290a  est_individual).
+00027f50: 2020 2020 2020 2020 7363 6f72 6520 3d20          score = 
+00027f60: 7232 5f73 636f 7265 2873 656c 662e 7661  r2_score(self.va
+00027f70: 6c69 645f 792c 2062 6573 745f 696e 6469  lid_y, best_indi
+00027f80: 7669 6475 616c 2e70 6970 652e 7072 6564  vidual.pipe.pred
+00027f90: 6963 7428 7061 7265 6e74 5f69 6e70 7574  ict(parent_input
+00027fa0: 2929 0a20 2020 2020 2020 2072 6574 7572  )).        retur
+00027fb0: 6e20 7363 6f72 650a 0a20 2020 2064 6566  n score..    def
+00027fc0: 206c 696e 6561 725f 6164 6170 7469 7665   linear_adaptive
+00027fd0: 5f72 6174 6528 7365 6c66 2c20 6765 6e2c  _rate(self, gen,
+00027fe0: 2063 7870 622c 206d 7574 7062 293a 0a20   cxpb, mutpb):. 
+00027ff0: 2020 2020 2020 2069 6620 7365 6c66 2e63         if self.c
+00028000: 726f 7373 5f70 6220 3d3d 2027 4c69 6e65  ross_pb == 'Line
+00028010: 6172 273a 0a20 2020 2020 2020 2020 2020  ar':.           
+00028020: 2063 7870 6220 3d20 6e70 2e69 6e74 6572   cxpb = np.inter
+00028030: 7028 6e70 2e61 7261 6e67 6528 302c 2073  p(np.arange(0, s
+00028040: 656c 662e 6e5f 6765 6e29 2c20 5b30 2c20  elf.n_gen), [0, 
+00028050: 7365 6c66 2e6e 5f67 656e 202d 2031 5d2c  self.n_gen - 1],
+00028060: 205b 302e 392c 2030 2e35 5d29 5b67 656e   [0.9, 0.5])[gen
+00028070: 202d 2031 5d0a 2020 2020 2020 2020 6966   - 1].        if
+00028080: 2073 656c 662e 6d75 7461 7469 6f6e 5f70   self.mutation_p
+00028090: 6220 3d3d 2027 4c69 6e65 6172 273a 0a20  b == 'Linear':. 
+000280a0: 2020 2020 2020 2020 2020 206d 7574 7062             mutpb
+000280b0: 203d 206e 702e 696e 7465 7270 286e 702e   = np.interp(np.
+000280c0: 6172 616e 6765 2830 2c20 7365 6c66 2e6e  arange(0, self.n
+000280d0: 5f67 656e 292c 205b 302c 2073 656c 662e  _gen), [0, self.
+000280e0: 6e5f 6765 6e20 2d20 315d 2c20 5b30 2e31  n_gen - 1], [0.1
+000280f0: 2c20 302e 355d 295b 6765 6e20 2d20 315d  , 0.5])[gen - 1]
+00028100: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00028110: 6378 7062 2c20 6d75 7470 620a 0a20 2020  cxpb, mutpb..   
+00028120: 2064 6566 2067 6574 5f61 6461 7074 6976   def get_adaptiv
+00028130: 655f 7062 5f61 7272 6179 2873 656c 662c  e_pb_array(self,
+00028140: 2070 726f 6261 6269 6c69 7479 2c20 696e   probability, in
+00028150: 7665 7273 653d 4661 6c73 6529 3a0a 2020  verse=False):.  
+00028160: 2020 2020 2020 7072 6f62 6162 696c 6974        probabilit
+00028170: 7920 3d20 666c 6f61 7428 7072 6f62 6162  y = float(probab
+00028180: 696c 6974 792e 7265 706c 6163 6528 2749  ility.replace('I
+00028190: 6e76 6572 7365 4164 6170 7469 7665 2d27  nverseAdaptive-'
+000281a0: 2c20 2727 292e 7265 706c 6163 6528 2741  , '').replace('A
+000281b0: 6461 7074 6976 652d 272c 2027 2729 290a  daptive-', '')).
+000281c0: 2020 2020 2020 2020 756e 6971 7565 5f68          unique_h
+000281d0: 6173 6820 3d20 5b6c 656e 286e 702e 756e  ash = [len(np.un
+000281e0: 6971 7565 285b 6f2e 6861 7368 5f72 6573  ique([o.hash_res
+000281f0: 756c 745b 695d 2066 6f72 206f 2069 6e20  ult[i] for o in 
+00028200: 7365 6c66 2e70 6f70 5d29 2920 666f 7220  self.pop])) for 
+00028210: 6920 696e 2072 616e 6765 2873 656c 662e  i in range(self.
+00028220: 6765 6e65 5f6e 756d 295d 0a20 2020 2020  gene_num)].     
+00028230: 2020 2070 726f 6261 6269 6c69 7479 203d     probability =
+00028240: 2063 726f 7373 5f73 6361 6c65 2875 6e69   cross_scale(uni
+00028250: 7175 655f 6861 7368 2c20 7072 6f62 6162  que_hash, probab
+00028260: 696c 6974 792c 2069 6e76 6572 7365 3d69  ility, inverse=i
+00028270: 6e76 6572 7365 290a 2020 2020 2020 2020  nverse).        
+00028280: 7265 7475 726e 2070 726f 6261 6269 6c69  return probabili
+00028290: 7479 0a0a 2020 2020 6465 6620 6765 745f  ty..    def get_
+000282a0: 6164 6170 7469 7665 5f6d 7574 6174 696f  adaptive_mutatio
+000282b0: 6e5f 7261 7465 2873 656c 662c 2063 7870  n_rate(self, cxp
+000282c0: 622c 206d 7574 7062 293a 0a20 2020 2020  b, mutpb):.     
+000282d0: 2020 2069 6620 7365 6c66 2e6d 6770 5f6d     if self.mgp_m
+000282e0: 6f64 653a 0a20 2020 2020 2020 2020 2020  ode:.           
+000282f0: 2069 6620 6973 696e 7374 616e 6365 2873   if isinstance(s
+00028300: 656c 662e 6372 6f73 735f 7062 2c20 7374  elf.cross_pb, st
+00028310: 7229 2061 6e64 2073 656c 662e 6372 6f73  r) and self.cros
+00028320: 735f 7062 2e73 7461 7274 7377 6974 6828  s_pb.startswith(
+00028330: 2741 6461 7074 6976 6527 293a 0a20 2020  'Adaptive'):.   
+00028340: 2020 2020 2020 2020 2020 2020 2063 7870               cxp
+00028350: 6220 3d20 7365 6c66 2e67 6574 5f61 6461  b = self.get_ada
+00028360: 7074 6976 655f 7062 5f61 7272 6179 2873  ptive_pb_array(s
+00028370: 656c 662e 6372 6f73 735f 7062 290a 2020  elf.cross_pb).  
+00028380: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
+00028390: 6e73 7461 6e63 6528 7365 6c66 2e6d 7574  nstance(self.mut
+000283a0: 6174 696f 6e5f 7062 2c20 7374 7229 2061  ation_pb, str) a
+000283b0: 6e64 2073 656c 662e 6d75 7461 7469 6f6e  nd self.mutation
+000283c0: 5f70 622e 7374 6172 7473 7769 7468 2827  _pb.startswith('
+000283d0: 4164 6170 7469 7665 2729 3a0a 2020 2020  Adaptive'):.    
+000283e0: 2020 2020 2020 2020 2020 2020 6d75 7470              mutp
+000283f0: 6220 3d20 7365 6c66 2e67 6574 5f61 6461  b = self.get_ada
+00028400: 7074 6976 655f 7062 5f61 7272 6179 2873  ptive_pb_array(s
+00028410: 656c 662e 6d75 7461 7469 6f6e 5f70 6229  elf.mutation_pb)
+00028420: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00028430: 2069 7369 6e73 7461 6e63 6528 7365 6c66   isinstance(self
+00028440: 2e63 726f 7373 5f70 622c 2073 7472 2920  .cross_pb, str) 
+00028450: 616e 6420 7365 6c66 2e63 726f 7373 5f70  and self.cross_p
+00028460: 622e 7374 6172 7473 7769 7468 2827 496e  b.startswith('In
+00028470: 7665 7273 6541 6461 7074 6976 6527 293a  verseAdaptive'):
+00028480: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028490: 2063 7870 6220 3d20 7365 6c66 2e67 6574   cxpb = self.get
+000284a0: 5f61 6461 7074 6976 655f 7062 5f61 7272  _adaptive_pb_arr
+000284b0: 6179 2873 656c 662e 6372 6f73 735f 7062  ay(self.cross_pb
+000284c0: 2c20 696e 7665 7273 653d 5472 7565 290a  , inverse=True).
+000284d0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+000284e0: 7369 6e73 7461 6e63 6528 7365 6c66 2e6d  sinstance(self.m
+000284f0: 7574 6174 696f 6e5f 7062 2c20 7374 7229  utation_pb, str)
+00028500: 2061 6e64 2073 656c 662e 6d75 7461 7469   and self.mutati
+00028510: 6f6e 5f70 622e 7374 6172 7473 7769 7468  on_pb.startswith
+00028520: 2827 496e 7665 7273 6541 6461 7074 6976  ('InverseAdaptiv
+00028530: 6527 293a 0a20 2020 2020 2020 2020 2020  e'):.           
+00028540: 2020 2020 206d 7574 7062 203d 2073 656c       mutpb = sel
+00028550: 662e 6765 745f 6164 6170 7469 7665 5f70  f.get_adaptive_p
+00028560: 625f 6172 7261 7928 7365 6c66 2e6d 7574  b_array(self.mut
+00028570: 6174 696f 6e5f 7062 2c20 696e 7665 7273  ation_pb, invers
+00028580: 653d 5472 7565 290a 2020 2020 2020 2020  e=True).        
+00028590: 2020 2020 6966 2073 656c 662e 7061 7261      if self.para
+000285a0: 6d2e 6765 7428 2772 6563 6f72 645f 7472  m.get('record_tr
+000285b0: 6169 6e69 6e67 5f64 6174 6127 2c20 4661  aining_data', Fa
+000285c0: 6c73 6529 2061 6e64 2069 7369 6e73 7461  lse) and isinsta
+000285d0: 6e63 6528 6378 7062 2c20 286c 6973 742c  nce(cxpb, (list,
+000285e0: 206e 702e 6e64 6172 7261 7929 293a 0a20   np.ndarray)):. 
+000285f0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00028600: 2069 6620 7072 6f62 6162 696c 6974 7920   if probability 
+00028610: 6973 2061 206c 6973 7420 6f72 2061 6e20  is a list or an 
+00028620: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
+00028630: 2020 2020 2020 7365 6c66 2e61 6461 7074        self.adapt
+00028640: 6976 655f 7072 6f62 6162 696c 6974 795f  ive_probability_
+00028650: 6869 7374 6f72 795b 305d 2e61 7070 656e  history[0].appen
+00028660: 6428 6378 7062 5b30 5d29 0a20 2020 2020  d(cxpb[0]).     
+00028670: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00028680: 6164 6170 7469 7665 5f70 726f 6261 6269  adaptive_probabi
+00028690: 6c69 7479 5f68 6973 746f 7279 5b31 5d2e  lity_history[1].
+000286a0: 6170 7065 6e64 2863 7870 625b 2d31 5d29  append(cxpb[-1])
+000286b0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+000286c0: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+000286d0: 696e 7374 616e 6365 2873 656c 662e 6372  instance(self.cr
+000286e0: 6f73 735f 7062 2c20 7374 7229 3a0a 2020  oss_pb, str):.  
+000286f0: 2020 2020 2020 2020 2020 2020 2020 6378                cx
+00028700: 7062 203d 2066 6c6f 6174 2873 656c 662e  pb = float(self.
+00028710: 6372 6f73 735f 7062 2e72 6570 6c61 6365  cross_pb.replace
+00028720: 2827 496e 7665 7273 6541 6461 7074 6976  ('InverseAdaptiv
+00028730: 652d 272c 2027 2729 2e72 6570 6c61 6365  e-', '').replace
+00028740: 2827 4164 6170 7469 7665 2d27 2c20 2727  ('Adaptive-', ''
+00028750: 2929 0a20 2020 2020 2020 2020 2020 2069  )).            i
+00028760: 6620 6973 696e 7374 616e 6365 2873 656c  f isinstance(sel
+00028770: 662e 6d75 7461 7469 6f6e 5f70 622c 2073  f.mutation_pb, s
+00028780: 7472 293a 0a20 2020 2020 2020 2020 2020  tr):.           
+00028790: 2020 2020 206d 7574 7062 203d 2066 6c6f       mutpb = flo
+000287a0: 6174 2873 656c 662e 6d75 7461 7469 6f6e  at(self.mutation
+000287b0: 5f70 622e 7265 706c 6163 6528 2749 6e76  _pb.replace('Inv
+000287c0: 6572 7365 4164 6170 7469 7665 2d27 2c20  erseAdaptive-', 
+000287d0: 2727 292e 7265 706c 6163 6528 2741 6461  '').replace('Ada
+000287e0: 7074 6976 652d 272c 2027 2729 290a 2020  ptive-', '')).  
+000287f0: 2020 2020 2020 7265 7475 726e 2063 7870        return cxp
+00028800: 622c 206d 7574 7062 0a0a 2020 2020 6465  b, mutpb..    de
+00028810: 6620 7375 6274 7265 655f 6170 7072 6f78  f subtree_approx
+00028820: 696d 6174 696f 6e28 7365 6c66 2c20 2a70  imation(self, *p
+00028830: 6f70 756c 6174 696f 6e29 3a0a 2020 2020  opulation):.    
+00028840: 2020 2020 746f 6f6c 626f 7820 3d20 7365      toolbox = se
+00028850: 6c66 2e74 6f6f 6c62 6f78 0a20 2020 2020  lf.toolbox.     
+00028860: 2020 206d 6561 6e5f 7369 7a65 203d 206e     mean_size = n
+00028870: 702e 6d65 616e 285b 6c65 6e28 702e 6765  p.mean([len(p.ge
+00028880: 6e65 2920 666f 7220 7020 696e 2070 6f70  ne) for p in pop
+00028890: 756c 6174 696f 6e5d 290a 2020 2020 2020  ulation]).      
+000288a0: 2020 666f 7220 7020 696e 2070 6f70 756c    for p in popul
+000288b0: 6174 696f 6e3a 0a20 2020 2020 2020 2020  ation:.         
+000288c0: 2020 2066 6f72 2067 2069 6e20 702e 6765     for g in p.ge
+000288d0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+000288e0: 2020 2020 6966 206c 656e 2867 2920 3e20      if len(g) > 
+000288f0: 6d65 616e 5f73 697a 653a 0a20 2020 2020  mean_size:.     
+00028900: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00028910: 6e64 6578 203d 2072 616e 646f 6d2e 7261  ndex = random.ra
+00028920: 6e64 7261 6e67 6528 6c65 6e28 6729 290a  ndrange(len(g)).
+00028930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028940: 2020 2020 736c 6963 655f 203d 2067 2e73      slice_ = g.s
+00028950: 6561 7263 6853 7562 7472 6565 2869 6e64  earchSubtree(ind
+00028960: 6578 290a 2020 2020 2020 2020 2020 2020  ex).            
+00028970: 2020 2020 2020 2020 6966 2073 6c69 6365          if slice
+00028980: 5f2e 7374 6f70 202d 2073 6c69 6365 5f2e  _.stop - slice_.
+00028990: 7374 6172 7420 3c3d 2033 3a0a 2020 2020  start <= 3:.    
+000289a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000289b0: 2020 2020 636f 6e74 696e 7565 0a20 2020      continue.   
+000289c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000289d0: 2074 7970 655f 203d 2067 5b69 6e64 6578   type_ = g[index
+000289e0: 5d2e 7265 740a 2020 2020 2020 2020 2020  ].ret.          
+000289f0: 2020 2020 2020 2020 2020 6f6c 645f 7920            old_y 
+00028a00: 3d20 7175 6963 6b5f 6576 616c 7561 7465  = quick_evaluate
+00028a10: 2867 5b73 6c69 6365 5f5d 2c20 7365 6c66  (g[slice_], self
+00028a20: 2e70 7365 742c 2073 656c 662e 5829 0a20  .pset, self.X). 
+00028a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028a40: 2020 206f 6c64 5f79 203d 2071 7569 636b     old_y = quick
+00028a50: 5f66 696c 6c28 5b6f 6c64 5f79 5d2c 2073  _fill([old_y], s
+00028a60: 656c 662e 7929 5b30 5d0a 2020 2020 2020  elf.y)[0].      
+00028a70: 2020 2020 2020 2020 2020 2020 2020 6e65                ne
+00028a80: 775f 696e 6420 3d20 4e6f 6e65 0a20 2020  w_ind = None.   
+00028a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028aa0: 2023 2031 3030 3020 7472 6169 6c73 0a20   # 1000 trails. 
+00028ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028ac0: 2020 2066 6f72 205f 2069 6e20 7261 6e67     for _ in rang
+00028ad0: 6528 302c 2031 3030 3029 3a0a 2020 2020  e(0, 1000):.    
+00028ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028af0: 2020 2020 6e65 775f 696e 6420 3d20 746f      new_ind = to
+00028b00: 6f6c 626f 782e 6578 7072 5f6d 7574 2870  olbox.expr_mut(p
+00028b10: 7365 743d 7365 6c66 2e70 7365 742c 2074  set=self.pset, t
+00028b20: 7970 655f 3d74 7970 655f 290a 2020 2020  ype_=type_).    
+00028b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028b40: 2020 2020 6966 206c 656e 286e 6577 5f69      if len(new_i
+00028b50: 6e64 2920 3c20 736c 6963 655f 2e73 746f  nd) < slice_.sto
+00028b60: 7020 2d20 736c 6963 655f 2e73 7461 7274  p - slice_.start
+00028b70: 202d 2032 3a0a 2020 2020 2020 2020 2020   - 2:.          
+00028b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028b90: 2020 6272 6561 6b0a 2020 2020 2020 2020    break.        
+00028ba0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00028bb0: 6577 5f69 6e64 2069 7320 6e6f 7420 4e6f  ew_ind is not No
+00028bc0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00028bd0: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
+00028be0: 7920 3d20 7175 6963 6b5f 6576 616c 7561  y = quick_evalua
+00028bf0: 7465 286e 6577 5f69 6e64 2c20 7365 6c66  te(new_ind, self
+00028c00: 2e70 7365 742c 2073 656c 662e 5829 0a20  .pset, self.X). 
+00028c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028c20: 2020 2020 2020 206e 6577 5f79 203d 2071         new_y = q
+00028c30: 7569 636b 5f66 696c 6c28 5b6e 6577 5f79  uick_fill([new_y
+00028c40: 5d2c 2073 656c 662e 7929 5b30 5d0a 2020  ], self.y)[0].  
+00028c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028c60: 2020 2020 2020 7468 6574 6120 3d20 6e70        theta = np
+00028c70: 2e64 6f74 286e 6577 5f79 2c20 6f6c 645f  .dot(new_y, old_
+00028c80: 7929 202f 206e 702e 646f 7428 6e65 775f  y) / np.dot(new_
+00028c90: 792c 206e 6577 5f79 290a 2020 2020 2020  y, new_y).      
+00028ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028cb0: 2020 6e65 775f 696e 642e 696e 7365 7274    new_ind.insert
+00028cc0: 2830 2c20 7365 6c66 2e70 7365 742e 6d61  (0, self.pset.ma
+00028cd0: 7070 696e 675b 224d 756c 225d 290a 2020  pping["Mul"]).  
+00028ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028cf0: 2020 2020 2020 6e65 775f 696e 642e 696e        new_ind.in
+00028d00: 7365 7274 2831 2c20 5465 726d 696e 616c  sert(1, Terminal
+00028d10: 2874 6865 7461 2c20 4661 6c73 652c 206f  (theta, False, o
+00028d20: 626a 6563 7429 290a 2020 2020 2020 2020  bject)).        
+00028d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028d40: 675b 736c 6963 655f 5d20 3d20 6e65 775f  g[slice_] = new_
+00028d50: 696e 640a 2020 2020 2020 2020 7265 7475  ind.        retu
+00028d60: 726e 2070 6f70 756c 6174 696f 6e0a 0a20  rn population.. 
+00028d70: 2020 2064 6566 2068 6173 685f 6261 7365     def hash_base
+00028d80: 645f 7369 6d70 6c69 6669 6361 7469 6f6e  d_simplification
+00028d90: 2873 656c 662c 2070 6f70 756c 6174 696f  (self, populatio
+00028da0: 6e2c 2073 696d 706c 6966 6963 6174 696f  n, simplificatio
+00028db0: 6e5f 706f 7029 3a0a 2020 2020 2020 2020  n_pop):.        
+00028dc0: 6265 7374 5f67 656e 6520 3d20 7b7d 0a20  best_gene = {}. 
+00028dd0: 2020 2020 2020 2066 6f72 206f 2069 6e20         for o in 
+00028de0: 706f 7075 6c61 7469 6f6e 3a0a 2020 2020  population:.    
+00028df0: 2020 2020 2020 2020 6f3a 204d 756c 7469          o: Multi
+00028e00: 706c 6547 656e 6547 500a 2020 2020 2020  pleGeneGP.      
+00028e10: 2020 2020 2020 666f 7220 6769 642c 2067        for gid, g
+00028e20: 2c20 6861 7368 2069 6e20 7a69 7028 7261  , hash in zip(ra
+00028e30: 6e67 6528 302c 206c 656e 286f 2e67 656e  nge(0, len(o.gen
+00028e40: 6529 292c 206f 2e67 656e 652c 206f 2e68  e)), o.gene, o.h
+00028e50: 6173 685f 7265 7375 6c74 293a 0a20 2020  ash_result):.   
+00028e60: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00028e70: 6861 7368 2069 6e20 6265 7374 5f67 656e  hash in best_gen
+00028e80: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00028e90: 2020 2020 2020 2069 6620 6c65 6e28 6729         if len(g)
+00028ea0: 203c 206c 656e 2862 6573 745f 6765 6e65   < len(best_gene
+00028eb0: 5b68 6173 685d 293a 0a20 2020 2020 2020  [hash]):.       
+00028ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028ed0: 2062 6573 745f 6765 6e65 5b68 6173 685d   best_gene[hash]
+00028ee0: 203d 2067 0a20 2020 2020 2020 2020 2020   = g.           
+00028ef0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00028f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028f10: 2020 2020 2020 2070 6173 730a 2020 2020         pass.    
+00028f20: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00028f30: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00028f40: 2020 2020 2020 6265 7374 5f67 656e 655b        best_gene[
+00028f50: 6861 7368 5d20 3d20 670a 2020 2020 2020  hash] = g.      
+00028f60: 2020 666f 7220 6f20 696e 2073 696d 706c    for o in simpl
+00028f70: 6966 6963 6174 696f 6e5f 706f 703a 0a20  ification_pop:. 
+00028f80: 2020 2020 2020 2020 2020 2066 6f72 2067             for g
+00028f90: 6964 2c20 672c 2068 6173 6820 696e 207a  id, g, hash in z
+00028fa0: 6970 2872 616e 6765 2830 2c20 6c65 6e28  ip(range(0, len(
+00028fb0: 6f2e 6765 6e65 2929 2c20 6f2e 6765 6e65  o.gene)), o.gene
+00028fc0: 2c20 6f2e 6861 7368 5f72 6573 756c 7429  , o.hash_result)
+00028fd0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00028fe0: 2020 6966 2068 6173 6820 696e 2062 6573    if hash in bes
+00028ff0: 745f 6765 6e65 2061 6e64 206c 656e 2862  t_gene and len(b
+00029000: 6573 745f 6765 6e65 5b68 6173 685d 2920  est_gene[hash]) 
+00029010: 3c20 6c65 6e28 6729 3a0a 2020 2020 2020  < len(g):.      
+00029020: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00029030: 7265 706c 6163 6520 7769 7468 2061 2073  replace with a s
+00029040: 6d61 6c6c 6572 2067 656e 650a 2020 2020  maller gene.    
+00029050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029060: 6f2e 6765 6e65 5b67 6964 5d20 3d20 6265  o.gene[gid] = be
+00029070: 7374 5f67 656e 655b 6861 7368 5d0a 0a20  st_gene[hash].. 
+00029080: 2020 2064 6566 2070 6f73 745f 7072 756e     def post_prun
+00029090: 6528 7365 6c66 2c20 686f 663a 204c 6973  e(self, hof: Lis
+000290a0: 745b 4d75 6c74 6970 6c65 4765 6e65 4750  t[MultipleGeneGP
+000290b0: 5d29 3a0a 2020 2020 2020 2020 6966 2073  ]):.        if s
+000290c0: 656c 662e 7265 6475 6e64 616e 745f 686f  elf.redundant_ho
+000290d0: 665f 7369 7a65 203e 2030 3a0a 2020 2020  f_size > 0:.    
+000290e0: 2020 2020 2020 2020 2320 7365 6c65 6374          # select
+000290f0: 2074 6865 2073 6d61 6c6c 6573 7420 6f6e   the smallest on
+00029100: 6520 6672 6f6d 2072 6564 756e 6461 6e74  e from redundant
+00029110: 2069 6e64 6976 6964 7561 6c73 0a20 2020   individuals.   
+00029120: 2020 2020 2020 2020 2062 6573 745f 696e           best_in
+00029130: 6420 3d20 6d69 6e28 7365 6c66 2e68 6f66  d = min(self.hof
+00029140: 2c20 6b65 793d 6c61 6d62 6461 2078 3a20  , key=lambda x: 
+00029150: 6c65 6e28 7829 290a 2020 2020 2020 2020  len(x)).        
+00029160: 2020 2020 7365 6c66 2e68 6f66 2e63 6c65      self.hof.cle
+00029170: 6172 2829 0a20 2020 2020 2020 2020 2020  ar().           
+00029180: 2073 656c 662e 686f 662e 696e 7365 7274   self.hof.insert
+00029190: 2862 6573 745f 696e 6429 0a0a 2020 2020  (best_ind)..    
+000291a0: 2020 2020 6966 2073 656c 662e 626c 6f61      if self.bloa
+000291b0: 745f 636f 6e74 726f 6c20 6973 206e 6f74  t_control is not
+000291c0: 204e 6f6e 6520 616e 6420 7365 6c66 2e62   None and self.b
+000291d0: 6c6f 6174 5f63 6f6e 7472 6f6c 2e67 6574  loat_control.get
+000291e0: 2822 6c61 7373 6f5f 7072 756e 6522 2c20  ("lasso_prune", 
+000291f0: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
+00029200: 2020 2020 6c61 7373 6f20 3d20 4c61 7373      lasso = Lass
+00029210: 6f43 5628 290a 2020 2020 2020 2020 2020  oCV().          
+00029220: 2020 6265 7374 5f69 6e64 203d 204e 6f6e    best_ind = Non
+00029230: 650a 2020 2020 2020 2020 2020 2020 6265  e.            be
+00029240: 7374 5f73 636f 7265 203d 2030 0a20 2020  st_score = 0.   
+00029250: 2020 2020 2020 2020 2066 6f72 2069 6e64           for ind
+00029260: 2069 6e20 7365 6c66 2e6c 6173 736f 5f68   in self.lasso_h
+00029270: 6f66 3a0a 2020 2020 2020 2020 2020 2020  of:.            
+00029280: 2020 2020 616c 6c5f 6765 6e65 7320 3d20      all_genes = 
+00029290: 5b5d 0a20 2020 2020 2020 2020 2020 2020  [].             
+000292a0: 2020 2059 7020 3d20 7175 6963 6b5f 7265     Yp = quick_re
+000292b0: 7375 6c74 5f63 616c 6375 6c61 7469 6f6e  sult_calculation
+000292c0: 2869 6e64 2e67 656e 652c 2073 656c 662e  (ind.gene, self.
+000292d0: 7073 6574 2c20 7365 6c66 2e58 290a 2020  pset, self.X).  
+000292e0: 2020 2020 2020 2020 2020 2020 2020 6c61                la
+000292f0: 7373 6f2e 6669 7428 5970 2c20 7365 6c66  sso.fit(Yp, self
+00029300: 2e79 290a 2020 2020 2020 2020 2020 2020  .y).            
+00029310: 2020 2020 6d69 6e5f 7363 6f72 6520 3d20      min_score = 
+00029320: 6e70 2e6d 696e 286e 702e 6d65 616e 286c  np.min(np.mean(l
+00029330: 6173 736f 2e6d 7365 5f70 6174 685f 2c20  asso.mse_path_, 
+00029340: 6178 6973 3d31 2929 0a20 2020 2020 2020  axis=1)).       
+00029350: 2020 2020 2020 2020 2066 6f72 2067 2c20           for g, 
+00029360: 6f6b 2069 6e20 7a69 7028 696e 642e 6765  ok in zip(ind.ge
+00029370: 6e65 2c20 6e70 2e61 6273 286c 6173 736f  ne, np.abs(lasso
+00029380: 2e63 6f65 665f 2920 3e20 3029 3a0a 2020  .coef_) > 0):.  
+00029390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000293a0: 2020 6966 206f 6b3a 0a20 2020 2020 2020    if ok:.       
+000293b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000293c0: 2061 6c6c 5f67 656e 6573 2e61 7070 656e   all_genes.appen
+000293d0: 6428 6729 0a20 2020 2020 2020 2020 2020  d(g).           
+000293e0: 2020 2020 2069 6e64 2e67 656e 6520 3d20       ind.gene = 
+000293f0: 616c 6c5f 6765 6e65 730a 2020 2020 2020  all_genes.      
+00029400: 2020 2020 2020 2020 2020 696e 642e 7069            ind.pi
+00029410: 7065 203d 2073 656c 662e 6765 745f 6261  pe = self.get_ba
+00029420: 7365 5f6d 6f64 656c 2829 0a20 2020 2020  se_model().     
+00029430: 2020 2020 2020 2020 2020 2069 6620 6265             if be
+00029440: 7374 5f69 6e64 2069 7320 4e6f 6e65 206f  st_ind is None o
+00029450: 7220 6d69 6e5f 7363 6f72 6520 3c20 6265  r min_score < be
+00029460: 7374 5f73 636f 7265 3a0a 2020 2020 2020  st_score:.      
+00029470: 2020 2020 2020 2020 2020 2020 2020 6265                be
+00029480: 7374 5f69 6e64 203d 2069 6e64 0a20 2020  st_ind = ind.   
+00029490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000294a0: 2062 6573 745f 7363 6f72 6520 3d20 6d69   best_score = mi
+000294b0: 6e5f 7363 6f72 650a 2020 2020 2020 2020  n_score.        
+000294c0: 2020 2020 7365 6c66 2e68 6f66 2e63 6c65      self.hof.cle
+000294d0: 6172 2829 0a20 2020 2020 2020 2020 2020  ar().           
+000294e0: 2073 656c 662e 686f 662e 696e 7365 7274   self.hof.insert
+000294f0: 2862 6573 745f 696e 6429 0a0a 2020 2020  (best_ind)..    
+00029500: 2020 2020 6966 2073 656c 662e 706f 7374      if self.post
+00029510: 5f70 7275 6e65 5f74 6872 6573 686f 6c64  _prune_threshold
+00029520: 203e 2030 206f 7220 5c0a 2020 2020 2020   > 0 or \.      
+00029530: 2020 2020 2020 2873 656c 662e 626c 6f61        (self.bloa
+00029540: 745f 636f 6e74 726f 6c20 6973 206e 6f74  t_control is not
+00029550: 204e 6f6e 6520 616e 6420 7365 6c66 2e62   None and self.b
+00029560: 6c6f 6174 5f63 6f6e 7472 6f6c 2e67 6574  loat_control.get
+00029570: 2822 706f 7374 5f70 7275 6e65 5f74 6872  ("post_prune_thr
+00029580: 6573 686f 6c64 222c 2030 2920 3e20 3029  eshold", 0) > 0)
+00029590: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+000295a0: 2073 656c 662e 706f 7374 5f70 7275 6e65   self.post_prune
+000295b0: 5f74 6872 6573 686f 6c64 203e 2030 3a0a  _threshold > 0:.
+000295c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000295d0: 706f 7374 5f70 7275 6e65 5f74 6872 6573  post_prune_thres
+000295e0: 686f 6c64 203d 2073 656c 662e 706f 7374  hold = self.post
+000295f0: 5f70 7275 6e65 5f74 6872 6573 686f 6c64  _prune_threshold
+00029600: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00029610: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00029620: 2020 2070 6f73 745f 7072 756e 655f 7468     post_prune_th
+00029630: 7265 7368 6f6c 6420 3d20 7365 6c66 2e62  reshold = self.b
+00029640: 6c6f 6174 5f63 6f6e 7472 6f6c 2e67 6574  loat_control.get
+00029650: 2822 706f 7374 5f70 7275 6e65 5f74 6872  ("post_prune_thr
+00029660: 6573 686f 6c64 222c 2030 290a 2020 2020  eshold", 0).    
+00029670: 2020 2020 2020 2020 636f 5f6c 696e 6561          co_linea
+00029680: 7269 7479 5f64 656c 6574 696f 6e20 3d20  rity_deletion = 
+00029690: 7365 6c66 2e62 6c6f 6174 5f63 6f6e 7472  self.bloat_contr
+000296a0: 6f6c 2e67 6574 2822 636f 5f6c 696e 6561  ol.get("co_linea
+000296b0: 7269 7479 5f64 656c 6574 696f 6e22 2c20  rity_deletion", 
+000296c0: 5472 7565 290a 2020 2020 2020 2020 2020  True).          
+000296d0: 2020 7472 6976 6961 6c5f 6665 6174 7572    trivial_featur
+000296e0: 655f 6465 6c65 7469 6f6e 203d 2073 656c  e_deletion = sel
+000296f0: 662e 626c 6f61 745f 636f 6e74 726f 6c2e  f.bloat_control.
+00029700: 6765 7428 2274 7269 7669 616c 5f66 6561  get("trivial_fea
+00029710: 7475 7265 5f64 656c 6574 696f 6e22 2c20  ture_deletion", 
+00029720: 5472 7565 290a 2020 2020 2020 2020 2020  True).          
+00029730: 2020 666f 7220 696e 6420 696e 2068 6f66    for ind in hof
+00029740: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00029750: 2020 2320 7072 756e 6520 7468 6520 696e    # prune the in
+00029760: 6469 7669 6475 616c 2062 6173 6564 206f  dividual based o
+00029770: 6e20 6d75 6c74 692d 636f 2d6c 696e 6561  n multi-co-linea
+00029780: 7269 7479 2061 6e64 207a 6572 6f20 636f  rity and zero co
+00029790: 7272 656c 6174 696f 6e0a 2020 2020 2020  rrelation.      
+000297a0: 2020 2020 2020 2020 2020 616c 6c5f 6765            all_ge
+000297b0: 6e65 7320 3d20 5b5d 0a20 2020 2020 2020  nes = [].       
+000297c0: 2020 2020 2020 2020 2070 7265 7669 6f75           previou
+000297d0: 735f 7265 7375 6c74 7320 3d20 5b5d 0a20  s_results = []. 
+000297e0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000297f0: 6f72 2067 656e 6520 696e 206c 6973 7428  or gene in list(
+00029800: 736f 7274 6564 2869 6e64 2e67 656e 652c  sorted(ind.gene,
+00029810: 206b 6579 3d6c 656e 2929 3a0a 2020 2020   key=len)):.    
+00029820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029830: 7175 6963 6b5f 7265 7375 6c74 203d 2071  quick_result = q
+00029840: 7569 636b 5f65 7661 6c75 6174 6528 6765  uick_evaluate(ge
+00029850: 6e65 2c20 7365 6c66 2e70 7365 742c 2073  ne, self.pset, s
+00029860: 656c 662e 5829 5b30 5d0a 2020 2020 2020  elf.X)[0].      
+00029870: 2020 2020 2020 2020 2020 2020 2020 7920                y 
+00029880: 3d20 7175 6963 6b5f 6669 6c6c 285b 7175  = quick_fill([qu
+00029890: 6963 6b5f 7265 7375 6c74 5d2c 2073 656c  ick_result], sel
+000298a0: 662e 5829 5b30 5d0a 2020 2020 2020 2020  f.X)[0].        
+000298b0: 2020 2020 2020 2020 2020 2020 6966 2074              if t
+000298c0: 7269 7669 616c 5f66 6561 7475 7265 5f64  rivial_feature_d
+000298d0: 656c 6574 696f 6e20 616e 6420 6e70 2e61  eletion and np.a
+000298e0: 6273 2870 6561 7273 6f6e 7228 792c 2073  bs(pearsonr(y, s
+000298f0: 656c 662e 7929 5b30 5d29 203c 2070 6f73  elf.y)[0]) < pos
+00029900: 745f 7072 756e 655f 7468 7265 7368 6f6c  t_prune_threshol
+00029910: 643a 0a20 2020 2020 2020 2020 2020 2020  d:.             
+00029920: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
+00029930: 6e75 650a 2020 2020 2020 2020 2020 2020  nue.            
+00029940: 2020 2020 2020 2020 666f 7220 795f 7020          for y_p 
+00029950: 696e 2070 7265 7669 6f75 735f 7265 7375  in previous_resu
+00029960: 6c74 733a 0a20 2020 2020 2020 2020 2020  lts:.           
+00029970: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00029980: 636f 5f6c 696e 6561 7269 7479 5f64 656c  co_linearity_del
+00029990: 6574 696f 6e20 616e 6420 6e70 2e61 6273  etion and np.abs
+000299a0: 2870 6561 7273 6f6e 7228 795f 702c 2079  (pearsonr(y_p, y
+000299b0: 295b 305d 2920 3e20 3120 2d20 706f 7374  )[0]) > 1 - post
+000299c0: 5f70 7275 6e65 5f74 6872 6573 686f 6c64  _prune_threshold
+000299d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000299e0: 2020 2020 2020 2020 2020 2020 2020 6272                br
+000299f0: 6561 6b0a 2020 2020 2020 2020 2020 2020  eak.            
+00029a00: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00029a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029a20: 2020 2020 2020 616c 6c5f 6765 6e65 732e        all_genes.
+00029a30: 6170 7065 6e64 2867 656e 6529 0a20 2020  append(gene).   
+00029a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029a50: 2020 2020 2070 7265 7669 6f75 735f 7265       previous_re
+00029a60: 7375 6c74 732e 6170 7065 6e64 2879 290a  sults.append(y).
+00029a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029a80: 696e 642e 6765 6e65 203d 2061 6c6c 5f67  ind.gene = all_g
+00029a90: 656e 6573 0a20 2020 2020 2020 2020 2020  enes.           
+00029aa0: 2020 2020 2023 2072 652d 696e 6974 6961       # re-initia
+00029ab0: 6c69 7a65 2074 6865 2066 696e 616c 2070  lize the final p
+00029ac0: 6970 656c 696e 650a 2020 2020 2020 2020  ipeline.        
+00029ad0: 2020 2020 2020 2020 696e 642e 7069 7065          ind.pipe
+00029ae0: 203d 2073 656c 662e 6765 745f 6261 7365   = self.get_base
+00029af0: 5f6d 6f64 656c 2829 0a0a 2020 2020 2222  _model()..    ""
+00029b00: 220a 2020 2020 416e 6f74 6865 7220 4964  ".    Another Id
+00029b10: 6561 3a0a 2020 2020 4966 2063 616e 6e6f  ea:.    If canno
+00029b20: 7420 686f 6973 742c 2074 6865 6e20 6d61  t hoist, then ma
+00029b30: 726b 2069 7420 6173 2069 6e74 726f 6e2e  rk it as intron.
+00029b40: 0a20 2020 2022 2222 0a0a 2020 2020 6465  .    """..    de
+00029b50: 6620 6765 745f 7061 7261 6d73 2873 656c  f get_params(sel
+00029b60: 662c 2064 6565 703d 5472 7565 293a 0a20  f, deep=True):. 
+00029b70: 2020 2020 2020 206f 7574 203d 2073 7570         out = sup
+00029b80: 6572 2829 2e67 6574 5f70 6172 616d 7328  er().get_params(
+00029b90: 6465 6570 290a 2020 2020 2020 2020 666f  deep).        fo
+00029ba0: 7220 6b2c 2076 2069 6e20 7365 6c66 2e70  r k, v in self.p
+00029bb0: 6172 616d 2e69 7465 6d73 2829 3a0a 2020  aram.items():.  
+00029bc0: 2020 2020 2020 2020 2020 6f75 745b 6b5d            out[k]
+00029bd0: 203d 2076 0a20 2020 2020 2020 2072 6574   = v.        ret
+00029be0: 7572 6e20 6f75 740a 0a20 2020 2064 6566  urn out..    def
+00029bf0: 2068 6f69 7374 5f6d 7574 6174 696f 6e28   hoist_mutation(
+00029c00: 7365 6c66 2c20 6f2c 2068 6f69 7374 5f70  self, o, hoist_p
+00029c10: 726f 6261 6269 6c69 7479 3d4e 6f6e 652c  robability=None,
+00029c20: 2070 7265 7669 6f75 735f 6765 6e65 3d4e   previous_gene=N
+00029c30: 6f6e 6529 3a0a 2020 2020 2020 2020 686f  one):.        ho
+00029c40: 6973 745f 6672 6571 7565 6e63 7920 3d20  ist_frequency = 
+00029c50: 7365 6c66 2e62 6c6f 6174 5f63 6f6e 7472  self.bloat_contr
+00029c60: 6f6c 2e67 6574 2827 686f 6973 745f 6672  ol.get('hoist_fr
+00029c70: 6571 7565 6e63 7927 2c20 3029 0a20 2020  equency', 0).   
+00029c80: 2020 2020 2069 6620 686f 6973 745f 6672       if hoist_fr
+00029c90: 6571 7565 6e63 7920 213d 2030 2061 6e64  equency != 0 and
+00029ca0: 2073 656c 662e 6375 7272 656e 745f 6765   self.current_ge
+00029cb0: 6e20 2520 686f 6973 745f 6672 6571 7565  n % hoist_freque
+00029cc0: 6e63 7920 213d 2030 2061 6e64 2073 656c  ncy != 0 and sel
+00029cd0: 662e 6375 7272 656e 745f 6765 6e20 213d  f.current_gen !=
+00029ce0: 2073 656c 662e 6e5f 6765 6e3a 0a20 2020   self.n_gen:.   
+00029cf0: 2020 2020 2020 2020 2023 2073 6b69 7020           # skip 
+00029d00: 686f 6973 7420 6f70 6572 6174 696f 6e20  hoist operation 
+00029d10: 6166 7465 7220 6120 6665 7720 6974 6572  after a few iter
+00029d20: 6174 696f 6e73 0a20 2020 2020 2020 2020  ations.         
+00029d30: 2020 2072 6574 7572 6e0a 0a20 2020 2020     return..     
+00029d40: 2020 2069 6620 7072 6576 696f 7573 5f67     if previous_g
+00029d50: 656e 6520 6973 204e 6f6e 653a 0a20 2020  ene is None:.   
+00029d60: 2020 2020 2020 2020 2070 7265 7669 6f75           previou
+00029d70: 735f 6765 6e65 203d 2073 6574 2829 0a0a  s_gene = set()..
+00029d80: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00029d90: 626c 6f61 745f 636f 6e74 726f 6c2e 6765  bloat_control.ge
+00029da0: 7428 2272 616e 6b5f 6279 5f73 697a 6522  t("rank_by_size"
+00029db0: 2c20 4661 6c73 6529 3a0a 2020 2020 2020  , False):.      
+00029dc0: 2020 2020 2020 6f72 6465 7220 3d20 6c69        order = li
+00029dd0: 7374 2865 6e75 6d65 7261 7465 286e 702e  st(enumerate(np.
+00029de0: 6172 6773 6f72 7428 5b6c 656e 2867 2920  argsort([len(g) 
+00029df0: 666f 7220 6720 696e 206f 2e67 656e 655d  for g in o.gene]
+00029e00: 2929 290a 2020 2020 2020 2020 656c 6966  ))).        elif
+00029e10: 2073 656c 662e 626c 6f61 745f 636f 6e74   self.bloat_cont
+00029e20: 726f 6c2e 6765 7428 2272 616e 6b5f 6279  rol.get("rank_by
+00029e30: 5f73 697a 655f 696e 7665 7273 6522 2c20  _size_inverse", 
+00029e40: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
+00029e50: 2020 2020 6f72 6465 7220 3d20 6c69 7374      order = list
+00029e60: 2865 6e75 6d65 7261 7465 286e 702e 6172  (enumerate(np.ar
+00029e70: 6773 6f72 7428 5b6c 656e 2867 2920 666f  gsort([len(g) fo
+00029e80: 7220 6720 696e 206f 2e67 656e 655d 2929  r g in o.gene]))
+00029e90: 290a 2020 2020 2020 2020 656c 6966 2073  ).        elif s
+00029ea0: 656c 662e 626c 6f61 745f 636f 6e74 726f  elf.bloat_contro
+00029eb0: 6c2e 6765 7428 2272 616e 6b5f 6279 5f77  l.get("rank_by_w
+00029ec0: 6569 6768 7422 2c20 4661 6c73 6529 3a0a  eight", False):.
+00029ed0: 2020 2020 2020 2020 2020 2020 6f72 6465              orde
+00029ee0: 7220 3d20 6c69 7374 2865 6e75 6d65 7261  r = list(enumera
+00029ef0: 7465 286e 702e 6172 6773 6f72 7428 2d31  te(np.argsort(-1
+00029f00: 202a 206f 2e63 6f65 6629 2929 0a20 2020   * o.coef))).   
+00029f10: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00029f20: 2020 2020 2020 206f 7264 6572 203d 206c         order = l
+00029f30: 6973 7428 656e 756d 6572 6174 6528 7261  ist(enumerate(ra
+00029f40: 6e67 6528 302c 206c 656e 286f 2e67 656e  nge(0, len(o.gen
+00029f50: 6529 2929 290a 0a20 2020 2020 2020 2022  e))))..        "
+00029f60: 2222 0a20 2020 2020 2020 2049 7465 7261  "".        Itera
+00029f70: 7469 7665 6c79 2068 6f69 7374 2074 7265  tively hoist tre
+00029f80: 6573 2c20 756e 7469 6c20 7573 6564 2061  es, until used a
+00029f90: 6c6c 2074 7265 6573 0a20 2020 2020 2020  ll trees.       
+00029fa0: 2022 2222 0a20 2020 2020 2020 2069 7465   """.        ite
+00029fb0: 7261 7469 7665 6c79 5f63 6865 636b 203d  ratively_check =
+00029fc0: 2073 656c 662e 626c 6f61 745f 636f 6e74   self.bloat_cont
+00029fd0: 726f 6c2e 6765 7428 2269 7465 7261 7469  rol.get("iterati
+00029fe0: 7665 6c79 5f63 6865 636b 222c 2046 616c  vely_check", Fal
+00029ff0: 7365 290a 2020 2020 2020 2020 6b65 795f  se).        key_
+0002a000: 6974 656d 203d 2073 656c 662e 626c 6f61  item = self.bloa
+0002a010: 745f 636f 6e74 726f 6c2e 6765 7428 226b  t_control.get("k
+0002a020: 6579 5f69 7465 6d22 2c20 2753 7472 696e  ey_item", 'Strin
+0002a030: 6727 290a 2020 2020 2020 2020 6e65 775f  g').        new_
+0002a040: 6765 6e65 203d 205b 5d0a 0a20 2020 2020  gene = []..     
+0002a050: 2020 2023 2072 616e 6b20 616c 6c20 6765     # rank all ge
+0002a060: 6e65 0a20 2020 2020 2020 2061 6c6c 5f67  ne.        all_g
+0002a070: 656e 6573 203d 205b 6c69 7374 2873 6f72  enes = [list(sor
+0002a080: 7465 6428 5b28 6b2c 2067 6574 6174 7472  ted([(k, getattr
+0002a090: 2867 2c20 2763 6f72 7227 2c20 3029 2c20  (g, 'corr', 0), 
+0002a0a0: 6769 6429 2066 6f72 206b 2c20 6720 696e  gid) for k, g in
+0002a0b0: 2065 6e75 6d65 7261 7465 2867 656e 6529   enumerate(gene)
 0002a0c0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-0002a0d0: 2020 2020 2020 2027 6d61 785f 6465 7074         'max_dept
-0002a0e0: 6827 3a20 7261 6e67 6528 312c 2031 3129  h': range(1, 11)
-0002a0f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002a100: 2020 2020 2020 276d 696e 5f73 616d 706c        'min_sampl
-0002a110: 6573 5f73 706c 6974 273a 2072 616e 6765  es_split': range
-0002a120: 2832 2c20 3231 292c 0a20 2020 2020 2020  (2, 21),.       
-0002a130: 2020 2020 2020 2020 2020 2020 2027 6d69               'mi
-0002a140: 6e5f 7361 6d70 6c65 735f 6c65 6166 273a  n_samples_leaf':
-0002a150: 2072 616e 6765 2831 2c20 3231 290a 2020   range(1, 21).  
-0002a160: 2020 2020 2020 2020 2020 2020 2020 7d2c                },
-0002a170: 0a20 2020 2020 2020 2020 2020 207d 0a20  .            }. 
-0002a180: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0002a190: 7470 6f74 5f6d 6f64 656c 203d 2054 504f  tpot_model = TPO
-0002a1a0: 5443 6c61 7373 6966 6965 7228 636f 6e66  TClassifier(conf
-0002a1b0: 6967 5f64 6963 743d 636f 6e66 6967 5f64  ig_dict=config_d
-0002a1c0: 6963 742c 2074 656d 706c 6174 653d 2743  ict, template='C
-0002a1d0: 6c61 7373 6966 6965 7227 290a 2020 2020  lassifier').    
-0002a1e0: 2020 2020 2020 2020 7365 6c66 2e74 706f          self.tpo
-0002a1f0: 745f 6d6f 6465 6c2e 5f66 6974 5f69 6e69  t_model._fit_ini
-0002a200: 7428 290a 2020 2020 2020 2020 656c 7365  t().        else
-0002a210: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-0002a220: 6c66 2e74 706f 745f 6d6f 6465 6c20 3d20  lf.tpot_model = 
-0002a230: 4e6f 6e65 0a0a 2020 2020 6465 6620 6765  None..    def ge
-0002a240: 745f 7061 7261 6d73 2873 656c 662c 2064  t_params(self, d
-0002a250: 6565 703d 5472 7565 293a 0a20 2020 2020  eep=True):.     
-0002a260: 2020 2070 6172 616d 7320 3d20 7375 7065     params = supe
-0002a270: 7228 292e 6765 745f 7061 7261 6d73 2864  r().get_params(d
-0002a280: 6565 7029 0a20 2020 2020 2020 2023 2048  eep).        # H
-0002a290: 6163 6b20 746f 206d 616b 6520 6765 745f  ack to make get_
-0002a2a0: 7061 7261 6d73 2072 6574 7572 6e20 6261  params return ba
-0002a2b0: 7365 2063 6c61 7373 2070 6172 616d 732e  se class params.
-0002a2c0: 2e2e 0a20 2020 2020 2020 2063 7020 3d20  ...        cp = 
-0002a2d0: 636f 7079 2e63 6f70 7928 7365 6c66 290a  copy.copy(self).
-0002a2e0: 2020 2020 2020 2020 6370 2e5f 5f63 6c61          cp.__cla
-0002a2f0: 7373 5f5f 203d 2045 766f 6c75 7469 6f6e  ss__ = Evolution
-0002a300: 6172 7946 6f72 6573 7452 6567 7265 7373  aryForestRegress
-0002a310: 6f72 0a20 2020 2020 2020 2070 6172 616d  or.        param
-0002a320: 732e 7570 6461 7465 2845 766f 6c75 7469  s.update(Evoluti
-0002a330: 6f6e 6172 7946 6f72 6573 7452 6567 7265  onaryForestRegre
-0002a340: 7373 6f72 2e67 6574 5f70 6172 616d 7328  ssor.get_params(
-0002a350: 6370 2c20 6465 6570 2929 0a20 2020 2020  cp, deep)).     
-0002a360: 2020 2072 6574 7572 6e20 7061 7261 6d73     return params
-0002a370: 0a0a 2020 2020 6465 6620 6f6f 625f 6572  ..    def oob_er
-0002a380: 726f 7228 7365 6c66 2c20 706f 7029 3a0a  ror(self, pop):.
-0002a390: 2020 2020 2020 2020 2320 686f 7720 746f          # how to
-0002a3a0: 2063 616c 6375 6c61 7465 2074 6865 2070   calculate the p
-0002a3b0: 7265 6469 6374 696f 6e20 7265 7375 6c74  rediction result
-0002a3c0: 3f0a 2020 2020 2020 2020 636f 756e 7420  ?.        count 
-0002a3d0: 3d20 6e70 2e7a 6572 6f73 286c 656e 2873  = np.zeros(len(s
-0002a3e0: 656c 662e 7929 290a 2020 2020 2020 2020  elf.y)).        
-0002a3f0: 2320 7072 6564 6963 7469 6f6e 203d 206e  # prediction = n
-0002a400: 702e 7a65 726f 7328 286c 656e 2873 656c  p.zeros((len(sel
-0002a410: 662e 7929 2c20 6c65 6e28 6e70 2e75 6e69  f.y), len(np.uni
-0002a420: 7175 6528 7365 6c66 2e79 2929 2929 0a20  que(self.y)))). 
-0002a430: 2020 2020 2020 2070 7265 6469 6374 696f         predictio
-0002a440: 6e20 3d20 6e70 2e66 756c 6c28 286c 656e  n = np.full((len
-0002a450: 2873 656c 662e 7929 2c20 6c65 6e28 6e70  (self.y), len(np
-0002a460: 2e75 6e69 7175 6528 7365 6c66 2e79 2929  .unique(self.y))
-0002a470: 292c 2030 2c20 6474 7970 653d 6e70 2e66  ), 0, dtype=np.f
-0002a480: 6c6f 6174 290a 2020 2020 2020 2020 666f  loat).        fo
-0002a490: 7220 692c 2078 2069 6e20 656e 756d 6572  r i, x in enumer
-0002a4a0: 6174 6528 706f 7029 3a0a 2020 2020 2020  ate(pop):.      
-0002a4b0: 2020 2020 2020 696e 6465 7820 3d20 782e        index = x.
-0002a4c0: 6f75 745f 6f66 5f62 6167 0a20 2020 2020  out_of_bag.     
-0002a4d0: 2020 2020 2020 2063 6f75 6e74 5b69 6e64         count[ind
-0002a4e0: 6578 5d20 2b3d 2031 0a20 2020 2020 2020  ex] += 1.       
-0002a4f0: 2020 2020 2070 7265 6469 6374 696f 6e5b       prediction[
-0002a500: 696e 6465 785d 202b 3d20 782e 6f6f 625f  index] += x.oob_
-0002a510: 7072 6564 6963 7469 6f6e 0a20 2020 2020  prediction.     
-0002a520: 2020 2023 206c 6162 656c 203d 2073 7461     # label = sta
-0002a530: 7473 2e6d 6f64 6528 6e70 2e61 7272 6179  ts.mode(np.array
-0002a540: 2870 7265 6469 6374 696f 6e29 2c20 6178  (prediction), ax
-0002a550: 6973 3d30 2c20 6e61 6e5f 706f 6c69 6379  is=0, nan_policy
-0002a560: 3d27 6f6d 6974 2729 5b30 5d2e 666c 6174  ='omit')[0].flat
-0002a570: 7465 6e28 290a 2020 2020 2020 2020 636c  ten().        cl
-0002a580: 6173 7365 7320 3d20 706f 705b 305d 2e70  asses = pop[0].p
-0002a590: 6970 655b 2752 6964 6765 275d 2e63 6c61  ipe['Ridge'].cla
-0002a5a0: 7373 6573 5f0a 2020 2020 2020 2020 6c61  sses_.        la
-0002a5b0: 6265 6c20 3d20 636c 6173 7365 732e 7461  bel = classes.ta
-0002a5c0: 6b65 286e 702e 6172 676d 6178 2870 7265  ke(np.argmax(pre
-0002a5d0: 6469 6374 696f 6e2c 2061 7869 733d 3129  diction, axis=1)
-0002a5e0: 2c20 6178 6973 3d30 290a 2020 2020 2020  , axis=0).      
-0002a5f0: 2020 6163 6375 7261 6379 203d 2061 6363    accuracy = acc
-0002a600: 7572 6163 795f 7363 6f72 6528 7365 6c66  uracy_score(self
-0002a610: 2e79 2c20 6c61 6265 6c29 0a20 2020 2020  .y, label).     
-0002a620: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
-0002a630: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0002a640: 7072 696e 7428 276f 6f62 2073 636f 7265  print('oob score
-0002a650: 272c 2061 6363 7572 6163 7929 0a20 2020  ', accuracy).   
-0002a660: 2020 2020 2072 6574 7572 6e20 6163 6375       return accu
-0002a670: 7261 6379 0a0a 2020 2020 6465 6620 7072  racy..    def pr
-0002a680: 6564 6963 745f 7072 6f62 6128 7365 6c66  edict_proba(self
-0002a690: 2c20 5829 3a0a 2020 2020 2020 2020 6966  , X):.        if
-0002a6a0: 2073 656c 662e 6e6f 726d 616c 697a 653a   self.normalize:
-0002a6b0: 0a20 2020 2020 2020 2020 2020 2058 203d  .            X =
-0002a6c0: 2073 656c 662e 785f 7363 616c 6572 2e74   self.x_scaler.t
-0002a6d0: 7261 6e73 666f 726d 2858 290a 2020 2020  ransform(X).    
-0002a6e0: 2020 2020 7072 6564 6963 7469 6f6e 5f64      prediction_d
-0002a6f0: 6174 615f 7369 7a65 203d 2058 2e73 6861  ata_size = X.sha
-0002a700: 7065 5b30 5d0a 2020 2020 2020 2020 6966  pe[0].        if
-0002a710: 2073 656c 662e 7465 7374 5f64 6174 615f   self.test_data_
-0002a720: 7369 7a65 203e 2030 3a0a 2020 2020 2020  size > 0:.      
-0002a730: 2020 2020 2020 5820 3d20 6e70 2e63 6f6e        X = np.con
-0002a740: 6361 7465 6e61 7465 285b 7365 6c66 2e74  catenate([self.t
-0002a750: 7261 696e 582c 2058 5d29 0a20 2020 2020  rainX, X]).     
-0002a760: 2020 2073 656c 662e 6669 6e61 6c5f 6d6f     self.final_mo
-0002a770: 6465 6c5f 6c61 7a79 5f74 7261 696e 696e  del_lazy_trainin
-0002a780: 6728 7365 6c66 2e68 6f66 290a 2020 2020  g(self.hof).    
-0002a790: 2020 2020 7365 6c65 6374 696f 6e5f 666c      selection_fl
-0002a7a0: 6167 203d 206e 702e 6f6e 6573 286c 656e  ag = np.ones(len
-0002a7b0: 2873 656c 662e 686f 6629 2c20 6474 7970  (self.hof), dtyp
-0002a7c0: 653d 626f 6f6c 290a 2020 2020 2020 2020  e=bool).        
-0002a7d0: 7072 6564 6963 7469 6f6e 7320 3d20 5b5d  predictions = []
-0002a7e0: 0a20 2020 2020 2020 2077 6569 6768 745f  .        weight_
-0002a7f0: 6c69 7374 203d 205b 5d0a 2020 2020 2020  list = [].      
-0002a800: 2020 666f 7220 692c 2069 6e64 6976 6964    for i, individ
-0002a810: 7561 6c20 696e 2065 6e75 6d65 7261 7465  ual in enumerate
-0002a820: 2873 656c 662e 686f 6629 3a0a 2020 2020  (self.hof):.    
-0002a830: 2020 2020 2020 2020 6675 6e63 203d 2073          func = s
-0002a840: 656c 662e 746f 6f6c 626f 782e 636f 6d70  elf.toolbox.comp
-0002a850: 696c 6528 696e 6469 7669 6475 616c 290a  ile(individual).
-0002a860: 2020 2020 2020 2020 2020 2020 5970 203d              Yp =
-0002a870: 2072 6573 756c 745f 6361 6c63 756c 6174   result_calculat
-0002a880: 696f 6e28 6675 6e63 2c20 582c 2073 656c  ion(func, X, sel
-0002a890: 662e 6f72 6967 696e 616c 5f66 6561 7475  f.original_featu
-0002a8a0: 7265 7329 0a20 2020 2020 2020 2020 2020  res).           
-0002a8b0: 2069 6620 7365 6c66 2e74 6573 745f 6461   if self.test_da
-0002a8c0: 7461 5f73 697a 6520 3e20 303a 0a20 2020  ta_size > 0:.   
-0002a8d0: 2020 2020 2020 2020 2020 2020 2059 7020               Yp 
-0002a8e0: 3d20 5970 5b2d 7072 6564 6963 7469 6f6e  = Yp[-prediction
-0002a8f0: 5f64 6174 615f 7369 7a65 3a5d 0a20 2020  _data_size:].   
-0002a900: 2020 2020 2020 2020 2070 7265 6469 6374           predict
-0002a910: 6564 203d 2069 6e64 6976 6964 7561 6c2e  ed = individual.
-0002a920: 7069 7065 2e70 7265 6469 6374 5f70 726f  pipe.predict_pro
-0002a930: 6261 2859 7029 0a0a 2020 2020 2020 2020  ba(Yp)..        
-0002a940: 2020 2020 6966 2068 6173 6174 7472 2873      if hasattr(s
-0002a950: 656c 662e 686f 662c 2027 6c6f 7373 5f66  elf.hof, 'loss_f
-0002a960: 756e 6374 696f 6e27 2920 616e 6420 7365  unction') and se
-0002a970: 6c66 2e68 6f66 2e6c 6f73 735f 6675 6e63  lf.hof.loss_func
-0002a980: 7469 6f6e 203d 3d20 275a 6572 6f4f 6e65  tion == 'ZeroOne
-0002a990: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
-0002a9a0: 2020 2023 207a 6572 6f2d 6f6e 6520 6c6f     # zero-one lo
-0002a9b0: 7373 0a20 2020 2020 2020 2020 2020 2020  ss.             
-0002a9c0: 2020 2061 7267 6d61 7820 3d20 6e70 2e61     argmax = np.a
-0002a9d0: 7267 6d61 7828 7072 6564 6963 7465 642c  rgmax(predicted,
-0002a9e0: 2061 7869 733d 3129 0a20 2020 2020 2020   axis=1).       
-0002a9f0: 2020 2020 2020 2020 2070 7265 6469 6374           predict
-0002aa00: 6564 5b3a 5d20 3d20 300a 2020 2020 2020  ed[:] = 0.      
-0002aa10: 2020 2020 2020 2020 2020 7072 6564 6963            predic
-0002aa20: 7465 645b 6e70 2e61 7261 6e67 6528 302c  ted[np.arange(0,
-0002aa30: 206c 656e 2870 7265 6469 6374 6564 2929   len(predicted))
-0002aa40: 2c20 6172 676d 6178 5d20 3d20 310a 0a20  , argmax] = 1.. 
-0002aa50: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
-0002aa60: 7420 6e70 2e61 6c6c 286e 702e 6973 6669  t np.all(np.isfi
-0002aa70: 6e69 7465 2870 7265 6469 6374 6564 2929  nite(predicted))
-0002aa80: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002aa90: 2020 2320 736b 6970 2070 7265 6469 6374    # skip predict
-0002aaa0: 696f 6e20 7265 7375 6c74 7320 636f 6e74  ion results cont
-0002aab0: 6169 6e69 6e67 204e 614e 0a20 2020 2020  aining NaN.     
-0002aac0: 2020 2020 2020 2020 2020 2073 656c 6563             selec
-0002aad0: 7469 6f6e 5f66 6c61 675b 695d 203d 2046  tion_flag[i] = F
-0002aae0: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-0002aaf0: 2020 2020 2063 6f6e 7469 6e75 650a 2020       continue.  
-0002ab00: 2020 2020 2020 2020 2020 7072 6564 6963            predic
-0002ab10: 7469 6f6e 732e 6170 7065 6e64 2870 7265  tions.append(pre
-0002ab20: 6469 6374 6564 290a 2020 2020 2020 2020  dicted).        
-0002ab30: 2020 2020 6966 2068 6173 6174 7472 2873      if hasattr(s
-0002ab40: 656c 662e 686f 662c 2027 656e 7365 6d62  elf.hof, 'ensemb
-0002ab50: 6c65 5f77 6569 6768 7427 2920 616e 6420  le_weight') and 
-0002ab60: 6c65 6e28 7365 6c66 2e68 6f66 2e65 6e73  len(self.hof.ens
-0002ab70: 656d 626c 655f 7765 6967 6874 2920 3e20  emble_weight) > 
-0002ab80: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-0002ab90: 2020 2077 6569 6768 745f 6c69 7374 2e61     weight_list.a
-0002aba0: 7070 656e 6428 7365 6c66 2e68 6f66 2e65  ppend(self.hof.e
-0002abb0: 6e73 656d 626c 655f 7765 6967 6874 5b69  nsemble_weight[i
-0002abc0: 6e64 6976 6964 7561 6c5f 746f 5f74 7570  ndividual_to_tup
-0002abd0: 6c65 2869 6e64 6976 6964 7561 6c29 5d29  le(individual)])
-0002abe0: 0a0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-0002abf0: 662e 7365 636f 6e64 5f6c 6179 6572 2021  f.second_layer !
-0002ac00: 3d20 274e 6f6e 6527 2061 6e64 2073 656c  = 'None' and sel
-0002ac10: 662e 7365 636f 6e64 5f6c 6179 6572 2021  f.second_layer !
-0002ac20: 3d20 4e6f 6e65 3a0a 2020 2020 2020 2020  = None:.        
-0002ac30: 2020 2020 6173 7365 7274 206c 656e 2873      assert len(s
-0002ac40: 656c 662e 686f 6629 203d 3d20 6c65 6e28  elf.hof) == len(
-0002ac50: 7365 6c66 2e74 7265 655f 7765 6967 6874  self.tree_weight
-0002ac60: 290a 2020 2020 2020 2020 2020 2020 7072  ).            pr
-0002ac70: 6564 6963 7469 6f6e 7320 3d20 6e70 2e61  edictions = np.a
-0002ac80: 7272 6179 2870 7265 6469 6374 696f 6e73  rray(predictions
-0002ac90: 292e 540a 2020 2020 2020 2020 2020 2020  ).T.            
-0002aca0: 7265 7475 726e 2028 7072 6564 6963 7469  return (predicti
-0002acb0: 6f6e 7320 4020 7365 6c66 2e74 7265 655f  ons @ self.tree_
-0002acc0: 7765 6967 6874 5b73 656c 6563 7469 6f6e  weight[selection
-0002acd0: 5f66 6c61 675d 292e 540a 2020 2020 2020  _flag]).T.      
-0002ace0: 2020 656c 6966 206c 656e 2877 6569 6768    elif len(weigh
-0002acf0: 745f 6c69 7374 2920 3e20 303a 0a20 2020  t_list) > 0:.   
-0002ad00: 2020 2020 2020 2020 2070 7265 6469 6374           predict
-0002ad10: 696f 6e73 203d 206e 702e 6172 7261 7928  ions = np.array(
-0002ad20: 7072 6564 6963 7469 6f6e 7329 2e54 0a20  predictions).T. 
-0002ad30: 2020 2020 2020 2020 2020 2077 6569 6768             weigh
-0002ad40: 745f 6c69 7374 203d 206e 702e 6172 7261  t_list = np.arra
-0002ad50: 7928 7765 6967 6874 5f6c 6973 7429 0a20  y(weight_list). 
-0002ad60: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0002ad70: 6e20 2870 7265 6469 6374 696f 6e73 2040  n (predictions @
-0002ad80: 2028 7765 6967 6874 5f6c 6973 7420 2f20   (weight_list / 
-0002ad90: 7765 6967 6874 5f6c 6973 742e 7375 6d28  weight_list.sum(
-0002ada0: 2929 292e 540a 2020 2020 2020 2020 656c  ))).T.        el
-0002adb0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0002adc0: 7265 7475 726e 206e 702e 6d65 616e 2870  return np.mean(p
-0002add0: 7265 6469 6374 696f 6e73 2c20 6178 6973  redictions, axis
-0002ade0: 3d30 290a 0a20 2020 2064 6566 206c 617a  =0)..    def laz
-0002adf0: 795f 696e 6974 2873 656c 662c 2078 293a  y_init(self, x):
-0002ae00: 0a20 2020 2020 2020 2023 2065 6e63 6f64  .        # encod
-0002ae10: 696e 6720 7461 7267 6574 206c 6162 656c  ing target label
-0002ae20: 730a 2020 2020 2020 2020 7365 6c66 2e6c  s.        self.l
-0002ae30: 6162 656c 5f65 6e63 6f64 6572 203d 204f  abel_encoder = O
-0002ae40: 6e65 486f 7445 6e63 6f64 6572 2873 7061  neHotEncoder(spa
-0002ae50: 7273 653d 4661 6c73 6529 0a20 2020 2020  rse=False).     
-0002ae60: 2020 2073 656c 662e 6c61 6265 6c5f 656e     self.label_en
-0002ae70: 636f 6465 722e 6669 7428 7365 6c66 2e79  coder.fit(self.y
-0002ae80: 2e72 6573 6861 7065 282d 312c 2031 2929  .reshape(-1, 1))
-0002ae90: 0a20 2020 2020 2020 2073 7570 6572 2829  .        super()
-0002aea0: 2e6c 617a 795f 696e 6974 2878 290a 2020  .lazy_init(x).  
-0002aeb0: 2020 2020 2020 6966 2073 656c 662e 636c        if self.cl
-0002aec0: 6173 735f 7765 6967 6874 203d 3d20 2742  ass_weight == 'B
-0002aed0: 616c 616e 6365 6427 3a0a 2020 2020 2020  alanced':.      
-0002aee0: 2020 2020 2020 7365 6c66 2e63 6c61 7373        self.class
-0002aef0: 5f77 6569 6768 7420 3d20 636f 6d70 7574  _weight = comput
-0002af00: 655f 7361 6d70 6c65 5f77 6569 6768 7428  e_sample_weight(
-0002af10: 636c 6173 735f 7765 6967 6874 3d27 6261  class_weight='ba
-0002af20: 6c61 6e63 6564 272c 2079 3d73 656c 662e  lanced', y=self.
-0002af30: 7929 0a20 2020 2020 2020 2020 2020 2069  y).            i
-0002af40: 6620 6861 7361 7474 7228 7365 6c66 2e68  f hasattr(self.h
-0002af50: 6f66 2c20 2763 6c61 7373 5f77 6569 6768  of, 'class_weigh
-0002af60: 7427 293a 0a20 2020 2020 2020 2020 2020  t'):.           
-0002af70: 2020 2020 2073 656c 662e 686f 662e 636c       self.hof.cl
-0002af80: 6173 735f 7765 6967 6874 203d 206e 702e  ass_weight = np.
-0002af90: 7265 7368 6170 6528 7365 6c66 2e63 6c61  reshape(self.cla
-0002afa0: 7373 5f77 6569 6768 742c 2028 2d31 2c20  ss_weight, (-1, 
-0002afb0: 3129 290a 2020 2020 2020 2020 6966 2068  1)).        if h
-0002afc0: 6173 6174 7472 2873 656c 662e 686f 662c  asattr(self.hof,
-0002afd0: 2027 7461 736b 5f74 7970 6527 293a 0a20   'task_type'):. 
-0002afe0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0002aff0: 686f 662e 7461 736b 5f74 7970 6520 3d20  hof.task_type = 
-0002b000: 2743 6c61 7373 6966 6963 6174 696f 6e27  'Classification'
-0002b010: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-0002b020: 7374 616e 6365 2873 656c 662e 686f 662c  stance(self.hof,
-0002b030: 2045 6e73 656d 626c 6553 656c 6563 7469   EnsembleSelecti
-0002b040: 6f6e 4861 6c6c 4f66 4661 6d65 293a 0a20  onHallOfFame):. 
-0002b050: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0002b060: 686f 662e 6361 7465 676f 7269 6573 203d  hof.categories =
-0002b070: 206c 656e 286e 702e 756e 6971 7565 2873   len(np.unique(s
-0002b080: 656c 662e 7929 290a 2020 2020 2020 2020  elf.y)).        
-0002b090: 2020 2020 7365 6c66 2e68 6f66 2e6c 6162      self.hof.lab
-0002b0a0: 656c 203d 2073 656c 662e 6c61 6265 6c5f  el = self.label_
-0002b0b0: 656e 636f 6465 722e 7472 616e 7366 6f72  encoder.transfor
-0002b0c0: 6d28 7365 6c66 2e79 2e72 6573 6861 7065  m(self.y.reshape
-0002b0d0: 282d 312c 2031 2929 0a0a 2020 2020 6465  (-1, 1))..    de
-0002b0e0: 6620 656e 7472 6f70 795f 6361 6c63 756c  f entropy_calcul
-0002b0f0: 6174 696f 6e28 7365 6c66 293a 0a20 2020  ation(self):.   
-0002b100: 2020 2020 2069 6620 7365 6c66 2e73 636f       if self.sco
-0002b110: 7265 5f66 756e 6320 3d3d 2027 4e6f 7665  re_func == 'Nove
-0002b120: 6c74 7953 6561 7263 6827 3a0a 2020 2020  ltySearch':.    
-0002b130: 2020 2020 2020 2020 656e 7365 6d62 6c65          ensemble
-0002b140: 5f76 616c 7565 203d 206e 702e 6d65 616e  _value = np.mean
-0002b150: 285b 782e 7072 6564 6963 7465 645f 7661  ([x.predicted_va
-0002b160: 6c75 6573 2066 6f72 2078 2069 6e20 7365  lues for x in se
-0002b170: 6c66 2e68 6f66 5d2c 0a20 2020 2020 2020  lf.hof],.       
-0002b180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b190: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-0002b1a0: 6973 3d30 290a 2020 2020 2020 2020 2020  is=0).          
-0002b1b0: 2020 7365 6c66 2e65 6e73 656d 626c 655f    self.ensemble_
-0002b1c0: 7661 6c75 6520 3d20 656e 7365 6d62 6c65  value = ensemble
-0002b1d0: 5f76 616c 7565 0a20 2020 2020 2020 2020  _value.         
-0002b1e0: 2020 2072 6574 7572 6e20 7365 6c66 2e65     return self.e
-0002b1f0: 6e73 656d 626c 655f 7661 6c75 650a 0a20  nsemble_value.. 
-0002b200: 2020 2064 6566 2063 616c 6375 6c61 7465     def calculate
-0002b210: 5f63 6173 655f 7661 6c75 6573 2873 656c  _case_values(sel
-0002b220: 662c 2069 6e64 6976 6964 7561 6c2c 2065  f, individual, e
-0002b230: 7374 696d 6174 6f72 732c 2059 2c20 795f  stimators, Y, y_
-0002b240: 7072 6564 293a 0a20 2020 2020 2020 2023  pred):.        #
-0002b250: 204d 696e 696d 697a 6520 6669 746e 6573   Minimize fitnes
-0002b260: 7320 7661 6c75 6573 0a20 2020 2020 2020  s values.       
-0002b270: 2069 6620 7365 6c66 2e73 636f 7265 5f66   if self.score_f
-0002b280: 756e 6320 3d3d 2027 4e6f 7665 6c74 7953  unc == 'NoveltyS
-0002b290: 6561 7263 6827 3a0a 2020 2020 2020 2020  earch':.        
-0002b2a0: 2020 2020 5920 3d20 7365 6c66 2e6c 6162      Y = self.lab
-0002b2b0: 656c 5f65 6e63 6f64 6572 2e74 7261 6e73  el_encoder.trans
-0002b2c0: 666f 726d 2859 2e72 6573 6861 7065 282d  form(Y.reshape(-
-0002b2d0: 312c 2031 2929 0a0a 2020 2020 2020 2020  1, 1))..        
-0002b2e0: 2320 736d 616c 6c65 7220 6973 2062 6574  # smaller is bet
-0002b2f0: 7465 720a 2020 2020 2020 2020 6966 2073  ter.        if s
-0002b300: 656c 662e 7363 6f72 655f 6675 6e63 203d  elf.score_func =
-0002b310: 3d20 275a 6572 6f4f 6e65 2720 6f72 2073  = 'ZeroOne' or s
-0002b320: 656c 662e 7363 6f72 655f 6675 6e63 203d  elf.score_func =
-0002b330: 3d20 275a 6572 6f4f 6e65 2d4e 6f64 6543  = 'ZeroOne-NodeC
-0002b340: 6f75 6e74 273a 0a20 2020 2020 2020 2020  ount':.         
-0002b350: 2020 2069 6e64 6976 6964 7561 6c2e 6361     individual.ca
-0002b360: 7365 5f76 616c 7565 7320 3d20 2d31 202a  se_values = -1 *
-0002b370: 2028 795f 7072 6564 2e66 6c61 7474 656e   (y_pred.flatten
-0002b380: 2829 203d 3d20 592e 666c 6174 7465 6e28  () == Y.flatten(
-0002b390: 2929 0a20 2020 2020 2020 2065 6c69 6620  )).        elif 
-0002b3a0: 7365 6c66 2e73 636f 7265 5f66 756e 6320  self.score_func 
-0002b3b0: 3d3d 2027 4356 2d4e 6f64 6543 6f75 6e74  == 'CV-NodeCount
-0002b3c0: 273a 0a20 2020 2020 2020 2020 2020 2069  ':.            i
-0002b3d0: 6e64 6976 6964 7561 6c2e 6361 7365 5f76  ndividual.case_v
-0002b3e0: 616c 7565 7320 3d20 5b65 7374 696d 6174  alues = [estimat
-0002b3f0: 6f72 735b 695d 5b27 5269 6467 6527 5d2e  ors[i]['Ridge'].
-0002b400: 7472 6565 5f2e 6e6f 6465 5f63 6f75 6e74  tree_.node_count
-0002b410: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-0002b420: 6c65 6e28 6573 7469 6d61 746f 7273 2929  len(estimators))
-0002b430: 5d0a 2020 2020 2020 2020 656c 6966 2073  ].        elif s
-0002b440: 656c 662e 7363 6f72 655f 6675 6e63 203d  elf.score_func =
-0002b450: 3d20 2743 4446 4327 3a0a 2020 2020 2020  = 'CDFC':.      
-0002b460: 2020 2020 2020 6d61 7472 6978 203d 2063        matrix = c
-0002b470: 6f6e 6675 7369 6f6e 5f6d 6174 7269 7828  onfusion_matrix(
-0002b480: 592e 666c 6174 7465 6e28 292c 2079 5f70  Y.flatten(), y_p
-0002b490: 7265 642e 666c 6174 7465 6e28 2929 0a20  red.flatten()). 
-0002b4a0: 2020 2020 2020 2020 2020 2073 636f 7265             score
-0002b4b0: 203d 206d 6174 7269 782e 6469 6167 6f6e   = matrix.diagon
-0002b4c0: 616c 2829 202f 206d 6174 7269 782e 7375  al() / matrix.su
-0002b4d0: 6d28 6178 6973 3d31 290a 2020 2020 2020  m(axis=1).      
-0002b4e0: 2020 2020 2020 696e 6469 7669 6475 616c        individual
-0002b4f0: 2e63 6173 655f 7661 6c75 6573 203d 202d  .case_values = -
-0002b500: 3120 2a20 7363 6f72 650a 2020 2020 2020  1 * score.      
-0002b510: 2020 656c 6966 2073 656c 662e 7363 6f72    elif self.scor
-0002b520: 655f 6675 6e63 203d 3d20 2743 726f 7373  e_func == 'Cross
-0002b530: 456e 7472 6f70 7927 206f 7220 7365 6c66  Entropy' or self
-0002b540: 2e73 636f 7265 5f66 756e 6320 3d3d 2027  .score_func == '
-0002b550: 4e6f 7665 6c74 7953 6561 7263 6827 3a0a  NoveltySearch':.
-0002b560: 2020 2020 2020 2020 2020 2020 6f6e 655f              one_
-0002b570: 686f 745f 7461 7267 6574 7320 3d20 4f6e  hot_targets = On
-0002b580: 6548 6f74 456e 636f 6465 7228 7370 6172  eHotEncoder(spar
-0002b590: 7365 3d46 616c 7365 292e 6669 745f 7472  se=False).fit_tr
-0002b5a0: 616e 7366 6f72 6d28 7365 6c66 2e79 2e72  ansform(self.y.r
-0002b5b0: 6573 6861 7065 282d 312c 2031 2929 0a20  eshape(-1, 1)). 
-0002b5c0: 2020 2020 2020 2020 2020 2065 7073 203d             eps =
-0002b5d0: 2031 652d 3135 0a20 2020 2020 2020 2020   1e-15.         
-0002b5e0: 2020 2023 2043 726f 7373 2065 6e74 726f     # Cross entro
-0002b5f0: 7079 0a20 2020 2020 2020 2020 2020 2069  py.            i
-0002b600: 6e64 6976 6964 7561 6c2e 6361 7365 5f76  ndividual.case_v
-0002b610: 616c 7565 7320 3d20 2d31 202a 206e 702e  alues = -1 * np.
-0002b620: 7375 6d28 6f6e 655f 686f 745f 7461 7267  sum(one_hot_targ
-0002b630: 6574 7320 2a20 6e70 2e6c 6f67 286e 702e  ets * np.log(np.
-0002b640: 636c 6970 2879 5f70 7265 642c 2065 7073  clip(y_pred, eps
-0002b650: 2c20 3120 2d20 6570 7329 292c 2061 7869  , 1 - eps)), axi
-0002b660: 733d 3129 0a20 2020 2020 2020 2020 2020  s=1).           
-0002b670: 2061 7373 6572 7420 6e6f 7420 6e70 2e61   assert not np.a
-0002b680: 6e79 286e 702e 6973 6e61 6e28 696e 6469  ny(np.isnan(indi
-0002b690: 7669 6475 616c 2e63 6173 655f 7661 6c75  vidual.case_valu
-0002b6a0: 6573 2929 2c20 7361 7665 5f61 7272 6179  es)), save_array
-0002b6b0: 2869 6e64 6976 6964 7561 6c2e 6361 7365  (individual.case
-0002b6c0: 5f76 616c 7565 7329 0a20 2020 2020 2020  _values).       
-0002b6d0: 2020 2020 2061 7373 6572 7420 6e70 2e73       assert np.s
-0002b6e0: 697a 6528 696e 6469 7669 6475 616c 2e63  ize(individual.c
-0002b6f0: 6173 655f 7661 6c75 6573 2920 3d3d 206e  ase_values) == n
-0002b700: 702e 7369 7a65 2873 656c 662e 7929 0a20  p.size(self.y). 
-0002b710: 2020 2020 2020 2065 6c69 6620 2743 5627         elif 'CV'
-0002b720: 2069 6e20 7365 6c66 2e73 636f 7265 5f66   in self.score_f
-0002b730: 756e 633a 0a20 2020 2020 2020 2020 2020  unc:.           
-0002b740: 2069 6e64 6976 6964 7561 6c2e 6361 7365   individual.case
-0002b750: 5f76 616c 7565 7320 3d20 2d31 202a 2079  _values = -1 * y
-0002b760: 5f70 7265 640a 2020 2020 2020 2020 656c  _pred.        el
+0002a0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a0e0: 2020 2020 6b65 793d 6c61 6d62 6461 2078      key=lambda x
+0002a0f0: 3a20 2878 5b31 5d2c 2078 5b30 5d29 2c0a  : (x[1], x[0]),.
+0002a100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a120: 2072 6576 6572 7365 3d54 7275 6529 2920   reverse=True)) 
+0002a130: 666f 7220 6769 642c 2067 656e 6520 696e  for gid, gene in
+0002a140: 2065 6e75 6d65 7261 7465 286f 2e67 656e   enumerate(o.gen
+0002a150: 6529 5d0a 0a20 2020 2020 2020 2064 796e  e)]..        dyn
+0002a160: 616d 6963 5f74 6872 6573 686f 6c64 203d  amic_threshold =
+0002a170: 206e 702e 6d65 616e 286c 6973 7428 6d61   np.mean(list(ma
+0002a180: 7028 6c61 6d62 6461 2067 3a20 675b 315d  p(lambda g: g[1]
+0002a190: 2c20 6368 6169 6e2e 6672 6f6d 5f69 7465  , chain.from_ite
+0002a1a0: 7261 626c 6528 616c 6c5f 6765 6e65 7329  rable(all_genes)
+0002a1b0: 2929 290a 2020 2020 2020 2020 6479 6e61  ))).        dyna
+0002a1c0: 6d69 635f 7468 7265 7368 6f6c 6420 3d20  mic_threshold = 
+0002a1d0: 6479 6e61 6d69 635f 7468 7265 7368 6f6c  dynamic_threshol
+0002a1e0: 6420 2a20 7365 6c66 2e62 6c6f 6174 5f63  d * self.bloat_c
+0002a1f0: 6f6e 7472 6f6c 2e67 6574 2822 6479 6e61  ontrol.get("dyna
+0002a200: 6d69 635f 7468 7265 7368 6f6c 6422 2c20  mic_threshold", 
+0002a210: 3029 0a0a 2020 2020 2020 2020 6472 6f70  0)..        drop
+0002a220: 6f75 745f 7072 6f62 6162 696c 6974 7920  out_probability 
+0002a230: 3d20 7365 6c66 2e62 6c6f 6174 5f63 6f6e  = self.bloat_con
+0002a240: 7472 6f6c 2e67 6574 2822 6472 6f70 6f75  trol.get("dropou
+0002a250: 745f 7072 6f62 6162 696c 6974 7922 2c20  t_probability", 
+0002a260: 3029 0a20 2020 2020 2020 2073 6861 7265  0).        share
+0002a270: 645f 6765 6e65 203d 2073 656c 662e 626c  d_gene = self.bl
+0002a280: 6f61 745f 636f 6e74 726f 6c2e 6765 7428  oat_control.get(
+0002a290: 2273 6861 7265 645f 6765 6e65 222c 2046  "shared_gene", F
+0002a2a0: 616c 7365 290a 2020 2020 2020 2020 6966  alse).        if
+0002a2b0: 2073 6861 7265 645f 6765 6e65 3a0a 2020   shared_gene:.  
+0002a2c0: 2020 2020 2020 2020 2020 616c 6c5f 6765            all_ge
+0002a2d0: 6e65 7320 3d20 6c69 7374 2873 6f72 7465  nes = list(sorte
+0002a2e0: 6428 6368 6169 6e2e 6672 6f6d 5f69 7465  d(chain.from_ite
+0002a2f0: 7261 626c 6528 616c 6c5f 6765 6e65 7329  rable(all_genes)
+0002a300: 2c20 6b65 793d 6c61 6d62 6461 2078 3a20  , key=lambda x: 
+0002a310: 2878 5b31 5d2c 2078 5b30 5d29 2c20 7265  (x[1], x[0]), re
+0002a320: 7665 7273 653d 5472 7565 2929 0a0a 2020  verse=True))..  
+0002a330: 2020 2020 2020 7768 696c 6520 6c65 6e28        while len(
+0002a340: 6e65 775f 6765 6e65 2920 3c20 7365 6c66  new_gene) < self
+0002a350: 2e67 656e 655f 6e75 6d3a 0a20 2020 2020  .gene_num:.     
+0002a360: 2020 2020 2020 2066 6169 6c20 3d20 5472         fail = Tr
+0002a370: 7565 0a20 2020 2020 2020 2020 2020 2066  ue.            f
+0002a380: 6f72 2065 6964 2c20 6769 6420 696e 206f  or eid, gid in o
+0002a390: 7264 6572 3a0a 2020 2020 2020 2020 2020  rder:.          
+0002a3a0: 2020 2020 2020 6765 6e65 203d 206f 2e67        gene = o.g
+0002a3b0: 656e 655b 6769 645d 0a20 2020 2020 2020  ene[gid].       
+0002a3c0: 2020 2020 2020 2020 2069 6620 686f 6973           if hois
+0002a3d0: 745f 7072 6f62 6162 696c 6974 7920 6973  t_probability is
+0002a3e0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0002a3f0: 2020 2020 2020 2020 2020 2068 6f69 7374             hoist
+0002a400: 5f70 726f 6261 6269 6c69 7479 203d 2073  _probability = s
+0002a410: 656c 662e 626c 6f61 745f 636f 6e74 726f  elf.bloat_contro
+0002a420: 6c2e 6765 7428 2768 6f69 7374 5f70 726f  l.get('hoist_pro
+0002a430: 6261 6269 6c69 7479 272c 2031 290a 2020  bability', 1).  
+0002a440: 2020 2020 2020 2020 2020 2020 2020 686f                ho
+0002a450: 6973 7465 6420 3d20 4661 6c73 650a 2020  isted = False.  
+0002a460: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0002a470: 2072 616e 646f 6d2e 7261 6e64 6f6d 2829   random.random()
+0002a480: 203c 2068 6f69 7374 5f70 726f 6261 6269   < hoist_probabi
+0002a490: 6c69 7479 3a0a 2020 2020 2020 2020 2020  lity:.          
+0002a4a0: 2020 2020 2020 2020 2020 2222 220a 2020            """.  
+0002a4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a4c0: 2020 5461 6b65 2063 6f72 7265 6c61 7469    Take correlati
+0002a4d0: 6f6e 2069 6e74 6f20 636f 6e73 6964 6572  on into consider
+0002a4e0: 6174 696f 6e0a 2020 2020 2020 2020 2020  ation.          
+0002a4f0: 2020 2020 2020 2020 2020 2222 220a 2020            """.  
+0002a500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a510: 2020 6966 2064 726f 706f 7574 5f70 726f    if dropout_pro
+0002a520: 6261 6269 6c69 7479 203e 2030 2061 6e64  bability > 0 and
+0002a530: 2072 616e 646f 6d2e 7261 6e64 6f6d 2829   random.random()
+0002a540: 203c 2064 726f 706f 7574 5f70 726f 6261   < dropout_proba
+0002a550: 6269 6c69 7479 3a0a 2020 2020 2020 2020  bility:.        
+0002a560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a570: 2320 5261 6e64 6f6d 2064 726f 706f 7574  # Random dropout
+0002a580: 2061 2067 656e 650a 2020 2020 2020 2020   a gene.        
+0002a590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a5a0: 6e65 775f 7472 6565 203d 2073 656c 662e  new_tree = self.
+0002a5b0: 6e65 775f 7472 6565 5f67 656e 6572 6174  new_tree_generat
+0002a5c0: 696f 6e28 290a 2020 2020 2020 2020 2020  ion().          
+0002a5d0: 2020 2020 2020 2020 2020 2020 2020 6e65                ne
+0002a5e0: 775f 6765 6e65 2e61 7070 656e 6428 6e65  w_gene.append(ne
+0002a5f0: 775f 7472 6565 290a 2020 2020 2020 2020  w_tree).        
+0002a600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a610: 636f 6e74 696e 7565 0a0a 2020 2020 2020  continue..      
+0002a620: 2020 2020 2020 2020 2020 2020 2020 6e6f                no
+0002a630: 5f63 6865 636b 203d 2073 656c 662e 626c  _check = self.bl
+0002a640: 6f61 745f 636f 6e74 726f 6c2e 6765 7428  oat_control.get(
+0002a650: 226e 6f5f 6368 6563 6b22 2c20 4661 6c73  "no_check", Fals
+0002a660: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
+0002a670: 2020 2020 2020 2069 6620 7368 6172 6564         if shared
+0002a680: 5f67 656e 653a 0a20 2020 2020 2020 2020  _gene:.         
+0002a690: 2020 2020 2020 2020 2020 2020 2020 2067                 g
+0002a6a0: 656e 655f 6c69 7374 203d 2061 6c6c 5f67  ene_list = all_g
+0002a6b0: 656e 6573 0a20 2020 2020 2020 2020 2020  enes.           
+0002a6c0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0002a6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a6e0: 2020 2020 2020 2067 656e 655f 6c69 7374         gene_list
+0002a6f0: 203d 2061 6c6c 5f67 656e 6573 5b67 6964   = all_genes[gid
+0002a700: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0002a710: 2020 2020 2020 666f 7220 635f 696e 6465        for c_inde
+0002a720: 782c 2063 616e 6469 6461 7465 5f69 6420  x, candidate_id 
+0002a730: 696e 2065 6e75 6d65 7261 7465 2867 656e  in enumerate(gen
+0002a740: 655f 6c69 7374 293a 0a20 2020 2020 2020  e_list):.       
+0002a750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a760: 2069 6620 7368 6172 6564 5f67 656e 653a   if shared_gene:
+0002a770: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002a780: 2020 2020 2020 2020 2020 2020 2067 656e               gen
+0002a790: 6520 3d20 6f2e 6765 6e65 5b63 616e 6469  e = o.gene[candi
+0002a7a0: 6461 7465 5f69 645b 325d 5d0a 2020 2020  date_id[2]].    
+0002a7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a7c0: 2020 2020 2320 6765 7420 6120 7374 7269      # get a stri
+0002a7d0: 6e67 206f 6620 6120 7375 6274 7265 650a  ng of a subtree.
+0002a7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a7f0: 2020 2020 2020 2020 7375 625f 7472 6565          sub_tree
+0002a800: 5f69 643a 2073 6c69 6365 203d 2067 656e  _id: slice = gen
+0002a810: 652e 7365 6172 6368 5375 6274 7265 6528  e.searchSubtree(
+0002a820: 6361 6e64 6964 6174 655f 6964 5b30 5d29  candidate_id[0])
+0002a830: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002a840: 2020 2020 2020 2020 2069 6620 6b65 795f           if key_
+0002a850: 6974 656d 203d 3d20 2753 7472 696e 6727  item == 'String'
+0002a860: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002a870: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0002a880: 5374 7269 6e67 2069 7320 7468 6520 7369  String is the si
+0002a890: 6d70 6c65 7374 2077 6179 2074 6f20 6176  mplest way to av
+0002a8a0: 6f69 6420 6964 656e 7469 6361 6c20 6665  oid identical fe
+0002a8b0: 6174 7572 6573 0a20 2020 2020 2020 2020  atures.         
+0002a8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a8d0: 2020 2067 656e 655f 7374 7220 3d20 6765     gene_str = ge
+0002a8e0: 6e65 5f74 6f5f 7374 7269 6e67 2867 656e  ne_to_string(gen
+0002a8f0: 655b 7375 625f 7472 6565 5f69 645d 290a  e[sub_tree_id]).
+0002a900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a910: 2020 2020 2020 2020 656c 6966 206b 6579          elif key
+0002a920: 5f69 7465 6d20 3d3d 2027 436f 7272 656c  _item == 'Correl
+0002a930: 6174 696f 6e27 3a0a 2020 2020 2020 2020  ation':.        
+0002a940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a950: 2020 2020 6765 6e65 5f73 7472 203d 2067      gene_str = g
+0002a960: 656e 655b 7375 625f 7472 6565 5f69 645d  ene[sub_tree_id]
+0002a970: 5b30 5d2e 636f 7272 0a20 2020 2020 2020  [0].corr.       
+0002a980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a990: 2065 6c69 6620 6b65 795f 6974 656d 203d   elif key_item =
+0002a9a0: 3d20 274c 5348 273a 0a20 2020 2020 2020  = 'LSH':.       
+0002a9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a9c0: 2020 2020 2023 204c 5348 2069 7320 616e       # LSH is an
+0002a9d0: 2069 6465 616c 2077 6179 2074 6f20 6176   ideal way to av
+0002a9e0: 6f69 6420 686f 6973 7469 6e67 2073 696d  oid hoisting sim
+0002a9f0: 696c 6172 2066 6561 7475 7265 730a 2020  ilar features.  
+0002aa00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002aa10: 2020 2020 2020 2020 2020 2320 6e70 2e75            # np.u
+0002aa20: 6e69 7175 6528 5b6f 2e68 6173 685f 6964  nique([o.hash_id
+0002aa30: 2066 6f72 206f 2069 6e20 6368 6169 6e2e   for o in chain.
+0002aa40: 6672 6f6d 5f69 7465 7261 626c 6528 6f2e  from_iterable(o.
+0002aa50: 6765 6e65 295d 290a 2020 2020 2020 2020  gene)]).        
+0002aa60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002aa70: 2020 2020 6765 6e65 5f73 7472 203d 2067      gene_str = g
+0002aa80: 656e 655b 7375 625f 7472 6565 5f69 645d  ene[sub_tree_id]
+0002aa90: 5b30 5d2e 6861 7368 5f69 640a 2020 2020  [0].hash_id.    
+0002aaa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002aab0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0002aac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002aad0: 2020 2020 2020 7261 6973 6520 4578 6365        raise Exce
+0002aae0: 7074 696f 6e28 2255 6e65 7870 6563 7465  ption("Unexpecte
+0002aaf0: 6420 4b65 7921 2229 0a0a 2020 2020 2020  d Key!")..      
+0002ab00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ab10: 2020 6966 206e 6f5f 6368 6563 6b20 6f72    if no_check or
+0002ab20: 2028 6765 6e65 5f73 7472 206e 6f74 2069   (gene_str not i
+0002ab30: 6e20 7072 6576 696f 7573 5f67 656e 6520  n previous_gene 
+0002ab40: 616e 640a 2020 2020 2020 2020 2020 2020  and.            
+0002ab50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ab60: 2020 2020 2020 2020 2020 2020 6765 7461              geta
+0002ab70: 7474 7228 6765 6e65 5b63 616e 6469 6461  ttr(gene[candida
+0002ab80: 7465 5f69 645b 305d 5d2c 2027 636f 7272  te_id[0]], 'corr
+0002ab90: 272c 2030 2920 3e20 6479 6e61 6d69 635f  ', 0) > dynamic_
+0002aba0: 7468 7265 7368 6f6c 6429 3a0a 2020 2020  threshold):.    
+0002abb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002abc0: 2020 2020 2020 2020 2320 6e65 7665 7220          # never 
+0002abd0: 686f 6973 7420 6120 7265 6475 6e64 616e  hoist a redundan
+0002abe0: 7420 6765 6e65 206f 7220 6120 6972 7265  t gene or a irre
+0002abf0: 6c65 7661 6e74 2067 656e 650a 2020 2020  levant gene.    
+0002ac00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ac10: 2020 2020 2020 2020 7072 6576 696f 7573          previous
+0002ac20: 5f67 656e 652e 6164 6428 6765 6e65 5f73  _gene.add(gene_s
+0002ac30: 7472 290a 2020 2020 2020 2020 2020 2020  tr).            
+0002ac40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ac50: 6e65 775f 6765 6e65 2e61 7070 656e 6428  new_gene.append(
+0002ac60: 686f 6973 744d 7574 6174 696f 6e28 636f  hoistMutation(co
+0002ac70: 7079 2e64 6565 7063 6f70 7928 6765 6e65  py.deepcopy(gene
+0002ac80: 292c 2063 616e 6469 6461 7465 5f69 645b  ), candidate_id[
+0002ac90: 305d 2929 0a20 2020 2020 2020 2020 2020  0])).           
+0002aca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002acb0: 2068 6f69 7374 6564 203d 2054 7275 650a   hoisted = True.
+0002acc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002acd0: 2020 2020 2020 2020 2020 2020 2320 616e              # an
+0002ace0: 7920 7375 6363 6573 7366 756c 2068 6f69  y successful hoi
+0002acf0: 7374 2069 7320 6f6b 6179 0a20 2020 2020  st is okay.     
+0002ad00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ad10: 2020 2020 2020 2066 6169 6c20 3d20 4661         fail = Fa
+0002ad20: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
+0002ad30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ad40: 2320 616c 6c20 7072 6576 696f 7573 2067  # all previous g
+0002ad50: 656e 6573 2061 7265 206e 6f74 2072 652d  enes are not re-
+0002ad60: 7573 6162 6c65 2c20 7468 7573 2073 6b69  usable, thus ski
+0002ad70: 7020 7468 656d 0a20 2020 2020 2020 2020  p them.         
+0002ad80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ad90: 2020 2069 6620 7368 6172 6564 5f67 656e     if shared_gen
+0002ada0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0002adb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002adc0: 2020 2061 6c6c 5f67 656e 6573 203d 2061     all_genes = a
+0002add0: 6c6c 5f67 656e 6573 5b63 5f69 6e64 6578  ll_genes[c_index
+0002ade0: 202b 2031 3a5d 0a20 2020 2020 2020 2020   + 1:].         
+0002adf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ae00: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0002ae10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ae20: 2020 2020 2020 2020 2061 6c6c 5f67 656e           all_gen
+0002ae30: 6573 5b67 6964 5d20 3d20 616c 6c5f 6765  es[gid] = all_ge
+0002ae40: 6e65 735b 6769 645d 5b63 5f69 6e64 6578  nes[gid][c_index
+0002ae50: 202b 2031 3a5d 0a20 2020 2020 2020 2020   + 1:].         
+0002ae60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ae70: 2020 2062 7265 616b 0a0a 2020 2020 2020     break..      
+0002ae80: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0002ae90: 206e 6f74 2068 6f69 7374 6564 2061 6e64   not hoisted and
+0002aea0: 2073 656c 662e 626c 6f61 745f 636f 6e74   self.bloat_cont
+0002aeb0: 726f 6c2e 6765 7428 2266 6561 7475 7265  rol.get("feature
+0002aec0: 5f72 6569 6e69 7469 616c 697a 6174 696f  _reinitializatio
+0002aed0: 6e22 2c20 4661 6c73 6529 2061 6e64 206e  n", False) and n
+0002aee0: 6f74 206e 6f5f 6368 6563 6b3a 0a20 2020  ot no_check:.   
+0002aef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002af00: 2020 2020 2069 6620 7368 6172 6564 5f67       if shared_g
+0002af10: 656e 653a 0a20 2020 2020 2020 2020 2020  ene:.           
+0002af20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002af30: 2061 6c6c 5f67 656e 6573 203d 205b 5d0a   all_genes = [].
+0002af40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002af50: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0002af60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002af70: 2020 2020 2020 2020 2020 616c 6c5f 6765            all_ge
+0002af80: 6e65 735b 6769 645d 203d 205b 5d0a 2020  nes[gid] = [].  
+0002af90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002afa0: 2020 2020 2020 6e65 775f 7472 6565 203d        new_tree =
+0002afb0: 2073 656c 662e 6e65 775f 7472 6565 5f67   self.new_tree_g
+0002afc0: 656e 6572 6174 696f 6e28 290a 2020 2020  eneration().    
+0002afd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002afe0: 2020 2020 6e65 775f 6765 6e65 2e61 7070      new_gene.app
+0002aff0: 656e 6428 6e65 775f 7472 6565 290a 2020  end(new_tree).  
+0002b000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b010: 2020 2020 2020 636f 6e74 696e 7565 0a0a        continue..
+0002b020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b030: 2020 2020 6966 206e 6f74 2068 6f69 7374      if not hoist
+0002b040: 6564 2061 6e64 2073 656c 662e 626c 6f61  ed and self.bloa
+0002b050: 745f 636f 6e74 726f 6c2e 6765 7428 2264  t_control.get("d
+0002b060: 6f5f 6e6f 7468 696e 6722 2c20 4661 6c73  o_nothing", Fals
+0002b070: 6529 2061 6e64 206e 6f74 206e 6f5f 6368  e) and not no_ch
+0002b080: 6563 6b3a 0a20 2020 2020 2020 2020 2020  eck:.           
+0002b090: 2020 2020 2020 2020 2020 2020 206e 6577               new
+0002b0a0: 5f67 656e 652e 6170 7065 6e64 2867 656e  _gene.append(gen
+0002b0b0: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
+0002b0c0: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
+0002b0d0: 6e75 650a 0a20 2020 2020 2020 2020 2020  nue..           
+0002b0e0: 2020 2020 2020 2020 2023 2061 6464 2061           # add a
+0002b0f0: 207a 6572 6f20 7472 6565 0a20 2020 2020   zero tree.     
+0002b100: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0002b110: 6620 6e6f 7420 686f 6973 7465 6420 616e  f not hoisted an
+0002b120: 6420 7365 6c66 2e62 6c6f 6174 5f63 6f6e  d self.bloat_con
+0002b130: 7472 6f6c 2e67 6574 2822 7a65 726f 5f74  trol.get("zero_t
+0002b140: 7265 6522 2c20 4661 6c73 6529 2061 6e64  ree", False) and
+0002b150: 206e 6f74 206e 6f5f 6368 6563 6b3a 0a20   not no_check:. 
+0002b160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b170: 2020 2020 2020 206e 6577 5f67 656e 652e         new_gene.
+0002b180: 6170 7065 6e64 2850 7269 6d69 7469 7665  append(Primitive
+0002b190: 5472 6565 285b 5465 726d 696e 616c 2830  Tree([Terminal(0
+0002b1a0: 2c20 4661 6c73 652c 206f 626a 6563 7429  , False, object)
+0002b1b0: 5d29 290a 2020 2020 2020 2020 2020 2020  ])).            
+0002b1c0: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
+0002b1d0: 696e 7565 0a0a 2020 2020 2020 2020 2020  inue..          
+0002b1e0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+0002b1f0: 2068 6f69 7374 6564 2061 6e64 206e 6f74   hoisted and not
+0002b200: 2069 7465 7261 7469 7665 6c79 5f63 6865   iteratively_che
+0002b210: 636b 3a0a 2020 2020 2020 2020 2020 2020  ck:.            
+0002b220: 2020 2020 2020 2020 2020 2020 2222 220a              """.
+0002b230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b240: 2020 2020 2020 2020 416c 6c20 706f 7373          All poss
+0002b250: 6962 6c65 206f 7065 7261 7469 6f6e 733a  ible operations:
+0002b260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002b270: 2020 2020 2020 2020 2031 2e20 5261 6e64           1. Rand
+0002b280: 6f6d 6c79 2069 6e69 7469 616c 697a 6520  omly initialize 
+0002b290: 6120 6e65 7720 7472 6565 0a20 2020 2020  a new tree.     
+0002b2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b2b0: 2020 2032 2e20 4765 6e65 7261 7465 2061     2. Generate a
+0002b2c0: 207a 6572 6f20 7472 6565 0a20 2020 2020   zero tree.     
+0002b2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b2e0: 2020 2033 2e20 536b 6970 2063 6865 636b     3. Skip check
+0002b2f0: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
+0002b300: 2020 2020 2020 2020 2020 2020 342e 2049              4. I
+0002b310: 7465 7261 7469 7665 6c79 2063 6865 636b  teratively check
+0002b320: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002b330: 2020 2020 2020 2020 2022 2222 0a20 2020           """.   
+0002b340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b350: 2020 2020 2072 6169 7365 2045 7863 6570       raise Excep
+0002b360: 7469 6f6e 2866 2754 6865 7265 2069 7320  tion(f'There is 
+0002b370: 6e6f 2061 7661 696c 6162 6c65 206f 7065  no available ope
+0002b380: 7261 7469 6f6e 2066 6f72 2074 7265 6520  ration for tree 
+0002b390: 7b67 6964 7d21 2729 0a20 2020 2020 2020  {gid}!').       
+0002b3a0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0002b3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b3c0: 2020 206e 6577 5f67 656e 652e 6170 7065     new_gene.appe
+0002b3d0: 6e64 2867 656e 6529 0a0a 2020 2020 2020  nd(gene)..      
+0002b3e0: 2020 2020 2020 6966 206e 6f74 2069 7465        if not ite
+0002b3f0: 7261 7469 7665 6c79 5f63 6865 636b 206f  ratively_check o
+0002b400: 7220 6661 696c 3a0a 2020 2020 2020 2020  r fail:.        
+0002b410: 2020 2020 2020 2020 6272 6561 6b0a 0a20          break.. 
+0002b420: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
+0002b430: 6e28 6e65 775f 6765 6e65 2920 3e3d 2030  n(new_gene) >= 0
+0002b440: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+0002b450: 6974 6572 6174 6976 656c 795f 6368 6563  iteratively_chec
+0002b460: 6b3a 0a20 2020 2020 2020 2020 2020 2061  k:.            a
+0002b470: 7373 6572 7420 6c65 6e28 6e65 775f 6765  ssert len(new_ge
+0002b480: 6e65 2920 3d3d 2073 656c 662e 6765 6e65  ne) == self.gene
+0002b490: 5f6e 756d 2c20 6627 4e75 6d62 6572 206f  _num, f'Number o
+0002b4a0: 6620 4765 6e65 7320 7b6c 656e 286e 6577  f Genes {len(new
+0002b4b0: 5f67 656e 6529 7d27 0a20 2020 2020 2020  _gene)}'.       
+0002b4c0: 2023 206d 6179 2073 616d 706c 6520 6d6f   # may sample mo
+0002b4d0: 7265 2074 7265 6573 2c20 6a75 7374 2074  re trees, just t
+0002b4e0: 616b 696e 6720 6120 6665 7720 6973 2065  aking a few is e
+0002b4f0: 6e6f 7567 680a 2020 2020 2020 2020 6e65  nough.        ne
+0002b500: 775f 6765 6e65 203d 206e 6577 5f67 656e  w_gene = new_gen
+0002b510: 655b 3a73 656c 662e 6765 6e65 5f6e 756d  e[:self.gene_num
+0002b520: 5d0a 2020 2020 2020 2020 7768 696c 6520  ].        while 
+0002b530: 6c65 6e28 6e65 775f 6765 6e65 2920 3c20  len(new_gene) < 
+0002b540: 7365 6c66 2e67 656e 655f 6e75 6d3a 0a20  self.gene_num:. 
+0002b550: 2020 2020 2020 2020 2020 206e 6577 5f74             new_t
+0002b560: 7265 6520 3d20 7365 6c66 2e6e 6577 5f74  ree = self.new_t
+0002b570: 7265 655f 6765 6e65 7261 7469 6f6e 2829  ree_generation()
+0002b580: 0a20 2020 2020 2020 2020 2020 206e 6577  .            new
+0002b590: 5f67 656e 652e 6170 7065 6e64 286e 6577  _gene.append(new
+0002b5a0: 5f74 7265 6529 0a20 2020 2020 2020 2061  _tree).        a
+0002b5b0: 7373 6572 7420 6c65 6e28 6e65 775f 6765  ssert len(new_ge
+0002b5c0: 6e65 2920 3d3d 2073 656c 662e 6765 6e65  ne) == self.gene
+0002b5d0: 5f6e 756d 2c20 6627 4e75 6d62 6572 206f  _num, f'Number o
+0002b5e0: 6620 4765 6e65 7320 7b6c 656e 286e 6577  f Genes {len(new
+0002b5f0: 5f67 656e 6529 7d27 0a20 2020 2020 2020  _gene)}'.       
+0002b600: 206f 2e67 656e 6520 3d20 6e65 775f 6765   o.gene = new_ge
+0002b610: 6e65 0a0a 2020 2020 6465 6620 6e65 775f  ne..    def new_
+0002b620: 7472 6565 5f67 656e 6572 6174 696f 6e28  tree_generation(
+0002b630: 7365 6c66 293a 0a20 2020 2020 2020 2023  self):.        #
+0002b640: 2072 616e 646f 6d6c 7920 6765 6e65 7261   randomly genera
+0002b650: 7465 2061 206e 6577 2074 7265 650a 2020  te a new tree.  
+0002b660: 2020 2020 2020 2320 5265 7475 726e 3a20        # Return: 
+0002b670: 6120 6e65 7720 6765 6e65 0a20 2020 2020  a new gene.     
+0002b680: 2020 2074 7265 655f 7369 7a65 203d 204e     tree_size = N
+0002b690: 6f6e 650a 2020 2020 2020 2020 6966 2073  one.        if s
+0002b6a0: 656c 662e 626c 6f61 745f 636f 6e74 726f  elf.bloat_contro
+0002b6b0: 6c20 6973 206e 6f74 204e 6f6e 653a 0a20  l is not None:. 
+0002b6c0: 2020 2020 2020 2020 2020 2074 7265 655f             tree_
+0002b6d0: 7369 7a65 203d 2073 656c 662e 626c 6f61  size = self.bloa
+0002b6e0: 745f 636f 6e74 726f 6c2e 6765 7428 2272  t_control.get("r
+0002b6f0: 6569 6e69 7469 616c 697a 6174 696f 6e5f  einitialization_
+0002b700: 7472 6565 5f73 697a 6522 2c20 4e6f 6e65  tree_size", None
+0002b710: 290a 0a20 2020 2020 2020 2069 6620 7472  )..        if tr
+0002b720: 6565 5f73 697a 6520 6973 204e 6f6e 653a  ee_size is None:
+0002b730: 0a20 2020 2020 2020 2020 2020 2061 2c20  .            a, 
+0002b740: 6220 3d20 7365 6c66 2e69 6e69 7469 616c  b = self.initial
+0002b750: 5f74 7265 655f 7369 7a65 2e73 706c 6974  _tree_size.split
+0002b760: 2827 2d27 290a 2020 2020 2020 2020 656c  ('-').        el
 0002b770: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0002b780: 7261 6973 6520 4578 6365 7074 696f 6e0a  raise Exception.
-0002b790: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-0002b7a0: 2e73 636f 7265 5f66 756e 6320 3d3d 2027  .score_func == '
-0002b7b0: 4e6f 7665 6c74 7953 6561 7263 6827 3a0a  NoveltySearch':.
-0002b7c0: 2020 2020 2020 2020 2020 2020 696e 6469              indi
-0002b7d0: 7669 6475 616c 2e6f 7269 6769 6e61 6c5f  vidual.original_
-0002b7e0: 6361 7365 5f76 616c 7565 7320 3d20 696e  case_values = in
-0002b7f0: 6469 7669 6475 616c 2e63 6173 655f 7661  dividual.case_va
-0002b800: 6c75 6573 0a20 2020 2020 2020 2020 2020  lues.           
-0002b810: 2023 204b 4c2d 4469 7665 7267 656e 6365   # KL-Divergence
-0002b820: 2066 6f72 2072 6567 756c 6172 697a 6174   for regularizat
-0002b830: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
-0002b840: 6966 206c 656e 2873 656c 662e 686f 6629  if len(self.hof)
-0002b850: 2021 3d20 303a 0a20 2020 2020 2020 2020   != 0:.         
-0002b860: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0002b870: 2020 2020 2020 2020 2020 2043 6f6f 7065             Coope
-0002b880: 7261 7469 6f6e 2076 7320 4469 7665 7273  ration vs Divers
-0002b890: 6974 793a 0a20 2020 2020 2020 2020 2020  ity:.           
-0002b8a0: 2020 2020 2022 4469 7665 7273 6974 7920       "Diversity 
-0002b8b0: 7769 7468 2043 6f6f 7065 7261 7469 6f6e  with Cooperation
-0002b8c0: 3a20 456e 7365 6d62 6c65 204d 6574 686f  : Ensemble Metho
-0002b8d0: 6473 2066 6f72 2046 6577 2d53 686f 7420  ds for Few-Shot 
-0002b8e0: 436c 6173 7369 6669 6361 7469 6f6e 2220  Classification" 
-0002b8f0: 4943 4356 2032 3031 390a 2020 2020 2020  ICCV 2019.      
-0002b900: 2020 2020 2020 2020 2020 2222 220a 2020            """.  
-0002b910: 2020 2020 2020 2020 2020 2020 2020 656e                en
-0002b920: 7365 6d62 6c65 5f76 616c 7565 203d 2073  semble_value = s
-0002b930: 656c 662e 656e 7365 6d62 6c65 5f76 616c  elf.ensemble_val
-0002b940: 7565 0a20 2020 2020 2020 2020 2020 2020  ue.             
-0002b950: 2020 2069 6620 7365 6c66 2e64 6976 6572     if self.diver
-0002b960: 7369 7479 5f6d 6574 7269 6320 3d3d 2027  sity_metric == '
-0002b970: 436f 7369 6e65 5369 6d69 6c61 7269 7479  CosineSimilarity
-0002b980: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
-0002b990: 2020 2020 2020 2023 2063 6f73 696e 6520         # cosine 
-0002b9a0: 7369 6d69 6c61 7269 7479 0a20 2020 2020  similarity.     
-0002b9b0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0002b9c0: 206c 6172 6765 7220 696e 6469 6361 7465   larger indicate
-0002b9d0: 7320 7369 6d69 6c61 720a 2020 2020 2020  s similar.      
-0002b9e0: 2020 2020 2020 2020 2020 2020 2020 6570                ep
-0002b9f0: 7320 3d20 3165 2d31 350a 2020 2020 2020  s = 1e-15.      
-0002ba00: 2020 2020 2020 2020 2020 2020 2020 616d                am
-0002ba10: 6269 6775 6974 7920 3d20 6e70 2e73 756d  biguity = np.sum
-0002ba20: 2828 795f 7072 6564 202a 2065 6e73 656d  ((y_pred * ensem
-0002ba30: 626c 655f 7661 6c75 6529 2c20 6178 6973  ble_value), axis
-0002ba40: 3d31 2920 2f20 5c0a 2020 2020 2020 2020  =1) / \.        
-0002ba50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ba60: 2020 2020 2020 2020 6e70 2e6d 6178 696d          np.maxim
-0002ba70: 756d 286e 6f72 6d28 795f 7072 6564 2c20  um(norm(y_pred, 
-0002ba80: 6178 6973 3d31 2920 2a20 6e6f 726d 2865  axis=1) * norm(e
-0002ba90: 6e73 656d 626c 655f 7661 6c75 652c 2061  nsemble_value, a
-0002baa0: 7869 733d 3129 2c20 6570 7329 0a20 2020  xis=1), eps).   
-0002bab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bac0: 2061 7373 6572 7420 6e6f 7420 286e 702e   assert not (np.
-0002bad0: 6973 6e61 6e28 616d 6269 6775 6974 7929  isnan(ambiguity)
-0002bae0: 2e61 6e79 2829 206f 7220 6e70 2e69 7369  .any() or np.isi
-0002baf0: 6e66 2861 6d62 6967 7569 7479 292e 616e  nf(ambiguity).an
-0002bb00: 7928 2929 2c20 7361 7665 5f61 7272 6179  y()), save_array
-0002bb10: 2828 616d 6269 6775 6974 792c 2079 5f70  ((ambiguity, y_p
-0002bb20: 7265 642c 0a20 2020 2020 2020 2020 2020  red,.           
-0002bb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bb80: 2020 2020 2020 2020 2020 656e 7365 6d62            ensemb
-0002bb90: 6c65 5f76 616c 7565 2929 0a20 2020 2020  le_value)).     
-0002bba0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-0002bbb0: 7365 6c66 2e64 6976 6572 7369 7479 5f6d  self.diversity_m
-0002bbc0: 6574 7269 6320 3d3d 2027 4b4c 2d44 6976  etric == 'KL-Div
-0002bbd0: 6572 6765 6e63 6527 3a0a 2020 2020 2020  ergence':.      
-0002bbe0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0002bbf0: 736d 616c 6c65 7220 696e 6469 6361 7465  smaller indicate
-0002bc00: 7320 7369 6d69 6c61 720a 2020 2020 2020  s similar.      
-0002bc10: 2020 2020 2020 2020 2020 2020 2020 6b6c                kl
-0002bc20: 5f64 6976 6572 6765 6e63 6520 3d20 6c61  _divergence = la
-0002bc30: 6d62 6461 2061 2c20 623a 206e 702e 7375  mbda a, b: np.su
-0002bc40: 6d28 6e70 2e6e 616e 5f74 6f5f 6e75 6d28  m(np.nan_to_num(
-0002bc50: 6120 2a20 6e70 2e6c 6f67 2861 202f 2062  a * np.log(a / b
-0002bc60: 292c 2070 6f73 696e 663d 302c 206e 6567  ), posinf=0, neg
-0002bc70: 696e 663d 3029 2c20 6178 6973 3d31 290a  inf=0), axis=1).
-0002bc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bc90: 2020 2020 616d 6269 6775 6974 7920 3d20      ambiguity = 
-0002bca0: 286b 6c5f 6469 7665 7267 656e 6365 2879  (kl_divergence(y
-0002bcb0: 5f70 7265 642c 2065 6e73 656d 626c 655f  _pred, ensemble_
-0002bcc0: 7661 6c75 6529 202b 206b 6c5f 6469 7665  value) + kl_dive
-0002bcd0: 7267 656e 6365 2865 6e73 656d 626c 655f  rgence(ensemble_
-0002bce0: 7661 6c75 652c 2079 5f70 7265 6429 2920  value, y_pred)) 
-0002bcf0: 2f20 320a 2020 2020 2020 2020 2020 2020  / 2.            
-0002bd00: 2020 2020 2020 2020 6173 7365 7274 206e          assert n
-0002bd10: 6f74 2028 6e70 2e69 736e 616e 2861 6d62  ot (np.isnan(amb
-0002bd20: 6967 7569 7479 292e 616e 7928 2920 6f72  iguity).any() or
-0002bd30: 206e 702e 6973 696e 6628 616d 6269 6775   np.isinf(ambigu
-0002bd40: 6974 7929 2e61 6e79 2829 292c 2073 6176  ity).any()), sav
-0002bd50: 655f 6172 7261 7928 2861 6d62 6967 7569  e_array((ambigui
-0002bd60: 7479 2c20 795f 7072 6564 2c0a 2020 2020  ty, y_pred,.    
-0002bd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bdb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bdd0: 2065 6e73 656d 626c 655f 7661 6c75 6529   ensemble_value)
-0002bde0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0002bdf0: 2020 2020 2020 616d 6269 6775 6974 7920        ambiguity 
-0002be00: 2a3d 202d 310a 2020 2020 2020 2020 2020  *= -1.          
-0002be10: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0002be20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002be30: 7261 6973 6520 4578 6365 7074 696f 6e0a  raise Exception.
-0002be40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002be50: 616d 6269 6775 6974 7920 2a3d 2073 656c  ambiguity *= sel
-0002be60: 662e 6e6f 7665 6c74 795f 7765 6967 6874  f.novelty_weight
-0002be70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002be80: 2069 6620 7365 6c66 2e65 6e73 656d 626c   if self.ensembl
-0002be90: 655f 636f 6f70 6572 6174 696f 6e3a 0a20  e_cooperation:. 
-0002bea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002beb0: 2020 2069 6e64 6976 6964 7561 6c2e 6361     individual.ca
-0002bec0: 7365 5f76 616c 7565 7320 3d20 696e 6469  se_values = indi
-0002bed0: 7669 6475 616c 2e63 6173 655f 7661 6c75  vidual.case_valu
-0002bee0: 6573 202d 2061 6d62 6967 7569 7479 0a20  es - ambiguity. 
-0002bef0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0002bf00: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0002bf10: 2020 2020 2020 2020 2069 6e64 6976 6964           individ
-0002bf20: 7561 6c2e 6361 7365 5f76 616c 7565 7320  ual.case_values 
-0002bf30: 3d20 696e 6469 7669 6475 616c 2e63 6173  = individual.cas
-0002bf40: 655f 7661 6c75 6573 202b 2061 6d62 6967  e_values + ambig
-0002bf50: 7569 7479 0a20 2020 2020 2020 2020 2020  uity.           
-0002bf60: 2020 2020 2061 7373 6572 7420 6e6f 7420       assert not 
-0002bf70: 286e 702e 6973 6e61 6e28 696e 6469 7669  (np.isnan(indivi
-0002bf80: 6475 616c 2e63 6173 655f 7661 6c75 6573  dual.case_values
-0002bf90: 292e 616e 7928 2920 6f72 206e 702e 6973  ).any() or np.is
-0002bfa0: 696e 6628 696e 6469 7669 6475 616c 2e63  inf(individual.c
-0002bfb0: 6173 655f 7661 6c75 6573 292e 616e 7928  ase_values).any(
-0002bfc0: 2929 0a0a 2020 2020 2020 2020 6966 2073  ))..        if s
-0002bfd0: 656c 662e 636c 6173 735f 7765 6967 6874  elf.class_weight
-0002bfe0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0002bff0: 2020 2020 2020 2020 2020 696e 6469 7669            indivi
-0002c000: 6475 616c 2e63 6173 655f 7661 6c75 6573  dual.case_values
-0002c010: 203d 2069 6e64 6976 6964 7561 6c2e 6361   = individual.ca
-0002c020: 7365 5f76 616c 7565 7320 2a20 7365 6c66  se_values * self
-0002c030: 2e63 6c61 7373 5f77 6569 6768 740a 0a20  .class_weight.. 
-0002c040: 2020 2064 6566 2067 6574 5f64 6976 6572     def get_diver
-0002c050: 7369 7479 5f6d 6174 7269 7828 7365 6c66  sity_matrix(self
-0002c060: 2c20 616c 6c5f 696e 6429 3a0a 2020 2020  , all_ind):.    
-0002c070: 2020 2020 696e 6473 203d 205b 5d0a 2020      inds = [].  
-0002c080: 2020 2020 2020 666f 7220 7020 696e 2061        for p in a
-0002c090: 6c6c 5f69 6e64 3a0a 2020 2020 2020 2020  ll_ind:.        
-0002c0a0: 2020 2020 795f 7072 6564 5f6f 6e65 5f68      y_pred_one_h
-0002c0b0: 6f74 203d 2070 2e70 7265 6469 6374 6564  ot = p.predicted
-0002c0c0: 5f76 616c 7565 730a 2020 2020 2020 2020  _values.        
-0002c0d0: 2020 2020 696e 6473 2e61 7070 656e 6428      inds.append(
-0002c0e0: 795f 7072 6564 5f6f 6e65 5f68 6f74 2e66  y_pred_one_hot.f
-0002c0f0: 6c61 7474 656e 2829 290a 2020 2020 2020  latten()).      
-0002c100: 2020 696e 6473 203d 206e 702e 6172 7261    inds = np.arra
-0002c110: 7928 696e 6473 290a 2020 2020 2020 2020  y(inds).        
-0002c120: 7265 7475 726e 2069 6e64 730a 0a20 2020  return inds..   
-0002c130: 2064 6566 2063 616c 6375 6c61 7465 5f66   def calculate_f
-0002c140: 6974 6e65 7373 5f76 616c 7565 2873 656c  itness_value(sel
-0002c150: 662c 2069 6e64 6976 6964 7561 6c2c 2065  f, individual, e
-0002c160: 7374 696d 6174 6f72 732c 2059 2c20 795f  stimators, Y, y_
-0002c170: 7072 6564 293a 0a20 2020 2020 2020 2023  pred):.        #
-0002c180: 2073 6d61 6c6c 6572 2069 7320 6265 7474   smaller is bett
-0002c190: 6572 2c20 7369 6d69 6c61 7220 746f 206e  er, similar to n
-0002c1a0: 6567 6174 6976 6520 525e 320a 2020 2020  egative R^2.    
-0002c1b0: 2020 2020 6966 2073 656c 662e 7363 6f72      if self.scor
-0002c1c0: 655f 6675 6e63 203d 3d20 275a 6572 6f4f  e_func == 'ZeroO
-0002c1d0: 6e65 2720 6f72 2073 656c 662e 7363 6f72  ne' or self.scor
-0002c1e0: 655f 6675 6e63 203d 3d20 2743 4446 4327  e_func == 'CDFC'
-0002c1f0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-0002c200: 6c61 7267 6572 2069 7320 6265 7474 6572  larger is better
-0002c210: 0a20 2020 2020 2020 2020 2020 2073 636f  .            sco
-0002c220: 7265 203d 206e 702e 7375 6d28 795f 7072  re = np.sum(y_pr
-0002c230: 6564 2e66 6c61 7474 656e 2829 203d 3d20  ed.flatten() == 
-0002c240: 592e 666c 6174 7465 6e28 2929 0a20 2020  Y.flatten()).   
-0002c250: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-0002c260: 2e77 6569 6768 7465 645f 636f 6566 3a0a  .weighted_coef:.
-0002c270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c280: 696e 6469 7669 6475 616c 2e63 6f65 6620  individual.coef 
-0002c290: 3d20 6e70 2e61 7272 6179 2869 6e64 6976  = np.array(indiv
-0002c2a0: 6964 7561 6c2e 636f 6566 2920 2a20 2873  idual.coef) * (s
-0002c2b0: 636f 7265 290a 2020 2020 2020 2020 2020  core).          
-0002c2c0: 2020 7265 7475 726e 202d 3120 2a20 7363    return -1 * sc
-0002c2d0: 6f72 652c 0a20 2020 2020 2020 2065 6c69  ore,.        eli
-0002c2e0: 6620 7365 6c66 2e73 636f 7265 5f66 756e  f self.score_fun
-0002c2f0: 6320 3d3d 2027 4e6f 7665 6c74 7953 6561  c == 'NoveltySea
-0002c300: 7263 6827 3a0a 2020 2020 2020 2020 2020  rch':.          
-0002c310: 2020 7265 7475 726e 206e 702e 6d65 616e    return np.mean
-0002c320: 2869 6e64 6976 6964 7561 6c2e 6f72 6967  (individual.orig
-0002c330: 696e 616c 5f63 6173 655f 7661 6c75 6573  inal_case_values
-0002c340: 292c 0a20 2020 2020 2020 2065 6c69 6620  ),.        elif 
-0002c350: 7365 6c66 2e73 636f 7265 5f66 756e 6320  self.score_func 
-0002c360: 3d3d 2027 4372 6f73 7345 6e74 726f 7079  == 'CrossEntropy
-0002c370: 273a 0a20 2020 2020 2020 2020 2020 2072  ':.            r
-0002c380: 6574 7572 6e20 6e70 2e6d 6561 6e28 696e  eturn np.mean(in
-0002c390: 6469 7669 6475 616c 2e63 6173 655f 7661  dividual.case_va
-0002c3a0: 6c75 6573 292c 0a20 2020 2020 2020 2065  lues),.        e
-0002c3b0: 6c69 6620 7365 6c66 2e73 636f 7265 5f66  lif self.score_f
-0002c3c0: 756e 6320 3d3d 2027 4356 2d4e 6f64 6543  unc == 'CV-NodeC
-0002c3d0: 6f75 6e74 2720 6f72 2073 656c 662e 7363  ount' or self.sc
-0002c3e0: 6f72 655f 6675 6e63 203d 3d20 275a 6572  ore_func == 'Zer
-0002c3f0: 6f4f 6e65 2d4e 6f64 6543 6f75 6e74 273a  oOne-NodeCount':
-0002c400: 0a20 2020 2020 2020 2020 2020 2073 636f  .            sco
-0002c410: 7265 203d 202d 3120 2a20 6e70 2e73 756d  re = -1 * np.sum
-0002c420: 2879 5f70 7265 642e 666c 6174 7465 6e28  (y_pred.flatten(
-0002c430: 2920 3d3d 2059 2e66 6c61 7474 656e 2829  ) == Y.flatten()
-0002c440: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-0002c450: 7475 726e 206e 702e 6d65 616e 285b 6573  turn np.mean([es
-0002c460: 7469 6d61 746f 7273 5b69 5d5b 2752 6964  timators[i]['Rid
-0002c470: 6765 275d 2e74 7265 655f 2e6e 6f64 655f  ge'].tree_.node_
-0002c480: 636f 756e 7420 666f 7220 6920 696e 2072  count for i in r
-0002c490: 616e 6765 286c 656e 2865 7374 696d 6174  ange(len(estimat
-0002c4a0: 6f72 7329 295d 292c 0a20 2020 2020 2020  ors))]),.       
-0002c4b0: 2065 6c69 6620 2743 5627 2069 6e20 7365   elif 'CV' in se
-0002c4c0: 6c66 2e73 636f 7265 5f66 756e 633a 0a20  lf.score_func:. 
-0002c4d0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0002c4e0: 6e20 2d31 202a 206e 702e 6d65 616e 2879  n -1 * np.mean(y
-0002c4f0: 5f70 7265 6429 2c0a 2020 2020 2020 2020  _pred),.        
-0002c500: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0002c510: 2020 7261 6973 6520 4578 6365 7074 696f    raise Exceptio
-0002c520: 6e0a 0a20 2020 2064 6566 2070 7265 6469  n..    def predi
-0002c530: 6374 2873 656c 662c 2058 2c20 7265 7475  ct(self, X, retu
-0002c540: 726e 5f73 7464 3d46 616c 7365 293a 0a20  rn_std=False):. 
-0002c550: 2020 2020 2020 2070 7265 6469 6374 696f         predictio
-0002c560: 6e73 203d 2073 656c 662e 7072 6564 6963  ns = self.predic
-0002c570: 745f 7072 6f62 6128 5829 0a20 2020 2020  t_proba(X).     
-0002c580: 2020 2061 7373 6572 7420 6e70 2e61 6c6c     assert np.all
-0002c590: 286e 702e 7375 6d28 7072 6564 6963 7469  (np.sum(predicti
-0002c5a0: 6f6e 732c 2061 7869 733d 3129 290a 2020  ons, axis=1)).  
-0002c5b0: 2020 2020 2020 6c61 6265 6c73 203d 206e        labels = n
-0002c5c0: 702e 736f 7274 286e 702e 756e 6971 7565  p.sort(np.unique
-0002c5d0: 2873 656c 662e 7929 290a 2020 2020 2020  (self.y)).      
-0002c5e0: 2020 7265 7475 726e 206c 6162 656c 735b    return labels[
-0002c5f0: 6e70 2e61 7267 6d61 7828 7072 6564 6963  np.argmax(predic
-0002c600: 7469 6f6e 732c 2061 7869 733d 3129 5d0a  tions, axis=1)].
-0002c610: 0a20 2020 2064 6566 2067 6574 5f62 6173  .    def get_bas
-0002c620: 655f 6d6f 6465 6c28 7365 6c66 2c20 7265  e_model(self, re
-0002c630: 6775 6c61 7269 7a61 7469 6f6e 5f72 6174  gularization_rat
-0002c640: 696f 3d31 2c20 6261 7365 5f6d 6f64 656c  io=1, base_model
-0002c650: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-0002c660: 6261 7365 5f6d 6f64 656c 5f73 7472 203d  base_model_str =
-0002c670: 2062 6173 655f 6d6f 6465 6c20 6966 2069   base_model if i
-0002c680: 7369 6e73 7461 6e63 6528 6261 7365 5f6d  sinstance(base_m
-0002c690: 6f64 656c 2c20 7374 7229 2065 6c73 6520  odel, str) else 
-0002c6a0: 2727 0a20 2020 2020 2020 2069 6620 7365  ''.        if se
-0002c6b0: 6c66 2e62 6173 655f 6c65 6172 6e65 7220  lf.base_learner 
-0002c6c0: 3d3d 2027 4454 2720 6f72 2073 656c 662e  == 'DT' or self.
-0002c6d0: 6261 7365 5f6c 6561 726e 6572 203d 3d20  base_learner == 
-0002c6e0: 2750 4341 2d44 5427 206f 7220 5c0a 2020  'PCA-DT' or \.  
-0002c6f0: 2020 2020 2020 2020 2020 7365 6c66 2e62            self.b
-0002c700: 6173 655f 6c65 6172 6e65 7220 3d3d 2027  ase_learner == '
-0002c710: 4479 6e61 6d69 632d 4454 2720 6f72 2062  Dynamic-DT' or b
-0002c720: 6173 655f 6d6f 6465 6c20 3d3d 2027 4454  ase_model == 'DT
-0002c730: 273a 0a20 2020 2020 2020 2020 2020 2072  ':.            r
-0002c740: 6964 6765 5f6d 6f64 656c 203d 2044 6563  idge_model = Dec
-0002c750: 6973 696f 6e54 7265 6543 6c61 7373 6966  isionTreeClassif
-0002c760: 6965 7228 6d61 785f 6465 7074 683d 7365  ier(max_depth=se
-0002c770: 6c66 2e6d 6178 5f74 7265 655f 6465 7074  lf.max_tree_dept
-0002c780: 682c 0a20 2020 2020 2020 2020 2020 2020  h,.             
-0002c790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c7b0: 2020 2020 6d69 6e5f 7361 6d70 6c65 735f      min_samples_
-0002c7c0: 6c65 6166 3d73 656c 662e 6d69 6e5f 7361  leaf=self.min_sa
-0002c7d0: 6d70 6c65 735f 6c65 6166 290a 2020 2020  mples_leaf).    
-0002c7e0: 2020 2020 656c 6966 2073 656c 662e 6261      elif self.ba
-0002c7f0: 7365 5f6c 6561 726e 6572 203d 3d20 2742  se_learner == 'B
-0002c800: 616c 616e 6365 642d 4454 2720 6f72 2062  alanced-DT' or b
-0002c810: 6173 655f 6d6f 6465 6c20 3d3d 2027 4261  ase_model == 'Ba
-0002c820: 6c61 6e63 6564 2d44 5427 3a0a 2020 2020  lanced-DT':.    
-0002c830: 2020 2020 2020 2020 7269 6467 655f 6d6f          ridge_mo
-0002c840: 6465 6c20 3d20 4465 6369 7369 6f6e 5472  del = DecisionTr
-0002c850: 6565 436c 6173 7369 6669 6572 286d 6178  eeClassifier(max
-0002c860: 5f64 6570 7468 3d73 656c 662e 6d61 785f  _depth=self.max_
-0002c870: 7472 6565 5f64 6570 7468 2c0a 2020 2020  tree_depth,.    
-0002c880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b780: 612c 2062 203d 2074 7265 655f 7369 7a65  a, b = tree_size
+0002b790: 2e73 706c 6974 2827 2d27 290a 2020 2020  .split('-').    
+0002b7a0: 2020 2020 612c 2062 203d 2069 6e74 2861      a, b = int(a
+0002b7b0: 292c 2069 6e74 2862 290a 2020 2020 2020  ), int(b).      
+0002b7c0: 2020 2320 6765 6e65 7261 7465 2074 7265    # generate tre
+0002b7d0: 6573 2077 6974 686f 7574 2063 6f72 7265  es without corre
+0002b7e0: 6c61 7469 6f6e 2069 6e66 6f72 6d61 7469  lation informati
+0002b7f0: 6f6e 0a20 2020 2020 2020 2069 6620 7365  on.        if se
+0002b800: 6c66 2e6d 7574 6174 696f 6e5f 7363 6865  lf.mutation_sche
+0002b810: 6d65 2069 6e20 6564 615f 6f70 6572 6174  me in eda_operat
+0002b820: 6f72 733a 0a20 2020 2020 2020 2020 2020  ors:.           
+0002b830: 206e 6577 5f74 7265 6520 3d20 6765 6e46   new_tree = genF
+0002b840: 756c 6c5f 7769 7468 5f70 726f 6228 7365  ull_with_prob(se
+0002b850: 6c66 2e70 7365 742c 2061 2c20 622c 2073  lf.pset, a, b, s
+0002b860: 656c 6629 5b3a 5d0a 2020 2020 2020 2020  elf)[:].        
+0002b870: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0002b880: 2020 6e65 775f 7472 6565 203d 2067 656e    new_tree = gen
+0002b890: 4675 6c6c 2873 656c 662e 7073 6574 2c20  Full(self.pset, 
+0002b8a0: 612c 2062 290a 2020 2020 2020 2020 6e65  a, b).        ne
+0002b8b0: 775f 7472 6565 203d 2050 7269 6d69 7469  w_tree = Primiti
+0002b8c0: 7665 5472 6565 286e 6577 5f74 7265 6529  veTree(new_tree)
+0002b8d0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0002b8e0: 6e65 775f 7472 6565 0a0a 2020 2020 6465  new_tree..    de
+0002b8f0: 6620 6765 6e65 5f70 7275 6e65 2873 656c  f gene_prune(sel
+0002b900: 662c 2067 656e 6529 3a0a 2020 2020 2020  f, gene):.      
+0002b910: 2020 6966 2073 656c 662e 626c 6f61 745f    if self.bloat_
+0002b920: 636f 6e74 726f 6c20 6973 204e 6f6e 6520  control is None 
+0002b930: 6f72 2028 6e6f 7420 7365 6c66 2e62 6c6f  or (not self.blo
+0002b940: 6174 5f63 6f6e 7472 6f6c 2e67 6574 2827  at_control.get('
+0002b950: 686f 6973 745f 6d75 7461 7469 6f6e 272c  hoist_mutation',
+0002b960: 2046 616c 7365 2929 3a0a 2020 2020 2020   False)):.      
+0002b970: 2020 2020 2020 7265 7475 726e 0a20 2020        return.   
+0002b980: 2020 2020 2063 6f6e 7374 616e 745f 7072       constant_pr
+0002b990: 756e 6520 3d20 7365 6c66 2e62 6c6f 6174  une = self.bloat
+0002b9a0: 5f63 6f6e 7472 6f6c 2e67 6574 2827 636f  _control.get('co
+0002b9b0: 6e73 7461 6e74 5f70 7275 6e65 272c 2054  nstant_prune', T
+0002b9c0: 7275 6529 0a20 2020 2020 2020 2069 6620  rue).        if 
+0002b9d0: 636f 6e73 7461 6e74 5f70 7275 6e65 3a0a  constant_prune:.
+0002b9e0: 2020 2020 2020 2020 2020 2020 2320 636f              # co
+0002b9f0: 6e73 7461 6e74 2070 7275 6e65 0a20 2020  nstant prune.   
+0002ba00: 2020 2020 2020 2020 2067 6964 203d 2030           gid = 0
+0002ba10: 0a20 2020 2020 2020 2020 2020 2077 6869  .            whi
+0002ba20: 6c65 2067 6964 203c 206c 656e 2867 656e  le gid < len(gen
+0002ba30: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+0002ba40: 2020 2020 6966 2067 6574 6174 7472 2867      if getattr(g
+0002ba50: 656e 655b 6769 645d 2c20 2763 6f72 7227  ene[gid], 'corr'
+0002ba60: 2c20 4e6f 6e65 2920 3d3d 202d 313a 0a20  , None) == -1:. 
+0002ba70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ba80: 2020 2074 7265 6520 3d20 6765 6e65 2e73     tree = gene.s
+0002ba90: 6561 7263 6853 7562 7472 6565 2867 6964  earchSubtree(gid
+0002baa0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0002bab0: 2020 2020 2020 7661 6c75 6520 3d20 7175        value = qu
+0002bac0: 6963 6b5f 6576 616c 7561 7465 2867 656e  ick_evaluate(gen
+0002bad0: 655b 7472 6565 5d2c 2073 656c 662e 7073  e[tree], self.ps
+0002bae0: 6574 2c20 7365 6c66 2e58 5b3a 315d 290a  et, self.X[:1]).
+0002baf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bb00: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+0002bb10: 6528 7661 6c75 652c 206e 702e 6e64 6172  e(value, np.ndar
+0002bb20: 7261 7929 3a0a 2020 2020 2020 2020 2020  ray):.          
+0002bb30: 2020 2020 2020 2020 2020 2020 2020 7661                va
+0002bb40: 6c75 6520 3d20 7661 6c75 652e 666c 6174  lue = value.flat
+0002bb50: 7465 6e28 295b 305d 0a20 2020 2020 2020  ten()[0].       
+0002bb60: 2020 2020 2020 2020 2020 2020 2063 203d               c =
+0002bb70: 2049 6e74 726f 6e54 6572 6d69 6e61 6c28   IntronTerminal(
+0002bb80: 7661 6c75 652c 2046 616c 7365 2c20 6f62  value, False, ob
+0002bb90: 6a65 6374 290a 2020 2020 2020 2020 2020  ject).          
+0002bba0: 2020 2020 2020 2020 2020 6765 6e65 5b74            gene[t
+0002bbb0: 7265 655d 203d 205b 635d 0a20 2020 2020  ree] = [c].     
+0002bbc0: 2020 2020 2020 2020 2020 2067 6964 202b             gid +
+0002bbd0: 3d20 310a 2020 2020 2020 2020 6571 7561  = 1.        equa
+0002bbe0: 6c5f 7072 756e 6520 3d20 7365 6c66 2e62  l_prune = self.b
+0002bbf0: 6c6f 6174 5f63 6f6e 7472 6f6c 2e67 6574  loat_control.get
+0002bc00: 2827 6571 7561 6c5f 7072 756e 6527 2c20  ('equal_prune', 
+0002bc10: 5472 7565 290a 2020 2020 2020 2020 6966  True).        if
+0002bc20: 2065 7175 616c 5f70 7275 6e65 3a0a 2020   equal_prune:.  
+0002bc30: 2020 2020 2020 2020 2020 6769 6420 3d20            gid = 
+0002bc40: 300a 2020 2020 2020 2020 2020 2020 7768  0.            wh
+0002bc50: 696c 6520 6769 6420 3c20 6c65 6e28 6765  ile gid < len(ge
+0002bc60: 6e65 293a 0a20 2020 2020 2020 2020 2020  ne):.           
+0002bc70: 2020 2020 2065 7175 616c 5f73 7562 7472       equal_subtr
+0002bc80: 6565 203d 2067 6574 6174 7472 2867 656e  ee = getattr(gen
+0002bc90: 655b 6769 645d 2c20 2765 7175 616c 5f73  e[gid], 'equal_s
+0002bca0: 7562 7472 6565 272c 202d 3129 0a20 2020  ubtree', -1).   
+0002bcb0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0002bcc0: 6571 7561 6c5f 7375 6274 7265 6520 3e3d  equal_subtree >=
+0002bcd0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+0002bce0: 2020 2020 2020 2020 7472 6565 203d 2067          tree = g
+0002bcf0: 656e 652e 7365 6172 6368 5375 6274 7265  ene.searchSubtre
+0002bd00: 6528 6769 6429 0a20 2020 2020 2020 2020  e(gid).         
+0002bd10: 2020 2020 2020 2020 2020 2073 7562 7472             subtr
+0002bd20: 6565 203d 2067 6964 202b 2031 0a20 2020  ee = gid + 1.   
+0002bd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bd40: 2073 7562 7472 6565 5f69 6420 3d20 300a   subtree_id = 0.
+0002bd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bd60: 2020 2020 7768 696c 6520 7375 6274 7265      while subtre
+0002bd70: 655f 6964 203c 2065 7175 616c 5f73 7562  e_id < equal_sub
+0002bd80: 7472 6565 3a0a 2020 2020 2020 2020 2020  tree:.          
+0002bd90: 2020 2020 2020 2020 2020 2020 2020 7375                su
+0002bda0: 6274 7265 6520 3d20 6765 6e65 2e73 6561  btree = gene.sea
+0002bdb0: 7263 6853 7562 7472 6565 2873 7562 7472  rchSubtree(subtr
+0002bdc0: 6565 292e 7374 6f70 0a20 2020 2020 2020  ee).stop.       
+0002bdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bde0: 2073 7562 7472 6565 5f69 6420 2b3d 2031   subtree_id += 1
+0002bdf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002be00: 2020 2020 2067 656e 655b 7472 6565 5d20       gene[tree] 
+0002be10: 3d20 6765 6e65 5b67 656e 652e 7365 6172  = gene[gene.sear
+0002be20: 6368 5375 6274 7265 6528 7375 6274 7265  chSubtree(subtre
+0002be30: 6529 5d0a 2020 2020 2020 2020 2020 2020  e)].            
+0002be40: 2020 2020 6769 6420 2b3d 2031 0a0a 2020      gid += 1..  
+0002be50: 2020 6465 6620 7072 756e 655f 616e 645f    def prune_and_
+0002be60: 706c 616e 7428 7365 6c66 2c20 6f66 6673  plant(self, offs
+0002be70: 7072 696e 672c 2062 6573 743d 4661 6c73  pring, best=Fals
+0002be80: 6529 3a0a 2020 2020 2020 2020 6e65 775f  e):.        new_
+0002be90: 706f 7075 6c61 7469 6f6e 203d 205b 5d0a  population = [].
+0002bea0: 2020 2020 2020 2020 666f 7220 6f20 696e          for o in
+0002beb0: 206f 6666 7370 7269 6e67 3a0a 2020 2020   offspring:.    
+0002bec0: 2020 2020 2020 2020 6e65 775f 6f20 3d20          new_o = 
+0002bed0: 636f 7079 2e64 6565 7063 6f70 7928 6f29  copy.deepcopy(o)
+0002bee0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0002bef0: 2069 642c 2067 656e 652c 206e 6577 5f67   id, gene, new_g
+0002bf00: 656e 6520 696e 207a 6970 2872 616e 6765  ene in zip(range
+0002bf10: 2830 2c20 6c65 6e28 6f2e 6765 6e65 2929  (0, len(o.gene))
+0002bf20: 2c20 6f2e 6765 6e65 2c20 6e65 775f 6f2e  , o.gene, new_o.
+0002bf30: 6765 6e65 293a 0a20 2020 2020 2020 2020  gene):.         
+0002bf40: 2020 2020 2020 2023 2061 766f 6964 2074         # avoid t
+0002bf50: 6f20 7072 756e 6520 6120 7472 6976 6961  o prune a trivia
+0002bf60: 6c20 7472 6565 2077 6974 6820 6f6e 6c79  l tree with only
+0002bf70: 206f 6e65 206e 6f64 652c 2061 7320 6974   one node, as it
+0002bf80: 2063 616e 6e6f 7420 7265 6475 6365 2074   cannot reduce t
+0002bf90: 6865 2074 7265 6520 7369 7a65 0a20 2020  he tree size.   
+0002bfa0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+0002bfb0: 6d69 7469 7665 5f6e 6f64 6573 203d 206c  mitive_nodes = l
+0002bfc0: 6973 7428 6669 6c74 6572 286c 616d 6264  ist(filter(lambd
+0002bfd0: 6120 783a 2078 2021 3d20 3020 616e 6420  a x: x != 0 and 
+0002bfe0: 6973 696e 7374 616e 6365 2867 656e 655b  isinstance(gene[
+0002bff0: 785d 2c20 5072 696d 6974 6976 6529 2c20  x], Primitive), 
+0002c000: 7261 6e67 6528 302c 206c 656e 2867 656e  range(0, len(gen
+0002c010: 6529 2929 290a 2020 2020 2020 2020 2020  e)))).          
+0002c020: 2020 2020 2020 6966 206c 656e 2870 7269        if len(pri
+0002c030: 6d69 7469 7665 5f6e 6f64 6573 2920 3d3d  mitive_nodes) ==
+0002c040: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+0002c050: 2020 2020 2020 2020 636f 6e74 696e 7565          continue
+0002c060: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002c070: 2069 6620 6265 7374 3a0a 2020 2020 2020   if best:.      
+0002c080: 2020 2020 2020 2020 2020 2020 2020 6265                be
+0002c090: 7374 5f69 6420 3d20 6d61 7828 5b28 6b2c  st_id = max([(k,
+0002c0a0: 2067 6574 6174 7472 2867 656e 655b 6b5d   getattr(gene[k]
+0002c0b0: 2c20 2763 6f72 7227 2c20 3029 2920 666f  , 'corr', 0)) fo
+0002c0c0: 7220 6b20 696e 2070 7269 6d69 7469 7665  r k in primitive
+0002c0d0: 5f6e 6f64 6573 5d2c 0a20 2020 2020 2020  _nodes],.       
+0002c0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c0f0: 2020 2020 2020 2020 2020 206b 6579 3d6c             key=l
+0002c100: 616d 6264 6120 783a 2028 785b 315d 2c20  ambda x: (x[1], 
+0002c110: 785b 305d 2929 5b30 5d0a 2020 2020 2020  x[0]))[0].      
+0002c120: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+0002c130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c140: 2020 2020 6265 7374 5f69 6420 3d20 7261      best_id = ra
+0002c150: 6e64 6f6d 2e63 686f 6963 6528 7072 696d  ndom.choice(prim
+0002c160: 6974 6976 655f 6e6f 6465 7329 0a20 2020  itive_nodes).   
+0002c170: 2020 2020 2020 2020 2020 2020 2023 2073               # s
+0002c180: 6d61 6c6c 2074 7265 650a 2020 2020 2020  mall tree.      
+0002c190: 2020 2020 2020 2020 2020 686f 6973 744d            hoistM
+0002c1a0: 7574 6174 696f 6e28 6e65 775f 6765 6e65  utation(new_gene
+0002c1b0: 2c20 6265 7374 5f69 6429 0a20 2020 2020  , best_id).     
+0002c1c0: 2020 2020 2020 2020 2020 2023 2072 656d             # rem
+0002c1d0: 6f76 6520 736d 616c 6c20 7472 6565 2066  ove small tree f
+0002c1e0: 726f 6d20 6f72 6967 696e 616c 2074 7265  rom original tre
+0002c1f0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+0002c200: 2020 686f 6973 744d 7574 6174 696f 6e57    hoistMutationW
+0002c210: 6974 6854 6572 6d69 6e61 6c28 6765 6e65  ithTerminal(gene
+0002c220: 2c20 6265 7374 5f69 642c 2073 656c 662e  , best_id, self.
+0002c230: 7073 6574 2c20 7365 6c66 2e74 6572 6d69  pset, self.termi
+0002c240: 6e61 6c5f 7072 6f62 290a 2020 2020 2020  nal_prob).      
+0002c250: 2020 2020 2020 6e65 775f 706f 7075 6c61        new_popula
+0002c260: 7469 6f6e 2e61 7070 656e 6428 6f29 0a20  tion.append(o). 
+0002c270: 2020 2020 2020 2020 2020 206e 6577 5f70             new_p
+0002c280: 6f70 756c 6174 696f 6e2e 6170 7065 6e64  opulation.append
+0002c290: 286e 6577 5f6f 290a 2020 2020 2020 2020  (new_o).        
+0002c2a0: 6f66 6673 7072 696e 6720 3d20 6e65 775f  offspring = new_
+0002c2b0: 706f 7075 6c61 7469 6f6e 0a20 2020 2020  population.     
+0002c2c0: 2020 2072 6574 7572 6e20 6f66 6673 7072     return offspr
+0002c2d0: 696e 670a 0a20 2020 2064 6566 2074 6872  ing..    def thr
+0002c2e0: 6561 645f 706f 6f6c 5f69 6e69 7469 616c  ead_pool_initial
+0002c2f0: 697a 6174 696f 6e28 7365 6c66 293a 0a20  ization(self):. 
+0002c300: 2020 2020 2020 2061 7267 203d 2028 7365         arg = (se
+0002c310: 6c66 2e58 2c20 7365 6c66 2e79 2c20 7365  lf.X, self.y, se
+0002c320: 6c66 2e73 636f 7265 5f66 756e 632c 2073  lf.score_func, s
+0002c330: 656c 662e 6376 2c20 7365 6c66 2e65 7661  elf.cv, self.eva
+0002c340: 6c75 6174 696f 6e5f 636f 6e66 6967 7572  luation_configur
+0002c350: 6174 696f 6e29 0a20 2020 2020 2020 2023  ation).        #
+0002c360: 2070 6f6f 6c20 696e 6974 6961 6c69 7a61   pool initializa
+0002c370: 7469 6f6e 0a20 2020 2020 2020 2069 6620  tion.        if 
+0002c380: 7365 6c66 2e6e 5f70 726f 6365 7373 203e  self.n_process >
+0002c390: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+0002c3a0: 7365 6c66 2e70 6f6f 6c20 3d20 506f 6f6c  self.pool = Pool
+0002c3b0: 2873 656c 662e 6e5f 7072 6f63 6573 732c  (self.n_process,
+0002c3c0: 2069 6e69 7469 616c 697a 6572 3d69 6e69   initializer=ini
+0002c3d0: 745f 776f 726b 6572 2c20 696e 6974 6172  t_worker, initar
+0002c3e0: 6773 3d28 6361 6c63 756c 6174 655f 7363  gs=(calculate_sc
+0002c3f0: 6f72 652c 2061 7267 2929 0a20 2020 2020  ore, arg)).     
+0002c400: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0002c410: 2020 2020 2069 6e69 745f 776f 726b 6572       init_worker
+0002c420: 2863 616c 6375 6c61 7465 5f73 636f 7265  (calculate_score
+0002c430: 2c20 6172 6729 0a0a 2020 2020 6465 6620  , arg)..    def 
+0002c440: 7365 6d61 6e74 6963 5f72 6570 6169 725f  semantic_repair_
+0002c450: 6665 6174 7572 6573 2873 656c 662c 206f  features(self, o
+0002c460: 6666 7370 7269 6e67 2c20 6578 7465 726e  ffspring, extern
+0002c470: 616c 5f61 7263 6869 7665 293a 0a20 2020  al_archive):.   
+0002c480: 2020 2020 2023 2073 656d 616e 7469 6320       # semantic 
+0002c490: 7265 7061 6972 206d 6561 6e73 2074 6f20  repair means to 
+0002c4a0: 7265 706c 6163 6520 6f6e 6520 6765 6e65  replace one gene
+0002c4b0: 2077 6974 6820 616e 6f74 6865 7220 6265   with another be
+0002c4c0: 7474 6572 2067 656e 650a 2020 2020 2020  tter gene.      
+0002c4d0: 2020 636f 735f 7369 6d20 3d20 6c61 6d62    cos_sim = lamb
+0002c4e0: 6461 2061 2c20 623a 206e 702e 646f 7428  da a, b: np.dot(
+0002c4f0: 612c 2062 2920 2f20 286e 702e 6c69 6e61  a, b) / (np.lina
+0002c500: 6c67 2e6e 6f72 6d28 6129 202a 206e 702e  lg.norm(a) * np.
+0002c510: 6c69 6e61 6c67 2e6e 6f72 6d28 6229 290a  linalg.norm(b)).
+0002c520: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0002c530: 7365 6d61 6e74 6963 5f72 6570 6169 7220  semantic_repair 
+0002c540: 3e20 303a 0a20 2020 2020 2020 2020 2020  > 0:.           
+0002c550: 2066 6f72 206f 2069 6e20 6f66 6673 7072   for o in offspr
+0002c560: 696e 673a 0a20 2020 2020 2020 2020 2020  ing:.           
+0002c570: 2020 2020 2064 6174 6120 3d20 7365 6c66       data = self
+0002c580: 2e73 656d 616e 7469 635f 7265 7061 6972  .semantic_repair
+0002c590: 5f69 6e70 7574 0a20 2020 2020 2020 2020  _input.         
+0002c5a0: 2020 2020 2020 2066 6f72 2069 642c 2067         for id, g
+0002c5b0: 656e 6520 696e 2065 6e75 6d65 7261 7465  ene in enumerate
+0002c5c0: 286f 2e67 656e 6529 3a0a 2020 2020 2020  (o.gene):.      
+0002c5d0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0002c5e0: 6576 616c 7561 7465 2074 6865 2063 7572  evaluate the cur
+0002c5f0: 7265 6e74 2067 656e 650a 2020 2020 2020  rent gene.      
+0002c600: 2020 2020 2020 2020 2020 2020 2020 6669                fi
+0002c610: 6e61 6c5f 7265 7375 6c74 203d 2071 7569  nal_result = qui
+0002c620: 636b 5f65 7661 6c75 6174 6528 6765 6e65  ck_evaluate(gene
+0002c630: 2c20 7365 6c66 2e70 7365 742e 7073 6574  , self.pset.pset
+0002c640: 5f6c 6973 745b 6964 5d2c 2064 6174 6129  _list[id], data)
+0002c650: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002c660: 2020 2020 2066 696e 616c 5f72 6573 756c       final_resul
+0002c670: 7420 3d20 7175 6963 6b5f 6669 6c6c 285b  t = quick_fill([
+0002c680: 6669 6e61 6c5f 7265 7375 6c74 5d2c 2064  final_result], d
+0002c690: 6174 6129 5b30 5d0a 2020 2020 2020 2020  ata)[0].        
+0002c6a0: 2020 2020 2020 2020 2020 2020 6375 7272              curr
+0002c6b0: 656e 745f 7369 6d20 3d20 6e70 2e61 6273  ent_sim = np.abs
+0002c6c0: 2863 6f73 5f73 696d 2866 696e 616c 5f72  (cos_sim(final_r
+0002c6d0: 6573 756c 742c 2073 656c 662e 7365 6d61  esult, self.sema
+0002c6e0: 6e74 6963 5f72 6570 6169 725f 7461 7267  ntic_repair_targ
+0002c6f0: 6574 2929 0a20 2020 2020 2020 2020 2020  et)).           
+0002c700: 2020 2020 2020 2020 2069 6620 6375 7272           if curr
+0002c710: 656e 745f 7369 6d20 3c20 7365 6c66 2e73  ent_sim < self.s
+0002c720: 656d 616e 7469 635f 7265 7061 6972 3a0a  emantic_repair:.
+0002c730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c740: 2020 2020 2020 2020 2320 7472 7920 746f          # try to
+0002c750: 2072 656d 6f76 6520 7468 6520 6375 7272   remove the curr
+0002c760: 656e 7420 6765 6e65 0a20 2020 2020 2020  ent gene.       
+0002c770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c780: 206e 6577 5f67 656e 6573 5f61 203d 2073   new_genes_a = s
+0002c790: 6f72 7465 6428 7365 6c52 616e 646f 6d28  orted(selRandom(
+0002c7a0: 6578 7465 726e 616c 5f61 7263 6869 7665  external_archive
+0002c7b0: 5b69 645d 2c20 3729 2c20 6b65 793d 6c61  [id], 7), key=la
+0002c7c0: 6d62 6461 2078 3a20 785b 305d 295b 2d31  mbda x: x[0])[-1
+0002c7d0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0002c7e0: 2020 2020 2020 2020 2020 6e65 775f 6765            new_ge
+0002c7f0: 6e65 735f 6220 3d20 736f 7274 6564 2873  nes_b = sorted(s
+0002c800: 656c 5261 6e64 6f6d 2865 7874 6572 6e61  elRandom(externa
+0002c810: 6c5f 6172 6368 6976 655b 6964 5d2c 2037  l_archive[id], 7
+0002c820: 292c 206b 6579 3d6c 616d 6264 6120 783a  ), key=lambda x:
+0002c830: 2078 5b30 5d29 5b2d 315d 0a20 2020 2020   x[0])[-1].     
+0002c840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c850: 2020 2064 6563 6f72 6174 6f72 203d 2073     decorator = s
+0002c860: 7461 7469 634c 696d 6974 286b 6579 3d6f  taticLimit(key=o
+0002c870: 7065 7261 746f 722e 6174 7472 6765 7474  perator.attrgett
+0002c880: 6572 2822 6865 6967 6874 2229 2c0a 2020  er("height"),.  
 0002c890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c8a0: 2020 2020 2020 2020 2020 2020 206d 696e               min
-0002c8b0: 5f73 616d 706c 6573 5f6c 6561 663d 7365  _samples_leaf=se
-0002c8c0: 6c66 2e6d 696e 5f73 616d 706c 6573 5f6c  lf.min_samples_l
-0002c8d0: 6561 662c 0a20 2020 2020 2020 2020 2020  eaf,.           
+0002c8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c8b0: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
+0002c8c0: 785f 7661 6c75 653d 7365 6c66 2e6d 6178  x_value=self.max
+0002c8d0: 5f68 6569 6768 742c 0a20 2020 2020 2020  _height,.       
 0002c8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002c8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c900: 2020 2020 2020 636c 6173 735f 7765 6967        class_weig
-0002c910: 6874 3d27 6261 6c61 6e63 6564 2729 0a20  ht='balanced'). 
-0002c920: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
-0002c930: 2e62 6173 655f 6c65 6172 6e65 7220 3d3d  .base_learner ==
-0002c940: 2027 4454 2d53 5152 5427 3a0a 2020 2020   'DT-SQRT':.    
-0002c950: 2020 2020 2020 2020 7269 6467 655f 6d6f          ridge_mo
-0002c960: 6465 6c20 3d20 4465 6369 7369 6f6e 5472  del = DecisionTr
-0002c970: 6565 436c 6173 7369 6669 6572 286d 6178  eeClassifier(max
-0002c980: 5f64 6570 7468 3d73 656c 662e 6d61 785f  _depth=self.max_
-0002c990: 7472 6565 5f64 6570 7468 2c0a 2020 2020  tree_depth,.    
+0002c900: 2020 2020 2020 2020 206d 696e 5f76 616c           min_val
+0002c910: 7565 3d73 656c 662e 6d69 6e5f 6865 6967  ue=self.min_heig
+0002c920: 6874 2928 6378 4f6e 6550 6f69 6e74 290a  ht)(cxOnePoint).
+0002c930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c940: 2020 2020 2020 2020 7465 7374 5f67 656e          test_gen
+0002c950: 6573 203d 2064 6563 6f72 6174 6f72 2863  es = decorator(c
+0002c960: 6f70 792e 6465 6570 636f 7079 286e 6577  opy.deepcopy(new
+0002c970: 5f67 656e 6573 5f61 5b31 5d29 2c20 636f  _genes_a[1]), co
+0002c980: 7079 2e64 6565 7063 6f70 7928 6e65 775f  py.deepcopy(new_
+0002c990: 6765 6e65 735f 625b 315d 2929 0a0a 2020  genes_b[1]))..  
 0002c9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c9c0: 2020 2020 2020 2020 2020 2020 206d 696e               min
-0002c9d0: 5f73 616d 706c 6573 5f6c 6561 663d 7365  _samples_leaf=se
-0002c9e0: 6c66 2e6d 696e 5f73 616d 706c 6573 5f6c  lf.min_samples_l
-0002c9f0: 6561 662c 0a20 2020 2020 2020 2020 2020  eaf,.           
+0002c9b0: 2020 2020 2020 6265 7374 5f67 656e 655f        best_gene_
+0002c9c0: 7363 6f72 6520 3d20 300a 2020 2020 2020  score = 0.      
+0002c9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c9e0: 2020 666f 7220 6e65 775f 6765 6e65 2069    for new_gene i
+0002c9f0: 6e20 7465 7374 5f67 656e 6573 3a0a 2020  n test_genes:.  
 0002ca00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ca10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ca20: 2020 2020 2020 6d61 785f 6665 6174 7572        max_featur
-0002ca30: 6573 3d27 7371 7274 2729 0a20 2020 2020  es='sqrt').     
-0002ca40: 2020 2065 6c69 6620 7365 6c66 2e62 6173     elif self.bas
-0002ca50: 655f 6c65 6172 6e65 7220 3d3d 2027 4c6f  e_learner == 'Lo
-0002ca60: 6769 7374 6963 5265 6772 6573 7369 6f6e  gisticRegression
-0002ca70: 2720 6f72 2073 656c 662e 6261 7365 5f6c  ' or self.base_l
-0002ca80: 6561 726e 6572 203d 3d20 2746 6173 742d  earner == 'Fast-
-0002ca90: 4c52 4454 2720 5c0a 2020 2020 2020 2020  LRDT' \.        
-0002caa0: 2020 2020 6f72 2062 6173 655f 6d6f 6465      or base_mode
-0002cab0: 6c5f 7374 7220 3d3d 2027 4c6f 6769 7374  l_str == 'Logist
-0002cac0: 6963 5265 6772 6573 7369 6f6e 273a 0a20  icRegression':. 
-0002cad0: 2020 2020 2020 2020 2020 2072 6964 6765             ridge
-0002cae0: 5f6d 6f64 656c 203d 2053 6166 6574 794c  _model = SafetyL
-0002caf0: 6f67 6973 7469 6352 6567 7265 7373 696f  ogisticRegressio
-0002cb00: 6e28 6d61 785f 6974 6572 3d31 3030 302c  n(max_iter=1000,
-0002cb10: 2073 6f6c 7665 723d 276c 6962 6c69 6e65   solver='libline
-0002cb20: 6172 272c 0a20 2020 2020 2020 2020 2020  ar',.           
-0002cb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cb50: 2020 2020 2020 2020 7261 6e64 6f6d 5f73          random_s
-0002cb60: 7461 7465 3d30 290a 2020 2020 2020 2020  tate=0).        
-0002cb70: 656c 6966 2073 656c 662e 6261 7365 5f6c  elif self.base_l
-0002cb80: 6561 726e 6572 203d 3d20 2742 616c 616e  earner == 'Balan
-0002cb90: 6365 642d 4c6f 6769 7374 6963 5265 6772  ced-LogisticRegr
-0002cba0: 6573 7369 6f6e 2720 6f72 205c 0a20 2020  ession' or \.   
-0002cbb0: 2020 2020 2020 2020 2062 6173 655f 6d6f           base_mo
-0002cbc0: 6465 6c5f 7374 7220 3d3d 2027 4261 6c61  del_str == 'Bala
-0002cbd0: 6e63 6564 2d4c 6f67 6973 7469 6352 6567  nced-LogisticReg
-0002cbe0: 7265 7373 696f 6e27 3a0a 2020 2020 2020  ression':.      
-0002cbf0: 2020 2020 2020 7269 6467 655f 6d6f 6465        ridge_mode
-0002cc00: 6c20 3d20 5361 6665 7479 4c6f 6769 7374  l = SafetyLogist
-0002cc10: 6963 5265 6772 6573 7369 6f6e 286d 6178  icRegression(max
-0002cc20: 5f69 7465 723d 3130 3030 2c20 736f 6c76  _iter=1000, solv
-0002cc30: 6572 3d27 6c69 626c 696e 6561 7227 2c20  er='liblinear', 
-0002cc40: 636c 6173 735f 7765 6967 6874 3d27 6261  class_weight='ba
-0002cc50: 6c61 6e63 6564 272c 0a20 2020 2020 2020  lanced',.       
-0002cc60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cc80: 2020 2020 2020 2020 2020 2020 7261 6e64              rand
-0002cc90: 6f6d 5f73 7461 7465 3d30 290a 2020 2020  om_state=0).    
-0002cca0: 2020 2020 656c 6966 2073 656c 662e 6261      elif self.ba
-0002ccb0: 7365 5f6c 6561 726e 6572 203d 3d20 2744  se_learner == 'D
-0002ccc0: 796e 616d 6963 2d4c 6f67 6973 7469 6352  ynamic-LogisticR
-0002ccd0: 6567 7265 7373 696f 6e27 3a0a 2020 2020  egression':.    
-0002cce0: 2020 2020 2020 2020 7269 6467 655f 6d6f          ridge_mo
-0002ccf0: 6465 6c20 3d20 4c6f 6769 7374 6963 5265  del = LogisticRe
-0002cd00: 6772 6573 7369 6f6e 2843 3d72 6567 756c  gression(C=regul
-0002cd10: 6172 697a 6174 696f 6e5f 7261 7469 6f2c  arization_ratio,
-0002cd20: 206d 6178 5f69 7465 723d 3130 3030 2c20   max_iter=1000, 
-0002cd30: 736f 6c76 6572 3d27 6c69 626c 696e 6561  solver='liblinea
-0002cd40: 7227 290a 2020 2020 2020 2020 656c 6966  r').        elif
-0002cd50: 2073 656c 662e 6261 7365 5f6c 6561 726e   self.base_learn
-0002cd60: 6572 203d 3d20 2747 4244 542d 504c 273a  er == 'GBDT-PL':
-0002cd70: 0a20 2020 2020 2020 2020 2020 2072 6964  .            rid
-0002cd80: 6765 5f6d 6f64 656c 203d 204c 4742 4d43  ge_model = LGBMC
-0002cd90: 6c61 7373 6966 6965 7228 6e5f 6573 7469  lassifier(n_esti
-0002cda0: 6d61 746f 7273 3d31 302c 206c 6561 726e  mators=10, learn
-0002cdb0: 696e 675f 7261 7465 3d31 2c20 6d61 785f  ing_rate=1, max_
-0002cdc0: 6465 7074 683d 332c 206c 696e 6561 725f  depth=3, linear_
-0002cdd0: 7472 6565 3d54 7275 6529 0a20 2020 2020  tree=True).     
-0002cde0: 2020 2065 6c69 6620 7365 6c66 2e62 6173     elif self.bas
-0002cdf0: 655f 6c65 6172 6e65 7220 3d3d 2027 4742  e_learner == 'GB
-0002ce00: 4454 2d4c 5227 3a0a 2020 2020 2020 2020  DT-LR':.        
-0002ce10: 2020 2020 7269 6467 655f 6d6f 6465 6c20      ridge_model 
-0002ce20: 3d20 4742 4454 4c52 436c 6173 7369 6669  = GBDTLRClassifi
-0002ce30: 6572 5828 4c47 424d 436c 6173 7369 6669  erX(LGBMClassifi
-0002ce40: 6572 286e 5f65 7374 696d 6174 6f72 733d  er(n_estimators=
-0002ce50: 3130 2c20 6c65 6172 6e69 6e67 5f72 6174  10, learning_rat
-0002ce60: 653d 312c 206d 6178 5f64 6570 7468 3d33  e=1, max_depth=3
-0002ce70: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-0002ce80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ce90: 2020 2020 2020 2020 2020 2020 2020 2053                 S
-0002cea0: 6166 6574 794c 6f67 6973 7469 6352 6567  afetyLogisticReg
-0002ceb0: 7265 7373 696f 6e28 6d61 785f 6974 6572  ression(max_iter
-0002cec0: 3d31 3030 302c 2073 6f6c 7665 723d 276c  =1000, solver='l
-0002ced0: 6962 6c69 6e65 6172 2729 290a 2020 2020  iblinear')).    
-0002cee0: 2020 2020 656c 6966 2073 656c 662e 6261      elif self.ba
-0002cef0: 7365 5f6c 6561 726e 6572 203d 3d20 274c  se_learner == 'L
-0002cf00: 6967 6874 4742 4d27 3a0a 2020 2020 2020  ightGBM':.      
-0002cf10: 2020 2020 2020 7061 7261 6d65 7465 725f        parameter_
-0002cf20: 6772 6964 203d 207b 0a20 2020 2020 2020  grid = {.       
-0002cf30: 2020 2020 2020 2020 2022 6c65 6172 6e69           "learni
-0002cf40: 6e67 5f72 6174 6522 3a20 5b30 2e35 5d2c  ng_rate": [0.5],
-0002cf50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002cf60: 2027 6e5f 6573 7469 6d61 746f 7273 273a   'n_estimators':
-0002cf70: 205b 3130 5d2c 0a20 2020 2020 2020 2020   [10],.         
-0002cf80: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
-0002cf90: 2070 6172 616d 6574 6572 203d 2072 616e   parameter = ran
-0002cfa0: 646f 6d2e 6368 6f69 6365 286c 6973 7428  dom.choice(list(
-0002cfb0: 5061 7261 6d65 7465 7247 7269 6428 7061  ParameterGrid(pa
-0002cfc0: 7261 6d65 7465 725f 6772 6964 2929 290a  rameter_grid))).
-0002cfd0: 2020 2020 2020 2020 2020 2020 7269 6467              ridg
-0002cfe0: 655f 6d6f 6465 6c20 3d20 4c47 424d 436c  e_model = LGBMCl
-0002cff0: 6173 7369 6669 6572 282a 2a70 6172 616d  assifier(**param
-0002d000: 6574 6572 2c20 6578 7472 615f 7472 6565  eter, extra_tree
-0002d010: 733d 5472 7565 2c20 6e75 6d5f 6c65 6176  s=True, num_leav
-0002d020: 6573 3d36 332c 206e 5f6a 6f62 733d 3129  es=63, n_jobs=1)
-0002d030: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
-0002d040: 6c66 2e62 6173 655f 6c65 6172 6e65 7220  lf.base_learner 
-0002d050: 3d3d 2027 4454 2d43 7269 7465 7269 6f6e  == 'DT-Criterion
-0002d060: 273a 0a20 2020 2020 2020 2020 2020 2072  ':.            r
-0002d070: 6964 6765 5f6d 6f64 656c 203d 2044 6563  idge_model = Dec
-0002d080: 6973 696f 6e54 7265 6543 6c61 7373 6966  isionTreeClassif
-0002d090: 6965 7228 6372 6974 6572 696f 6e3d 7261  ier(criterion=ra
-0002d0a0: 6e64 6f6d 2e63 686f 6963 6528 5b27 656e  ndom.choice(['en
-0002d0b0: 7472 6f70 7927 2c20 2767 696e 6927 5d29  tropy', 'gini'])
-0002d0c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002d0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d0f0: 2020 206d 6178 5f64 6570 7468 3d73 656c     max_depth=sel
-0002d100: 662e 6d61 785f 7472 6565 5f64 6570 7468  f.max_tree_depth
-0002d110: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002d120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d140: 2020 206d 696e 5f73 616d 706c 6573 5f6c     min_samples_l
-0002d150: 6561 663d 7365 6c66 2e6d 696e 5f73 616d  eaf=self.min_sam
-0002d160: 706c 6573 5f6c 6561 6629 0a20 2020 2020  ples_leaf).     
-0002d170: 2020 2065 6c69 6620 7365 6c66 2e62 6173     elif self.bas
-0002d180: 655f 6c65 6172 6e65 7220 3d3d 2027 5261  e_learner == 'Ra
-0002d190: 6e64 6f6d 2d44 5427 206f 7220 7365 6c66  ndom-DT' or self
-0002d1a0: 2e62 6173 655f 6c65 6172 6e65 7220 3d3d  .base_learner ==
-0002d1b0: 2027 5261 6e64 6f6d 2d44 542d 506c 7573   'Random-DT-Plus
-0002d1c0: 2720 5c0a 2020 2020 2020 2020 2020 2020  ' \.            
-0002d1d0: 6f72 2062 6173 655f 6d6f 6465 6c20 3d3d  or base_model ==
-0002d1e0: 2027 5261 6e64 6f6d 2d44 5427 3a0a 2020   'Random-DT':.  
-0002d1f0: 2020 2020 2020 2020 2020 7269 6467 655f            ridge_
-0002d200: 6d6f 6465 6c20 3d20 4465 6369 7369 6f6e  model = Decision
-0002d210: 5472 6565 436c 6173 7369 6669 6572 2873  TreeClassifier(s
-0002d220: 706c 6974 7465 723d 2772 616e 646f 6d27  plitter='random'
-0002d230: 2c20 6d61 785f 6465 7074 683d 7365 6c66  , max_depth=self
-0002d240: 2e6d 6178 5f74 7265 655f 6465 7074 682c  .max_tree_depth,
-0002d250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002ca10: 2020 2020 2020 2020 2020 7472 6961 6c5f            trial_
+0002ca20: 7265 7375 6c74 203d 2071 7569 636b 5f65  result = quick_e
+0002ca30: 7661 6c75 6174 6528 6e65 775f 6765 6e65  valuate(new_gene
+0002ca40: 2c20 7365 6c66 2e70 7365 742e 7073 6574  , self.pset.pset
+0002ca50: 5f6c 6973 745b 6964 5d2c 2064 6174 6129  _list[id], data)
+0002ca60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002ca70: 2020 2020 2020 2020 2020 2020 2074 7269               tri
+0002ca80: 616c 5f72 6573 756c 7420 3d20 7175 6963  al_result = quic
+0002ca90: 6b5f 6669 6c6c 285b 7472 6961 6c5f 7265  k_fill([trial_re
+0002caa0: 7375 6c74 5d2c 2064 6174 6129 5b30 5d0a  sult], data)[0].
+0002cab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cac0: 2020 2020 2020 2020 2020 2020 7472 6169              trai
+0002cad0: 6c5f 7369 6d20 3d20 6e70 2e61 6273 2863  l_sim = np.abs(c
+0002cae0: 6f73 5f73 696d 2874 7269 616c 5f72 6573  os_sim(trial_res
+0002caf0: 756c 742c 2073 656c 662e 7365 6d61 6e74  ult, self.semant
+0002cb00: 6963 5f72 6570 6169 725f 7461 7267 6574  ic_repair_target
+0002cb10: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+0002cb20: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0002cb30: 6570 6c61 6365 5f74 6872 6573 686f 6c64  eplace_threshold
+0002cb40: 203d 2074 7261 696c 5f73 696d 202f 2063   = trail_sim / c
+0002cb50: 7572 7265 6e74 5f73 696d 0a0a 2020 2020  urrent_sim..    
+0002cb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cb70: 2020 2020 2020 2020 6966 2072 6570 6c61          if repla
+0002cb80: 6365 5f74 6872 6573 686f 6c64 203e 2031  ce_threshold > 1
+0002cb90: 3020 616e 6420 7472 6169 6c5f 7369 6d20  0 and trail_sim 
+0002cba0: 3e20 6265 7374 5f67 656e 655f 7363 6f72  > best_gene_scor
+0002cbb0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0002cbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cbd0: 2020 2062 6573 745f 6765 6e65 5f73 636f     best_gene_sco
+0002cbe0: 7265 203d 2074 7261 696c 5f73 696d 0a20  re = trail_sim. 
+0002cbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cc00: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0002cc10: 696e 616c 5f72 6573 756c 7420 3d20 7472  inal_result = tr
+0002cc20: 6961 6c5f 7265 7375 6c74 0a20 2020 2020  ial_result.     
+0002cc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cc40: 2020 2020 2020 2020 2020 206f 2e67 656e             o.gen
+0002cc50: 655b 6964 5d20 3d20 6e65 775f 6765 6e65  e[id] = new_gene
+0002cc60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002cc70: 2020 2020 2020 2020 2069 6620 6265 7374           if best
+0002cc80: 5f67 656e 655f 7363 6f72 6520 3e20 303a  _gene_score > 0:
+0002cc90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002cca0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0002ccb0: 662e 7375 6363 6573 7366 756c 5f72 6570  f.successful_rep
+0002ccc0: 6169 7220 2b3d 2031 0a20 2020 2020 2020  air += 1.       
+0002ccd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cce0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0002ccf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cd00: 2020 2073 656c 662e 6661 696c 6564 5f72     self.failed_r
+0002cd10: 6570 6169 7220 2b3d 2031 0a20 2020 2020  epair += 1.     
+0002cd20: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0002cd30: 6174 6120 3d20 6e70 2e63 6f6e 6361 7465  ata = np.concate
+0002cd40: 6e61 7465 285b 6461 7461 2c20 6e70 2e72  nate([data, np.r
+0002cd50: 6573 6861 7065 2866 696e 616c 5f72 6573  eshape(final_res
+0002cd60: 756c 742c 2028 2d31 2c20 3129 295d 2c20  ult, (-1, 1))], 
+0002cd70: 6178 6973 3d31 290a 0a20 2020 2064 6566  axis=1)..    def
+0002cd80: 2075 7064 6174 655f 7365 6d61 6e74 6963   update_semantic
+0002cd90: 5f72 6570 6169 725f 696e 7075 745f 6d61  _repair_input_ma
+0002cda0: 7472 6978 2873 656c 662c 2070 6f70 756c  trix(self, popul
+0002cdb0: 6174 696f 6e29 3a0a 2020 2020 2020 2020  ation):.        
+0002cdc0: 6265 7374 5f69 6e64 203d 2073 6f72 7465  best_ind = sorte
+0002cdd0: 6428 706f 7075 6c61 7469 6f6e 2c20 6b65  d(population, ke
+0002cde0: 793d 6c61 6d62 6461 2078 3a20 782e 6669  y=lambda x: x.fi
+0002cdf0: 746e 6573 732e 7776 616c 7565 7329 5b2d  tness.wvalues)[-
+0002ce00: 315d 0a20 2020 2020 2020 2069 6420 3d20  1].        id = 
+0002ce10: 6e70 2e61 7267 736f 7274 2862 6573 745f  np.argsort(best_
+0002ce20: 696e 642e 6361 7365 5f76 616c 7565 7329  ind.case_values)
+0002ce30: 5b2d 3230 3a5d 0a20 2020 2020 2020 2073  [-20:].        s
+0002ce40: 656c 662e 7365 6d61 6e74 6963 5f72 6570  elf.semantic_rep
+0002ce50: 6169 725f 696e 7075 7420 3d20 7365 6c66  air_input = self
+0002ce60: 2e58 5b69 645d 0a20 2020 2020 2020 2073  .X[id].        s
+0002ce70: 656c 662e 7365 6d61 6e74 6963 5f72 6570  elf.semantic_rep
+0002ce80: 6169 725f 7461 7267 6574 203d 2073 656c  air_target = sel
+0002ce90: 662e 795b 6964 5d0a 0a20 2020 2064 6566  f.y[id]..    def
+0002cea0: 2073 7461 7469 7374 6963 616c 5f72 6573   statistical_res
+0002ceb0: 756c 745f 7570 6461 7465 2873 656c 662c  ult_update(self,
+0002cec0: 2070 6f70 756c 6174 696f 6e2c 2076 6572   population, ver
+0002ced0: 626f 7365 293a 0a20 2020 2020 2020 2069  bose):.        i
+0002cee0: 6620 7365 6c66 2e67 656e 655f 6e75 6d20  f self.gene_num 
+0002cef0: 3d3d 2031 2061 6e64 2073 656c 662e 6372  == 1 and self.cr
+0002cf00: 6f73 736f 7665 725f 636f 6e66 6967 7572  ossover_configur
+0002cf10: 6174 696f 6e2e 7661 725f 6f72 3a0a 2020  ation.var_or:.  
+0002cf20: 2020 2020 2020 2020 2020 616c 6c5f 6372            all_cr
+0002cf30: 6f73 736f 7665 7220 3d20 300a 2020 2020  ossover = 0.    
+0002cf40: 2020 2020 2020 2020 7375 6363 6573 7366          successf
+0002cf50: 756c 5f63 726f 7373 6f76 6572 203d 2030  ul_crossover = 0
+0002cf60: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0002cf70: 2070 2069 6e20 706f 7075 6c61 7469 6f6e   p in population
+0002cf80: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002cf90: 2020 6966 2070 2e70 6172 656e 745f 6669    if p.parent_fi
+0002cfa0: 746e 6573 7320 6973 206e 6f74 204e 6f6e  tness is not Non
+0002cfb0: 6520 616e 6420 6c65 6e28 702e 7061 7265  e and len(p.pare
+0002cfc0: 6e74 5f66 6974 6e65 7373 2920 3d3d 2032  nt_fitness) == 2
+0002cfd0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002cfe0: 2020 2020 2020 6966 2070 2e66 6974 6e65        if p.fitne
+0002cff0: 7373 2e77 7661 6c75 6573 5b30 5d20 3e20  ss.wvalues[0] > 
+0002d000: 702e 7061 7265 6e74 5f66 6974 6e65 7373  p.parent_fitness
+0002d010: 5b30 5d3a 0a20 2020 2020 2020 2020 2020  [0]:.           
+0002d020: 2020 2020 2020 2020 2020 2020 2073 7563               suc
+0002d030: 6365 7373 6675 6c5f 6372 6f73 736f 7665  cessful_crossove
+0002d040: 7220 2b3d 2031 0a20 2020 2020 2020 2020  r += 1.         
+0002d050: 2020 2020 2020 2020 2020 2061 6c6c 5f63             all_c
+0002d060: 726f 7373 6f76 6572 202b 3d20 310a 2020  rossover += 1.  
+0002d070: 2020 2020 2020 2020 2020 6966 2061 6c6c            if all
+0002d080: 5f63 726f 7373 6f76 6572 203e 2030 3a0a  _crossover > 0:.
+0002d090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d0a0: 2320 6967 6e6f 7265 2074 6865 2066 6972  # ignore the fir
+0002d0b0: 7374 2067 656e 6572 6174 696f 6e0a 2020  st generation.  
+0002d0c0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0002d0d0: 6c66 2e63 726f 7373 6f76 6572 5f73 7563  lf.crossover_suc
+0002d0e0: 6365 7373 6675 6c5f 7261 7465 2e61 7070  cessful_rate.app
+0002d0f0: 656e 6428 7375 6363 6573 7366 756c 5f63  end(successful_c
+0002d100: 726f 7373 6f76 6572 202f 2061 6c6c 5f63  rossover / all_c
+0002d110: 726f 7373 6f76 6572 290a 0a20 2020 2020  rossover)..     
+0002d120: 2020 2020 2020 2061 6c6c 5f6d 7574 6174         all_mutat
+0002d130: 696f 6e20 3d20 300a 2020 2020 2020 2020  ion = 0.        
+0002d140: 2020 2020 7375 6363 6573 7366 756c 5f6d      successful_m
+0002d150: 7574 6174 696f 6e20 3d20 300a 2020 2020  utation = 0.    
+0002d160: 2020 2020 2020 2020 666f 7220 7020 696e          for p in
+0002d170: 2070 6f70 756c 6174 696f 6e3a 0a20 2020   population:.   
+0002d180: 2020 2020 2020 2020 2020 2020 2023 2073               # s
+0002d190: 6f6d 6574 696d 6573 2c20 616e 206f 6666  ometimes, an off
+0002d1a0: 7370 7269 6e67 2069 7320 6765 6e65 7261  spring is genera
+0002d1b0: 7465 6420 6279 2074 6865 206d 7574 6174  ted by the mutat
+0002d1c0: 696f 6e20 6f70 6572 6174 6f72 0a20 2020  ion operator.   
+0002d1d0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0002d1e0: 702e 7061 7265 6e74 5f66 6974 6e65 7373  p.parent_fitness
+0002d1f0: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
+0002d200: 206c 656e 2870 2e70 6172 656e 745f 6669   len(p.parent_fi
+0002d210: 746e 6573 7329 203d 3d20 313a 0a20 2020  tness) == 1:.   
+0002d220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d230: 2069 6620 702e 6669 746e 6573 732e 7776   if p.fitness.wv
+0002d240: 616c 7565 735b 305d 203e 2070 2e70 6172  alues[0] > p.par
+0002d250: 656e 745f 6669 746e 6573 735b 305d 3a0a  ent_fitness[0]:.
 0002d260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d280: 2020 6d69 6e5f 7361 6d70 6c65 735f 6c65    min_samples_le
-0002d290: 6166 3d73 656c 662e 6d69 6e5f 7361 6d70  af=self.min_samp
-0002d2a0: 6c65 735f 6c65 6166 290a 2020 2020 2020  les_leaf).      
-0002d2b0: 2020 656c 6966 2073 656c 662e 6261 7365    elif self.base
-0002d2c0: 5f6c 6561 726e 6572 203d 3d20 2742 616c  _learner == 'Bal
-0002d2d0: 616e 6365 642d 5261 6e64 6f6d 2d44 5427  anced-Random-DT'
-0002d2e0: 206f 7220 6261 7365 5f6d 6f64 656c 203d   or base_model =
-0002d2f0: 3d20 2742 616c 616e 6365 642d 5261 6e64  = 'Balanced-Rand
-0002d300: 6f6d 2d44 5427 3a0a 2020 2020 2020 2020  om-DT':.        
-0002d310: 2020 2020 7269 6467 655f 6d6f 6465 6c20      ridge_model 
-0002d320: 3d20 4465 6369 7369 6f6e 5472 6565 436c  = DecisionTreeCl
-0002d330: 6173 7369 6669 6572 2873 706c 6974 7465  assifier(splitte
-0002d340: 723d 2772 616e 646f 6d27 2c20 6d61 785f  r='random', max_
-0002d350: 6465 7074 683d 7365 6c66 2e6d 6178 5f74  depth=self.max_t
-0002d360: 7265 655f 6465 7074 682c 0a20 2020 2020  ree_depth,.     
-0002d370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d390: 2020 2020 2020 2020 2020 2020 6d69 6e5f              min_
-0002d3a0: 7361 6d70 6c65 735f 6c65 6166 3d73 656c  samples_leaf=sel
-0002d3b0: 662e 6d69 6e5f 7361 6d70 6c65 735f 6c65  f.min_samples_le
-0002d3c0: 6166 2c0a 2020 2020 2020 2020 2020 2020  af,.            
-0002d3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d3f0: 2020 2020 2063 6c61 7373 5f77 6569 6768       class_weigh
-0002d400: 743d 2762 616c 616e 6365 6427 290a 2020  t='balanced').  
-0002d410: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
-0002d420: 6261 7365 5f6c 6561 726e 6572 203d 3d20  base_learner == 
-0002d430: 2752 616e 646f 6d2d 4454 2d43 7269 7465  'Random-DT-Crite
-0002d440: 7269 6f6e 273a 0a20 2020 2020 2020 2020  rion':.         
-0002d450: 2020 2072 6964 6765 5f6d 6f64 656c 203d     ridge_model =
-0002d460: 2044 6563 6973 696f 6e54 7265 6543 6c61   DecisionTreeCla
-0002d470: 7373 6966 6965 7228 6372 6974 6572 696f  ssifier(criterio
-0002d480: 6e3d 7261 6e64 6f6d 2e63 686f 6963 6528  n=random.choice(
-0002d490: 5b27 656e 7472 6f70 7927 2c20 2767 696e  ['entropy', 'gin
-0002d4a0: 6927 5d29 2c0a 2020 2020 2020 2020 2020  i']),.          
+0002d270: 2020 2020 2020 2020 7375 6363 6573 7366          successf
+0002d280: 756c 5f6d 7574 6174 696f 6e20 2b3d 2031  ul_mutation += 1
+0002d290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002d2a0: 2020 2020 2061 6c6c 5f6d 7574 6174 696f       all_mutatio
+0002d2b0: 6e20 2b3d 2031 0a20 2020 2020 2020 2020  n += 1.         
+0002d2c0: 2020 2069 6620 616c 6c5f 6d75 7461 7469     if all_mutati
+0002d2d0: 6f6e 203e 2030 3a0a 2020 2020 2020 2020  on > 0:.        
+0002d2e0: 2020 2020 2020 2020 2320 6967 6e6f 7265          # ignore
+0002d2f0: 2074 6865 2066 6972 7374 2067 656e 6572   the first gener
+0002d300: 6174 696f 6e0a 2020 2020 2020 2020 2020  ation.          
+0002d310: 2020 2020 2020 7365 6c66 2e6d 7574 6174        self.mutat
+0002d320: 696f 6e5f 7375 6363 6573 7366 756c 5f72  ion_successful_r
+0002d330: 6174 652e 6170 7065 6e64 2873 7563 6365  ate.append(succe
+0002d340: 7373 6675 6c5f 6d75 7461 7469 6f6e 202f  ssful_mutation /
+0002d350: 2061 6c6c 5f6d 7574 6174 696f 6e29 0a0a   all_mutation)..
+0002d360: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0002d370: 6372 6f73 736f 7665 725f 636f 6e66 6967  crossover_config
+0002d380: 7572 6174 696f 6e2e 7365 6d61 6e74 6963  uration.semantic
+0002d390: 5f63 726f 7373 6f76 6572 5f6d 6f64 6520  _crossover_mode 
+0002d3a0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0002d3b0: 2020 2020 2020 2020 2023 2069 6620 616e           # if an
+0002d3c0: 2069 6e64 6976 6964 7561 6c20 6973 2062   individual is b
+0002d3d0: 6574 7465 7220 7468 616e 2065 6974 6865  etter than eithe
+0002d3e0: 7220 6f66 2069 7473 2070 6172 656e 742c  r of its parent,
+0002d3f0: 2069 7420 6973 2063 6f6e 7369 6465 7265   it is considere
+0002d400: 6420 6173 2061 2073 7563 6365 7373 6675  d as a successfu
+0002d410: 6c20 6372 6f73 736f 7665 720a 2020 2020  l crossover.    
+0002d420: 2020 2020 2020 2020 7375 6363 6573 7366          successf
+0002d430: 756c 5f63 726f 7373 6f76 6572 203d 2030  ul_crossover = 0
+0002d440: 0a20 2020 2020 2020 2020 2020 2061 6c6c  .            all
+0002d450: 5f63 726f 7373 6f76 6572 203d 2030 0a20  _crossover = 0. 
+0002d460: 2020 2020 2020 2020 2020 2066 6f72 2070             for p
+0002d470: 2069 6e20 706f 7075 6c61 7469 6f6e 3a0a   in population:.
+0002d480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d490: 6966 2070 2e63 726f 7373 6f76 6572 5f74  if p.crossover_t
+0002d4a0: 7970 6520 3d3d 2027 4d61 6372 6f27 3a0a  ype == 'Macro':.
 0002d4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d4d0: 2020 2020 2020 2073 706c 6974 7465 723d         splitter=
-0002d4e0: 2772 616e 646f 6d27 2c0a 2020 2020 2020  'random',.      
-0002d4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d510: 2020 2020 2020 2020 2020 206d 6178 5f64             max_d
-0002d520: 6570 7468 3d73 656c 662e 6d61 785f 7472  epth=self.max_tr
-0002d530: 6565 5f64 6570 7468 2c0a 2020 2020 2020  ee_depth,.      
-0002d540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d560: 2020 2020 2020 2020 2020 206d 696e 5f73             min_s
-0002d570: 616d 706c 6573 5f6c 6561 663d 7365 6c66  amples_leaf=self
-0002d580: 2e6d 696e 5f73 616d 706c 6573 5f6c 6561  .min_samples_lea
-0002d590: 6629 0a20 2020 2020 2020 2065 6c69 6620  f).        elif 
-0002d5a0: 7365 6c66 2e62 6173 655f 6c65 6172 6e65  self.base_learne
-0002d5b0: 7220 3d3d 2027 4c6f 6769 7374 6963 5265  r == 'LogisticRe
-0002d5c0: 6772 6573 7369 6f6e 4356 273a 0a20 2020  gressionCV':.   
-0002d5d0: 2020 2020 2020 2020 2072 6964 6765 5f6d           ridge_m
-0002d5e0: 6f64 656c 203d 204c 6f67 6973 7469 6352  odel = LogisticR
-0002d5f0: 6567 7265 7373 696f 6e43 5628 736f 6c76  egressionCV(solv
-0002d600: 6572 3d27 6c69 626c 696e 6561 7227 290a  er='liblinear').
-0002d610: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
-0002d620: 662e 6261 7365 5f6c 6561 726e 6572 203d  f.base_learner =
-0002d630: 3d20 2752 616e 646f 6d2d 4454 2d53 5152  = 'Random-DT-SQR
-0002d640: 5427 3a0a 2020 2020 2020 2020 2020 2020  T':.            
-0002d650: 7269 6467 655f 6d6f 6465 6c20 3d20 4465  ridge_model = De
-0002d660: 6369 7369 6f6e 5472 6565 436c 6173 7369  cisionTreeClassi
-0002d670: 6669 6572 2873 706c 6974 7465 723d 2772  fier(splitter='r
-0002d680: 616e 646f 6d27 2c20 6d61 785f 6465 7074  andom', max_dept
-0002d690: 683d 7365 6c66 2e6d 6178 5f74 7265 655f  h=self.max_tree_
-0002d6a0: 6465 7074 682c 0a20 2020 2020 2020 2020  depth,.         
-0002d6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d6d0: 2020 2020 2020 2020 6d69 6e5f 7361 6d70          min_samp
-0002d6e0: 6c65 735f 6c65 6166 3d73 656c 662e 6d69  les_leaf=self.mi
-0002d6f0: 6e5f 7361 6d70 6c65 735f 6c65 6166 2c0a  n_samples_leaf,.
-0002d700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d730: 206d 6178 5f66 6561 7475 7265 733d 2773   max_features='s
-0002d740: 7172 7427 290a 2020 2020 2020 2020 656c  qrt').        el
-0002d750: 6966 2073 656c 662e 6261 7365 5f6c 6561  if self.base_lea
-0002d760: 726e 6572 203d 3d20 274c 5244 5427 3a0a  rner == 'LRDT':.
-0002d770: 2020 2020 2020 2020 2020 2020 7269 6467              ridg
-0002d780: 655f 6d6f 6465 6c20 3d20 4c52 4454 436c  e_model = LRDTCl
-0002d790: 6173 7369 6669 6572 2864 6563 6973 696f  assifier(decisio
-0002d7a0: 6e5f 7472 6565 5f63 6f75 6e74 3d73 656c  n_tree_count=sel
-0002d7b0: 662e 6465 6369 7369 6f6e 5f74 7265 655f  f.decision_tree_
-0002d7c0: 636f 756e 742c 0a20 2020 2020 2020 2020  count,.         
-0002d7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d7f0: 6d61 785f 6c65 6166 5f6e 6f64 6573 3d73  max_leaf_nodes=s
-0002d800: 656c 662e 6d61 785f 6c65 6166 5f6e 6f64  elf.max_leaf_nod
-0002d810: 6573 290a 2020 2020 2020 2020 656c 6966  es).        elif
-0002d820: 2073 656c 662e 6261 7365 5f6c 6561 726e   self.base_learn
-0002d830: 6572 203d 3d20 2748 7962 7269 6427 3a0a  er == 'Hybrid':.
-0002d840: 2020 2020 2020 2020 2020 2020 2320 6578              # ex
-0002d850: 7472 6163 7420 6261 7365 206d 6f64 656c  tract base model
-0002d860: 0a20 2020 2020 2020 2020 2020 2072 6964  .            rid
-0002d870: 6765 5f6d 6f64 656c 203d 2073 656c 662e  ge_model = self.
-0002d880: 7470 6f74 5f6d 6f64 656c 2e5f 636f 6d70  tpot_model._comp
-0002d890: 696c 655f 746f 5f73 6b6c 6561 726e 2862  ile_to_sklearn(b
-0002d8a0: 6173 655f 6d6f 6465 6c29 5b2d 315d 0a20  ase_model)[-1]. 
-0002d8b0: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
-0002d8c0: 7374 616e 6365 2873 656c 662e 6261 7365  stance(self.base
-0002d8d0: 5f6c 6561 726e 6572 2c20 436c 6173 7369  _learner, Classi
-0002d8e0: 6669 6572 4d69 7869 6e29 3a0a 2020 2020  fierMixin):.    
-0002d8f0: 2020 2020 2020 2020 7269 6467 655f 6d6f          ridge_mo
-0002d900: 6465 6c20 3d20 7365 6c66 2e62 6173 655f  del = self.base_
-0002d910: 6c65 6172 6e65 720a 2020 2020 2020 2020  learner.        
-0002d920: 656c 6966 2062 6173 655f 6d6f 6465 6c5f  elif base_model_
-0002d930: 7374 7220 213d 2027 2720 616e 6420 6261  str != '' and ba
-0002d940: 7365 5f6d 6f64 656c 5f73 7472 2069 6e20  se_model_str in 
-0002d950: 7365 6c66 2e62 6173 655f 6d6f 6465 6c5f  self.base_model_
-0002d960: 6469 6374 3a0a 2020 2020 2020 2020 2020  dict:.          
-0002d970: 2020 7269 6467 655f 6d6f 6465 6c20 3d20    ridge_model = 
-0002d980: 7365 6c66 2e62 6173 655f 6d6f 6465 6c5f  self.base_model_
-0002d990: 6469 6374 5b62 6173 655f 6d6f 6465 6c5f  dict[base_model_
-0002d9a0: 7374 725d 0a20 2020 2020 2020 2065 6c69  str].        eli
-0002d9b0: 6620 7365 6c66 2e62 6173 655f 6c65 6172  f self.base_lear
-0002d9c0: 6e65 7220 213d 2027 2720 616e 6420 7365  ner != '' and se
-0002d9d0: 6c66 2e62 6173 655f 6c65 6172 6e65 7220  lf.base_learner 
-0002d9e0: 696e 2073 656c 662e 6261 7365 5f6d 6f64  in self.base_mod
-0002d9f0: 656c 5f64 6963 743a 0a20 2020 2020 2020  el_dict:.       
-0002da00: 2020 2020 2072 6964 6765 5f6d 6f64 656c       ridge_model
-0002da10: 203d 2073 656c 662e 6261 7365 5f6d 6f64   = self.base_mod
-0002da20: 656c 5f64 6963 745b 7365 6c66 2e62 6173  el_dict[self.bas
-0002da30: 655f 6c65 6172 6e65 725d 0a20 2020 2020  e_learner].     
-0002da40: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0002da50: 2020 2020 2072 6169 7365 2045 7863 6570       raise Excep
-0002da60: 7469 6f6e 0a20 2020 2020 2020 2069 6620  tion.        if 
-0002da70: 7365 6c66 2e62 6173 655f 6c65 6172 6e65  self.base_learne
-0002da80: 7220 3d3d 2027 5043 412d 4454 273a 0a20  r == 'PCA-DT':. 
-0002da90: 2020 2020 2020 2020 2020 2070 6970 6520             pipe 
-0002daa0: 3d20 5069 7065 6c69 6e65 285b 0a20 2020  = Pipeline([.   
-0002dab0: 2020 2020 2020 2020 2020 2020 2028 2253               ("S
-0002dac0: 6361 6c65 7222 2c20 5374 616e 6461 7264  caler", Standard
-0002dad0: 5363 616c 6572 2829 292c 0a20 2020 2020  Scaler()),.     
-0002dae0: 2020 2020 2020 2020 2020 2028 2750 4341             ('PCA
-0002daf0: 272c 2050 4341 2829 292c 0a20 2020 2020  ', PCA()),.     
-0002db00: 2020 2020 2020 2020 2020 2028 2252 6964             ("Rid
-0002db10: 6765 222c 2072 6964 6765 5f6d 6f64 656c  ge", ridge_model
-0002db20: 292c 0a20 2020 2020 2020 2020 2020 205d  ),.            ]
-0002db30: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-0002db40: 2020 2020 2020 2020 2020 2020 7069 7065              pipe
-0002db50: 203d 2050 6970 656c 696e 6528 5b0a 2020   = Pipeline([.  
-0002db60: 2020 2020 2020 2020 2020 2020 2020 2822                ("
-0002db70: 5363 616c 6572 222c 2053 6166 6574 7953  Scaler", SafetyS
-0002db80: 6361 6c65 7228 2929 2c0a 2020 2020 2020  caler()),.      
-0002db90: 2020 2020 2020 2020 2020 2822 5269 6467            ("Ridg
-0002dba0: 6522 2c20 7269 6467 655f 6d6f 6465 6c29  e", ridge_model)
-0002dbb0: 2c0a 2020 2020 2020 2020 2020 2020 5d29  ,.            ])
-0002dbc0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0002dbd0: 7069 7065 0a0a 0a64 6566 2074 7275 6e63  pipe...def trunc
-0002dbe0: 6174 6564 5f6e 6f72 6d61 6c28 6c6f 7765  ated_normal(lowe
-0002dbf0: 723d 302c 2075 7070 6572 3d31 2c20 6d75  r=0, upper=1, mu
-0002dc00: 3d30 2e35 2c20 7369 676d 613d 302e 312c  =0.5, sigma=0.1,
-0002dc10: 2073 616d 706c 653d 2831 3030 2c20 3130   sample=(100, 10
-0002dc20: 3029 293a 0a20 2020 2023 2069 6e73 7461  0)):.    # insta
-0002dc30: 6e74 6961 7465 2061 6e20 6f62 6a65 6374  ntiate an object
-0002dc40: 2058 2075 7369 6e67 2074 6865 2061 626f   X using the abo
-0002dc50: 7665 2066 6f75 7220 7061 7261 6d65 7465  ve four paramete
-0002dc60: 7273 2c0a 2020 2020 5820 3d20 7374 6174  rs,.    X = stat
-0002dc70: 732e 7472 756e 636e 6f72 6d28 286c 6f77  s.truncnorm((low
-0002dc80: 6572 202d 206d 7529 202f 2073 6967 6d61  er - mu) / sigma
-0002dc90: 2c20 2875 7070 6572 202d 206d 7529 202f  , (upper - mu) /
-0002dca0: 2073 6967 6d61 2c20 6c6f 633d 6d75 2c20   sigma, loc=mu, 
-0002dcb0: 7363 616c 653d 7369 676d 6129 0a20 2020  scale=sigma).   
-0002dcc0: 2023 2067 656e 6572 6174 6520 3130 3030   # generate 1000
-0002dcd0: 2073 616d 706c 6520 6461 7461 0a20 2020   sample data.   
-0002dce0: 2073 616d 706c 6573 203d 2058 2e72 7673   samples = X.rvs
-0002dcf0: 2873 616d 706c 6529 0a20 2020 2072 6574  (sample).    ret
-0002dd00: 7572 6e20 7361 6d70 6c65 730a 0a0a 6465  urn samples...de
-0002dd10: 6620 696e 6974 5f77 6f72 6b65 7228 6675  f init_worker(fu
-0002dd20: 6e63 7469 6f6e 2c20 6461 7461 293a 0a20  nction, data):. 
-0002dd30: 2020 2066 756e 6374 696f 6e2e 6461 7461     function.data
-0002dd40: 203d 2064 6174 610a                       = data.
+0002d4c0: 2020 2020 6966 206e 702e 616c 6c28 702e      if np.all(p.
+0002d4d0: 6669 746e 6573 732e 7776 616c 7565 735b  fitness.wvalues[
+0002d4e0: 305d 203e 206e 702e 6172 7261 7928 702e  0] > np.array(p.
+0002d4f0: 7061 7265 6e74 5f66 6974 6e65 7373 2929  parent_fitness))
+0002d500: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002d510: 2020 2020 2020 2020 2020 7375 6363 6573            succes
+0002d520: 7366 756c 5f63 726f 7373 6f76 6572 202b  sful_crossover +
+0002d530: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
+0002d540: 2020 2020 2020 2020 616c 6c5f 6372 6f73          all_cros
+0002d550: 736f 7665 7220 2b3d 2031 0a20 2020 2020  sover += 1.     
+0002d560: 2020 2020 2020 2023 2047 656e 6572 616c         # General
+0002d570: 6c79 2073 7065 616b 696e 672c 2069 7420  ly speaking, it 
+0002d580: 6973 2069 6d70 6f73 7369 626c 6520 746f  is impossible to
+0002d590: 203d 3d30 2c20 756e 6c65 7373 2061 6c6c   ==0, unless all
+0002d5a0: 206f 6620 7468 656d 2064 6f20 6e6f 7420   of them do not 
+0002d5b0: 7573 6520 4d61 6372 6f20 4372 6f73 736f  use Macro Crosso
+0002d5c0: 7665 720a 2020 2020 2020 2020 2020 2020  ver.            
+0002d5d0: 6966 2061 6c6c 5f63 726f 7373 6f76 6572  if all_crossover
+0002d5e0: 203e 2030 3a0a 2020 2020 2020 2020 2020   > 0:.          
+0002d5f0: 2020 2020 2020 7365 6c66 2e6d 6163 726f        self.macro
+0002d600: 5f63 726f 7373 6f76 6572 5f73 7563 6365  _crossover_succe
+0002d610: 7373 6675 6c5f 7261 7465 2e61 7070 656e  ssful_rate.appen
+0002d620: 6428 7375 6363 6573 7366 756c 5f63 726f  d(successful_cro
+0002d630: 7373 6f76 6572 202f 2061 6c6c 5f63 726f  ssover / all_cro
+0002d640: 7373 6f76 6572 290a 2020 2020 2020 2020  ssover).        
+0002d650: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0002d660: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+0002d670: 6163 726f 5f63 726f 7373 6f76 6572 5f73  acro_crossover_s
+0002d680: 7563 6365 7373 6675 6c5f 7261 7465 2e61  uccessful_rate.a
+0002d690: 7070 656e 6428 3029 0a0a 2020 2020 2020  ppend(0)..      
+0002d6a0: 2020 2020 2020 7375 6363 6573 7366 756c        successful
+0002d6b0: 5f63 726f 7373 6f76 6572 203d 2030 0a20  _crossover = 0. 
+0002d6c0: 2020 2020 2020 2020 2020 2061 6c6c 5f63             all_c
+0002d6d0: 726f 7373 6f76 6572 203d 2030 0a20 2020  rossover = 0.   
+0002d6e0: 2020 2020 2020 2020 2066 6f72 2070 2069           for p i
+0002d6f0: 6e20 706f 7075 6c61 7469 6f6e 3a0a 2020  n population:.  
+0002d700: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0002d710: 2070 2e63 726f 7373 6f76 6572 5f74 7970   p.crossover_typ
+0002d720: 6520 3d3d 2027 4d69 6372 6f27 3a0a 2020  e == 'Micro':.  
+0002d730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d740: 2020 6966 206e 702e 616c 6c28 702e 6669    if np.all(p.fi
+0002d750: 746e 6573 732e 7776 616c 7565 735b 305d  tness.wvalues[0]
+0002d760: 203e 206e 702e 6172 7261 7928 702e 7061   > np.array(p.pa
+0002d770: 7265 6e74 5f66 6974 6e65 7373 2929 3a0a  rent_fitness)):.
+0002d780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d790: 2020 2020 2020 2020 7375 6363 6573 7366          successf
+0002d7a0: 756c 5f63 726f 7373 6f76 6572 202b 3d20  ul_crossover += 
+0002d7b0: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
+0002d7c0: 2020 2020 2020 616c 6c5f 6372 6f73 736f        all_crosso
+0002d7d0: 7665 7220 2b3d 2031 0a20 2020 2020 2020  ver += 1.       
+0002d7e0: 2020 2020 2069 6620 616c 6c5f 6372 6f73       if all_cros
+0002d7f0: 736f 7665 7220 3e20 303a 0a20 2020 2020  sover > 0:.     
+0002d800: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0002d810: 6d69 6372 6f5f 6372 6f73 736f 7665 725f  micro_crossover_
+0002d820: 7375 6363 6573 7366 756c 5f72 6174 652e  successful_rate.
+0002d830: 6170 7065 6e64 2873 7563 6365 7373 6675  append(successfu
+0002d840: 6c5f 6372 6f73 736f 7665 7220 2f20 616c  l_crossover / al
+0002d850: 6c5f 6372 6f73 736f 7665 7229 0a20 2020  l_crossover).   
+0002d860: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0002d870: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0002d880: 656c 662e 6d69 6372 6f5f 6372 6f73 736f  elf.micro_crosso
+0002d890: 7665 725f 7375 6363 6573 7366 756c 5f72  ver_successful_r
+0002d8a0: 6174 652e 6170 7065 6e64 2830 290a 0a20  ate.append(0).. 
+0002d8b0: 2020 2020 2020 2073 656c 662e 6869 7374         self.hist
+0002d8c0: 6f72 6963 616c 5f73 6d61 6c6c 6573 7420  orical_smallest 
+0002d8d0: 3d20 6d69 6e28 7365 6c66 2e68 6973 746f  = min(self.histo
+0002d8e0: 7269 6361 6c5f 736d 616c 6c65 7374 2c20  rical_smallest, 
+0002d8f0: 6d69 6e28 5b6c 656e 2870 2920 666f 7220  min([len(p) for 
+0002d900: 7020 696e 2070 6f70 756c 6174 696f 6e5d  p in population]
+0002d910: 2929 0a20 2020 2020 2020 2073 656c 662e  )).        self.
+0002d920: 6869 7374 6f72 6963 616c 5f6c 6172 6765  historical_large
+0002d930: 7374 203d 206d 6178 2873 656c 662e 6869  st = max(self.hi
+0002d940: 7374 6f72 6963 616c 5f6c 6172 6765 7374  storical_largest
+0002d950: 2c20 6d61 7828 5b6c 656e 2870 2920 666f  , max([len(p) fo
+0002d960: 7220 7020 696e 2070 6f70 756c 6174 696f  r p in populatio
+0002d970: 6e5d 2929 0a20 2020 2020 2020 2069 6620  n])).        if 
+0002d980: 7365 6c66 2e74 6573 745f 6675 6e20 213d  self.test_fun !=
+0002d990: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0002d9a0: 2020 2073 656c 662e 7472 6169 6e69 6e67     self.training
+0002d9b0: 5f77 6974 685f 7661 6c69 6461 7469 6f6e  _with_validation
+0002d9c0: 5f73 6574 2829 0a20 2020 2020 2020 2020  _set().         
+0002d9d0: 2020 2073 656c 662e 7365 636f 6e64 5f6c     self.second_l
+0002d9e0: 6179 6572 5f67 656e 6572 6174 696f 6e28  ayer_generation(
+0002d9f0: 7365 6c66 2e58 2c20 7365 6c66 2e79 290a  self.X, self.y).
+0002da00: 2020 2020 2020 2020 2020 2020 7472 6169              trai
+0002da10: 6e69 6e67 5f6c 6f73 7320 3d20 7365 6c66  ning_loss = self
+0002da20: 2e74 6573 745f 6675 6e5b 305d 2e70 7265  .test_fun[0].pre
+0002da30: 6469 6374 5f6c 6f73 7328 290a 2020 2020  dict_loss().    
+0002da40: 2020 2020 2020 2020 7365 6c66 2e74 7261          self.tra
+0002da50: 696e 5f64 6174 615f 6869 7374 6f72 792e  in_data_history.
+0002da60: 6170 7065 6e64 2874 7261 696e 696e 675f  append(training_
+0002da70: 6c6f 7373 290a 2020 2020 2020 2020 2020  loss).          
+0002da80: 2020 7465 7374 696e 675f 6c6f 7373 203d    testing_loss =
+0002da90: 2073 656c 662e 7465 7374 5f66 756e 5b31   self.test_fun[1
+0002daa0: 5d2e 7072 6564 6963 745f 6c6f 7373 2829  ].predict_loss()
+0002dab0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0002dac0: 662e 7465 7374 5f64 6174 615f 6869 7374  f.test_data_hist
+0002dad0: 6f72 792e 6170 7065 6e64 2874 6573 7469  ory.append(testi
+0002dae0: 6e67 5f6c 6f73 7329 0a20 2020 2020 2020  ng_loss).       
+0002daf0: 2020 2020 2069 6620 7665 7262 6f73 653a       if verbose:
+0002db00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002db10: 2070 7269 6e74 2827 5472 6169 6e69 6e67   print('Training
+0002db20: 204c 6f73 7327 2c20 7472 6169 6e69 6e67   Loss', training
+0002db30: 5f6c 6f73 7329 0a20 2020 2020 2020 2020  _loss).         
+0002db40: 2020 2020 2020 2070 7269 6e74 2827 5465         print('Te
+0002db50: 7374 696e 6720 4c6f 7373 272c 2074 6573  sting Loss', tes
+0002db60: 7469 6e67 5f6c 6f73 7329 0a20 2020 2020  ting_loss).     
+0002db70: 2020 2020 2020 2073 656c 662e 6669 746e         self.fitn
+0002db80: 6573 735f 6869 7374 6f72 792e 6170 7065  ess_history.appe
+0002db90: 6e64 286e 702e 6d65 616e 285b 696e 642e  nd(np.mean([ind.
+0002dba0: 6669 746e 6573 732e 7776 616c 7565 735b  fitness.wvalues[
+0002dbb0: 305d 2066 6f72 2069 6e64 2069 6e20 706f  0] for ind in po
+0002dbc0: 7075 6c61 7469 6f6e 5d29 290a 2020 2020  pulation])).    
+0002dbd0: 2020 2020 2020 2020 7365 6c66 2e64 6976          self.div
+0002dbe0: 6572 7369 7479 5f68 6973 746f 7279 2e61  ersity_history.a
+0002dbf0: 7070 656e 6428 7365 6c66 2e64 6976 6572  ppend(self.diver
+0002dc00: 7369 7479 5f63 616c 6375 6c61 7469 6f6e  sity_calculation
+0002dc10: 2870 6f70 756c 6174 696f 6e29 290a 2020  (population)).  
+0002dc20: 2020 2020 2020 2020 2020 7365 6c66 2e63            self.c
+0002dc30: 6f73 5f73 696d 696c 6172 6974 795f 6869  os_similarity_hi
+0002dc40: 7374 6f72 792e 6170 7065 6e64 2873 656c  story.append(sel
+0002dc50: 662e 636f 735f 7369 6d69 6c61 7269 7479  f.cos_similarity
+0002dc60: 5f63 616c 6375 6c61 7469 6f6e 2870 6f70  _calculation(pop
+0002dc70: 756c 6174 696f 6e29 290a 2020 2020 2020  ulation)).      
+0002dc80: 2020 2020 2020 6765 6e6f 7479 7065 5f73        genotype_s
+0002dc90: 756d 5f65 6e74 726f 7079 2c20 7068 656e  um_entropy, phen
+0002dca0: 6f74 7970 655f 7375 6d5f 656e 7472 6f70  otype_sum_entrop
+0002dcb0: 7920 3d20 7365 6c66 2e74 7265 655f 656e  y = self.tree_en
+0002dcc0: 7472 6f70 795f 6361 6c63 756c 6174 696f  tropy_calculatio
+0002dcd0: 6e28 706f 7075 6c61 7469 6f6e 290a 2020  n(population).  
+0002dce0: 2020 2020 2020 2020 2020 7365 6c66 2e74            self.t
+0002dcf0: 7265 655f 6765 6e6f 7479 7069 635f 6469  ree_genotypic_di
+0002dd00: 7665 7273 6974 792e 6170 7065 6e64 2867  versity.append(g
+0002dd10: 656e 6f74 7970 655f 7375 6d5f 656e 7472  enotype_sum_entr
+0002dd20: 6f70 7929 0a20 2020 2020 2020 2020 2020  opy).           
+0002dd30: 2073 656c 662e 7472 6565 5f70 6865 6e6f   self.tree_pheno
+0002dd40: 7479 7069 635f 6469 7665 7273 6974 792e  typic_diversity.
+0002dd50: 6170 7065 6e64 2870 6865 6e6f 7479 7065  append(phenotype
+0002dd60: 5f73 756d 5f65 6e74 726f 7079 290a 2020  _sum_entropy).  
+0002dd70: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+0002dd80: 7667 5f74 7265 655f 7369 7a65 5f68 6973  vg_tree_size_his
+0002dd90: 746f 7279 2e61 7070 656e 6428 6e70 2e6d  tory.append(np.m
+0002dda0: 6561 6e28 5b5b 6c65 6e28 6729 2066 6f72  ean([[len(g) for
+0002ddb0: 2067 2069 6e20 702e 6765 6e65 5d20 666f   g in p.gene] fo
+0002ddc0: 7220 7020 696e 2070 6f70 756c 6174 696f  r p in populatio
+0002ddd0: 6e5d 2929 0a20 2020 2020 2020 2020 2020  n])).           
+0002dde0: 2073 656c 662e 6172 6368 6976 655f 636f   self.archive_co
+0002ddf0: 735f 7369 6d69 6c61 7269 7479 5f68 6973  s_similarity_his
+0002de00: 746f 7279 2e61 7070 656e 6428 7365 6c66  tory.append(self
+0002de10: 2e63 6f73 5f73 696d 696c 6172 6974 795f  .cos_similarity_
+0002de20: 6361 6c63 756c 6174 696f 6e28 7365 6c66  calculation(self
+0002de30: 2e68 6f66 2929 0a20 2020 2020 2020 2020  .hof)).         
+0002de40: 2020 2073 656c 662e 6172 6368 6976 655f     self.archive_
+0002de50: 6669 746e 6573 735f 6869 7374 6f72 792e  fitness_history.
+0002de60: 6170 7065 6e64 286e 702e 6d65 616e 285b  append(np.mean([
+0002de70: 696e 642e 6669 746e 6573 732e 7776 616c  ind.fitness.wval
+0002de80: 7565 735b 305d 2066 6f72 2069 6e64 2069  ues[0] for ind i
+0002de90: 6e20 7365 6c66 2e68 6f66 5d29 290a 2020  n self.hof])).  
+0002dea0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+0002deb0: 7263 6869 7665 5f64 6976 6572 7369 7479  rchive_diversity
+0002dec0: 5f68 6973 746f 7279 2e61 7070 656e 6428  _history.append(
+0002ded0: 7365 6c66 2e64 6976 6572 7369 7479 5f63  self.diversity_c
+0002dee0: 616c 6375 6c61 7469 6f6e 2829 290a 0a20  alculation()).. 
+0002def0: 2020 2064 6566 2074 7261 696e 696e 675f     def training_
+0002df00: 7769 7468 5f76 616c 6964 6174 696f 6e5f  with_validation_
+0002df10: 7365 7428 7365 6c66 293a 0a20 2020 2020  set(self):.     
+0002df20: 2020 2023 2054 7261 696e 696e 6720 7468     # Training th
+0002df30: 6520 6669 6e61 6c20 6d6f 6465 6c20 7769  e final model wi
+0002df40: 7468 2076 616c 6964 6174 696f 6e20 7365  th validation se
+0002df50: 740a 2020 2020 2020 2020 6966 2073 656c  t.        if sel
+0002df60: 662e 6172 6368 6976 655f 636f 6e66 6967  f.archive_config
+0002df70: 7572 6174 696f 6e2e 6461 7461 5f63 6f6d  uration.data_com
+0002df80: 6269 6e61 7469 6f6e 2061 6e64 2073 656c  bination and sel
+0002df90: 662e 7661 6c69 6461 7469 6f6e 5f73 697a  f.validation_siz
+0002dfa0: 6520 3e20 303a 0a20 2020 2020 2020 2020  e > 0:.         
+0002dfb0: 2020 2023 2072 6574 7572 6e0a 2020 2020     # return.    
+0002dfc0: 2020 2020 2020 2020 5820 3d20 6e70 2e63          X = np.c
+0002dfd0: 6f6e 6361 7465 6e61 7465 2828 7365 6c66  oncatenate((self
+0002dfe0: 2e58 2c20 7365 6c66 2e76 616c 6964 5f78  .X, self.valid_x
+0002dff0: 292c 2061 7869 733d 3029 0a20 2020 2020  ), axis=0).     
+0002e000: 2020 2020 2020 2079 203d 206e 702e 636f         y = np.co
+0002e010: 6e63 6174 656e 6174 6528 2873 656c 662e  ncatenate((self.
+0002e020: 792c 2073 656c 662e 7661 6c69 645f 7929  y, self.valid_y)
+0002e030: 2c20 6178 6973 3d30 290a 2020 2020 2020  , axis=0).      
+0002e040: 2020 2020 2020 7365 6c66 2e66 696e 616c        self.final
+0002e050: 5f6d 6f64 656c 5f6c 617a 795f 7472 6169  _model_lazy_trai
+0002e060: 6e69 6e67 2873 656c 662e 686f 662c 2058  ning(self.hof, X
+0002e070: 2c20 792c 2066 6f72 6365 5f74 7261 696e  , y, force_train
+0002e080: 696e 673d 5472 7565 290a 0a20 2020 2064  ing=True)..    d
+0002e090: 6566 2074 7265 655f 656e 7472 6f70 795f  ef tree_entropy_
+0002e0a0: 6361 6c63 756c 6174 696f 6e28 7365 6c66  calculation(self
+0002e0b0: 2c20 706f 7075 6c61 7469 6f6e 293a 0a20  , population):. 
+0002e0c0: 2020 2020 2020 2065 6e74 726f 7079 203d         entropy =
+0002e0d0: 206c 616d 6264 6120 703a 202d 7020 2a20   lambda p: -p * 
+0002e0e0: 6e70 2e6c 6f67 2870 290a 2020 2020 2020  np.log(p).      
+0002e0f0: 2020 6765 6e6f 7479 7065 203d 2064 6566    genotype = def
+0002e100: 6175 6c74 6469 6374 2869 6e74 290a 2020  aultdict(int).  
+0002e110: 2020 2020 2020 7068 656e 6f74 7970 6520        phenotype 
+0002e120: 3d20 6465 6661 756c 7464 6963 7428 696e  = defaultdict(in
+0002e130: 7429 0a20 2020 2020 2020 2066 6f72 2070  t).        for p
+0002e140: 2069 6e20 706f 7075 6c61 7469 6f6e 3a0a   in population:.
+0002e150: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0002e160: 742c 2068 2069 6e20 7a69 7028 702e 6765  t, h in zip(p.ge
+0002e170: 6e65 2c20 702e 6861 7368 5f72 6573 756c  ne, p.hash_resul
+0002e180: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
+0002e190: 2020 2020 6765 6e6f 7479 7065 5b73 7472      genotype[str
+0002e1a0: 2874 295d 202b 3d20 310a 2020 2020 2020  (t)] += 1.      
+0002e1b0: 2020 2020 2020 2020 2020 7068 656e 6f74            phenot
+0002e1c0: 7970 655b 685d 202b 3d20 310a 2020 2020  ype[h] += 1.    
+0002e1d0: 2020 2020 7068 656e 6f74 7970 655f 7375      phenotype_su
+0002e1e0: 6d5f 7661 6c75 6520 3d20 7375 6d28 7068  m_value = sum(ph
+0002e1f0: 656e 6f74 7970 652e 7661 6c75 6573 2829  enotype.values()
+0002e200: 290a 2020 2020 2020 2020 7068 656e 6f74  ).        phenot
+0002e210: 7970 655f 7375 6d5f 656e 7472 6f70 7920  ype_sum_entropy 
+0002e220: 3d20 300a 2020 2020 2020 2020 666f 7220  = 0.        for 
+0002e230: 6b2c 2076 2069 6e20 7068 656e 6f74 7970  k, v in phenotyp
+0002e240: 652e 6974 656d 7328 293a 0a20 2020 2020  e.items():.     
+0002e250: 2020 2020 2020 2070 6865 6e6f 7479 7065         phenotype
+0002e260: 5f73 756d 5f65 6e74 726f 7079 202b 3d20  _sum_entropy += 
+0002e270: 656e 7472 6f70 7928 7620 2f20 7068 656e  entropy(v / phen
+0002e280: 6f74 7970 655f 7375 6d5f 7661 6c75 6529  otype_sum_value)
+0002e290: 0a20 2020 2020 2020 2067 656e 6f74 7970  .        genotyp
+0002e2a0: 655f 7375 6d5f 7661 6c75 6520 3d20 7375  e_sum_value = su
+0002e2b0: 6d28 6765 6e6f 7479 7065 2e76 616c 7565  m(genotype.value
+0002e2c0: 7328 2929 0a20 2020 2020 2020 2067 656e  s()).        gen
+0002e2d0: 6f74 7970 655f 7375 6d5f 656e 7472 6f70  otype_sum_entrop
+0002e2e0: 7920 3d20 300a 2020 2020 2020 2020 666f  y = 0.        fo
+0002e2f0: 7220 6b2c 2076 2069 6e20 6765 6e6f 7479  r k, v in genoty
+0002e300: 7065 2e69 7465 6d73 2829 3a0a 2020 2020  pe.items():.    
+0002e310: 2020 2020 2020 2020 6765 6e6f 7479 7065          genotype
+0002e320: 5f73 756d 5f65 6e74 726f 7079 202b 3d20  _sum_entropy += 
+0002e330: 656e 7472 6f70 7928 7620 2f20 6765 6e6f  entropy(v / geno
+0002e340: 7479 7065 5f73 756d 5f76 616c 7565 290a  type_sum_value).
+0002e350: 2020 2020 2020 2020 7265 7475 726e 2067          return g
+0002e360: 656e 6f74 7970 655f 7375 6d5f 656e 7472  enotype_sum_entr
+0002e370: 6f70 792c 2070 6865 6e6f 7479 7065 5f73  opy, phenotype_s
+0002e380: 756d 5f65 6e74 726f 7079 0a0a 2020 2020  um_entropy..    
+0002e390: 6465 6620 7365 6c66 5f61 6461 7074 6976  def self_adaptiv
+0002e3a0: 655f 6576 6f6c 7574 696f 6e28 7365 6c66  e_evolution(self
+0002e3b0: 2c20 6f66 6673 7072 696e 673a 204c 6973  , offspring: Lis
+0002e3c0: 745b 4d75 6c74 6970 6c65 4765 6e65 4750  t[MultipleGeneGP
+0002e3d0: 5d29 3a0a 2020 2020 2020 2020 6966 2069  ]):.        if i
+0002e3e0: 7369 6e73 7461 6e63 6528 7365 6c66 2e63  sinstance(self.c
+0002e3f0: 726f 7373 5f70 622c 2073 7472 2920 616e  ross_pb, str) an
+0002e400: 6420 7365 6c66 2e63 726f 7373 5f70 622e  d self.cross_pb.
+0002e410: 7374 6172 7473 7769 7468 2827 4164 6170  startswith('Adap
+0002e420: 7469 7665 2d27 293a 0a20 2020 2020 2020  tive-'):.       
+0002e430: 2020 2020 2063 726f 7373 5f70 6220 3d20       cross_pb = 
+0002e440: 666c 6f61 7428 7365 6c66 2e63 726f 7373  float(self.cross
+0002e450: 5f70 622e 7265 706c 6163 6528 2741 6461  _pb.replace('Ada
+0002e460: 7074 6976 652d 272c 2027 2729 290a 2020  ptive-', '')).  
+0002e470: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0002e480: 2020 2020 2020 2020 6372 6f73 735f 7062          cross_pb
+0002e490: 203d 2073 656c 662e 6372 6f73 735f 7062   = self.cross_pb
+0002e4a0: 0a0a 2020 2020 2020 2020 6966 2069 7369  ..        if isi
+0002e4b0: 6e73 7461 6e63 6528 7365 6c66 2e6d 7574  nstance(self.mut
+0002e4c0: 6174 696f 6e5f 7062 2c20 7374 7229 2061  ation_pb, str) a
+0002e4d0: 6e64 2073 656c 662e 6d75 7461 7469 6f6e  nd self.mutation
+0002e4e0: 5f70 622e 7374 6172 7473 7769 7468 2827  _pb.startswith('
+0002e4f0: 4164 6170 7469 7665 2d27 293a 0a20 2020  Adaptive-'):.   
+0002e500: 2020 2020 2020 2020 206d 7574 6174 696f           mutatio
+0002e510: 6e5f 7062 203d 2066 6c6f 6174 2873 656c  n_pb = float(sel
+0002e520: 662e 6d75 7461 7469 6f6e 5f70 622e 7265  f.mutation_pb.re
+0002e530: 706c 6163 6528 2741 6461 7074 6976 652d  place('Adaptive-
+0002e540: 272c 2027 2729 290a 2020 2020 2020 2020  ', '')).        
+0002e550: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0002e560: 2020 6d75 7461 7469 6f6e 5f70 6220 3d20    mutation_pb = 
+0002e570: 7365 6c66 2e6d 7574 6174 696f 6e5f 7062  self.mutation_pb
+0002e580: 0a0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+0002e590: 662e 696e 7472 6f6e 5f70 726f 6261 6269  f.intron_probabi
+0002e5a0: 6c69 7479 203e 2030 3a0a 2020 2020 2020  lity > 0:.      
+0002e5b0: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+0002e5c0: 616e 6765 2830 2c20 6c65 6e28 6f66 6673  ange(0, len(offs
+0002e5d0: 7072 696e 6729 2c20 3229 3a0a 2020 2020  pring), 2):.    
+0002e5e0: 2020 2020 2020 2020 2020 2020 6966 2072              if r
+0002e5f0: 616e 646f 6d2e 7261 6e64 6f6d 2829 203c  andom.random() <
+0002e600: 2063 726f 7373 5f70 623a 0a20 2020 2020   cross_pb:.     
+0002e610: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0002e620: 2c20 6220 3d20 6f66 6673 7072 696e 675b  , b = offspring[
+0002e630: 695d 2e61 6374 6976 655f 6765 6e65 2c20  i].active_gene, 
+0002e640: 6f66 6673 7072 696e 675b 6920 2b20 315d  offspring[i + 1]
+0002e650: 2e61 6374 6976 655f 6765 6e65 0a20 2020  .active_gene.   
+0002e660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e670: 2061 2c20 6220 3d20 6378 5477 6f50 6f69   a, b = cxTwoPoi
+0002e680: 6e74 2861 2c20 6229 0a20 2020 2020 2020  nt(a, b).       
+0002e690: 2020 2020 2020 2020 2020 2020 206f 6666               off
+0002e6a0: 7370 7269 6e67 5b69 5d2e 6163 7469 7665  spring[i].active
+0002e6b0: 5f67 656e 652c 206f 6666 7370 7269 6e67  _gene, offspring
+0002e6c0: 5b69 202b 2031 5d2e 6163 7469 7665 5f67  [i + 1].active_g
+0002e6d0: 656e 6520 3d20 612c 2062 0a0a 2020 2020  ene = a, b..    
+0002e6e0: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+0002e6f0: 2072 616e 6765 2830 2c20 6c65 6e28 6f66   range(0, len(of
+0002e700: 6673 7072 696e 6729 293a 0a20 2020 2020  fspring)):.     
+0002e710: 2020 2020 2020 2020 2020 2069 6620 7261             if ra
+0002e720: 6e64 6f6d 2e72 616e 646f 6d28 2920 3c20  ndom.random() < 
+0002e730: 6d75 7461 7469 6f6e 5f70 623a 0a20 2020  mutation_pb:.   
+0002e740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e750: 2061 203d 206f 6666 7370 7269 6e67 5b69   a = offspring[i
+0002e760: 5d2e 6163 7469 7665 5f67 656e 650a 2020  ].active_gene.  
+0002e770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e780: 2020 612c 203d 206d 7574 466c 6970 4269    a, = mutFlipBi
+0002e790: 7428 612c 2069 6e64 7062 3d31 202f 2073  t(a, indpb=1 / s
+0002e7a0: 656c 662e 6765 6e65 5f6e 756d 290a 2020  elf.gene_num).  
+0002e7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e7c0: 2020 6f66 6673 7072 696e 675b 695d 2e61    offspring[i].a
+0002e7d0: 6374 6976 655f 6765 6e65 203d 2061 0a0a  ctive_gene = a..
+0002e7e0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0002e7f0: 6920 696e 2072 616e 6765 2830 2c20 6c65  i in range(0, le
+0002e800: 6e28 6f66 6673 7072 696e 6729 293a 0a20  n(offspring)):. 
+0002e810: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0002e820: 2072 6570 6169 7269 6e67 2c20 666f 7263   repairing, forc
+0002e830: 696e 6720 6f6e 6520 6765 6e65 2070 6f69  ing one gene poi
+0002e840: 6e74 2065 7175 616c 7320 746f 206f 6e65  nt equals to one
+0002e850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002e860: 2069 6620 6e70 2e73 756d 286f 6666 7370   if np.sum(offsp
+0002e870: 7269 6e67 5b69 5d2e 6163 7469 7665 5f67  ring[i].active_g
+0002e880: 656e 6529 203d 3d20 303a 0a20 2020 2020  ene) == 0:.     
+0002e890: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0002e8a0: 6e64 6578 203d 206e 702e 7261 6e64 6f6d  ndex = np.random
+0002e8b0: 2e72 616e 6469 6e74 2830 2c20 6c65 6e28  .randint(0, len(
+0002e8c0: 6f66 6673 7072 696e 675b 695d 2e61 6374  offspring[i].act
+0002e8d0: 6976 655f 6765 6e65 2929 0a20 2020 2020  ive_gene)).     
+0002e8e0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+0002e8f0: 6666 7370 7269 6e67 5b69 5d2e 6163 7469  ffspring[i].acti
+0002e900: 7665 5f67 656e 655b 696e 6465 785d 203d  ve_gene[index] =
+0002e910: 2031 0a0a 2020 2020 6465 6620 7365 6c66   1..    def self
+0002e920: 5f61 6461 7074 6976 655f 6d75 7461 7469  _adaptive_mutati
+0002e930: 6f6e 2873 656c 662c 206f 2c20 706f 7075  on(self, o, popu
+0002e940: 6c61 7469 6f6e 293a 0a20 2020 2020 2020  lation):.       
+0002e950: 2069 6620 7365 6c66 2e62 6173 655f 6c65   if self.base_le
+0002e960: 6172 6e65 7220 3d3d 2027 4164 6170 7469  arner == 'Adapti
+0002e970: 7665 4c61 7373 6f27 3a0a 2020 2020 2020  veLasso':.      
+0002e980: 2020 2020 2020 6661 6374 6f72 203d 206e        factor = n
+0002e990: 702e 7261 6e64 6f6d 2e75 6e69 666f 726d  p.random.uniform
+0002e9a0: 2830 2e35 2c20 312c 2031 295b 305d 0a20  (0.5, 1, 1)[0]. 
+0002e9b0: 2020 2020 2020 2020 2020 2061 2c20 6220             a, b 
+0002e9c0: 3d20 7365 6c52 616e 646f 6d28 706f 7075  = selRandom(popu
+0002e9d0: 6c61 7469 6f6e 2c20 3229 0a20 2020 2020  lation, 2).     
+0002e9e0: 2020 2020 2020 206f 2e70 6172 616d 6574         o.paramet
+0002e9f0: 6572 735b 274c 6173 736f 275d 203d 206f  ers['Lasso'] = o
+0002ea00: 2e70 6172 616d 6574 6572 735b 274c 6173  .parameters['Las
+0002ea10: 736f 275d 202b 205c 0a20 2020 2020 2020  so'] + \.       
+0002ea20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ea30: 2020 2020 2020 2020 2020 2020 2066 6163               fac
+0002ea40: 746f 7220 2a20 2861 2e70 6172 616d 6574  tor * (a.paramet
+0002ea50: 6572 735b 274c 6173 736f 275d 202d 2062  ers['Lasso'] - b
+0002ea60: 2e70 6172 616d 6574 6572 735b 274c 6173  .parameters['Las
+0002ea70: 736f 275d 290a 2020 2020 2020 2020 2020  so']).          
+0002ea80: 2020 6f2e 7061 7261 6d65 7465 7273 5b27    o.parameters['
+0002ea90: 4c61 7373 6f27 5d20 3d20 6e70 2e63 6c69  Lasso'] = np.cli
+0002eaa0: 7028 6f2e 7061 7261 6d65 7465 7273 5b27  p(o.parameters['
+0002eab0: 4c61 7373 6f27 5d2c 202d 352c 2030 290a  Lasso'], -5, 0).
+0002eac0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0002ead0: 6d67 705f 6d6f 6465 203d 3d20 2752 6567  mgp_mode == 'Reg
+0002eae0: 6973 7465 7227 3a0a 2020 2020 2020 2020  ister':.        
+0002eaf0: 2020 2020 6e65 775f 7265 6769 7374 6572      new_register
+0002eb00: 203d 206e 702e 7261 6e64 6f6d 2e72 616e   = np.random.ran
+0002eb10: 6469 6e74 2830 2c20 7365 6c66 2e6e 756d  dint(0, self.num
+0002eb20: 6265 725f 6f66 5f72 6567 6973 7465 722c  ber_of_register,
+0002eb30: 2073 656c 662e 6765 6e65 5f6e 756d 290a   self.gene_num).
+0002eb40: 2020 2020 2020 2020 2020 2020 666c 6970              flip
+0002eb50: 5f62 6974 203d 206e 702e 7261 6e64 6f6d  _bit = np.random
+0002eb60: 2e72 616e 6428 7365 6c66 2e67 656e 655f  .rand(self.gene_
+0002eb70: 6e75 6d29 203c 2073 656c 662e 7265 6769  num) < self.regi
+0002eb80: 7374 6572 5f6d 7574 6174 696f 6e5f 7072  ster_mutation_pr
+0002eb90: 6f62 6162 696c 6974 790a 2020 2020 2020  obability.      
+0002eba0: 2020 2020 2020 6f2e 7061 7261 6d65 7465        o.paramete
+0002ebb0: 7273 5b27 5265 6769 7374 6572 275d 5b66  rs['Register'][f
+0002ebc0: 6c69 705f 6269 745d 203d 206e 6577 5f72  lip_bit] = new_r
+0002ebd0: 6567 6973 7465 725b 666c 6970 5f62 6974  egister[flip_bit
+0002ebe0: 5d0a 2020 2020 2020 2020 6966 2073 656c  ].        if sel
+0002ebf0: 662e 6261 7365 5f6c 6561 726e 6572 203d  f.base_learner =
+0002ec00: 3d20 2744 796e 616d 6963 2d44 5427 3a0a  = 'Dynamic-DT':.
+0002ec10: 2020 2020 2020 2020 2020 2020 2222 220a              """.
+0002ec20: 2020 2020 2020 2020 2020 2020 4479 6e61              Dyna
+0002ec30: 6d69 6361 6c6c 7920 7475 6e65 2074 6865  mically tune the
+0002ec40: 206c 6561 6620 7369 7a65 206f 6620 6465   leaf size of de
+0002ec50: 6369 7369 6f6e 2074 7265 650a 2020 2020  cision tree.    
+0002ec60: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0002ec70: 2020 2020 2020 2020 2320 6261 7365 206c          # base l
+0002ec80: 6561 726e 6572 206d 7574 6174 696f 6e0a  earner mutation.
+0002ec90: 2020 2020 2020 2020 2020 2020 6261 7365              base
+0002eca0: 5f6c 6561 726e 6572 5f6d 7574 6174 696f  _learner_mutatio
+0002ecb0: 6e5f 7261 7465 203d 2030 2e31 0a20 2020  n_rate = 0.1.   
+0002ecc0: 2020 2020 2020 2020 2069 6620 7261 6e64           if rand
+0002ecd0: 6f6d 2e72 616e 646f 6d28 2920 3c20 6261  om.random() < ba
+0002ece0: 7365 5f6c 6561 726e 6572 5f6d 7574 6174  se_learner_mutat
+0002ecf0: 696f 6e5f 7261 7465 3a0a 2020 2020 2020  ion_rate:.      
+0002ed00: 2020 2020 2020 2020 2020 6f2e 6479 6e61            o.dyna
+0002ed10: 6d69 635f 6c65 6166 5f73 697a 6520 3d20  mic_leaf_size = 
+0002ed20: 6e70 2e63 6c69 7028 6f2e 6479 6e61 6d69  np.clip(o.dynami
+0002ed30: 635f 6c65 6166 5f73 697a 6520 2b20 7261  c_leaf_size + ra
+0002ed40: 6e64 6f6d 2e63 686f 6963 6528 5b2d 312c  ndom.choice([-1,
+0002ed50: 2031 5d29 2c0a 2020 2020 2020 2020 2020   1]),.          
+0002ed60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ed70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ed80: 2020 2020 312c 2031 3029 0a20 2020 2020      1, 10).     
+0002ed90: 2020 2069 6620 7365 6c66 2e62 6173 655f     if self.base_
+0002eda0: 6c65 6172 6e65 7220 3d3d 2027 4479 6e61  learner == 'Dyna
+0002edb0: 6d69 632d 4c6f 6769 7374 6963 5265 6772  mic-LogisticRegr
+0002edc0: 6573 7369 6f6e 273a 0a20 2020 2020 2020  ession':.       
+0002edd0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0002ede0: 2020 2020 2044 796e 616d 6963 616c 6c79       Dynamically
+0002edf0: 2074 756e 6520 7468 6520 7265 6775 6c61   tune the regula
+0002ee00: 7269 7a61 7469 6f6e 2074 6572 6d20 6f66  rization term of
+0002ee10: 206c 6f67 6973 7469 6320 7265 6772 6573   logistic regres
+0002ee20: 7369 6f6e 0a20 2020 2020 2020 2020 2020  sion.           
+0002ee30: 2022 2222 0a20 2020 2020 2020 2020 2020   """.           
+0002ee40: 2062 6173 655f 6c65 6172 6e65 725f 6d75   base_learner_mu
+0002ee50: 7461 7469 6f6e 5f72 6174 6520 3d20 302e  tation_rate = 0.
+0002ee60: 310a 2020 2020 2020 2020 2020 2020 6966  1.            if
+0002ee70: 2072 616e 646f 6d2e 7261 6e64 6f6d 2829   random.random()
+0002ee80: 203c 2062 6173 655f 6c65 6172 6e65 725f   < base_learner_
+0002ee90: 6d75 7461 7469 6f6e 5f72 6174 653a 0a20  mutation_rate:. 
+0002eea0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+0002eeb0: 2e64 796e 616d 6963 5f72 6567 756c 6172  .dynamic_regular
+0002eec0: 697a 6174 696f 6e20 3d20 6e70 2e63 6c69  ization = np.cli
+0002eed0: 7028 6f2e 6479 6e61 6d69 635f 7265 6775  p(o.dynamic_regu
+0002eee0: 6c61 7269 7a61 7469 6f6e 202a 2072 616e  larization * ran
+0002eef0: 646f 6d2e 6368 6f69 6365 285b 302e 312c  dom.choice([0.1,
+0002ef00: 2031 305d 292c 0a20 2020 2020 2020 2020   10]),.         
+0002ef10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ef20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ef30: 2020 2020 2020 2020 2020 3165 2d34 2c20            1e-4, 
+0002ef40: 3165 3429 0a0a 2020 2020 6465 6620 7472  1e4)..    def tr
+0002ef50: 6164 6974 696f 6e61 6c5f 7061 7265 6e74  aditional_parent
+0002ef60: 5f73 656c 6563 7469 6f6e 2873 656c 662c  _selection(self,
+0002ef70: 2074 6f6f 6c62 6f78 2c20 7061 7265 6e74   toolbox, parent
+0002ef80: 2c20 6578 7465 726e 616c 5f61 7263 6869  , external_archi
+0002ef90: 7665 293a 0a20 2020 2020 2020 2023 2054  ve):.        # T
+0002efa0: 6865 2074 7261 6469 7469 6f6e 616c 2070  he traditional p
+0002efb0: 6172 656e 7420 7365 6c65 6374 696f 6e20  arent selection 
+0002efc0: 7072 6f63 6573 730a 2020 2020 2020 2020  process.        
+0002efd0: 6966 2073 656c 662e 6261 7365 5f6c 6561  if self.base_lea
+0002efe0: 726e 6572 2069 6e20 5b27 4454 2d4c 5227  rner in ['DT-LR'
+0002eff0: 2c20 2742 616c 616e 6365 642d 4454 2d4c  , 'Balanced-DT-L
+0002f000: 5227 2c20 2742 616c 616e 6365 642d 5244  R', 'Balanced-RD
+0002f010: 542d 4c52 275d 3a0a 2020 2020 2020 2020  T-LR']:.        
+0002f020: 2020 2020 2320 6d75 6c74 692d 6261 7365      # multi-base
+0002f030: 206c 6561 726e 6572 2073 656c 6563 7469   learner selecti
+0002f040: 6f6e 0a20 2020 2020 2020 2020 2020 2069  on.            i
+0002f050: 6620 7261 6e64 6f6d 2e72 616e 646f 6d28  f random.random(
+0002f060: 2920 3c20 7365 6c66 2e72 6d70 5f72 6174  ) < self.rmp_rat
+0002f070: 696f 3a0a 2020 2020 2020 2020 2020 2020  io:.            
+0002f080: 2020 2020 2320 6372 6f73 7320 6265 7477      # cross betw
+0002f090: 6565 6e20 6469 6666 6572 656e 7420 6d6f  een different mo
+0002f0a0: 6465 6c73 0a20 2020 2020 2020 2020 2020  dels.           
+0002f0b0: 2020 2020 2023 2030 2e32 352d 3e20 4141       # 0.25-> AA
+0002f0c0: 2042 420a 2020 2020 2020 2020 2020 2020   BB.            
+0002f0d0: 2020 2020 2320 302e 3235 2d3e 2041 4220      # 0.25-> AB 
+0002f0e0: 4241 0a20 2020 2020 2020 2020 2020 2020  BA.             
+0002f0f0: 2020 2070 6172 656e 745f 6120 3d20 7365     parent_a = se
+0002f100: 6c66 2e73 616d 706c 655f 6d6f 6465 6c5f  lf.sample_model_
+0002f110: 6e61 6d65 2870 6172 656e 7429 0a20 2020  name(parent).   
+0002f120: 2020 2020 2020 2020 2020 2020 206f 6666               off
+0002f130: 7370 7269 6e67 5f61 203d 2074 6f6f 6c62  spring_a = toolb
+0002f140: 6f78 2e73 656c 6563 7428 7061 7265 6e74  ox.select(parent
+0002f150: 5f61 2c20 3129 0a20 2020 2020 2020 2020  _a, 1).         
+0002f160: 2020 2020 2020 2070 6172 656e 745f 6220         parent_b 
+0002f170: 3d20 7365 6c66 2e73 616d 706c 655f 6d6f  = self.sample_mo
+0002f180: 6465 6c5f 6e61 6d65 2870 6172 656e 7429  del_name(parent)
+0002f190: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002f1a0: 206f 6666 7370 7269 6e67 5f62 203d 2074   offspring_b = t
+0002f1b0: 6f6f 6c62 6f78 2e73 656c 6563 7428 7061  oolbox.select(pa
+0002f1c0: 7265 6e74 5f62 2c20 3129 0a20 2020 2020  rent_b, 1).     
+0002f1d0: 2020 2020 2020 2020 2020 206f 6666 7370             offsp
+0002f1e0: 7269 6e67 203d 205b 6f66 6673 7072 696e  ring = [offsprin
+0002f1f0: 675f 615b 305d 2c20 6f66 6673 7072 696e  g_a[0], offsprin
+0002f200: 675f 625b 305d 5d0a 2020 2020 2020 2020  g_b[0]].        
+0002f210: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0002f220: 2020 2020 2020 2020 2020 7061 7265 6e74            parent
+0002f230: 5f61 203d 2073 656c 662e 7361 6d70 6c65  _a = self.sample
+0002f240: 5f6d 6f64 656c 5f6e 616d 6528 7061 7265  _model_name(pare
+0002f250: 6e74 290a 2020 2020 2020 2020 2020 2020  nt).            
+0002f260: 2020 2020 6f66 6673 7072 696e 6720 3d20      offspring = 
+0002f270: 746f 6f6c 626f 782e 7365 6c65 6374 2870  toolbox.select(p
+0002f280: 6172 656e 745f 612c 2032 290a 2020 2020  arent_a, 2).    
+0002f290: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0002f2a0: 2020 2020 2020 6966 2073 656c 662e 6e75        if self.nu
+0002f2b0: 6d62 6572 5f6f 665f 7061 7265 6e74 7320  mber_of_parents 
+0002f2c0: 3e20 303a 0a20 2020 2020 2020 2020 2020  > 0:.           
+0002f2d0: 2020 2020 2023 206d 756c 7469 2d70 6172       # multi-par
+0002f2e0: 656e 7420 6765 6e65 7261 7469 6f6e 2c20  ent generation, 
+0002f2f0: 7768 6963 6820 6973 2070 6172 7469 6375  which is particu
+0002f300: 6c61 726c 7920 7573 6566 756c 2066 6f72  larly useful for
+0002f310: 206d 756c 7469 2d74 7265 6520 4750 0a20   multi-tree GP. 
+0002f320: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+0002f330: 6666 7370 7269 6e67 203d 205b 5d0a 2020  ffspring = [].  
+0002f340: 2020 2020 2020 2020 2020 2020 2020 6f66                of
+0002f350: 6673 7072 696e 672e 6170 7065 6e64 2873  fspring.append(s
+0002f360: 656c 662e 6f66 6673 7072 696e 675f 6765  elf.offspring_ge
+0002f370: 6e65 7261 7469 6f6e 2874 6f6f 6c62 6f78  neration(toolbox
+0002f380: 2c20 7061 7265 6e74 2c0a 2020 2020 2020  , parent,.      
+0002f390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f3c0: 2020 2020 2073 656c 662e 6e75 6d62 6572       self.number
+0002f3d0: 5f6f 665f 7061 7265 6e74 732c 2065 7874  _of_parents, ext
+0002f3e0: 6572 6e61 6c5f 6172 6368 6976 6529 5b30  ernal_archive)[0
+0002f3f0: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
+0002f400: 2020 206f 6666 7370 7269 6e67 2e61 7070     offspring.app
+0002f410: 656e 6428 7365 6c66 2e6f 6666 7370 7269  end(self.offspri
+0002f420: 6e67 5f67 656e 6572 6174 696f 6e28 746f  ng_generation(to
+0002f430: 6f6c 626f 782c 2070 6172 656e 742c 0a20  olbox, parent,. 
+0002f440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f470: 2020 2020 2020 2020 2020 7365 6c66 2e6e            self.n
+0002f480: 756d 6265 725f 6f66 5f70 6172 656e 7473  umber_of_parents
+0002f490: 2c20 6578 7465 726e 616c 5f61 7263 6869  , external_archi
+0002f4a0: 7665 295b 305d 290a 2020 2020 2020 2020  ve)[0]).        
+0002f4b0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0002f4c0: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
+0002f4d0: 6e73 7461 6e63 6528 7365 6c66 2e65 7874  nstance(self.ext
+0002f4e0: 6572 6e61 6c5f 6172 6368 6976 652c 2069  ernal_archive, i
+0002f4f0: 6e74 2920 616e 6420 7365 6c66 2e65 7874  nt) and self.ext
+0002f500: 6572 6e61 6c5f 6172 6368 6976 6520 3e3d  ernal_archive >=
+0002f510: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+0002f520: 2020 2020 2020 2020 6f66 6673 7072 696e          offsprin
+0002f530: 6720 3d20 746f 6f6c 626f 782e 7365 6c65  g = toolbox.sele
+0002f540: 6374 2870 6172 656e 7420 2b20 6578 7465  ct(parent + exte
+0002f550: 726e 616c 5f61 7263 6869 7665 2c20 3229  rnal_archive, 2)
+0002f560: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002f570: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0002f580: 2020 2020 2020 2020 2020 206f 6666 7370             offsp
+0002f590: 7269 6e67 203d 2074 6f6f 6c62 6f78 2e73  ring = toolbox.s
+0002f5a0: 656c 6563 7428 7061 7265 6e74 2c20 3229  elect(parent, 2)
+0002f5b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0002f5c0: 6f66 6673 7072 696e 670a 0a20 2020 2064  offspring..    d
+0002f5d0: 6566 2072 6564 756e 6461 6e74 5f66 6561  ef redundant_fea
+0002f5e0: 7475 7265 735f 6361 6c63 756c 6174 696f  tures_calculatio
+0002f5f0: 6e28 7365 6c66 2c20 6f66 6673 7072 696e  n(self, offsprin
+0002f600: 6729 3a0a 2020 2020 2020 2020 6375 7272  g):.        curr
+0002f610: 656e 745f 7265 6475 6e64 616e 745f 6665  ent_redundant_fe
+0002f620: 6174 7572 6573 203d 2030 0a20 2020 2020  atures = 0.     
+0002f630: 2020 2063 7572 7265 6e74 5f69 7272 656c     current_irrel
+0002f640: 6576 616e 745f 6665 6174 7572 6573 203d  evant_features =
+0002f650: 2030 0a20 2020 2020 2020 2066 6f72 206f   0.        for o
+0002f660: 2069 6e20 6f66 6673 7072 696e 673a 0a20   in offspring:. 
+0002f670: 2020 2020 2020 2020 2020 2068 6173 685f             hash_
+0002f680: 7365 7420 3d20 7365 7428 290a 2020 2020  set = set().    
+0002f690: 2020 2020 2020 2020 666f 7220 6720 696e          for g in
+0002f6a0: 206f 2e68 6173 685f 7265 7375 6c74 3a0a   o.hash_result:.
+0002f6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f6c0: 6966 2067 2069 6e20 6861 7368 5f73 6574  if g in hash_set
+0002f6d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002f6e0: 2020 2020 2020 6375 7272 656e 745f 7265        current_re
+0002f6f0: 6475 6e64 616e 745f 6665 6174 7572 6573  dundant_features
+0002f700: 202b 3d20 310a 2020 2020 2020 2020 2020   += 1.          
+0002f710: 2020 2020 2020 2020 2020 7365 6c66 2e72            self.r
+0002f720: 6564 756e 6461 6e74 5f66 6561 7475 7265  edundant_feature
+0002f730: 7320 2b3d 2031 0a20 2020 2020 2020 2020  s += 1.         
+0002f740: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0002f750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f760: 2068 6173 685f 7365 742e 6164 6428 6729   hash_set.add(g)
+0002f770: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0002f780: 2067 2069 6e20 6f2e 636f 6566 3a0a 2020   g in o.coef:.  
+0002f790: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0002f7a0: 2067 203c 2073 656c 662e 6972 7265 6c65   g < self.irrele
+0002f7b0: 7661 6e74 5f66 6561 7475 7265 5f72 6174  vant_feature_rat
+0002f7c0: 696f 3a0a 2020 2020 2020 2020 2020 2020  io:.            
+0002f7d0: 2020 2020 2020 2020 6375 7272 656e 745f          current_
+0002f7e0: 6972 7265 6c65 7661 6e74 5f66 6561 7475  irrelevant_featu
+0002f7f0: 7265 7320 2b3d 2031 0a20 2020 2020 2020  res += 1.       
+0002f800: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0002f810: 662e 6972 7265 6c65 7661 6e74 5f66 6561  f.irrelevant_fea
+0002f820: 7475 7265 7320 2b3d 2031 0a20 2020 2020  tures += 1.     
+0002f830: 2020 2073 656c 662e 7265 6475 6e64 616e     self.redundan
+0002f840: 745f 6665 6174 7572 6573 5f68 6973 746f  t_features_histo
+0002f850: 7279 2e61 7070 656e 6428 6375 7272 656e  ry.append(curren
+0002f860: 745f 7265 6475 6e64 616e 745f 6665 6174  t_redundant_feat
+0002f870: 7572 6573 290a 2020 2020 2020 2020 7365  ures).        se
+0002f880: 6c66 2e69 7272 656c 6576 616e 745f 6665  lf.irrelevant_fe
+0002f890: 6174 7572 6573 5f68 6973 746f 7279 2e61  atures_history.a
+0002f8a0: 7070 656e 6428 6375 7272 656e 745f 6972  ppend(current_ir
+0002f8b0: 7265 6c65 7661 6e74 5f66 6561 7475 7265  relevant_feature
+0002f8c0: 7329 0a0a 2020 2020 6465 6620 7570 6461  s)..    def upda
+0002f8d0: 7465 5f65 7874 6572 6e61 6c5f 6172 6368  te_external_arch
+0002f8e0: 6976 6528 7365 6c66 2c20 706f 7075 6c61  ive(self, popula
+0002f8f0: 7469 6f6e 2c20 6578 7465 726e 616c 5f61  tion, external_a
+0002f900: 7263 6869 7665 293a 0a20 2020 2020 2020  rchive):.       
+0002f910: 2069 6620 6973 696e 7374 616e 6365 2873   if isinstance(s
+0002f920: 656c 662e 6578 7465 726e 616c 5f61 7263  elf.external_arc
+0002f930: 6869 7665 2c20 696e 7429 3a0a 2020 2020  hive, int):.    
+0002f940: 2020 2020 2020 2020 6966 2065 7874 6572          if exter
+0002f950: 6e61 6c5f 6172 6368 6976 6520 6973 206e  nal_archive is n
+0002f960: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+0002f970: 2020 2020 2020 2020 2065 7874 6572 6e61           externa
+0002f980: 6c5f 6172 6368 6976 6520 3d20 7365 6c42  l_archive = selB
+0002f990: 6573 7428 6c69 7374 2865 7874 6572 6e61  est(list(externa
+0002f9a0: 6c5f 6172 6368 6976 6529 202b 206c 6973  l_archive) + lis
+0002f9b0: 7428 706f 7075 6c61 7469 6f6e 292c 2073  t(population), s
+0002f9c0: 656c 662e 6578 7465 726e 616c 5f61 7263  elf.external_arc
+0002f9d0: 6869 7665 290a 2020 2020 2020 2020 2020  hive).          
+0002f9e0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0002f9f0: 2020 2020 2020 2020 6578 7465 726e 616c          external
+0002fa00: 5f61 7263 6869 7665 203d 2073 656c 4265  _archive = selBe
+0002fa10: 7374 286c 6973 7428 706f 7075 6c61 7469  st(list(populati
+0002fa20: 6f6e 292c 2073 656c 662e 6578 7465 726e  on), self.extern
+0002fa30: 616c 5f61 7263 6869 7665 290a 2020 2020  al_archive).    
+0002fa40: 2020 2020 656c 6966 2073 656c 662e 6578      elif self.ex
+0002fa50: 7465 726e 616c 5f61 7263 6869 7665 2069  ternal_archive i
+0002fa60: 7320 6e6f 7420 4e6f 6e65 2061 6e64 2073  s not None and s
+0002fa70: 656c 662e 6578 7465 726e 616c 5f61 7263  elf.external_arc
+0002fa80: 6869 7665 2021 3d20 4661 6c73 6520 5c0a  hive != False \.
+0002fa90: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+0002faa0: 7365 6c66 2e65 7874 6572 6e61 6c5f 6172  self.external_ar
+0002fab0: 6368 6976 652e 7374 6172 7473 7769 7468  chive.startswith
+0002fac0: 2827 5369 7a65 2d27 293a 0a20 2020 2020  ('Size-'):.     
+0002fad0: 2020 2020 2020 2073 697a 6520 3d20 696e         size = in
+0002fae0: 7428 7365 6c66 2e65 7874 6572 6e61 6c5f  t(self.external_
+0002faf0: 6172 6368 6976 652e 7265 706c 6163 6528  archive.replace(
+0002fb00: 2753 697a 652d 272c 2027 2729 290a 2020  'Size-', '')).  
+0002fb10: 2020 2020 2020 2020 2020 6966 2065 7874            if ext
+0002fb20: 6572 6e61 6c5f 6172 6368 6976 6520 6973  ernal_archive is
+0002fb30: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+0002fb40: 2020 2020 2020 2020 2020 2065 7874 6572             exter
+0002fb50: 6e61 6c5f 6172 6368 6976 6520 3d20 7365  nal_archive = se
+0002fb60: 6c42 6573 7428 6c69 7374 2865 7874 6572  lBest(list(exter
+0002fb70: 6e61 6c5f 6172 6368 6976 6529 202b 206c  nal_archive) + l
+0002fb80: 6973 7428 706f 7075 6c61 7469 6f6e 292c  ist(population),
+0002fb90: 2073 697a 6520 2a20 7365 6c66 2e6e 5f70   size * self.n_p
+0002fba0: 6f70 290a 2020 2020 2020 2020 2020 2020  op).            
+0002fbb0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0002fbc0: 2020 2020 2020 6578 7465 726e 616c 5f61        external_a
+0002fbd0: 7263 6869 7665 203d 2073 656c 4265 7374  rchive = selBest
+0002fbe0: 286c 6973 7428 706f 7075 6c61 7469 6f6e  (list(population
+0002fbf0: 292c 2073 697a 6520 2a20 7365 6c66 2e6e  ), size * self.n
+0002fc00: 5f70 6f70 290a 2020 2020 2020 2020 656c  _pop).        el
+0002fc10: 6966 2073 656c 662e 6578 7465 726e 616c  if self.external
+0002fc20: 5f61 7263 6869 7665 203d 3d20 2749 6d70  _archive == 'Imp
+0002fc30: 6f72 7461 6e74 4665 6174 7572 6573 2720  ortantFeatures' 
+0002fc40: 6f72 2073 656c 662e 7365 6d61 6e74 6963  or self.semantic
+0002fc50: 5f72 6570 6169 7220 3e20 303a 0a20 2020  _repair > 0:.   
+0002fc60: 2020 2020 2020 2020 2069 6620 6578 7465           if exte
+0002fc70: 726e 616c 5f61 7263 6869 7665 2069 7320  rnal_archive is 
+0002fc80: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0002fc90: 2020 2020 2020 6578 7465 726e 616c 5f61        external_a
+0002fca0: 7263 6869 7665 203d 205b 5d0a 2020 2020  rchive = [].    
+0002fcb0: 2020 2020 2020 2020 666f 7220 6720 696e          for g in
+0002fcc0: 2072 616e 6765 2873 656c 662e 6765 6e65   range(self.gene
+0002fcd0: 5f6e 756d 293a 0a20 2020 2020 2020 2020  _num):.         
+0002fce0: 2020 2020 2020 2069 6620 6c65 6e28 6578         if len(ex
+0002fcf0: 7465 726e 616c 5f61 7263 6869 7665 2920  ternal_archive) 
+0002fd00: 3d3d 2073 656c 662e 6765 6e65 5f6e 756d  == self.gene_num
+0002fd10: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002fd20: 2020 2020 2020 7365 6c65 6374 6564 5f66        selected_f
+0002fd30: 6561 7475 7265 7320 3d20 7b0a 2020 2020  eatures = {.    
+0002fd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fd50: 2020 2020 7374 7228 6f5b 315d 293a 206f      str(o[1]): o
+0002fd60: 2066 6f72 206f 2069 6e20 6578 7465 726e   for o in extern
+0002fd70: 616c 5f61 7263 6869 7665 5b67 5d0a 2020  al_archive[g].  
+0002fd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fd90: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
+0002fda0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0002fdb0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0002fdc0: 6c65 6374 6564 5f66 6561 7475 7265 7320  lected_features 
+0002fdd0: 3d20 7b7d 0a20 2020 2020 2020 2020 2020  = {}.           
+0002fde0: 2020 2020 2066 6f72 2070 2069 6e20 706f       for p in po
+0002fdf0: 7075 6c61 7469 6f6e 3a0a 2020 2020 2020  pulation:.      
+0002fe00: 2020 2020 2020 2020 2020 2020 2020 7363                sc
+0002fe10: 6f72 6520 3d20 702e 6669 746e 6573 732e  ore = p.fitness.
+0002fe20: 7776 616c 7565 735b 305d 202a 2070 2e63  wvalues[0] * p.c
+0002fe30: 6f65 665b 675d 0a20 2020 2020 2020 2020  oef[g].         
+0002fe40: 2020 2020 2020 2020 2020 2067 656e 655f             gene_
+0002fe50: 7374 7220 3d20 7374 7228 702e 6765 6e65  str = str(p.gene
+0002fe60: 5b67 5d29 0a20 2020 2020 2020 2020 2020  [g]).           
+0002fe70: 2020 2020 2020 2020 2069 6620 6765 6e65           if gene
+0002fe80: 5f73 7472 2069 6e20 7365 6c65 6374 6564  _str in selected
+0002fe90: 5f66 6561 7475 7265 733a 0a20 2020 2020  _features:.     
+0002fea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002feb0: 2020 2069 6620 7363 6f72 6520 3e20 7365     if score > se
+0002fec0: 6c65 6374 6564 5f66 6561 7475 7265 735b  lected_features[
+0002fed0: 6765 6e65 5f73 7472 5d5b 305d 3a0a 2020  gene_str][0]:.  
+0002fee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fef0: 2020 2020 2020 2020 2020 7365 6c65 6374            select
+0002ff00: 6564 5f66 6561 7475 7265 735b 6765 6e65  ed_features[gene
+0002ff10: 5f73 7472 5d20 3d20 2873 636f 7265 2c20  _str] = (score, 
+0002ff20: 702e 6765 6e65 5b67 5d29 0a20 2020 2020  p.gene[g]).     
+0002ff30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ff40: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0002ff50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ff60: 2020 2020 2070 6173 730a 2020 2020 2020       pass.      
+0002ff70: 2020 2020 2020 2020 2020 2020 2020 656c                el
+0002ff80: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0002ff90: 2020 2020 2020 2020 2020 2020 7365 6c65              sele
+0002ffa0: 6374 6564 5f66 6561 7475 7265 735b 6765  cted_features[ge
+0002ffb0: 6e65 5f73 7472 5d20 3d20 2873 636f 7265  ne_str] = (score
+0002ffc0: 2c20 702e 6765 6e65 5b67 5d29 0a20 2020  , p.gene[g]).   
+0002ffd0: 2020 2020 2020 2020 2020 2020 2066 696e               fin
+0002ffe0: 616c 5f61 7263 6869 7665 203d 206c 6973  al_archive = lis
+0002fff0: 7428 736f 7274 6564 2873 656c 6563 7465  t(sorted(selecte
+00030000: 645f 6665 6174 7572 6573 2e76 616c 7565  d_features.value
+00030010: 7328 292c 206b 6579 3d6c 616d 6264 6120  s(), key=lambda 
+00030020: 783a 2078 5b30 5d2c 2072 6576 6572 7365  x: x[0], reverse
+00030030: 3d54 7275 6529 5b3a 7365 6c66 2e6e 5f70  =True)[:self.n_p
+00030040: 6f70 5d29 0a20 2020 2020 2020 2020 2020  op]).           
+00030050: 2020 2020 2069 6620 6c65 6e28 6578 7465       if len(exte
+00030060: 726e 616c 5f61 7263 6869 7665 2920 3d3d  rnal_archive) ==
+00030070: 2073 656c 662e 6765 6e65 5f6e 756d 3a0a   self.gene_num:.
+00030080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030090: 2020 2020 6578 7465 726e 616c 5f61 7263      external_arc
+000300a0: 6869 7665 5b67 5d20 3d20 6669 6e61 6c5f  hive[g] = final_
+000300b0: 6172 6368 6976 650a 2020 2020 2020 2020  archive.        
+000300c0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+000300d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000300e0: 2020 6578 7465 726e 616c 5f61 7263 6869    external_archi
+000300f0: 7665 2e61 7070 656e 6428 6669 6e61 6c5f  ve.append(final_
+00030100: 6172 6368 6976 6529 0a20 2020 2020 2020  archive).       
+00030110: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00030120: 2020 2065 7874 6572 6e61 6c5f 6172 6368     external_arch
+00030130: 6976 6520 3d20 4e6f 6e65 0a20 2020 2020  ive = None.     
+00030140: 2020 2072 6574 7572 6e20 6578 7465 726e     return extern
+00030150: 616c 5f61 7263 6869 7665 0a0a 2020 2020  al_archive..    
+00030160: 6465 6620 6f66 6673 7072 696e 675f 6765  def offspring_ge
+00030170: 6e65 7261 7469 6f6e 2873 656c 662c 2074  neration(self, t
+00030180: 6f6f 6c62 6f78 2c20 7061 7265 6e74 2c20  oolbox, parent, 
+00030190: 636f 756e 742c 2065 7874 6572 6e61 6c5f  count, external_
+000301a0: 6172 6368 6976 653d 4e6f 6e65 293a 0a20  archive=None):. 
+000301b0: 2020 2020 2020 2023 2047 656e 6572 6174         # Generat
+000301c0: 6520 6f66 6673 7072 696e 6720 6261 7365  e offspring base
+000301d0: 6420 6d75 6c74 6970 6c65 2070 6172 656e  d multiple paren
+000301e0: 7473 0a20 2020 2020 2020 2069 6620 7365  ts.        if se
+000301f0: 6c66 2e65 7874 6572 6e61 6c5f 6172 6368  lf.external_arch
+00030200: 6976 6520 3d3d 2046 616c 7365 206f 7220  ive == False or 
+00030210: 7365 6c66 2e65 7874 6572 6e61 6c5f 6172  self.external_ar
+00030220: 6368 6976 6520 6973 204e 6f6e 653a 0a20  chive is None:. 
+00030230: 2020 2020 2020 2020 2020 206f 6666 7370             offsp
+00030240: 7269 6e67 203d 2074 6f6f 6c62 6f78 2e73  ring = toolbox.s
+00030250: 656c 6563 7428 7061 7265 6e74 2c20 636f  elect(parent, co
+00030260: 756e 7429 0a20 2020 2020 2020 2065 6c69  unt).        eli
+00030270: 6620 7365 6c66 2e65 7874 6572 6e61 6c5f  f self.external_
+00030280: 6172 6368 6976 6520 3d3d 2027 496d 706f  archive == 'Impo
+00030290: 7274 616e 7446 6561 7475 7265 7327 3a0a  rtantFeatures':.
+000302a0: 2020 2020 2020 2020 2020 2020 6f66 6673              offs
+000302b0: 7072 696e 6720 3d20 746f 6f6c 626f 782e  pring = toolbox.
+000302c0: 7365 6c65 6374 2870 6172 656e 742c 2031  select(parent, 1
+000302d0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+000302e0: 2020 2020 2020 2020 2020 2020 2320 7265              # re
+000302f0: 7573 6520 6578 7465 726e 616c 2061 7263  use external arc
+00030300: 6869 7665 2074 6f20 6669 7820 616e 2069  hive to fix an i
+00030310: 6e64 6976 6964 7561 6c0a 2020 2020 2020  ndividual.      
+00030320: 2020 2020 2020 2320 646f 6e27 7420 7365        # don't se
+00030330: 6c65 6374 2065 7874 6572 6e61 6c20 6172  lect external ar
+00030340: 6368 6976 6520 696e 6465 7065 6e64 656e  chive independen
+00030350: 746c 792c 2062 6563 6175 7365 2065 7874  tly, because ext
+00030360: 6572 6e61 6c20 6172 6368 6976 6520 6d69  ernal archive mi
+00030370: 6768 7420 6265 2076 6572 7920 736d 616c  ght be very smal
+00030380: 6c0a 2020 2020 2020 2020 2020 2020 6f66  l.            of
+00030390: 6673 7072 696e 6720 3d20 746f 6f6c 626f  fspring = toolbo
+000303a0: 782e 7365 6c65 6374 2870 6172 656e 7420  x.select(parent 
+000303b0: 2b20 6578 7465 726e 616c 5f61 7263 6869  + external_archi
+000303c0: 7665 2c20 636f 756e 7429 0a20 2020 2020  ve, count).     
+000303d0: 2020 2023 2064 6f6e 2774 206d 6f64 6966     # don't modif
+000303e0: 7920 7061 7265 6e74 2069 6e64 6976 6964  y parent individ
+000303f0: 7561 6c73 0a20 2020 2020 2020 206f 6666  uals.        off
+00030400: 7370 7269 6e67 203d 205b 6566 6669 6369  spring = [effici
+00030410: 656e 745f 6465 6570 636f 7079 286f 2920  ent_deepcopy(o) 
+00030420: 666f 7220 6f20 696e 206f 6666 7370 7269  for o in offspri
+00030430: 6e67 5d0a 2020 2020 2020 2020 6966 2073  ng].        if s
+00030440: 656c 662e 6465 6c65 7465 5f6c 6f77 5f73  elf.delete_low_s
+00030450: 696d 696c 6172 6974 793a 0a20 2020 2020  imilarity:.     
+00030460: 2020 2020 2020 2066 6f72 206f 2069 6e20         for o in 
+00030470: 6f66 6673 7072 696e 673a 0a20 2020 2020  offspring:.     
+00030480: 2020 2020 2020 2020 2020 206f 2e63 6f72             o.cor
+00030490: 7265 6c61 7469 6f6e 5f72 6573 756c 7473  relation_results
+000304a0: 2c20 6f2e 636f 6566 203d 206f 2e63 6f65  , o.coef = o.coe
+000304b0: 662c 206f 2e63 6f72 7265 6c61 7469 6f6e  f, o.correlation
+000304c0: 5f72 6573 756c 7473 0a20 2020 2020 2020  _results.       
+000304d0: 2061 7373 6572 7420 6162 7328 6e70 2e73   assert abs(np.s
+000304e0: 756d 286f 6666 7370 7269 6e67 5b30 5d2e  um(offspring[0].
+000304f0: 636f 6566 2920 2d20 3129 203c 2031 652d  coef) - 1) < 1e-
+00030500: 350a 2020 2020 2020 2020 2320 6361 6c63  5.        # calc
+00030510: 756c 6174 6520 6275 696c 6469 6e67 2062  ulate building b
+00030520: 6c6f 636b 2072 656c 6174 6976 6520 696d  lock relative im
+00030530: 706f 7274 616e 6365 0a20 2020 2020 2020  portance.       
+00030540: 2023 2069 6620 7365 6c66 2e73 6861 7265   # if self.share
+00030550: 645f 6564 613a 0a20 2020 2020 2020 2023  d_eda:.        #
+00030560: 2020 2020 2062 7569 6c64 696e 675f 626c       building_bl
+00030570: 6f63 6b5f 696d 706f 7274 616e 6365 203d  ock_importance =
+00030580: 205b 5d0a 2020 2020 2020 2020 2320 2020   [].        #   
+00030590: 2020 666f 7220 6720 696e 2072 616e 6765    for g in range
+000305a0: 2873 656c 662e 6765 6e65 5f6e 756d 293a  (self.gene_num):
+000305b0: 0a20 2020 2020 2020 2023 2020 2020 2020  .        #      
+000305c0: 2020 2062 7569 6c64 696e 675f 626c 6f63     building_bloc
+000305d0: 6b5f 696d 706f 7274 616e 6365 2e61 7070  k_importance.app
+000305e0: 656e 6428 7365 6c66 2e74 6572 6d69 6e61  end(self.termina
+000305f0: 6c5f 7072 6f62 5f63 6f75 6e74 5b66 2741  l_prob_count[f'A
+00030600: 5247 7b67 202b 2073 656c 662e 582e 7368  RG{g + self.X.sh
+00030610: 6170 655b 315d 202d 2031 7d27 5d29 0a20  ape[1] - 1}']). 
+00030620: 2020 2020 2020 2023 2020 2020 2062 7569         #     bui
+00030630: 6c64 696e 675f 626c 6f63 6b5f 696d 706f  lding_block_impo
+00030640: 7274 616e 6365 203d 206e 702e 6172 7261  rtance = np.arra
+00030650: 7928 6275 696c 6469 6e67 5f62 6c6f 636b  y(building_block
+00030660: 5f69 6d70 6f72 7461 6e63 6529 0a20 2020  _importance).   
+00030670: 2020 2020 2023 2020 2020 2062 7569 6c64       #     build
+00030680: 696e 675f 626c 6f63 6b5f 696d 706f 7274  ing_block_import
+00030690: 616e 6365 203d 2062 7569 6c64 696e 675f  ance = building_
+000306a0: 626c 6f63 6b5f 696d 706f 7274 616e 6365  block_importance
+000306b0: 202f 206e 702e 7375 6d28 6275 696c 6469   / np.sum(buildi
+000306c0: 6e67 5f62 6c6f 636b 5f69 6d70 6f72 7461  ng_block_importa
+000306d0: 6e63 6529 0a0a 2020 2020 2020 2020 616c  nce)..        al
+000306e0: 6c5f 6861 7368 203d 2073 6574 2829 0a20  l_hash = set(). 
+000306f0: 2020 2020 2020 2066 6f72 2067 2069 6e20         for g in 
+00030700: 7261 6e67 6528 7365 6c66 2e67 656e 655f  range(self.gene_
+00030710: 6e75 6d29 3a0a 2020 2020 2020 2020 2020  num):.          
+00030720: 2020 6e65 6564 5f74 6f5f 6368 616e 6765    need_to_change
+00030730: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
+00030740: 2020 2020 2069 6620 6f66 6673 7072 696e       if offsprin
+00030750: 675b 305d 2e68 6173 685f 7265 7375 6c74  g[0].hash_result
+00030760: 5b67 5d20 696e 2061 6c6c 5f68 6173 683a  [g] in all_hash:
+00030770: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00030780: 2023 2069 6620 6861 7368 2076 616c 7565   # if hash value
+00030790: 2072 652d 6170 7065 6172 2c20 7468 656e   re-appear, then
+000307a0: 2063 6861 6e67 6520 6974 2077 6974 6820   change it with 
+000307b0: 736f 6d65 7468 696e 670a 2020 2020 2020  something.      
+000307c0: 2020 2020 2020 2020 2020 6e65 6564 5f74            need_t
+000307d0: 6f5f 6368 616e 6765 203d 2054 7275 650a  o_change = True.
+000307e0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+000307f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00030800: 2020 616c 6c5f 6861 7368 2e61 6464 286f    all_hash.add(o
+00030810: 6666 7370 7269 6e67 5b30 5d2e 6861 7368  ffspring[0].hash
+00030820: 5f72 6573 756c 745b 675d 290a 2020 2020  _result[g]).    
+00030830: 2020 2020 2020 2020 2320 7265 706c 6163          # replac
+00030840: 6520 6e65 676c 6967 6962 6c65 2066 6561  e negligible fea
+00030850: 7475 7265 7320 6279 206f 7468 6572 2066  tures by other f
+00030860: 6561 7475 7265 730a 2020 2020 2020 2020  eatures.        
+00030870: 2020 2020 7374 6172 745f 706f 7369 7469      start_positi
+00030880: 6f6e 203d 2030 0a20 2020 2020 2020 2020  on = 0.         
+00030890: 2020 2069 6420 3d20 6e70 2e61 7267 6d61     id = np.argma
+000308a0: 7828 5b6f 2e63 6f65 665b 675d 2066 6f72  x([o.coef[g] for
+000308b0: 206f 2069 6e20 6f66 6673 7072 696e 675b   o in offspring[
+000308c0: 7374 6172 745f 706f 7369 7469 6f6e 3a5d  start_position:]
+000308d0: 5d29 0a20 2020 2020 2020 2020 2020 2023  ]).            #
+000308e0: 206d 7573 7420 636f 6e73 6964 6572 2074   must consider t
+000308f0: 6865 2073 7461 7274 2070 6f73 6974 696f  he start positio
+00030900: 6e2c 206f 7468 6572 7769 7365 2074 6865  n, otherwise the
+00030910: 7265 2077 696c 6c20 6265 2061 6e20 6572  re will be an er
+00030920: 726f 720a 2020 2020 2020 2020 2020 2020  ror.            
+00030930: 6964 202b 3d20 7374 6172 745f 706f 7369  id += start_posi
+00030940: 7469 6f6e 0a20 2020 2020 2020 2020 2020  tion.           
+00030950: 2072 6174 696f 203d 2073 656c 662e 6972   ratio = self.ir
+00030960: 7265 6c65 7661 6e74 5f66 6561 7475 7265  relevant_feature
+00030970: 5f72 6174 696f 0a20 2020 2020 2020 2020  _ratio.         
+00030980: 2020 2069 6620 7261 7469 6f20 3d3d 2027     if ratio == '
+00030990: 4479 6e61 6d69 6327 3a0a 2020 2020 2020  Dynamic':.      
+000309a0: 2020 2020 2020 2020 2020 7261 7469 6f20            ratio 
+000309b0: 3d20 302e 3120 2a20 6f66 6673 7072 696e  = 0.1 * offsprin
+000309c0: 675b 6964 5d2e 636f 6566 5b67 5d0a 0a20  g[id].coef[g].. 
+000309d0: 2020 2020 2020 2020 2020 2064 6566 2069             def i
+000309e0: 7272 656c 6576 616e 745f 6372 6974 6572  rrelevant_criter
+000309f0: 696f 6e28 293a 0a20 2020 2020 2020 2020  ion():.         
+00030a00: 2020 2020 2020 2023 2069 6620 7365 6c66         # if self
+00030a10: 2e6d 7574 6174 696f 6e5f 7363 6865 6d65  .mutation_scheme
+00030a20: 2069 6e20 6564 615f 6f70 6572 6174 6f72   in eda_operator
+00030a30: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+00030a40: 2020 2023 2020 2020 2069 6620 6f66 6673     #     if offs
+00030a50: 7072 696e 675b 305d 2e63 6f65 665b 675d  pring[0].coef[g]
+00030a60: 203c 2072 6174 696f 206f 7220 6e70 2e69   < ratio or np.i
+00030a70: 736e 616e 286f 6666 7370 7269 6e67 5b30  snan(offspring[0
+00030a80: 5d2e 636f 6566 5b67 5d29 3a0a 2020 2020  ].coef[g]):.    
+00030a90: 2020 2020 2020 2020 2020 2020 2320 2020              #   
+00030aa0: 2020 2020 2020 6966 2073 656c 662e 7368        if self.sh
+00030ab0: 6172 6564 5f65 6461 2061 6e64 2062 7569  ared_eda and bui
+00030ac0: 6c64 696e 675f 626c 6f63 6b5f 696d 706f  lding_block_impo
+00030ad0: 7274 616e 6365 5b67 5d20 3e20 7261 7469  rtance[g] > rati
+00030ae0: 6f3a 0a20 2020 2020 2020 2020 2020 2020  o:.             
+00030af0: 2020 2023 2020 2020 2020 2020 2020 2020     #            
+00030b00: 2023 2069 6d70 6f72 7461 6e74 2062 7569   # important bui
+00030b10: 6c64 696e 6720 626c 6f63 6b0a 2020 2020  lding block.    
+00030b20: 2020 2020 2020 2020 2020 2020 2320 2020              #   
+00030b30: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00030b40: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
+00030b50: 2020 2020 2020 2023 2020 2020 2020 2020         #        
+00030b60: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00030b70: 2020 2020 2020 2023 2020 2020 2020 2020         #        
+00030b80: 2020 2020 2023 2073 6d61 6c6c 6572 2074       # smaller t
+00030b90: 6861 6e20 7468 7265 7368 6f6c 640a 2020  han threshold.  
+00030ba0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00030bb0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00030bc0: 726e 2054 7275 650a 2020 2020 2020 2020  rn True.        
+00030bd0: 2020 2020 2020 2020 2320 2020 2020 656c          #     el
+00030be0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00030bf0: 2020 2020 2320 2020 2020 2020 2020 2320      #         # 
+00030c00: 6c61 7267 6572 2074 6861 6e20 7468 7265  larger than thre
+00030c10: 7368 6f6c 640a 2020 2020 2020 2020 2020  shold.          
+00030c20: 2020 2020 2020 2320 2020 2020 2020 2020        #         
+00030c30: 7265 7475 726e 2046 616c 7365 0a20 2020  return False.   
+00030c40: 2020 2020 2020 2020 2020 2020 2023 2065               # e
+00030c50: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00030c60: 2020 2020 2069 6620 6f66 6673 7072 696e       if offsprin
+00030c70: 675b 305d 2e63 6f65 665b 675d 203c 2072  g[0].coef[g] < r
+00030c80: 6174 696f 206f 7220 6e70 2e69 736e 616e  atio or np.isnan
+00030c90: 286f 6666 7370 7269 6e67 5b30 5d2e 636f  (offspring[0].co
+00030ca0: 6566 5b67 5d29 3a0a 2020 2020 2020 2020  ef[g]):.        
+00030cb0: 2020 2020 2020 2020 2020 2020 2320 736d              # sm
+00030cc0: 616c 6c65 7220 7468 616e 2074 6872 6573  aller than thres
+00030cd0: 686f 6c64 0a20 2020 2020 2020 2020 2020  hold.           
+00030ce0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00030cf0: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
+00030d00: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00030d10: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00030d20: 206c 6172 6765 7220 7468 616e 2074 6872   larger than thr
+00030d30: 6573 686f 6c64 0a20 2020 2020 2020 2020  eshold.         
+00030d40: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00030d50: 6e20 4661 6c73 650a 0a20 2020 2020 2020  n False..       
+00030d60: 2020 2020 2023 206f 6666 7370 7269 6e67       # offspring
+00030d70: 5b69 645d 2e63 6f65 665b 675d 3e6f 6666  [id].coef[g]>off
+00030d80: 7370 7269 6e67 5b30 5d2e 636f 6566 5b67  spring[0].coef[g
+00030d90: 5d0a 2020 2020 2020 2020 2020 2020 6966  ].            if
+00030da0: 2028 7365 6c66 2e64 656c 6574 655f 6972   (self.delete_ir
+00030db0: 7265 6c65 7661 6e74 2061 6e64 2069 7272  relevant and irr
+00030dc0: 656c 6576 616e 745f 6372 6974 6572 696f  elevant_criterio
+00030dd0: 6e28 2929 206f 7220 2873 656c 662e 6465  n()) or (self.de
+00030de0: 6c65 7465 5f72 6564 756e 6461 6e74 2061  lete_redundant a
+00030df0: 6e64 206e 6565 645f 746f 5f63 6861 6e67  nd need_to_chang
+00030e00: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+00030e10: 2020 2020 6966 2073 656c 662e 6578 7465      if self.exte
+00030e20: 726e 616c 5f61 7263 6869 7665 203d 3d20  rnal_archive == 
+00030e30: 2749 6d70 6f72 7461 6e74 4665 6174 7572  'ImportantFeatur
+00030e40: 6573 273a 0a20 2020 2020 2020 2020 2020  es':.           
+00030e50: 2020 2020 2020 2020 2023 2066 6561 7475           # featu
+00030e60: 7265 7320 7261 7468 6572 2074 6861 6e20  res rather than 
+00030e70: 696e 6469 7669 6475 616c 7320 696e 2061  individuals in a
+00030e80: 6e20 6172 6368 6976 652c 0a20 2020 2020  n archive,.     
+00030e90: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00030ea0: 2074 6875 7320 7261 6e64 6f6d 6c79 2073   thus randomly s
+00030eb0: 656c 6563 7420 736f 6d65 2070 6f74 656e  elect some poten
+00030ec0: 7469 616c 2075 7365 6675 6c20 6665 6174  tial useful feat
+00030ed0: 7572 6573 0a20 2020 2020 2020 2020 2020  ures.           
+00030ee0: 2020 2020 2020 2020 2063 616e 6469 6461           candida
+00030ef0: 7465 7320 3d20 7365 6c52 616e 646f 6d28  tes = selRandom(
+00030f00: 6578 7465 726e 616c 5f61 7263 6869 7665  external_archive
+00030f10: 5b67 5d2c 2063 6f75 6e74 290a 2020 2020  [g], count).    
+00030f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030f30: 6f66 6673 7072 696e 675b 305d 2e67 656e  offspring[0].gen
+00030f40: 655b 675d 203d 2063 616e 6469 6461 7465  e[g] = candidate
+00030f50: 735b 6e70 2e61 7267 6d61 7828 5b6f 5b30  s[np.argmax([o[0
+00030f60: 5d20 666f 7220 6f20 696e 2063 616e 6469  ] for o in candi
+00030f70: 6461 7465 735d 295d 5b31 5d0a 2020 2020  dates])][1].    
+00030f80: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00030f90: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00030fa0: 2020 2020 2020 6f66 6673 7072 696e 675b        offspring[
+00030fb0: 305d 2e63 6f65 665b 675d 203d 206f 6666  0].coef[g] = off
+00030fc0: 7370 7269 6e67 5b69 645d 2e63 6f65 665b  spring[id].coef[
+00030fd0: 675d 0a20 2020 2020 2020 2020 2020 2020  g].             
+00030fe0: 2020 2020 2020 206f 6666 7370 7269 6e67         offspring
+00030ff0: 5b30 5d2e 6765 6e65 5b67 5d20 3d20 6f66  [0].gene[g] = of
+00031000: 6673 7072 696e 675b 6964 5d2e 6765 6e65  fspring[id].gene
+00031010: 5b67 5d0a 2020 2020 2020 2020 6966 2073  [g].        if s
+00031020: 656c 662e 6465 6c65 7465 5f6c 6f77 5f73  elf.delete_low_s
+00031030: 696d 696c 6172 6974 793a 0a20 2020 2020  imilarity:.     
+00031040: 2020 2020 2020 2023 2072 6573 746f 7265         # restore
+00031050: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00031060: 206f 2069 6e20 6f66 6673 7072 696e 673a   o in offspring:
+00031070: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00031080: 206f 2e63 6f72 7265 6c61 7469 6f6e 5f72   o.correlation_r
+00031090: 6573 756c 7473 2c20 6f2e 636f 6566 203d  esults, o.coef =
+000310a0: 206f 2e63 6f65 662c 206f 2e63 6f72 7265   o.coef, o.corre
+000310b0: 6c61 7469 6f6e 5f72 6573 756c 7473 0a20  lation_results. 
+000310c0: 2020 2020 2020 2072 6574 7572 6e20 6f66         return of
+000310d0: 6673 7072 696e 670a 0a20 2020 2064 6566  fspring..    def
+000310e0: 206f 6666 7370 7269 6e67 5f73 656c 6563   offspring_selec
+000310f0: 7469 6f6e 5f6d 6170 5f65 6c69 7465 7328  tion_map_elites(
+00031100: 7365 6c66 2c20 7061 7265 6e74 2c20 7365  self, parent, se
+00031110: 6c65 6374 696f 6e5f 6f70 6572 6174 6f72  lection_operator
+00031120: 2c20 656c 6974 655f 6d61 703d 4e6f 6e65  , elite_map=None
+00031130: 293a 0a20 2020 2020 2020 2069 6620 7365  ):.        if se
+00031140: 6c65 6374 696f 6e5f 6f70 6572 6174 6f72  lection_operator
+00031150: 2e73 7461 7274 7377 6974 6828 274d 4150  .startswith('MAP
+00031160: 2d45 6c69 7465 2729 2061 6e64 206c 656e  -Elite') and len
+00031170: 2865 6c69 7465 5f6d 6170 2920 3e20 303a  (elite_map) > 0:
+00031180: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
+00031190: 656e 7420 3d20 6c69 7374 2865 6c69 7465  ent = list(elite
+000311a0: 5f6d 6170 2e76 616c 7565 7328 2929 0a0a  _map.values())..
+000311b0: 2020 2020 2020 2020 6966 2073 656c 6563          if selec
+000311c0: 7469 6f6e 5f6f 7065 7261 746f 7220 3d3d  tion_operator ==
+000311d0: 2027 4d41 502d 456c 6974 652d 4c65 7869   'MAP-Elite-Lexi
+000311e0: 6361 7365 273a 0a20 2020 2020 2020 2020  case':.         
+000311f0: 2020 206f 6666 7370 7269 6e67 203d 2073     offspring = s
+00031200: 656c 4175 746f 6d61 7469 6345 7073 696c  elAutomaticEpsil
+00031210: 6f6e 4c65 7869 6361 7365 4661 7374 2870  onLexicaseFast(p
+00031220: 6172 656e 742c 2032 290a 2020 2020 2020  arent, 2).      
+00031230: 2020 656c 6966 2073 656c 6563 7469 6f6e    elif selection
+00031240: 5f6f 7065 7261 746f 7220 3d3d 2027 546f  _operator == 'To
+00031250: 7572 6e61 6d65 6e74 2d33 273a 0a20 2020  urnament-3':.   
+00031260: 2020 2020 2020 2020 206f 6666 7370 7269           offspri
+00031270: 6e67 203d 2073 656c 546f 7572 6e61 6d65  ng = selTourname
+00031280: 6e74 2870 6172 656e 742c 2032 2c20 746f  nt(parent, 2, to
+00031290: 7572 6e73 697a 653d 3329 0a20 2020 2020  urnsize=3).     
+000312a0: 2020 2065 6c69 6620 7365 6c65 6374 696f     elif selectio
+000312b0: 6e5f 6f70 6572 6174 6f72 203d 3d20 2754  n_operator == 'T
+000312c0: 6f75 726e 616d 656e 742d 3727 3a0a 2020  ournament-7':.  
+000312d0: 2020 2020 2020 2020 2020 6f66 6673 7072            offspr
+000312e0: 696e 6720 3d20 7365 6c54 6f75 726e 616d  ing = selTournam
+000312f0: 656e 7428 7061 7265 6e74 2c20 322c 2074  ent(parent, 2, t
+00031300: 6f75 726e 7369 7a65 3d37 290a 2020 2020  ournsize=7).    
+00031310: 2020 2020 656c 6966 2073 656c 6563 7469      elif selecti
+00031320: 6f6e 5f6f 7065 7261 746f 7220 3d3d 2027  on_operator == '
+00031330: 546f 7572 6e61 6d65 6e74 2d31 3527 3a0a  Tournament-15':.
+00031340: 2020 2020 2020 2020 2020 2020 6f66 6673              offs
+00031350: 7072 696e 6720 3d20 7365 6c54 6f75 726e  pring = selTourn
+00031360: 616d 656e 7428 7061 7265 6e74 2c20 322c  ament(parent, 2,
+00031370: 2074 6f75 726e 7369 7a65 3d31 3529 0a20   tournsize=15). 
+00031380: 2020 2020 2020 2065 6c69 6620 7365 6c65         elif sele
+00031390: 6374 696f 6e5f 6f70 6572 6174 6f72 203d  ction_operator =
+000313a0: 3d20 2754 6f75 726e 616d 656e 742d 3330  = 'Tournament-30
+000313b0: 273a 0a20 2020 2020 2020 2020 2020 206f  ':.            o
+000313c0: 6666 7370 7269 6e67 203d 2073 656c 546f  ffspring = selTo
+000313d0: 7572 6e61 6d65 6e74 2870 6172 656e 742c  urnament(parent,
+000313e0: 2032 2c20 746f 7572 6e73 697a 653d 3330   2, tournsize=30
+000313f0: 290a 2020 2020 2020 2020 656c 6966 2073  ).        elif s
+00031400: 656c 6563 7469 6f6e 5f6f 7065 7261 746f  election_operato
+00031410: 7220 3d3d 2027 4175 746f 6d61 7469 634c  r == 'AutomaticL
+00031420: 6578 6963 6173 6527 3a0a 2020 2020 2020  exicase':.      
+00031430: 2020 2020 2020 6f66 6673 7072 696e 6720        offspring 
+00031440: 3d20 7365 6c41 7574 6f6d 6174 6963 4570  = selAutomaticEp
+00031450: 7369 6c6f 6e4c 6578 6963 6173 6546 6173  silonLexicaseFas
+00031460: 7428 7061 7265 6e74 2c20 3229 0a20 2020  t(parent, 2).   
+00031470: 2020 2020 2065 6c69 6620 7365 6c65 6374       elif select
+00031480: 696f 6e5f 6f70 6572 6174 6f72 203d 3d20  ion_operator == 
+00031490: 274d 6178 416e 676c 6553 656c 6563 7469  'MaxAngleSelecti
+000314a0: 6f6e 273a 0a20 2020 2020 2020 2020 2020  on':.           
+000314b0: 206f 6666 7370 7269 6e67 203d 2073 656c   offspring = sel
+000314c0: 4d61 7841 6e67 6c65 5365 6c65 6374 696f  MaxAngleSelectio
+000314d0: 6e28 7061 7265 6e74 2c20 322c 2073 656c  n(parent, 2, sel
+000314e0: 662e 7929 0a20 2020 2020 2020 2065 6c69  f.y).        eli
+000314f0: 6620 7365 6c65 6374 696f 6e5f 6f70 6572  f selection_oper
+00031500: 6174 6f72 203d 3d20 2741 6e67 6c65 4472  ator == 'AngleDr
+00031510: 6976 656e 5365 6c65 6374 696f 6e27 3a0a  ivenSelection':.
+00031520: 2020 2020 2020 2020 2020 2020 6f66 6673              offs
+00031530: 7072 696e 6720 3d20 7365 6c41 6e67 6c65  pring = selAngle
+00031540: 4472 6976 656e 5365 6c65 6374 696f 6e28  DrivenSelection(
+00031550: 7061 7265 6e74 2c20 322c 2073 656c 662e  parent, 2, self.
+00031560: 7929 0a20 2020 2020 2020 2065 6c69 6620  y).        elif 
+00031570: 7365 6c66 2e73 656c 6563 7420 3d3d 2027  self.select == '
+00031580: 4d41 502d 456c 6974 652d 4b6e 6f63 6b6f  MAP-Elite-Knocko
+00031590: 7574 2d41 273a 0a20 2020 2020 2020 2020  ut-A':.         
+000315a0: 2020 206f 6666 7370 7269 6e67 203d 2073     offspring = s
+000315b0: 656c 4b6e 6f63 6b6f 7574 2870 6172 656e  elKnockout(paren
+000315c0: 742c 2032 2c20 6175 746f 5f63 6173 653d  t, 2, auto_case=
+000315d0: 5472 7565 290a 2020 2020 2020 2020 656c  True).        el
+000315e0: 6966 2073 656c 662e 7365 6c65 6374 203d  if self.select =
+000315f0: 3d20 274d 4150 2d45 6c69 7465 2d4b 6e6f  = 'MAP-Elite-Kno
+00031600: 636b 6f75 742d 5327 3a0a 2020 2020 2020  ckout-S':.      
+00031610: 2020 2020 2020 6f66 6673 7072 696e 6720        offspring 
+00031620: 3d20 7365 6c4b 6e6f 636b 6f75 7428 7061  = selKnockout(pa
+00031630: 7265 6e74 2c20 322c 2076 6572 7369 6f6e  rent, 2, version
+00031640: 3d27 5327 290a 2020 2020 2020 2020 656c  ='S').        el
+00031650: 6966 2073 656c 662e 7365 6c65 6374 203d  if self.select =
+00031660: 3d20 274d 4150 2d45 6c69 7465 2d4b 6e6f  = 'MAP-Elite-Kno
+00031670: 636b 6f75 742d 5341 273a 0a20 2020 2020  ckout-SA':.     
+00031680: 2020 2020 2020 206f 6666 7370 7269 6e67         offspring
+00031690: 203d 2073 656c 4b6e 6f63 6b6f 7574 2870   = selKnockout(p
+000316a0: 6172 656e 742c 2032 2c20 7665 7273 696f  arent, 2, versio
+000316b0: 6e3d 2753 272c 2061 7574 6f5f 6361 7365  n='S', auto_case
+000316c0: 3d54 7275 6529 0a20 2020 2020 2020 2065  =True).        e
+000316d0: 6c69 6620 7365 6c65 6374 696f 6e5f 6f70  lif selection_op
+000316e0: 6572 6174 6f72 203d 3d20 274d 4150 2d45  erator == 'MAP-E
+000316f0: 6c69 7465 2d54 6f75 726e 616d 656e 742d  lite-Tournament-
+00031700: 3327 3a0a 2020 2020 2020 2020 2020 2020  3':.            
+00031710: 6f66 6673 7072 696e 6720 3d20 7365 6c54  offspring = selT
+00031720: 6f75 726e 616d 656e 7428 7061 7265 6e74  ournament(parent
+00031730: 2c20 322c 2074 6f75 726e 7369 7a65 3d33  , 2, tournsize=3
+00031740: 290a 2020 2020 2020 2020 656c 6966 2073  ).        elif s
+00031750: 656c 6563 7469 6f6e 5f6f 7065 7261 746f  election_operato
+00031760: 7220 3d3d 2027 4d41 502d 456c 6974 652d  r == 'MAP-Elite-
+00031770: 546f 7572 6e61 6d65 6e74 2d37 273a 0a20  Tournament-7':. 
+00031780: 2020 2020 2020 2020 2020 206f 6666 7370             offsp
+00031790: 7269 6e67 203d 2073 656c 546f 7572 6e61  ring = selTourna
+000317a0: 6d65 6e74 2870 6172 656e 742c 2032 2c20  ment(parent, 2, 
+000317b0: 746f 7572 6e73 697a 653d 3729 0a20 2020  tournsize=7).   
+000317c0: 2020 2020 2065 6c69 6620 7365 6c65 6374       elif select
+000317d0: 696f 6e5f 6f70 6572 6174 6f72 203d 3d20  ion_operator == 
+000317e0: 274d 4150 2d45 6c69 7465 2d52 616e 646f  'MAP-Elite-Rando
+000317f0: 6d27 3a0a 2020 2020 2020 2020 2020 2020  m':.            
+00031800: 6f66 6673 7072 696e 6720 3d20 7365 6c52  offspring = selR
+00031810: 616e 646f 6d28 7061 7265 6e74 2c20 3229  andom(parent, 2)
+00031820: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
+00031830: 6c65 6374 696f 6e5f 6f70 6572 6174 6f72  lection_operator
+00031840: 203d 3d20 274d 4150 2d45 6c69 7465 2d52   == 'MAP-Elite-R
+00031850: 6f75 6c65 7474 6527 3a0a 2020 2020 2020  oulette':.      
+00031860: 2020 2020 2020 7061 7265 6e74 203d 206c        parent = l
+00031870: 6973 7428 6669 6c74 6572 286c 616d 6264  ist(filter(lambd
+00031880: 6120 783a 2078 2e66 6974 6e65 7373 2e77  a x: x.fitness.w
+00031890: 7661 6c75 6573 5b30 5d20 3e20 302c 2070  values[0] > 0, p
+000318a0: 6172 656e 7429 290a 2020 2020 2020 2020  arent)).        
+000318b0: 2020 2020 6f66 6673 7072 696e 6720 3d20      offspring = 
+000318c0: 7365 6c52 6f75 6c65 7474 6528 7061 7265  selRoulette(pare
+000318d0: 6e74 2c20 3229 0a20 2020 2020 2020 2020  nt, 2).         
+000318e0: 2020 2061 7373 6572 7420 6c65 6e28 6f66     assert len(of
+000318f0: 6673 7072 696e 6729 203d 3d20 320a 2020  fspring) == 2.  
+00031900: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00031910: 2020 2020 2020 2020 7261 6973 6520 4578          raise Ex
+00031920: 6365 7074 696f 6e0a 2020 2020 2020 2020  ception.        
+00031930: 7265 7475 726e 206f 6666 7370 7269 6e67  return offspring
+00031940: 0a0a 2020 2020 6465 6620 6d61 705f 656c  ..    def map_el
+00031950: 6974 655f 6765 6e65 7261 7469 6f6e 2873  ite_generation(s
+00031960: 656c 662c 2070 6f70 756c 6174 696f 6e2c  elf, population,
+00031970: 2065 6c69 7465 5f6d 6170 2c20 706f 705f   elite_map, pop_
+00031980: 706f 6f6c 293a 0a20 2020 2020 2020 2022  pool):.        "
+00031990: 2222 0a20 2020 2020 2020 203a 7061 7261  "".        :para
+000319a0: 6d20 706f 7075 6c61 7469 6f6e 3a20 5374  m population: St
+000319b0: 6f72 6520 696e 6469 7669 6475 616c 7320  ore individuals 
+000319c0: 696e 2074 6865 2063 7572 7265 6e74 2067  in the current g
+000319d0: 656e 6572 6174 696f 6e0a 2020 2020 2020  eneration.      
+000319e0: 2020 3a70 6172 616d 2065 6c69 7465 5f6d    :param elite_m
+000319f0: 6170 3a20 5374 6f72 6520 7365 6c65 6374  ap: Store select
+00031a00: 6564 2069 6e64 6976 6964 7561 6c73 0a20  ed individuals. 
+00031a10: 2020 2020 2020 203a 7061 7261 6d20 706f         :param po
+00031a20: 705f 706f 6f6c 3a20 5374 6f72 6520 6b2a  p_pool: Store k*
+00031a30: 706f 705f 7369 7a65 2069 6e64 6976 6964  pop_size individ
+00031a40: 7561 6c73 0a20 2020 2020 2020 203a 7265  uals.        :re
+00031a50: 7475 726e 3a0a 2020 2020 2020 2020 2222  turn:.        ""
+00031a60: 220a 2020 2020 2020 2020 6966 2073 656c  ".        if sel
+00031a70: 662e 7365 6c65 6374 2069 6e20 6d61 705f  f.select in map_
+00031a80: 656c 6974 655f 7365 7269 6573 3a0a 2020  elite_series:.  
+00031a90: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00031aa0: 662e 6d61 705f 656c 6974 655f 7061 7261  f.map_elite_para
+00031ab0: 6d65 7465 725b 2774 7970 6527 5d20 3d3d  meter['type'] ==
+00031ac0: 2027 4772 6964 273a 0a20 2020 2020 2020   'Grid':.       
+00031ad0: 2020 2020 2020 2020 2065 6c69 7465 5f6d           elite_m
+00031ae0: 6170 203d 2073 656c 4d41 5045 6c69 7465  ap = selMAPElite
+00031af0: 7328 706f 7075 6c61 7469 6f6e 2c20 656c  s(population, el
+00031b00: 6974 655f 6d61 702c 2073 656c 662e 6d61  ite_map, self.ma
+00031b10: 705f 656c 6974 655f 7061 7261 6d65 7465  p_elite_paramete
+00031b20: 722c 2073 656c 662e 7929 0a20 2020 2020  r, self.y).     
+00031b30: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
+00031b40: 2e6d 6170 5f65 6c69 7465 5f70 6172 616d  .map_elite_param
+00031b50: 6574 6572 5b27 7479 7065 275d 2e73 7461  eter['type'].sta
+00031b60: 7274 7377 6974 6828 2747 7269 642d 5379  rtswith('Grid-Sy
+00031b70: 6e74 6865 7469 6327 293a 0a20 2020 2020  nthetic'):.     
+00031b80: 2020 2020 2020 2020 2020 2072 6174 696f             ratio
+00031b90: 203d 2066 6c6f 6174 2873 656c 662e 6d61   = float(self.ma
+00031ba0: 705f 656c 6974 655f 7061 7261 6d65 7465  p_elite_paramete
+00031bb0: 725b 2774 7970 6527 5d2e 7265 706c 6163  r['type'].replac
+00031bc0: 6528 2747 7269 642d 5379 6e74 6865 7469  e('Grid-Syntheti
+00031bd0: 632d 272c 2027 2729 290a 2020 2020 2020  c-', '')).      
+00031be0: 2020 2020 2020 2020 2020 656c 6974 655f            elite_
+00031bf0: 6d61 7020 3d20 7365 6c4d 4150 456c 6974  map = selMAPElit
+00031c00: 6573 2870 6f70 756c 6174 696f 6e2c 2065  es(population, e
+00031c10: 6c69 7465 5f6d 6170 2c20 7365 6c66 2e6d  lite_map, self.m
+00031c20: 6170 5f65 6c69 7465 5f70 6172 616d 6574  ap_elite_paramet
+00031c30: 6572 2c20 7365 6c66 2e79 2c0a 2020 2020  er, self.y,.    
+00031c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031c60: 2020 2020 2064 6174 615f 6175 676d 656e       data_augmen
+00031c70: 7461 7469 6f6e 3d72 6174 696f 290a 2020  tation=ratio).  
+00031c80: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
+00031c90: 656c 662e 6d61 705f 656c 6974 655f 7061  elf.map_elite_pa
+00031ca0: 7261 6d65 7465 725b 2774 7970 6527 5d20  rameter['type'] 
+00031cb0: 3d3d 2027 4772 6964 2d41 7574 6f27 3a0a  == 'Grid-Auto':.
+00031cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031cd0: 656c 6974 655f 6d61 7073 203d 205b 5d0a  elite_maps = [].
+00031ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031cf0: 666f 7220 6964 2c20 7061 7261 6d65 7465  for id, paramete
+00031d00: 7273 2069 6e20 656e 756d 6572 6174 6528  rs in enumerate(
+00031d10: 5b7b 2766 6974 6e65 7373 5f72 6174 696f  [{'fitness_ratio
+00031d20: 273a 2078 2c0a 2020 2020 2020 2020 2020  ': x,.          
+00031d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031d50: 2020 2020 2020 2020 276d 6170 5f73 697a          'map_siz
+00031d60: 6527 3a20 797d 0a20 2020 2020 2020 2020  e': y}.         
+00031d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031d90: 2020 2020 2020 2020 666f 7220 7820 696e          for x in
+00031da0: 205b 302e 322c 2030 2e35 2c20 302e 385d   [0.2, 0.5, 0.8]
+00031db0: 2066 6f72 2079 2069 6e20 5b35 2c20 3130   for y in [5, 10
+00031dc0: 2c20 3135 5d5d 293a 0a20 2020 2020 2020  , 15]]):.       
+00031dd0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00031de0: 662e 6d61 705f 656c 6974 655f 7061 7261  f.map_elite_para
+00031df0: 6d65 7465 722e 7570 6461 7465 2870 6172  meter.update(par
+00031e00: 616d 6574 6572 7329 0a20 2020 2020 2020  ameters).       
+00031e10: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00031e20: 6c65 6e28 656c 6974 655f 6d61 7029 203e  len(elite_map) >
+00031e30: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+00031e40: 2020 2020 2020 2020 2020 2020 656c 6974              elit
+00031e50: 655f 6d61 7073 2e61 7070 656e 6428 7365  e_maps.append(se
+00031e60: 6c4d 4150 456c 6974 6573 2870 6f70 756c  lMAPElites(popul
+00031e70: 6174 696f 6e2c 2065 6c69 7465 5f6d 6170  ation, elite_map
+00031e80: 5b69 645d 2c20 7365 6c66 2e6d 6170 5f65  [id], self.map_e
+00031e90: 6c69 7465 5f70 6172 616d 6574 6572 2929  lite_parameter))
+00031ea0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00031eb0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00031ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031ed0: 2020 2065 6c69 7465 5f6d 6170 732e 6170     elite_maps.ap
+00031ee0: 7065 6e64 2873 656c 4d41 5045 6c69 7465  pend(selMAPElite
+00031ef0: 7328 706f 7075 6c61 7469 6f6e 2c20 7b7d  s(population, {}
+00031f00: 2c20 7365 6c66 2e6d 6170 5f65 6c69 7465  , self.map_elite
+00031f10: 5f70 6172 616d 6574 6572 2929 0a20 2020  _parameter)).   
+00031f20: 2020 2020 2020 2020 2065 6c69 6620 7365           elif se
+00031f30: 6c66 2e6d 6170 5f65 6c69 7465 5f70 6172  lf.map_elite_par
+00031f40: 616d 6574 6572 5b27 7479 7065 275d 203d  ameter['type'] =
+00031f50: 3d20 2743 6c75 7374 6572 273a 0a20 2020  = 'Cluster':.   
+00031f60: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+00031f70: 7465 5f6d 6170 2c20 706f 705f 706f 6f6c  te_map, pop_pool
+00031f80: 203d 2073 656c 4d41 5045 6c69 7465 436c   = selMAPEliteCl
+00031f90: 7573 7465 7269 6e67 2870 6f70 756c 6174  ustering(populat
+00031fa0: 696f 6e2c 2070 6f70 5f70 6f6f 6c2c 2073  ion, pop_pool, s
+00031fb0: 656c 662e 6d61 705f 656c 6974 655f 7061  elf.map_elite_pa
+00031fc0: 7261 6d65 7465 7229 0a20 2020 2020 2020  rameter).       
+00031fd0: 2020 2020 2065 6c69 6620 7365 6c66 2e6d       elif self.m
+00031fe0: 6170 5f65 6c69 7465 5f70 6172 616d 6574  ap_elite_paramet
+00031ff0: 6572 5b27 7479 7065 275d 203d 3d20 2743  er['type'] == 'C
+00032000: 6c75 7374 6572 2d45 7870 6c6f 6974 6174  luster-Exploitat
+00032010: 696f 6e27 3a0a 2020 2020 2020 2020 2020  ion':.          
+00032020: 2020 2020 2020 7365 6c66 2e6d 6170 5f65        self.map_e
+00032030: 6c69 7465 5f70 6172 616d 6574 6572 5b27  lite_parameter['
+00032040: 6669 746e 6573 735f 7261 7469 6f27 5d20  fitness_ratio'] 
+00032050: 3d20 6e70 2e63 6c69 7028 302c 2030 2e30  = np.clip(0, 0.0
+00032060: 352c 2030 2e39 3529 0a20 2020 2020 2020  5, 0.95).       
+00032070: 2020 2020 2020 2020 2065 6c69 7465 5f6d           elite_m
+00032080: 6170 2c20 706f 705f 706f 6f6c 203d 2073  ap, pop_pool = s
+00032090: 656c 4d41 5045 6c69 7465 436c 7573 7465  elMAPEliteCluste
+000320a0: 7269 6e67 2870 6f70 756c 6174 696f 6e2c  ring(population,
+000320b0: 2070 6f70 5f70 6f6f 6c2c 2073 656c 662e   pop_pool, self.
+000320c0: 6d61 705f 656c 6974 655f 7061 7261 6d65  map_elite_parame
+000320d0: 7465 7229 0a20 2020 2020 2020 2020 2020  ter).           
+000320e0: 2065 6c69 6620 7365 6c66 2e6d 6170 5f65   elif self.map_e
+000320f0: 6c69 7465 5f70 6172 616d 6574 6572 5b27  lite_parameter['
+00032100: 7479 7065 275d 203d 3d20 2743 6c75 7374  type'] == 'Clust
+00032110: 6572 2d45 7870 6c6f 7261 7469 6f6e 273a  er-Exploration':
+00032120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00032130: 2073 656c 662e 6d61 705f 656c 6974 655f   self.map_elite_
+00032140: 7061 7261 6d65 7465 725b 2766 6974 6e65  parameter['fitne
+00032150: 7373 5f72 6174 696f 275d 203d 206e 702e  ss_ratio'] = np.
+00032160: 636c 6970 2831 2c20 302e 3035 2c20 302e  clip(1, 0.05, 0.
+00032170: 3935 290a 2020 2020 2020 2020 2020 2020  95).            
+00032180: 2020 2020 656c 6974 655f 6d61 702c 2070      elite_map, p
+00032190: 6f70 5f70 6f6f 6c20 3d20 7365 6c4d 4150  op_pool = selMAP
+000321a0: 456c 6974 6543 6c75 7374 6572 696e 6728  EliteClustering(
+000321b0: 706f 7075 6c61 7469 6f6e 2c20 706f 705f  population, pop_
+000321c0: 706f 6f6c 2c20 7365 6c66 2e6d 6170 5f65  pool, self.map_e
+000321d0: 6c69 7465 5f70 6172 616d 6574 6572 290a  lite_parameter).
+000321e0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+000321f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00032200: 2020 7261 6973 6520 4578 6365 7074 696f    raise Exceptio
+00032210: 6e0a 2020 2020 2020 2020 2020 2020 6966  n.            if
+00032220: 2073 656c 662e 656e 7365 6d62 6c65 5f73   self.ensemble_s
+00032230: 656c 6563 7469 6f6e 203d 3d20 274d 4150  election == 'MAP
+00032240: 2d45 6c69 7465 273a 0a20 2020 2020 2020  -Elite':.       
+00032250: 2020 2020 2020 2020 2073 656c 662e 686f           self.ho
+00032260: 6620 3d20 6c69 7374 2865 6c69 7465 5f6d  f = list(elite_m
+00032270: 6170 2e76 616c 7565 7328 2929 0a20 2020  ap.values()).   
+00032280: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00032290: 2e65 6e73 656d 626c 655f 7365 6c65 6374  .ensemble_select
+000322a0: 696f 6e20 3d3d 2027 4861 6c66 2d4d 4150  ion == 'Half-MAP
+000322b0: 2d45 6c69 7465 273a 0a20 2020 2020 2020  -Elite':.       
+000322c0: 2020 2020 2020 2020 2073 656c 662e 686f           self.ho
+000322d0: 6620 3d20 6c69 7374 2873 6f72 7465 6428  f = list(sorted(
+000322e0: 656c 6974 655f 6d61 702e 7661 6c75 6573  elite_map.values
+000322f0: 2829 2c20 6b65 793d 6c61 6d62 6461 2078  (), key=lambda x
+00032300: 3a20 782e 6669 746e 6573 732e 7776 616c  : x.fitness.wval
+00032310: 7565 735b 305d 2c20 7265 7665 7273 653d  ues[0], reverse=
+00032320: 5472 7565 2929 205c 0a20 2020 2020 2020  True)) \.       
+00032330: 2020 2020 2020 2020 2020 2020 205b 3a6c               [:l
+00032340: 656e 2865 6c69 7465 5f6d 6170 2920 2f2f  en(elite_map) //
+00032350: 2032 5d0a 2020 2020 2020 2020 2020 2020   2].            
+00032360: 6966 2073 656c 662e 7061 7261 6d2e 6765  if self.param.ge
+00032370: 7428 2772 6563 6f72 645f 7472 6169 6e69  t('record_traini
+00032380: 6e67 5f64 6174 6127 2c20 4661 6c73 6529  ng_data', False)
+00032390: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000323a0: 2020 7365 6c66 2e65 6c69 7465 5f67 7269    self.elite_gri
+000323b0: 645f 6176 675f 6469 7665 7273 6974 795f  d_avg_diversity_
+000323c0: 6869 7374 6f72 792e 6170 7065 6e64 2873  history.append(s
+000323d0: 656c 662e 6469 7665 7273 6974 795f 6361  elf.diversity_ca
+000323e0: 6c63 756c 6174 696f 6e28 656c 6974 655f  lculation(elite_
+000323f0: 6d61 702e 7661 6c75 6573 2829 2929 0a20  map.values())). 
+00032400: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00032410: 656c 662e 656c 6974 655f 6772 6964 5f61  elf.elite_grid_a
+00032420: 7667 5f66 6974 6e65 7373 5f68 6973 746f  vg_fitness_histo
+00032430: 7279 2e61 7070 656e 6428 0a20 2020 2020  ry.append(.     
+00032440: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00032450: 702e 6d65 616e 285b 696e 642e 6669 746e  p.mean([ind.fitn
+00032460: 6573 732e 7776 616c 7565 735b 305d 2066  ess.wvalues[0] f
+00032470: 6f72 2069 6e64 2069 6e20 656c 6974 655f  or ind in elite_
+00032480: 6d61 702e 7661 6c75 6573 2829 5d29 0a20  map.values()]). 
+00032490: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+000324a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000324b0: 2069 6620 7365 6c66 2e63 7572 7265 6e74   if self.current
+000324c0: 5f67 656e 203d 3d20 7365 6c66 2e6e 5f67  _gen == self.n_g
+000324d0: 656e 3a0a 2020 2020 2020 2020 2020 2020  en:.            
+000324e0: 2020 2020 2020 2020 6461 7461 203d 206e          data = n
+000324f0: 702e 7a65 726f 7328 2873 656c 662e 6d61  p.zeros((self.ma
+00032500: 705f 656c 6974 655f 7061 7261 6d65 7465  p_elite_paramete
+00032510: 725b 276d 6170 5f73 697a 6527 5d2c 2073  r['map_size'], s
+00032520: 656c 662e 6d61 705f 656c 6974 655f 7061  elf.map_elite_pa
+00032530: 7261 6d65 7465 725b 276d 6170 5f73 697a  rameter['map_siz
+00032540: 6527 5d29 290a 2020 2020 2020 2020 2020  e'])).          
+00032550: 2020 2020 2020 2020 2020 666f 7220 6b2c            for k,
+00032560: 2076 2069 6e20 656c 6974 655f 6d61 702e   v in elite_map.
+00032570: 6974 656d 7328 293a 0a20 2020 2020 2020  items():.       
+00032580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032590: 2064 6174 615b 286b 5b30 5d20 2d20 312c   data[(k[0] - 1,
+000325a0: 206b 5b31 5d20 2d20 3129 5d20 3d20 762e   k[1] - 1)] = v.
+000325b0: 6669 746e 6573 732e 7776 616c 7565 735b  fitness.wvalues[
+000325c0: 305d 0a20 2020 2020 2020 2020 2020 2020  0].             
+000325d0: 2020 2020 2020 2073 656c 662e 6669 6e61         self.fina
+000325e0: 6c5f 656c 6974 655f 6772 6964 203d 2064  l_elite_grid = d
+000325f0: 6174 612e 746f 6c69 7374 2829 0a20 2020  ata.tolist().   
+00032600: 2020 2020 2069 6620 7365 6c66 2e65 6e73       if self.ens
+00032610: 656d 626c 655f 7365 6c65 6374 696f 6e20  emble_selection 
+00032620: 3d3d 2027 4d61 7841 6e67 6c65 5365 6c65  == 'MaxAngleSele
+00032630: 6374 696f 6e27 3a0a 2020 2020 2020 2020  ction':.        
+00032640: 2020 2020 7365 6c66 2e68 6f66 203d 2073      self.hof = s
+00032650: 656c 4d61 7841 6e67 6c65 5365 6c65 6374  elMaxAngleSelect
+00032660: 696f 6e28 706f 7075 6c61 7469 6f6e 202b  ion(population +
+00032670: 206c 6973 7428 7365 6c66 2e68 6f66 292c   list(self.hof),
+00032680: 2073 656c 662e 656e 7365 6d62 6c65 5f73   self.ensemble_s
+00032690: 697a 652c 2073 656c 662e 792c 0a20 2020  ize, self.y,.   
+000326a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000326b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000326c0: 2020 2020 2020 2020 2075 6e69 7175 653d           unique=
+000326d0: 5472 7565 290a 2020 2020 2020 2020 6966  True).        if
+000326e0: 2073 656c 662e 656e 7365 6d62 6c65 5f73   self.ensemble_s
+000326f0: 656c 6563 7469 6f6e 203d 3d20 2741 6e67  election == 'Ang
+00032700: 6c65 4472 6976 656e 5365 6c65 6374 696f  leDrivenSelectio
+00032710: 6e27 3a0a 2020 2020 2020 2020 2020 2020  n':.            
+00032720: 7365 6c66 2e68 6f66 203d 2073 656c 416e  self.hof = selAn
+00032730: 676c 6544 7269 7665 6e53 656c 6563 7469  gleDrivenSelecti
+00032740: 6f6e 2870 6f70 756c 6174 696f 6e20 2b20  on(population + 
+00032750: 6c69 7374 2873 656c 662e 686f 6629 2c20  list(self.hof), 
+00032760: 7365 6c66 2e65 6e73 656d 626c 655f 7369  self.ensemble_si
+00032770: 7a65 2c20 7365 6c66 2e79 2c0a 2020 2020  ze, self.y,.    
+00032780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000327a0: 2020 2020 2020 2020 2020 2075 6e69 7175             uniqu
+000327b0: 653d 5472 7565 290a 2020 2020 2020 2020  e=True).        
+000327c0: 7265 7475 726e 2065 6c69 7465 5f6d 6170  return elite_map
+000327d0: 2c20 706f 705f 706f 6f6c 0a0a 2020 2020  , pop_pool..    
+000327e0: 6465 6620 7361 6d70 6c65 5f6d 6f64 656c  def sample_model
+000327f0: 5f6e 616d 6528 7365 6c66 2c20 7061 7265  _name(self, pare
+00032800: 6e74 293a 0a20 2020 2020 2020 206d 6f64  nt):.        mod
+00032810: 656c 7320 3d20 7365 6c66 2e62 6173 655f  els = self.base_
+00032820: 6d6f 6465 6c5f 6c69 7374 2e73 706c 6974  model_list.split
+00032830: 2827 2c27 290a 2020 2020 2020 2020 6d6f  (',').        mo
+00032840: 6465 6c20 3d20 7261 6e64 6f6d 2e63 686f  del = random.cho
+00032850: 6963 6528 6d6f 6465 6c73 290a 2020 2020  ice(models).    
+00032860: 2020 2020 7061 7265 6e74 203d 206c 6973      parent = lis
+00032870: 7428 6669 6c74 6572 286c 616d 6264 6120  t(filter(lambda 
+00032880: 783a 2078 2e62 6173 655f 6d6f 6465 6c20  x: x.base_model 
+00032890: 3d3d 206d 6f64 656c 2c20 7061 7265 6e74  == model, parent
+000328a0: 2929 0a20 2020 2020 2020 2072 6574 7572  )).        retur
+000328b0: 6e20 7061 7265 6e74 0a0a 2020 2020 6465  n parent..    de
+000328c0: 6620 7375 7276 6976 616c 5f73 656c 6563  f survival_selec
+000328d0: 7469 6f6e 2873 656c 662c 2067 656e 2c20  tion(self, gen, 
+000328e0: 706f 7075 6c61 7469 6f6e 2c20 6f66 6673  population, offs
+000328f0: 7072 696e 6729 3a0a 2020 2020 2020 2020  pring):.        
+00032900: 2320 5573 696e 6720 4e53 4741 2d49 4920  # Using NSGA-II 
+00032910: 6f72 206f 7468 6572 206f 7065 7261 746f  or other operato
+00032920: 7273 2074 6f20 7365 6c65 6374 2070 6172  rs to select par
+00032930: 656e 7420 696e 6469 7669 6475 616c 730a  ent individuals.
+00032940: 2020 2020 2020 2020 6e73 6761 3220 3d20          nsga2 = 
+00032950: 2873 656c 662e 626c 6f61 745f 636f 6e74  (self.bloat_cont
+00032960: 726f 6c20 6973 206e 6f74 204e 6f6e 6520  rol is not None 
+00032970: 616e 6420 7365 6c66 2e62 6c6f 6174 5f63  and self.bloat_c
+00032980: 6f6e 7472 6f6c 2e67 6574 2827 4e53 4741  ontrol.get('NSGA
+00032990: 3227 2c20 4661 6c73 6529 290a 2020 2020  2', False)).    
+000329a0: 2020 2020 7370 6561 3220 3d20 2873 656c      spea2 = (sel
+000329b0: 662e 626c 6f61 745f 636f 6e74 726f 6c20  f.bloat_control 
+000329c0: 6973 206e 6f74 204e 6f6e 6520 616e 6420  is not None and 
+000329d0: 7365 6c66 2e62 6c6f 6174 5f63 6f6e 7472  self.bloat_contr
+000329e0: 6f6c 2e67 6574 2827 5350 4541 3227 2c20  ol.get('SPEA2', 
+000329f0: 4661 6c73 6529 290a 2020 2020 2020 2020  False)).        
+00032a00: 6966 2073 656c 662e 656e 7669 726f 6e6d  if self.environm
+00032a10: 656e 7461 6c5f 7365 6c65 6374 696f 6e20  ental_selection 
+00032a20: 3d3d 2027 4e53 4741 3227 3a0a 2020 2020  == 'NSGA2':.    
+00032a30: 2020 2020 2020 2020 6e73 6761 3220 3d20          nsga2 = 
+00032a40: 5472 7565 0a20 2020 2020 2020 2069 6620  True.        if 
+00032a50: 7365 6c66 2e65 6e76 6972 6f6e 6d65 6e74  self.environment
+00032a60: 616c 5f73 656c 6563 7469 6f6e 203d 3d20  al_selection == 
+00032a70: 2753 5045 4132 273a 0a20 2020 2020 2020  'SPEA2':.       
+00032a80: 2020 2020 2073 7065 6132 203d 2054 7275       spea2 = Tru
+00032a90: 650a 2020 2020 2020 2020 6966 2073 656c  e.        if sel
+00032aa0: 662e 656e 7669 726f 6e6d 656e 7461 6c5f  f.environmental_
+00032ab0: 7365 6c65 6374 696f 6e20 696e 205b 274e  selection in ['N
+00032ac0: 5347 4132 275d 2061 6e64 2073 656c 662e  SGA2'] and self.
+00032ad0: 6261 7365 5f6c 6561 726e 6572 203d 3d20  base_learner == 
+00032ae0: 2752 4454 7e4c 6967 6874 4742 4d2d 5374  'RDT~LightGBM-St
+00032af0: 756d 7027 3a0a 2020 2020 2020 2020 2020  ump':.          
+00032b00: 2020 706f 7075 6c61 7469 6f6e 5b3a 5d20    population[:] 
+00032b10: 3d20 7365 6c4e 5347 4132 286f 6666 7370  = selNSGA2(offsp
+00032b20: 7269 6e67 202b 2070 6f70 756c 6174 696f  ring + populatio
+00032b30: 6e2c 206c 656e 2870 6f70 756c 6174 696f  n, len(populatio
+00032b40: 6e29 290a 2020 2020 2020 2020 2020 2020  n)).            
+00032b50: 7365 6c66 2e68 6f66 203d 2070 6f70 756c  self.hof = popul
+00032b60: 6174 696f 6e0a 2020 2020 2020 2020 656c  ation.        el
+00032b70: 6966 2073 656c 662e 656e 7669 726f 6e6d  if self.environm
+00032b80: 656e 7461 6c5f 7365 6c65 6374 696f 6e20  ental_selection 
+00032b90: 3d3d 2027 416c 7068 612d 446f 6d69 6e61  == 'Alpha-Domina
+00032ba0: 6e63 652d 4e53 4741 3227 206f 7220 5c0a  nce-NSGA2' or \.
+00032bb0: 2020 2020 2020 2020 2020 2020 2873 656c              (sel
+00032bc0: 662e 626c 6f61 745f 636f 6e74 726f 6c20  f.bloat_control 
+00032bd0: 6973 206e 6f74 204e 6f6e 6520 616e 6420  is not None and 
+00032be0: 7365 6c66 2e62 6c6f 6174 5f63 6f6e 7472  self.bloat_contr
+00032bf0: 6f6c 2e67 6574 2827 616c 7068 615f 646f  ol.get('alpha_do
+00032c00: 6d69 6e61 6e63 655f 4e53 4741 3227 2c20  minance_NSGA2', 
+00032c10: 4661 6c73 6529 293a 0a20 2020 2020 2020  False)):.       
+00032c20: 2020 2020 2061 6c70 6861 203d 2073 656c       alpha = sel
+00032c30: 662e 626c 6f61 745f 636f 6e74 726f 6c5b  f.bloat_control[
+00032c40: 2761 6c70 6861 5f76 616c 7565 275d 0a20  'alpha_value']. 
+00032c50: 2020 2020 2020 2020 2020 206d 6178 5f73             max_s
+00032c60: 697a 6520 3d20 6d61 7828 5b6c 656e 2878  ize = max([len(x
+00032c70: 2920 666f 7220 7820 696e 206f 6666 7370  ) for x in offsp
+00032c80: 7269 6e67 202b 2070 6f70 756c 6174 696f  ring + populatio
+00032c90: 6e5d 290a 2020 2020 2020 2020 2020 2020  n]).            
+00032ca0: 666f 7220 696e 6420 696e 206f 6666 7370  for ind in offsp
+00032cb0: 7269 6e67 202b 2070 6f70 756c 6174 696f  ring + populatio
+00032cc0: 6e3a 0a20 2020 2020 2020 2020 2020 2020  n:.             
+00032cd0: 2020 2061 7373 6572 7420 616c 7068 6120     assert alpha 
+00032ce0: 3e3d 2030 2c20 6627 416c 7068 6120 5661  >= 0, f'Alpha Va
+00032cf0: 6c75 6520 7b61 6c70 6861 7d27 0a20 2020  lue {alpha}'.   
+00032d00: 2020 2020 2020 2020 2020 2020 2073 6574               set
+00032d10: 6174 7472 2869 6e64 2c20 276f 7269 6769  attr(ind, 'origi
+00032d20: 6e61 6c5f 6669 746e 6573 7327 2c20 696e  nal_fitness', in
+00032d30: 642e 6669 746e 6573 732e 7661 6c75 6573  d.fitness.values
+00032d40: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00032d50: 2020 696e 642e 6669 746e 6573 732e 7765    ind.fitness.we
+00032d60: 6967 6874 7320 3d20 282d 312c 202d 3129  ights = (-1, -1)
+00032d70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00032d80: 2069 6e64 2e66 6974 6e65 7373 2e76 616c   ind.fitness.val
+00032d90: 7565 7320 3d20 2869 6e64 2e66 6974 6e65  ues = (ind.fitne
+00032da0: 7373 2e76 616c 7565 735b 305d 2c20 6c65  ss.values[0], le
+00032db0: 6e28 696e 6429 202f 206d 6178 5f73 697a  n(ind) / max_siz
+00032dc0: 6520 2b20 616c 7068 6120 2a20 696e 642e  e + alpha * ind.
+00032dd0: 6669 746e 6573 732e 7661 6c75 6573 5b30  fitness.values[0
+00032de0: 5d29 0a20 2020 2020 2020 2020 2020 2066  ]).            f
+00032df0: 6972 7374 5f70 6172 6574 6f5f 6672 6f6e  irst_pareto_fron
+00032e00: 7420 3d20 736f 7274 4e6f 6e64 6f6d 696e  t = sortNondomin
+00032e10: 6174 6564 286f 6666 7370 7269 6e67 202b  ated(offspring +
+00032e20: 2070 6f70 756c 6174 696f 6e2c 206c 656e   population, len
+00032e30: 2870 6f70 756c 6174 696f 6e29 295b 305d  (population))[0]
+00032e40: 0a20 2020 2020 2020 2020 2020 2070 6f70  .            pop
+00032e50: 756c 6174 696f 6e5b 3a5d 203d 2073 656c  ulation[:] = sel
+00032e60: 4e53 4741 3228 6f66 6673 7072 696e 6720  NSGA2(offspring 
+00032e70: 2b20 706f 7075 6c61 7469 6f6e 2c20 6c65  + population, le
+00032e80: 6e28 706f 7075 6c61 7469 6f6e 2929 0a20  n(population)). 
+00032e90: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00032ea0: 686f 6620 3d20 5b6d 6178 2870 6f70 756c  hof = [max(popul
+00032eb0: 6174 696f 6e2c 206b 6579 3d6c 616d 6264  ation, key=lambd
+00032ec0: 6120 783a 2078 2e66 6974 6e65 7373 2e77  a x: x.fitness.w
+00032ed0: 7661 6c75 6573 5b30 5d29 5d0a 2020 2020  values[0])].    
+00032ee0: 2020 2020 2020 2020 666f 7220 696e 6420          for ind 
+00032ef0: 696e 2070 6f70 756c 6174 696f 6e3a 0a20  in population:. 
+00032f00: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00032f10: 6e64 2e66 6974 6e65 7373 2e77 6569 6768  nd.fitness.weigh
+00032f20: 7473 203d 2028 2d31 2c29 0a20 2020 2020  ts = (-1,).     
+00032f30: 2020 2020 2020 2020 2020 2069 6e64 2e66             ind.f
+00032f40: 6974 6e65 7373 2e76 616c 7565 7320 3d20  itness.values = 
+00032f50: 6765 7461 7474 7228 696e 642c 2027 6f72  getattr(ind, 'or
+00032f60: 6967 696e 616c 5f66 6974 6e65 7373 2729  iginal_fitness')
+00032f70: 0a0a 2020 2020 2020 2020 2020 2020 7468  ..            th
+00032f80: 6574 6120 3d20 6e70 2e72 6164 3264 6567  eta = np.rad2deg
+00032f90: 286e 702e 6172 6374 616e 2861 6c70 6861  (np.arctan(alpha
+00032fa0: 2929 0a20 2020 2020 2020 2020 2020 2068  )).            h
+00032fb0: 6973 746f 7269 6361 6c5f 6c61 7267 6573  istorical_larges
+00032fc0: 7420 3d20 7365 6c66 2e68 6973 746f 7269  t = self.histori
+00032fd0: 6361 6c5f 6c61 7267 6573 740a 2020 2020  cal_largest.    
+00032fe0: 2020 2020 2020 2020 6869 7374 6f72 6963          historic
+00032ff0: 616c 5f73 6d61 6c6c 6573 7420 3d20 7365  al_smallest = se
+00033000: 6c66 2e68 6973 746f 7269 6361 6c5f 736d  lf.historical_sm
+00033010: 616c 6c65 7374 0a20 2020 2020 2020 2020  allest.         
+00033020: 2020 2061 7667 5f73 697a 6520 3d20 6e70     avg_size = np
+00033030: 2e6d 6561 6e28 5b6c 656e 2870 2920 666f  .mean([len(p) fo
+00033040: 7220 7020 696e 2066 6972 7374 5f70 6172  r p in first_par
+00033050: 6574 6f5f 6672 6f6e 745d 290a 2020 2020  eto_front]).    
+00033060: 2020 2020 2020 2020 7468 6574 6120 3d20          theta = 
+00033070: 7468 6574 6120 2b20 2868 6973 746f 7269  theta + (histori
+00033080: 6361 6c5f 6c61 7267 6573 7420 2b20 6869  cal_largest + hi
+00033090: 7374 6f72 6963 616c 5f73 6d61 6c6c 6573  storical_smalles
+000330a0: 7420 2d20 3220 2a20 6176 675f 7369 7a65  t - 2 * avg_size
+000330b0: 2920 2a20 7365 6c66 2e62 6c6f 6174 5f63  ) * self.bloat_c
+000330c0: 6f6e 7472 6f6c 5b27 7374 6570 5f73 697a  ontrol['step_siz
+000330d0: 6527 5d20 5c0a 2020 2020 2020 2020 2020  e'] \.          
+000330e0: 2020 2020 2020 2020 2020 2f20 2868 6973            / (his
+000330f0: 746f 7269 6361 6c5f 6c61 7267 6573 7420  torical_largest 
+00033100: 2d20 6869 7374 6f72 6963 616c 5f73 6d61  - historical_sma
+00033110: 6c6c 6573 7429 0a20 2020 2020 2020 2020  llest).         
+00033120: 2020 2074 6865 7461 203d 206e 702e 636c     theta = np.cl
+00033130: 6970 2874 6865 7461 2c20 302c 2039 3029  ip(theta, 0, 90)
+00033140: 0a20 2020 2020 2020 2020 2020 2061 6c70  .            alp
+00033150: 6861 203d 206e 702e 7461 6e28 6e70 2e64  ha = np.tan(np.d
+00033160: 6567 3272 6164 2874 6865 7461 2929 0a20  eg2rad(theta)). 
+00033170: 2020 2020 2020 2020 2020 2023 2070 7269             # pri
+00033180: 6e74 2827 416c 7068 6127 2c20 616c 7068  nt('Alpha', alph
+00033190: 6129 0a20 2020 2020 2020 2020 2020 2073  a).            s
+000331a0: 656c 662e 626c 6f61 745f 636f 6e74 726f  elf.bloat_contro
+000331b0: 6c5b 2761 6c70 6861 5f76 616c 7565 275d  l['alpha_value']
+000331c0: 203d 2061 6c70 6861 0a20 2020 2020 2020   = alpha.       
+000331d0: 2065 6c69 6620 6e73 6761 3220 6f72 2073   elif nsga2 or s
+000331e0: 7065 6132 3a0a 2020 2020 2020 2020 2020  pea2:.          
+000331f0: 2020 6d61 785f 7369 7a65 203d 206d 6178    max_size = max
+00033200: 285b 6c65 6e28 7829 2066 6f72 2078 2069  ([len(x) for x i
+00033210: 6e20 6f66 6673 7072 696e 6720 2b20 706f  n offspring + po
+00033220: 7075 6c61 7469 6f6e 5d29 0a20 2020 2020  pulation]).     
+00033230: 2020 2020 2020 2066 6f72 2069 6e64 2069         for ind i
+00033240: 6e20 6f66 6673 7072 696e 6720 2b20 706f  n offspring + po
+00033250: 7075 6c61 7469 6f6e 3a0a 2020 2020 2020  pulation:.      
+00033260: 2020 2020 2020 2020 2020 7365 7461 7474            setatt
+00033270: 7228 696e 642c 2027 6f72 6967 696e 616c  r(ind, 'original
+00033280: 5f66 6974 6e65 7373 272c 2069 6e64 2e66  _fitness', ind.f
+00033290: 6974 6e65 7373 2e76 616c 7565 7329 0a20  itness.values). 
+000332a0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000332b0: 6e64 2e66 6974 6e65 7373 2e77 6569 6768  nd.fitness.weigh
+000332c0: 7473 203d 2028 2d31 2c20 2d31 290a 2020  ts = (-1, -1).  
+000332d0: 2020 2020 2020 2020 2020 2020 2020 696e                in
+000332e0: 642e 6669 746e 6573 732e 7661 6c75 6573  d.fitness.values
+000332f0: 203d 2028 696e 642e 6669 746e 6573 732e   = (ind.fitness.
+00033300: 7661 6c75 6573 5b30 5d2c 206c 656e 2869  values[0], len(i
+00033310: 6e64 2920 2f20 6d61 785f 7369 7a65 290a  nd) / max_size).
+00033320: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00033330: 7367 6132 3a0a 2020 2020 2020 2020 2020  sga2:.          
+00033340: 2020 2020 2020 706f 7075 6c61 7469 6f6e        population
+00033350: 5b3a 5d20 3d20 7365 6c4e 5347 4132 286f  [:] = selNSGA2(o
+00033360: 6666 7370 7269 6e67 202b 2070 6f70 756c  ffspring + popul
+00033370: 6174 696f 6e2c 206c 656e 2870 6f70 756c  ation, len(popul
+00033380: 6174 696f 6e29 290a 2020 2020 2020 2020  ation)).        
+00033390: 2020 2020 656c 6966 2073 7065 6132 3a0a      elif spea2:.
+000333a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000333b0: 706f 7075 6c61 7469 6f6e 5b3a 5d20 3d20  population[:] = 
+000333c0: 7365 6c53 5045 4132 286f 6666 7370 7269  selSPEA2(offspri
+000333d0: 6e67 202b 2070 6f70 756c 6174 696f 6e2c  ng + population,
+000333e0: 206c 656e 2870 6f70 756c 6174 696f 6e29   len(population)
+000333f0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00033400: 6c66 2e68 6f66 203d 205b 6d61 7828 706f  lf.hof = [max(po
+00033410: 7075 6c61 7469 6f6e 2c20 6b65 793d 6c61  pulation, key=la
+00033420: 6d62 6461 2078 3a20 782e 6669 746e 6573  mbda x: x.fitnes
+00033430: 732e 7776 616c 7565 735b 305d 295d 0a20  s.wvalues[0])]. 
+00033440: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+00033450: 6e64 2069 6e20 706f 7075 6c61 7469 6f6e  nd in population
+00033460: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00033470: 2020 696e 642e 6669 746e 6573 732e 7765    ind.fitness.we
+00033480: 6967 6874 7320 3d20 282d 312c 290a 2020  ights = (-1,).  
+00033490: 2020 2020 2020 2020 2020 2020 2020 696e                in
+000334a0: 642e 6669 746e 6573 732e 7661 6c75 6573  d.fitness.values
+000334b0: 203d 2067 6574 6174 7472 2869 6e64 2c20   = getattr(ind, 
+000334c0: 276f 7269 6769 6e61 6c5f 6669 746e 6573  'original_fitnes
+000334d0: 7327 290a 2020 2020 2020 2020 656c 6966  s').        elif
+000334e0: 2073 656c 662e 656e 7669 726f 6e6d 656e   self.environmen
+000334f0: 7461 6c5f 7365 6c65 6374 696f 6e20 3d3d  tal_selection ==
+00033500: 2027 4e53 4741 322d 4d69 7875 7027 3a0a   'NSGA2-Mixup':.
+00033510: 2020 2020 2020 2020 2020 2020 706f 7075              popu
+00033520: 6c61 7469 6f6e 5b3a 5d20 3d20 7365 6c4e  lation[:] = selN
+00033530: 5347 4132 286f 6666 7370 7269 6e67 202b  SGA2(offspring +
+00033540: 2070 6f70 756c 6174 696f 6e2c 206c 656e   population, len
+00033550: 2870 6f70 756c 6174 696f 6e29 290a 2020  (population)).  
+00033560: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
+00033570: 656e 7669 726f 6e6d 656e 7461 6c5f 7365  environmental_se
+00033580: 6c65 6374 696f 6e20 213d 204e 6f6e 6520  lection != None 
+00033590: 616e 6420 274e 5347 4132 2d31 3030 2720  and 'NSGA2-100' 
+000335a0: 696e 2073 656c 662e 656e 7669 726f 6e6d  in self.environm
+000335b0: 656e 7461 6c5f 7365 6c65 6374 696f 6e3a  ental_selection:
+000335c0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+000335d0: 2069 6e64 2069 6e20 6f66 6673 7072 696e   ind in offsprin
+000335e0: 6720 2b20 706f 7075 6c61 7469 6f6e 3a0a  g + population:.
+000335f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033600: 7365 7461 7474 7228 696e 642c 2027 6f72  setattr(ind, 'or
+00033610: 6967 696e 616c 5f66 6974 6e65 7373 272c  iginal_fitness',
+00033620: 2069 6e64 2e66 6974 6e65 7373 2e76 616c   ind.fitness.val
+00033630: 7565 7329 0a20 2020 2020 2020 2020 2020  ues).           
+00033640: 2020 2020 2066 6974 6e65 7373 203d 2069       fitness = i
+00033650: 6e64 2e63 6173 655f 7661 6c75 6573 2040  nd.case_values @
+00033660: 2073 656c 662e 7261 6e64 6f6d 5f6f 626a   self.random_obj
+00033670: 6563 7469 7665 730a 2020 2020 2020 2020  ectives.        
+00033680: 2020 2020 2020 2020 696e 642e 6669 746e          ind.fitn
+00033690: 6573 732e 7765 6967 6874 7320 3d20 282d  ess.weights = (-
+000336a0: 312c 2920 2a20 6c65 6e28 7365 6c66 2e72  1,) * len(self.r
+000336b0: 616e 646f 6d5f 6f62 6a65 6374 6976 6573  andom_objectives
+000336c0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000336d0: 2020 696e 642e 6669 746e 6573 732e 7661    ind.fitness.va
+000336e0: 6c75 6573 203d 206c 6973 7428 6669 746e  lues = list(fitn
+000336f0: 6573 7329 0a20 2020 2020 2020 2020 2020  ess).           
+00033700: 2070 6f70 756c 6174 696f 6e5b 3a5d 203d   population[:] =
+00033710: 2073 656c 4e53 4741 3228 6f66 6673 7072   selNSGA2(offspr
+00033720: 696e 6720 2b20 706f 7075 6c61 7469 6f6e  ing + population
+00033730: 2c20 6c65 6e28 706f 7075 6c61 7469 6f6e  , len(population
+00033740: 2929 0a20 2020 2020 2020 2020 2020 2066  )).            f
+00033750: 6f72 2069 6e64 2069 6e20 706f 7075 6c61  or ind in popula
+00033760: 7469 6f6e 3a0a 2020 2020 2020 2020 2020  tion:.          
+00033770: 2020 2020 2020 696e 642e 6669 746e 6573        ind.fitnes
+00033780: 732e 7765 6967 6874 7320 3d20 282d 312c  s.weights = (-1,
+00033790: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000337a0: 2020 696e 642e 6669 746e 6573 732e 7661    ind.fitness.va
+000337b0: 6c75 6573 203d 2067 6574 6174 7472 2869  lues = getattr(i
+000337c0: 6e64 2c20 276f 7269 6769 6e61 6c5f 6669  nd, 'original_fi
+000337d0: 746e 6573 7327 290a 2020 2020 2020 2020  tness').        
+000337e0: 2020 2020 7365 6c66 2e68 6f66 203d 2070      self.hof = p
+000337f0: 6f70 756c 6174 696f 6e0a 2020 2020 2020  opulation.      
+00033800: 2020 656c 6966 2073 656c 662e 656e 7669    elif self.envi
+00033810: 726f 6e6d 656e 7461 6c5f 7365 6c65 6374  ronmental_select
+00033820: 696f 6e20 696e 205b 274e 5347 4132 2d43  ion in ['NSGA2-C
+00033830: 5627 2c20 274e 5347 4132 2d43 5632 275d  V', 'NSGA2-CV2']
+00033840: 3a0a 2020 2020 2020 2020 2020 2020 666f  :.            fo
+00033850: 7220 696e 6420 696e 206f 6666 7370 7269  r ind in offspri
+00033860: 6e67 202b 2070 6f70 756c 6174 696f 6e3a  ng + population:
+00033870: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00033880: 2073 6574 6174 7472 2869 6e64 2c20 276f   setattr(ind, 'o
+00033890: 7269 6769 6e61 6c5f 6669 746e 6573 7327  riginal_fitness'
+000338a0: 2c20 696e 642e 6669 746e 6573 732e 7661  , ind.fitness.va
+000338b0: 6c75 6573 290a 2020 2020 2020 2020 2020  lues).          
+000338c0: 2020 2020 2020 6669 746e 6573 7320 3d20        fitness = 
+000338d0: 696e 642e 6361 7365 5f76 616c 7565 730a  ind.case_values.
+000338e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000338f0: 6966 2073 656c 662e 656e 7669 726f 6e6d  if self.environm
+00033900: 656e 7461 6c5f 7365 6c65 6374 696f 6e20  ental_selection 
+00033910: 3d3d 2027 4e53 4741 322d 4356 3227 3a0a  == 'NSGA2-CV2':.
+00033920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033930: 2020 2020 6669 746e 6573 7320 3d20 6669      fitness = fi
+00033940: 746e 6573 7320 4020 6e70 2e72 616e 646f  tness @ np.rando
+00033950: 6d2e 756e 6966 6f72 6d28 302c 2031 2c20  m.uniform(0, 1, 
+00033960: 7369 7a65 3d28 352c 2032 2929 0a20 2020  size=(5, 2)).   
+00033970: 2020 2020 2020 2020 2020 2020 2069 6e64               ind
+00033980: 2e66 6974 6e65 7373 2e77 6569 6768 7473  .fitness.weights
+00033990: 203d 2028 2d31 2c29 202a 206c 656e 2866   = (-1,) * len(f
+000339a0: 6974 6e65 7373 290a 2020 2020 2020 2020  itness).        
+000339b0: 2020 2020 2020 2020 696e 642e 6669 746e          ind.fitn
+000339c0: 6573 732e 7661 6c75 6573 203d 206c 6973  ess.values = lis
+000339d0: 7428 6669 746e 6573 7329 0a20 2020 2020  t(fitness).     
+000339e0: 2020 2020 2020 2070 6f70 756c 6174 696f         populatio
+000339f0: 6e5b 3a5d 203d 2073 656c 4e53 4741 3228  n[:] = selNSGA2(
+00033a00: 6f66 6673 7072 696e 6720 2b20 706f 7075  offspring + popu
+00033a10: 6c61 7469 6f6e 2c20 6c65 6e28 706f 7075  lation, len(popu
+00033a20: 6c61 7469 6f6e 2929 0a20 2020 2020 2020  lation)).       
+00033a30: 2020 2020 2066 6f72 2069 6e64 2069 6e20       for ind in 
+00033a40: 706f 7075 6c61 7469 6f6e 3a0a 2020 2020  population:.    
+00033a50: 2020 2020 2020 2020 2020 2020 696e 642e              ind.
+00033a60: 6669 746e 6573 732e 7765 6967 6874 7320  fitness.weights 
+00033a70: 3d20 282d 312c 290a 2020 2020 2020 2020  = (-1,).        
+00033a80: 2020 2020 2020 2020 696e 642e 6669 746e          ind.fitn
+00033a90: 6573 732e 7661 6c75 6573 203d 2067 6574  ess.values = get
+00033aa0: 6174 7472 2869 6e64 2c20 276f 7269 6769  attr(ind, 'origi
+00033ab0: 6e61 6c5f 6669 746e 6573 7327 290a 2020  nal_fitness').  
+00033ac0: 2020 2020 2020 2020 2020 7365 6c66 2e68            self.h
+00033ad0: 6f66 203d 2070 6f70 756c 6174 696f 6e0a  of = population.
+00033ae0: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
+00033af0: 662e 656e 7669 726f 6e6d 656e 7461 6c5f  f.environmental_
+00033b00: 7365 6c65 6374 696f 6e20 696e 205b 274e  selection in ['N
+00033b10: 5347 4132 272c 2027 4e53 4741 322d 4e6f  SGA2', 'NSGA2-No
+00033b20: 726d 616c 697a 6564 272c 2027 4e53 4741  rmalized', 'NSGA
+00033b30: 322d 4265 7374 272c 2027 4e53 4741 322d  2-Best', 'NSGA2-
+00033b40: 4265 7374 2d48 616c 6627 5d3a 0a20 2020  Best-Half']:.   
+00033b50: 2020 2020 2020 2020 2023 2074 776f 206f           # two o
+00033b60: 626a 6563 7469 7665 733a 0a20 2020 2020  bjectives:.     
+00033b70: 2020 2020 2020 2023 2031 2e20 6163 6375         # 1. accu
+00033b80: 7261 6379 0a20 2020 2020 2020 2020 2020  racy.           
+00033b90: 2023 2032 2e20 6e6f 6465 2063 6f75 6e74   # 2. node count
+00033ba0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00033bb0: 7365 6c66 2e65 6e76 6972 6f6e 6d65 6e74  self.environment
+00033bc0: 616c 5f73 656c 6563 7469 6f6e 203d 3d20  al_selection == 
+00033bd0: 274e 5347 4132 2d42 6573 742d 4861 6c66  'NSGA2-Best-Half
+00033be0: 2720 616e 6420 6765 6e20 3c20 2873 656c  ' and gen < (sel
+00033bf0: 662e 6e5f 6765 6e20 2f2f 2032 293a 0a20  f.n_gen // 2):. 
+00033c00: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00033c10: 6f70 756c 6174 696f 6e5b 3a5d 203d 206f  opulation[:] = o
+00033c20: 6666 7370 7269 6e67 0a20 2020 2020 2020  ffspring.       
+00033c30: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00033c40: 2020 2020 2020 2020 2020 2064 6566 206b             def k
+00033c50: 6e65 655f 706f 696e 745f 6465 7465 6374  nee_point_detect
+00033c60: 696f 6e28 6672 6f6e 7429 3a0a 2020 2020  ion(front):.    
+00033c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033c80: 7031 203d 206e 702e 6d61 7828 6672 6f6e  p1 = np.max(fron
+00033c90: 742c 2061 7869 733d 3029 0a20 2020 2020  t, axis=0).     
+00033ca0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00033cb0: 3220 3d20 6e70 2e6d 6178 2866 726f 6e74  2 = np.max(front
+00033cc0: 2c20 6178 6973 3d30 290a 2020 2020 2020  , axis=0).      
+00033cd0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00033ce0: e887 aae5 8aa8 e980 89e6 8ba9 e68b 90e7  ................
+00033cf0: 82b9 0a20 2020 2020 2020 2020 2020 2020  ...             
+00033d00: 2020 2020 2020 2061 6e73 203d 206d 6178         ans = max
+00033d10: 285b 6920 666f 7220 6920 696e 2072 616e  ([i for i in ran
+00033d20: 6765 286c 656e 2866 726f 6e74 2929 5d2c  ge(len(front))],
+00033d30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00033d40: 2020 2020 2020 2020 2020 2020 2020 206b                 k
+00033d50: 6579 3d6c 616d 6264 6120 693a 206e 6f72  ey=lambda i: nor
+00033d60: 6d28 6e70 2e63 726f 7373 2870 3220 2d20  m(np.cross(p2 - 
+00033d70: 7031 2c20 7031 202d 2066 726f 6e74 5b69  p1, p1 - front[i
+00033d80: 5d29 2920 2f20 6e6f 726d 2870 3220 2d20  ])) / norm(p2 - 
+00033d90: 7031 2929 0a20 2020 2020 2020 2020 2020  p1)).           
+00033da0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00033db0: 616e 730a 0a20 2020 2020 2020 2020 2020  ans..           
+00033dc0: 2020 2020 2061 7667 5f73 697a 6520 3d20       avg_size = 
+00033dd0: 6e70 2e6d 6561 6e28 5b6e 702e 6172 7261  np.mean([np.arra
+00033de0: 7928 5b6c 656e 2879 2920 666f 7220 7920  y([len(y) for y 
+00033df0: 696e 2078 2e67 656e 655d 2920 2a20 2878  in x.gene]) * (x
+00033e00: 2e63 6f65 6620 213d 2030 2920 666f 7220  .coef != 0) for 
+00033e10: 7820 696e 206f 6666 7370 7269 6e67 202b  x in offspring +
+00033e20: 2070 6f70 756c 6174 696f 6e5d 290a 2020   population]).  
+00033e30: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00033e40: 7220 696e 6420 696e 206f 6666 7370 7269  r ind in offspri
+00033e50: 6e67 202b 2070 6f70 756c 6174 696f 6e3a  ng + population:
+00033e60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00033e70: 2020 2020 2073 6574 6174 7472 2869 6e64       setattr(ind
+00033e80: 2c20 276f 7269 6769 6e61 6c5f 6669 746e  , 'original_fitn
+00033e90: 6573 7327 2c20 696e 642e 6669 746e 6573  ess', ind.fitnes
+00033ea0: 732e 7661 6c75 6573 290a 2020 2020 2020  s.values).      
+00033eb0: 2020 2020 2020 2020 2020 2020 2020 696e                in
+00033ec0: 642e 6669 746e 6573 732e 7765 6967 6874  d.fitness.weight
+00033ed0: 7320 3d20 282d 312c 202d 3129 0a20 2020  s = (-1, -1).   
+00033ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033ef0: 2069 6e64 5f73 697a 6520 3d20 6e70 2e6d   ind_size = np.m
+00033f00: 6561 6e28 6e70 2e61 7272 6179 285b 6c65  ean(np.array([le
+00033f10: 6e28 7929 2066 6f72 2079 2069 6e20 696e  n(y) for y in in
+00033f20: 642e 6765 6e65 5d29 202a 2028 696e 642e  d.gene]) * (ind.
+00033f30: 636f 6566 2021 3d20 3029 2920 2f20 6176  coef != 0)) / av
+00033f40: 675f 7369 7a65 0a20 2020 2020 2020 2020  g_size.         
+00033f50: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00033f60: 6c66 2e65 6e76 6972 6f6e 6d65 6e74 616c  lf.environmental
+00033f70: 5f73 656c 6563 7469 6f6e 203d 3d20 274e  _selection == 'N
+00033f80: 5347 4132 2d4e 6f72 6d61 6c69 7a65 6427  SGA2-Normalized'
+00033f90: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00033fa0: 2020 2020 2020 2020 2020 696e 642e 6669            ind.fi
+00033fb0: 746e 6573 732e 7661 6c75 6573 203d 2028  tness.values = (
+00033fc0: 696e 642e 6669 746e 6573 732e 7661 6c75  ind.fitness.valu
+00033fd0: 6573 5b30 5d2c 206d 6178 2831 2c20 696e  es[0], max(1, in
+00033fe0: 645f 7369 7a65 2929 0a20 2020 2020 2020  d_size)).       
+00033ff0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00034000: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00034010: 2020 2020 2020 2020 2020 2069 6e64 2e66             ind.f
+00034020: 6974 6e65 7373 2e76 616c 7565 7320 3d20  itness.values = 
+00034030: 2869 6e64 2e66 6974 6e65 7373 2e76 616c  (ind.fitness.val
+00034040: 7565 735b 305d 2c20 696e 645f 7369 7a65  ues[0], ind_size
+00034050: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00034060: 2020 706f 7075 6c61 7469 6f6e 5b3a 5d20    population[:] 
+00034070: 3d20 7365 6c4e 5347 4132 286f 6666 7370  = selNSGA2(offsp
+00034080: 7269 6e67 202b 2070 6f70 756c 6174 696f  ring + populatio
+00034090: 6e2c 206c 656e 2870 6f70 756c 6174 696f  n, len(populatio
+000340a0: 6e29 290a 2020 2020 2020 2020 2020 2020  n)).            
+000340b0: 2020 2020 6b6e 6565 203d 206b 6e65 655f      knee = knee_
+000340c0: 706f 696e 745f 6465 7465 6374 696f 6e28  point_detection(
+000340d0: 5b70 2e66 6974 6e65 7373 2e77 7661 6c75  [p.fitness.wvalu
+000340e0: 6573 2066 6f72 2070 2069 6e20 706f 7075  es for p in popu
+000340f0: 6c61 7469 6f6e 5d29 0a20 2020 2020 2020  lation]).       
+00034100: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00034110: 2e76 6572 626f 7365 3a0a 2020 2020 2020  .verbose:.      
+00034120: 2020 2020 2020 2020 2020 2020 2020 6b6e                kn
+00034130: 6565 5f69 6e64 6976 6964 7561 6c20 3d20  ee_individual = 
+00034140: 706f 7075 6c61 7469 6f6e 5b6b 6e65 655d  population[knee]
+00034150: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00034160: 2020 2020 206b 6e65 655f 7369 7a65 203d       knee_size =
+00034170: 206e 702e 7375 6d28 6b6e 6565 5f69 6e64   np.sum(knee_ind
+00034180: 6976 6964 7561 6c2e 636f 6566 2021 3d20  ividual.coef != 
+00034190: 3029 0a20 2020 2020 2020 2020 2020 2020  0).             
+000341a0: 2020 2020 2020 2070 7269 6e74 2827 4b6e         print('Kn
+000341b0: 6565 2053 697a 6527 2c20 6b6e 6565 5f73  ee Size', knee_s
+000341c0: 697a 6529 0a20 2020 2020 2020 2020 2020  ize).           
+000341d0: 2020 2020 2066 6f72 2069 6e64 2069 6e20       for ind in 
+000341e0: 706f 7075 6c61 7469 6f6e 3a0a 2020 2020  population:.    
+000341f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034200: 696e 642e 6669 746e 6573 732e 7765 6967  ind.fitness.weig
+00034210: 6874 7320 3d20 282d 312c 290a 2020 2020  hts = (-1,).    
+00034220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034230: 696e 642e 6669 746e 6573 732e 7661 6c75  ind.fitness.valu
+00034240: 6573 203d 2067 6574 6174 7472 2869 6e64  es = getattr(ind
+00034250: 2c20 276f 7269 6769 6e61 6c5f 6669 746e  , 'original_fitn
+00034260: 6573 7327 290a 2020 2020 2020 2020 2020  ess').          
+00034270: 2020 2020 2020 6966 2073 656c 662e 656e        if self.en
+00034280: 7669 726f 6e6d 656e 7461 6c5f 7365 6c65  vironmental_sele
+00034290: 6374 696f 6e20 213d 2027 4e53 4741 322d  ction != 'NSGA2-
+000342a0: 4265 7374 273a 0a20 2020 2020 2020 2020  Best':.         
+000342b0: 2020 2020 2020 2020 2020 2023 2053 656c             # Sel
+000342c0: 6563 7420 7468 6520 6b6e 6565 2070 6f69  ect the knee poi
+000342d0: 6e74 2061 7320 7468 6520 6669 6e61 6c20  nt as the final 
+000342e0: 6d6f 6465 6c0a 2020 2020 2020 2020 2020  model.          
+000342f0: 2020 2020 2020 2020 2020 7365 6c66 2e68            self.h
+00034300: 6f66 203d 205b 706f 7075 6c61 7469 6f6e  of = [population
+00034310: 5b6b 6e65 655d 5d0a 2020 2020 2020 2020  [knee]].        
+00034320: 656c 6966 2073 656c 662e 656e 7669 726f  elif self.enviro
+00034330: 6e6d 656e 7461 6c5f 7365 6c65 6374 696f  nmental_selectio
+00034340: 6e20 3d3d 2027 4d4f 4541 2f44 273a 0a20  n == 'MOEA/D':. 
+00034350: 2020 2020 2020 2020 2020 2023 204d 4f45             # MOE
+00034360: 412f 4420 7769 7468 2072 616e 646f 6d20  A/D with random 
+00034370: 6465 636f 6d70 6f73 6974 696f 6e0a 2020  decomposition.  
+00034380: 2020 2020 2020 2020 2020 6465 6620 7365            def se
+00034390: 6c4d 4f45 4144 2869 6e64 6976 6964 7561  lMOEAD(individua
+000343a0: 6c73 2c20 6b29 3a0a 2020 2020 2020 2020  ls, k):.        
+000343b0: 2020 2020 2020 2020 696e 6473 203d 205b          inds = [
+000343c0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+000343d0: 2020 7768 696c 6520 5472 7565 3a0a 2020    while True:.  
+000343e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000343f0: 2020 6966 206c 656e 2869 6e64 7329 203e    if len(inds) >
+00034400: 3d20 6b3a 0a20 2020 2020 2020 2020 2020  = k:.           
+00034410: 2020 2020 2020 2020 2020 2020 2062 7265               bre
+00034420: 616b 0a20 2020 2020 2020 2020 2020 2020  ak.             
+00034430: 2020 2020 2020 2077 6569 6768 7420 3d20         weight = 
+00034440: 6e70 2e72 616e 646f 6d2e 756e 6966 6f72  np.random.unifor
+00034450: 6d28 302c 2031 2c20 7369 7a65 3d28 6c65  m(0, 1, size=(le
+00034460: 6e28 696e 6469 7669 6475 616c 735b 305d  n(individuals[0]
+00034470: 2e63 6173 655f 7661 6c75 6573 2929 290a  .case_values))).
+00034480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034490: 2020 2020 6675 6e20 3d20 6c61 6d62 6461      fun = lambda
+000344a0: 2078 3a20 6e70 2e73 756d 2877 6569 6768   x: np.sum(weigh
+000344b0: 7420 2a20 6e70 2e61 7272 6179 2878 2e63  t * np.array(x.c
+000344c0: 6173 655f 7661 6c75 6573 2929 0a20 2020  ase_values)).   
+000344d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000344e0: 2069 6e64 203d 2073 6f72 7465 6428 696e   ind = sorted(in
+000344f0: 6469 7669 6475 616c 732c 206b 6579 3d6c  dividuals, key=l
+00034500: 616d 6264 6120 783a 2066 6c6f 6174 2866  ambda x: float(f
+00034510: 756e 2878 2929 295b 305d 0a20 2020 2020  un(x)))[0].     
+00034520: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00034530: 6e64 6976 6964 7561 6c73 2e72 656d 6f76  ndividuals.remov
+00034540: 6528 696e 6429 0a20 2020 2020 2020 2020  e(ind).         
+00034550: 2020 2020 2020 2020 2020 2069 6e64 732e             inds.
+00034560: 6170 7065 6e64 2869 6e64 290a 2020 2020  append(ind).    
+00034570: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00034580: 726e 2069 6e64 730a 0a20 2020 2020 2020  rn inds..       
+00034590: 2020 2020 2070 6f70 756c 6174 696f 6e5b       population[
+000345a0: 3a5d 203d 2073 656c 4d4f 4541 4428 6f66  :] = selMOEAD(of
+000345b0: 6673 7072 696e 6720 2b20 706f 7075 6c61  fspring + popula
+000345c0: 7469 6f6e 2c20 6c65 6e28 706f 7075 6c61  tion, len(popula
+000345d0: 7469 6f6e 2929 0a20 2020 2020 2020 2020  tion)).         
+000345e0: 2020 2073 656c 662e 686f 6620 3d20 706f     self.hof = po
+000345f0: 7075 6c61 7469 6f6e 0a20 2020 2020 2020  pulation.       
+00034600: 2065 6c69 6620 7365 6c66 2e65 6e76 6972   elif self.envir
+00034610: 6f6e 6d65 6e74 616c 5f73 656c 6563 7469  onmental_selecti
+00034620: 6f6e 203d 3d20 2742 6573 7427 3a0a 2020  on == 'Best':.  
+00034630: 2020 2020 2020 2020 2020 706f 7075 6c61            popula
+00034640: 7469 6f6e 5b3a 5d20 3d20 7365 6c42 6573  tion[:] = selBes
+00034650: 7428 6f66 6673 7072 696e 6720 2b20 706f  t(offspring + po
+00034660: 7075 6c61 7469 6f6e 2c20 6c65 6e28 706f  pulation, len(po
+00034670: 7075 6c61 7469 6f6e 2929 0a20 2020 2020  pulation)).     
+00034680: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00034690: 2020 2020 2070 6f70 756c 6174 696f 6e5b       population[
+000346a0: 3a5d 203d 206f 6666 7370 7269 6e67 0a0a  :] = offspring..
+000346b0: 2020 2020 2320 4074 696d 6569 740a 2020      # @timeit.  
+000346c0: 2020 6465 6620 706f 7075 6c61 7469 6f6e    def population
+000346d0: 5f72 6564 7563 7469 6f6e 2873 656c 662c  _reduction(self,
+000346e0: 2070 6f70 756c 6174 696f 6e29 3a0a 2020   population):.  
+000346f0: 2020 2020 2020 2320 7265 6475 6365 2074        # reduce t
+00034700: 6865 2070 6f70 756c 6174 696f 6e20 7369  he population si
+00034710: 7a65 2074 6872 6f75 6768 2066 6561 7475  ze through featu
+00034720: 7265 2073 656c 6563 7469 6f6e 0a20 2020  re selection.   
+00034730: 2020 2020 2072 6174 696f 203d 2073 656c       ratio = sel
+00034740: 662e 7265 6475 6374 696f 6e5f 7261 7469  f.reduction_rati
+00034750: 6f0a 2020 2020 2020 2020 6e65 775f 706f  o.        new_po
+00034760: 7075 6c61 7469 6f6e 203d 205b 5d0a 2020  pulation = [].  
+00034770: 2020 2020 2020 2320 7768 696c 6520 6c65        # while le
+00034780: 6e28 6e65 775f 706f 7075 6c61 7469 6f6e  n(new_population
+00034790: 2920 3c20 286c 656e 2870 6f70 756c 6174  ) < (len(populat
+000347a0: 696f 6e29 202f 2f20 7261 7469 6f29 3a0a  ion) // ratio):.
+000347b0: 2020 2020 2020 2020 666f 7220 7020 696e          for p in
+000347c0: 2070 6f70 756c 6174 696f 6e3a 0a20 2020   population:.   
+000347d0: 2020 2020 2020 2020 2023 2069 6e64 7320           # inds 
+000347e0: 3d20 7261 6e64 6f6d 2e73 616d 706c 6528  = random.sample(
+000347f0: 706f 7075 6c61 7469 6f6e 2c20 7261 7469  population, rati
+00034800: 6f29 0a20 2020 2020 2020 2020 2020 2069  o).            i
+00034810: 6e64 7320 3d20 5b70 5d0a 2020 2020 2020  nds = [p].      
+00034820: 2020 2020 2020 6765 6e65 7320 3d20 6c69        genes = li
+00034830: 7374 2863 6861 696e 2e66 726f 6d5f 6974  st(chain.from_it
+00034840: 6572 6162 6c65 285b 696e 642e 6765 6e65  erable([ind.gene
+00034850: 2066 6f72 2069 6e64 2069 6e20 696e 6473   for ind in inds
+00034860: 5d29 290a 0a20 2020 2020 2020 2020 2020  ]))..           
+00034870: 2023 2073 796e 7461 6374 6963 2066 6561   # syntactic fea
+00034880: 7475 7265 2073 656c 6563 7469 6f6e 0a20  ture selection. 
+00034890: 2020 2020 2020 2020 2020 2067 656e 655f             gene_
+000348a0: 7374 7220 3d20 7365 7428 290a 2020 2020  str = set().    
+000348b0: 2020 2020 2020 2020 6669 6e61 6c5f 6765          final_ge
+000348c0: 6e65 7320 3d20 5b5d 0a20 2020 2020 2020  nes = [].       
+000348d0: 2020 2020 2066 6f72 2067 2069 6e20 6765       for g in ge
+000348e0: 6e65 733a 0a20 2020 2020 2020 2020 2020  nes:.           
+000348f0: 2020 2020 2023 2072 656d 6f76 6520 7379       # remove sy
+00034900: 6e74 6163 7469 6320 6571 7569 7661 6c65  ntactic equivale
+00034910: 6e74 2020 6665 6174 7572 6573 2061 6e64  nt  features and
+00034920: 2063 6f6e 7374 616e 7420 6665 6174 7572   constant featur
+00034930: 6573 0a20 2020 2020 2020 2020 2020 2020  es.             
+00034940: 2020 2069 6620 7374 7228 6729 206e 6f74     if str(g) not
+00034950: 2069 6e20 6765 6e65 5f73 7472 2061 6e64   in gene_str and
+00034960: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+00034970: 675b 305d 2c20 6770 2e72 616e 6431 3031  g[0], gp.rand101
+00034980: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00034990: 2020 2020 2020 2067 656e 655f 7374 722e         gene_str.
+000349a0: 6164 6428 7374 7228 6729 290a 2020 2020  add(str(g)).    
+000349b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000349c0: 6669 6e61 6c5f 6765 6e65 732e 6170 7065  final_genes.appe
+000349d0: 6e64 2867 290a 0a20 2020 2020 2020 2020  nd(g)..         
+000349e0: 2020 2023 2073 656d 616e 7469 6320 6665     # semantic fe
+000349f0: 6174 7572 6520 7365 6c65 6374 696f 6e0a  ature selection.
+00034a00: 2020 2020 2020 2020 2020 2020 6765 6e65              gene
+00034a10: 5f63 6f6d 7069 6c65 6420 3d20 5b5d 0a20  _compiled = []. 
+00034a20: 2020 2020 2020 2020 2020 2066 6f72 2067             for g
+00034a30: 656e 6520 696e 2066 696e 616c 5f67 656e  ene in final_gen
+00034a40: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+00034a50: 2020 2020 6765 6e65 5f63 6f6d 7069 6c65      gene_compile
+00034a60: 642e 6170 7065 6e64 2863 6f6d 7069 6c65  d.append(compile
+00034a70: 2867 656e 652c 2073 656c 662e 7073 6574  (gene, self.pset
+00034a80: 2929 0a20 2020 2020 2020 2020 2020 2023  )).            #
+00034a90: 2072 616e 646f 6d20 7361 6d70 6c65 2061   random sample a
+00034aa0: 2073 7562 7365 7420 746f 2070 6572 666f   subset to perfo
+00034ab0: 726d 2066 6561 7475 7265 2073 656c 6563  rm feature selec
+00034ac0: 7469 6f6e 0a20 2020 2020 2020 2020 2020  tion.           
+00034ad0: 2078 203d 2073 656c 662e 585b 6e70 2e72   x = self.X[np.r
+00034ae0: 616e 646f 6d2e 7261 6e64 696e 7428 6c6f  andom.randint(lo
+00034af0: 773d 302c 2073 697a 653d 3230 2c20 6869  w=0, size=20, hi
+00034b00: 6768 3d73 656c 662e 792e 7368 6170 655b  gh=self.y.shape[
+00034b10: 305d 295d 0a20 2020 2020 2020 2020 2020  0])].           
+00034b20: 2066 6561 7475 7265 7320 3d20 7265 7375   features = resu
+00034b30: 6c74 5f63 616c 6375 6c61 7469 6f6e 2867  lt_calculation(g
+00034b40: 656e 655f 636f 6d70 696c 6564 2c20 782c  ene_compiled, x,
+00034b50: 2046 616c 7365 290a 2020 2020 2020 2020   False).        
+00034b60: 2020 2020 6665 6174 7572 6573 2c20 7365      features, se
+00034b70: 6c65 6374 6564 5f69 6e64 6578 203d 206e  lected_index = n
+00034b80: 702e 756e 6971 7565 2866 6561 7475 7265  p.unique(feature
+00034b90: 732c 2072 6574 7572 6e5f 696e 6465 783d  s, return_index=
+00034ba0: 5472 7565 2c20 6178 6973 3d31 290a 2020  True, axis=1).  
+00034bb0: 2020 2020 2020 2020 2020 6765 6e65 7320            genes 
+00034bc0: 3d20 5b66 696e 616c 5f67 656e 6573 5b72  = [final_genes[r
+00034bd0: 5d20 666f 7220 7220 696e 2073 656c 6563  ] for r in selec
+00034be0: 7465 645f 696e 6465 785d 0a20 2020 2020  ted_index].     
+00034bf0: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
+00034c00: 6e28 6765 6e65 7329 203d 3d20 6665 6174  n(genes) == feat
+00034c10: 7572 6573 2e73 6861 7065 5b31 5d0a 0a20  ures.shape[1].. 
+00034c20: 2020 2020 2020 2020 2020 2023 206d 726d             # mrm
+00034c30: 7220 6665 6174 7572 6520 7365 6c65 6374  r feature select
+00034c40: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
+00034c50: 2320 6966 206c 656e 2867 656e 6573 2920  # if len(genes) 
+00034c60: 3c20 7365 6c66 2e67 656e 655f 6e75 6d3a  < self.gene_num:
+00034c70: 0a20 2020 2020 2020 2020 2020 2023 2020  .            #  
+00034c80: 2020 2063 6f6e 7469 6e75 650a 2020 2020     continue.    
+00034c90: 2020 2020 2020 2020 2320 7265 7375 6c74          # result
+00034ca0: 203d 206d 726d 725f 7265 6772 6573 7369   = mrmr_regressi
+00034cb0: 6f6e 2866 6561 7475 7265 732c 2073 656c  on(features, sel
+00034cc0: 662e 792c 2073 656c 662e 6765 6e65 5f6e  f.y, self.gene_n
+00034cd0: 756d 2c0a 2020 2020 2020 2020 2020 2020  um,.            
+00034ce0: 2320 2020 2020 2020 2020 2020 2020 2020  #               
+00034cf0: 2020 2020 2020 2020 2020 2072 656c 6576             relev
+00034d00: 616e 6365 3d5f 665f 7265 6772 6573 7369  ance=_f_regressi
+00034d10: 6f6e 2c20 7265 6475 6e64 616e 6379 3d5f  on, redundancy=_
+00034d20: 636f 7272 5f70 6561 7273 6f6e 290a 2020  corr_pearson).  
+00034d30: 2020 2020 2020 2020 2020 2320 7265 7375            # resu
+00034d40: 6c74 2c20 5f2c 205f 203d 204d 524d 522e  lt, _, _ = MRMR.
+00034d50: 6d72 6d72 2866 6561 7475 7265 732c 2073  mrmr(features, s
+00034d60: 656c 662e 792c 206e 5f73 656c 6563 7465  elf.y, n_selecte
+00034d70: 645f 6665 6174 7572 6573 3d73 656c 662e  d_features=self.
+00034d80: 6765 6e65 5f6e 756d 290a 2020 2020 2020  gene_num).      
+00034d90: 2020 2020 2020 2320 7365 6c65 6374 6564        # selected
+00034da0: 5f66 6561 7475 7265 7320 3d20 5b67 656e  _features = [gen
+00034db0: 6573 5b72 5d20 666f 7220 7220 696e 2072  es[r] for r in r
+00034dc0: 6573 756c 745d 0a0a 2020 2020 2020 2020  esult]..        
+00034dd0: 2020 2020 2320 616e 6f74 6865 7220 7374      # another st
+00034de0: 7261 7465 6779 3a20 6f6e 6c79 2065 6c69  rategy: only eli
+00034df0: 6d69 6e61 7465 2072 6564 756e 6461 6e74  minate redundant
+00034e00: 2066 6561 7475 7265 730a 2020 2020 2020   features.      
+00034e10: 2020 2020 2020 2320 7365 6c65 6374 6564        # selected
+00034e20: 5f66 6561 7475 7265 7320 3d20 5b67 656e  _features = [gen
+00034e30: 6573 5b72 5d20 666f 7220 7220 696e 2072  es[r] for r in r
+00034e40: 616e 6765 2873 656c 662e 6765 6e65 5f6e  ange(self.gene_n
+00034e50: 756d 295d 0a0a 2020 2020 2020 2020 2020  um)]..          
+00034e60: 2020 2320 7265 6c69 6566 2073 656c 6563    # relief selec
+00034e70: 7469 6f6e 0a20 2020 2020 2020 2020 2020  tion.           
+00034e80: 2023 2073 636f 7265 203d 2072 656c 6965   # score = relie
+00034e90: 6646 2e72 656c 6965 6646 2866 6561 7475  fF.reliefF(featu
+00034ea0: 7265 732c 7365 6c66 2e79 290a 2020 2020  res,self.y).    
+00034eb0: 2020 2020 2020 2020 2320 7365 6c65 6374          # select
+00034ec0: 6564 5f66 6561 7475 7265 7320 3d20 5b67  ed_features = [g
+00034ed0: 656e 6573 5b72 5d20 666f 7220 7220 696e  enes[r] for r in
+00034ee0: 206e 702e 6172 6773 6f72 7428 7363 6f72   np.argsort(scor
+00034ef0: 6529 5b2d 7365 6c66 2e67 656e 655f 6e75  e)[-self.gene_nu
+00034f00: 6d3a 5d5d 0a20 2020 2020 2020 2020 2020  m:]].           
+00034f10: 2023 2069 6e64 203d 2063 6f70 792e 6465   # ind = copy.de
+00034f20: 6570 636f 7079 2869 6e64 735b 305d 290a  epcopy(inds[0]).
+00034f30: 2020 2020 2020 2020 2020 2020 2320 696e              # in
+00034f40: 642e 6765 6e65 203d 2073 656c 6563 7465  d.gene = selecte
+00034f50: 645f 6665 6174 7572 6573 0a0a 2020 2020  d_features..    
+00034f60: 2020 2020 2020 2020 702e 6765 6e65 203d          p.gene =
+00034f70: 2067 656e 6573 0a20 2020 2020 2020 2020   genes.         
+00034f80: 2020 2023 206e 6577 5f70 6f70 756c 6174     # new_populat
+00034f90: 696f 6e2e 6170 7065 6e64 2869 6e64 290a  ion.append(ind).
+00034fa0: 0a20 2020 2064 6566 2070 6561 7273 6f6e  .    def pearson
+00034fb0: 5f63 6f72 7265 6c61 7469 6f6e 5f61 6e61  _correlation_ana
+00034fc0: 6c79 7369 735f 7061 6972 7328 7365 6c66  lysis_pairs(self
+00034fd0: 2c20 706f 7075 6c61 7469 6f6e 293a 0a20  , population):. 
+00034fe0: 2020 2020 2020 2023 2050 6f70 756c 6174         # Populat
+00034ff0: 696f 6e20 416e 616c 7973 6973 0a20 2020  ion Analysis.   
+00035000: 2020 2020 2064 6566 2070 6561 7273 6f6e       def pearson
+00035010: 5f63 616c 6375 6c61 7469 6f6e 2869 6e64  _calculation(ind
+00035020: 3a20 4d75 6c74 6970 6c65 4765 6e65 4750  : MultipleGeneGP
+00035030: 293a 0a20 2020 2020 2020 2020 2020 2066  ):.            f
+00035040: 6561 7475 7265 7320 3d20 7365 6c66 2e66  eatures = self.f
+00035050: 6561 7475 7265 5f67 656e 6572 6174 696f  eature_generatio
+00035060: 6e28 7365 6c66 2e58 2c20 696e 6429 0a20  n(self.X, ind). 
+00035070: 2020 2020 2020 2020 2020 2063 6f72 7220             corr 
+00035080: 3d20 6e70 2e6e 616e 5f74 6f5f 6e75 6d28  = np.nan_to_num(
+00035090: 6e70 2e61 6273 286e 702e 6172 7261 7928  np.abs(np.array(
+000350a0: 7064 2e44 6174 6146 7261 6d65 2866 6561  pd.DataFrame(fea
+000350b0: 7475 7265 7329 2e63 6f72 7228 2929 292c  tures).corr())),
+000350c0: 206e 616e 3d31 290a 2020 2020 2020 2020   nan=1).        
+000350d0: 2020 2020 7265 7475 726e 206e 702e 6d65      return np.me
+000350e0: 616e 2863 6f72 7229 0a0a 2020 2020 2020  an(corr)..      
+000350f0: 2020 676f 6f64 5f70 6561 7273 6f6e 5f6c    good_pearson_l
+00035100: 6973 7420 3d20 6e70 2e61 6273 285b 7065  ist = np.abs([pe
+00035110: 6172 736f 6e5f 6361 6c63 756c 6174 696f  arson_calculatio
+00035120: 6e28 7029 2066 6f72 2070 2069 6e20 706f  n(p) for p in po
+00035130: 7075 6c61 7469 6f6e 5d29 0a20 2020 2020  pulation]).     
+00035140: 2020 2070 7269 6e74 2827 5065 6172 736f     print('Pearso
+00035150: 6e20 436f 7272 656c 6174 696f 6e27 2c20  n Correlation', 
+00035160: 6e70 2e6d 6561 6e28 676f 6f64 5f70 6561  np.mean(good_pea
+00035170: 7273 6f6e 5f6c 6973 7429 290a 0a20 2020  rson_list))..   
+00035180: 2064 6566 2070 6561 7273 6f6e 5f63 6f72   def pearson_cor
+00035190: 7265 6c61 7469 6f6e 5f61 6e61 6c79 7369  relation_analysi
+000351a0: 7328 7365 6c66 2c20 706f 7075 6c61 7469  s(self, populati
+000351b0: 6f6e 293a 0a20 2020 2020 2020 2023 2050  on):.        # P
+000351c0: 6f70 756c 6174 696f 6e20 416e 616c 7973  opulation Analys
+000351d0: 6973 0a20 2020 2020 2020 2070 6f6f 725f  is.        poor_
+000351e0: 696e 6469 7669 6475 616c 7320 3d20 6c69  individuals = li
+000351f0: 7374 2873 6f72 7465 6428 706f 7075 6c61  st(sorted(popula
+00035200: 7469 6f6e 2c20 6b65 793d 6c61 6d62 6461  tion, key=lambda
+00035210: 2078 3a20 782e 6669 746e 6573 732e 7776   x: x.fitness.wv
+00035220: 616c 7565 7329 295b 3a6c 656e 2870 6f70  alues))[:len(pop
+00035230: 756c 6174 696f 6e29 202f 2f20 355d 0a20  ulation) // 5]. 
+00035240: 2020 2020 2020 2067 6f6f 645f 696e 6469         good_indi
+00035250: 7669 6475 616c 7320 3d20 6c69 7374 2873  viduals = list(s
+00035260: 6f72 7465 6428 706f 7075 6c61 7469 6f6e  orted(population
+00035270: 2c20 6b65 793d 6c61 6d62 6461 2078 3a20  , key=lambda x: 
+00035280: 782e 6669 746e 6573 732e 7776 616c 7565  x.fitness.wvalue
+00035290: 7329 295b 2d6c 656e 2870 6f70 756c 6174  s))[-len(populat
+000352a0: 696f 6e29 202f 2f20 353a 5d0a 0a20 2020  ion) // 5:]..   
+000352b0: 2020 2020 2064 6566 2070 6561 7273 6f6e       def pearson
+000352c0: 5f63 616c 6375 6c61 7469 6f6e 2869 6e64  _calculation(ind
+000352d0: 3a20 4d75 6c74 6970 6c65 4765 6e65 4750  : MultipleGeneGP
+000352e0: 293a 0a20 2020 2020 2020 2020 2020 2066  ):.            f
+000352f0: 6561 7475 7265 7320 3d20 7365 6c66 2e66  eatures = self.f
+00035300: 6561 7475 7265 5f67 656e 6572 6174 696f  eature_generatio
+00035310: 6e28 7365 6c66 2e58 2c20 696e 6429 0a20  n(self.X, ind). 
+00035320: 2020 2020 2020 2020 2020 2023 2072 6574             # ret
+00035330: 7572 6e20 7065 6172 736f 6e72 2866 6561  urn pearsonr(fea
+00035340: 7475 7265 735b 3a2c 206e 702e 6172 676d  tures[:, np.argm
+00035350: 6178 2869 6e64 2e63 6f65 6629 5d2c 2073  ax(ind.coef)], s
+00035360: 656c 662e 7929 5b30 5d0a 2020 2020 2020  elf.y)[0].      
+00035370: 2020 2020 2020 616c 6c5f 7661 6c75 6573        all_values
+00035380: 203d 206e 702e 6162 7328 6e70 2e6e 616e   = np.abs(np.nan
+00035390: 5f74 6f5f 6e75 6d28 5b70 6561 7273 6f6e  _to_num([pearson
+000353a0: 7228 6665 6174 7572 6573 5b3a 2c20 705d  r(features[:, p]
+000353b0: 2c20 7365 6c66 2e79 295b 305d 2066 6f72  , self.y)[0] for
+000353c0: 2070 2069 6e20 7261 6e67 6528 6665 6174   p in range(feat
+000353d0: 7572 6573 2e73 6861 7065 5b31 5d29 5d29  ures.shape[1])])
+000353e0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+000353f0: 7475 726e 206e 702e 6d65 616e 2861 6c6c  turn np.mean(all
+00035400: 5f76 616c 7565 7329 2c20 6e70 2e6d 696e  _values), np.min
+00035410: 2861 6c6c 5f76 616c 7565 7329 2c20 6e70  (all_values), np
+00035420: 2e6d 6178 2861 6c6c 5f76 616c 7565 7329  .max(all_values)
+00035430: 0a0a 2020 2020 2020 2020 676f 6f64 5f70  ..        good_p
+00035440: 6561 7273 6f6e 5f6c 6973 7420 3d20 6e70  earson_list = np
+00035450: 2e61 6273 285b 7065 6172 736f 6e5f 6361  .abs([pearson_ca
+00035460: 6c63 756c 6174 696f 6e28 7029 2066 6f72  lculation(p) for
+00035470: 2070 2069 6e20 676f 6f64 5f69 6e64 6976   p in good_indiv
+00035480: 6964 7561 6c73 5d29 0a20 2020 2020 2020  iduals]).       
+00035490: 2062 6164 5f70 6561 7273 6f6e 5f6c 6973   bad_pearson_lis
+000354a0: 7420 3d20 6e70 2e61 6273 285b 7065 6172  t = np.abs([pear
+000354b0: 736f 6e5f 6361 6c63 756c 6174 696f 6e28  son_calculation(
+000354c0: 7029 2066 6f72 2070 2069 6e20 706f 6f72  p) for p in poor
+000354d0: 5f69 6e64 6976 6964 7561 6c73 5d29 0a20  _individuals]). 
+000354e0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+000354f0: 7261 6e67 6528 3329 3a0a 2020 2020 2020  range(3):.      
+00035500: 2020 2020 2020 7072 696e 7428 6e70 2e6d        print(np.m
+00035510: 6561 6e28 676f 6f64 5f70 6561 7273 6f6e  ean(good_pearson
+00035520: 5f6c 6973 745b 3a2c 2069 5d29 2c20 6e70  _list[:, i]), np
+00035530: 2e6d 6561 6e28 6261 645f 7065 6172 736f  .mean(bad_pearso
+00035540: 6e5f 6c69 7374 5b3a 2c20 695d 2929 0a0a  n_list[:, i]))..
+00035550: 2020 2020 6465 6620 6d75 6c74 696f 626a      def multiobj
+00035560: 6563 7469 7665 5f65 7661 6c75 6174 696f  ective_evaluatio
+00035570: 6e28 7365 6c66 2c20 746f 6f6c 626f 782c  n(self, toolbox,
+00035580: 2070 6f70 756c 6174 696f 6e29 3a0a 2020   population):.  
+00035590: 2020 2020 2020 6966 2073 656c 662e 6261        if self.ba
+000355a0: 7365 5f6c 6561 726e 6572 203d 3d20 2752  se_learner == 'R
+000355b0: 4454 7e4c 6967 6874 4742 4d2d 5374 756d  DT~LightGBM-Stum
+000355c0: 7027 3a0a 2020 2020 2020 2020 2020 2020  p':.            
+000355d0: 7365 636f 6e64 5f70 6f70 203d 2063 6f70  second_pop = cop
+000355e0: 792e 6465 6570 636f 7079 2870 6f70 756c  y.deepcopy(popul
+000355f0: 6174 696f 6e29 0a20 2020 2020 2020 2020  ation).         
+00035600: 2020 2066 6f72 206f 2069 6e20 706f 7075     for o in popu
+00035610: 6c61 7469 6f6e 3a0a 2020 2020 2020 2020  lation:.        
+00035620: 2020 2020 2020 2020 6f2e 6261 7365 5f6d          o.base_m
+00035630: 6f64 656c 203d 2027 5261 6e64 6f6d 2d44  odel = 'Random-D
+00035640: 5427 0a20 2020 2020 2020 2020 2020 2066  T'.            f
+00035650: 6f72 206f 2069 6e20 7365 636f 6e64 5f70  or o in second_p
+00035660: 6f70 3a0a 2020 2020 2020 2020 2020 2020  op:.            
+00035670: 2020 2020 6f2e 6261 7365 5f6d 6f64 656c      o.base_model
+00035680: 203d 2027 4c69 6768 7447 424d 2d53 7475   = 'LightGBM-Stu
+00035690: 6d70 270a 0a20 2020 2020 2020 2073 656c  mp'..        sel
+000356a0: 662e 706f 7075 6c61 7469 6f6e 5f65 7661  f.population_eva
+000356b0: 6c75 6174 696f 6e28 746f 6f6c 626f 782c  luation(toolbox,
+000356c0: 2070 6f70 756c 6174 696f 6e29 0a20 2020   population).   
+000356d0: 2020 2020 2073 656c 662e 706f 7075 6c61       self.popula
+000356e0: 7469 6f6e 5f65 7661 6c75 6174 696f 6e28  tion_evaluation(
+000356f0: 746f 6f6c 626f 782c 2073 6563 6f6e 645f  toolbox, second_
+00035700: 706f 7029 0a20 2020 2020 2020 2070 6f70  pop).        pop
+00035710: 756c 6174 696f 6e2e 6578 7465 6e64 2873  ulation.extend(s
+00035720: 6563 6f6e 645f 706f 7029 0a0a 2020 2020  econd_pop)..    
+00035730: 2020 2020 666f 7220 6f61 2c20 6f62 2069      for oa, ob i
+00035740: 6e20 7a69 7028 706f 7075 6c61 7469 6f6e  n zip(population
+00035750: 2c20 7365 636f 6e64 5f70 6f70 293a 0a20  , second_pop):. 
+00035760: 2020 2020 2020 2020 2020 206f 612e 6669             oa.fi
+00035770: 746e 6573 732e 7765 6967 6874 7320 3d20  tness.weights = 
+00035780: 282d 312c 202d 3129 0a20 2020 2020 2020  (-1, -1).       
+00035790: 2020 2020 206f 612e 6669 746e 6573 732e       oa.fitness.
+000357a0: 7661 6c75 6573 203d 2028 6f61 2e66 6974  values = (oa.fit
+000357b0: 6e65 7373 2e76 616c 7565 735b 305d 2c20  ness.values[0], 
+000357c0: 6f62 2e66 6974 6e65 7373 2e76 616c 7565  ob.fitness.value
+000357d0: 735b 305d 290a 2020 2020 2020 2020 2020  s[0]).          
+000357e0: 2020 6f62 2e66 6974 6e65 7373 2e77 6569    ob.fitness.wei
+000357f0: 6768 7473 203d 2028 2d31 2c20 2d31 290a  ghts = (-1, -1).
+00035800: 2020 2020 2020 2020 2020 2020 6f62 2e66              ob.f
+00035810: 6974 6e65 7373 2e76 616c 7565 7320 3d20  itness.values = 
+00035820: 286f 612e 6669 746e 6573 732e 7661 6c75  (oa.fitness.valu
+00035830: 6573 5b30 5d2c 206f 622e 6669 746e 6573  es[0], ob.fitnes
+00035840: 732e 7661 6c75 6573 5b30 5d29 0a20 2020  s.values[0]).   
+00035850: 2020 2020 2072 6574 7572 6e20 706f 7075       return popu
+00035860: 6c61 7469 6f6e 0a0a 2020 2020 6465 6620  lation..    def 
+00035870: 6d69 7875 705f 6576 616c 7561 7469 6f6e  mixup_evaluation
+00035880: 2873 656c 662c 2074 6f6f 6c62 6f78 2c20  (self, toolbox, 
+00035890: 706f 7075 6c61 7469 6f6e 293a 0a20 2020  population):.   
+000358a0: 2020 2020 2073 656c 662e 6669 6e61 6c5f       self.final_
+000358b0: 6d6f 6465 6c5f 6c61 7a79 5f74 7261 696e  model_lazy_train
+000358c0: 696e 6728 706f 7075 6c61 7469 6f6e 290a  ing(population).
+000358d0: 2020 2020 2020 2020 5820 3d20 7365 6c66          X = self
+000358e0: 2e74 6573 745f 580a 2020 2020 2020 2020  .test_X.        
+000358f0: 6966 2073 656c 662e 6e6f 726d 616c 697a  if self.normaliz
+00035900: 653a 0a20 2020 2020 2020 2020 2020 2058  e:.            X
+00035910: 203d 2073 656c 662e 785f 7363 616c 6572   = self.x_scaler
+00035920: 2e74 7261 6e73 666f 726d 2858 290a 2020  .transform(X).  
+00035930: 2020 2020 2020 666f 7220 696e 6469 7669        for indivi
+00035940: 6475 616c 2069 6e20 706f 7075 6c61 7469  dual in populati
+00035950: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
+00035960: 5970 203d 2073 656c 662e 6665 6174 7572  Yp = self.featur
+00035970: 655f 6765 6e65 7261 7469 6f6e 2858 2c20  e_generation(X, 
+00035980: 696e 6469 7669 6475 616c 290a 2020 2020  individual).    
+00035990: 2020 2020 2020 2020 7072 6564 6963 7465          predicte
+000359a0: 6420 3d20 696e 6469 7669 6475 616c 2e70  d = individual.p
+000359b0: 6970 652e 7072 6564 6963 7428 5970 290a  ipe.predict(Yp).
+000359c0: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
+000359d0: 6976 6964 7561 6c2e 6669 746e 6573 732e  ividual.fitness.
+000359e0: 7765 6967 6874 7320 3d20 282d 312c 202d  weights = (-1, -
+000359f0: 3129 0a20 2020 2020 2020 2020 2020 2069  1).            i
+00035a00: 6e64 6976 6964 7561 6c2e 6669 746e 6573  ndividual.fitnes
+00035a10: 732e 7661 6c75 6573 203d 2028 696e 6469  s.values = (indi
+00035a20: 7669 6475 616c 2e66 6974 6e65 7373 2e76  vidual.fitness.v
+00035a30: 616c 7565 735b 305d 2c20 7232 5f73 636f  alues[0], r2_sco
+00035a40: 7265 2873 656c 662e 7073 6575 646f 5f6c  re(self.pseudo_l
+00035a50: 6162 656c 2c20 7072 6564 6963 7465 6429  abel, predicted)
+00035a60: 290a 0a20 2020 2023 2040 7469 6d65 6974  )..    # @timeit
+00035a70: 0a20 2020 2064 6566 2070 6f70 756c 6174  .    def populat
+00035a80: 696f 6e5f 6576 616c 7561 7469 6f6e 2873  ion_evaluation(s
+00035a90: 656c 662c 2074 6f6f 6c62 6f78 2c20 706f  elf, toolbox, po
+00035aa0: 7075 6c61 7469 6f6e 293a 0a20 2020 2020  pulation):.     
+00035ab0: 2020 2022 2222 0a20 2020 2020 2020 203a     """.        :
+00035ac0: 7061 7261 6d20 706f 7075 6c61 7469 6f6e  param population
+00035ad0: 3a20 6120 706f 7075 6c61 7469 6f6e 206f  : a population o
+00035ae0: 6620 4750 2069 6e64 6976 6964 7561 6c73  f GP individuals
+00035af0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+00035b00: 3a20 6576 616c 7561 7465 6420 696e 6469  : evaluated indi
+00035b10: 7669 6475 616c 730a 2020 2020 2020 2020  viduals.        
+00035b20: 2222 220a 2020 2020 2020 2020 2320 696e  """.        # in
+00035b30: 6469 7669 6475 616c 2065 7661 6c75 6174  dividual evaluat
+00035b40: 696f 6e20 7461 736b 7320 6469 7374 7269  ion tasks distri
+00035b50: 6275 7469 6f6e 0a20 2020 2020 2020 2069  bution.        i
+00035b60: 6e76 616c 6964 5f69 6e64 203d 205b 696e  nvalid_ind = [in
+00035b70: 6420 666f 7220 696e 6420 696e 2070 6f70  d for ind in pop
+00035b80: 756c 6174 696f 6e20 6966 206e 6f74 2069  ulation if not i
+00035b90: 6e64 2e66 6974 6e65 7373 2e76 616c 6964  nd.fitness.valid
+00035ba0: 5d0a 2020 2020 2020 2020 6669 746e 6573  ].        fitnes
+00035bb0: 7365 7320 3d20 6c69 7374 2874 6f6f 6c62  ses = list(toolb
+00035bc0: 6f78 2e6d 6170 2874 6f6f 6c62 6f78 2e65  ox.map(toolbox.e
+00035bd0: 7661 6c75 6174 652c 2069 6e76 616c 6964  valuate, invalid
+00035be0: 5f69 6e64 2929 0a0a 2020 2020 2020 2020  _ind))..        
+00035bf0: 2320 6469 7374 7269 6275 7465 2074 6173  # distribute tas
+00035c00: 6b73 0a20 2020 2020 2020 2069 6620 7365  ks.        if se
+00035c10: 6c66 2e6e 5f70 726f 6365 7373 203e 2031  lf.n_process > 1
+00035c20: 3a0a 2020 2020 2020 2020 2020 2020 6461  :.            da
+00035c30: 7461 203d 205b 6e65 7874 2866 2920 666f  ta = [next(f) fo
+00035c40: 7220 6620 696e 2066 6974 6e65 7373 6573  r f in fitnesses
+00035c50: 5d0a 2020 2020 2020 2020 2020 2020 7265  ].            re
+00035c60: 7375 6c74 7320 3d20 6c69 7374 2873 656c  sults = list(sel
+00035c70: 662e 706f 6f6c 2e6d 6170 2863 616c 6375  f.pool.map(calcu
+00035c80: 6c61 7465 5f73 636f 7265 2c20 6461 7461  late_score, data
+00035c90: 2929 0a20 2020 2020 2020 2065 6c73 653a  )).        else:
+00035ca0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+00035cb0: 756c 7473 203d 206c 6973 7428 6d61 7028  ults = list(map(
+00035cc0: 6c61 6d62 6461 2066 3a20 6361 6c63 756c  lambda f: calcul
+00035cd0: 6174 655f 7363 6f72 6528 6e65 7874 2866  ate_score(next(f
+00035ce0: 2929 2c20 6669 746e 6573 7365 7329 290a  )), fitnesses)).
+00035cf0: 0a20 2020 2020 2020 2023 2061 6767 7265  .        # aggre
+00035d00: 6761 7465 2072 6573 756c 7473 0a20 2020  gate results.   
+00035d10: 2020 2020 2066 6f72 2069 6e64 2c20 6669       for ind, fi
+00035d20: 742c 2072 2069 6e20 7a69 7028 696e 7661  t, r in zip(inva
+00035d30: 6c69 645f 696e 642c 2066 6974 6e65 7373  lid_ind, fitness
+00035d40: 6573 2c20 7265 7375 6c74 7329 3a0a 2020  es, results):.  
+00035d50: 2020 2020 2020 2020 2020 7661 6c75 6520            value 
+00035d60: 3d20 6669 742e 7365 6e64 2872 290a 2020  = fit.send(r).  
+00035d70: 2020 2020 2020 2020 2020 696e 642e 6669            ind.fi
+00035d80: 746e 6573 732e 7661 6c75 6573 203d 2076  tness.values = v
+00035d90: 616c 7565 0a0a 2020 2020 2020 2020 2320  alue..        # 
+00035da0: 7570 6461 7469 6e67 2061 6c6c 2070 6172  updating all par
+00035db0: 7469 7469 6f6e 2073 6368 656d 650a 2020  tition scheme.  
+00035dc0: 2020 2020 2020 6966 2073 656c 662e 6261        if self.ba
+00035dd0: 7365 5f6c 6561 726e 6572 203d 3d20 2753  se_learner == 'S
+00035de0: 6f66 742d 504c 5472 6565 2720 616e 6420  oft-PLTree' and 
+00035df0: 7365 6c66 2e73 6861 7265 645f 7061 7274  self.shared_part
+00035e00: 6974 696f 6e5f 7363 6865 6d65 3a0a 2020  ition_scheme:.  
+00035e10: 2020 2020 2020 2020 2020 7061 7274 6974            partit
+00035e20: 696f 6e5f 7363 6865 6d65 203d 206e 702e  ion_scheme = np.
+00035e30: 7a65 726f 7328 2873 656c 662e 582e 7368  zeros((self.X.sh
+00035e40: 6170 655b 305d 2c20 7365 6c66 2e70 6172  ape[0], self.par
+00035e50: 7469 7469 6f6e 5f6e 756d 6265 7229 290a  tition_number)).
+00035e60: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00035e70: 7020 696e 2070 6f70 756c 6174 696f 6e3a  p in population:
+00035e80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00035e90: 2061 7373 6572 7420 702e 7061 7274 6974   assert p.partit
+00035ea0: 696f 6e5f 7363 6865 6d65 2e73 6861 7065  ion_scheme.shape
+00035eb0: 5b30 5d20 3d3d 2073 656c 662e 582e 7368  [0] == self.X.sh
+00035ec0: 6170 655b 305d 0a20 2020 2020 2020 2020  ape[0].         
+00035ed0: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
+00035ee0: 6e28 702e 7061 7274 6974 696f 6e5f 7363  n(p.partition_sc
+00035ef0: 6865 6d65 2e73 6861 7065 2920 3d3d 2031  heme.shape) == 1
+00035f00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00035f10: 2070 2e70 6172 7469 7469 6f6e 5f73 6368   p.partition_sch
+00035f20: 656d 6520 3d20 702e 7061 7274 6974 696f  eme = p.partitio
+00035f30: 6e5f 7363 6865 6d65 2e61 7374 7970 6528  n_scheme.astype(
+00035f40: 696e 7429 0a20 2020 2020 2020 2020 2020  int).           
+00035f50: 2020 2020 2070 6172 7469 7469 6f6e 5f73       partition_s
+00035f60: 6368 656d 655b 6e70 2e61 7261 6e67 6528  cheme[np.arange(
+00035f70: 7365 6c66 2e58 2e73 6861 7065 5b30 5d29  self.X.shape[0])
+00035f80: 2c20 702e 7061 7274 6974 696f 6e5f 7363  , p.partition_sc
+00035f90: 6865 6d65 5d20 2b3d 2031 0a20 2020 2020  heme] += 1.     
+00035fa0: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
+00035fb0: 5f73 6368 656d 6520 3d20 7061 7274 6974  _scheme = partit
+00035fc0: 696f 6e5f 7363 6865 6d65 2e61 7267 6d61  ion_scheme.argma
+00035fd0: 7828 6178 6973 3d31 290a 2020 2020 2020  x(axis=1).      
+00035fe0: 2020 2020 2020 666f 7220 7020 696e 2070        for p in p
+00035ff0: 6f70 756c 6174 696f 6e3a 0a20 2020 2020  opulation:.     
+00036000: 2020 2020 2020 2020 2020 2070 2e70 6172             p.par
+00036010: 7469 7469 6f6e 5f73 6368 656d 6520 3d20  tition_scheme = 
+00036020: 7061 7274 6974 696f 6e5f 7363 6865 6d65  partition_scheme
+00036030: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00036040: 696e 7661 6c69 645f 696e 640a 0a20 2020  invalid_ind..   
+00036050: 2064 6566 2063 6f73 5f73 696d 696c 6172   def cos_similar
+00036060: 6974 795f 6361 6c63 756c 6174 696f 6e28  ity_calculation(
+00036070: 7365 6c66 2c20 706f 7075 6c61 7469 6f6e  self, population
+00036080: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+00036090: 696e 6473 203d 2073 656c 662e 6765 745f  inds = self.get_
+000360a0: 6469 7665 7273 6974 795f 6d61 7472 6978  diversity_matrix
+000360b0: 2870 6f70 756c 6174 696f 6e29 0a20 2020  (population).   
+000360c0: 2020 2020 2069 6620 7365 6c66 2e65 7661       if self.eva
+000360d0: 6c75 6174 696f 6e5f 636f 6e66 6967 7572  luation_configur
+000360e0: 6174 696f 6e2e 6d69 6e69 5f62 6174 6368  ation.mini_batch
+000360f0: 3a0a 2020 2020 2020 2020 2020 2020 696e  :.            in
+00036100: 6473 202d 3d20 7365 6c66 2e67 6574 5f6d  ds -= self.get_m
+00036110: 696e 695f 6261 7463 685f 7928 290a 2020  ini_batch_y().  
+00036120: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00036130: 2020 2020 2020 2020 696e 6473 202d 3d20          inds -= 
+00036140: 7365 6c66 2e79 0a20 2020 2020 2020 2064  self.y.        d
+00036150: 6973 203d 2070 6169 7277 6973 655f 6469  is = pairwise_di
+00036160: 7374 616e 6365 7328 696e 6473 2c20 6d65  stances(inds, me
+00036170: 7472 6963 3d27 636f 7369 6e65 2729 0a20  tric='cosine'). 
+00036180: 2020 2020 2020 2072 6574 7572 6e20 6e70         return np
+00036190: 2e6d 6561 6e28 6469 7329 0a0a 2020 2020  .mean(dis)..    
+000361a0: 6465 6620 6e75 6d62 6572 5f6f 665f 7573  def number_of_us
+000361b0: 6564 5f66 6561 7475 7265 7328 7365 6c66  ed_features(self
+000361c0: 293a 0a20 2020 2020 2020 2070 6f73 7369  ):.        possi
+000361d0: 626c 655f 7465 726d 696e 616c 7320 3d20  ble_terminals = 
+000361e0: 7365 7428 5b74 2e6e 616d 6520 666f 7220  set([t.name for 
+000361f0: 7420 696e 2073 656c 662e 7073 6574 2e74  t in self.pset.t
+00036200: 6572 6d69 6e61 6c73 5b6f 626a 6563 745d  erminals[object]
+00036210: 5d29 0a20 2020 2020 2020 2075 7365 645f  ]).        used_
+00036220: 7465 726d 696e 616c 7320 3d20 7365 7428  terminals = set(
+00036230: 290a 2020 2020 2020 2020 666f 7220 6820  ).        for h 
+00036240: 696e 2073 656c 662e 686f 663a 0a20 2020  in self.hof:.   
+00036250: 2020 2020 2020 2020 2066 6f72 2067 2069           for g i
+00036260: 6e20 682e 6765 6e65 3a0a 2020 2020 2020  n h.gene:.      
+00036270: 2020 2020 2020 2020 2020 666f 7220 7820            for x 
+00036280: 696e 2067 3a0a 2020 2020 2020 2020 2020  in g:.          
+00036290: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
+000362a0: 6e73 7461 6e63 6528 782c 2054 6572 6d69  nstance(x, Termi
+000362b0: 6e61 6c29 2061 6e64 2078 2e6e 616d 6520  nal) and x.name 
+000362c0: 696e 2070 6f73 7369 626c 655f 7465 726d  in possible_term
+000362d0: 696e 616c 733a 0a20 2020 2020 2020 2020  inals:.         
+000362e0: 2020 2020 2020 2020 2020 2020 2020 2075                 u
+000362f0: 7365 645f 7465 726d 696e 616c 732e 6164  sed_terminals.ad
+00036300: 6428 782e 6e61 6d65 290a 2020 2020 2020  d(x.name).      
+00036310: 2020 7265 7475 726e 206c 656e 2875 7365    return len(use
+00036320: 645f 7465 726d 696e 616c 7329 0a0a 2020  d_terminals)..  
+00036330: 2020 6465 6620 6469 7665 7273 6974 795f    def diversity_
+00036340: 6361 6c63 756c 6174 696f 6e28 7365 6c66  calculation(self
+00036350: 2c20 696e 6469 7669 6475 616c 733d 4e6f  , individuals=No
+00036360: 6e65 293a 0a20 2020 2020 2020 2022 2222  ne):.        """
+00036370: 0a20 2020 2020 2020 2043 616c 6375 6c61  .        Calcula
+00036380: 7465 2074 6865 2064 6976 6572 7369 7479  te the diversity
+00036390: 2062 6574 7765 656e 2069 6e64 6976 6964   between individ
+000363a0: 7561 6c73 0a20 2020 2020 2020 2022 2222  uals.        """
+000363b0: 0a20 2020 2020 2020 2069 6620 2743 5627  .        if 'CV'
+000363c0: 2069 6e20 7365 6c66 2e73 636f 7265 5f66   in self.score_f
+000363d0: 756e 633a 0a20 2020 2020 2020 2020 2020  unc:.           
+000363e0: 2072 6574 7572 6e20 300a 2020 2020 2020   return 0.      
+000363f0: 2020 2320 6469 7374 616e 6365 2063 616c    # distance cal
+00036400: 6375 6c61 7469 6f6e 0a20 2020 2020 2020  culation.       
+00036410: 2069 6620 696e 6469 7669 6475 616c 7320   if individuals 
+00036420: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+00036430: 2020 2020 2069 6e64 6976 6964 7561 6c73       individuals
+00036440: 203d 2073 656c 662e 686f 660a 2020 2020   = self.hof.    
+00036450: 2020 2020 6966 2073 656c 662e 7365 636f      if self.seco
+00036460: 6e64 5f6c 6179 6572 2069 6e20 5b27 4e6f  nd_layer in ['No
+00036470: 6e65 272c 204e 6f6e 652c 2027 4341 5750  ne', None, 'CAWP
+00036480: 4527 2c20 2752 6964 6765 2d50 7265 6469  E', 'Ridge-Predi
+00036490: 6374 696f 6e27 2c20 2752 462d 526f 7574  ction', 'RF-Rout
+000364a0: 696e 6727 5d3a 0a20 2020 2020 2020 2020  ing']:.         
+000364b0: 2020 2061 6c6c 5f69 6e64 203d 2069 6e64     all_ind = ind
+000364c0: 6976 6964 7561 6c73 0a20 2020 2020 2020  ividuals.       
+000364d0: 2065 6c69 6620 7365 6c66 2e73 6563 6f6e   elif self.secon
+000364e0: 645f 6c61 7965 7220 696e 205b 2744 6976  d_layer in ['Div
+000364f0: 6572 7369 7479 5072 756e 6527 2c20 2754  ersityPrune', 'T
+00036500: 7265 6542 6173 656c 696e 6527 2c20 2747  reeBaseline', 'G
+00036510: 4127 5d3a 0a20 2020 2020 2020 2020 2020  A']:.           
+00036520: 2023 2077 6974 6820 736f 6d65 2070 7275   # with some pru
+00036530: 6e65 0a20 2020 2020 2020 2020 2020 2069  ne.            i
+00036540: 6620 6e6f 7420 6861 7361 7474 7228 7365  f not hasattr(se
+00036550: 6c66 2c20 2774 7265 655f 7765 6967 6874  lf, 'tree_weight
+00036560: 2729 3a0a 2020 2020 2020 2020 2020 2020  '):.            
+00036570: 2020 2020 7265 7475 726e 2030 0a20 2020      return 0.   
+00036580: 2020 2020 2020 2020 2061 6c6c 5f69 6e64           all_ind
+00036590: 203d 206c 6973 7428 6d61 7028 6c61 6d62   = list(map(lamb
+000365a0: 6461 2078 3a20 785b 315d 2c20 6669 6c74  da x: x[1], filt
+000365b0: 6572 286c 616d 6264 6120 783a 2073 656c  er(lambda x: sel
+000365c0: 662e 7472 6565 5f77 6569 6768 745b 785b  f.tree_weight[x[
+000365d0: 305d 5d20 3e20 302c 2065 6e75 6d65 7261  0]] > 0, enumera
+000365e0: 7465 2869 6e64 6976 6964 7561 6c73 2929  te(individuals))
+000365f0: 2929 0a20 2020 2020 2020 2065 6c73 653a  )).        else:
+00036600: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00036610: 7365 2045 7863 6570 7469 6f6e 0a20 2020  se Exception.   
+00036620: 2020 2020 2069 6e64 7320 3d20 7365 6c66       inds = self
+00036630: 2e67 6574 5f64 6976 6572 7369 7479 5f6d  .get_diversity_m
+00036640: 6174 7269 7828 616c 6c5f 696e 6429 0a20  atrix(all_ind). 
+00036650: 2020 2020 2020 2064 6973 203d 2070 6169         dis = pai
+00036660: 7277 6973 655f 6469 7374 616e 6365 7328  rwise_distances(
+00036670: 696e 6473 290a 2020 2020 2020 2020 7265  inds).        re
+00036680: 7475 726e 206e 702e 6d65 616e 2864 6973  turn np.mean(dis
+00036690: 290a 0a20 2020 2064 6566 2067 6574 5f64  )..    def get_d
+000366a0: 6976 6572 7369 7479 5f6d 6174 7269 7828  iversity_matrix(
+000366b0: 7365 6c66 2c20 616c 6c5f 696e 6429 3a0a  self, all_ind):.
+000366c0: 2020 2020 2020 2020 696e 6473 203d 205b          inds = [
+000366d0: 5d0a 2020 2020 2020 2020 666f 7220 7020  ].        for p 
+000366e0: 696e 2061 6c6c 5f69 6e64 3a0a 2020 2020  in all_ind:.    
+000366f0: 2020 2020 2020 2020 696e 6473 2e61 7070          inds.app
+00036700: 656e 6428 702e 7072 6564 6963 7465 645f  end(p.predicted_
+00036710: 7661 6c75 6573 2e66 6c61 7474 656e 2829  values.flatten()
+00036720: 290a 2020 2020 2020 2020 696e 6473 203d  ).        inds =
+00036730: 206e 702e 6172 7261 7928 696e 6473 290a   np.array(inds).
+00036740: 2020 2020 2020 2020 7265 7475 726e 2069          return i
+00036750: 6e64 730a 0a20 2020 2064 6566 2064 6976  nds..    def div
+00036760: 6572 7369 7479 5f61 7373 6967 6e6d 656e  ersity_assignmen
+00036770: 7428 7365 6c66 2c20 706f 7075 6c61 7469  t(self, populati
+00036780: 6f6e 293a 0a20 2020 2020 2020 2023 2064  on):.        # d
+00036790: 6973 7461 6e63 6520 6361 6c63 756c 6174  istance calculat
+000367a0: 696f 6e0a 2020 2020 2020 2020 696e 6473  ion.        inds
+000367b0: 203d 2073 656c 662e 6765 745f 6469 7665   = self.get_dive
+000367c0: 7273 6974 795f 6d61 7472 6978 2870 6f70  rsity_matrix(pop
+000367d0: 756c 6174 696f 6e29 0a0a 2020 2020 2020  ulation)..      
+000367e0: 2020 686f 665f 696e 6473 203d 205b 5d0a    hof_inds = [].
+000367f0: 2020 2020 2020 2020 706f 7020 3d20 7b0a          pop = {.
+00036800: 2020 2020 2020 2020 2020 2020 2750 6f70              'Pop
+00036810: 273a 2073 656c 662e 706f 702c 0a20 2020  ': self.pop,.   
+00036820: 2020 2020 2020 2020 2027 4172 6368 6976           'Archiv
+00036830: 6527 3a20 7365 6c66 2e68 6f66 2c0a 2020  e': self.hof,.  
+00036840: 2020 2020 2020 2020 2020 2750 6f70 2b41            'Pop+A
+00036850: 7263 6869 7665 273a 206c 6973 7428 7365  rchive': list(se
+00036860: 6c66 2e70 6f70 2920 2b20 6c69 7374 2873  lf.pop) + list(s
+00036870: 656c 662e 686f 6629 2c0a 2020 2020 2020  elf.hof),.      
+00036880: 2020 7d5b 7365 6c66 2e64 6976 6572 7369    }[self.diversi
+00036890: 7479 5f73 6561 7263 685d 0a20 2020 2020  ty_search].     
+000368a0: 2020 2066 6f72 2070 2069 6e20 706f 703a     for p in pop:
+000368b0: 0a20 2020 2020 2020 2020 2020 2068 6f66  .            hof
+000368c0: 5f69 6e64 732e 6170 7065 6e64 2870 2e70  _inds.append(p.p
+000368d0: 7265 6469 6374 6564 5f76 616c 7565 732e  redicted_values.
+000368e0: 666c 6174 7465 6e28 2929 0a20 2020 2020  flatten()).     
+000368f0: 2020 2068 6f66 5f69 6e64 7320 3d20 6e70     hof_inds = np
+00036900: 2e61 7272 6179 2868 6f66 5f69 6e64 7329  .array(hof_inds)
+00036910: 0a20 2020 2020 2020 2066 6f72 2069 6e64  .        for ind
+00036920: 6578 2c20 696e 6420 696e 2065 6e75 6d65  ex, ind in enume
+00036930: 7261 7465 2870 6f70 756c 6174 696f 6e29  rate(population)
+00036940: 3a0a 2020 2020 2020 2020 2020 2020 6469  :.            di
+00036950: 7374 616e 6365 203d 202d 6e70 2e73 7172  stance = -np.sqr
+00036960: 7428 6e70 2e73 756d 2828 696e 6473 5b69  t(np.sum((inds[i
+00036970: 6e64 6578 5d20 2d20 686f 665f 696e 6473  ndex] - hof_inds
+00036980: 2920 2a2a 2032 2c20 6178 6973 3d30 2929  ) ** 2, axis=0))
+00036990: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000369a0: 6c65 6e28 696e 642e 6361 7365 5f76 616c  len(ind.case_val
+000369b0: 7565 7329 203d 3d20 6c65 6e28 7365 6c66  ues) == len(self
+000369c0: 2e79 293a 0a20 2020 2020 2020 2020 2020  .y):.           
+000369d0: 2020 2020 2069 6e64 2e63 6173 655f 7661       ind.case_va
+000369e0: 6c75 6573 203d 206e 702e 636f 6e63 6174  lues = np.concat
+000369f0: 656e 6174 6528 5b69 6e64 2e63 6173 655f  enate([ind.case_
+00036a00: 7661 6c75 6573 2c20 6469 7374 616e 6365  values, distance
+00036a10: 5d2c 2061 7869 733d 3029 0a20 2020 2020  ], axis=0).     
+00036a20: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00036a30: 2020 2020 2020 2020 2020 2020 2069 6e64               ind
+00036a40: 2e63 6173 655f 7661 6c75 6573 5b6c 656e  .case_values[len
+00036a50: 2873 656c 662e 7929 3a5d 203d 2064 6973  (self.y):] = dis
+00036a60: 7461 6e63 650a 0a20 2020 2064 6566 2063  tance..    def c
+00036a70: 6f6d 706c 6578 6974 7928 7365 6c66 293a  omplexity(self):
+00036a80: 0a20 2020 2020 2020 2063 6f75 6e74 203d  .        count =
+00036a90: 2030 0a20 2020 2020 2020 2023 2063 6f75   0.        # cou
+00036aa0: 6e74 2047 5020 636f 6d70 6c65 7869 7479  nt GP complexity
+00036ab0: 0a20 2020 2020 2020 2066 6f72 2068 2069  .        for h i
+00036ac0: 6e20 7365 6c66 2e68 6f66 3a0a 2020 2020  n self.hof:.    
+00036ad0: 2020 2020 2020 2020 683a 204d 756c 7469          h: Multi
+00036ae0: 706c 6547 656e 6547 500a 2020 2020 2020  pleGeneGP.      
+00036af0: 2020 2020 2020 666f 7220 7820 696e 2068        for x in h
+00036b00: 2e67 656e 653a 0a20 2020 2020 2020 2020  .gene:.         
+00036b10: 2020 2020 2020 2063 6f75 6e74 202b 3d20         count += 
+00036b20: 6c65 6e28 7829 0a0a 2020 2020 2020 2020  len(x)..        
+00036b30: 2020 2020 2320 636f 756e 7420 4261 7365      # count Base
+00036b40: 204d 6f64 656c 2043 6f6d 706c 6578 6974   Model Complexit
+00036b50: 790a 2020 2020 2020 2020 2020 2020 6c65  y.            le
+00036b60: 6172 6e65 7220 3d20 682e 7069 7065 5b27  arner = h.pipe['
+00036b70: 5269 6467 6527 5d0a 2020 2020 2020 2020  Ridge'].        
+00036b80: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00036b90: 6528 6c65 6172 6e65 722c 2044 6563 6973  e(learner, Decis
+00036ba0: 696f 6e54 7265 6552 6567 7265 7373 6f72  ionTreeRegressor
+00036bb0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00036bc0: 2020 2063 6f75 6e74 202b 3d20 6c65 6172     count += lear
+00036bd0: 6e65 722e 7472 6565 5f2e 6e6f 6465 5f63  ner.tree_.node_c
+00036be0: 6f75 6e74 0a20 2020 2020 2020 2020 2020  ount.           
+00036bf0: 2069 6620 6973 696e 7374 616e 6365 286c   if isinstance(l
+00036c00: 6561 726e 6572 2c20 536f 6674 504c 5472  earner, SoftPLTr
+00036c10: 6565 5265 6772 6573 736f 7229 3a0a 2020  eeRegressor):.  
+00036c20: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00036c30: 756e 7420 2b3d 206c 6561 726e 6572 2e63  unt += learner.c
+00036c40: 6f6d 706c 6578 6974 7928 290a 2020 2020  omplexity().    
+00036c50: 2020 2020 7265 7475 726e 2063 6f75 6e74      return count
+00036c60: 0a0a 2020 2020 6465 6620 6d6f 6465 6c28  ..    def model(
+00036c70: 7365 6c66 293a 0a20 2020 2020 2020 2061  self):.        a
+00036c80: 7373 6572 7420 6c65 6e28 7365 6c66 2e68  ssert len(self.h
+00036c90: 6f66 2920 3d3d 2031 0a20 2020 2020 2020  of) == 1.       
+00036ca0: 2068 203d 2073 656c 662e 686f 665b 305d   h = self.hof[0]
+00036cb0: 0a20 2020 2020 2020 206c 6561 726e 6572  .        learner
+00036cc0: 3a20 4c69 6e65 6172 4d6f 6465 6c20 3d20  : LinearModel = 
+00036cd0: 682e 7069 7065 5b27 5269 6467 6527 5d0a  h.pipe['Ridge'].
+00036ce0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+00036cf0: 7369 6e73 7461 6e63 6528 6c65 6172 6e65  sinstance(learne
+00036d00: 722c 204c 696e 6561 724d 6f64 656c 290a  r, LinearModel).
+00036d10: 2020 2020 2020 2020 6d6f 6465 6c5f 7374          model_st
+00036d20: 7220 3d20 2727 0a20 2020 2020 2020 2066  r = ''.        f
+00036d30: 6f72 2069 642c 2067 2c20 6320 696e 207a  or id, g, c in z
+00036d40: 6970 2872 616e 6765 2830 2c20 6c65 6e28  ip(range(0, len(
+00036d50: 682e 6765 6e65 2929 2c20 682e 6765 6e65  h.gene)), h.gene
+00036d60: 2c20 6c65 6172 6e65 722e 636f 6566 5f29  , learner.coef_)
+00036d70: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00036d80: 2069 6420 3d3d 2030 3a0a 2020 2020 2020   id == 0:.      
+00036d90: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
+00036da0: 7374 7220 2b3d 2073 7472 2863 2920 2b20  str += str(c) + 
+00036db0: 272a 2720 2b20 6765 6e65 5f74 6f5f 7374  '*' + gene_to_st
+00036dc0: 7269 6e67 2867 290a 2020 2020 2020 2020  ring(g).        
+00036dd0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00036de0: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
+00036df0: 7374 7220 2b3d 2027 2b27 202b 2073 7472  str += '+' + str
+00036e00: 2863 2920 2b20 272a 2720 2b20 6765 6e65  (c) + '*' + gene
+00036e10: 5f74 6f5f 7374 7269 6e67 2867 290a 2020  _to_string(g).  
+00036e20: 2020 2020 2020 6d6f 6465 6c5f 7374 7220        model_str 
+00036e30: 2b3d 2027 2b27 202b 2073 7472 286c 6561  += '+' + str(lea
+00036e40: 726e 6572 2e69 6e74 6572 6365 7074 5f29  rner.intercept_)
+00036e50: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00036e60: 6d6f 6465 6c5f 7374 720a 0a0a 636c 6173  model_str...clas
+00036e70: 7320 4576 6f6c 7574 696f 6e61 7279 466f  s EvolutionaryFo
+00036e80: 7265 7374 436c 6173 7369 6669 6572 2843  restClassifier(C
+00036e90: 6c61 7373 6966 6965 724d 6978 696e 2c20  lassifierMixin, 
+00036ea0: 4576 6f6c 7574 696f 6e61 7279 466f 7265  EvolutionaryFore
+00036eb0: 7374 5265 6772 6573 736f 7229 3a0a 2020  stRegressor):.  
+00036ec0: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
+00036ed0: 656c 662c 2073 636f 7265 5f66 756e 633d  elf, score_func=
+00036ee0: 275a 6572 6f4f 6e65 272c 202a 2a70 6172  'ZeroOne', **par
+00036ef0: 616d 7329 3a0a 2020 2020 2020 2020 7375  ams):.        su
+00036f00: 7065 7228 292e 5f5f 696e 6974 5f5f 2873  per().__init__(s
+00036f10: 636f 7265 5f66 756e 633d 7363 6f72 655f  core_func=score_
+00036f20: 6675 6e63 2c20 2a2a 7061 7261 6d73 290a  func, **params).
+00036f30: 2020 2020 2020 2020 7365 6c66 2e79 5f73          self.y_s
+00036f40: 6361 6c65 7220 3d20 4475 6d6d 7954 7261  caler = DummyTra
+00036f50: 6e73 666f 726d 6572 2829 0a20 2020 2020  nsformer().     
+00036f60: 2020 2069 6620 7365 6c66 2e62 6173 655f     if self.base_
+00036f70: 6c65 6172 6e65 7220 3d3d 2027 4879 6272  learner == 'Hybr
+00036f80: 6964 273a 0a20 2020 2020 2020 2020 2020  id':.           
+00036f90: 2063 6f6e 6669 675f 6469 6374 203d 207b   config_dict = {
+00036fa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00036fb0: 2027 736b 6c65 6172 6e2e 6c69 6e65 6172   'sklearn.linear
+00036fc0: 5f6d 6f64 656c 2e4c 6f67 6973 7469 6352  _model.LogisticR
+00036fd0: 6567 7265 7373 696f 6e27 3a20 7b0a 2020  egression': {.  
+00036fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036ff0: 2020 2770 656e 616c 7479 273a 205b 226c    'penalty': ["l
+00037000: 3222 5d2c 0a20 2020 2020 2020 2020 2020  2"],.           
+00037010: 2020 2020 2020 2020 2027 4327 3a20 5b31           'C': [1
+00037020: 652d 342c 2031 652d 332c 2031 652d 322c  e-4, 1e-3, 1e-2,
+00037030: 2031 652d 312c 2030 2e35 2c20 312e 2c20   1e-1, 0.5, 1., 
+00037040: 352e 2c20 3130 2e2c 2031 352e 2c20 3230  5., 10., 15., 20
+00037050: 2e2c 2032 352e 5d2c 0a20 2020 2020 2020  ., 25.],.       
+00037060: 2020 2020 2020 2020 2020 2020 2027 736f               'so
+00037070: 6c76 6572 273a 205b 276c 6962 6c69 6e65  lver': ['libline
+00037080: 6172 275d 2c0a 2020 2020 2020 2020 2020  ar'],.          
+00037090: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
+000370a0: 2020 2020 2020 2020 2027 736b 6c65 6172           'sklear
+000370b0: 6e2e 7472 6565 2e44 6563 6973 696f 6e54  n.tree.DecisionT
+000370c0: 7265 6543 6c61 7373 6966 6965 7227 3a20  reeClassifier': 
+000370d0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+000370e0: 2020 2020 2020 2763 7269 7465 7269 6f6e        'criterion
+000370f0: 273a 205b 2267 696e 6922 2c20 2265 6e74  ': ["gini", "ent
+00037100: 726f 7079 225d 2c0a 2020 2020 2020 2020  ropy"],.        
+00037110: 2020 2020 2020 2020 2020 2020 276d 6178              'max
+00037120: 5f64 6570 7468 273a 2072 616e 6765 2831  _depth': range(1
+00037130: 2c20 3131 292c 0a20 2020 2020 2020 2020  , 11),.         
+00037140: 2020 2020 2020 2020 2020 2027 6d69 6e5f             'min_
+00037150: 7361 6d70 6c65 735f 7370 6c69 7427 3a20  samples_split': 
+00037160: 7261 6e67 6528 322c 2032 3129 2c0a 2020  range(2, 21),.  
+00037170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037180: 2020 276d 696e 5f73 616d 706c 6573 5f6c    'min_samples_l
+00037190: 6561 6627 3a20 7261 6e67 6528 312c 2032  eaf': range(1, 2
+000371a0: 3129 0a20 2020 2020 2020 2020 2020 2020  1).             
+000371b0: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
+000371c0: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
+000371d0: 7365 6c66 2e74 706f 745f 6d6f 6465 6c20  self.tpot_model 
+000371e0: 3d20 5450 4f54 436c 6173 7369 6669 6572  = TPOTClassifier
+000371f0: 2863 6f6e 6669 675f 6469 6374 3d63 6f6e  (config_dict=con
+00037200: 6669 675f 6469 6374 2c20 7465 6d70 6c61  fig_dict, templa
+00037210: 7465 3d27 436c 6173 7369 6669 6572 2729  te='Classifier')
+00037220: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00037230: 662e 7470 6f74 5f6d 6f64 656c 2e5f 6669  f.tpot_model._fi
+00037240: 745f 696e 6974 2829 0a20 2020 2020 2020  t_init().       
+00037250: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00037260: 2020 2073 656c 662e 7470 6f74 5f6d 6f64     self.tpot_mod
+00037270: 656c 203d 204e 6f6e 650a 0a20 2020 2064  el = None..    d
+00037280: 6566 2067 6574 5f70 6172 616d 7328 7365  ef get_params(se
+00037290: 6c66 2c20 6465 6570 3d54 7275 6529 3a0a  lf, deep=True):.
+000372a0: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
+000372b0: 2073 7570 6572 2829 2e67 6574 5f70 6172   super().get_par
+000372c0: 616d 7328 6465 6570 290a 2020 2020 2020  ams(deep).      
+000372d0: 2020 2320 4861 636b 2074 6f20 6d61 6b65    # Hack to make
+000372e0: 2067 6574 5f70 6172 616d 7320 7265 7475   get_params retu
+000372f0: 726e 2062 6173 6520 636c 6173 7320 7061  rn base class pa
+00037300: 7261 6d73 2e2e 2e0a 2020 2020 2020 2020  rams....        
+00037310: 6370 203d 2063 6f70 792e 636f 7079 2873  cp = copy.copy(s
+00037320: 656c 6629 0a20 2020 2020 2020 2063 702e  elf).        cp.
+00037330: 5f5f 636c 6173 735f 5f20 3d20 4576 6f6c  __class__ = Evol
+00037340: 7574 696f 6e61 7279 466f 7265 7374 5265  utionaryForestRe
+00037350: 6772 6573 736f 720a 2020 2020 2020 2020  gressor.        
+00037360: 7061 7261 6d73 2e75 7064 6174 6528 4576  params.update(Ev
+00037370: 6f6c 7574 696f 6e61 7279 466f 7265 7374  olutionaryForest
+00037380: 5265 6772 6573 736f 722e 6765 745f 7061  Regressor.get_pa
+00037390: 7261 6d73 2863 702c 2064 6565 7029 290a  rams(cp, deep)).
+000373a0: 2020 2020 2020 2020 7265 7475 726e 2070          return p
+000373b0: 6172 616d 730a 0a20 2020 2064 6566 206f  arams..    def o
+000373c0: 6f62 5f65 7272 6f72 2873 656c 662c 2070  ob_error(self, p
+000373d0: 6f70 293a 0a20 2020 2020 2020 2023 2068  op):.        # h
+000373e0: 6f77 2074 6f20 6361 6c63 756c 6174 6520  ow to calculate 
+000373f0: 7468 6520 7072 6564 6963 7469 6f6e 2072  the prediction r
+00037400: 6573 756c 743f 0a20 2020 2020 2020 2063  esult?.        c
+00037410: 6f75 6e74 203d 206e 702e 7a65 726f 7328  ount = np.zeros(
+00037420: 6c65 6e28 7365 6c66 2e79 2929 0a20 2020  len(self.y)).   
+00037430: 2020 2020 2023 2070 7265 6469 6374 696f       # predictio
+00037440: 6e20 3d20 6e70 2e7a 6572 6f73 2828 6c65  n = np.zeros((le
+00037450: 6e28 7365 6c66 2e79 292c 206c 656e 286e  n(self.y), len(n
+00037460: 702e 756e 6971 7565 2873 656c 662e 7929  p.unique(self.y)
+00037470: 2929 290a 2020 2020 2020 2020 7072 6564  ))).        pred
+00037480: 6963 7469 6f6e 203d 206e 702e 6675 6c6c  iction = np.full
+00037490: 2828 6c65 6e28 7365 6c66 2e79 292c 206c  ((len(self.y), l
+000374a0: 656e 286e 702e 756e 6971 7565 2873 656c  en(np.unique(sel
+000374b0: 662e 7929 2929 2c20 302c 2064 7479 7065  f.y))), 0, dtype
+000374c0: 3d6e 702e 666c 6f61 7429 0a20 2020 2020  =np.float).     
+000374d0: 2020 2066 6f72 2069 2c20 7820 696e 2065     for i, x in e
+000374e0: 6e75 6d65 7261 7465 2870 6f70 293a 0a20  numerate(pop):. 
+000374f0: 2020 2020 2020 2020 2020 2069 6e64 6578             index
+00037500: 203d 2078 2e6f 7574 5f6f 665f 6261 670a   = x.out_of_bag.
+00037510: 2020 2020 2020 2020 2020 2020 636f 756e              coun
+00037520: 745b 696e 6465 785d 202b 3d20 310a 2020  t[index] += 1.  
+00037530: 2020 2020 2020 2020 2020 7072 6564 6963            predic
+00037540: 7469 6f6e 5b69 6e64 6578 5d20 2b3d 2078  tion[index] += x
+00037550: 2e6f 6f62 5f70 7265 6469 6374 696f 6e0a  .oob_prediction.
+00037560: 2020 2020 2020 2020 2320 6c61 6265 6c20          # label 
+00037570: 3d20 7374 6174 732e 6d6f 6465 286e 702e  = stats.mode(np.
+00037580: 6172 7261 7928 7072 6564 6963 7469 6f6e  array(prediction
+00037590: 292c 2061 7869 733d 302c 206e 616e 5f70  ), axis=0, nan_p
+000375a0: 6f6c 6963 793d 276f 6d69 7427 295b 305d  olicy='omit')[0]
+000375b0: 2e66 6c61 7474 656e 2829 0a20 2020 2020  .flatten().     
+000375c0: 2020 2063 6c61 7373 6573 203d 2070 6f70     classes = pop
+000375d0: 5b30 5d2e 7069 7065 5b27 5269 6467 6527  [0].pipe['Ridge'
+000375e0: 5d2e 636c 6173 7365 735f 0a20 2020 2020  ].classes_.     
+000375f0: 2020 206c 6162 656c 203d 2063 6c61 7373     label = class
+00037600: 6573 2e74 616b 6528 6e70 2e61 7267 6d61  es.take(np.argma
+00037610: 7828 7072 6564 6963 7469 6f6e 2c20 6178  x(prediction, ax
+00037620: 6973 3d31 292c 2061 7869 733d 3029 0a20  is=1), axis=0). 
+00037630: 2020 2020 2020 2061 6363 7572 6163 7920         accuracy 
+00037640: 3d20 6163 6375 7261 6379 5f73 636f 7265  = accuracy_score
+00037650: 2873 656c 662e 792c 206c 6162 656c 290a  (self.y, label).
+00037660: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00037670: 7665 7262 6f73 653a 0a20 2020 2020 2020  verbose:.       
+00037680: 2020 2020 2070 7269 6e74 2827 6f6f 6220       print('oob 
+00037690: 7363 6f72 6527 2c20 6163 6375 7261 6379  score', accuracy
+000376a0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+000376b0: 2061 6363 7572 6163 790a 0a20 2020 2064   accuracy..    d
+000376c0: 6566 2070 7265 6469 6374 5f70 726f 6261  ef predict_proba
+000376d0: 2873 656c 662c 2058 293a 0a20 2020 2020  (self, X):.     
+000376e0: 2020 2069 6620 7365 6c66 2e6e 6f72 6d61     if self.norma
+000376f0: 6c69 7a65 3a0a 2020 2020 2020 2020 2020  lize:.          
+00037700: 2020 5820 3d20 7365 6c66 2e78 5f73 6361    X = self.x_sca
+00037710: 6c65 722e 7472 616e 7366 6f72 6d28 5829  ler.transform(X)
+00037720: 0a20 2020 2020 2020 2070 7265 6469 6374  .        predict
+00037730: 696f 6e5f 6461 7461 5f73 697a 6520 3d20  ion_data_size = 
+00037740: 582e 7368 6170 655b 305d 0a20 2020 2020  X.shape[0].     
+00037750: 2020 2069 6620 7365 6c66 2e74 6573 745f     if self.test_
+00037760: 6461 7461 5f73 697a 6520 3e20 303a 0a20  data_size > 0:. 
+00037770: 2020 2020 2020 2020 2020 2058 203d 206e             X = n
+00037780: 702e 636f 6e63 6174 656e 6174 6528 5b73  p.concatenate([s
+00037790: 656c 662e 7472 6169 6e58 2c20 585d 290a  elf.trainX, X]).
+000377a0: 2020 2020 2020 2020 7365 6c66 2e66 696e          self.fin
+000377b0: 616c 5f6d 6f64 656c 5f6c 617a 795f 7472  al_model_lazy_tr
+000377c0: 6169 6e69 6e67 2873 656c 662e 686f 6629  aining(self.hof)
+000377d0: 0a20 2020 2020 2020 2073 656c 6563 7469  .        selecti
+000377e0: 6f6e 5f66 6c61 6720 3d20 6e70 2e6f 6e65  on_flag = np.one
+000377f0: 7328 6c65 6e28 7365 6c66 2e68 6f66 292c  s(len(self.hof),
+00037800: 2064 7479 7065 3d62 6f6f 6c29 0a20 2020   dtype=bool).   
+00037810: 2020 2020 2070 7265 6469 6374 696f 6e73       predictions
+00037820: 203d 205b 5d0a 2020 2020 2020 2020 7765   = [].        we
+00037830: 6967 6874 5f6c 6973 7420 3d20 5b5d 0a20  ight_list = []. 
+00037840: 2020 2020 2020 2066 6f72 2069 2c20 696e         for i, in
+00037850: 6469 7669 6475 616c 2069 6e20 656e 756d  dividual in enum
+00037860: 6572 6174 6528 7365 6c66 2e68 6f66 293a  erate(self.hof):
+00037870: 0a20 2020 2020 2020 2020 2020 2066 756e  .            fun
+00037880: 6320 3d20 7365 6c66 2e74 6f6f 6c62 6f78  c = self.toolbox
+00037890: 2e63 6f6d 7069 6c65 2869 6e64 6976 6964  .compile(individ
+000378a0: 7561 6c29 0a20 2020 2020 2020 2020 2020  ual).           
+000378b0: 2059 7020 3d20 7265 7375 6c74 5f63 616c   Yp = result_cal
+000378c0: 6375 6c61 7469 6f6e 2866 756e 632c 2058  culation(func, X
+000378d0: 2c20 7365 6c66 2e6f 7269 6769 6e61 6c5f  , self.original_
+000378e0: 6665 6174 7572 6573 290a 2020 2020 2020  features).      
+000378f0: 2020 2020 2020 6966 2073 656c 662e 7465        if self.te
+00037900: 7374 5f64 6174 615f 7369 7a65 203e 2030  st_data_size > 0
+00037910: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00037920: 2020 5970 203d 2059 705b 2d70 7265 6469    Yp = Yp[-predi
+00037930: 6374 696f 6e5f 6461 7461 5f73 697a 653a  ction_data_size:
+00037940: 5d0a 2020 2020 2020 2020 2020 2020 7072  ].            pr
+00037950: 6564 6963 7465 6420 3d20 696e 6469 7669  edicted = indivi
+00037960: 6475 616c 2e70 6970 652e 7072 6564 6963  dual.pipe.predic
+00037970: 745f 7072 6f62 6128 5970 290a 0a20 2020  t_proba(Yp)..   
+00037980: 2020 2020 2020 2020 2069 6620 6861 7361           if hasa
+00037990: 7474 7228 7365 6c66 2e68 6f66 2c20 276c  ttr(self.hof, 'l
+000379a0: 6f73 735f 6675 6e63 7469 6f6e 2729 2061  oss_function') a
+000379b0: 6e64 2073 656c 662e 686f 662e 6c6f 7373  nd self.hof.loss
+000379c0: 5f66 756e 6374 696f 6e20 3d3d 2027 5a65  _function == 'Ze
+000379d0: 726f 4f6e 6527 3a0a 2020 2020 2020 2020  roOne':.        
+000379e0: 2020 2020 2020 2020 2320 7a65 726f 2d6f          # zero-o
+000379f0: 6e65 206c 6f73 730a 2020 2020 2020 2020  ne loss.        
+00037a00: 2020 2020 2020 2020 6172 676d 6178 203d          argmax =
+00037a10: 206e 702e 6172 676d 6178 2870 7265 6469   np.argmax(predi
+00037a20: 6374 6564 2c20 6178 6973 3d31 290a 2020  cted, axis=1).  
+00037a30: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+00037a40: 6564 6963 7465 645b 3a5d 203d 2030 0a20  edicted[:] = 0. 
+00037a50: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00037a60: 7265 6469 6374 6564 5b6e 702e 6172 616e  redicted[np.aran
+00037a70: 6765 2830 2c20 6c65 6e28 7072 6564 6963  ge(0, len(predic
+00037a80: 7465 6429 292c 2061 7267 6d61 785d 203d  ted)), argmax] =
+00037a90: 2031 0a0a 2020 2020 2020 2020 2020 2020   1..            
+00037aa0: 6966 206e 6f74 206e 702e 616c 6c28 6e70  if not np.all(np
+00037ab0: 2e69 7366 696e 6974 6528 7072 6564 6963  .isfinite(predic
+00037ac0: 7465 6429 293a 0a20 2020 2020 2020 2020  ted)):.         
+00037ad0: 2020 2020 2020 2023 2073 6b69 7020 7072         # skip pr
+00037ae0: 6564 6963 7469 6f6e 2072 6573 756c 7473  ediction results
+00037af0: 2063 6f6e 7461 696e 696e 6720 4e61 4e0a   containing NaN.
+00037b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037b10: 7365 6c65 6374 696f 6e5f 666c 6167 5b69  selection_flag[i
+00037b20: 5d20 3d20 4661 6c73 650a 2020 2020 2020  ] = False.      
+00037b30: 2020 2020 2020 2020 2020 636f 6e74 696e            contin
+00037b40: 7565 0a20 2020 2020 2020 2020 2020 2070  ue.            p
+00037b50: 7265 6469 6374 696f 6e73 2e61 7070 656e  redictions.appen
+00037b60: 6428 7072 6564 6963 7465 6429 0a20 2020  d(predicted).   
+00037b70: 2020 2020 2020 2020 2069 6620 6861 7361           if hasa
+00037b80: 7474 7228 7365 6c66 2e68 6f66 2c20 2765  ttr(self.hof, 'e
+00037b90: 6e73 656d 626c 655f 7765 6967 6874 2729  nsemble_weight')
+00037ba0: 2061 6e64 206c 656e 2873 656c 662e 686f   and len(self.ho
+00037bb0: 662e 656e 7365 6d62 6c65 5f77 6569 6768  f.ensemble_weigh
+00037bc0: 7429 203e 2030 3a0a 2020 2020 2020 2020  t) > 0:.        
+00037bd0: 2020 2020 2020 2020 7765 6967 6874 5f6c          weight_l
+00037be0: 6973 742e 6170 7065 6e64 2873 656c 662e  ist.append(self.
+00037bf0: 686f 662e 656e 7365 6d62 6c65 5f77 6569  hof.ensemble_wei
+00037c00: 6768 745b 696e 6469 7669 6475 616c 5f74  ght[individual_t
+00037c10: 6f5f 7475 706c 6528 696e 6469 7669 6475  o_tuple(individu
+00037c20: 616c 295d 290a 0a20 2020 2020 2020 2069  al)])..        i
+00037c30: 6620 7365 6c66 2e73 6563 6f6e 645f 6c61  f self.second_la
+00037c40: 7965 7220 213d 2027 4e6f 6e65 2720 616e  yer != 'None' an
+00037c50: 6420 7365 6c66 2e73 6563 6f6e 645f 6c61  d self.second_la
+00037c60: 7965 7220 213d 204e 6f6e 653a 0a20 2020  yer != None:.   
+00037c70: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+00037c80: 6c65 6e28 7365 6c66 2e68 6f66 2920 3d3d  len(self.hof) ==
+00037c90: 206c 656e 2873 656c 662e 7472 6565 5f77   len(self.tree_w
+00037ca0: 6569 6768 7429 0a20 2020 2020 2020 2020  eight).         
+00037cb0: 2020 2070 7265 6469 6374 696f 6e73 203d     predictions =
+00037cc0: 206e 702e 6172 7261 7928 7072 6564 6963   np.array(predic
+00037cd0: 7469 6f6e 7329 2e54 0a20 2020 2020 2020  tions).T.       
+00037ce0: 2020 2020 2072 6574 7572 6e20 2870 7265       return (pre
+00037cf0: 6469 6374 696f 6e73 2040 2073 656c 662e  dictions @ self.
+00037d00: 7472 6565 5f77 6569 6768 745b 7365 6c65  tree_weight[sele
+00037d10: 6374 696f 6e5f 666c 6167 5d29 2e54 0a20  ction_flag]).T. 
+00037d20: 2020 2020 2020 2065 6c69 6620 6c65 6e28         elif len(
+00037d30: 7765 6967 6874 5f6c 6973 7429 203e 2030  weight_list) > 0
+00037d40: 3a0a 2020 2020 2020 2020 2020 2020 7072  :.            pr
+00037d50: 6564 6963 7469 6f6e 7320 3d20 6e70 2e61  edictions = np.a
+00037d60: 7272 6179 2870 7265 6469 6374 696f 6e73  rray(predictions
+00037d70: 292e 540a 2020 2020 2020 2020 2020 2020  ).T.            
+00037d80: 7765 6967 6874 5f6c 6973 7420 3d20 6e70  weight_list = np
+00037d90: 2e61 7272 6179 2877 6569 6768 745f 6c69  .array(weight_li
+00037da0: 7374 290a 2020 2020 2020 2020 2020 2020  st).            
+00037db0: 7265 7475 726e 2028 7072 6564 6963 7469  return (predicti
+00037dc0: 6f6e 7320 4020 2877 6569 6768 745f 6c69  ons @ (weight_li
+00037dd0: 7374 202f 2077 6569 6768 745f 6c69 7374  st / weight_list
+00037de0: 2e73 756d 2829 2929 2e54 0a20 2020 2020  .sum())).T.     
+00037df0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00037e00: 2020 2020 2072 6574 7572 6e20 6e70 2e6d       return np.m
+00037e10: 6561 6e28 7072 6564 6963 7469 6f6e 732c  ean(predictions,
+00037e20: 2061 7869 733d 3029 0a0a 2020 2020 6465   axis=0)..    de
+00037e30: 6620 6c61 7a79 5f69 6e69 7428 7365 6c66  f lazy_init(self
+00037e40: 2c20 7829 3a0a 2020 2020 2020 2020 2320  , x):.        # 
+00037e50: 656e 636f 6469 6e67 2074 6172 6765 7420  encoding target 
+00037e60: 6c61 6265 6c73 0a20 2020 2020 2020 2073  labels.        s
+00037e70: 656c 662e 6c61 6265 6c5f 656e 636f 6465  elf.label_encode
+00037e80: 7220 3d20 4f6e 6548 6f74 456e 636f 6465  r = OneHotEncode
+00037e90: 7228 7370 6172 7365 3d46 616c 7365 290a  r(sparse=False).
+00037ea0: 2020 2020 2020 2020 7365 6c66 2e6c 6162          self.lab
+00037eb0: 656c 5f65 6e63 6f64 6572 2e66 6974 2873  el_encoder.fit(s
+00037ec0: 656c 662e 792e 7265 7368 6170 6528 2d31  elf.y.reshape(-1
+00037ed0: 2c20 3129 290a 2020 2020 2020 2020 7375  , 1)).        su
+00037ee0: 7065 7228 292e 6c61 7a79 5f69 6e69 7428  per().lazy_init(
+00037ef0: 7829 0a20 2020 2020 2020 2069 6620 7365  x).        if se
+00037f00: 6c66 2e63 6c61 7373 5f77 6569 6768 7420  lf.class_weight 
+00037f10: 3d3d 2027 4261 6c61 6e63 6564 273a 0a20  == 'Balanced':. 
+00037f20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00037f30: 636c 6173 735f 7765 6967 6874 203d 2063  class_weight = c
+00037f40: 6f6d 7075 7465 5f73 616d 706c 655f 7765  ompute_sample_we
+00037f50: 6967 6874 2863 6c61 7373 5f77 6569 6768  ight(class_weigh
+00037f60: 743d 2762 616c 616e 6365 6427 2c20 793d  t='balanced', y=
+00037f70: 7365 6c66 2e79 290a 2020 2020 2020 2020  self.y).        
+00037f80: 2020 2020 6966 2068 6173 6174 7472 2873      if hasattr(s
+00037f90: 656c 662e 686f 662c 2027 636c 6173 735f  elf.hof, 'class_
+00037fa0: 7765 6967 6874 2729 3a0a 2020 2020 2020  weight'):.      
+00037fb0: 2020 2020 2020 2020 2020 7365 6c66 2e68            self.h
+00037fc0: 6f66 2e63 6c61 7373 5f77 6569 6768 7420  of.class_weight 
+00037fd0: 3d20 6e70 2e72 6573 6861 7065 2873 656c  = np.reshape(sel
+00037fe0: 662e 636c 6173 735f 7765 6967 6874 2c20  f.class_weight, 
+00037ff0: 282d 312c 2031 2929 0a20 2020 2020 2020  (-1, 1)).       
+00038000: 2069 6620 6861 7361 7474 7228 7365 6c66   if hasattr(self
+00038010: 2e68 6f66 2c20 2774 6173 6b5f 7479 7065  .hof, 'task_type
+00038020: 2729 3a0a 2020 2020 2020 2020 2020 2020  '):.            
+00038030: 7365 6c66 2e68 6f66 2e74 6173 6b5f 7479  self.hof.task_ty
+00038040: 7065 203d 2027 436c 6173 7369 6669 6361  pe = 'Classifica
+00038050: 7469 6f6e 270a 2020 2020 2020 2020 6966  tion'.        if
+00038060: 2069 7369 6e73 7461 6e63 6528 7365 6c66   isinstance(self
+00038070: 2e68 6f66 2c20 456e 7365 6d62 6c65 5365  .hof, EnsembleSe
+00038080: 6c65 6374 696f 6e48 616c 6c4f 6646 616d  lectionHallOfFam
+00038090: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+000380a0: 7365 6c66 2e68 6f66 2e63 6174 6567 6f72  self.hof.categor
+000380b0: 6965 7320 3d20 6c65 6e28 6e70 2e75 6e69  ies = len(np.uni
+000380c0: 7175 6528 7365 6c66 2e79 2929 0a20 2020  que(self.y)).   
+000380d0: 2020 2020 2020 2020 2073 656c 662e 686f           self.ho
+000380e0: 662e 6c61 6265 6c20 3d20 7365 6c66 2e6c  f.label = self.l
+000380f0: 6162 656c 5f65 6e63 6f64 6572 2e74 7261  abel_encoder.tra
+00038100: 6e73 666f 726d 2873 656c 662e 792e 7265  nsform(self.y.re
+00038110: 7368 6170 6528 2d31 2c20 3129 290a 0a20  shape(-1, 1)).. 
+00038120: 2020 2064 6566 2065 6e74 726f 7079 5f63     def entropy_c
+00038130: 616c 6375 6c61 7469 6f6e 2873 656c 6629  alculation(self)
+00038140: 3a0a 2020 2020 2020 2020 6966 2073 656c  :.        if sel
+00038150: 662e 7363 6f72 655f 6675 6e63 203d 3d20  f.score_func == 
+00038160: 274e 6f76 656c 7479 5365 6172 6368 273a  'NoveltySearch':
+00038170: 0a20 2020 2020 2020 2020 2020 2065 6e73  .            ens
+00038180: 656d 626c 655f 7661 6c75 6520 3d20 6e70  emble_value = np
+00038190: 2e6d 6561 6e28 5b78 2e70 7265 6469 6374  .mean([x.predict
+000381a0: 6564 5f76 616c 7565 7320 666f 7220 7820  ed_values for x 
+000381b0: 696e 2073 656c 662e 686f 665d 2c0a 2020  in self.hof],.  
+000381c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000381d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000381e0: 2020 2061 7869 733d 3029 0a20 2020 2020     axis=0).     
+000381f0: 2020 2020 2020 2073 656c 662e 656e 7365         self.ense
+00038200: 6d62 6c65 5f76 616c 7565 203d 2065 6e73  mble_value = ens
+00038210: 656d 626c 655f 7661 6c75 650a 2020 2020  emble_value.    
+00038220: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00038230: 656c 662e 656e 7365 6d62 6c65 5f76 616c  elf.ensemble_val
+00038240: 7565 0a0a 2020 2020 6465 6620 6361 6c63  ue..    def calc
+00038250: 756c 6174 655f 6361 7365 5f76 616c 7565  ulate_case_value
+00038260: 7328 7365 6c66 2c20 696e 6469 7669 6475  s(self, individu
+00038270: 616c 2c20 592c 2079 5f70 7265 6429 3a0a  al, Y, y_pred):.
+00038280: 2020 2020 2020 2020 2320 4d69 6e69 6d69          # Minimi
+00038290: 7a65 2066 6974 6e65 7373 2076 616c 7565  ze fitness value
+000382a0: 730a 2020 2020 2020 2020 6966 2073 656c  s.        if sel
+000382b0: 662e 7363 6f72 655f 6675 6e63 203d 3d20  f.score_func == 
+000382c0: 274e 6f76 656c 7479 5365 6172 6368 273a  'NoveltySearch':
+000382d0: 0a20 2020 2020 2020 2020 2020 2059 203d  .            Y =
+000382e0: 2073 656c 662e 6c61 6265 6c5f 656e 636f   self.label_enco
+000382f0: 6465 722e 7472 616e 7366 6f72 6d28 592e  der.transform(Y.
+00038300: 7265 7368 6170 6528 2d31 2c20 3129 290a  reshape(-1, 1)).
+00038310: 0a20 2020 2020 2020 2023 2073 6d61 6c6c  .        # small
+00038320: 6572 2069 7320 6265 7474 6572 0a20 2020  er is better.   
+00038330: 2020 2020 2069 6620 7365 6c66 2e73 636f       if self.sco
+00038340: 7265 5f66 756e 6320 3d3d 2027 5a65 726f  re_func == 'Zero
+00038350: 4f6e 6527 206f 7220 7365 6c66 2e73 636f  One' or self.sco
+00038360: 7265 5f66 756e 6320 3d3d 2027 5a65 726f  re_func == 'Zero
+00038370: 4f6e 652d 4e6f 6465 436f 756e 7427 3a0a  One-NodeCount':.
+00038380: 2020 2020 2020 2020 2020 2020 696e 6469              indi
+00038390: 7669 6475 616c 2e63 6173 655f 7661 6c75  vidual.case_valu
+000383a0: 6573 203d 202d 3120 2a20 2879 5f70 7265  es = -1 * (y_pre
+000383b0: 642e 666c 6174 7465 6e28 2920 3d3d 2059  d.flatten() == Y
+000383c0: 2e66 6c61 7474 656e 2829 290a 2020 2020  .flatten()).    
+000383d0: 2020 2020 656c 6966 2073 656c 662e 7363      elif self.sc
+000383e0: 6f72 655f 6675 6e63 203d 3d20 2743 4446  ore_func == 'CDF
+000383f0: 4327 3a0a 2020 2020 2020 2020 2020 2020  C':.            
+00038400: 6d61 7472 6978 203d 2063 6f6e 6675 7369  matrix = confusi
+00038410: 6f6e 5f6d 6174 7269 7828 592e 666c 6174  on_matrix(Y.flat
+00038420: 7465 6e28 292c 2079 5f70 7265 642e 666c  ten(), y_pred.fl
+00038430: 6174 7465 6e28 2929 0a20 2020 2020 2020  atten()).       
+00038440: 2020 2020 2073 636f 7265 203d 206d 6174       score = mat
+00038450: 7269 782e 6469 6167 6f6e 616c 2829 202f  rix.diagonal() /
+00038460: 206d 6174 7269 782e 7375 6d28 6178 6973   matrix.sum(axis
+00038470: 3d31 290a 2020 2020 2020 2020 2020 2020  =1).            
+00038480: 696e 6469 7669 6475 616c 2e63 6173 655f  individual.case_
+00038490: 7661 6c75 6573 203d 202d 3120 2a20 7363  values = -1 * sc
+000384a0: 6f72 650a 2020 2020 2020 2020 656c 6966  ore.        elif
+000384b0: 2073 656c 662e 7363 6f72 655f 6675 6e63   self.score_func
+000384c0: 203d 3d20 2743 726f 7373 456e 7472 6f70   == 'CrossEntrop
+000384d0: 7927 206f 7220 7365 6c66 2e73 636f 7265  y' or self.score
+000384e0: 5f66 756e 6320 3d3d 2027 4e6f 7665 6c74  _func == 'Novelt
+000384f0: 7953 6561 7263 6827 3a0a 2020 2020 2020  ySearch':.      
+00038500: 2020 2020 2020 6f6e 655f 686f 745f 7461        one_hot_ta
+00038510: 7267 6574 7320 3d20 4f6e 6548 6f74 456e  rgets = OneHotEn
+00038520: 636f 6465 7228 7370 6172 7365 3d46 616c  coder(sparse=Fal
+00038530: 7365 292e 6669 745f 7472 616e 7366 6f72  se).fit_transfor
+00038540: 6d28 7365 6c66 2e79 2e72 6573 6861 7065  m(self.y.reshape
+00038550: 282d 312c 2031 2929 0a20 2020 2020 2020  (-1, 1)).       
+00038560: 2020 2020 2065 7073 203d 2031 652d 3135       eps = 1e-15
+00038570: 0a20 2020 2020 2020 2020 2020 2023 2043  .            # C
+00038580: 726f 7373 2065 6e74 726f 7079 0a20 2020  ross entropy.   
+00038590: 2020 2020 2020 2020 2069 6e64 6976 6964           individ
+000385a0: 7561 6c2e 6361 7365 5f76 616c 7565 7320  ual.case_values 
+000385b0: 3d20 2d31 202a 206e 702e 7375 6d28 6f6e  = -1 * np.sum(on
+000385c0: 655f 686f 745f 7461 7267 6574 7320 2a20  e_hot_targets * 
+000385d0: 6e70 2e6c 6f67 286e 702e 636c 6970 2879  np.log(np.clip(y
+000385e0: 5f70 7265 642c 2065 7073 2c20 3120 2d20  _pred, eps, 1 - 
+000385f0: 6570 7329 292c 2061 7869 733d 3129 0a20  eps)), axis=1). 
+00038600: 2020 2020 2020 2020 2020 2061 7373 6572             asser
+00038610: 7420 6e6f 7420 6e70 2e61 6e79 286e 702e  t not np.any(np.
+00038620: 6973 6e61 6e28 696e 6469 7669 6475 616c  isnan(individual
+00038630: 2e63 6173 655f 7661 6c75 6573 2929 2c20  .case_values)), 
+00038640: 7361 7665 5f61 7272 6179 2869 6e64 6976  save_array(indiv
+00038650: 6964 7561 6c2e 6361 7365 5f76 616c 7565  idual.case_value
+00038660: 7329 0a20 2020 2020 2020 2020 2020 2061  s).            a
+00038670: 7373 6572 7420 6e70 2e73 697a 6528 696e  ssert np.size(in
+00038680: 6469 7669 6475 616c 2e63 6173 655f 7661  dividual.case_va
+00038690: 6c75 6573 2920 3d3d 206e 702e 7369 7a65  lues) == np.size
+000386a0: 2873 656c 662e 7929 0a20 2020 2020 2020  (self.y).       
+000386b0: 2065 6c69 6620 2743 5627 2069 6e20 7365   elif 'CV' in se
+000386c0: 6c66 2e73 636f 7265 5f66 756e 633a 0a20  lf.score_func:. 
+000386d0: 2020 2020 2020 2020 2020 2069 6e64 6976             indiv
+000386e0: 6964 7561 6c2e 6361 7365 5f76 616c 7565  idual.case_value
+000386f0: 7320 3d20 2d31 202a 2079 5f70 7265 640a  s = -1 * y_pred.
+00038700: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00038710: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00038720: 4578 6365 7074 696f 6e0a 0a20 2020 2020  Exception..     
+00038730: 2020 2069 6620 7365 6c66 2e73 636f 7265     if self.score
+00038740: 5f66 756e 6320 3d3d 2027 4e6f 7665 6c74  _func == 'Novelt
+00038750: 7953 6561 7263 6827 3a0a 2020 2020 2020  ySearch':.      
+00038760: 2020 2020 2020 696e 6469 7669 6475 616c        individual
+00038770: 2e6f 7269 6769 6e61 6c5f 6361 7365 5f76  .original_case_v
+00038780: 616c 7565 7320 3d20 696e 6469 7669 6475  alues = individu
+00038790: 616c 2e63 6173 655f 7661 6c75 6573 0a20  al.case_values. 
+000387a0: 2020 2020 2020 2020 2020 2023 204b 4c2d             # KL-
+000387b0: 4469 7665 7267 656e 6365 2066 6f72 2072  Divergence for r
+000387c0: 6567 756c 6172 697a 6174 696f 6e0a 2020  egularization.  
+000387d0: 2020 2020 2020 2020 2020 6966 206c 656e            if len
+000387e0: 2873 656c 662e 686f 6629 2021 3d20 303a  (self.hof) != 0:
+000387f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00038800: 2022 2222 0a20 2020 2020 2020 2020 2020   """.           
+00038810: 2020 2020 2043 6f6f 7065 7261 7469 6f6e       Cooperation
+00038820: 2076 7320 4469 7665 7273 6974 793a 0a20   vs Diversity:. 
+00038830: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00038840: 4469 7665 7273 6974 7920 7769 7468 2043  Diversity with C
+00038850: 6f6f 7065 7261 7469 6f6e 3a20 456e 7365  ooperation: Ense
+00038860: 6d62 6c65 204d 6574 686f 6473 2066 6f72  mble Methods for
+00038870: 2046 6577 2d53 686f 7420 436c 6173 7369   Few-Shot Classi
+00038880: 6669 6361 7469 6f6e 2220 4943 4356 2032  fication" ICCV 2
+00038890: 3031 390a 2020 2020 2020 2020 2020 2020  019.            
+000388a0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000388b0: 2020 2020 2020 2020 656e 7365 6d62 6c65          ensemble
+000388c0: 5f76 616c 7565 203d 2073 656c 662e 656e  _value = self.en
+000388d0: 7365 6d62 6c65 5f76 616c 7565 0a20 2020  semble_value.   
+000388e0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000388f0: 7365 6c66 2e64 6976 6572 7369 7479 5f6d  self.diversity_m
+00038900: 6574 7269 6320 3d3d 2027 436f 7369 6e65  etric == 'Cosine
+00038910: 5369 6d69 6c61 7269 7479 273a 0a20 2020  Similarity':.   
+00038920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038930: 2023 2063 6f73 696e 6520 7369 6d69 6c61   # cosine simila
+00038940: 7269 7479 0a20 2020 2020 2020 2020 2020  rity.           
+00038950: 2020 2020 2020 2020 2023 206c 6172 6765           # large
+00038960: 7220 696e 6469 6361 7465 7320 7369 6d69  r indicates simi
+00038970: 6c61 720a 2020 2020 2020 2020 2020 2020  lar.            
+00038980: 2020 2020 2020 2020 6570 7320 3d20 3165          eps = 1e
+00038990: 2d31 350a 2020 2020 2020 2020 2020 2020  -15.            
+000389a0: 2020 2020 2020 2020 616d 6269 6775 6974          ambiguit
+000389b0: 7920 3d20 6e70 2e73 756d 2828 795f 7072  y = np.sum((y_pr
+000389c0: 6564 202a 2065 6e73 656d 626c 655f 7661  ed * ensemble_va
+000389d0: 6c75 6529 2c20 6178 6973 3d31 2920 2f20  lue), axis=1) / 
+000389e0: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
+000389f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038a00: 2020 6e70 2e6d 6178 696d 756d 286e 6f72    np.maximum(nor
+00038a10: 6d28 795f 7072 6564 2c20 6178 6973 3d31  m(y_pred, axis=1
+00038a20: 2920 2a20 6e6f 726d 2865 6e73 656d 626c  ) * norm(ensembl
+00038a30: 655f 7661 6c75 652c 2061 7869 733d 3129  e_value, axis=1)
+00038a40: 2c20 6570 7329 0a20 2020 2020 2020 2020  , eps).         
+00038a50: 2020 2020 2020 2020 2020 2061 7373 6572             asser
+00038a60: 7420 6e6f 7420 286e 702e 6973 6e61 6e28  t not (np.isnan(
+00038a70: 616d 6269 6775 6974 7929 2e61 6e79 2829  ambiguity).any()
+00038a80: 206f 7220 6e70 2e69 7369 6e66 2861 6d62   or np.isinf(amb
+00038a90: 6967 7569 7479 292e 616e 7928 2929 2c20  iguity).any()), 
+00038aa0: 7361 7665 5f61 7272 6179 2828 616d 6269  save_array((ambi
+00038ab0: 6775 6974 792c 2079 5f70 7265 642c 0a20  guity, y_pred,. 
+00038ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038b20: 2020 2020 656e 7365 6d62 6c65 5f76 616c      ensemble_val
+00038b30: 7565 2929 0a20 2020 2020 2020 2020 2020  ue)).           
+00038b40: 2020 2020 2065 6c69 6620 7365 6c66 2e64       elif self.d
+00038b50: 6976 6572 7369 7479 5f6d 6574 7269 6320  iversity_metric 
+00038b60: 3d3d 2027 4b4c 2d44 6976 6572 6765 6e63  == 'KL-Divergenc
+00038b70: 6527 3a0a 2020 2020 2020 2020 2020 2020  e':.            
+00038b80: 2020 2020 2020 2020 2320 736d 616c 6c65          # smalle
+00038b90: 7220 696e 6469 6361 7465 7320 7369 6d69  r indicates simi
+00038ba0: 6c61 720a 2020 2020 2020 2020 2020 2020  lar.            
+00038bb0: 2020 2020 2020 2020 6b6c 5f64 6976 6572          kl_diver
+00038bc0: 6765 6e63 6520 3d20 6c61 6d62 6461 2061  gence = lambda a
+00038bd0: 2c20 623a 206e 702e 7375 6d28 6e70 2e6e  , b: np.sum(np.n
+00038be0: 616e 5f74 6f5f 6e75 6d28 6120 2a20 6e70  an_to_num(a * np
+00038bf0: 2e6c 6f67 2861 202f 2062 292c 2070 6f73  .log(a / b), pos
+00038c00: 696e 663d 302c 206e 6567 696e 663d 3029  inf=0, neginf=0)
+00038c10: 2c20 6178 6973 3d31 290a 2020 2020 2020  , axis=1).      
+00038c20: 2020 2020 2020 2020 2020 2020 2020 616d                am
+00038c30: 6269 6775 6974 7920 3d20 286b 6c5f 6469  biguity = (kl_di
+00038c40: 7665 7267 656e 6365 2879 5f70 7265 642c  vergence(y_pred,
+00038c50: 2065 6e73 656d 626c 655f 7661 6c75 6529   ensemble_value)
+00038c60: 202b 206b 6c5f 6469 7665 7267 656e 6365   + kl_divergence
+00038c70: 2865 6e73 656d 626c 655f 7661 6c75 652c  (ensemble_value,
+00038c80: 2079 5f70 7265 6429 2920 2f20 320a 2020   y_pred)) / 2.  
+00038c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038ca0: 2020 6173 7365 7274 206e 6f74 2028 6e70    assert not (np
+00038cb0: 2e69 736e 616e 2861 6d62 6967 7569 7479  .isnan(ambiguity
+00038cc0: 292e 616e 7928 2920 6f72 206e 702e 6973  ).any() or np.is
+00038cd0: 696e 6628 616d 6269 6775 6974 7929 2e61  inf(ambiguity).a
+00038ce0: 6e79 2829 292c 2073 6176 655f 6172 7261  ny()), save_arra
+00038cf0: 7928 2861 6d62 6967 7569 7479 2c20 795f  y((ambiguity, y_
+00038d00: 7072 6564 2c0a 2020 2020 2020 2020 2020  pred,.          
+00038d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038d60: 2020 2020 2020 2020 2020 2065 6e73 656d             ensem
+00038d70: 626c 655f 7661 6c75 6529 290a 2020 2020  ble_value)).    
+00038d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038d90: 616d 6269 6775 6974 7920 2a3d 202d 310a  ambiguity *= -1.
+00038da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038db0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00038dc0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00038dd0: 4578 6365 7074 696f 6e0a 2020 2020 2020  Exception.      
+00038de0: 2020 2020 2020 2020 2020 616d 6269 6775            ambigu
+00038df0: 6974 7920 2a3d 2073 656c 662e 6e6f 7665  ity *= self.nove
+00038e00: 6c74 795f 7765 6967 6874 0a20 2020 2020  lty_weight.     
+00038e10: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00038e20: 6c66 2e65 6e73 656d 626c 655f 636f 6f70  lf.ensemble_coop
+00038e30: 6572 6174 696f 6e3a 0a20 2020 2020 2020  eration:.       
+00038e40: 2020 2020 2020 2020 2020 2020 2069 6e64               ind
+00038e50: 6976 6964 7561 6c2e 6361 7365 5f76 616c  ividual.case_val
+00038e60: 7565 7320 3d20 696e 6469 7669 6475 616c  ues = individual
+00038e70: 2e63 6173 655f 7661 6c75 6573 202d 2061  .case_values - a
+00038e80: 6d62 6967 7569 7479 0a20 2020 2020 2020  mbiguity.       
+00038e90: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00038ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038eb0: 2020 2069 6e64 6976 6964 7561 6c2e 6361     individual.ca
+00038ec0: 7365 5f76 616c 7565 7320 3d20 696e 6469  se_values = indi
+00038ed0: 7669 6475 616c 2e63 6173 655f 7661 6c75  vidual.case_valu
+00038ee0: 6573 202b 2061 6d62 6967 7569 7479 0a20  es + ambiguity. 
+00038ef0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00038f00: 7373 6572 7420 6e6f 7420 286e 702e 6973  ssert not (np.is
+00038f10: 6e61 6e28 696e 6469 7669 6475 616c 2e63  nan(individual.c
+00038f20: 6173 655f 7661 6c75 6573 292e 616e 7928  ase_values).any(
+00038f30: 2920 6f72 206e 702e 6973 696e 6628 696e  ) or np.isinf(in
+00038f40: 6469 7669 6475 616c 2e63 6173 655f 7661  dividual.case_va
+00038f50: 6c75 6573 292e 616e 7928 2929 0a0a 2020  lues).any())..  
+00038f60: 2020 2020 2020 6966 2073 656c 662e 636c        if self.cl
+00038f70: 6173 735f 7765 6967 6874 2069 7320 6e6f  ass_weight is no
+00038f80: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+00038f90: 2020 2020 696e 6469 7669 6475 616c 2e63      individual.c
+00038fa0: 6173 655f 7661 6c75 6573 203d 2069 6e64  ase_values = ind
+00038fb0: 6976 6964 7561 6c2e 6361 7365 5f76 616c  ividual.case_val
+00038fc0: 7565 7320 2a20 7365 6c66 2e63 6c61 7373  ues * self.class
+00038fd0: 5f77 6569 6768 740a 0a20 2020 2064 6566  _weight..    def
+00038fe0: 2067 6574 5f64 6976 6572 7369 7479 5f6d   get_diversity_m
+00038ff0: 6174 7269 7828 7365 6c66 2c20 616c 6c5f  atrix(self, all_
+00039000: 696e 6429 3a0a 2020 2020 2020 2020 696e  ind):.        in
+00039010: 6473 203d 205b 5d0a 2020 2020 2020 2020  ds = [].        
+00039020: 666f 7220 7020 696e 2061 6c6c 5f69 6e64  for p in all_ind
+00039030: 3a0a 2020 2020 2020 2020 2020 2020 795f  :.            y_
+00039040: 7072 6564 5f6f 6e65 5f68 6f74 203d 2070  pred_one_hot = p
+00039050: 2e70 7265 6469 6374 6564 5f76 616c 7565  .predicted_value
+00039060: 730a 2020 2020 2020 2020 2020 2020 696e  s.            in
+00039070: 6473 2e61 7070 656e 6428 795f 7072 6564  ds.append(y_pred
+00039080: 5f6f 6e65 5f68 6f74 2e66 6c61 7474 656e  _one_hot.flatten
+00039090: 2829 290a 2020 2020 2020 2020 696e 6473  ()).        inds
+000390a0: 203d 206e 702e 6172 7261 7928 696e 6473   = np.array(inds
+000390b0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+000390c0: 2069 6e64 730a 0a20 2020 2064 6566 2063   inds..    def c
+000390d0: 616c 6375 6c61 7465 5f66 6974 6e65 7373  alculate_fitness
+000390e0: 5f76 616c 7565 2873 656c 662c 2069 6e64  _value(self, ind
+000390f0: 6976 6964 7561 6c2c 2065 7374 696d 6174  ividual, estimat
+00039100: 6f72 732c 2059 2c20 795f 7072 6564 293a  ors, Y, y_pred):
+00039110: 0a20 2020 2020 2020 2023 2073 6d61 6c6c  .        # small
+00039120: 6572 2069 7320 6265 7474 6572 2c20 7369  er is better, si
+00039130: 6d69 6c61 7220 746f 206e 6567 6174 6976  milar to negativ
+00039140: 6520 525e 320a 2020 2020 2020 2020 6966  e R^2.        if
+00039150: 2073 656c 662e 7363 6f72 655f 6675 6e63   self.score_func
+00039160: 203d 3d20 275a 6572 6f4f 6e65 2720 6f72   == 'ZeroOne' or
+00039170: 2073 656c 662e 7363 6f72 655f 6675 6e63   self.score_func
+00039180: 203d 3d20 2743 4446 4327 3a0a 2020 2020   == 'CDFC':.    
+00039190: 2020 2020 2020 2020 2320 6c61 7267 6572          # larger
+000391a0: 2069 7320 6265 7474 6572 0a20 2020 2020   is better.     
+000391b0: 2020 2020 2020 2073 636f 7265 203d 206e         score = n
+000391c0: 702e 7375 6d28 795f 7072 6564 2e66 6c61  p.sum(y_pred.fla
+000391d0: 7474 656e 2829 203d 3d20 592e 666c 6174  tten() == Y.flat
+000391e0: 7465 6e28 2929 0a20 2020 2020 2020 2020  ten()).         
+000391f0: 2020 2069 6620 7365 6c66 2e77 6569 6768     if self.weigh
+00039200: 7465 645f 636f 6566 3a0a 2020 2020 2020  ted_coef:.      
+00039210: 2020 2020 2020 2020 2020 696e 6469 7669            indivi
+00039220: 6475 616c 2e63 6f65 6620 3d20 6e70 2e61  dual.coef = np.a
+00039230: 7272 6179 2869 6e64 6976 6964 7561 6c2e  rray(individual.
+00039240: 636f 6566 2920 2a20 2873 636f 7265 290a  coef) * (score).
+00039250: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00039260: 726e 202d 3120 2a20 7363 6f72 652c 0a20  rn -1 * score,. 
+00039270: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
+00039280: 2e73 636f 7265 5f66 756e 6320 3d3d 2027  .score_func == '
+00039290: 4e6f 7665 6c74 7953 6561 7263 6827 3a0a  NoveltySearch':.
+000392a0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+000392b0: 726e 206e 702e 6d65 616e 2869 6e64 6976  rn np.mean(indiv
+000392c0: 6964 7561 6c2e 6f72 6967 696e 616c 5f63  idual.original_c
+000392d0: 6173 655f 7661 6c75 6573 292c 0a20 2020  ase_values),.   
+000392e0: 2020 2020 2065 6c69 6620 7365 6c66 2e73       elif self.s
+000392f0: 636f 7265 5f66 756e 6320 3d3d 2027 4372  core_func == 'Cr
+00039300: 6f73 7345 6e74 726f 7079 273a 0a20 2020  ossEntropy':.   
+00039310: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00039320: 6e70 2e6d 6561 6e28 696e 6469 7669 6475  np.mean(individu
+00039330: 616c 2e63 6173 655f 7661 6c75 6573 292c  al.case_values),
+00039340: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
+00039350: 6c66 2e73 636f 7265 5f66 756e 6320 3d3d  lf.score_func ==
+00039360: 2027 4356 2d4e 6f64 6543 6f75 6e74 2720   'CV-NodeCount' 
+00039370: 6f72 2073 656c 662e 7363 6f72 655f 6675  or self.score_fu
+00039380: 6e63 203d 3d20 275a 6572 6f4f 6e65 2d4e  nc == 'ZeroOne-N
+00039390: 6f64 6543 6f75 6e74 273a 0a20 2020 2020  odeCount':.     
+000393a0: 2020 2020 2020 2073 636f 7265 203d 202d         score = -
+000393b0: 3120 2a20 6e70 2e73 756d 2879 5f70 7265  1 * np.sum(y_pre
+000393c0: 642e 666c 6174 7465 6e28 2920 3d3d 2059  d.flatten() == Y
+000393d0: 2e66 6c61 7474 656e 2829 290a 2020 2020  .flatten()).    
+000393e0: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+000393f0: 702e 6d65 616e 285b 6573 7469 6d61 746f  p.mean([estimato
+00039400: 7273 5b69 5d5b 2752 6964 6765 275d 2e74  rs[i]['Ridge'].t
+00039410: 7265 655f 2e6e 6f64 655f 636f 756e 7420  ree_.node_count 
+00039420: 666f 7220 6920 696e 2072 616e 6765 286c  for i in range(l
+00039430: 656e 2865 7374 696d 6174 6f72 7329 295d  en(estimators))]
+00039440: 292c 0a20 2020 2020 2020 2065 6c69 6620  ),.        elif 
+00039450: 2743 5627 2069 6e20 7365 6c66 2e73 636f  'CV' in self.sco
+00039460: 7265 5f66 756e 633a 0a20 2020 2020 2020  re_func:.       
+00039470: 2020 2020 2072 6574 7572 6e20 2d31 202a       return -1 *
+00039480: 206e 702e 6d65 616e 2879 5f70 7265 6429   np.mean(y_pred)
+00039490: 2c0a 2020 2020 2020 2020 656c 7365 3a0a  ,.        else:.
+000394a0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+000394b0: 6520 4578 6365 7074 696f 6e0a 0a20 2020  e Exception..   
+000394c0: 2064 6566 2070 7265 6469 6374 2873 656c   def predict(sel
+000394d0: 662c 2058 2c20 7265 7475 726e 5f73 7464  f, X, return_std
+000394e0: 3d46 616c 7365 293a 0a20 2020 2020 2020  =False):.       
+000394f0: 2070 7265 6469 6374 696f 6e73 203d 2073   predictions = s
+00039500: 656c 662e 7072 6564 6963 745f 7072 6f62  elf.predict_prob
+00039510: 6128 5829 0a20 2020 2020 2020 2061 7373  a(X).        ass
+00039520: 6572 7420 6e70 2e61 6c6c 286e 702e 7375  ert np.all(np.su
+00039530: 6d28 7072 6564 6963 7469 6f6e 732c 2061  m(predictions, a
+00039540: 7869 733d 3129 290a 2020 2020 2020 2020  xis=1)).        
+00039550: 6c61 6265 6c73 203d 206e 702e 736f 7274  labels = np.sort
+00039560: 286e 702e 756e 6971 7565 2873 656c 662e  (np.unique(self.
+00039570: 7929 290a 2020 2020 2020 2020 7265 7475  y)).        retu
+00039580: 726e 206c 6162 656c 735b 6e70 2e61 7267  rn labels[np.arg
+00039590: 6d61 7828 7072 6564 6963 7469 6f6e 732c  max(predictions,
+000395a0: 2061 7869 733d 3129 5d0a 0a20 2020 2064   axis=1)]..    d
+000395b0: 6566 2067 6574 5f62 6173 655f 6d6f 6465  ef get_base_mode
+000395c0: 6c28 7365 6c66 2c20 7265 6775 6c61 7269  l(self, regulari
+000395d0: 7a61 7469 6f6e 5f72 6174 696f 3d31 2c20  zation_ratio=1, 
+000395e0: 6261 7365 5f6d 6f64 656c 3d4e 6f6e 6529  base_model=None)
+000395f0: 3a0a 2020 2020 2020 2020 6261 7365 5f6d  :.        base_m
+00039600: 6f64 656c 5f73 7472 203d 2062 6173 655f  odel_str = base_
+00039610: 6d6f 6465 6c20 6966 2069 7369 6e73 7461  model if isinsta
+00039620: 6e63 6528 6261 7365 5f6d 6f64 656c 2c20  nce(base_model, 
+00039630: 7374 7229 2065 6c73 6520 2727 0a20 2020  str) else ''.   
+00039640: 2020 2020 2069 6620 7365 6c66 2e62 6173       if self.bas
+00039650: 655f 6c65 6172 6e65 7220 3d3d 2027 4454  e_learner == 'DT
+00039660: 2720 6f72 2073 656c 662e 6261 7365 5f6c  ' or self.base_l
+00039670: 6561 726e 6572 203d 3d20 2750 4341 2d44  earner == 'PCA-D
+00039680: 5427 206f 7220 5c0a 2020 2020 2020 2020  T' or \.        
+00039690: 2020 2020 7365 6c66 2e62 6173 655f 6c65      self.base_le
+000396a0: 6172 6e65 7220 3d3d 2027 4479 6e61 6d69  arner == 'Dynami
+000396b0: 632d 4454 2720 6f72 2062 6173 655f 6d6f  c-DT' or base_mo
+000396c0: 6465 6c20 3d3d 2027 4454 273a 0a20 2020  del == 'DT':.   
+000396d0: 2020 2020 2020 2020 2072 6964 6765 5f6d           ridge_m
+000396e0: 6f64 656c 203d 2044 6563 6973 696f 6e54  odel = DecisionT
+000396f0: 7265 6543 6c61 7373 6966 6965 7228 6d61  reeClassifier(ma
+00039700: 785f 6465 7074 683d 7365 6c66 2e6d 6178  x_depth=self.max
+00039710: 5f74 7265 655f 6465 7074 682c 0a20 2020  _tree_depth,.   
+00039720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039740: 2020 2020 2020 2020 2020 2020 2020 6d69                mi
+00039750: 6e5f 7361 6d70 6c65 735f 6c65 6166 3d73  n_samples_leaf=s
+00039760: 656c 662e 6d69 6e5f 7361 6d70 6c65 735f  elf.min_samples_
+00039770: 6c65 6166 290a 2020 2020 2020 2020 656c  leaf).        el
+00039780: 6966 2073 656c 662e 6261 7365 5f6c 6561  if self.base_lea
+00039790: 726e 6572 203d 3d20 2742 616c 616e 6365  rner == 'Balance
+000397a0: 642d 4454 2720 6f72 2062 6173 655f 6d6f  d-DT' or base_mo
+000397b0: 6465 6c20 3d3d 2027 4261 6c61 6e63 6564  del == 'Balanced
+000397c0: 2d44 5427 3a0a 2020 2020 2020 2020 2020  -DT':.          
+000397d0: 2020 7269 6467 655f 6d6f 6465 6c20 3d20    ridge_model = 
+000397e0: 4465 6369 7369 6f6e 5472 6565 436c 6173  DecisionTreeClas
+000397f0: 7369 6669 6572 286d 6178 5f64 6570 7468  sifier(max_depth
+00039800: 3d73 656c 662e 6d61 785f 7472 6565 5f64  =self.max_tree_d
+00039810: 6570 7468 2c0a 2020 2020 2020 2020 2020  epth,.          
+00039820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039840: 2020 2020 2020 206d 696e 5f73 616d 706c         min_sampl
+00039850: 6573 5f6c 6561 663d 7365 6c66 2e6d 696e  es_leaf=self.min
+00039860: 5f73 616d 706c 6573 5f6c 6561 662c 0a20  _samples_leaf,. 
+00039870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000398a0: 636c 6173 735f 7765 6967 6874 3d27 6261  class_weight='ba
+000398b0: 6c61 6e63 6564 2729 0a20 2020 2020 2020  lanced').       
+000398c0: 2065 6c69 6620 7365 6c66 2e62 6173 655f   elif self.base_
+000398d0: 6c65 6172 6e65 7220 3d3d 2027 4454 2d53  learner == 'DT-S
+000398e0: 5152 5427 3a0a 2020 2020 2020 2020 2020  QRT':.          
+000398f0: 2020 7269 6467 655f 6d6f 6465 6c20 3d20    ridge_model = 
+00039900: 4465 6369 7369 6f6e 5472 6565 436c 6173  DecisionTreeClas
+00039910: 7369 6669 6572 286d 6178 5f64 6570 7468  sifier(max_depth
+00039920: 3d73 656c 662e 6d61 785f 7472 6565 5f64  =self.max_tree_d
+00039930: 6570 7468 2c0a 2020 2020 2020 2020 2020  epth,.          
+00039940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039960: 2020 2020 2020 206d 696e 5f73 616d 706c         min_sampl
+00039970: 6573 5f6c 6561 663d 7365 6c66 2e6d 696e  es_leaf=self.min
+00039980: 5f73 616d 706c 6573 5f6c 6561 662c 0a20  _samples_leaf,. 
+00039990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000399a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000399b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000399c0: 6d61 785f 6665 6174 7572 6573 3d27 7371  max_features='sq
+000399d0: 7274 2729 0a20 2020 2020 2020 2065 6c69  rt').        eli
+000399e0: 6620 7365 6c66 2e62 6173 655f 6c65 6172  f self.base_lear
+000399f0: 6e65 7220 3d3d 2027 4c6f 6769 7374 6963  ner == 'Logistic
+00039a00: 5265 6772 6573 7369 6f6e 2720 6f72 2073  Regression' or s
+00039a10: 656c 662e 6261 7365 5f6c 6561 726e 6572  elf.base_learner
+00039a20: 203d 3d20 2746 6173 742d 4c52 4454 2720   == 'Fast-LRDT' 
+00039a30: 5c0a 2020 2020 2020 2020 2020 2020 6f72  \.            or
+00039a40: 2062 6173 655f 6d6f 6465 6c5f 7374 7220   base_model_str 
+00039a50: 3d3d 2027 4c6f 6769 7374 6963 5265 6772  == 'LogisticRegr
+00039a60: 6573 7369 6f6e 273a 0a20 2020 2020 2020  ession':.       
+00039a70: 2020 2020 2072 6964 6765 5f6d 6f64 656c       ridge_model
+00039a80: 203d 2053 6166 6574 794c 6f67 6973 7469   = SafetyLogisti
+00039a90: 6352 6567 7265 7373 696f 6e28 6d61 785f  cRegression(max_
+00039aa0: 6974 6572 3d31 3030 302c 2073 6f6c 7665  iter=1000, solve
+00039ab0: 723d 276c 6962 6c69 6e65 6172 272c 0a20  r='liblinear',. 
+00039ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039af0: 2020 7261 6e64 6f6d 5f73 7461 7465 3d30    random_state=0
+00039b00: 290a 2020 2020 2020 2020 656c 6966 2073  ).        elif s
+00039b10: 656c 662e 6261 7365 5f6c 6561 726e 6572  elf.base_learner
+00039b20: 203d 3d20 2742 616c 616e 6365 642d 4c6f   == 'Balanced-Lo
+00039b30: 6769 7374 6963 5265 6772 6573 7369 6f6e  gisticRegression
+00039b40: 2720 6f72 205c 0a20 2020 2020 2020 2020  ' or \.         
+00039b50: 2020 2062 6173 655f 6d6f 6465 6c5f 7374     base_model_st
+00039b60: 7220 3d3d 2027 4261 6c61 6e63 6564 2d4c  r == 'Balanced-L
+00039b70: 6f67 6973 7469 6352 6567 7265 7373 696f  ogisticRegressio
+00039b80: 6e27 3a0a 2020 2020 2020 2020 2020 2020  n':.            
+00039b90: 7269 6467 655f 6d6f 6465 6c20 3d20 5361  ridge_model = Sa
+00039ba0: 6665 7479 4c6f 6769 7374 6963 5265 6772  fetyLogisticRegr
+00039bb0: 6573 7369 6f6e 286d 6178 5f69 7465 723d  ession(max_iter=
+00039bc0: 3130 3030 2c20 736f 6c76 6572 3d27 6c69  1000, solver='li
+00039bd0: 626c 696e 6561 7227 2c20 636c 6173 735f  blinear', class_
+00039be0: 7765 6967 6874 3d27 6261 6c61 6e63 6564  weight='balanced
+00039bf0: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+00039c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039c20: 2020 2020 2020 7261 6e64 6f6d 5f73 7461        random_sta
+00039c30: 7465 3d30 290a 2020 2020 2020 2020 656c  te=0).        el
+00039c40: 6966 2073 656c 662e 6261 7365 5f6c 6561  if self.base_lea
+00039c50: 726e 6572 203d 3d20 2744 796e 616d 6963  rner == 'Dynamic
+00039c60: 2d4c 6f67 6973 7469 6352 6567 7265 7373  -LogisticRegress
+00039c70: 696f 6e27 3a0a 2020 2020 2020 2020 2020  ion':.          
+00039c80: 2020 7269 6467 655f 6d6f 6465 6c20 3d20    ridge_model = 
+00039c90: 4c6f 6769 7374 6963 5265 6772 6573 7369  LogisticRegressi
+00039ca0: 6f6e 2843 3d72 6567 756c 6172 697a 6174  on(C=regularizat
+00039cb0: 696f 6e5f 7261 7469 6f2c 206d 6178 5f69  ion_ratio, max_i
+00039cc0: 7465 723d 3130 3030 2c20 736f 6c76 6572  ter=1000, solver
+00039cd0: 3d27 6c69 626c 696e 6561 7227 290a 2020  ='liblinear').  
+00039ce0: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
+00039cf0: 6261 7365 5f6c 6561 726e 6572 203d 3d20  base_learner == 
+00039d00: 2747 4244 542d 504c 273a 0a20 2020 2020  'GBDT-PL':.     
+00039d10: 2020 2020 2020 2072 6964 6765 5f6d 6f64         ridge_mod
+00039d20: 656c 203d 204c 4742 4d43 6c61 7373 6966  el = LGBMClassif
+00039d30: 6965 7228 6e5f 6573 7469 6d61 746f 7273  ier(n_estimators
+00039d40: 3d31 302c 206c 6561 726e 696e 675f 7261  =10, learning_ra
+00039d50: 7465 3d31 2c20 6d61 785f 6465 7074 683d  te=1, max_depth=
+00039d60: 332c 206c 696e 6561 725f 7472 6565 3d54  3, linear_tree=T
+00039d70: 7275 6529 0a20 2020 2020 2020 2065 6c69  rue).        eli
+00039d80: 6620 7365 6c66 2e62 6173 655f 6c65 6172  f self.base_lear
+00039d90: 6e65 7220 3d3d 2027 4742 4454 2d4c 5227  ner == 'GBDT-LR'
+00039da0: 3a0a 2020 2020 2020 2020 2020 2020 7269  :.            ri
+00039db0: 6467 655f 6d6f 6465 6c20 3d20 4742 4454  dge_model = GBDT
+00039dc0: 4c52 436c 6173 7369 6669 6572 5828 4c47  LRClassifierX(LG
+00039dd0: 424d 436c 6173 7369 6669 6572 286e 5f65  BMClassifier(n_e
+00039de0: 7374 696d 6174 6f72 733d 3130 2c20 6c65  stimators=10, le
+00039df0: 6172 6e69 6e67 5f72 6174 653d 312c 206d  arning_rate=1, m
+00039e00: 6178 5f64 6570 7468 3d33 292c 0a20 2020  ax_depth=3),.   
+00039e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039e30: 2020 2020 2020 2020 2053 6166 6574 794c           SafetyL
+00039e40: 6f67 6973 7469 6352 6567 7265 7373 696f  ogisticRegressio
+00039e50: 6e28 6d61 785f 6974 6572 3d31 3030 302c  n(max_iter=1000,
+00039e60: 2073 6f6c 7665 723d 276c 6962 6c69 6e65   solver='libline
+00039e70: 6172 2729 290a 2020 2020 2020 2020 656c  ar')).        el
+00039e80: 6966 2073 656c 662e 6261 7365 5f6c 6561  if self.base_lea
+00039e90: 726e 6572 203d 3d20 274c 6967 6874 4742  rner == 'LightGB
+00039ea0: 4d27 3a0a 2020 2020 2020 2020 2020 2020  M':.            
+00039eb0: 7061 7261 6d65 7465 725f 6772 6964 203d  parameter_grid =
+00039ec0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+00039ed0: 2020 2022 6c65 6172 6e69 6e67 5f72 6174     "learning_rat
+00039ee0: 6522 3a20 5b30 2e35 5d2c 0a20 2020 2020  e": [0.5],.     
+00039ef0: 2020 2020 2020 2020 2020 2027 6e5f 6573             'n_es
+00039f00: 7469 6d61 746f 7273 273a 205b 3130 5d2c  timators': [10],
+00039f10: 0a20 2020 2020 2020 2020 2020 207d 0a20  .            }. 
+00039f20: 2020 2020 2020 2020 2020 2070 6172 616d             param
+00039f30: 6574 6572 203d 2072 616e 646f 6d2e 6368  eter = random.ch
+00039f40: 6f69 6365 286c 6973 7428 5061 7261 6d65  oice(list(Parame
+00039f50: 7465 7247 7269 6428 7061 7261 6d65 7465  terGrid(paramete
+00039f60: 725f 6772 6964 2929 290a 2020 2020 2020  r_grid))).      
+00039f70: 2020 2020 2020 7269 6467 655f 6d6f 6465        ridge_mode
+00039f80: 6c20 3d20 4c47 424d 436c 6173 7369 6669  l = LGBMClassifi
+00039f90: 6572 282a 2a70 6172 616d 6574 6572 2c20  er(**parameter, 
+00039fa0: 6578 7472 615f 7472 6565 733d 5472 7565  extra_trees=True
+00039fb0: 2c20 6e75 6d5f 6c65 6176 6573 3d36 332c  , num_leaves=63,
+00039fc0: 206e 5f6a 6f62 733d 3129 0a20 2020 2020   n_jobs=1).     
+00039fd0: 2020 2065 6c69 6620 7365 6c66 2e62 6173     elif self.bas
+00039fe0: 655f 6c65 6172 6e65 7220 3d3d 2027 4454  e_learner == 'DT
+00039ff0: 2d43 7269 7465 7269 6f6e 273a 0a20 2020  -Criterion':.   
+0003a000: 2020 2020 2020 2020 2072 6964 6765 5f6d           ridge_m
+0003a010: 6f64 656c 203d 2044 6563 6973 696f 6e54  odel = DecisionT
+0003a020: 7265 6543 6c61 7373 6966 6965 7228 6372  reeClassifier(cr
+0003a030: 6974 6572 696f 6e3d 7261 6e64 6f6d 2e63  iterion=random.c
+0003a040: 686f 6963 6528 5b27 656e 7472 6f70 7927  hoice(['entropy'
+0003a050: 2c20 2767 696e 6927 5d29 2c0a 2020 2020  , 'gini']),.    
+0003a060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a080: 2020 2020 2020 2020 2020 2020 206d 6178               max
+0003a090: 5f64 6570 7468 3d73 656c 662e 6d61 785f  _depth=self.max_
+0003a0a0: 7472 6565 5f64 6570 7468 2c0a 2020 2020  tree_depth,.    
+0003a0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a0d0: 2020 2020 2020 2020 2020 2020 206d 696e               min
+0003a0e0: 5f73 616d 706c 6573 5f6c 6561 663d 7365  _samples_leaf=se
+0003a0f0: 6c66 2e6d 696e 5f73 616d 706c 6573 5f6c  lf.min_samples_l
+0003a100: 6561 6629 0a20 2020 2020 2020 2065 6c69  eaf).        eli
+0003a110: 6620 7365 6c66 2e62 6173 655f 6c65 6172  f self.base_lear
+0003a120: 6e65 7220 3d3d 2027 5261 6e64 6f6d 2d44  ner == 'Random-D
+0003a130: 5427 206f 7220 7365 6c66 2e62 6173 655f  T' or self.base_
+0003a140: 6c65 6172 6e65 7220 3d3d 2027 5261 6e64  learner == 'Rand
+0003a150: 6f6d 2d44 542d 506c 7573 2720 5c0a 2020  om-DT-Plus' \.  
+0003a160: 2020 2020 2020 2020 2020 6f72 2062 6173            or bas
+0003a170: 655f 6d6f 6465 6c20 3d3d 2027 5261 6e64  e_model == 'Rand
+0003a180: 6f6d 2d44 5427 3a0a 2020 2020 2020 2020  om-DT':.        
+0003a190: 2020 2020 7269 6467 655f 6d6f 6465 6c20      ridge_model 
+0003a1a0: 3d20 4465 6369 7369 6f6e 5472 6565 436c  = DecisionTreeCl
+0003a1b0: 6173 7369 6669 6572 2873 706c 6974 7465  assifier(splitte
+0003a1c0: 723d 2772 616e 646f 6d27 2c20 6d61 785f  r='random', max_
+0003a1d0: 6465 7074 683d 7365 6c66 2e6d 6178 5f74  depth=self.max_t
+0003a1e0: 7265 655f 6465 7074 682c 0a20 2020 2020  ree_depth,.     
+0003a1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a210: 2020 2020 2020 2020 2020 2020 6d69 6e5f              min_
+0003a220: 7361 6d70 6c65 735f 6c65 6166 3d73 656c  samples_leaf=sel
+0003a230: 662e 6d69 6e5f 7361 6d70 6c65 735f 6c65  f.min_samples_le
+0003a240: 6166 290a 2020 2020 2020 2020 656c 6966  af).        elif
+0003a250: 2073 656c 662e 6261 7365 5f6c 6561 726e   self.base_learn
+0003a260: 6572 203d 3d20 2742 616c 616e 6365 642d  er == 'Balanced-
+0003a270: 5261 6e64 6f6d 2d44 5427 206f 7220 6261  Random-DT' or ba
+0003a280: 7365 5f6d 6f64 656c 203d 3d20 2742 616c  se_model == 'Bal
+0003a290: 616e 6365 642d 5261 6e64 6f6d 2d44 5427  anced-Random-DT'
+0003a2a0: 3a0a 2020 2020 2020 2020 2020 2020 7269  :.            ri
+0003a2b0: 6467 655f 6d6f 6465 6c20 3d20 4465 6369  dge_model = Deci
+0003a2c0: 7369 6f6e 5472 6565 436c 6173 7369 6669  sionTreeClassifi
+0003a2d0: 6572 2873 706c 6974 7465 723d 2772 616e  er(splitter='ran
+0003a2e0: 646f 6d27 2c20 6d61 785f 6465 7074 683d  dom', max_depth=
+0003a2f0: 7365 6c66 2e6d 6178 5f74 7265 655f 6465  self.max_tree_de
+0003a300: 7074 682c 0a20 2020 2020 2020 2020 2020  pth,.           
+0003a310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a330: 2020 2020 2020 6d69 6e5f 7361 6d70 6c65        min_sample
+0003a340: 735f 6c65 6166 3d73 656c 662e 6d69 6e5f  s_leaf=self.min_
+0003a350: 7361 6d70 6c65 735f 6c65 6166 2c0a 2020  samples_leaf,.  
+0003a360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a380: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0003a390: 6c61 7373 5f77 6569 6768 743d 2762 616c  lass_weight='bal
+0003a3a0: 616e 6365 6427 290a 2020 2020 2020 2020  anced').        
+0003a3b0: 656c 6966 2073 656c 662e 6261 7365 5f6c  elif self.base_l
+0003a3c0: 6561 726e 6572 203d 3d20 2752 616e 646f  earner == 'Rando
+0003a3d0: 6d2d 4454 2d43 7269 7465 7269 6f6e 273a  m-DT-Criterion':
+0003a3e0: 0a20 2020 2020 2020 2020 2020 2072 6964  .            rid
+0003a3f0: 6765 5f6d 6f64 656c 203d 2044 6563 6973  ge_model = Decis
+0003a400: 696f 6e54 7265 6543 6c61 7373 6966 6965  ionTreeClassifie
+0003a410: 7228 6372 6974 6572 696f 6e3d 7261 6e64  r(criterion=rand
+0003a420: 6f6d 2e63 686f 6963 6528 5b27 656e 7472  om.choice(['entr
+0003a430: 6f70 7927 2c20 2767 696e 6927 5d29 2c0a  opy', 'gini']),.
+0003a440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a470: 2073 706c 6974 7465 723d 2772 616e 646f   splitter='rando
+0003a480: 6d27 2c0a 2020 2020 2020 2020 2020 2020  m',.            
+0003a490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a4b0: 2020 2020 206d 6178 5f64 6570 7468 3d73       max_depth=s
+0003a4c0: 656c 662e 6d61 785f 7472 6565 5f64 6570  elf.max_tree_dep
+0003a4d0: 7468 2c0a 2020 2020 2020 2020 2020 2020  th,.            
+0003a4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a500: 2020 2020 206d 696e 5f73 616d 706c 6573       min_samples
+0003a510: 5f6c 6561 663d 7365 6c66 2e6d 696e 5f73  _leaf=self.min_s
+0003a520: 616d 706c 6573 5f6c 6561 6629 0a20 2020  amples_leaf).   
+0003a530: 2020 2020 2065 6c69 6620 7365 6c66 2e62       elif self.b
+0003a540: 6173 655f 6c65 6172 6e65 7220 3d3d 2027  ase_learner == '
+0003a550: 4c6f 6769 7374 6963 5265 6772 6573 7369  LogisticRegressi
+0003a560: 6f6e 4356 273a 0a20 2020 2020 2020 2020  onCV':.         
+0003a570: 2020 2072 6964 6765 5f6d 6f64 656c 203d     ridge_model =
+0003a580: 204c 6f67 6973 7469 6352 6567 7265 7373   LogisticRegress
+0003a590: 696f 6e43 5628 736f 6c76 6572 3d27 6c69  ionCV(solver='li
+0003a5a0: 626c 696e 6561 7227 290a 2020 2020 2020  blinear').      
+0003a5b0: 2020 656c 6966 2073 656c 662e 6261 7365    elif self.base
+0003a5c0: 5f6c 6561 726e 6572 203d 3d20 2752 616e  _learner == 'Ran
+0003a5d0: 646f 6d2d 4454 2d53 5152 5427 3a0a 2020  dom-DT-SQRT':.  
+0003a5e0: 2020 2020 2020 2020 2020 7269 6467 655f            ridge_
+0003a5f0: 6d6f 6465 6c20 3d20 4465 6369 7369 6f6e  model = Decision
+0003a600: 5472 6565 436c 6173 7369 6669 6572 2873  TreeClassifier(s
+0003a610: 706c 6974 7465 723d 2772 616e 646f 6d27  plitter='random'
+0003a620: 2c20 6d61 785f 6465 7074 683d 7365 6c66  , max_depth=self
+0003a630: 2e6d 6178 5f74 7265 655f 6465 7074 682c  .max_tree_depth,
+0003a640: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003a650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a670: 2020 6d69 6e5f 7361 6d70 6c65 735f 6c65    min_samples_le
+0003a680: 6166 3d73 656c 662e 6d69 6e5f 7361 6d70  af=self.min_samp
+0003a690: 6c65 735f 6c65 6166 2c0a 2020 2020 2020  les_leaf,.      
+0003a6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a6c0: 2020 2020 2020 2020 2020 206d 6178 5f66             max_f
+0003a6d0: 6561 7475 7265 733d 2773 7172 7427 290a  eatures='sqrt').
+0003a6e0: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
+0003a6f0: 662e 6261 7365 5f6c 6561 726e 6572 203d  f.base_learner =
+0003a700: 3d20 274c 5244 5427 3a0a 2020 2020 2020  = 'LRDT':.      
+0003a710: 2020 2020 2020 7269 6467 655f 6d6f 6465        ridge_mode
+0003a720: 6c20 3d20 4c52 4454 436c 6173 7369 6669  l = LRDTClassifi
+0003a730: 6572 2864 6563 6973 696f 6e5f 7472 6565  er(decision_tree
+0003a740: 5f63 6f75 6e74 3d73 656c 662e 6465 6369  _count=self.deci
+0003a750: 7369 6f6e 5f74 7265 655f 636f 756e 742c  sion_tree_count,
+0003a760: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003a770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a780: 2020 2020 2020 2020 2020 6d61 785f 6c65            max_le
+0003a790: 6166 5f6e 6f64 6573 3d73 656c 662e 6d61  af_nodes=self.ma
+0003a7a0: 785f 6c65 6166 5f6e 6f64 6573 290a 2020  x_leaf_nodes).  
+0003a7b0: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
+0003a7c0: 6261 7365 5f6c 6561 726e 6572 203d 3d20  base_learner == 
+0003a7d0: 2748 7962 7269 6427 3a0a 2020 2020 2020  'Hybrid':.      
+0003a7e0: 2020 2020 2020 2320 6578 7472 6163 7420        # extract 
+0003a7f0: 6261 7365 206d 6f64 656c 0a20 2020 2020  base model.     
+0003a800: 2020 2020 2020 2072 6964 6765 5f6d 6f64         ridge_mod
+0003a810: 656c 203d 2073 656c 662e 7470 6f74 5f6d  el = self.tpot_m
+0003a820: 6f64 656c 2e5f 636f 6d70 696c 655f 746f  odel._compile_to
+0003a830: 5f73 6b6c 6561 726e 2862 6173 655f 6d6f  _sklearn(base_mo
+0003a840: 6465 6c29 5b2d 315d 0a20 2020 2020 2020  del)[-1].       
+0003a850: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
+0003a860: 2873 656c 662e 6261 7365 5f6c 6561 726e  (self.base_learn
+0003a870: 6572 2c20 436c 6173 7369 6669 6572 4d69  er, ClassifierMi
+0003a880: 7869 6e29 3a0a 2020 2020 2020 2020 2020  xin):.          
+0003a890: 2020 7269 6467 655f 6d6f 6465 6c20 3d20    ridge_model = 
+0003a8a0: 7365 6c66 2e62 6173 655f 6c65 6172 6e65  self.base_learne
+0003a8b0: 720a 2020 2020 2020 2020 656c 6966 2062  r.        elif b
+0003a8c0: 6173 655f 6d6f 6465 6c5f 7374 7220 213d  ase_model_str !=
+0003a8d0: 2027 2720 616e 6420 6261 7365 5f6d 6f64   '' and base_mod
+0003a8e0: 656c 5f73 7472 2069 6e20 7365 6c66 2e62  el_str in self.b
+0003a8f0: 6173 655f 6d6f 6465 6c5f 6469 6374 3a0a  ase_model_dict:.
+0003a900: 2020 2020 2020 2020 2020 2020 7269 6467              ridg
+0003a910: 655f 6d6f 6465 6c20 3d20 7365 6c66 2e62  e_model = self.b
+0003a920: 6173 655f 6d6f 6465 6c5f 6469 6374 5b62  ase_model_dict[b
+0003a930: 6173 655f 6d6f 6465 6c5f 7374 725d 0a20  ase_model_str]. 
+0003a940: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
+0003a950: 2e62 6173 655f 6c65 6172 6e65 7220 213d  .base_learner !=
+0003a960: 2027 2720 616e 6420 7365 6c66 2e62 6173   '' and self.bas
+0003a970: 655f 6c65 6172 6e65 7220 696e 2073 656c  e_learner in sel
+0003a980: 662e 6261 7365 5f6d 6f64 656c 5f64 6963  f.base_model_dic
+0003a990: 743a 0a20 2020 2020 2020 2020 2020 2072  t:.            r
+0003a9a0: 6964 6765 5f6d 6f64 656c 203d 2073 656c  idge_model = sel
+0003a9b0: 662e 6261 7365 5f6d 6f64 656c 5f64 6963  f.base_model_dic
+0003a9c0: 745b 7365 6c66 2e62 6173 655f 6c65 6172  t[self.base_lear
+0003a9d0: 6e65 725d 0a20 2020 2020 2020 2065 6c73  ner].        els
+0003a9e0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+0003a9f0: 6169 7365 2045 7863 6570 7469 6f6e 0a20  aise Exception. 
+0003aa00: 2020 2020 2020 2069 6620 7365 6c66 2e62         if self.b
+0003aa10: 6173 655f 6c65 6172 6e65 7220 3d3d 2027  ase_learner == '
+0003aa20: 5043 412d 4454 273a 0a20 2020 2020 2020  PCA-DT':.       
+0003aa30: 2020 2020 2070 6970 6520 3d20 5069 7065       pipe = Pipe
+0003aa40: 6c69 6e65 285b 0a20 2020 2020 2020 2020  line([.         
+0003aa50: 2020 2020 2020 2028 2253 6361 6c65 7222         ("Scaler"
+0003aa60: 2c20 5374 616e 6461 7264 5363 616c 6572  , StandardScaler
+0003aa70: 2829 292c 0a20 2020 2020 2020 2020 2020  ()),.           
+0003aa80: 2020 2020 2028 2750 4341 272c 2050 4341       ('PCA', PCA
+0003aa90: 2829 292c 0a20 2020 2020 2020 2020 2020  ()),.           
+0003aaa0: 2020 2020 2028 2252 6964 6765 222c 2072       ("Ridge", r
+0003aab0: 6964 6765 5f6d 6f64 656c 292c 0a20 2020  idge_model),.   
+0003aac0: 2020 2020 2020 2020 205d 290a 2020 2020           ]).    
+0003aad0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0003aae0: 2020 2020 2020 7069 7065 203d 2050 6970        pipe = Pip
+0003aaf0: 656c 696e 6528 5b0a 2020 2020 2020 2020  eline([.        
+0003ab00: 2020 2020 2020 2020 2822 5363 616c 6572          ("Scaler
+0003ab10: 222c 2053 6166 6574 7953 6361 6c65 7228  ", SafetyScaler(
+0003ab20: 2929 2c0a 2020 2020 2020 2020 2020 2020  )),.            
+0003ab30: 2020 2020 2822 5269 6467 6522 2c20 7269      ("Ridge", ri
+0003ab40: 6467 655f 6d6f 6465 6c29 2c0a 2020 2020  dge_model),.    
+0003ab50: 2020 2020 2020 2020 5d29 0a20 2020 2020          ]).     
+0003ab60: 2020 2072 6574 7572 6e20 7069 7065 0a0a     return pipe..
+0003ab70: 0a64 6566 2074 7275 6e63 6174 6564 5f6e  .def truncated_n
+0003ab80: 6f72 6d61 6c28 6c6f 7765 723d 302c 2075  ormal(lower=0, u
+0003ab90: 7070 6572 3d31 2c20 6d75 3d30 2e35 2c20  pper=1, mu=0.5, 
+0003aba0: 7369 676d 613d 302e 312c 2073 616d 706c  sigma=0.1, sampl
+0003abb0: 653d 2831 3030 2c20 3130 3029 293a 0a20  e=(100, 100)):. 
+0003abc0: 2020 2023 2069 6e73 7461 6e74 6961 7465     # instantiate
+0003abd0: 2061 6e20 6f62 6a65 6374 2058 2075 7369   an object X usi
+0003abe0: 6e67 2074 6865 2061 626f 7665 2066 6f75  ng the above fou
+0003abf0: 7220 7061 7261 6d65 7465 7273 2c0a 2020  r parameters,.  
+0003ac00: 2020 5820 3d20 7374 6174 732e 7472 756e    X = stats.trun
+0003ac10: 636e 6f72 6d28 286c 6f77 6572 202d 206d  cnorm((lower - m
+0003ac20: 7529 202f 2073 6967 6d61 2c20 2875 7070  u) / sigma, (upp
+0003ac30: 6572 202d 206d 7529 202f 2073 6967 6d61  er - mu) / sigma
+0003ac40: 2c20 6c6f 633d 6d75 2c20 7363 616c 653d  , loc=mu, scale=
+0003ac50: 7369 676d 6129 0a20 2020 2023 2067 656e  sigma).    # gen
+0003ac60: 6572 6174 6520 3130 3030 2073 616d 706c  erate 1000 sampl
+0003ac70: 6520 6461 7461 0a20 2020 2073 616d 706c  e data.    sampl
+0003ac80: 6573 203d 2058 2e72 7673 2873 616d 706c  es = X.rvs(sampl
+0003ac90: 6529 0a20 2020 2072 6574 7572 6e20 7361  e).    return sa
+0003aca0: 6d70 6c65 730a 0a0a 6465 6620 696e 6974  mples...def init
+0003acb0: 5f77 6f72 6b65 7228 6675 6e63 7469 6f6e  _worker(function
+0003acc0: 2c20 6461 7461 293a 0a20 2020 2066 756e  , data):.    fun
+0003acd0: 6374 696f 6e2e 6461 7461 203d 2064 6174  ction.data = dat
+0003ace0: 610a                                     a.
```

### Comparing `evolutionary_forest-0.2.0/evolutionary_forest/model/PLTree.py` & `evolutionary_forest-0.2.1/evolutionary_forest/model/PLTree.py`

 * *Files 0% similar despite different names*

```diff
@@ -219,15 +219,15 @@
         prediction = self.ridge.predict(X)
         for dt in self.dt:
             prediction += dt.predict(X)
         return prediction
 
 
 class RidgeDT(RPLBaseModel, RegressorMixin):
-    def __init__(self, decision_tree_count=1, max_leaf_nodes=4):
+    def __init__(self, decision_tree_count=0, max_leaf_nodes=4):
         if max_leaf_nodes is None:
             max_leaf_nodes = 4
         self.ridge = Ridge()
         self.base_model = PLTreeRegressor
         super().__init__(decision_tree_count, max_leaf_nodes)
```

### Comparing `evolutionary_forest-0.2.0/evolutionary_forest/model/RBFN.py` & `evolutionary_forest-0.2.1/evolutionary_forest/model/RBFN.py`

 * *Files identical despite different names*

### Comparing `evolutionary_forest-0.2.0/evolutionary_forest/model/SafetyScaler.py` & `evolutionary_forest-0.2.1/evolutionary_forest/model/SafetyScaler.py`

 * *Files identical despite different names*

### Comparing `evolutionary_forest-0.2.0/evolutionary_forest/model/VAE.py` & `evolutionary_forest-0.2.1/evolutionary_forest/model/VAE.py`

 * *Files identical despite different names*

### Comparing `evolutionary_forest-0.2.0/evolutionary_forest/preprocess_utils.py` & `evolutionary_forest-0.2.1/evolutionary_forest/preprocess_utils.py`

 * *Files identical despite different names*

### Comparing `evolutionary_forest-0.2.0/evolutionary_forest/probability_gp.py` & `evolutionary_forest-0.2.1/evolutionary_forest/probability_gp.py`

 * *Files identical despite different names*

### Comparing `evolutionary_forest-0.2.0/evolutionary_forest/pruning.py` & `evolutionary_forest-0.2.1/evolutionary_forest/pruning.py`

 * *Files identical despite different names*

### Comparing `evolutionary_forest-0.2.0/evolutionary_forest/sklearn_utils.py` & `evolutionary_forest-0.2.1/evolutionary_forest/sklearn_utils.py`

 * *Files identical despite different names*

### Comparing `evolutionary_forest-0.2.0/evolutionary_forest/strategies/space_partition.py` & `evolutionary_forest-0.2.1/evolutionary_forest/strategies/space_partition.py`

 * *Files identical despite different names*

### Comparing `evolutionary_forest-0.2.0/evolutionary_forest/strategies/surrogate_model.py` & `evolutionary_forest-0.2.1/evolutionary_forest/strategies/surrogate_model.py`

 * *Files identical despite different names*

### Comparing `evolutionary_forest-0.2.0/evolutionary_forest/utils.py` & `evolutionary_forest-0.2.1/evolutionary_forest/utils.py`

 * *Files 14% similar despite different names*

```diff
@@ -1,9 +1,10 @@
 import copy
 import os
+import pickle as cPickle
 import random
 import time
 from collections import defaultdict
 from itertools import chain
 
 import numpy as np
 import pandas as pd
@@ -13,14 +14,54 @@
 from matplotlib import pyplot as plt
 from numba import njit
 from sympy import latex, parse_expr
 
 from evolutionary_forest.component.primitives import individual_to_tuple
 
 
+def extract_numbers(dimension, s):
+    """
+    Extracts two integers from a string of the form 'aN-b'.
+
+    Args:
+    s (str): The input string to extract integers from.
+
+    Returns:
+    A tuple containing two integers. The first integer is the number
+    before the letter 'N' in the input string, and the second integer
+    is the number after the dash.
+
+    Example:
+    >>> extract_numbers('3N-200')
+    (3, 200)
+    """
+
+    # Split the string into two parts around the dash
+    parts = s.split('-')
+
+    # Extract the first number before the letter 'N'
+    num1 = int(parts[0].rstrip('N'))
+
+    # Extract the second number after the dash
+    num2 = int(parts[1])
+
+    return min(num1 * dimension, num2)
+
+
+def cross_scale(array, cross_pb, inverse):
+    # scaling based on cross probabilities
+    array = np.array(array)
+    if inverse:
+        max_value = np.max(array)
+        return cross_pb * (max_value / array)
+    else:
+        min_value = np.min(array)
+        return cross_pb * (min_value / array)
+
+
 def get_important_features(parents):
     # Get important features
     genes = list(chain.from_iterable([x.gene for x in parents]))
     coefficients = list(chain.from_iterable([x.coef for x in parents]))
     hash_codes = list(chain.from_iterable([x.hash_result for x in parents]))
     results = dict()
     for g, c, h in zip(genes, coefficients, hash_codes):
@@ -30,39 +71,45 @@
             results[h][0] += float(c)
     features = list(sorted(results.items(), key=lambda item: -1 * item[1][0]))
     coefs = list(map(lambda x: x[1][0], features))
     features = list(map(lambda x: x[1][1], features))
     return features, coefs
 
 
-def efficient_deepcopy(self, memo=None):
+def efficient_deepcopy(self, memo=None, custom_filter=None):
     if memo is None:
         memo = {}
     cls = self.__class__  # Extract the class of the object
     result = cls.__new__(cls)  # Create a new instance of the object based on extracted class
     memo[id(self)] = result
     for k, v in self.__dict__.items():
-        if k in ('predicted_values', 'case_values', 'pipe', 'estimators'):
+        if custom_filter is None:
+            custom_filter = ('predicted_values', 'case_values', 'estimators')
+        if k in custom_filter:
             continue
         # Copy over attributes by copying directly or in case of complex objects like lists
         # for example calling the `__deepcopy()__` method defined by them.
-        # Thus recursively copying the whole tree of objects.
+        # Thus, recursively copying the whole tree of objects.
         setattr(result, k, copy.deepcopy(v, memo))
     return result
 
 
 def get_feature_importance(regr, latex_version=True, fitness_weighted=False, mean_fitness=False,
-                           ensemble_weighted=True):
+                           ensemble_weighted=True, simple_version=None):
     """
     :param regr: evolutionary forest
     :param latex_version: return simplified symbol, which is used for printing
     :param fitness_weighted: assign different weights to features based on fitness values
     :param mean_fitness: return mean feature importance instead of summative feature importance
+    :param simple_version: alias for latex_version
     :return:
     """
+    if simple_version is not None:
+        latex_version = simple_version
+
     if mean_fitness:
         all_genes_map = defaultdict(list)
     else:
         all_genes_map = defaultdict(int)
     hash_dict = {}
 
     # Processing function
@@ -180,28 +227,40 @@
     string = ""
     stack = []
     for node in gene:
         stack.append((node, []))
         while len(stack[-1][1]) == stack[-1][0].arity:
             prim, args = stack.pop()
             # string = prim.format(*args)
-            if type(prim) is Primitive:
+            if isinstance(prim, Primitive):
                 string = '('
                 if prim.name == 'AQ':
                     string += f'{args[0]}/sqrt(1+{args[1]}*{args[1]})'
                 elif prim.name == 'Log':
-                    string += f'log(1+Abs({args[0]}))'
+                    string += f'log(sqrt(1+{args[0]}*{args[0]}))'
+                elif prim.name == 'Log10':
+                    string += f'log(sqrt(1+{args[0]}*{args[0]}),10)'
+                elif prim.name == 'Square':
+                    string += f'{args[0]}*{args[0]}'
+                elif prim.name == 'Cube':
+                    string += f'{args[0]}*{args[0]}*{args[0]}'
                 elif prim.name == 'Sqrt':
                     string += f'sqrt(Abs({args[0]}))'
                 elif prim.name == 'Max':
                     string += f'Max({args[0]}, {args[1]})'
                 elif prim.name == 'Min':
                     string += f'Min({args[0]}, {args[1]})'
                 elif prim.name == 'Neg':
                     string += f'-{args[0]}'
+                elif prim.name == 'Tanh':
+                    string += f'tanh({args[0]})'
+                elif prim.name == 'Cbrt':
+                    string += f'cbrt({args[0]})'
+                elif prim.name == 'Abs':
+                    string += f'Abs({args[0]})'
                 elif prim.name not in infix_map:
                     string += prim.format(*args)
                 else:
                     string += args[0]
                     for a in args[1:]:
                         string += f'{infix_map[prim.name]}{a}'
                 string += ')'
@@ -302,7 +361,22 @@
 
 
 def load_object(path):
     import pickle
     with open(path, 'rb') as file:
         obj = pickle.load(file)
         return obj
+
+
+def is_float(element: any) -> bool:
+    # If you expect None to be passed:
+    if element is None:
+        return False
+    try:
+        float(element)
+        return True
+    except ValueError:
+        return False
+
+
+def pickle_deepcopy(a):
+    return cPickle.loads(cPickle.dumps(a, -1))
```

### Comparing `evolutionary_forest-0.2.0/evolutionary_forest.egg-info/PKG-INFO` & `evolutionary_forest-0.2.1/evolutionary_forest.egg-info/PKG-INFO`

 * *Files 2% similar despite different names*

```diff
@@ -1,17 +1,16 @@
 Metadata-Version: 2.1
 Name: evolutionary-forest
-Version: 0.2.0
+Version: 0.2.1
 Summary: An open source python library for automated feature engineering based on Genetic Programming
 Home-page: https://github.com/zhenlingcn/evolutionary_forest
 Author: Hengzhe Zhang
 Author-email: zhenlingcn@foxmail.com
 License: BSD license
 Keywords: evolutionary_forest
-Platform: UNKNOWN
 Classifier: Development Status :: 2 - Pre-Alpha
 Classifier: Intended Audience :: Developers
 Classifier: License :: OSI Approved :: BSD License
 Classifier: Natural Language :: English
 Classifier: Programming Language :: Python :: 3
 Classifier: Programming Language :: Python :: 3.6
 Classifier: Programming Language :: Python :: 3.7
@@ -134,9 +133,7 @@
 History
 =======
 
 0.1.0 (2021-05-22)
 ------------------
 
 * First release on PyPI.
-
-
```

### Comparing `evolutionary_forest-0.2.0/evolutionary_forest.egg-info/SOURCES.txt` & `evolutionary_forest-0.2.1/evolutionary_forest.egg-info/SOURCES.txt`

 * *Files 8% similar despite different names*

```diff
@@ -27,30 +27,41 @@
 evolutionary_forest/utils.py
 evolutionary_forest.egg-info/PKG-INFO
 evolutionary_forest.egg-info/SOURCES.txt
 evolutionary_forest.egg-info/dependency_links.txt
 evolutionary_forest.egg-info/not-zip-safe
 evolutionary_forest.egg-info/requires.txt
 evolutionary_forest.egg-info/top_level.txt
+evolutionary_forest/application/__init__.py
+evolutionary_forest/application/baes_class.py
+evolutionary_forest/application/expensive_benchmark.py
+evolutionary_forest/application/gp_function_test.py
 evolutionary_forest/component/__init__.py
 evolutionary_forest/component/archive.py
+evolutionary_forest/component/configuration.py
+evolutionary_forest/component/crossover_mutation.py
 evolutionary_forest/component/evaluation.py
 evolutionary_forest/component/generation.py
 evolutionary_forest/component/mutation_transformer.py
 evolutionary_forest/component/primitives.py
 evolutionary_forest/component/selection.py
 evolutionary_forest/component/stateful_gp.py
 evolutionary_forest/component/subset_selection.py
 evolutionary_forest/component/syntax_tools.py
+evolutionary_forest/component/toolbox.py
 evolutionary_forest/component/translation_transformer.py
+evolutionary_forest/component/tree_utils.py
 evolutionary_forest/model/PLTree.py
 evolutionary_forest/model/RBFN.py
 evolutionary_forest/model/SafetyLR.py
 evolutionary_forest/model/SafetyScaler.py
 evolutionary_forest/model/VAE.py
 evolutionary_forest/model/__init__.py
 evolutionary_forest/strategies/__init__.py
+evolutionary_forest/strategies/adaptive_rate.py
 evolutionary_forest/strategies/estimation_of_distribution.py
+evolutionary_forest/strategies/multiarm_bandit.py
+evolutionary_forest/strategies/prune_strategy.py
 evolutionary_forest/strategies/space_partition.py
 evolutionary_forest/strategies/surrogate_model.py
 tests/__init__.py
 tests/test_evolutionary_forest.py
```

### Comparing `evolutionary_forest-0.2.0/setup.py` & `evolutionary_forest-0.2.1/setup.py`

 * *Files 0% similar despite different names*

```diff
@@ -57,10 +57,10 @@
     keywords='evolutionary_forest',
     name='evolutionary_forest',
     packages=find_packages(include=['evolutionary_forest', 'evolutionary_forest.*']),
     setup_requires=setup_requirements,
     test_suite='tests',
     tests_require=test_requirements,
     url='https://github.com/zhenlingcn/evolutionary_forest',
-    version='0.2.0',
+    version='0.2.1',
     zip_safe=False,
 )
```

### Comparing `evolutionary_forest-0.2.0/tests/test_evolutionary_forest.py` & `evolutionary_forest-0.2.1/tests/test_evolutionary_forest.py`

 * *Files identical despite different names*

